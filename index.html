<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>PowerShell Commands</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      line-height: 1.4;
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      background-color: #ebebeb; /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ */
      color: #000000; /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ */
      padding: 2px; /* –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã */
    border-radius: 10px; /* –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤ */
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–Ω–∞–≤–µ—Ä—Ö" */
    .scroll-to-top {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 24px;
        cursor: pointer;
        display: none; /* –ö–Ω–æ–ø–∫–∞ —Å–∫—Ä—ã—Ç–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ */
        z-index: 1000; /* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö –¥—Ä—É–≥–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
    }
    .scroll-to-top:hover {
        background-color: #0056b3; /* –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
    }
  </style>
</head>
<body>
<script async src="https://cse.google.com/cse.js?cx=00375fd6fbe034dab"></script>
<div class="gcse-search"></div>
<button class="scroll-to-top" onclick="scrollToTop()">‚Üë</button>
<script>
  function scrollToTop() {
      window.scrollTo({
          top: 0,
          behavior: 'smooth' // –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞
      });
  }
  window.onscroll = function() {
      var scrollButton = document.querySelector('.scroll-to-top');
      if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
          scrollButton.style.display = 'block';
      } else {
          scrollButton.style.display = 'none';
      }
  };
</script>
<h1 id="PowerShell-Commands">PowerShell Commands</h1>
<p><img
src="https://img.shields.io/github/languages/top/lifailon/PS-Commands"
alt="GitHub top language" /> <img
src="https://img.shields.io/github/last-commit/lifailon/PS-Commands"
alt="GitHub last commit (by committer)" /> <img
src="https://img.shields.io/github/languages/code-size/lifailon/PS-Commands"
alt="GitHub code size in bytes" /> <img
src="https://img.shields.io/github/stars/Lifailon/PS-Commands"
alt="GitHub Repo stars" /></p>
<p>–ë–æ–ª—å—à–∞—è –±–∞–∑–∞ –∑–∞–º–µ—Ç–æ–∫ PowerShell –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.</p>
<p><a href="https://lifailon.github.io/">‚û°Ô∏è –í–µ–±-–≤–µ—Ä—Å–∏—è</a></p>
<p>üì¢ Habr: <a href="https://habr.com/ru/articles/782592/">PowerShell –∏
–µ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</a></p>
<ul>
<li><a href="#help">Help</a></li>
<li><a href="#object">Object</a></li>
<li><a href="#npp">npp</a></li>
<li><a href="#regex">Regex</a></li>
<li><a href="#datatype">DataType</a></li>
<li><a href="#module">Module</a></li>
<li><a href="#bit">Bit</a></li>
<li><a href="#cycle">Cycle</a></li>
<li><a href="#files">Files</a></li>
<li><a href="#credential">Credential</a></li>
<li><a href="#winevent">WinEvent</a></li>
<li><a href="#firewall">Firewall</a></li>
<li><a href="#defender">Defender</a></li>
<li><a href="#windowsupdate">WindowsUpdate</a></li>
<li><a href="#dism">DISM</a></li>
<li><a href="#scheduled">Scheduled</a></li>
<li><a href="#network">Network</a></li>
<li><a href="#rdp">RDP</a></li>
<li><a href="#shutdown">Shutdown</a></li>
<li><a href="#localaccounts">LocalAccounts</a></li>
<li><a href="#smb">SMB</a></li>
<li><a href="#activedirectory">ActiveDirectory</a></li>
<li><a href="#repadmin">repadmin</a></li>
<li><a href="#dcdiag">dcdiag</a></li>
<li><a href="#ntdsutil">ntdsutil</a></li>
<li><a href="#gpo">GPO</a></li>
<li><a href="#servermanager">ServerManager</a></li>
<li><a href="#dnsserver">DNS</a></li>
<li><a href="#dhcpserver">DHCP</a></li>
<li><a href="#dfs">DFS</a></li>
<li><a href="#storagereplica">StorageReplica</a></li>
<li><a href="#ps2exe">PS2EXE</a></li>
<li><a href="#nssm">NSSM</a></li>
<li><a href="#jobs">Jobs</a></li>
<li><a href="#smtp">SMTP</a></li>
<li><a href="#hyper-v">Hyper-V</a></li>
<li><a href="#vmwarepowercli">VMWare/PowerCLI</a></li>
<li><a href="#exchangeemshell">Exchange/EMShell</a></li>
<li><a href="#truenas">TrueNAS</a></li>
<li><a href="#veeam">Veeam</a></li>
<li><a href="#rest-api">REST API</a></li>
<li><a href="#pode">Pode</a></li>
<li><a href="#selenium">Selenium</a></li>
<li><a href="#ie">IE</a></li>
<li><a href="#com">COM</a></li>
<li><a href="#dotnet">dotNET</a></li>
<li><a href="#console-api">Console API</a></li>
<li><a href="#drawing">Drawing</a></li>
<li><a href="#objectevent">ObjectEvent</a></li>
<li><a href="#sockets">Sockets</a></li>
<li><a href="#excel">Excel</a></li>
<li><a href="#csv">CSV</a></li>
<li><a href="#xml">XML</a></li>
<li><a href="#json">JSON</a></li>
<li><a href="#yaml">YAML</a></li>
<li><a href="#html">HTML</a></li>
<li><a href="#sqlite">SQLite</a></li>
<li><a href="#mysql">MySQL</a></li>
<li><a href="#mssql">MSSQL</a></li>
<li><a href="#influxdb">InfluxDB</a></li>
<li><a href="#telegraf">Telegraf</a></li>
<li><a href="#elasticsearch">Elasticsearch</a></li>
<li><a href="#cdata">CData</a></li>
<li><a href="#odbc">ODBC</a></li>
<li><a href="#postgresql">PostgreSQL</a></li>
<li><a href="#wmi">WMI</a></li>
<li><a href="#regedit">Regedit</a></li>
<li><a href="#performance">Performance</a></li>
<li><a href="#snmp">SNMP</a></li>
<li><a href="#zabbix">Zabbix</a></li>
<li><a href="#pki">pki</a></li>
<li><a href="#openssl">OpenSSL</a></li>
<li><a href="#openvpn">OpenVPN</a></li>
<li><a href="#route">Route</a></li>
<li><a href="#nat">NAT</a></li>
<li><a href="#wireguard">WireGuard</a></li>
<li><a href="#vpnclient">VpnClient</a></li>
<li><a href="#proxy">Proxy</a></li>
<li><a href="#netsh">netsh</a></li>
<li><a href="#openssh">OpenSSH</a></li>
<li><a href="#winrm">WinRM</a></li>
<li><a href="#packagemanagement">PackageManagement</a></li>
<li><a href="#nuget">NuGet</a></li>
<li><a href="#git">Git</a></li>
<li><a href="#dsc">DSC</a></li>
<li><a href="#ansible">Ansible</a></li>
<li><a href="#win_modules">Win_Modules</a></li>
<li><a href="#GigaChat">GigaChat</a></li>
<li><a href="#YandexGPT">YandexGPT</a></li>
<li><a href="#superagi">SuperAGI</a></li>
<li><a href="#replicate">Replicate</a></li>
<li><a href="#google-filter">Google-Filter</a></li>
<li><a href="#google-api">Google-API</a></li>
<li><a href="#rapidapi">RapidAPI</a></li>
<li><a href="#tmdb">TMDB</a></li>
<li><a href="#omdb">OMDb</a></li>
<li><a href="#ivi">ivi</a></li>
<li><a href="#kinopoisk">Kinopoisk</a></li>
<li><a href="#videocdn">VideoCDN</a></li>
<li><a href="#telegram">Telegram</a></li>
<li><a href="#discord">Discord</a></li>
<li><a href="#oh-my-posh">oh-my-posh</a></li>
<li><a href="#pester">Pester</a></li>
<li><a href="#pandoc">Pandoc</a></li>
<li><a href="#ffmpeg">FFmpeg</a></li>
<li><a href="#imagemagick">ImageMagick</a></li>
</ul>
<h1 id="help">Help</h1>
<p><code>Get-Verb</code> –¥–µ–π—Å—Ç–≤–∏—è/–≥–ª–∞–≥–æ–ª—ã, —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –¥–ª—è
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–º–∞–Ω–¥–ª–µ—Ç–∞—Ö<br />
<code>Get-Command *Language*</code> –ø–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥—ã –ø–æ –∏–º–µ–Ω–∏<br />
<code>(Get-Command Get-Language).Module</code> —É–∑–Ω–∞—Ç—å –∫ –∫–∞–∫–æ–º—É –º–æ–¥—É–ª—é
–ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫–æ–º–∞–Ω–¥–∞<br />
<code>Get-Command Get-Content | fl Module,DLL</code> —É–∑–Ω–∞—Ç—å
–ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥—ã –∫ –º–æ–¥—É–ª—é –∏ dll<br />
<code>Get-Command -Module LanguagePackManagement</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å
—Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è<br />
<code>(Get-Module LanguagePackManagement).ExportedCommands.Values</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è<br />
<code>Get-Language | Get-Member</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–µ—Ç–æ–¥–æ–≤ –∫–æ–º–∞–Ω–¥—ã
(–¥–µ–π—Å—Ç–≤–∏—è), –æ–±—ä–µ–∫—Ç—ã –≤—ã–≤–æ–¥–∞ –∏ Event (—Å–æ–±—ã—Ç–∏—è –æ–±—ä–µ–∫—Ç–æ–≤: Click)<br />
<code>(Get-Help Get-Service).Aliases</code> —É–∑–Ω–∞—Ç—å –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–º
–∫–æ–º–∞–Ω–¥—ã<br />
<code>Get-Alias gsv</code> —É–∑–Ω–∞—Ç—å –∏–º—è –∫–æ–º–∞–Ω–¥—ã –ø–æ –ø—Å–µ–≤–¥–æ–Ω–∏–º—É<br />
<code>Get-Help Get-Service</code> —Å–∏–Ω—Ç–∞–∫—Å–∏—Å<br />
<code>Get-Help Get-Service -Parameter *</code> –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö
–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤<br />
<code>Get-Help Get-Service -Online</code><br />
<code>Get-Help Get-Service -ShowWindow</code> –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ GUI
—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π<br />
<code>Show-Command</code> –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –≤ GUI<br />
<code>Show-Command Get-Service</code> —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–º–∞–Ω–¥—ã –≤
GUI<br />
<code>Invoke-Expression</code> iex –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤
–∫–æ–Ω—Å–æ–ª–∏ –∫–∞–∫ –∫–æ–º–∞–Ω–¥—ã<br />
<code>$PSVersionTable</code> –≤–µ—Ä—Å–∏—è PowerShell<br />
<code>Set-ExecutionPolicy Unrestricted</code><br />
<code>Get-ExecutionPolicy</code><br />
<code>$Metadata = New-Object System.Management.Automation.CommandMetaData (Get-Command Get-Service)</code>
–ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–∞–Ω–¥–ª–µ—Ç–µ<br />
<code>[System.Management.Automation.ProxyCommand]::Create($Metadata)</code>
–∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏</p>
<h1 id="object">Object</h1>
<h3 id="variable">Variable</h3>
<p><code>$var = Read-Host "Enter"</code> —Ä—É—á–Ω–æ–π –≤–≤–æ–¥<br />
<code>$pass = Read-Host "Enter Password" -AsSecureString</code> —Å–∫—Ä—ã–≤–∞—Ç—å
–Ω–∞–±–æ—Ä<br />
<code>$global:path = "\\path"</code> –∑–∞–¥–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é,
–Ω–∞–ø—Ä–∏–º–µ—Ä –≤ —Ñ—É–Ω–∫—Ü–∏–∏<br />
<code>$using:srv</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏ –≤
Invoke-—Å–µ—Å—Å–∏–∏<br />
<code>Get-Variable</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ<br />
<code>ls variable:/</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ<br />
<code>Get-Variable *srv*</code> –Ω–∞–π—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –ø–æ –∏–º–µ–Ω–∏<br />
<code>Get-Variable -Scope Global</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ
–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ<br />
<code>Get-Variable Error</code> –ø–æ—Å–ª–µ–¥–Ω—è—è –∫–æ–º–∞–Ω–¥–∞ —Å –æ—à–∏–±–∫–æ–π<br />
<code>Remove-Variable -Name *</code> –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ<br />
<code>$LASTEXITCODE</code> —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –≤—ã–≤–æ–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø—É—â–µ–Ω–Ω–æ–π
–ø—Ä–æ–≥—Ä–∞–º–º—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä ping. –ï—Å–ª–∏ –∫–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π (True), —Ç–æ
$LastExitCode = 0</p>
<h3 id="env">ENV</h3>
<p><code>Get-ChildItem Env:</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
–æ–∫—Ä—É–∂–µ–Ω–∏—è<br />
<code>$env:PSModulePath</code> –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π<br />
<code>$env:userprofile</code><br />
<code>$env:computername</code><br />
<code>$env:username</code><br />
<code>$env:userdnsdomain</code><br />
<code>$env:logonserver</code><br />
<code>([DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()).Name</code><br />
<code>[Environment]::GetFolderPath('ApplicationData')</code></p>
<h3 id="history">History</h3>
<p><code>Get-History</code> –∏—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏<br />
<code>(Get-History)[-1].Duration.TotalSeconds</code> –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
–ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã<br />
<code>(Get-PSReadLineOption).HistorySavePath</code> –ø—É—Ç—å –∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–º—É
—Ñ–∞–π–ª—É —Å 4096 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ (–∏–∑ –º–æ–¥—É–ª—è PSReadLine)<br />
<code>Get-Content (Get-PSReadlineOption).HistorySavePath | Select-String Get</code>
–ø–æ–∏—Å–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É —Ñ–∞–π–ª–∞ (GREP)<br />
<code>Set-PSReadlineOption -MaximumHistoryCount 10000</code> –∏–∑–º–µ–Ω–∏—Ç—å
–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã—Ö –∫–æ–º–∞–Ω–¥ –≤ —Ñ–∞–π–ª<br />
<code>Get-PSReadLineOption | select MaximumHistoryCount</code><br />
<code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code>
–æ—Ç–∫–ª—é—á–∏—Ç—å –≤–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞<br />
<code>F2</code> –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è —Å InlineView –Ω–∞ ListView</p>
<h3 id="clipboard">Clipboard</h3>
<p><code>Set-Clipboard $srv</code> —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞<br />
<code>Get-Clipboard</code> –≤—Å—Ç–∞–≤–∏—Ç—å</p>
<h3 id="write">Write</h3>
<p><code>Write-Host -ForegroundColor Black -BackgroundColor Green "Test" -NoNewline</code><br />
<code>Write-Error Test</code><br />
<code>Foreach ($n in 1..100) {Write-Progress -Activity "Test Progress" -PercentComplete $n}</code></p>
<h3 id="array">Array</h3>
<p><code>$srv = @("server-01", "server-02")</code> —Å–æ–∑–¥–∞—Ç—å –º–∞—Å—Å–∏–≤<br />
<code>$srv += @("server-03")</code> –¥–æ–±–∞–≤–∏—Ç—å –≤ –º–∞—Å—Å–∏–≤ –Ω–æ–≤—ã–π
—ç–ª–µ–º–µ–Ω—Ç<br />
<code>$srv.Count</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–æ–ª-–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ<br />
<code>Out-String</code> –ø–æ—Å—Ç—Ä–æ—á–Ω—ã–π –≤—ã–≤–æ–¥</p>
<h3 id="index">Index</h3>
<p><code>$srv[0]</code> –≤—ã–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –º–∞—Å—Å–∏–≤–∞<br />
<code>$srv[0] = Name</code> –∑–∞–º–µ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –º–∞—Å—Å–∏–≤–µ<br />
<code>$srv[0].Length</code> —É–∑–Ω–∞—Ç—å –∫–æ–ª-–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –ø–µ—Ä–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤
–º–∞—Å—Å–∏–≤–µ<br />
<code>$srv[10..100]</code> —Å—Ä–µ–∑</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="va">$array</span> <span class="op">=</span> <span class="st">&quot;a&quot;</span><span class="op">,</span><span class="st">&quot;b&quot;</span><span class="op">,</span><span class="st">&quot;c&quot;</span><span class="op">,</span><span class="st">&quot;d&quot;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="va">$num</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dt">foreach</span> <span class="op">(</span><span class="va">$a</span> <span class="kw">in</span> <span class="va">$array</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="va">$num</span> <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="va">$index</span> <span class="op">=</span> <span class="op">[</span>array<span class="op">]::</span>IndexOf<span class="op">(</span><span class="va">$array</span><span class="op">,</span> <span class="va">$a</span><span class="op">)</span> <span class="co"># —É–∑–Ω–∞—Ç—å –Ω–æ–º–µ—Ä –∏–Ω–¥–µ–∫—Å–∞ –ø–æ –∑–∞—á–µ–Ω–∏—é</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="va">$array</span><span class="op">[</span><span class="va">$index</span><span class="op">]</span> <span class="op">=</span> <span class="va">$num</span> <span class="co"># –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="hashtable">HashTable</h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="va">$hashtable</span> <span class="op">=</span> @<span class="op">{</span><span class="st">&quot;User&quot;</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">username</span><span class="st">&quot;</span><span class="op">;</span> <span class="st">&quot;Server&quot;</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">computername</span><span class="st">&quot;</span><span class="op">}</span> <span class="co"># —Å–æ–∑–¥–∞—Ç—å</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="va">$hashtable</span> <span class="op">+=</span> @<span class="op">{</span><span class="st">&quot;User2&quot;</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">username</span><span class="st">&quot;</span><span class="op">;</span> <span class="st">&quot;Server2&quot;</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">computername</span><span class="st">&quot;</span><span class="op">}</span> <span class="co"># –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á–∏</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="va">$hashtable</span><span class="op">.</span><span class="fu">Keys</span> <span class="co"># —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–ª—é—á–µ–π</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="va">$hashtable</span><span class="op">[</span><span class="st">&quot;User&quot;</span><span class="op">]</span> <span class="co"># –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (Values) –ø–æ –∫–ª—é—á—É</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="va">$hashtable</span><span class="op">[</span><span class="st">&quot;User&quot;</span><span class="op">]</span> <span class="op">=</span> <span class="st">&quot;Test&quot;</span> <span class="co"># –∏–∑–º–µ–Ω–∏—Ç—å</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="va">$hashtable</span><span class="op">.</span><span class="fu">Remove</span><span class="op">(</span><span class="st">&quot;User&quot;</span><span class="op">)</span> <span class="co"># —É–¥–∞–ª–∏—Ç—å –∫–ª—é—á</span></span></code></pre></div>
<p><code>$Tag = @{$true = 'dev'; $false = 'prod'}[([System.Net.Dns]::GetHostEntry("localhost").HostName) -match '.*.TestDomain$']</code></p>
<h3 id="collectionslist">Collections/List</h3>
<div class="sourceCode" id="cb3"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="va">$Collections</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Collections</span><span class="op">.</span><span class="fu">Generic</span><span class="op">.</span><span class="fu">List</span><span class="op">[</span>System<span class="op">.</span><span class="fu">Object</span><span class="op">]</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Collections</span><span class="op">.</span><span class="fu">Add</span><span class="op">([</span>PSCustomObject<span class="op">]</span>@<span class="op">{</span>User <span class="op">=</span> <span class="va">$env</span><span class="op">:</span><span class="va">username</span><span class="op">;</span> Server <span class="op">=</span> <span class="va">$env</span><span class="op">:</span><span class="va">computername</span><span class="op">})</span></span></code></pre></div>
<h3 id="pscustomobject">PSCustomObject</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="va">$CustomObject</span> <span class="op">=</span> <span class="op">[</span>PSCustomObject<span class="op">][</span>ordered<span class="op">]</span>@<span class="op">{</span>User <span class="op">=</span> <span class="va">$env</span><span class="op">:</span><span class="va">username</span><span class="op">;</span> Server <span class="op">=</span> <span class="va">$env</span><span class="op">:</span><span class="va">computername</span><span class="op">}</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="va">$CustomObject</span> <span class="op">|</span> <span class="fu">Add-Member</span> ‚ÄìMemberType NoteProperty ‚ÄìName Arr ‚ÄìValue <span class="op">@(</span><span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">)</span> <span class="co"># –¥–æ–±–∞–≤–∏—Ç—å Property (—Å–≤–æ–π—Å—Ç–≤–æ/—Å—Ç–æ–±–µ—Ü)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="va">$CustomObject</span><span class="op">.</span><span class="fu">Arr</span> <span class="op">=</span> <span class="op">@(</span><span class="dv">1</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">5</span><span class="op">)</span> <span class="co"># –∏–∑–º–µ–Ω–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="va">$CustomObject</span><span class="op">.</span><span class="fu">PsObject</span><span class="op">.</span><span class="fu">Properties</span><span class="op">.</span><span class="fu">Remove</span><span class="op">(</span><span class="st">&#39;User&#39;</span><span class="op">)</span> <span class="co"># —É–¥–∞–ª–∏—Ç—å Property</span></span></code></pre></div>
<h3 id="add-member">Add-Member</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="va">$ScriptBlock</span> <span class="op">=</span> <span class="op">{</span><span class="fu">Get-Service</span><span class="op">}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="va">$CustomObject</span> <span class="op">|</span> <span class="fu">Add-Member</span> <span class="op">-</span>Name <span class="st">&quot;TestMethod&quot;</span> <span class="op">-</span>MemberType ScriptMethod <span class="op">-</span>Value <span class="va">$ScriptBlock</span> <span class="co"># –î–æ–±–∞–≤–∏—Ç—å Method</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="va">$CustomObject</span> <span class="op">|</span> <span class="fu">Get-Member</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="va">$CustomObject</span><span class="op">.</span><span class="fu">TestMethod</span><span class="op">()</span></span></code></pre></div>
<h3 id="class">Class</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cf">Class</span> CustomClass <span class="op">{</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$User</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$Server</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Start</span><span class="op">([</span><span class="dt">bool</span><span class="op">]</span><span class="va">$Param1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">If</span> <span class="op">(</span><span class="va">$Param1</span><span class="op">)</span> <span class="op">{</span><span class="fu">Write-Host</span> <span class="st">&quot;Start Function&quot;</span><span class="op">}}</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="va">$Class</span> <span class="op">=</span> <span class="fu">New-Object</span> <span class="op">-</span>TypeName CustomClass</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="va">$Class</span><span class="op">.</span><span class="fu">User</span> <span class="op">=</span> <span class="va">$env</span><span class="op">:</span><span class="va">username</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="va">$Class</span><span class="op">.</span><span class="fu">Server</span> <span class="op">=</span> <span class="va">$env</span><span class="op">:</span><span class="va">computername</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="va">$Class</span><span class="op">.</span><span class="fu">Start</span><span class="op">(</span><span class="dv">1</span><span class="op">)</span></span></code></pre></div>
<h3 id="pipeline">Pipeline</h3>
<p><code>$obj | Add-Member -MemberType NoteProperty -Name "Type" -Value "user" -Force</code>
–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–∫—Ç–∞ –≤—ã–≤–æ–¥–∞ NoteProperty<br />
<code>$obj | Add-Member -MemberType NoteProperty -Name "User" -Value "admin" -Force</code>
–∏–∑–º–µ–Ω–µ–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–ª—è —Å—É—â–Ω–æ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç–∞ User<br />
<code>ping $srv | Out-Null</code> –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–≤–æ–¥–∞ –≤
Out-Null</p>
<h3 id="select-object">Select-Object</h3>
<p><code>Get-Process | Select-Object -Property *</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ
–¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –≤—ã–≤–æ–¥–∞<br />
<code>Get-Process | select -Unique "Name"</code> —É–¥–∞–ª–∏—Ç—å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è
–∑–Ω–∞—á–µ–Ω–∏—è –≤ –º–∞—Å—Å–∏–≤–µ<br />
<code>Get-Process | select -ExpandProperty ProcessName</code>
–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∏–∑ –æ–±—ä–µ–∫—Ç–∞-–∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ –º–∞—Å—Å–∏–≤ (–≤—ã–≤–µ—Å—Ç–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–µ–∑
–Ω–∞–∏–º–µ–Ω–æ–≤–∞—è —Å—Ç–æ–ª–±—Ü–∞)<br />
<code>(Get-Process | ? Name -match iperf).Modules</code> —Å–ø–∏—Å–æ–∫
–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –º–æ–¥—É–ª–µ–π –ø—Ä–æ—Ü–µ—Å—Å–æ–º</p>
<h3 id="expression">Expression</h3>
<div class="sourceCode" id="cb7"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ps</span> <span class="op">|</span> <span class="fu">Sort-Object</span> <span class="op">-</span>Descending CPU <span class="op">|</span> <span class="fu">select</span> <span class="op">-</span>first <span class="dv">10</span> ProcessName<span class="op">,</span> <span class="co"># —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ CPU, –≤—ã–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤—ã—Ö 10 –∑–Ω–∞—á–µ–Ω–∏–π (-first)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>@<span class="op">{</span>Name<span class="op">=</span><span class="st">&quot;ProcessorTime&quot;</span><span class="op">;</span> Expression<span class="op">={</span><span class="va">$_</span><span class="op">.</span><span class="fu">TotalProcessorTime</span> <span class="op">-replace</span> <span class="st">&quot;\.\d+$&quot;</span><span class="op">}},</span> <span class="co"># –∑–∞—Ç—Ä–∞—á–µ–Ω–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ –º–∏–Ω—É—Ç–∞—Ö</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>@<span class="op">{</span>Name<span class="op">=</span><span class="st">&quot;Memory&quot;</span><span class="op">;</span> Expression<span class="op">={[</span><span class="dt">string</span><span class="op">]([</span><span class="dt">int</span><span class="op">](</span><span class="va">$_</span><span class="op">.</span><span class="fu">WS</span> <span class="op">/</span> <span class="dv">1024</span><span class="dt">kb</span><span class="op">))+</span><span class="st">&quot;MB&quot;</span><span class="op">}},</span> <span class="co"># –¥–µ–ª–∏–º –±–∞–π—Ç—ã –Ω–∞ –ö–ë</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>@<span class="op">{</span>Label<span class="op">=</span><span class="st">&quot;RunTime&quot;</span><span class="op">;</span> Expression<span class="op">={((</span><span class="fu">Get-Date</span><span class="op">)</span> <span class="op">-</span> <span class="va">$_</span><span class="op">.</span><span class="fu">StartTime</span><span class="op">)</span> <span class="op">-replace</span> <span class="st">&quot;\.\d+$&quot;</span><span class="op">}}</span> <span class="co"># –≤—ã—á–µ—Å—Ç—å –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ - –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞, –∏ —É–¥–∞–ª–∏—Ç—å milisec</span></span></code></pre></div>
<h3 id="select-string">Select-String</h3>
<p><code>$(ipconfig | Select-String IPv4) -replace ".+: " | Where-Object {$_ -match "^172."}</code>
—É–∑–Ω–∞—Ç—å —Ç–æ–ª—å–∫–æ IP<br />
<code>$Current_IP = Get-Content $RDCMan_RDG_PATH | Select-String $RDCMan_Display_Name -Context 0,1</code>
–ø–æ–ª—É—á–∏—Ç—å –¥–≤–µ —Å—Ç—Ä–æ–∫–∏<br />
<code>$Current_IP = $Current_IP.Context.DisplayPostContext[0] -replace ".+&lt;name&gt;|&lt;\/name&gt;"</code>
–∑–∞–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤—Ç–æ—Ä—É—é —Å—Ç—Ä–æ–∫—É –∏ —É–¥–∞–ª–∏—Ç—å —Ç—ç–≥–∏</p>
<h3 id="format-tableformat-list">Format-Table/Format-List</h3>
<p><code>Get-Process | ft ProcessName, StartTime -Autosize</code>
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Å—Ç–æ–ª–±—Ü–æ–≤</p>
<h3 id="measure-object">Measure-Object</h3>
<p><code>Get-Process | Measure | select Count</code> –∫–æ–ª-–≤–æ
–æ–±—ä–µ–∫—Ç–æ–≤<br />
<code>Get-Process | Measure -Line -Word -Character</code> –∫–æ–ª-–≤–æ —Å—Ç—Ä–æ–∫,
—Å–ª–æ–≤ –∏ Char –æ–±—ä–µ–∫—Ç–æ–≤<br />
<code>Get-Process | Measure-Object PM -sum | Select-Object Count,@{Name="MEM_MB"; Expression={[int]($_.Sum/1mb)}}</code>
–∫–æ–ª-–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –æ–±—â–∏–π –æ–±—ä–µ–º –∑–∞–Ω—è—Ç–æ–π –ø–∞–º—è—Ç–∏ –≤ –ú–ë–∞–π—Ç</p>
<h3 id="compare-object">Compare-Object</h3>
<p><code>Compare-Object -ReferenceObject (Get-Content -Path .\file1.txt) -DifferenceObject (Get-Content -Path .\file2.txt)</code>
—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö —Ñ–∞–π–ª–æ–≤<br />
<code>$group1 = Get-ADGroupMember -Identity "Domain Admins"</code><br />
<code>$group2 = Get-ADGroupMember -Identity "Enterprise Admins"</code><br />
<code>Compare-Object -ReferenceObject $group1 -DifferenceObject $group2 -IncludeEqual</code>
<code>==</code> –Ω–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π<br />
<code>&lt;=</code> –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ $group1<br />
<code>=&gt;</code> –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ $group2</p>
<h3 id="where-object">Where-Object (?)</h3>
<p><code>Get-Process | Where-Object {$_.ProcessName -match "zabbix"}</code>
—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è/–ø–æ–∏—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ –∏–º–µ–Ω–∏ —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–∞<br />
<code>Get-Process | where CPU -gt 10 | Sort-Object -Descending CPU</code>
–≤—ã–≤–µ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç—ã, –≥–¥–µ –∑–Ω–∞—á–µ–Ω–∏—è CPU –±–æ–ª—å—à–µ 10<br />
<code>Get-Process | where WS -gt 200MB</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –≥–¥–µ WS
–≤—ã—à–µ 200–ú–ë<br />
<code>Get-Service | where Name -match "zabbix"</code> –ø–æ–∏—Å–∫ —Å–ª—É–∂–±—ã<br />
<code>Get-Service -ComputerName $srv | Where {$_.Name -match "WinRM"} | Restart-Service</code>
–ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ<br />
<code>(Get-Service).DisplayName</code> –≤—ã–≤–µ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤–∞
–º–∞—Å—Å–∏–≤–∞<br />
<code>netstat -an | where {$_ -match 443}</code><br />
<code>netstat -an | ?{$_ -match 443}</code><br />
<code>(netstat -an) -match 443</code></p>
<h3 id="sort-object">Sort-Object</h3>
<p><code>Get-Process | Sort-Object -Descending CPU | ft</code> –æ–±—Ä–∞—Ç–Ω–∞—è
(-Descending) —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ CPU<br />
<code>$path[-1..-10]</code> –æ–±—Ä–∞—Ç–Ω–∞—è —Å–±–æ—Ä–∫–∞ –º–∞—Å—Å–∏–≤–∞ –±–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</p>
<h3 id="lastfirst">Last/First</h3>
<p><code>Get-Process | Sort-Object -Descending CPU | select -First 10</code>
–≤—ã–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤—ã—Ö 10 –æ–±—ä–µ–∫—Ç–æ–≤<br />
<code>Get-Process | Sort-Object -Descending CPU | select -Last 10</code>
–≤—ã–≤–µ—Å—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 –æ–±—ä–µ–∫—Ç–æ–≤</p>
<h3 id="group-object">Group-Object</h3>
<div class="sourceCode" id="cb8"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="va">$Groups</span> <span class="op">=</span> <span class="fu">Get-CimInstance</span> <span class="op">-</span>Class Win32_PnPSignedDriver <span class="op">|</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Select-Object</span> DriverProviderName<span class="op">,</span> FriendlyName<span class="op">,</span> Description<span class="op">,</span> DriverVersion<span class="op">,</span> DriverDate <span class="op">|</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Group-Object</span> DriverProviderName<span class="op">,</span> FriendlyName<span class="op">,</span> Description<span class="op">,</span> DriverVersion<span class="op">,</span> DriverDate</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="op">$(</span><span class="cf">foreach</span> <span class="op">(</span><span class="va">$Group</span> <span class="kw">in</span> <span class="va">$Groups</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">$Group</span><span class="op">.</span><span class="fu">Group</span><span class="op">[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="op">})</span> <span class="op">|</span> <span class="fu">Format-Table</span></span></code></pre></div>
<h3 id="error">Error</h3>
<p><code>$Error</code> –≤—ã–≤–æ–¥–∏—Ç –≤—Å–µ –æ—à–∏–±–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ —Å–µ–∞–Ω—Å–∞<br />
<code>$Error[0].InvocationInfo</code> —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç—á–µ—Ç –æ–± –æ—à–∏–±–∫–µ<br />
<code>$Error.clear()</code><br />
<code>$LASTEXITCODE</code> —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã (0 -
—É—Å–ø–µ—Ö)<br />
<code>exit 1</code> –∫–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è
$LASTEXITCODE</p>
<h3 id="property">Property</h3>
<p><code>$srv.Count</code> –∫–æ–ª-–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ<br />
<code>$srv.Length</code> —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–º —Å—Ç—Ä–æ–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
[string] –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π (—Å—Ç—Ä–æ–∫) –æ–±—ä–µ–∫—Ç–∞<br />
<code>$srv.Chars(2)</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å 3-–π —Å–∏–º–≤–æ–ª –≤ —Å—Ç—Ä–æ–∫–µ<br />
<code>$srv[2]</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å 3-—é —Å—Ç—Ä–æ–∫—É –≤ –º–∞—Å—Å–∏–≤–µ</p>
<h3 id="method">Method</h3>
<p><code>$srv.Insert(0,"https://")</code> –¥–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º
—Å–∏–º–≤–æ–ª–æ–º<br />
<code>$srv.Substring(4)</code> —É–¥–∞–ª–∏—Ç—å (–∏–∑ –≤—Å–µ–≥–æ –º–∞—Å—Å–∏–≤–∞) –ø–µ—Ä–≤—ã–µ 4
—Å–∏–º–≤–æ–ª–∞<br />
<code>$srv.Remove(3)</code> —É–¥–∞–ª–∏—Ç—å –∏–∑ –≤—Å–µ–≥–æ –º–∞—Å—Å–∏–≤–∞ –≤—Å–µ –ø–æ—Å–ª–µ 3
—Å–∏–º–≤–æ–ª–∞<br />
<code>$string = "123"</code> —Å–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–æ–∫—É<br />
<code>$int = [convert]::ToInt32($string)</code> –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É –≤
—Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö —á–∏—Å–ª–æ<br />
<code>[string]::Concat($text,$num)</code> –æ–±—ä–µ–¥–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –æ–¥–Ω—É
—Å—Ç—Ä–æ–∫—É<br />
<code>[string]::Join(":",$text,$num)</code> –æ–±—ä–µ–¥–µ–Ω–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É—è
—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å<br />
<code>[string]::Compare($text,$num,$true)</code> –≤—ã–¥–∞–µ—Ç 0 –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏
–∏–ª–∏ 1/-1 –ø—Ä–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏, $true (–±–µ–∑ —É—á–µ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞) –∏–ª–∏ <span
class="math inline">$false (—Å —É—á–µ—Ç–æ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞) \
`[string]::Equals($</span>text,$num)<code>–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö —Å—Ç—Ä–æ–∫ –∏ –≤—ã–¥–∞–µ—Ç $true –ø—Ä–∏ –∏—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∏–ª–∏ $false –ø—Ä–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ \</code>[string]::IsNullOrEmpty($text)<code>–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –ø—É—Å—Ç–∞ $true, –µ—Å–ª–∏ –Ω–µ—Ç $false \</code>[string]::IsNullOrWhiteSpace($text2)`
–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª–æ–≤ –ø—Ä–æ–±–µ–ª, —Ç–∞–±—É–ª—è—Ü–∏—è –∏–ª–∏ —Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–π
—Å—Ç—Ä–æ–∫–∏</p>
<h3 id="datetime">DateTime</h3>
<p><code>Get-TimeZone</code> —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å<br />
<code>[DateTime]::UtcNow</code> –≤—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ UTC 0<br />
<code>(Get-Date).AddHours(-3)</code><br />
<code>$Date = (Get-Date -Format "dd/MM/yyyy hh:mm:ss")</code><br />
<code>$Date = Get-Date -f "dd/MM/yyyy"</code> –ø–æ–ª—É—á–∞–µ–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö
[string]<br />
<code>[DateTime]$gDate = Get-Date "$Date"</code> –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —Ç–∏–ø <a
href="#datetime">DateTime</a><br />
<code>[int32]$days=($fDate-$gDate).Days</code> –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –≤
–¥–Ω—è—Ö<br />
<code>"5/7/07" -as [DateTime]</code> –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∏–ø
–¥–∞–Ω–Ω—ã—Ö <a href="#datetime">DateTime</a><br />
<code>New-TimeSpan -Start $VBRRP.CreationTimeUTC -End $VBRRP.CompletionTimeUTC</code>
–ø–æ–ª—É—á–∏—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –≤–æ –≤—Ä–µ–º–µ–Ω–∏</p>
<h3 id="measure-command">Measure-Command</h3>
<p><code>(Measure-Command {ping ya.ru}).TotalSeconds</code> —É–∑–Ω–∞—Ç—å
—Ç–æ–ª—å–∫–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è<br />
<code>(Get-History)[-1] | select @{Name="RunTime"; Expression={$_.EndExecutionTime - $_.StartExecutionTime}},ExecutionStatus,CommandLine</code>
–ø–æ—Å—á–∏—Ç–∞—Ç—å –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–π [-1] (select -Last 1) –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π
–∫–æ–º–∞–Ω–¥—ã –∏ —É–∑–Ω–∞—Ç—å –µ–µ —Å—Ç–∞—Ç—É—Å</p>
<h3 id="timer">Timer</h3>
<p><code>$start_time = Get-Date</code> –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
–∫–æ–º–∞–Ω–¥—ã<br />
<code>$end_time = Get-Date</code> –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –ø–æ
–∑–∞–≤–µ—Ä—à–µ–Ω–∏—é<br />
<code>$time = $end_time - $start_time</code> –≤—ã—Å—á–∏—Ç–∞—Ç—å –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã
—Å–∫—Ä–∏–ø—Ç–∞<br />
<code>$min = $time.minutes</code><br />
<code>$sec = $time.seconds</code><br />
<code>Write-Host "$min –º–∏–Ω—É—Ç $sec —Å–µ–∫—É–Ω–¥"</code><br />
<code>$timer = [System.Diagnostics.Stopwatch]::StartNew()</code>
–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–∞–π–º–µ—Ä<br />
<code>$timer.IsRunning</code> —Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã —Ç–∞–π–º–µ—Ä–∞<br />
<code>$timer.Elapsed.TotalSeconds</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Ä–µ–º—è —Å –º–æ–º–µ–Ω—Ç–∞
–∑–∞–ø—É—Å–∫–∞ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)<br />
<code>$timer.Stop()</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä</p>
<h1 id="npp">npp</h1>
<p><code>pwsh -NoExit -ExecutionPolicy Unrestricted -WindowStyle Maximized -File "$(FULL_CURRENT_PATH)"</code></p>
<p><code>%AppData%\Notepad++</code> themes/shortcuts.xml<br />
</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode xml"><code class="sourceCode xml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">&lt;?xml</span><span class="ot"> version=</span><span class="st">&quot;1.0&quot;</span><span class="ot"> encoding=</span><span class="st">&quot;UTF-8&quot;</span> <span class="fu">?&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">NotepadPlus</span>&gt;</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">InternalCommands</span> /&gt;</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">Macros</span>&gt;</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">Macro</span><span class="ot"> name=</span><span class="st">&quot;`+\+</span><span class="dv">&amp;gt;</span><span class="st">&quot;</span><span class="ot"> Ctrl=</span><span class="st">&quot;yes&quot;</span><span class="ot"> Alt=</span><span class="st">&quot;no&quot;</span><span class="ot"> Shift=</span><span class="st">&quot;no&quot;</span><span class="ot"> Key=</span><span class="st">&quot;190&quot;</span>&gt;</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">Action</span><span class="ot"> type=</span><span class="st">&quot;0&quot;</span><span class="ot"> message=</span><span class="st">&quot;2453&quot;</span><span class="ot"> wParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> lParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> sParam=</span><span class="st">&quot;&quot;</span> /&gt;</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">Action</span><span class="ot"> type=</span><span class="st">&quot;1&quot;</span><span class="ot"> message=</span><span class="st">&quot;2170&quot;</span><span class="ot"> wParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> lParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> sParam=</span><span class="st">&quot;`&quot;</span> /&gt;</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">Action</span><span class="ot"> type=</span><span class="st">&quot;0&quot;</span><span class="ot"> message=</span><span class="st">&quot;2451&quot;</span><span class="ot"> wParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> lParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> sParam=</span><span class="st">&quot;&quot;</span> /&gt;</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">Action</span><span class="ot"> type=</span><span class="st">&quot;0&quot;</span><span class="ot"> message=</span><span class="st">&quot;2451&quot;</span><span class="ot"> wParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> lParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> sParam=</span><span class="st">&quot;&quot;</span> /&gt;</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">Action</span><span class="ot"> type=</span><span class="st">&quot;1&quot;</span><span class="ot"> message=</span><span class="st">&quot;2170&quot;</span><span class="ot"> wParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> lParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> sParam=</span><span class="st">&quot; &quot;</span> /&gt;</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">Action</span><span class="ot"> type=</span><span class="st">&quot;1&quot;</span><span class="ot"> message=</span><span class="st">&quot;2170&quot;</span><span class="ot"> wParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> lParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> sParam=</span><span class="st">&quot;\&quot;</span> /&gt;</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">Action</span><span class="ot"> type=</span><span class="st">&quot;0&quot;</span><span class="ot"> message=</span><span class="st">&quot;2300&quot;</span><span class="ot"> wParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> lParam=</span><span class="st">&quot;0&quot;</span><span class="ot"> sParam=</span><span class="st">&quot;&quot;</span> /&gt;</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">Macro</span>&gt;</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">Macros</span>&gt;</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">UserDefinedCommands</span>&gt;</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">Command</span><span class="ot"> name=</span><span class="st">&quot;PowerShell7&quot;</span><span class="ot"> Ctrl=</span><span class="st">&quot;no&quot;</span><span class="ot"> Alt=</span><span class="st">&quot;yes&quot;</span><span class="ot"> Shift=</span><span class="st">&quot;no&quot;</span><span class="ot"> Key=</span><span class="st">&quot;116&quot;</span>&gt;pwsh -NoExit -ExecutionPolicy Unrestricted -WindowStyle Maximized -File <span class="dv">&amp;quot;</span>$(FULL_CURRENT_PATH)<span class="dv">&amp;quot;</span>&lt;/<span class="kw">Command</span>&gt;</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">UserDefinedCommands</span>&gt;</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">PluginCommands</span> /&gt;</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">ScintillaKeys</span> /&gt;</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">NotepadPlus</span>&gt;</span></code></pre></div>
<p><code>Parsing text to Markdown:</code><br />
<code>Macros: FnLeft+'+FnRight+FnRight+\s\\+Down</code><br />
<code>Replace: "# ","'"</code></p>
<pre><code>.       # –û–±–æ–∑–Ω–∞—á–∞–µ—Ç –ª—é–±–æ–π —Å–∏–º–≤–æ–ª
\       # –≠–∫—Ä–∞–Ω–∏—Ä—É—é—â–∏–π —Å–∏–º–≤–æ–ª. –°–∏–º–≤–æ–ª—ã –∫–æ—Ç–æ—Ä—ã–µ —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è: ^, [, ., $, {, *, (, ), \, +, |, ?, &lt;, &gt;
^       # –ù–∞—á–∞–ª–æ —Å—Ç—Ä–æ–∫–∏
$       # –ö–æ–Ω–µ—Ü —Å—Ç—Ä–æ–∫–∏
\n      # –ù–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞
\d      # –õ—é–±–∞—è —Ü–∏—Ñ—Ä–∞
\D      # –ù–µ —Ü–∏—Ñ—Ä–∞
\w      # –õ—é–±–∞—è –±—É–∫–≤–∞ –ª–∞—Ç–∏–Ω–∏—Ü—ã, —Ü–∏—Ñ—Ä–∞, –∏–ª–∏ –∑–Ω–∞–∫ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏—è
\W      # –ù–µ –ª–∞—Ç–∏–Ω–∏—Ü–∞, –Ω–µ —Ü–∏—Ñ—Ä–∞, –Ω–µ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ
\s      # –ü—Ä–æ–±–µ–ª, —Ç–∞–±—É–ª—è—Ü–∏—è, –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏
\S      # –ù–µ –ø—Ä–æ–±–µ–ª
\b      # –ì—Ä–∞–Ω–∏—Ü–∞ —Å–ª–æ–≤–∞. –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å, —á—Ç–æ –∏—Å–∫–æ–º—ã–µ —Å–∏–º–≤–æ–ª—ã —è–≤–ª—è—é—Ç—Å—è —Å–ª–æ–≤–æ–º, –∞ –Ω–µ —á–∞—Å—Ç—å—é –¥—Ä—É–≥–æ–≥–æ —Å–ª–æ–≤–∞
\B      # –ù–µ –≥—Ä–∞–Ω–∏—Ü–∞ —Å–ª–æ–≤–∞
\&lt;      # –ù–∞—á–∞–ª–æ —Å–ª–æ–≤–∞
\&gt;      # –ö–æ–Ω–µ—Ü —Å–ª–æ–≤–∞
\A      # –ù–∞—á–∞–ª–æ —Ç–µ–∫—Å—Ç–∞
\Z      # –ö–æ–Ω–µ—Ü —Ç–µ–∫—Å—Ç–∞
*       # –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ–ª—å. –û–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–∏–π —Å–∏–º–≤–æ–ª –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å 0 –∏ –±–æ–ª–µ–µ —Ä–∞–∑
+       # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–µ–≥–æ –Ω–µ –º–µ–Ω–µ–µ 1-–≥–æ.
?       # –û–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å. –ù–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞
|       # –ò–ª–∏. –°–æ–µ–¥–∏–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
()      # –í –∫—Ä—É–≥–ª—ã–µ —Å–∫–æ–±–∫–∏ –∑–∞–∫–ª—é—á–∞—é—Ç—Å—è –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å &quot;–∏–ª–∏&quot; –∏ –ø–æ–∏—Å–∫ –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ —Å—Ç—Ä–æ–∫
[ ]     # –í –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö –∑–∞–¥–∞—é—Ç—Å—è —Å–∏–º–≤–æ–ª—ã –∫ –ø–æ–∏—Å–∫—É, –Ω–∞–ø—Ä–∏–º–µ—Ä [a-—è–ê-–Ø], –∏–ª–∏ [0-9]
[^ ]    # –ò—Å–∫–ª—é—á–∞–µ—Ç –∏–∑ –ø–æ–∏—Å–∫–∞ —Å–∏–º–≤–æ–ª—ã —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö
{ }     # –í —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π
\d{2}   # –ù–∞–π—Ç–∏ –¥–≤–µ —Ü–∏—Ñ—Ä—ã
\d{2,4} # –ù–∞–π—Ç–∏ –¥–≤–µ –∏–ª–∏ —á–µ—Ç—ã—Ä–µ
{4,}    # –ù–∞–π—Ç–∏ —á–µ—Ç—ã—Ä–µ –∏ –±–æ–ª–µ–µ

^\s{1,}#.+` –ø–æ–∏—Å–∫ –≤–Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –∏ –ø—Ä–æ–±–µ–ª –ø–æ—Å–ª–µ –Ω–µ–≥–æ 1 –∏–ª–∏ –±–æ–ª—å—à–µ –∏ –ª—é–±–æ–µ –∫–æ–ª-–≤–æ —Å–∏–º–≤–æ–ª–æ–≤</code></pre>
<h1 id="regex">Regex</h1>
<p><code>-replace "1","2"</code> –∑–∞–º–µ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∏–Ω–¥–µ–∫—Å–∞—Ö –º–∞—Å—Å–∏–≤–∞
(–≤–µ–∑–¥–µ –≥–¥–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç 1, –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ 2), –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ<br />
<code>-split " "</code> –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É –≤ –º–∞—Å—Å–∏–≤, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º
—É–∫–∞–∑–∞–Ω –ø—Ä–æ–±–µ–ª, –∫–æ—Ç–æ—Ä–æ–π —É–¥–∞–ª—è–µ—Ç—Å—è ($url.Split(‚Äú/‚Äù)[-1])<br />
<code>-join " "</code> –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ (–∫–æ–ª–ª–µ–∫—Ü–∏—é) –≤ –µ–¥–∏–Ω—É—é —Å—Ç—Ä–æ–∫—É
(string), –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º –ø—Ä–æ–±–µ–ª<br />
</p>
<p><code>-like *txt*</code> –ø–æ–∏—Å–∫ –ø–æ –º–∞—Å–∫–∞–º wildcard, –≤—ã–≤–æ–¥–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ
–Ω–∞ —ç–∫—Ä–∞–Ω<br />
<code>-match txt</code> –ø–æ–∏—Å–∫–∞ –ø–æ —à–∞–±–ª–æ–Ω–∞–º, –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞<br />
<code>-match "zabbix|rpc"</code> —É—Å–ª–æ–≤–∏—è, –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º
—Å–ª–æ–≤–∞–º<br />
<code>-NotMatch</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è<br />
</p>
<h3 id="matches">Matches</h3>
<p><code>$ip = "192.168.10.1"</code><br />
<code>$ip -match "(\.\d{1,3})\.\d{1,2}"</code> True<br />
<code>$Matches</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ
–ø–æ–∏—Å–∫–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤—Ö–æ–¥—è—Ç –∏ –Ω–µ –≤—Ö–æ–¥—è—Ç –≤ –≥—Ä—É–ø–ø—ã ()</p>
<p><code>$String = "09/14/2017 12:00:27 - mtbill_post_201709141058.txt 7577_Delivered: OK"</code><br />
<code>$String -Match ".*(?=\.txt)" | Out-Null</code><br />
<code>$Matches[0][-4..-1] -Join ""</code></p>
<p><code>$string.Substring($string.IndexOf(".txt")-4, 4)</code> 2-–π
–≤–∞—Ä–∏–∞–Ω—Ç (IndexOf)`</p>
<h3 id="—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-.net-method-format">–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (.NET method
format)</h3>
<p><code>[string]::Format("{1} {0}","Index0","Index1")</code><br />
<code>"{1} {0}" -f "Index0","Index1"</code><br />
<code>"{0:###-##-##}" -f 1234567</code> –∑–∞–ø–∏—Å–∞—Ç—å —á–∏—Å–ª–æ –≤ –¥—Ä—É–≥–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
(#)<br />
<code>"{0:0000}" -f 123</code> –≤—ã–≤–µ—Å—Ç–∏ —á–∏—Å–ª–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –Ω–µ –º–µ–Ω—å—à–µ 4
–∑–Ω–∞–∫–æ–≤ (0123)<br />
<code>"{0:P0}" -f (220/1000)</code> –ø–æ—Å—á–∏—Ç–∞—Ç—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (P)<br />
<code>"{0:P}" -f (512MB/1GB)</code> —Å–∫–æ–ª—å–∫–æ % —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 512–ú–± –æ—Ç
1–ì–±<br />
<code>"{0:0.0%}" -f 0.123</code> —É–º–Ω–æ–∂–∏—Ç—å –Ω–∞ 100%</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="va">$gp</span> <span class="op">=</span> <span class="fu">Get-Process</span> <span class="op">|</span> <span class="fu">sort</span> cpu <span class="op">-</span>Descending <span class="op">|</span> <span class="fu">select</span> <span class="op">-</span>First <span class="dv">10</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dt">foreach</span> <span class="op">(</span><span class="va">$p</span> <span class="kw">in</span> <span class="va">$gp</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;{0} - {1:N2}&quot;</span> <span class="op">-</span>f <span class="va">$p</span><span class="op">.</span><span class="fu">processname</span><span class="op">,</span> <span class="va">$p</span><span class="op">.</span><span class="fu">cpu</span> <span class="co"># –æ–∫—Ä—É–≥–ª–∏—Ç—å</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="—É—Å–ª–æ–≤–Ω—ã–π-–æ–ø–µ—Ä–∞—Ç–æ—Ä">–£—Å–ª–æ–≤–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä</h3>
<p><code>$rh = Read-Host</code><br />
<code>if ($rh -eq 1) {ipconfig} elseif ($rh -eq 2) {getmac} else {hostname}</code><br />
–ï—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ if () —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ç–µ–Ω–Ω—ã–º (<span
class="math inline"><em>T</em><em>r</em><em>u</em><em>e</em>),‚ÄÜ<em>–≤</em><em>—ã</em><em>–ø</em><em>–æ</em><em>–ª</em><em>–Ω</em><em>–∏</em><em>—Ç</em><em>—å</em><em>–¥</em><em>–µ</em><em>–π</em><em>—Å</em><em>—Ç</em><em>–≤</em><em>–∏</em><em>–µ</em><em>–≤</em>¬†<em>–ï</em><em>—Å</em><em>–ª</em><em>–∏</em><em>—É</em><em>—Å</em><em>–ª</em><em>–æ</em><em>–≤</em><em>–∏</em><em>–µ</em><em>i</em><em>f</em>()<em>—è</em><em>–≤</em><em>–ª</em><em>—è</em><em>–µ</em><em>—Ç</em><em>—Å</em><em>—è</em><em>–ª</em><em>–æ</em><em>–∂</em><em>–Ω</em><em>—ã</em><em>–º</em>(</span>False),
–≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ else<br />
–£—Å–ª–æ–≤–∏–µ Elseif –∏–¥—ë—Ç –ø–æ—Å–ª–µ —É—Å–ª–æ–≤–∏—è if –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
–ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ else. –û–ø–µ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–≤—ã–π –≤–µ—Ä–Ω–µ—Ç $True,
–æ—Ç–º–µ–Ω–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π<br />
–ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ —É—Å–ª–æ–≤–∏–µ –±–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞, —Ç–æ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è
–Ω–∞–ª–∏—á–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —É –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–∞ <span
class="math inline"><em>T</em><em>r</em><em>u</em><em>e</em>/</span>False<br />
<code>if ((tnc $srv -Port 80).TcpTestSucceeded) {"Opened port"} else {"Closed port"}</code></p>
<h3 id="–æ–ø–µ—Ä–∞—Ç–æ—Ä—ã">–û–ø–µ—Ä–∞—Ç–æ—Ä—ã</h3>
<p><code>-eq</code> —Ä–∞–≤–Ω–æ (equal)<br />
<code>-ceq</code> —É—á–∏—Ç—ã–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä<br />
<code>-ne</code> –Ω–µ —Ä–∞–≤–Ω–æ (not equal)<br />
<code>-gt</code> –±–æ–ª—å—à–µ (greater)<br />
<code>-ge</code> –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ<br />
<code>-lt</code> –º–µ–Ω—å—à–µ (less)<br />
<code>-le</code> –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ<br />
<code>-in</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ (5 -in @(1,2,3,4,5))<br />
<code>-NOT</code> –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –ù–ï–¢ !(Test-Path $path)<br />
<code>-and</code> –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –ò<br />
<code>-or</code> –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –ò–õ–ò<br />
<code>if ((($1 -eq 1) -and ($2 -eq 2)) -or ($1 -ne 3)) {"$true"} else {"$false"}</code>
–¥–≤–∞ —É—Å–ª–æ–≤–∏—è: (–µ—Å–ª–∏ $1 = 1 –∏ $2 = 2) –∏–ª–∏ $1 –Ω–µ —Ä–∞–≤–Ω–æ 3</p>
<h3 id="pipeline-operators">Pipeline Operators</h3>
<p><code>Write-Output "First" &amp;&amp; Write-Output "Second"</code>
–¥–≤–µ —É—Å–ø–µ—à–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è<br />
<code>Write-Error "Bad" &amp;&amp; Write-Output "Second"</code> –ø–µ—Ä–≤–∞—è
–∫–æ–º–∞–Ω–¥–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ—à–∏–±–∫–æ–π, –∏–∑-–∑–∞ —á–µ–≥–æ –≤—Ç–æ—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –Ω–µ
–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è<br />
<code>Write-Error "Bad" || Write-Output "Second"</code> –ø–µ—Ä–≤–∞—è –∫–æ–º–∞–Ω–¥–∞
–∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ—à–∏–±–∫–æ–π, –ø–æ—ç—Ç–æ–º—É –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ç–æ—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞<br />
<code>Write-Output "First" || Write-Output "Second"</code> –ø–µ—Ä–≤–∞—è
–∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ, –ø–æ—ç—Ç–æ–º—É –≤—Ç–æ—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è</p>
<h3 id="invocation-operator">Invocation Operator</h3>
<p><code>$addr = "8.8.8.8"</code><br />
<code>$ping = "ping"</code><br />
<code>&amp; $ping $addr</code> –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç –∫–∞–∫ –∫–æ–º–∞–Ω–¥—É</p>
<p><code>&amp; $ping $addr &amp;</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤ —Ñ–æ–Ω–µ<br />
<code>(Get-Job)[-1] | Receive-Job -Keep</code></p>
<h3 id="—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ-—Å–∏–º–≤–æ–ª—ã">–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã</h3>
<p><code>\d</code> —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 9 (20-07-2022 —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç: ‚Äú)<br />
<code>\D</code> –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –ª—é–±–æ–π —Å–∏–º–≤–æ–ª, –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä—ã. –£–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö
—Å–∏–º–≤–æ–ª–æ–≤, –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä: [int]$(‚Äù123 test‚Äù -replace ‚Äú‚Äù)<br />
<code>\w</code> –±—É–∫–≤–∞ –æ—Ç ‚Äúa‚Äù –¥–æ ‚Äúz‚Äù –∏ –æ—Ç ‚ÄúA‚Äù –¥–æ ‚ÄúZ‚Äù –∏–ª–∏ —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ
9<br />
<code>\s</code> –ø—Ä–æ–±–µ–ª, —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç: ‚Äù ‚Äù<br />
<code>\n</code> –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞<br />
<code>\b</code> –º–∞—Å–∫–∞, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü —Ü–µ–ª–æ–≥–æ —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è
–¥–ª—è –ø–æ–∏—Å–∫–∞<br />
<code>.</code> –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –ª—é–±–æ–π —Å–∏–º–≤–æ–ª, –∫—Ä–æ–º–µ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏<br />
<code>\</code> —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç –ª—é–±–æ–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã —Å–∏–º–≤–æ–ª (–º–µ—Ç–∞—Å–∏–º–≤–æ–ª).
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–∏–º–≤–æ–ª, –≤–º–µ—Å—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ
({ } [ ] / ¬†+ * . $ ^ | ?)<br />
<code>+</code> –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è 1 –∏ –±–æ–ª–µ–µ —Ä–∞–∑ (+)<br />
<code>{1,25}</code> –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
—Å–∏–º–≤–æ–ª–∞ —Å–ª–µ–≤–∞ –Ω–∞ –ø—Ä–∞–≤–æ (–æ—Ç 1 –¥–æ 25 —Ä–∞–∑)<br />
<code>[]</code> –ø–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ª—é–±–æ–π –±—É–∫–≤—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, [A-z0-9] –æ—Ç A –¥–æ
z –∏ —Ü–∏—Ñ—Ä—ã –æ—Ç 0 –¥–æ 9 (‚Äú192.168.1.1‚Äù -match ‚Äú192.1[6-7][0-9]‚Äù)</p>
<h3 id="—è–∫–æ—Ä–∏">–Ø–∫–æ—Ä–∏</h3>
<p><code>^</code> –∏–ª–∏ <code>\A</code> –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞—á–∞–ª–æ —Å—Ç—Ä–æ–∫–∏. <span
class="math inline">$url -replace '^','https:'` –¥–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ; \
`$</span><code>–∏–ª–∏</code><code>–æ–±–æ–∑–Ω–∞—á–∞—é—Ç –∫–æ–Ω–µ—Ü —Å—Ç—Ä–æ–∫–∏. $ip -replace "\d{1,3}$","0" \</code>(?=text)<code>–ø–æ–∏—Å–∫ —Å–ª–æ–≤–∞ —Å–ª–µ–≤–∞. –ü–∏—à–µ–º —Å–ª–µ–≤–∞ –Ω–∞ –ø—Ä–∞–≤–æ –æ—Ç –∏—Å–∫–æ–º–æ–≥–æ (–∏—â–µ—Ç —Ç–æ–ª—å–∫–æ —Ü–µ–ª—ã–µ —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è) "Server:\s(.{1,30})\s(?=$username)" \</code>(?&lt;=text)<code>–ø–æ–∏—Å–∫ —Å–ª–æ–≤–∞ —Å–ø—Ä–∞–≤–∞. $in_time -replace ".+(?&lt;=Last)"</code>
—É–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–æ —Å–ª–æ–≤–∞ Last<br />
<code>(?!text)</code> –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å–æ —Å–ª–æ–≤–æ–º —Å–ª–µ–≤–∞<br />
<code>(?&lt;!text)</code> –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å–æ —Å–ª–æ–≤–æ–º —Å–ø—Ä–∞–≤–∞</p>
<p><code>$test = "string"</code><br />
<code>$test -replace ".{1}$"</code> —É–¥–∞–ª–∏—Ç—å –ª—é–±–æ–µ –∫–æ–ª-–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤
–∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫–∏<br />
<code>$test -replace "^.{1}"</code> —É–¥–∞–ª–∏—Ç—å –ª—é–±–æ–µ –∫–æ–ª-–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤
–Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏<br />
</p>
<h3 id="–≥—Ä—É–ø–ø—ã-–∑–∞—Ö–≤–∞—Ç–∞">–ì—Ä—É–ø–ø—ã –∑–∞—Ö–≤–∞—Ç–∞</h3>
<p><code>$date = '12.31.2021'</code><br />
<code>$date -replace '^(\d{2}).(\d{2})','$2.$1'</code> –ø–æ–º–µ–Ω—è—Ç—å
–º–µ—Å—Ç–∞–º–∏<br />
<code>$1</code> —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–µ—Ä–≤–æ–π –≥—Ä—É–ø–ø—ã –≤ —Å–∫–æ–±–∫–∞—Ö<br />
<code>$2</code> —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—Ç–æ—Ä–æ–π –≥—Ä—É–ø–ø—ã</p>
<h1 id="datatype">DataType</h1>
<p><code>$srv.GetType()</code> —É–∑–Ω–∞—Ç—å —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö<br />
<code>$srv -is [string]</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–∞
–¥–∞–Ω–Ω—ã—Ö<br />
<code>$srv -isnot [System.Object]</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞
–Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ<br />
<code>[Object]</code> –º–∞—Å—Å–∏–≤ (BaseType:System.Array)<br />
<code>[DateTime]</code> —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏ (BaseType:System.ValueType)<br />
<code>[Bool]/[Boolean]</code> –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (<span
class="math inline"><em>T</em><em>r</em><em>u</em><em>e</em>/</span>False)
–∏–ª–∏ 1/0 (1 –±–∏—Ç) –Ω–∞–ª–∏—á–∏–µ/–æ—Ç—Å—É—Å—Ç–≤–∏–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è<br />
<code>[Byte]</code> 8-–±–∏—Ç–Ω–æ–µ (1 –±–∞–π—Ç) —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –±–µ–∑ –∑–Ω–∞–∫–∞
(0..255)<br />
<code>[Int16]</code> 16-–±–∏—Ç–Ω–æ–µ –∑–Ω–∞–∫–æ–≤–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –æ—Ç -32767 –¥–æ 32767
(—Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö WORD 0..65535)<br />
<code>[Int]</code> 32-–±–∏—Ç–Ω–æ–µ (4 –±–∞–π—Ç–∞) –∑–Ω–∞–∫–æ–≤–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –æ—Ç
‚Äì2147483648 –¥–æ 2147483647 (DWORD)<br />
<code>[Int64]</code> 64-–±–∏—Ç–Ω–æ–µ –æ—Ç -9223372036854775808 –¥–æ
9223372036854775808 (LWORD)<br />
<code>[Decimal]</code> 128-–±–∏—Ç–Ω–æ–µ –¥–µ—Å—è—Ç–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç
‚Äì79228162514264337593543950335 –¥–æ 79228162514264337593543950335<br />
<code>[Single]</code> —á–∏—Å–ª–æ —Å –ø–ª–∞–≤–∞—é—â–µ–π –∑–∞–ø—è—Ç–æ–π (32-—Ä–∞–∑—Ä—è–¥–Ω–æ–µ)<br />
<code>[Double]</code> —á–∏—Å–ª–æ —Å –ø–ª–∞–≤–∞—é—â–µ–π –∑–∞–ø—è—Ç–æ–π —Å –¥–≤–æ–π–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é
(64-—Ä–∞–∑—Ä—è–¥–Ω–æ–µ)<br />
<code>[String]</code> –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤ –Æ–Ω–∏–∫–æ–¥–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π
–¥–ª–∏–Ω—ã (BaseType:System.Object)</p>
<h3 id="math">Math</h3>
<p><code>[math] | Get-Member -Static</code><br />
<code>[math]::Pow(2,4)</code> 2 –≤ 4 —Å—Ç–µ–ø–µ–Ω–∏<br />
<code>[math]::Truncate(1.8)</code> –≥—Ä—É–±–æ–µ –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ, —É–¥–∞–ª—è–µ—Ç –¥—Ä–æ–±–Ω—É—é
—á–∞—Å—Ç—å<br />
<code>[math]::Ceiling(1.8)</code> –æ–∫—Ä—É–≥–ª—è–µ—Ç —á–∏—Å–ª–æ –≤ –±–æ–ª—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É –¥–æ
–±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è<br />
<code>[math]::Floor(-1.8)</code> –æ–∫—Ä—É–≥–ª—è–µ—Ç —á–∏—Å–ª–æ –≤ –º–µ–Ω—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É<br />
<code>[math]::Min(33,22)</code> –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–∏–º–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–≤—É—Ö
–∑–Ω–∞—á–µ–Ω–∏–π<br />
<code>[math]::Max(33,22)</code> –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–≤—É—Ö
–∑–Ω–∞—á–µ–Ω–∏–π</p>
<h3 id="round">Round</h3>
<p><code>[double]::Round(87.5, 0)</code> 88 (–Ω–µ—á–µ—Ç–Ω–æ–µ), –≤ .NET –ø–æ
—É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –≤ —Å—Ä–µ–¥–Ω–µ–π —Ç–æ—á–∫–µ ToEven, –≥–¥–µ *.5
–∑–Ω–∞—á–µ–Ω–∏—è –æ–∫—Ä—É–≥–ª—è—é—Ç—Å—è –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —á–µ—Ç–Ω–æ–≥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞.<br />
<code>[double]::Round(88.5, 0)</code> 88 (—á–µ—Ç–Ω–æ–µ)<br />
<code>[double]::Round(88.5, 0, 1)</code> 89 (–æ–∫—Ä—É–≥–ª—è—Ç—å –≤ –±–æ–ª—å—à—É—é
—Å—Ç–æ—Ä–æ–Ω—É)<br />
<code>[double]::Round(1234.56789, 2)</code> –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ 2 —Å–∏–º–≤–æ–ª–æ–≤
–ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π</p>
<h3 id="tostring">ToString</h3>
<p><code>(4164539/1MB).ToString("0.00")</code> —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –¥–≤–∞–∂–¥—ã –Ω–∞
1024/1024 –∏ –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ 3,97</p>
<h3 id="char">Char</h3>
<p><code>[Char]</code> c–∏–º–≤–æ–ª –Æ–Ω–∏–∫–æ–¥–∞ (16-—Ä–∞–∑—Ä—è–¥–Ω—ã–π)<br />
<code>$char = $srv.ToCharArray()</code> —Ä–∞–∑–±–∏—Ç—å —Å—Ç—Ä–æ–∫—É [string] –Ω–∞
–º–∞—Å—Å–∏–≤ [System.Array] –∏–∑ –±—É–∫–≤<br />
</p>
<h1 id="module">Module</h1>
<h3 id="psd1">psd1</h3>
<div class="sourceCode" id="cb12"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>@<span class="op">{</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    RootModule        <span class="op">=</span> <span class="st">&quot;Get-Function.psm1&quot;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    ModuleVersion     <span class="op">=</span> <span class="st">&quot;0.1&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    Author            <span class="op">=</span> <span class="st">&quot;Lifailon&quot;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    CompanyName       <span class="op">=</span> <span class="st">&quot;Open Source Community&quot;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    Copyright         <span class="op">=</span> <span class="st">&quot;Apache-2.0&quot;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    Description       <span class="op">=</span> <span class="st">&quot;Function example&quot;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    PowerShellVersion <span class="op">=</span> <span class="st">&quot;7.2&quot;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    PrivateData       <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        PSData <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            Tags         <span class="op">=</span> <span class="op">@(</span><span class="st">&quot;Function&quot;</span><span class="op">,</span><span class="st">&quot;Example&quot;</span><span class="op">)</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>            ProjectUri   <span class="op">=</span> <span class="st">&quot;https://github.com/Lifailon/PS-Commands&quot;</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>            LicenseUri   <span class="op">=</span> <span class="st">&quot;https://github.com/Lifailon/Console-Translate/blob/rsa/LICENSE&quot;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>            ReleaseNotes <span class="op">=</span> <span class="st">&quot;Second release&quot;</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="psm1">psm1</h3>
<div class="sourceCode" id="cb13"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get-Function <span class="op">{</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&lt;#</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">    .SYNOPSIS</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">    –û–ø–∏—Å–∞–Ω–∏–µ</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">    .DESCRIPTION</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">    –û–ø–∏—Å–∞–Ω–∏–µ</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">    .LINK</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">    https://github.com/Lifailon/PS-Commands</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">    #&gt;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span> <span class="op">(</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>Parameter<span class="op">(</span>Mandatory<span class="op">,</span>ValueFromPipeline<span class="op">)][</span><span class="dt">string</span><span class="op">]</span><span class="va">$Text</span><span class="op">,</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>ValidateSet<span class="op">(</span><span class="st">&quot;Test1&quot;</span><span class="op">,</span><span class="st">&quot;Test2&quot;</span><span class="op">)][</span><span class="dt">string</span><span class="op">]</span><span class="va">$Provider</span> <span class="op">=</span> <span class="st">&quot;Test1&quot;</span><span class="op">,</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>ValidateRange<span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">3</span><span class="op">)][</span><span class="dt">int</span><span class="op">]</span><span class="va">$Number</span> <span class="op">=</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="dt">Switch</span><span class="op">]</span><span class="va">$Switch</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="kw">Param</span> Text<span class="op">:</span> <span class="va">$Text</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="kw">Param</span> Provider<span class="op">:</span> <span class="va">$Provider</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="kw">Param</span> Number<span class="op">:</span> <span class="va">$Number</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="kw">Param</span> Switch<span class="op">:</span> <span class="va">$Switch</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Get-Function Test</code></p>
<h3 id="switch">Switch</h3>
<div class="sourceCode" id="cb14"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="va">$MMM</span> <span class="op">=</span> <span class="fu">Get-Date</span> <span class="op">-</span>UFormat <span class="st">&quot;%m&quot;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="cf">switch</span><span class="op">(</span><span class="va">$MMM</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;01&quot;</span> <span class="op">{</span><span class="va">$Month</span> <span class="op">=</span> <span class="st">&#39;Jan&#39;</span><span class="op">}</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;02&quot;</span> <span class="op">{</span><span class="va">$Month</span> <span class="op">=</span> <span class="st">&#39;Feb&#39;</span><span class="op">}</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;03&quot;</span> <span class="op">{</span><span class="va">$Month</span> <span class="op">=</span> <span class="st">&#39;Mar&#39;</span><span class="op">}</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;04&quot;</span> <span class="op">{</span><span class="va">$Month</span> <span class="op">=</span> <span class="st">&#39;Apr&#39;</span><span class="op">}</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;05&quot;</span> <span class="op">{</span><span class="va">$Month</span> <span class="op">=</span> <span class="st">&#39;May&#39;</span><span class="op">}</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;06&quot;</span> <span class="op">{</span><span class="va">$Month</span> <span class="op">=</span> <span class="st">&#39;Jun&#39;</span><span class="op">}</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;07&quot;</span> <span class="op">{</span><span class="va">$Month</span> <span class="op">=</span> <span class="st">&#39;Jul&#39;</span><span class="op">}</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;08&quot;</span> <span class="op">{</span><span class="va">$Month</span> <span class="op">=</span> <span class="st">&#39;Aug&#39;</span><span class="op">}</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;09&quot;</span> <span class="op">{</span><span class="va">$Month</span> <span class="op">=</span> <span class="st">&#39;Sep&#39;</span><span class="op">}</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;10&quot;</span> <span class="op">{</span><span class="va">$Month</span> <span class="op">=</span> <span class="st">&#39;Oct&#39;</span><span class="op">}</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;11&quot;</span> <span class="op">{</span><span class="va">$Month</span> <span class="op">=</span> <span class="st">&#39;Nov&#39;</span><span class="op">}</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;12&quot;</span> <span class="op">{</span><span class="va">$Month</span> <span class="op">=</span> <span class="st">&#39;Dec&#39;</span><span class="op">}</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="function-switch">function switch</h3>
<div class="sourceCode" id="cb15"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Function</span> fun-switch <span class="op">(</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="dt">switch</span><span class="op">]</span><span class="va">$param</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="op">)</span> <span class="op">{</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">If</span> <span class="op">(</span><span class="va">$param</span><span class="op">)</span> <span class="op">{</span><span class="st">&quot;yes&quot;</span><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span><span class="st">&quot;no&quot;</span><span class="op">}</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>fun-switch <span class="op">-</span>param</span></code></pre></div>
<h1 id="bit">Bit</h1>
<pre><code>–î–≤–æ–∏—á–Ω–æ–µ    –î–µ—Å—è—Ç–∏—á–Ω–æ–µ
1           1
10          2
11          3
100         4
101         5
110         6
111         7
1000        8
1001        9
1010        10
1011        11
1100        12
1101        13
1110        14
1111        15
1 0000      16

–î–≤–æ–∏—á–Ω–æ–µ    –î–µ—Å—è—Ç–∏—á–Ω–æ–µ  –ù–æ–º–µ—Ä —Ä–∞–∑—Ä—è–¥–∞
1           1           0
10          2           1
100         4           2
1000        8           3
1 0000      16          4
10 0000     32          5
100 0000    64          6
1000 0000   128         7
1 0000 0000 256         8

–ò–∑ –¥–≤–æ–∏—á–Ω–æ–≥–æ =&gt; –¥–µ—Å—è—Ç–∏—á–Ω–æ–µ (1-–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ —Ç–∞–±–ª–∏—Ü–µ)
1001 0011 = 1000 0000 + 1 0000 + 10 + 1 = 128 + 16 + 2 + 1 = 147

2-–π –≤–∞—Ä–∏–∞–Ω—Ç
7654 3210 (—Ä–∞–∑—Ä—è–¥—ã –¥–≤–æ–∏—á–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è) = (1*2^7)+(0*2^6)+(0*2^5)+(1*2^4)+(0*2^3)+(0*2^2)+(1*2^1)+(1*2^0) = 147
[math]::Pow(2,7) + [math]::Pow(2,4) + [math]::Pow(2,1) + [math]::Pow(2,0) = 147` –∏—Å–∫–ª—é—á–∏—Ç—å 0 –∏ —Å–ª–æ–∂–∏—Ç—å —Å—Ç–µ–ø–µ–Ω—å

–ò–∑ –¥–µ—Å—è—Ç–∏—á–Ω–æ–≥–æ =&gt; –¥–≤–æ–∏—á–Ω–æ–µ (1-–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ —Ç–∞–±–ª–∏—Ü–µ)
347 –≤—ã—á–µ—Å—Ç—å –±–ª–∏–∂–∞–π—à–∏–µ 256 = 91 (+ 1 0000 0000 –∑–∞–±—Ä–∞—Ç—å –¥–≤–æ–∏—á–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫)
91  - 64  = 27 –±–ª–∏–∂–∞–π—à–µ–µ 16 (+ 100 0000)
27  - 16  = 11 –±–ª–∏–∂–∞–π—à–µ–µ 8 (+ 1 0000)
11  - 8   = 3  –±–ª–∏–∂–∞–π—à–µ–µ 2 (+ 1000)
3   - 2   = 1 (+ 10)
1   - 1   = 0 (+ 1)
1 0101 1011

2-–π –≤–∞—Ä–∏–∞–Ω—Ç
–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –¥–µ–ª–µ–Ω–∏—è —á–∏—Å–ª–∞ –Ω–∞ 2, –ø—Ä–µ–¥–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–±–∏—Ä–∞—è –æ—Å—Ç–∞—Ç–æ–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —á–µ—Ç–Ω–æ–≥–æ —á–∏—Å–ª–∞ –≤ –º–µ–Ω—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É
347 - 346 = –æ—Å—Ç–∞—Ç–æ–∫ 1, (347-1)/2 = 173
173 - 172 = –æ—Å—Ç–∞—Ç–æ–∫ 1, (172-1)/2 = 86
86  - 86  = –æ—Å—Ç–∞—Ç–æ–∫ 0, 86/2 = 43
43  - 42  = –æ—Å—Ç–∞—Ç–æ–∫ 1, (43-1)/2 = 21
21  - 20  = –æ—Å—Ç–∞—Ç–æ–∫ 1, (21-1)/2 = 10
10  - 10  = –æ—Å—Ç–∞—Ç–æ–∫ 0, 10/2 = 5
5   - 4   = –æ—Å—Ç–∞—Ç–æ–∫ 1, (5-1)/2 = 2
2   - 2   = –æ—Å—Ç–∞—Ç–æ–∫ 0, 2/2 = 1
1   - 2   = –æ—Å—Ç–∞—Ç–æ–∫ 1, (1-1)/2 = 0
–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö</code></pre>
<h3 id="bit-convertor">Bit Convertor</h3>
<div class="sourceCode" id="cb17"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> ConvertTo-Bit <span class="op">{</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span> <span class="op">(</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="dt">Int</span><span class="op">]</span><span class="va">$int</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>array<span class="op">]</span><span class="va">$bits</span> <span class="op">=</span> <span class="op">@()</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">$test</span> <span class="op">=</span> <span class="va">$true</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="va">$test</span> <span class="op">-eq</span> <span class="va">$true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">((</span><span class="va">$int</span><span class="op">/</span><span class="dv">2</span><span class="op">).</span><span class="fu">GetType</span><span class="op">()</span> <span class="op">-match</span> <span class="op">[</span><span class="dt">double</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>            <span class="va">$int</span> <span class="op">=</span> <span class="op">(</span><span class="va">$int</span><span class="op">-</span><span class="dv">1</span><span class="op">)/</span><span class="dv">2</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>            <span class="op">[</span>array<span class="op">]</span><span class="va">$bits</span> <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elseif</span> <span class="op">((</span><span class="va">$int</span><span class="op">/</span><span class="dv">2</span><span class="op">).</span><span class="fu">GetType</span><span class="op">()</span> <span class="op">-match</span> <span class="op">[</span><span class="dt">int</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>            <span class="va">$int</span> <span class="op">=</span> <span class="va">$int</span><span class="op">/</span><span class="dv">2</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">[</span>array<span class="op">]</span><span class="va">$bits</span> <span class="op">+=</span> <span class="dv">0</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="va">$int</span> <span class="op">-eq</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>            <span class="va">$test</span> <span class="op">=</span> <span class="va">$false</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="va">$bits</span> <span class="op">=</span>  <span class="va">$bits</span><span class="op">[</span>-1<span class="op">..</span>-999<span class="op">]</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">([</span><span class="dt">string</span><span class="op">](</span><span class="va">$bits</span><span class="op">))</span> <span class="op">-replace</span> <span class="st">&quot;\s&quot;</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>ConvertTo-Bit 347</code></p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> ConvertFrom-Bit <span class="op">{</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span> <span class="op">(</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">$bit</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="dt">int</span><span class="op">]</span><span class="va">$int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">$bits</span> <span class="op">=</span> <span class="va">$bit</span><span class="op">.</span><span class="fu">ToString</span><span class="op">().</span><span class="fu">ToCharArray</span><span class="op">()</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">$index</span> <span class="op">=</span> <span class="op">(</span><span class="va">$bits</span><span class="op">.</span><span class="fu">Count</span><span class="op">)-</span><span class="dv">1</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">foreach</span> <span class="op">(</span><span class="va">$b</span> <span class="kw">in</span> <span class="va">$bits</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="va">$b</span> <span class="op">-notlike</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>            <span class="va">$int</span> <span class="op">+=</span> <span class="op">[</span>math<span class="op">]::</span>Pow<span class="op">(</span><span class="dv">2</span><span class="op">,</span><span class="va">$index</span><span class="op">)</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">$index</span> <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="va">$int</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>ConvertFrom-Bit 10010011</code></p>
<p><code>Get-Process pwsh | fl ProcessorAffinity</code> –ø—Ä–∏–≤—è–∑–∫–∞
–ø—Ä–æ—Ü–µ—Å—Å–∞ –∫ —è–¥—Ä–∞–º, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–∑ —Å–µ–±—è –±–∏—Ç–æ–≤—É—é –º–∞—Å–∫—É (bitmask), –≥–¥–µ
–∫–∞–∂–¥–æ–º—É –±–∏—Ç—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —è–¥—Ä–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞. –ï—Å–ª–∏ –¥–ª—è —è–¥—Ä–∞ –æ—Ç–º–µ—á–µ–Ω–æ
—Å—Ö–æ–¥—Å—Ç–≤–æ (affinity), —Ç–æ –±–∏—Ç –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ 1, –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî —Ç–æ –≤ 0.
–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω—ã –≤—Å–µ 16 —è–¥–µ—Ä, —Ç–æ —ç—Ç–æ 1111 1111 1111 1111 –∏–ª–∏
65535.<br />
<code>(Get-Process pwsh).ProcessorAffinity = 15</code> 0000000000001111
–ø—Ä–∏—Å–≤–æ–∏—Ç—å 4 –ø–µ—Ä–≤—ã—Ö —è–¥—Ä–∞<br />
<code>(Get-Process pwsh).ProcessorAffinity = 61440</code>
1111000000000000 –ø—Ä–∏—Å–≤–æ–∏—Ç—å 4 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —è–¥—Ä–∞<br />
<code>(Get-Process pwsh).ProcessorAffinity = (ConvertFrom-Bit 1111000000000000)</code></p>
<h1 id="cycle">Cycle</h1>
<h3 id="foreach">Foreach</h3>
<p><code>$list = 100..110</code> —Å–æ–∑–¥–∞—Ç—å –º–∞—Å—Å–∏–≤ –∏–∑ —Ü–∏—Ñ—Ä –æ—Ç 100 –¥–æ
110<br />
<code>foreach ($srv in $list) {ping 192.168.3.$srv -n 1 -w 50}</code>
$srv —Ö—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –∏–∑ <span class="math inline">$list –∏
–ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –º–∞—Å—Å–∏–≤–µ \
`$</span>foreach.Current<code>—Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Ü–∏–∫–ª–µ \</code><span
class="math inline">$foreach.Reset()` –æ–±–Ω—É–ª—è–µ—Ç –∏—Ç–µ—Ä–∞—Ü–∏—é, –ø–µ—Ä–µ–±–æ—Ä
–Ω–∞—á–Ω–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º—É —Ü–∏–∫–ª—É \
`$</span>foreach.MoveNext()` –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –≤ —Ü–∏–∫–ª–µ</p>
<h3 id="foreach-object">ForEach-Object (%)</h3>
<div class="sourceCode" id="cb19"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="op">..</span><span class="dv">110</span> <span class="op">|</span> <span class="op">%{</span>ping <span class="op">-</span>n <span class="dv">1</span> <span class="op">-</span>w <span class="dv">50</span> <span class="dv">192.168</span><span class="op">.</span><span class="dv">3</span><span class="op">.</span><span class="va">$_</span> <span class="op">&gt;</span> <span class="va">$null</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$LastExitCode</span> <span class="op">-eq</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span><span class="fu">Write-Host</span> <span class="st">&quot;192.168.3.</span><span class="va">$_</span><span class="st">&quot;</span> <span class="op">-</span>ForegroundColor green</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;192.168.3.</span><span class="va">$_</span><span class="st">&quot;</span><span class="op">-</span>ForegroundColor Red<span class="op">}}</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>  <span class="co"># –ø–µ—Ä–µ–¥–∞—Ç—å —Ü–∏–∫–ª —á–µ—Ä–µ–∑ –∫–æ–Ω–≤–µ–µ—Ä (ForEach-Object)</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="va">$_</span> <span class="co"># –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ü–∏–∫–ª–∞ –∏ –∫–æ–Ω–≤–µ–µ—Ä–∞ ($PSItem)</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">gwmi</span> Win32_QuickFixEngineering <span class="op">|</span> <span class="fu">where</span> <span class="op">{</span><span class="va">$_</span><span class="op">.</span><span class="fu">InstalledOn</span><span class="op">.</span><span class="fu">ToString</span><span class="op">()</span> <span class="op">-match</span> <span class="st">&quot;2022&quot;</span><span class="op">}</span> <span class="op">|</span> <span class="op">%{(</span><span class="va">$_</span><span class="op">.</span><span class="fu">HotFixID</span><span class="op">.</span><span class="fu">Substring</span><span class="op">(</span><span class="dv">2</span><span class="op">))}</span> <span class="co"># gwmi —Å–æ–∑–¥–∞–µ—Ç –º–∞—Å—Å–∏–≤, –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è where –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø–æ–¥ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤. –ü–æ –∫–æ–Ω–≤–µ–µ—Ä—É –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Ü–∏–∫–ª –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–µ—Ä–≤—ã—Ö (2) —Å–∏–º–≤–æ–ª–æ–≤ –º–µ—Ç–æ–¥–æ–º Substring –∏–∑ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ HotFixID.</span></span></code></pre></div>
<h3 id="while">While</h3>
<div class="sourceCode" id="cb20"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="va">$srv</span> <span class="op">=</span> <span class="st">&quot;yandex.ru&quot;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="va">$out2</span> <span class="op">=</span> <span class="st">&quot;–ï—Å—Ç—å –ø–∏–Ω–≥&quot;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="va">$out3</span> <span class="op">=</span> <span class="st">&quot;–ù–µ—Ç –ø–∏–Ω–≥–∞&quot;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="va">$out</span> <span class="op">=</span> <span class="va">$false</span> <span class="co"># –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, While –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏–µ –¥–æ –∑–∞–ø—É—Å–∫–∞ —Ü–∏–∫–ª–∞</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="cf">While</span> <span class="op">(</span><span class="va">$out</span> <span class="op">-eq</span> <span class="va">$false</span><span class="op">){</span> <span class="co"># –ø–æ–∫–∞ —É—Å–ª–æ–≤–∏–µ —è–≤–ª—è–µ—Ç—Å—è $true, —Ü–∏–∫–ª –±—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="va">$out</span> <span class="op">=</span> ping <span class="op">-</span>n <span class="dv">1</span> <span class="op">-</span>w <span class="dv">50</span> <span class="va">$srv</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$out</span> <span class="op">-match</span> <span class="st">&quot;ttl&quot;</span><span class="op">)</span> <span class="op">{</span><span class="va">$out</span> <span class="op">=</span> <span class="va">$true</span><span class="op">;</span> <span class="va">$out2</span><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span><span class="va">$out</span> <span class="op">=</span> <span class="va">$false</span><span class="op">;</span> <span class="va">$out3</span><span class="op">;</span> <span class="fu">sleep</span> <span class="dv">1</span><span class="op">}</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span><span class="va">$True</span><span class="op">){</span> <span class="co"># –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="va">$result</span> <span class="op">=</span> ping yandex<span class="op">.</span><span class="fu">ru</span> <span class="op">-</span>n <span class="dv">1</span> <span class="op">-</span>w <span class="dv">50</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="dt">if</span> <span class="op">(</span><span class="va">$result</span> <span class="op">-match</span> <span class="st">&quot;TTL&quot;</span><span class="op">){</span> <span class="co"># —É—Å–ª–æ–≤–∏–µ, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω break</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;–°–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω&quot;</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="cf">break</span> <span class="co"># –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç —Ü–∏–∫–ª</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span><span class="fu">Write-Host</span> <span class="st">&quot;–°–∞–π—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω&quot;</span><span class="op">;</span> <span class="fu">sleep</span> <span class="dv">1</span><span class="op">}</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="try-catch-finally">Try-Catch-Finally</h3>
<div class="sourceCode" id="cb21"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="cf">Try</span> <span class="op">{</span><span class="va">$out</span> <span class="op">=</span> pping <span class="dv">192.168</span><span class="op">.</span><span class="dv">3.1</span><span class="op">}</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="cf">Catch</span> <span class="op">{</span><span class="fu">Write-Warning</span> <span class="st">&quot;</span><span class="op">$(</span><span class="va">$error</span><span class="op">[</span><span class="dv">0</span><span class="op">])</span><span class="st">&quot;</span><span class="op">}</span> <span class="co"># –≤—ã–≤–æ–¥–∏—Ç –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ (–≤–º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏)</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span> <span class="op">{</span><span class="va">$out</span> <span class="op">=</span> <span class="st">&quot;End&quot;</span><span class="op">}</span> <span class="co"># –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ</span></span></code></pre></div>
<h1 id="files">Files</h1>
<p><code>$file = [System.IO.File]::Create("$home\desktop\test.txt")</code>
—Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª<br />
<code>$file.Close()</code> –∑–∞–∫—Ä—ã—Ç—å —Ñ–∞–π–ª<br />
<code>[System.IO.File]::ReadAllLines("$home\desktop\test.txt")</code>
–ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª<br />
<code>$file = New-Object System.IO.StreamReader("$home\desktop\test.txt")</code>
—Ñ–∞–π–ª –±—É–¥–µ—Ç –∑–∞–Ω—è—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–º PowerShell<br />
<code>$file | gm</code><br />
<code>$file.ReadLine()</code> –ø–æ—Å—Ç—Ä–æ—á–Ω—ã–π –≤—ã–≤–æ–¥<br />
<code>$file.ReadToEnd()</code> –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª —Ü–µ–ª–∏–∫–æ–º</p>
<h3 id="readwrite-bytes">Read/Write Bytes</h3>
<p><code>$file = [io.file]::ReadAllBytes("$home\desktop\powershell.jpg")</code>
–º–µ—Ç–æ–¥ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–≤–æ–∏—á–Ω—ã–π —Ñ–∞–π–ª, —Å—á–∏—Ç—ã–≤–∞–µ—Ç –µ–≥–æ –≤ –º–∞—Å—Å–∏–≤ –±–∞–π—Ç –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç
—Ñ–∞–π–ª<br />
<code>[io.file]::WriteAllBytes("$home\desktop\tloztotk-2.jpg",$file)</code>
—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–∞–π—Ç—ã –≤ —Ñ–∞–π–ª (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏ –¥–≤–æ–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
–∏–∑ –ë–î)</p>
<p><code>Get-Content $home/desktop\test.txt -Wait</code> –∞–Ω–∞–ª–æ–≥
tail<br />
<code>Test-Path $path</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—É—Ç–∏<br />
<code>Get-ChildItem $path -Filter *.txt -Recurse</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å
—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–∞—Ç–∞–ª–æ–≥–∞ (Alias: ls/gci/dir) –∏ –¥–æ—á–µ—Ä–Ω–∏—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤ (-Recurse)
–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥<br />
<code>Get-Location</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –º–µ—Å—Ç–æ—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ (Alias:
pwd/gl)<br />
<code>Set-Location $path</code> –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–∞–ª–æ–≥–∞–º (Alias:
cd/sl)<br />
<code>Invoke-Item $path</code> –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª (Alias: ii/start)<br />
<code>Get-ItemProperty $env:userprofile\Documents\dns-list.txt | select FullName,Directory,Name,BaseName,Extension</code>
—Å–≤–æ–π—Ç—Å–≤–∞ —Ñ–∞–π–ª–∞<br />
<code>Get-ItemProperty -Path $path\* | select FullName,CreationTime,LastWriteTime</code>
—Å–≤–æ–π—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –¥–∞—Ç–∞ –∏—Ö —Å–æ–∑–¥–∞–Ω–∏—è –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ
–∏–∑–º–µ–Ω–µ–Ω–∏—è<br />
<code>New-Item -Path "C:\test\" -ItemType "Directory"</code> —Å–æ–∑–¥–∞—Ç—å
–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é (Alias: mkdir/md)<br />
<code>New-Item -Path "C:\test\file.txt" -ItemType "File" -Value "–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –≤ —Ñ–∞–π–ª"</code>
—Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª<br />
<code>"test" &gt; "C:\test\file.txt"</code> –∑–∞–º–µ–Ω–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ<br />
<code>"test" &gt;&gt; "C:\test\file.txt"</code> –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É –≤
—Ñ–∞–π–ª<br />
<code>New-Item -Path "C:\test\test\file.txt" -Force</code> –∫–ª—é—á
–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤ –ø—É—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏
—Ñ–∞–π–ª–∞ –µ—Å–ª–∏ –æ–Ω —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç<br />
<code>Move-Item</code> –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ (Alias: mv/move)<br />
<code>Remove-Item "$path\" -Recurse</code> —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤–Ω—É—Ç—Ä–∏
–∫–∞—Ç–∞–ª–æ–≥–∞, –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–¥–≤–µ—Ä–∂–¥–µ–Ω–∏—è (Alias: rm/del)<br />
<code>Remove-Item $path -Recurse -Include "*.txt","*.temp" -Exclude "log.txt"</code>
—É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º txt –∏ temp (<a href="#array">Array</a>),
–∫—Ä–æ–º–µ log.txt<br />
<code>Rename-Item "C:\test\*.*" "*.jpg"</code> –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –ø–æ
–º–∞—Å–∫–µ (Alias: ren)<br />
<code>Copy-Item</code> –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ (Alias:
cp/copy)<br />
<code>Copy-Item -Path "\\server-01\test" -Destination "C:\" -Recurse</code>
–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –µ–µ —Å–æ–¥–µ—Ä–∂–∏–º—ã–º (-Recurse)<br />
<code>Copy-Item -Path "C:\*.txt" -Destination "C:\test\"</code> –∑–Ω–∞–∫ ‚Äô'
–≤ –∫–æ–Ω—Ü–µ Destination –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –ø–∞–ø–∫–∏ –≤–Ω—É—Ç—Ä—å —É–∫–∞–∑–∞–Ω–Ω–æ–π,
–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ, —á—Ç–æ —ç—Ç–æ –Ω–æ–≤–æ–µ –∏–º—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏<br />
<code>Copy-Item -Path "C:\*" -Destination "C:\test\" -Include '*.txt','*.jpg'</code>
–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º (Include)<br />
<code>Copy-Item -Path "C:\*" -Destination "C:\test\" -Exclude '*.jpeg'</code>
–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º (Exclude)<br />
<code>$log = Copy-Item "C:\*.txt" "C:\test\" -PassThru</code> –≤—ã–≤–µ—Å—Ç–∏
—Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ) –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –º–æ–∂–Ω–æ –∑–∞–±–∏—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫–∏
—Å –ø–æ–º–æ—â—å—é –∏–Ω–¥–µ–∫—Å–æ–≤ $log[0].FullName</p>
<h3 id="clear-env-temp-14-days">Clear-env-Temp-14-days</h3>
<div class="sourceCode" id="cb22"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="va">$ls</span> <span class="op">=</span> <span class="fu">Get-Item</span> <span class="va">$env</span><span class="op">:</span><span class="va">TEMP</span>\<span class="op">*.</span><span class="fu">tmp</span> <span class="co"># —Å—á–∏—Ç–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="va">$date</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Date</span><span class="op">).</span><span class="fu">AddDays</span><span class="op">(-</span><span class="dv">14</span><span class="op">)</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$l</span> <span class="kw">in</span> <span class="va">$ls</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="va">$l</span><span class="op">.</span><span class="fu">LastWriteTime</span> <span class="op">-le</span> <span class="va">$date</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">$l</span><span class="op">.</span><span class="fu">FullName</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Remove-Item</span> <span class="va">$l</span><span class="op">.</span><span class="fu">FullName</span> <span class="op">-</span>Recurse</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="filehash">Filehash</h3>
<p><code>Get-Filehash -Algorithm SHA256 "$env:USERPROFILE\Documents\RSA.conf.txt"</code></p>
<h3 id="microsoft.powershell.archive">Microsoft.PowerShell.Archive</h3>
<p><code>Compress-Archive -Path $sourcepath -DestinationPath $dstpath -CompressionLevel Optimal</code>
–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å<br />
<code>Expand-Archive .\powerlinefonts.zip</code> —Ä–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å</p>
<h1 id="credential">Credential</h1>
<p><code>$Cred = Get-Credential</code> —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫—Ä–µ–¥—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
<code>$Cred.Username</code> –∏ <code>$Cred.Password</code><br />
<code>$Cred.GetNetworkCredential().password</code> –∏–∑–≤–ª–µ—á—å –ø–∞—Ä–æ–ª—å<br />
<code>cmdkey /generic:"TERMSRV/$srv" /user:"$username" /pass:"$password"</code>
–¥–æ–±–∞–≤–∏—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫—Ä–µ–¥—ã –∞—É–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ –Ω–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è
–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–µ–∑ –ø–∞—Ä–æ–ª—è<br />
<code>mstsc /admin /v:$srv</code> –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è<br />
<code>cmdkey /delete:"TERMSRV/$srv"</code> —É–¥–∞–ª–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∫—Ä–µ–¥—ã
–∞—É–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã<br />
<code>rundll32.exe keymgr.dll,KRShowKeyMgr</code> —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Stored User
Names and Password<br />
<code>Get-Service VaultSvc</code> —Å–ª—É–∂–±–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã Credential
Manager<br />
<code>Install-Module CredentialManager</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å
—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Credential Manager –∫ —Ö—Ä–∞–Ω–∏–ª–∏—â—É PasswordVault –∏–∑
PowerShell<br />
<code>[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]'Tls11,Tls12'</code>
–¥–ª—è —É—Å—Ç–∞–Ω–æ–∫–∏ –º–æ–¥—É–ª—è<br />
<code>Get-StoredCredential</code> –ø–æ–ª—É—á–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
Windows Vault<br />
<code>Get-StrongPassword</code> –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª—è<br />
<code>New-StoredCredential -UserName test -Password "123456"</code>
–¥–æ–±–∞–≤–∏—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å<br />
<code>Remove-StoredCredential</code> —É–¥–∞–ª–∏—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å<br />
<code>$Cred = Get-StoredCredential | where {$_.username -match "admin"}</code><br />
<code>$pass = $cred.password</code><br />
<code>$BSTR = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pass)</code><br />
<code>[System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)</code></p>
<h3 id="out-gridview">Out-Gridview</h3>
<p><code>Get-Service -cn $srv | Out-GridView -Title "Service $srv" -OutputMode Single ‚ÄìPassThru | Restart-Service</code>
–ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–ª—É–∂–±—É</p>
<h3 id="out-file">Out-File</h3>
<p><code>Read-Host ‚ÄìAsSecureString | ConvertFrom-SecureString | Out-File "$env:userprofile\desktop\password.txt"</code>
–ø–∏—Å–∞—Ç—å –≤ —Ñ–∞–π–ª. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –≤ —Ñ–æ—Ä–º–∞—Ç SecureString —Å
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è Windows Data Protection API (DPAPI)</p>
<h3 id="get-content-gccattype">Get-Content (gc/cat/type)</h3>
<p><code>$password = gc "$env:userprofile\desktop\password.txt" | ConvertTo-SecureString</code>
—á–∏—Ç–∞—Ç—å —Ö—ç—à –ø–∞—Ä–æ–ª—è –∏–∑ —Ñ–∞–π–ª–∞ —Å –ø–æ–º–æ—â—å—é –∫–ª—é—á–µ–π, —Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è –≤ –ø—Ä–æ—Ñ–∏–ª–µ
—Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–º
–∫–æ–ø—å—é—Ç–µ—Ä–µ</p>
<h3 id="aes-key">AES Key</h3>
<p><code>$AESKey = New-Object Byte[] 32</code><br />
<code>[Security.Cryptography.RNGCryptoServiceProvider]::Create().GetBytes($AESKey)</code><br />
<code>$AESKey | Out-File "C:\password.key"</code><br />
<code>$Cred.Password | ConvertFrom-SecureString -Key (Get-Content "C:\password.key") | Set-Content "C:\password.txt"</code>
—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ —Ñ–∞–π–ª –∏—Å–ø–æ–ª—å–∑—É—è –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á<br />
<code>$pass = Get-Content "C:\password.txt" | ConvertTo-SecureString -Key (Get-Content "\\Server\Share\password.key")</code>
—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –Ω–∞ –≤—Ç–æ—Ä–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ</p>
<h1 id="winevent">WinEvent</h1>
<p><code>Get-WinEvent -ListLog *</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∂—É—Ä–Ω–∞–ª—ã
–ª–æ–≥–æ–≤<br />
<code>Get-WinEvent -ListLog * | where RecordCount -ne 0 | where RecordCount -ne $null | sort -Descending RecordCount</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–µ –ø—É—Å—Ç—ã–µ –∂—É—Ä–Ω–∞–ª—ã —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–æ –∫–æ–ª-–≤—É –∑–∞–ø–∏—Å–µ–π<br />
<code>Get-WinEvent -ListProvider * | ft</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ—Ö
–ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π<br />
<code>Get-WinEvent -ListProvider GroupPolicy</code> –Ω–∞–π—Ç–∏ –≤ –∫–∞–∫–æ–π –∂—É—Ä–Ω–∞–ª
LogLinks {Application} –ø–∏—à—É—Ç—Å—è –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è<br />
<code>Get-WinEvent -ListProvider *smb*</code><br />
<code>Get-WinEvent -ListLog * | where logname -match SMB | sort -Descending RecordCount</code>
–Ω–∞–π—Ç–∏ –≤—Å–µ –∂—É—Ä–Ω–∞–ª—ã –ø–æ –∏–º–µ–Ω–∏<br />
<code>Get-WinEvent -LogName "Microsoft-Windows-SmbClient/Connectivity"</code><br />
<code>Get-WinEvent -ListProvider *firewall*</code></p>
<h3 id="filter-xpathhashtable">Filter XPath/Hashtable</h3>
<p><code>Get-WinEvent -FilterHashtable @{LogName="Security";ID=4624}</code>
–Ω–∞–π—Ç–∏ –ª–æ–≥–∏ –ø–æ ID –≤ –∂—É—Ä–Ω–∞–ª–µ Security<br />
<code>Get-WinEvent -FilterHashtable @{LogName="System";Level=2}</code>
–Ω–∞–π—Ç–∏ –≤—Å–µ –∑–∞–ø–∏—Å–∏ –æ—à–∏–±–∫–∏ (1 - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π, 3 - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, 4 -
—Å–≤–µ–¥–µ–Ω–∏—è)<br />
<code>Get-WinEvent -FilterHashtable @{LogName="System";Level=2;ProviderName="Service Control Manager"}</code>
–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –∏–º–µ–Ω–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞</p>
<p><code>([xml](Get-WinEvent -FilterHashtable @{LogName="Security";ID=4688} -MaxEvents 1).ToXml()).Event.EventData.Data</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞, —Ö—Ä–∞–Ω–∏–º—ã–µ –≤ EventData (Message)<br />
<code>Get-WinEvent -FilterHashtable @{logname="security";ID=4688} -MaxEvents 1 | select timecreated,{$_.Properties[5].value}</code>
–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è –∏ –∏–º—è –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞</p>
<pre><code>$query = &#39;
&lt;QueryList&gt;
    &lt;Query Id=&quot;0&quot; Path=&quot;Security&quot;&gt;
        &lt;Select Path=&quot;Security&quot;&gt;
            *[System[EventID=4688]] and 
            *[EventData[Data[@Name=&quot;NewProcessName&quot;]=&quot;C:\Windows\System32\autochk.exe&quot; or Data[@Name=&quot;NewProcessName&quot;]=&quot;C:\Windows\System32\services.exe&quot;]]
        &lt;/Select&gt;
    &lt;/Query&gt;
&lt;/QueryList&gt;
&#39;

Get-WinEvent -LogName Security -FilterXPath $query</code></pre>
<h3 id="reboot">Reboot</h3>
<pre><code>$query = &#39;
&lt;QueryList&gt;
    &lt;Query Id=&quot;0&quot; Path=&quot;System&quot;&gt;
        &lt;Select Path=&quot;System&quot;&gt;
            *[
            System[
            EventID=41 or
            EventID=1074 or
            EventID=1076 or
            EventID=6005 or
            EventID=6006 or
            EventID=6008 or
            EventID=6009 or
            EventID=6013
            ]
            ]
        &lt;/Select&gt;
    &lt;/Query&gt;
&lt;/QueryList&gt;
&#39;
Get-WinEvent -LogName System -FilterXPath $query

41  ` –°–∏—Å—Ç–µ–º–∞ –±—ã–ª–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞ –±–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã.
1074` –°–∏—Å—Ç–µ–º–∞ –±—ã–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã–∫–ª—é—á–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–º.
1076` –°–ª–µ–¥—É–µ—Ç –∑–∞ Event ID 6008 –∏ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–µ—Ä–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—Å –ø—Ä–∞–≤–æ–º –≤—ã–∫–ª—é—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã) –ø–æ–¥–∫–ª—é—á–∏–≤—à–∏–π—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ—Å–ª–µ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏—è, —É–∫–∞–∑–∞–ª –ø—Ä–∏—á–∏–Ω—É —ç—Ç–æ–≥–æ —Å–æ–±—ã—Ç–∏—è.
6005` –ó–∞–ø—É—Å–∫ &quot;–ñ—É—Ä–Ω–∞–ª–∞ —Å–æ–±—ã—Ç–∏–π Windows&quot; (Event Log). –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã.
6006` –û—Å—Ç–∞–Ω–æ–≤–∫–∞ ¬´–ñ—É—Ä–Ω–∞–ª–∞ —Å–æ–±—ã—Ç–∏–π Windows¬ª. –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã.
6008` –ü—Ä–µ–¥—ã–¥—É—â–µ–µ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –±—ã–ª–æ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º.
6009` –í–µ—Ä—Å–∏—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã.
6013` –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã (system uptime) –≤ —Å–µ–∫—É–Ω–¥–∞—Ö.</code></pre>
<h3 id="logon">Logon</h3>
<div class="sourceCode" id="cb25"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="va">$srv</span> <span class="op">=</span> <span class="st">&quot;localhost&quot;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="va">$FilterXPath</span> <span class="op">=</span> <span class="st">&#39;&lt;QueryList&gt;&lt;Query Id=&quot;0&quot;&gt;&lt;Select&gt;*[System[EventID=21]]&lt;/Select&gt;&lt;/Query&gt;&lt;/QueryList&gt;&#39;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="va">$RDPAuths</span> <span class="op">=</span> <span class="fu">Get-WinEvent</span> <span class="op">-</span>ComputerName <span class="va">$srv</span> <span class="op">-</span>LogName <span class="st">&quot;Microsoft-Windows-TerminalServices-LocalSessionManager/Operational&quot;</span> <span class="op">-</span>FilterXPath <span class="va">$FilterXPath</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>xml<span class="op">[]]</span><span class="va">$xml</span> <span class="op">=</span> <span class="va">$RDPAuths</span> <span class="op">|</span> <span class="cf">Foreach</span> <span class="op">{</span><span class="va">$_</span><span class="op">.</span><span class="fu">ToXml</span><span class="op">()}</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="va">$EventData</span> <span class="op">=</span> <span class="cf">Foreach</span> <span class="op">(</span><span class="va">$event</span> <span class="kw">in</span> <span class="va">$xml</span><span class="op">.</span><span class="fu">Event</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">New-Object</span> PSObject <span class="op">-</span>Property @<span class="op">{</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Connection Time&quot;</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Date</span> <span class="op">(</span><span class="va">$event</span><span class="op">.</span><span class="fu">System</span><span class="op">.</span><span class="fu">TimeCreated</span><span class="op">.</span><span class="fu">SystemTime</span><span class="op">)</span> <span class="op">-</span>Format <span class="st">&#39;yyyy-MM-dd hh:mm K&#39;</span><span class="op">)</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;User Name&quot;</span> <span class="op">=</span> <span class="va">$event</span><span class="op">.</span><span class="fu">UserData</span><span class="op">.</span><span class="fu">EventXML</span><span class="op">.</span><span class="fu">User</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;User ID&quot;</span> <span class="op">=</span> <span class="va">$event</span><span class="op">.</span><span class="fu">UserData</span><span class="op">.</span><span class="fu">EventXML</span><span class="op">.</span><span class="fu">SessionID</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;User Address&quot;</span> <span class="op">=</span> <span class="va">$event</span><span class="op">.</span><span class="fu">UserData</span><span class="op">.</span><span class="fu">EventXML</span><span class="op">.</span><span class="fu">Address</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Event ID&quot;</span> <span class="op">=</span> <span class="va">$event</span><span class="op">.</span><span class="fu">System</span><span class="op">.</span><span class="fu">EventID</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="op">}}</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="va">$EventData</span> <span class="op">|</span> <span class="fu">ft</span></span></code></pre></div>
<h3 id="eventlog">EventLog</h3>
<p><code>Get-EventLog -List</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –∫–æ—Ä–Ω–µ–≤—ã–µ –∂—É—Ä–Ω–∞–ª—ã –ª–æ–≥–æ–≤
–∏ –∏—Ö —Ä–∞–∑–º–µ—Ä<br />
<code>Clear-EventLog Application</code> –æ—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ
–∂—É—Ä–Ω–∞–ª–∞<br />
<code>Get-EventLog -LogName Security -InstanceId 4624</code> –Ω–∞–π—Ç–∏ –ª–æ–≥–∏
–ø–æ ID –≤ –∂—É—Ä–Ω–∞–ª–µ Security</p>
<h1 id="firewall">Firewall</h1>
<div class="sourceCode" id="cb26"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="va">$days</span> <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="va">$obj</span> <span class="op">=</span> <span class="op">@()</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="va">$fw</span> <span class="op">=</span> <span class="fu">Get-WinEvent</span> <span class="st">&quot;Microsoft-Windows-Windows Firewall With Advanced Security/Firewall&quot;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$temp_fw</span> <span class="kw">in</span> <span class="va">$fw</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$temp_fw</span><span class="op">.</span><span class="fu">id</span> <span class="op">-eq</span> <span class="dv">2097</span><span class="op">)</span> <span class="op">{</span> <span class="co"># 2004</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">$type</span> <span class="op">=</span> <span class="st">&quot;Added Rule&quot;</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="cf">elseif</span> <span class="op">(</span><span class="va">$temp_fw</span><span class="op">.</span><span class="fu">id</span> <span class="op">-eq</span> <span class="dv">2006</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">$type</span> <span class="op">=</span> <span class="st">&quot;Deleted Rule&quot;</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="va">$port</span> <span class="op">=</span> <span class="va">$temp_fw</span><span class="op">.</span><span class="fu">Properties</span><span class="op">[</span><span class="dv">7</span><span class="op">]</span> <span class="op">|</span> <span class="fu">select</span> <span class="op">-</span>ExpandProperty value</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="va">$name</span> <span class="op">=</span> <span class="va">$temp_fw</span><span class="op">.</span><span class="fu">Properties</span><span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">|</span> <span class="fu">select</span> <span class="op">-</span>ExpandProperty value</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="va">$obj</span> <span class="op">+=</span> <span class="op">[</span>PSCustomObject<span class="op">]</span>@<span class="op">{</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    Time <span class="op">=</span> <span class="va">$temp_fw</span><span class="op">.</span><span class="fu">TimeCreated</span><span class="op">;</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Type</span> <span class="op">=</span> <span class="va">$type</span><span class="op">;</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    Port <span class="op">=</span> <span class="va">$port</span><span class="op">;</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    Name <span class="op">=</span> <span class="va">$name</span><span class="op">}</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="va">$obj</span> <span class="op">|</span> <span class="fu">Where-Object</span> time <span class="op">-gt</span> <span class="op">(</span><span class="fu">Get-Date</span><span class="op">).</span><span class="fu">AddDays</span><span class="op">(-</span><span class="va">$days</span><span class="op">)</span></span></code></pre></div>
<p><code>New-NetFirewallRule -Profile Any -DisplayName "Open Port 135 RPC" -Direction Inbound -Protocol TCP -LocalPort 135</code>
–æ—Ç–∫—Ä—ã—Ç—å in-–ø–æ—Ä—Ç<br />
<code>Get-NetFirewallRule | where DisplayName -match kms | select *</code>
–Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª–æ –ø–æ –∏–º–µ–Ω–∏<br />
<code>Get-NetFirewallPortFilter | where LocalPort -like 80</code> –Ω–∞–π—Ç–∏
–¥–µ–π—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∞–≤–∏–ª–æ –ø–æ –Ω–æ–º–µ—Ä—É –ø–æ—Ä—Ç–∞</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Get-NetFirewallRule <span class="op">-</span>Enabled True <span class="op">-</span>Direction Inbound <span class="op">|</span> <span class="fu">select</span> <span class="op">-</span>Property DisplayName<span class="op">,</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>@<span class="op">{</span>Name<span class="op">=</span><span class="st">&#39;Protocol&#39;</span><span class="op">;</span>Expression<span class="op">={(</span><span class="va">$_</span> <span class="op">|</span> Get-NetFirewallPortFilter<span class="op">).</span><span class="fu">Protocol</span><span class="op">}},</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>@<span class="op">{</span>Name<span class="op">=</span><span class="st">&#39;LocalPort&#39;</span><span class="op">;</span>Expression<span class="op">={(</span><span class="va">$_</span> <span class="op">|</span> Get-NetFirewallPortFilter<span class="op">).</span><span class="fu">LocalPort</span><span class="op">}},</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>@<span class="op">{</span>Name<span class="op">=</span><span class="st">&#39;RemotePort&#39;</span><span class="op">;</span>Expression<span class="op">={(</span><span class="va">$_</span> <span class="op">|</span> Get-NetFirewallPortFilter<span class="op">).</span><span class="fu">RemotePort</span><span class="op">}},</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>@<span class="op">{</span>Name<span class="op">=</span><span class="st">&#39;RemoteAddress&#39;</span><span class="op">;</span>Expression<span class="op">={(</span><span class="va">$_</span> <span class="op">|</span> Get-NetFirewallAddressFilter<span class="op">).</span><span class="fu">RemoteAddress</span><span class="op">}},</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>Enabled<span class="op">,</span>Profile</span></code></pre></div>
<h3 id="firewall-manager">Firewall-Manager</h3>
<p><code>Install-Module Firewall-Manager</code><br />
<code>Export-FirewallRules -Name * -CSVFile $home\documents\fw.csv</code>
-Inbound -Outbound -Enabled -Disabled -Allow -Block (—Ñ–∏–ª—å—Ç—Ä –ø—Ä–∞–≤–∏–ª –¥–ª—è
—ç–∫—Å–ø–æ—Ä—Ç–∞)<br />
<code>Import-FirewallRules -CSVFile $home\documents\fw.csv</code></p>
<h1 id="defender">Defender</h1>
<p><code>Import-Module Defender</code><br />
<code>Get-Command -Module Defender</code><br />
<code>Get-MpComputerStatus</code><br />
<code>(Get-MpComputerStatus).AntivirusEnabled</code> —Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã
–∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞</p>
<p><code>$session = NewCimSession -ComputerName hostname</code>
–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —É–¥–∞–ª–µ–Ω–Ω–æ–º—É –∫–æ–º–ø—å—é—Ç–µ—Ä—É, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è WinRM<br />
<code>Get-MpComputerStatus -CimSession $session | fl fullscan*</code>
—É–∑–Ω–∞—Ç—å –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ</p>
<p><code>Get-MpPreference</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏<br />
<code>(Get-MpPreference).ScanPurgeItemsAfterDelay</code> –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
–∑–∞–ø–∏—Å–µ–π –∂—É—Ä–Ω–∞–ª–∞ –∑–∞—â–∏—Ç–Ω–∏–∫–∞ –≤ –¥–Ω—è—Ö<br />
<code>Set-MpPreference -ScanPurgeItemsAfterDelay 30</code> –∏–∑–º–µ–Ω–∏—Ç—å
–≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è<br />
<code>ls "C:\ProgramData\Microsoft\Windows Defender\Scans\History"</code><br />
<code>Get-MpPreference | select disable*</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö
–≤–∏–¥–æ–≤ –ø—Ä–æ–≤–µ—Ä–æ–∫/—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–π<br />
<code>Set-MpPreference -DisableRealtimeMonitoring $true</code> –æ—Ç–∫–ª—é—á–∏—Ç—å
–∑–∞—â–∏—Ç—É Defender –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ä—É—á–Ω–æ–µ
—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)<br />
<code>Set-MpPreference -DisableRemovableDriveScanning $false</code>
–≤–∫–ª—é—á–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ USB –Ω–∞–∫–æ–ø–∏—Ç–µ–ª–µ–π<br />
<code>Get-MpPreference | select excl*</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö
–∏—Å–∫–ª—é—á–µ–Ω–∏–π<br />
<code>(Get-MpPreference).ExclusionPath</code><br />
<code>Add-MpPreference -ExclusionPath C:\install</code> –¥–æ–±–∞–≤–∏—Ç—å
–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ<br />
<code>Remove-MpPreference -ExclusionPath C:\install</code> —É–¥–∞–ª–∏—Ç—å –∏–∑
–∏—Å–∫–ª—é—á–µ–Ω–∏—è<br />
<code>New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force</code>
–ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å Windows Defender</p>
<p><code>Set-MpPreference -SignatureDefinitionUpdateFileSharesSources \\FileShare1\Updates</code>
–¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ —Å–µ—Ç–µ–≤–æ–π –ø–∞–ø–∫–∏ –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª—ã —Å
—Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º–∏ –±–∞–∑ —Å —Å–∞–π—Ç–∞
https://www.microsoft.com/security/portal/definitions/adl.aspx –∏
–ø–æ–º–µ—Å—Ç–∏—Ç—å –≤ —Å–µ—Ç–µ–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥
<code>Update-MpSignature -UpdateSource FileShares</code> –∏–∑–º–µ–Ω–∏—Ç—å
–∏—Å—Ç–æ—á–Ω–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (MicrosoftUpdateServer ‚Äì —Å–µ—Ä–≤–µ—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π MS –≤
–∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ, InternalDefinitionUpdateServer ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π WSUS
—Å–µ—Ä–≤–µ—Ä)<br />
<code>Update-MpSignature</code> –æ–±–Ω–æ–≤–∏—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—ã</p>
<p><code>Start-MpScan -ScanType QuickScan</code> –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–ª–∏
FullScan<br />
<code>Start-MpScan -ScanType FullScan -AsJob</code><br />
<code>Set-MpPreference -RemediationScheduleDay 1-7</code> –≤—ã–±—Ä–∞—Ç—å –¥–Ω–∏,
–Ω–∞—á–∏–Ω–∞—è —Å –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è –∏–ª–∏ 0 –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, 8 - —Å–±—Ä–æ—Å–∏—Ç—å<br />
<code>Set-MpPreference -ScanScheduleQuickScanTime 14:00:00</code><br />
<code>Start-MpScan -ScanType CustomScan -ScanPath "C:\Program Files"</code>
—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é</p>
<p><code>Get-MpThreat</code> –∏—Å—Ç–æ—Ä–∏—è —É–≥—Ä–æ–∑ –∏ —Ç–∏–ø —É–≥—Ä–æ–∑—ã (ThreatName:
HackTool/Trojan)<br />
<code>Get-MpThreatCatalog</code> —Å–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –≤–∏–¥–æ–≤ —É–≥—Ä–æ–∑<br />
<code>Get-MpThreatDetection</code> –∏—Å—Ç–æ—Ä–∏—è –∑–∞—â–∏—Ç—ã (–∞–∫—Ç–∏–≤–Ω—ã—Ö –∏ –ø—Ä–æ—à–ª—ã–µ) –∏
ID —É–≥—Ä–æ–∑—ã<br />
<code>Get-MpThreat -ThreatID 2147760253</code></p>
<p><code>ls "C:\ProgramData\Microsoft\Windows Defender\Quarantine\"</code>
–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –≤ –∫–∞—Ä–∞–Ω—Ç–∏–Ω–µ<br />
<code>cd "C:\Program Files\Windows Defender\"</code><br />
<code>.\MpCmdRun.exe -restore -name $ThreatName</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª
–∏–∑ –∫–∞—Ä–∞–Ω—Ç–∏–Ω–∞<br />
<code>.\MpCmdRun.exe -restore -filepath $path_file</code></p>
<h1 id="windowsupdate">WindowsUpdate</h1>
<p><code>Get-Hotfix | Sort-Object -Descending  InstalledOn</code> —Å–ø–∏—Å–æ–∫
—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ cimv2)<br />
<code>Get-Hotfix -Description "Security update"</code><br />
<code>Get-CimInstance Win32_QuickFixEngineering</code><br />
<code>Get-Command -Module WindowsUpdate</code><br />
<code>Get-WindowsUpdateLog</code><br />
<code>Get-Service uhssvc</code> —Å–ª—É–∂–±–∞ Microsoft Health Update Tools,
–∫–æ—Ç–æ—Ä–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π</p>
<p><code>Install-Module -Name PSWindowsUpdate -Scope CurrentUser</code><br />
<code>Import-Module PSWindowsUpdate</code><br />
<code>Get-Command -Module PSWindowsUpdate</code><br />
<code>Get-WindowsUpdate</code> —Å–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –¥–ª—è —Å–∫–∞—á–∞—Ç—å –∏
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞ WSUS –∏–ª–∏ Microsoft Update<br />
<code>Get-WindowsUpdate -Download</code> –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è<br />
<code>Get-WindowsUpdate ‚ÄìInstall</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è<br />
<code>Install-WindowsUpdate -MicrosoftUpdate -AcceptAll -IgnoreReboot</code>
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏<br />
<code>Get-WindowsUpdate -KBArticleID KB2267602, KB4533002 -Install</code><br />
<code>Get-WindowsUpdate -KBArticleID KB2538243 -Hide</code> —Å–∫—Ä—ã—Ç—å
–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —á—Ç–æ –±—ã –æ–Ω–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∏—Å—å<br />
<code>Get-WindowsUpdate ‚ÄìIsHidden</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
(Hide-WindowsUpdate)<br />
<code>Remove-WindowsUpdate -KBArticleID KB4011634 -NoRestart</code>
—É–¥–∞–ª–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ<br />
<code>Uninstall-WindowsUpdate</code> —É–¥–∞–ª–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ<br />
<code>Add-WUServiceManager</code> —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
(Windows Update Service Manager)<br />
<code>Enable-WURemoting</code> –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ Windows Defender,
—Ä–∞–∑—Ä–µ—à–∞—é—â–∏–µ —É–¥–∞–ª–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥–ª–µ—Ç–∞ PSWindowsUpdate<br />
<code>Get-WUApiVersion</code> –≤–µ—Ä—Å–∏—è Windows Update Agent<br />
<code>Get-WUHistory</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (–∏—Å—Ç–æ—Ä–∏—è
–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π)<br />
<code>Get-WUHistory | Where-Object {$_.Title -match "KB4517389"}</code>
–ø–æ–∏—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è<br />
<code>Get-WULastResults</code> –¥–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π<br />
<code>Get-WURebootStatus</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω—É–∂–Ω–∞ –ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è
–ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è<br />
<code>Get-WUServiceManager</code> –≤—ã–≤–æ–¥–∏—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π<br />
<code>Get-WUInstallerStatus</code> —Å—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã Windows Installer<br />
<code>Remove-WUServiceManager</code> –æ—Ç–∫–ª—é—á–∏—Ç—å Windows Update Service
Manager</p>
<h1 id="dism">DISM</h1>
<p><code>Get-Command -Module Dism -Name *Driver*</code><br />
<code>Export-WindowsDriver -Online -Destination C:\Users\Lifailon\Documents\Drivers\</code>
–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏–∑ —Ç–µ–∫—É—â–µ–π —Å–∏—Å—Ç–µ–º—ã (C:), –≤—ã–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤,
–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞ (dll,sys,exe) –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏
—Å–æ —Å–ø–∏—Å–∫–æ–º —Ñ–∞–π–ª–æ–≤, —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤ —Å–µ–∫—Ü–∏–∏ [CopyFiles] inf-—Ñ–∞–π–ª–∞
–¥—Ä–∞–π–≤–µ—Ä–∞.<br />
<code>Export-WindowsDriver -Path C:\win_image -Destination C:\drivers</code>
–∏–∑–≤–ª–µ—á—å –¥—Ä–∞–π–≤–µ—Ä–∞ –∏–∑ –æ—Ñ–ª–∞–π–Ω –æ–±—Ä–∞–∑–∞ Windows, —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤ –∫–∞—Ç–∞–ª–æ–≥
c:_image<br />
<code>$BackupDrivers = Export-WindowsDriver -Online -Destination C:\Drivers</code><br />
<code>$BackupDrivers | ft Driver,ClassName,ProviderName,Date,Version,ClassDescription</code>
—Å–ø–∏—Å–æ–∫ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –≤ –æ–±—ä–µ–∫—Ç–Ω–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏<br />
<code>$BackupDrivers | where classname -match printer</code><br />
<code>pnputil.exe /add-driver C:\drivers\*.inf /subdirs /install</code>
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ (–ø–∞—Ä–∞–º–µ—Ç—Ä subdirs) –¥—Ä–∞–π–≤–µ—Ä–∞ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–∏ (–≤–∫–ª—é—á–∞—è
–≤–ª–æ–∂–µ–Ω–Ω—ã–µ)</p>
<p><code>sfc /scannow</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å
–ø–æ–º–æ—â—å—é —É—Ç–∏–ª–∏—Ç—ã SFC (System File Checker), –≤ —Å–ª—É—á–∞–µ –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫,
–ø–æ–ø—Ä–æ–±—É–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Ö –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∫–æ–ø–∏–∏ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö
–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Windows (–∫–∞—Ç–∞–ª–æ–≥ C:). –í—ã–≤–æ–¥ —Ä–∞–±–æ—Ç—ã –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ C:—Å —Ç–µ–≥–æ–º
SR<br />
<code>Get-ComputerInfo | select *</code> –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
(WindowsVersion,WindowsEditionId,<em>Bios</em>)<br />
<code>Get-WindowsImage -ImagePath E:\sources\install.wim</code> —Å–ø–∏—Å–æ–∫
–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–µ—Ä—Å–∏–π –≤ –æ–±—Ä–∞–∑–µ<br />
<code>Repair-WindowsImage -Online ‚ÄìScanHealth</code><br />
<code>Repair-WindowsImage -Online -RestoreHealth</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
—Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤<br />
<code>Repair-WindowsImage -Online -RestoreHealth -Source E:\sources\install.wim:3 ‚ÄìLimitAccess</code>
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–µ –∏–∑ –æ–±—Ä–∞–∑–∞ –ø–æ –Ω–æ–º–µ—Ä—É –∏–Ω–¥–µ–∫—Å–∞</p>
<h1 id="scheduled">Scheduled</h1>
<p><code>$Trigger = New-ScheduledTaskTrigger -At 01:00am -Daily</code>
1:00 –Ω–æ—á–∏<br />
<code>$Trigger = New-ScheduledTaskTrigger ‚ÄìAtLogon</code> –∑–∞–ø—É—Å–∫ –ø—Ä–∏
–≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º—É<br />
<code>$Trigger = New-ScheduledTaskTrigger -AtStartup</code> –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
—Å–∏—Å—Ç–µ–º—ã<br />
<code>$User = "NT AUTHORITY\SYSTEM"</code><br />
<code>$Action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "$home\Documents\DNS-Change-Tray-1.3.ps1"</code><br />
<code>$Action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "-NoProfile -NoLogo -NonInteractive -ExecutionPolicy Unrestricted -WindowStyle Hidden -File $home\Documents\DNS-Change-Tray-1.3.ps1"</code><br />
<code>Register-ScheduledTask -TaskName "DNS-Change-Tray-Startup" -Trigger $Trigger -User $User -Action $Action -RunLevel Highest ‚ÄìForce</code></p>
<p><code>Get-ScheduledTask | ? state -ne Disabled</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö
–∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π<br />
<code>Start-ScheduledTask DNS-Change-Tray-Startup</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å
–∑–∞–¥–∞–Ω–∏–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ<br />
<code>Get-ScheduledTask DNS-Change-Tray-Startup | Disable-ScheduledTask</code>
–æ—Ç–∫–ª—é—á–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ<br />
<code>Get-ScheduledTask DNS-Change-Tray-Startup | Enable-ScheduledTask</code>
–≤–∫–ª—é—á–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ<br />
<code>Unregister-ScheduledTask DNS-Change-Tray-Startup</code> —É–¥–∞–ª–∏—Ç—å
–∑–∞–¥–∞–Ω–∏–µ<br />
<code>Export-ScheduledTask DNS-Change-Tray-Startup | Out-File $home\Desktop\Task-Export-Startup.xml</code>
—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ –≤ xml<br />
<code>Register-ScheduledTask -Xml (Get-Content $home\Desktop\Task-Export-Startup.xml | Out-String) -TaskName "DNS-Change-Tray-Startup"</code></p>
<h1 id="network">Network</h1>
<h3 id="ping">ping</h3>
<p><code>Test-Connection -Count 1 $srv1, $srv2</code> –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
icmp-–ø–∞–∫–µ—Ç –¥–≤—É–º —Ö–æ—Å—Ç–∞–º<br />
<code>Test-Connection $srv -ErrorAction SilentlyContinue</code> –Ω–µ
–≤—ã–≤–æ–¥–∏—Ç—å –æ—à–∏–±–æ–∫, –µ—Å–ª–∏ —Ö–æ—Å—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç<br />
<code>Test-Connection -Source $srv1 -ComputerName $srv2</code> –ø–∏–Ω–≥ —Å
—É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Test-PingNetwork <span class="op">{</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">param</span> <span class="op">(</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>Parameter<span class="op">(</span>Mandatory<span class="op">,</span>ValueFromPipeline<span class="op">)][</span><span class="dt">string</span><span class="op">[]]</span><span class="va">$Network</span><span class="op">,</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>ValidateRange<span class="op">(</span><span class="dv">100</span><span class="op">,</span><span class="dv">10000</span><span class="op">)][</span><span class="dt">int</span><span class="op">]</span><span class="va">$Timeout</span> <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="va">$ping</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">NetworkInformation</span><span class="op">.</span><span class="fu">Ping</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="va">$Network</span>  <span class="op">=</span> <span class="va">$Network</span> <span class="op">-replace</span> <span class="st">&quot;0$&quot;</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="va">$net</span> <span class="op">=</span> <span class="op">@()</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$r</span> <span class="kw">in</span> <span class="op">@(</span><span class="dv">1</span><span class="op">..</span><span class="dv">254</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="va">$net</span> <span class="op">+=</span> <span class="st">&quot;</span><span class="va">$network$r</span><span class="st">&quot;</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$n</span> <span class="kw">in</span> <span class="va">$net</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="va">$ping</span><span class="op">.</span><span class="fu">Send</span><span class="op">(</span><span class="va">$n</span><span class="op">,</span> <span class="va">$timeout</span><span class="op">)</span> <span class="op">|</span> <span class="fu">select</span> @<span class="op">{</span>Name<span class="op">=</span><span class="st">&quot;Address&quot;</span><span class="op">;</span> Expression<span class="op">={</span><span class="va">$n</span> <span class="op">-replace</span> <span class="st">&quot;.+\.&quot;</span><span class="op">}},</span> Status</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Test-PingNetwork -Network 192.168.3.0</code><br />
<code>Test-PingNetwork -Network 192.168.3.0 -Timeout 1000</code></p>
<p><code>Get-CimInstance -Class Win32_PingStatus -Filter "Address='127.0.0.1'"</code><br />
<code>Get-CimInstance -Class Win32_PingStatus -Filter "Address='127.0.0.1'" | Format-Table -Property Address,ResponseTime,StatusCode -Autosize</code>
0 - —É—Å–ø–µ—Ö<br />
<code>'127.0.0.1','8.8.8.8' | ForEach-Object -Process {Get-CimInstance -Class Win32_PingStatus -Filter ("Address='$_'") | Select-Object -Property Address,ResponseTime,StatusCode}</code><br />
<code>$ips = 1..254 | ForEach-Object -Process {'192.168.1.' + $_}</code>
—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ –∏–∑ ip-–∞–¥—Ä–µ—Å–æ–≤ –ø–æ–¥—Å–µ—Ç–∏</p>
<h3 id="dhcp">dhcp</h3>
<p><code>Get-CimInstance -Class Win32_NetworkAdapterConfiguration -Filter "DHCPEnabled=$true"</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∞–¥–∞–ø—Ç–µ—Ä—ã —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º DHCP<br />
<code>$wql = 'SELECT * from Win32_NetworkAdapterConfiguration WHERE IPEnabled=True and DHCPEnabled=False'</code><br />
<code>Invoke-CimMethod -MethodName ReleaseDHCPLease -Query $wql</code>
–≤–∫–ª—é—á–µ–Ω–∏–µ DHCP –Ω–∞ –≤—Å–µ—Ö –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö<br />
<code>Invoke-CimMethod -ClassName Win32_NetworkAdapterConfiguration -MethodName ReleaseDHCPLeaseAll</code>
–æ—Ç–º–µ–Ω–∏—Ç—å –∞—Ä–µ–Ω–¥—É –∞–¥—Ä–µ—Å–æ–≤ DHCP –Ω–∞ –≤—Å–µ—Ö –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö<br />
<code>Invoke-CimMethod -ClassName Win32_NetworkAdapterConfiguration -MethodName RenewDHCPLeaseAll</code>
–æ–±–Ω–æ–≤–∏—Ç—å –∞—Ä–µ–Ω–¥—É –∞–¥—Ä–µ—Å–æ–≤ DHCP –Ω–∞ –≤—Å–µ—Ö –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö</p>
<h3 id="port">port</h3>
<p><code>tnc $srv -p 5985</code><br />
<code>tnc $srv -CommonTCPPort WINRM</code> HTTP,RDP,SMB<br />
<code>tnc ya.ru ‚ÄìTraceRoute -Hops 2</code> TTL=2<br />
<code>tnc ya.ru -DiagnoseRouting</code> –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –¥–æ —Ö–æ—Å—Ç–∞, –∫—É–¥–∞
(DestinationPrefix: 0.0.0.0/0) —á–µ—Ä–µ–∑ (NextHop: 192.168.1.254)</p>
<h3 id="nslookup">nslookup</h3>
<p><code>nslookup ya.ru 1.1.1.1</code> —Å —É–∫–∞–∑–∞–Ω–∏–µ–º DNS —Å–µ—Ä–≤–µ—Ä–∞<br />
<code>nslookup -type=any ya.ru</code> —É–∫–∞–∑–∞—Ç—å —Ç–∏–ø –∑–∞–ø–∏—Å–∏<br />
<code>Resolve-DnsName ya.ru -Type MX</code>
ALL,ANY,A,NS,SRV,CNAME,PTR,TXT(spf)<br />
<code>[System.Net.Dns]::GetHostEntry("ya.ru")</code></p>
<h3 id="ipconfig">ipconfig</h3>
<p><code>Get-NetIPConfiguration</code><br />
<code>Get-NetIPConfiguration -InterfaceIndex 14 -Detailed</code></p>
<h3 id="adapter">Adapter</h3>
<p><code>Get-NetAdapter</code><br />
<code>Set-NetIPInterface -InterfaceIndex 14 -Dhcp Disabled</code>
–æ—Ç–∫–ª—é—á–∏—Ç—å DHCP<br />
<code>Get-NetAdapter -InterfaceIndex 14 | New-NetIPAddress ‚ÄìIPAddress 192.168.3.99 -DefaultGateway 192.168.3.1 -PrefixLength 24</code>
–∑–∞–¥–∞—Ç—å/–¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP-–∞–¥—Ä–µ—Å<br />
<code>Set-NetIPAddress -InterfaceIndex 14 -IPAddress 192.168.3.98</code>
–∏–∑–º–µ–Ω–∏—Ç—å IP-–∞–¥—Ä–µ–∞—Å –Ω–∞ –∞–¥–∞–ø—Ç–µ—Ä–µ<br />
<code>Remove-NetIPAddress -InterfaceIndex 14 -IPAddress 192.168.3.99</code>
—É–¥–∞–ª–∏—Ç—å IP-–∞–¥—Ä–µ—Å –Ω–∞ –∞–¥–∞–ø—Ç–µ—Ä–µ<br />
<code>Set-NetIPInterface -InterfaceIndex 14 -Dhcp Enabled</code>
–≤–∫–ª—é—á–∏—Ç—å DHCP</p>
<h3 id="dnsclient">DNSClient</h3>
<p><code>Get-DNSClientServerAddress</code><br />
<code>Set-DNSClientServerAddress -InterfaceIndex 14 -ServerAddresses 8.8.8.8</code></p>
<h3 id="dnscache">DNSCache</h3>
<p><code>Get-DnsClientCache</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏
–∫–ª–∏–µ–Ω—Ç–∞ DNS<br />
<code>Clear-DnsClientCache</code> –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à</p>
<h3 id="binding">Binding</h3>
<p><code>Get-NetAdapterBinding -Name Ethernet -IncludeHidden -AllBindings</code><br />
<code>Get-NetAdapterBinding -Name "–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–∞—è —Å–µ—Ç—å" -DisplayName "IP –≤–µ—Ä—Å–∏–∏ 6 (TCP/IPv6)" | Set-NetAdapterBinding -Enabled $false</code>
–æ—Ç–∫–ª—é—á–∏—Ç—å IPv6 –Ω–∞ –∞–¥–∞–ø—Ç–µ—Ä–µ</p>
<h3 id="tcpsetting">TCPSetting</h3>
<p><code>Get-NetTCPSetting</code><br />
<code>Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -CongestionProvider DCTCP</code><br />
<code>Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -CwndRestart True</code><br />
<code>Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -ForceWS Disabled</code></p>
<h3 id="netstat">netstat</h3>
<p><code>netstat -anop tcp</code> -n/-f/-b<br />
<code>Get-NetTCPConnection -State Established,Listen | ? LocalPort -Match 3389</code><br />
<code>Get-NetTCPConnection -State Established,Listen | ? RemotePort -Match 22</code><br />
<code>Get-NetUDPEndpoint | ? LocalPort -Match 514</code> netstat -ap
udp`</p>
<h3 id="statistics">Statistics</h3>
<p><code>netstat -se</code><br />
<code>Get-NetAdapterStatistics</code></p>
<h3 id="hostname">hostname</h3>
<p><code>$env:computername</code><br />
<code>hostname.exe</code><br />
<code>(Get-CIMInstance CIM_ComputerSystem).Name</code><br />
<code>(New-Object -ComObject WScript.Network).ComputerName</code><br />
<code>[System.Environment]::MachineName</code><br />
<code>[System.Net.Dns]::GetHostName()</code></p>
<h3 id="arp">arp</h3>
<p><code>ipconfig /all | Select-String "—Ñ–∏–∑"</code> grep<br />
<code>Get-NetNeighbor -AddressFamily IPv4</code></p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get-ARP <span class="op">{</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Param</span> <span class="op">(</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="va">$proxy</span><span class="op">,</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="va">$search</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(!</span><span class="va">$proxy</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="va">$arp</span> <span class="op">=</span> arp <span class="op">-</span>a</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$proxy</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="va">$arp</span> <span class="op">=</span> <span class="fu">icm</span> <span class="va">$proxy</span> <span class="op">{</span>arp <span class="op">-</span>a<span class="op">}</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="va">$mac</span> <span class="op">=</span> <span class="va">$arp</span><span class="op">[</span><span class="dv">3</span><span class="op">..</span><span class="dv">260</span><span class="op">]</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="va">$mac</span> <span class="op">=</span> <span class="va">$mac</span> <span class="op">-replace</span> <span class="st">&quot;^\s\s&quot;</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="va">$mac</span> <span class="op">=</span> <span class="va">$mac</span> <span class="op">-replace</span> <span class="st">&quot;\s{1,50}&quot;</span><span class="op">,</span><span class="st">&quot; &quot;</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="va">$mac_coll</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Collections</span><span class="op">.</span><span class="fu">Generic</span><span class="op">.</span><span class="fu">List</span><span class="op">[</span>System<span class="op">.</span><span class="fu">Object</span><span class="op">]</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$m</span> <span class="kw">in</span> <span class="va">$mac</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="va">$smac</span> <span class="op">=</span> <span class="va">$m</span> <span class="op">-split</span> <span class="st">&quot; &quot;</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="va">$mac_coll</span><span class="op">.</span><span class="fu">Add</span><span class="op">([</span>PSCustomObject<span class="op">]</span>@<span class="op">{</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>IP <span class="op">=</span> <span class="va">$smac</span><span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>MAC <span class="op">=</span> <span class="va">$smac</span><span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="fu">Type</span> <span class="op">=</span> <span class="va">$smac</span><span class="op">[</span><span class="dv">2</span><span class="op">]</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="op">})</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$search</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$search</span> <span class="op">-NotMatch</span> <span class="st">&quot;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="co">#$ns = nslookup $search</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="co">#$ns = $ns[-2]</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="co">#$global:ns = $ns -replace &quot;Address:\s{1,10}&quot;</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="va">$rdns</span> <span class="op">=</span> Resolve-DnsName <span class="va">$search</span> <span class="op">-</span>ErrorAction Ignore</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="va">$ns</span> <span class="op">=</span> <span class="va">$rdns</span><span class="op">.</span><span class="fu">IPAddress</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$ns</span> <span class="op">-eq</span> <span class="va">$null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="va">$ns</span> <span class="op">=</span> <span class="va">$search</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a><span class="va">$mac_coll</span> <span class="op">=</span> <span class="va">$mac_coll</span> <span class="op">|</span> <span class="op">?</span> ip <span class="op">-Match</span> <span class="va">$ns</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="va">$mac_coll</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Get-ARP -search 192.168.3.100</code><br />
<code>Get-ARP -search 192.168.3.100 -proxy dc-01</code></p>
<h1 id="rdp">RDP</h1>
<p><code>Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "PortNumber"</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ RDP –ø–æ—Ä—Ç–∞<br />
<code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "PortNumber" -Value "3390"</code>
–∏–∑–º–µ–Ω–∏—Ç—å RDP-–ø–æ—Ä—Ç<br />
<code>$(Get-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server\" -Name "fDenyTSConnections").fDenyTSConnections</code>
–µ—Å–ª–∏ 0, —Ç–æ –≤–∫–ª—é—á–µ–Ω<br />
<code>Set-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server\" -Name "fDenyTSConnections" -Value 0</code>
–≤–∫–ª—é—á–∏—Ç—å RDP<br />
<code>reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f</code><br />
<code>(gcim -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).SetAllowTSConnections(0)</code>
–≤–∫–ª—é—á–∏—Ç—å RDP (–¥–ª—è Windows Server)<br />
<code>Get-Service TermService | Restart-Service -Force</code>
–ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å rdp-—Å–ª—É–∂–±—É<br />
<code>New-NetFirewallRule -Profile Any -DisplayName "RDP 3390" -Direction Inbound -Protocol TCP -LocalPort 3390</code>
–æ—Ç–∫—Ä—ã—Ç—å RDP-–ø–æ—Ä—Ç</p>
<h3 id="ipban">IPBan</h3>
<p><code>auditpol /get /category:*</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –ø–æ–ª–∏—Ç–∏–∫–∏
–∞—É–¥–∏—Ç–∞<br />
<code>auditpol /get /category:–í—Ö–æ–¥/–≤—ã—Ö–æ–¥</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ
–ø–æ–ª–∏—Ç–∏–∫–∏ –∞—É–¥–∏—Ç–∞ –¥–ª—è –í—Ö–æ–¥–∞ –∏ –í—ã—Ö–æ–¥–∞ –∏–∑ —Å–∏—Å—Ç–µ–º—ã<br />
<code>auditpol /set /subcategory:"–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É" /success:enable /failure:enable</code>
–≤–∫–ª—é—á–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ - –ê—É–¥–∏—Ç –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É<br />
<code>auditpol /set /subcategory:"–í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã" /success:enable /failure:enable</code></p>
<p><code>$url = $($(Invoke-RestMethod https://api.github.com/repos/DigitalRuby/IPBan/releases/latest).assets | Where-Object name -match ".+win.+x64.+").browser_download_url</code>
–ø–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏<br />
<code>$version = $(Invoke-RestMethod https://api.github.com/repos/DigitalRuby/IPBan/releases/latest).tag_name</code>
–ø–æ–ª—É—á–∏—Ç—å –Ω–æ–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏<br />
<code>$path = "$home\Documents\ipban-$version"</code> –ø—É—Ç—å –¥–ª—è
—É—Å—Ç–∞–Ω–æ–≤–∫–∏<br />
<code>Invoke-RestMethod $url -OutFile "$home\Downloads\IPBan-$version.zip"</code>
—Å–∫–∞—á–∞—Ç—å –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤<br />
<code>Expand-Archive "$home\Downloads\ipban-$version.zip" -DestinationPath $path</code>
—Ä–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—É—Ç—å –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏<br />
<code>Remove-Item "$home\Downloads\ipban-$version.zip"</code> —É–¥–∞–ª–∏—Ç—å
–¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤<br />
<code>sc create IPBan type=own start=delayed-auto binPath="$path\DigitalRuby.IPBan.exe" DisplayName=IPBan</code>
—Å–æ–∑–¥–∞—Ç—å —Å–ª—É–∂–±—É<br />
<code>Get-Service IPBan</code> —Å—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã<br />
<code>$conf = $(Get-Content "$path\ipban.config")</code> —á–∏—Ç–∞–µ–º
–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é<br />
<code>$conf = $conf -replace '&lt;add key="Whitelist" value=""/&gt;','&lt;add key="Whitelist" value="192.168.3.0/24"/&gt;'</code>
–¥–æ–±–∞–≤–∏—Ç—å –≤ –±–µ–ª—ã–π –ª–∏—Å—Ç –¥–æ–º–∞—à–Ω—é—é —Å–µ—Ç—å –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è<br />
<code>$conf = $conf -replace '&lt;add key="ProcessInternalIPAddresses" value="false"/&gt;','&lt;add key="ProcessInternalIPAddresses" value="true"/&gt;'</code>
–≤–∫–ª—é—á–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ª–æ–∫–∞–ª—å–Ω—ã—Ö (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö) ip-–∞–¥—Ä–µ—Å–æ–≤<br />
<code>$conf = $conf -replace '&lt;add key="FailedLoginAttemptsBeforeBanUserNameWhitelist" value="20"/&gt;','&lt;add key="FailedLoginAttemptsBeforeBanUserNameWhitelist" value="5"/&gt;'</code>
—É–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏<br />
<code>$conf = $conf -replace '&lt;add key="ExpireTime" value="01:00:00:00"/&gt;','&lt;add key="ExpireTime" value="00:01:00:00"/&gt;'</code>
–∑–∞–¥–∞—Ç—å –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ 1 —á–∞—Å<br />
<code>$conf &gt; "$path\ipban.config"</code> –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é<br />
<code>Get-Service IPBan | Start-Service</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É</p>
<pre><code>Get-NetFirewallRule | Where-Object DisplayName -Match &quot;IPBan&quot; | ForEach-Object {
    $Name = $_.DisplayName
    Get-NetFirewallAddressFilter -AssociatedNetFirewallRule $_ | Select-Object @{Name=&quot;Name&quot;; Expression={$Name}},LocalIP,RemoteIP
} # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –æ–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª –ë—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ –¥–ª—è IPBan</code></pre>
<p><code>Get-Content -Wait "$path\logfile.txt"</code> —á–∏—Ç–∞—Ç—å –ª–æ–≥<br />
<code>Get-Service IPBan | Stop-Service</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂–±—É<br />
<code>sc delete IPBan</code> —É–¥–∞–ª–∏—Ç—å —Å–ª—É–∂–±—É</p>
<h1 id="shutdown">shutdown</h1>
<p><code>shutdown /r /o</code> –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º<br />
<code>shutdown /s /t 600 /c "Power off after 10 minutes"</code>
–≤—ã–∫–ª—é—á–µ–Ω–∏–µ<br />
<code>shutdown /s /f</code> –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π<br />
<code>shutdown /a</code> –æ—Ç–º–µ–Ω–∞<br />
<code>shutdown /r /t 0 /m \\192.168.3.100</code><br />
<code>Restart-Computer -ComputerName 192.168.3.100 -Protocol WSMan</code>
—á–µ—Ä–µ–∑ WinRM<br />
<code>Restart-Computer ‚ÄìComputerName 192.168.3.100 ‚ÄìForce</code> —á–µ—Ä–µ–∑
WMI<br />
<code>Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\Start\HideShutDown" -Name "value" -Value 1</code>
—Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –≤—ã–∫–ª—é—á–µ–Ω–∏—è<br />
<code>Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\Start\HideRestart" -Name "value" -Value 1</code>
—Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Start-Shutdown <span class="op">{</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&lt;#</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">    .SYNOPSIS</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Module for shutdown and restart the computer at a specified time</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">    .DESCRIPTION</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co">    # Start-Shutdown -Time &quot;18:00&quot;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">    # Start-Shutdown -Restart -Time &quot;18:00&quot;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">    # Start-Shutdown -Cancel</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">    .LINK</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co">    https://github.com/Lifailon/PS-Commands</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">    #&gt;</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span><span class="op">(</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$Time</span><span class="op">,</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="dt">switch</span><span class="op">]</span><span class="va">$Restart</span><span class="op">,</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="dt">switch</span><span class="op">]</span><span class="va">$Cancel</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="va">$Time</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">$currentDateTime</span> <span class="op">=</span> <span class="fu">Get-Date</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">$shutdownTime</span> <span class="op">=</span> <span class="fu">Get-Date</span> <span class="va">$Time</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="va">$shutdownTime</span> <span class="op">-lt</span> <span class="va">$currentDateTime</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>            <span class="va">$shutdownTime</span> <span class="op">=</span> <span class="va">$shutdownTime</span><span class="op">.</span><span class="fu">AddDays</span><span class="op">(</span><span class="dv">1</span><span class="op">)</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">$timeUntilShutdown</span> <span class="op">=</span> <span class="va">$shutdownTime</span> <span class="op">-</span> <span class="va">$currentDateTime</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">$secondsUntilShutdown</span> <span class="op">=</span> <span class="op">[</span>math<span class="op">]::</span>Round<span class="op">(</span><span class="va">$timeUntilShutdown</span><span class="op">.</span><span class="fu">TotalSeconds</span><span class="op">)</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="va">$Cancel</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Start-Process</span> <span class="op">-</span>FilePath <span class="st">&quot;shutdown.exe&quot;</span> <span class="op">-</span>ArgumentList <span class="st">&quot;/a&quot;</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">elseif</span> <span class="op">(</span><span class="va">$Restart</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Write-Host</span> <span class="st">&quot;The computer will restart after </span><span class="op">$(</span><span class="va">$timeUntilShutdown</span><span class="op">.</span><span class="fu">Hours</span><span class="op">)</span><span class="st"> hours and </span><span class="op">$(</span><span class="va">$timeUntilShutdown</span><span class="op">.</span><span class="fu">Minutes</span><span class="op">)</span><span class="st"> minutes.&quot;</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Start-Process</span> <span class="op">-</span>FilePath <span class="st">&quot;shutdown.exe&quot;</span> <span class="op">-</span>ArgumentList <span class="st">&quot;/r&quot;</span><span class="op">,</span> <span class="st">&quot;/f&quot;</span><span class="op">,</span> <span class="st">&quot;/t&quot;</span><span class="op">,</span> <span class="st">&quot;</span><span class="va">$secondsUntilShutdown</span><span class="st">&quot;</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Write-Host</span> <span class="st">&quot;The computer will shutdown after </span><span class="op">$(</span><span class="va">$timeUntilShutdown</span><span class="op">.</span><span class="fu">Hours</span><span class="op">)</span><span class="st"> hours and </span><span class="op">$(</span><span class="va">$timeUntilShutdown</span><span class="op">.</span><span class="fu">Minutes</span><span class="op">)</span><span class="st"> minutes.&quot;</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Start-Process</span> <span class="op">-</span>FilePath <span class="st">&quot;shutdown.exe&quot;</span> <span class="op">-</span>ArgumentList <span class="st">&quot;/s&quot;</span><span class="op">,</span> <span class="st">&quot;/f&quot;</span><span class="op">,</span> <span class="st">&quot;/t&quot;</span><span class="op">,</span> <span class="st">&quot;</span><span class="va">$secondsUntilShutdown</span><span class="st">&quot;</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="localaccounts">LocalAccounts</h1>
<p><code>Get-Command -Module Microsoft.PowerShell.LocalAccounts</code><br />
<code>Get-LocalUser</code> —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π<br />
<code>Get-LocalGroup</code> —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø<br />
<code>New-LocalUser "1C" -Password $Password -FullName "1C Domain"</code>
—Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>Set-LocalUser -Password $Password 1C</code> –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å<br />
<code>Add-LocalGroupMember -Group "Administrators" -Member "1C"</code>
–¥–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤<br />
<code>Get-LocalGroupMember "Administrators"</code> —á–ª–µ–Ω—ã –≥—Ä—É–ø–ø—ã</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="op">@(</span><span class="st">&quot;vproxy-01&quot;</span><span class="op">,</span><span class="st">&quot;vproxy-02&quot;</span><span class="op">,</span><span class="st">&quot;vproxy-03&quot;</span><span class="op">)</span> <span class="op">|</span> <span class="op">%{</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">icm</span> <span class="va">$_</span> <span class="op">{</span>Add-LocalGroupMember <span class="op">-</span>Group <span class="st">&quot;Administrators&quot;</span> <span class="op">-</span>Member <span class="st">&quot;support4&quot;</span><span class="op">}</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">icm</span> <span class="va">$_</span> <span class="op">{</span>Get-LocalGroupMember <span class="st">&quot;Administrators&quot;</span><span class="op">}</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="smb">SMB</h1>
<p><code>Get-SmbServerConfiguration</code><br />
<code>Set-SmbServerConfiguration -EnableSMB1Protocol $false -Force</code>
–æ—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª SMB v1<br />
<code>Get-WindowsFeature | Where-Object {$_.name -eq "FS-SMB1"} | ft Name,Installstate</code>
–º–æ–¥—É–ª—å ServerManager, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç SMB1<br />
<code>Install-WindowsFeature FS-SMB1</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SMB1<br />
<code>Uninstall-WindowsFeature ‚ÄìName FS-SMB1 ‚ÄìRemove</code> —É–¥–∞–ª–∏—Ç—å SMB1
–∫–ª–∏–µ–Ω—Ç–∞ (–ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞)<br />
<code>Get-WindowsOptionalFeature -Online</code> –º–æ–¥—É–ª—å DISM, –¥–ª—è —Ä–∞–±–æ—Ç—ã
—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ Windows<br />
<code>Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol -Remove</code>
—É–¥–∞–ª–∏—Ç—å SMB1<br />
<code>Set-SmbServerConfiguration ‚ÄìAuditSmb1Access $true</code> –≤–∫–ª—é—á–∏—Ç—å
–∞—É–¥–∏—Ç SMB1<br />
<code>Get-SmbConnection</code> —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è
–≤–µ—Ä—Å–∏—è SMB (Dialect)<br />
<code>Get-SmbOpenFile | select ClientUserName,ClientComputerName,Path,SessionID</code>
—Å–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤<br />
<code>Get-SmbShare</code> —Å–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–ø–æ–∫<br />
<code>New-SmbShare -Name xl-share -Path E:\test</code> —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é
–æ–±—â—É—é —Å–µ—Ç–µ–≤—É—é –ø–∞–ø–∫—É (—Ä–∞—Å—à–∞—Ä–∏—Ç—å)<br />
<code>-EncryptData $True</code> –≤–∫–ª—é—á–∏—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ SMB<br />
<code>-Description</code> –∏–º—è –≤ —Å–µ—Ç–µ–≤–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏<br />
<code>-ReadAccess "domain\username"</code> –¥–æ—Å—Ç—É–ø –Ω–∞ —á—Ç–µ–Ω–∏–µ<br />
<code>-ChangeAccess</code> –¥–æ—Å—Ç—É–ø –Ω–∞ –∑–∞–ø–∏—Å—å<br />
<code>-FullAccess</code> –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø<br />
<code>-NoAccess ALL</code> –Ω–µ—Ç –ø—Ä–∞–≤<br />
<code>-FolderEnumerationMode [AccessBased | Unrestricted]</code>
–ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫—Ä—ã—Ç—å –≤ —Å–µ—Ç–µ–≤–æ–π –ø–∞–ø–∫–µ –æ–±—ä–µ–∫—Ç—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç
–¥–æ—Å—Ç—É–ø–∞ —Å –ø–æ–º–æ—â—å—é Access-Based Enumeration (ABE)<br />
<code>Get-SmbShare xl-share | Set-SmbShare -FolderEnumerationMode AccessBased</code>
–∫–ª—é—á–∏—Ç—å ABE –¥–ª—è –≤—Å–µ—Ö —Ä–∞—Å—à–∞—Ä–µ–Ω–Ω—ã—Ö –ø–∞–ø–æ–∫<br />
<code>Remove-SmbShare xl-share -force</code> —É–¥–∞–ª–∏—Ç—å —Å–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø
(—à–∞—Ä—É)<br />
<code>Get-SmbShareAccess xl-share</code> –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–æ–≤
–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫ —à–∞—Ä–µ<br />
<code>Revoke-SmbShareAccess xl-share -AccountName Everyone ‚ÄìForce</code>
—É–¥–∞–ª–∏—Ç—å –≥—Ä—É–ø–ø—É –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–æ–≤<br />
<code>Grant-SmbShareAccess -Name xl-share -AccountName "domain\XL-Share" -AccessRight Change ‚Äìforce</code>
–∏–∑–º–µ–Ω–∏—Ç—å/–¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –∑–∞–ø–∏—Å—å (Full,Read)<br />
<code>Grant-SmbShareAccess -Name xl-share -AccountName "–≤—Å–µ" -AccessRight Change ‚Äìforce</code><br />
<code>Block-SmbShareAccess -Name xl-share -AccountName "domain\noAccess" -Force</code>
–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–µ—Ç<br />
<code>New-SmbMapping -LocalPath X: -RemotePath \\$srv\xl-share -UserName support4 -Password password ‚ÄìPersistent $true</code>
–ø–æ–¥–∫–ª—é—á–∏—Ç—å —Å–µ—Ç–µ–≤–æ–π –¥–∏—Å–∫<br />
<code>-Persistent</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
–∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∏–ª–∏ —Å–µ—Ç–∏<br />
<code>-SaveCredential</code> –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –¥–∏—Å–ø–µ—Ç—á–µ—Ä —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö Windows
Credential Manager<br />
<code>Stop-Process -Name "explorer" | Start-Process -FilePath "C:\Windows\explorer.exe"</code>
–ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–µ<br />
<code>Get-SmbMapping</code> —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –¥–∏—Å–∫–æ–≤<br />
<code>Remove-SmbMapping X: -force</code> –æ—Ç–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤–æ–π
–¥–∏—Å–∫<br />
<code>$CIMSession = New-CIMSession ‚ÄìComputername $srv</code> —Å–æ–∑–¥–∞—Ç—å
—Å–µ–∞–Ω—Å CIM (–∞—É–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ SMB)<br />
<code>Get-SmbOpenFile -CIMSession $CIMSession | select ClientUserName,ClientComputerName,Path | Out-GridView -PassThru | Close-SmbOpenFile -CIMSession $CIMSession -Confirm:$false ‚ÄìForce</code>
–∑–∞–∫—Ä—ã—Ç—å —Ñ–∞–π–ª—ã (–æ—Ç–∫—Ä—ã—Ç—å –∫ –Ω–∏–º —Å–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø)</p>
<h3 id="get-acl">Get-Acl</h3>
<p><code>(Get-Acl \\$srv\xl-share).access</code> –¥–æ—Å—Ç—É–ø ACL –Ω–∞ —É—Ä–æ–≤–Ω–µ
NTFS<br />
<code>Get-Acl C:\Drivers | Set-Acl C:\Distr</code> —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å NTFS
—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å –æ–¥–Ω–æ–π –ø–∞–ø–∫–∏ –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Ö –Ω–∞ –¥—Ä—É–≥—É—é</p>
<h3 id="ntfssecurity">NTFSSecurity</h3>
<p><code>Install-Module -Name NTFSSecurity -force</code><br />
<code>Get-Item "\\$srv\xl-share" | Get-NTFSAccess</code><br />
<code>Add-NTFSAccess -Path "\\$srv\xl-share" -Account "domain\xl-share" -AccessRights Fullcontrol -PassThru</code>
–¥–æ–±–∞–≤–∏—Ç—å<br />
<code>Remove-NTFSAccess -Path "\\$srv\xl-share" -Account "domain\xl-share" -AccessRights FullControl -PassThru</code>
—É–¥–∞–ª–∏—Ç—å<br />
<code>Get-ChildItem -Path "\\$srv\xl-share" -Recurse -Force | Clear-NTFSAccess</code>
—É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è, –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π<br />
<code>Get-ChildItem -Path "\\$srv\xl-share" -Recurse -Force | Enable-NTFSAccessInheritance</code>
–≤–∫–ª—é—á–∏—Ç—å NTFS –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</p>
<h3 id="storage">Storage</h3>
<p><code>Get-Command -Module Storage</code><br />
<code>Get-Disk</code> —Å–ø–∏—Å–æ–∫ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –¥–∏—Å–∫–æ–≤<br />
<code>Get-Partition</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ä–∞–∑–¥–µ–ª—ã –Ω–∞ –≤—Å–µ—Ö –¥–∏—Å–∫–∞—Ö<br />
<code>Get-Volume</code> —Å–ø–∏—Å–æ–∫ –ª–æ–≥–∏—á–∫–∏—Ö —Ä–∞–∑–¥–µ–ª–æ–≤<br />
<code>Get-PhysicalDisk</code> —Å–ø–∏—Å–æ–∫ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –¥–∏—Å–∫–æ–≤<br />
<code>Initialize-Disk 1 ‚ÄìPartitionStyle MBR</code> –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
–¥–∏—Å–∫<br />
<code>New-Partition -DriveLetter D ‚ÄìDiskNumber 1 -Size 500gb</code>
—Å–æ–∑–¥–∞—Ç—å —Ä–∞–∑–¥–µ–ª (–≤—ã–¥–µ–ª–∏—Ç—å –≤—Å–µ –º–µ—Å—Ç–æ -UseMaximumSize)<br />
<code>Format-Volume -DriveLetter D -FileSystem NTFS -NewFileSystemLabel Disk-D</code>
—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–¥–µ–ª<br />
<code>Set-Partition -DriveLetter D -IsActive $True</code> —Å–¥–µ–ª–∞—Ç—å
–∞–∫—Ç–∏–≤–Ω—ã–º<br />
<code>Remove-Partition -DriveLetter D ‚ÄìDiskNumber 1</code> —É–¥–∞–ª–∏—Ç—å
—Ä–∞–∑–¥–µ–ª<br />
<code>Clear-Disk -Number 1 -RemoveData</code> –æ—á–∏—Å—Ç–∏—Ç—å –¥–∏—Å–∫<br />
<code>Repair-Volume ‚Äìdriveletter C ‚ÄìScan</code> Check disk<br />
<code>Repair-Volume ‚Äìdriveletter C ‚ÄìSpotFix</code><br />
<code>Repair-Volume ‚Äìdriverletter C -Scan ‚ÄìCimsession $CIMSession</code></p>
<h3 id="iscsi">iSCSI</h3>
<p><code>New-IscsiVirtualDisk -Path D:\iSCSIVirtualDisks\iSCSI2.vhdx -Size 20GB</code>
—Å–æ–∑–¥–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π vhdx-–¥–∏—Å–∫ (–¥–ª—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
-UseFixed)<br />
<code>New-IscsiServerTarget -TargetName iscsi-target-2 -InitiatorIds "IQN:iqn.1991-05.com.microsoft:srv3.contoso.com"</code>
—Å–æ–∑–¥–∞—Ç—å Target<br />
<code>Get-IscsiServerTarget | fl TargetName, LunMappings</code><br />
<code>Connect-IscsiTarget -NodeAddress "iqn.1995-05.com.microsoft:srv2-iscsi-target-2-target" -IsPersistent $true</code>
–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–æ–º –∫ —Ç–∞—Ä–≥–µ—Ç—É<br />
<code>Get-IscsiTarget | fl</code><br />
<code>Disconnect-IscsiTarget -NodeAddress "iqn.1995-05.com.microsoft:srv2-iscsi-target-2-target" -Confirm:$false</code>
–æ—Ç–∫–ª—é—á–∏—Ç—å—Å—è</p>
<h1 id="activedirectory">ActiveDirectory</h1>
<h3 id="rsat-remote-server-administration-tools">RSAT (Remote Server
Administration Tools)</h3>
<p><code>DISM.exe /Online /add-capability /CapabilityName:Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0 /CapabilityName:Rsat.GroupPolicy.Management.Tools~~~~0.0.1.0</code><br />
<code>Add-WindowsCapability ‚Äìonline ‚ÄìName Rsat.Dns.Tools~~~~0.0.1.0</code><br />
<code>Add-WindowsCapability -Online -Name Rsat.DHCP.Tools~~~~0.0.1.0</code><br />
<code>Add-WindowsCapability ‚Äìonline ‚ÄìName Rsat.FileServices.Tools~~~~0.0.1.0</code><br />
<code>Add-WindowsCapability -Online -Name Rsat.WSUS.Tools~~~~0.0.1.0</code><br />
<code>Add-WindowsCapability -Online -Name Rsat.CertificateServices.Tools~~~~0.0.1.0</code><br />
<code>Add-WindowsCapability -Online -Name Rsat.RemoteDesktop.Services.Tools~~~~0.0.1.0</code><br />
<code>Get-WindowsCapability -Name RSAT* -Online | Select-Object -Property DisplayName, State</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–µ–Ω—Ç–æ–≤</p>
<h3 id="import-module-activedirectory">Import-Module
ActiveDirectory</h3>
<p><code>$Session = New-PSSession -ComputerName $srv</code> -Credential
$cred<code>\</code>Export-PSsession -Session $Session -Module
ActiveDirectory -OutputModule
ActiveDirectory<code>—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å –∏–∑ —É–¥–∞–ª–µ–Ω–Ω–æ–π —Å–µ—Å—Å–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å DC) \</code>Remove-PSSession
-Session $Session<code>\</code>Import-Module
ActiveDirectory<code>\</code>Get-Command -Module ActiveDirectory`</p>
<h3 id="adsi-active-directory-service-interface">ADSI (Active Directory
Service Interface)</h3>
<p><code>$d0 = $env:userdnsdomain</code><br />
<code>$d0 = $d0 -split "\."</code><br />
<code>$d1 = $d0[0]</code><br />
<code>$d2 = $d0[1]</code><br />
<code>$group = [ADSI]"LDAP://OU=Domain Controllers,DC=$d1,DC=$d2"</code><br />
<code>$group | select *</code></p>
<p><code>$Local_User = [ADSI]"WinNT://./–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä,user"</code><br />
<code>$Local_User | Get-Member</code><br />
<code>$Local_User.Description</code><br />
<code>$Local_User.LastLogin</code> –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
–ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
<h3 id="ldap-lightweight-directory-access-protocol">LDAP (Lightweight
Directory Access Protocol)</h3>
<p><code>$ldapsearcher = New-Object System.DirectoryServices.DirectorySearcher</code><br />
<code>$ldapsearcher.SearchRoot = "LDAP://OU=Domain Controllers,DC=$d1,DC=$d2"</code><br />
<code>$ldapsearcher.Filter = "(objectclass=computer)"</code><br />
<code>$dc = $ldapsearcher.FindAll().path</code></p>
<p><code>$usr = $env:username</code> c–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø —Ç–µ–∫—É—â–µ–≥–æ
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>$ldapsearcher = New-Object System.DirectoryServices.DirectorySearcher</code><br />
<code>$ldapsearcher.Filter = "(&amp;(objectCategory=User)(samAccountName=$usr))"</code><br />
<code>$usrfind = $ldapsearcher.FindOne()</code><br />
<code>$groups = $usrfind.properties.memberof -replace "(,OU=.+)"</code><br />
<code>$groups = $groups -replace "(CN=)"</code></p>
<p>DC (Domain Component) - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–æ–º–µ–Ω–Ω–æ–≥–æ –∏–º–µ–Ω–∏<br />
OU (Organizational Unit) - –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è (type),
–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤<br />
Container - —Ç–∞–∫ –∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤
–æ—Ç–ª–∏—á–∏–∏ –æ—Ç –ø–æ–¥—Ä–∞–¥–µ–ª–µ–Ω–∏–π –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã, —É–¥–∞–ª–µ–Ω—ã, —Å–æ–∑–¥–∞–Ω—ã
–∏–ª–∏ —Å–≤—è–∑–∞–Ω—ã —Å –æ–±—ä–µ–∫—Ç–æ–º –≥—Ä—É–ø–ø–æ–≤–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏ (Computers, Domain
Controllers, Users)<br />
DN (Distinguished Name) ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è –æ–±—ä–µ–∫—Ç–∞ –∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –ª–µ—Å—É
AD. –í DN –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –≤ –¥–µ—Ä–µ–≤–µ (–ø—É—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏),
—Ç—Ä–µ–±—É–µ–º–æ–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –∏–ª–∏ –µ–µ –ø–æ–∏—Å–∫–∞<br />
CN (Common Name) - –æ–±—â–µ–µ –∏–º—è</p>
<p><code>(Get-ADObject (Get-ADRootDSE).DefaultNamingContext -Properties wellKnownObjects).wellKnownObjects</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é<br />
<code>redircmp OU=Client Computers,DC=root,DC=domain,DC=local</code>
–∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é<br />
<code>redirusr</code> –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</p>
<h3 id="laps-local-admin-password-management">LAPS (Local Admin Password
Management)</h3>
<p><code>Import-module AdmPwd.ps</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å<br />
<code>Get-AdmPwdPassword -ComputerName NAME</code> –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å
–ø–∞—Ä–æ–ª—å<br />
<code>Reset-AdmPwdPassword -ComputerName NAME</code> –∏–∑–º–µ–Ω–∏—Ç—å
–ø–∞—Ä–æ–ª—å<br />
<code>Get-ADComputer -Filter * -SearchBase "DC=$d1,DC=$d2" | Get-AdmPwdPassword -ComputerName {$_.Name} | select ComputerName,Password,ExpirationTimestamp | Out-GridView</code><br />
<code>Get-ADComputer -Identity $srv | Get-AdmPwdPassword -ComputerName {$_.Name} | select ComputerName,Password,ExpirationTimestamp</code></p>
<h3 id="recycle-bin">Recycle Bin</h3>
<p>–£–¥–∞–ª–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∫–æ—Ä–∑–∏–Ω–µ AD –≤ —Ç–µ—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞—Ö–æ—Ä–æ–Ω–µ–Ω–∏—è
(–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ –∞—Ç—Ä–∏–±—É—Ç–µ –¥–æ–º–µ–Ω–∞ msDS-deletedObjectLifetime), –∑–∞–¥–∞–Ω–Ω–æ–º
–¥–ª—è –ª–µ—Å–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ 180 –¥–Ω–µ–π. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–π —Å—Ä–æ–∫ –ø—Ä–æ—à–µ–ª, –æ–±—ä–µ–∫—Ç –≤—Å–µ
–µ—â–µ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ Deleted Objects, –Ω–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –µ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
–∏ —Å–≤—è–∑–µ–π –æ—á–∏—â–∞—é—Ç—Å—è (Recycled Object). –ü–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è –ø–µ—Ä–∏–æ–¥–∞
tombstoneLifetime (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–∞–∫–∂–µ 180 –¥–Ω–µ–π, –Ω–æ –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å)
–æ–±—ä–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ AD –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º –æ—á–∏—Å—Ç–∫–∏.<br />
<code>Get-ADForest domain.local</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —Ä–∞–±–æ—Ç—ã
–ª–µ—Å–∞<br />
<code>Set-ADForestMode -Identity domain.local -ForestMode Windows2008R2Forest -force</code>
—É–≤–µ–ª–∏—á–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —Ä–∞–±–æ—Ç—ã –ª–µ—Å–∞<br />
<code>Enable-ADOptionalFeature ‚ÄìIdentity "CN=Recycle Bin Feature,CN=Optional Features,CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration,DC=domain,DC=local" ‚ÄìScope ForestOrConfigurationSet ‚ÄìTarget "domain.local"</code>
–≤–∫–ª—é—á–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É<br />
<code>Get-ADOptionalFeature "Recycle Bin Feature" | select-object name,EnabledScopes</code>
–µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ EnabledScopes –Ω–µ –ø—É—Å—Ç–æ–µ, –∑–Ω–∞—á–∏—Ç –≤ –¥–æ–º–µ–Ω–µ –∫–æ—Ä–∑–∏–Ω–∞ Active
Directory –≤–∫–ª—é—á–µ–Ω–∞<br />
<code>Get-ADObject -Filter 'Name -like "*tnas*"' -IncludeDeletedObjects</code>
–Ω–∞–π—Ç–∏ —É–¥–∞–ª–µ–Ω–Ω—É—é (Deleted: True) –£–ó (ObjectClass: user) –≤ AD<br />
<code>Get-ADObject -Filter 'Name -like "*tnas*"' ‚ÄìIncludeDeletedObjects -Properties *| select-object Name, sAMAccountName, LastKnownParent, memberOf, IsDeleted | fl</code>
–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ IsDeleted, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥–∏–ª—Å—è
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º (LastKnownParent) –∏ —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø, –≤ –∫–æ—Ç–æ—Ä—ã—Ö
–æ–Ω —Å–æ—Å—Ç–æ—è–ª<br />
<code>Get-ADObject ‚Äìfilter {Deleted -eq $True -and ObjectClass -eq "user"} ‚ÄìincludeDeletedObjects</code>
–≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π<br />
<code>Restore-ADObject -Identity "3dc33c7c-b912-4a19-b1b7-415c1395a34e"</code>
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é –∞—Ç—Ä–∏–±—É—Ç–∞ ObjectGUID<br />
<code>Get-ADObject -Filter 'SAMAccountName -eq "tnas-01"' ‚ÄìIncludeDeletedObjects | Restore-ADObject</code>
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ SAMAccountName<br />
<code>Get-ADObject -Filter {Deleted -eq $True -and ObjectClass -eq 'group' -and Name -like '*Allow*'} ‚ÄìIncludeDeletedObjects | Restore-ADObject ‚ÄìVerbose</code>
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥—Ä—É–ø–ø—É –∏–ª–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä</p>
<h3 id="thumbnailphoto">thumbnailPhoto</h3>
<p><code>$photo = [byte[]](Get-Content C:\Install\adm.jpg -Encoding byte)</code>
–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ –º–∞—Å—Å–∏–≤ –±–∞–π—Ç–æ–≤ (jpeg/bmp —Ñ–∞–π–ª, —Ä–∞–∑–º–µ—Ä–æ–º
—Ñ–æ—Ç–æ –¥–æ 100 –ö–± –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º 96?96)<br />
<code>Set-ADUser support4 -Replace @{thumbnailPhoto=$photo}</code>
–∑–∞–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ thumbnailPhoto</p>
<h3 id="addomaincontroller">ADDomainController</h3>
<p><code>Get-ADDomainController</code> –≤—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º
–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞ (LogonServer), –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∞–Ω–Ω—ã–º
–∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (DC –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤
—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–æ–ø–æ–ª–æ–≥–∏–µ–π —Å–∞–π—Ç–æ–≤ AD)<br />
<code>Get-ADDomainController -Discover -Service PrimaryDC</code> –Ω–∞–π—Ç–∏
–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å —Ä–æ–ª—å—é PDC –≤ –¥–æ–º–µ–Ω–µ<br />
<code>Get-ADDomainController -Filter * | ft HostName,IPv4Address,Name,Site,OperatingSystem,IsGlobalCatalog</code>
—Å–ø–∏—Å–æ–∫ –≤—Å–µ DC, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫ —Å–∞–π—Ç—É, –≤–µ—Ä—Å–∏–∏ –û–° –∏ GC</p>
<p>–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –û–° —Å–ª—É–∂–±–∞ NetLogon –¥–µ–ª–∞–µ—Ç DNS –∑–∞–ø—Ä–æ—Å —Å–æ —Å–ø–∏—Å–∫–æ–º
–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –¥–æ–º–µ–Ω–∞ (–∫ SRV –∑–∞–ø–∏—Å–∏ <em>ldap._tcp.dc._msdcs.domain</em>),
DNS –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ DC –≤ –¥–æ–º–µ–Ω–µ —Å –∑–∞–ø–∏—Å—å—é Service Location (SRV).
–ö–ª–∏–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç LDAP –∑–∞–ø—Ä–æ—Å –∫ DC –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–∞–π—Ç–∞ AD –ø–æ —Å–≤–æ–µ–º—É IP
–∞–¥—Ä–µ—Å—É. –ö–ª–∏–µ–Ω—Ç —á–µ—Ä–µ–∑ DNS –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –¥–æ–º–µ–Ω–∞ –≤ —Å–∞–π—Ç–µ
(–≤ —Ä–∞–∑–¥–µ–ª–µ _tcp.sitename._sites‚Ä¶).</p>
<p>USN (Update Sequence Numbers) - —Å—á–µ—Ç—á–∏–∫ –Ω–æ–º–µ—Ä–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ
–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —É –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ AD. –ü—Ä–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏
–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ USN, –æ–±—ä–µ–∫—Ç —Å –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–º USN –±—É–¥–µ—Ç
–ø—Ä–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω –æ–±—ä–µ–∫—Ç–æ–º —Å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º USN. –ù–∞—Ö–æ–¥–∏—Ç—Å—è –≤
—Å–≤–æ–π—Å—Ç–≤–∞—Ö - Object (–≤–∫–ª—é—á–∏—Ç—å View - Advanced Features). –ö–∞–∂–¥—ã–π
–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫ USN, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—á–∏–Ω–∞–µ—Ç
–æ—Ç—Å—á–µ—Ç –≤ –º–æ–º–µ–Ω—Ç –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ Dcpromo –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å
–∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ç–µ—á–µ–Ω–∏–µ –≤—Å–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞.
–ó–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ USN —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ
–¥–æ–º–µ–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è, —ç—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–ª–∏
—É–¥–∞–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞.</p>
<p><code>Get-ADDomainController -Filter * | % {</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å USN
–æ–±—ä–µ–∫—Ç–∞ –Ω–∞ –≤—Å–µ—Ö DC –≤ –¥–æ–º–µ–Ω–µ<code>\</code>Get-ADUser -Server $_.HostName
-Identity support4 -Properties uSNChanged | select
SamAccountName,uSNChanged<code>\</code>}`</p>
<p><code>dcpromo /forceremoval</code> –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç –ø–æ–Ω–∏–∂–µ–Ω–∏–µ –≤
—Ä–æ–ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞ –¥–æ —É—Ä–æ–≤–Ω—è —Ä—è–¥–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞. –ü–æ—Å–ª–µ –ø–æ–Ω–∏–∂–µ–Ω–∏—è —Ä–æ–ª–∏
–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫ –≤ –¥–æ–º–µ–Ω–µ –Ω–∞ —ç—Ç–æ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä. –î–∞–ª–µ–µ
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –≤–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Å–æ—Å—Ç–∞–≤ –¥–æ–º–µ–Ω–∞, –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ
–ø—Ä–æ—Ü–µ—Å—Å–∞, —Ç.–µ. –ø–æ–≤—ã—à–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ —É—Ä–æ–≤–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞.</p>
<h3 id="adcomputer">ADComputer</h3>
<p><code>nltest /DSGETDC:$env:userdnsdomain</code> —É–∑–Ω–∞—Ç—å –Ω–∞ –∫–∞–∫–æ–º DC
–∞—É–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω —Ö–æ—Å—Ç (Logon Server)<br />
<code>nltest /SC_RESET:$env:userdnsdomain\srv-dc2.$env:userdnsdomain</code>
–ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä –Ω–∞ –¥—Ä—É–≥–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞ AD –≤—Ä—É—á–Ω—É—é (The
command completed successfully)<br />
<code>Get-ADComputer ‚ÄìIdentity $env:computername -Properties PasswordLastSet</code>
–≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ<br />
<code>Test-ComputerSecureChannel ‚Äìverbose</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ
–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –¥–æ–º–µ–Ω–æ–º (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
–ø–∞—Ä–æ–ª—é, —Ö—Ä–∞–Ω—è—â–µ–º—É—Å—è –≤ AD)<br />
<code>Reset-ComputerMachinePassword -Credential domain\admin</code>
–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å<br />
<code>Netdom ResetPWD /Server:dc-01 /UserD:domain\admin /PasswordD:*</code>
—Å–±—Ä–æ—Å–∏—Ç—å —Ö—ç—à –ø–∞—Ä–æ–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ –¥–æ–º–µ–Ω–µ (–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ
—Ç—Ä–µ–±—É–µ—Ç—Å—è)<br />
<code>Search-ADAccount -AccountDisabled -ComputersOnly | select Name,LastLogonDate,Enabled</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã</p>
<p><code>Get-ADComputer -Filter * -Properties * | select name</code>
—Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ –≤ –¥–æ–º–µ–Ω–µ (Filter), –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞
(Properties)<br />
<code>Get-ADComputer -Identity $srv -Properties * | ft Name,LastLogonDate,PasswordLastSet,ms-Mcs-AdmPwd -Autosize</code>
–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ AD (Identity)<br />
<code>Get-ADComputer -SearchBase "OU=Domain Controllers,DC=$d1,DC=$d2" -Filter * -Properties * | ft Name, LastLogonDate, distinguishedName -Autosize</code>
–ø–æ–∏—Å–∫ –≤ –±–∞–∑–µ –ø–æ DN (SearchBase)</p>
<p><code>(Get-ADComputer -Filter {enabled -eq "true"}).count</code>
–ø–æ–ª—É—á–∏—Ç—å –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö (–Ω–µ–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö) –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤<br />
<code>(Get-ADComputer -Filter {enabled -eq "true" -and OperatingSystem -like "*Windows Server 2016*"}).count</code>
–∫–æ–ª-–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–ø—å—é—Ç–µ—Ä–æ–≤ —Å –û–° WS 2016</p>
<p><code>Get-ADComputer -Filter * -Properties * | select @{Label="Ping Status"; Expression={</code><br />
<code>$ping = ping -n 1 -w 50 $_.Name</code><br />
<code>if ($ping -match "TTL") {"Online"} else {"Offline"}</code><br />
<code>}},</code><br />
<code>@{Label="Status"; Expression={</code><br />
<code>if ($_.Enabled -eq "True") {$_.Enabled -replace "True","Active"} else {$_.Enabled -replace "False","Blocked"}</code><br />
<code>}}, Name, IPv4Address, OperatingSystem, @{Label="UserOwner"; Expression={$_.ManagedBy -replace "(CN=|,.+)"}</code><br />
<code>},Created | Out-GridView</code></p>
<h3 id="aduser">ADUser</h3>
<p><code>Get-ADUser -Identity support4 -Properties *</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö
–∞—Ç—Ä–∏–±—É—Ç–æ–≤<br />
<code>Get-ADUser -Identity support4 -Properties DistinguishedName, EmailAddress, Description</code>
–ø—É—Ç—å DN, email –∏ –æ–ø–∏—Å–∞–Ω–∏–µ<br />
<code>Get-ADUser -Filter {(Enabled -eq "True") -and (mail -ne "null")} -Properties mail | ft Name,mail</code>
—Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –µ—Å—Ç—å –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫<br />
<code>Get-ADUser -Filter {SamAccountName -like "*"} | Measure-Object</code>
–ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª-–≤–æ –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (Count)<br />
<code>Get-ADUser -Filter * -Properties WhenCreated | sort WhenCreated | ft Name, whenCreated</code>
–¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è<br />
<code>Get-ADUser -Identity support4 -property LockedOut | select samaccountName,Name,Enabled,Lockedout</code><br />
<code>Enabled=True</code> —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –≤–∫–ª—é—á–µ–Ω–∞ - –¥–∞<br />
<code>Lockedout=False</code> —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä,
–ø–æ–ª–∏—Ç–∏–∫–æ–π –ø–∞—Ä–æ–ª–µ–π) - –Ω–µ—Ç<br />
<code>Get-ADUser -Identity support4 | Unlock-ADAccount</code>
—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å<br />
<code>Disable-ADAccount -Identity support4</code> –æ—Ç–∫–ª—é—á–∏—Ç—å —É—á–µ—Ç–Ω—É—é
–∑–∞–ø–∏—Å—å<br />
<code>Enable-ADAccount -Identity support4</code> –≤–∫–ª—é—á–∏—Ç—å —É—á–µ—Ç–Ω—É—é
–∑–∞–ø–∏—Å—å<br />
<code>Search-ADAccount -LockedOut</code> –Ω–∞–π—Ç–∏ –≤—Å–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
—É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏<br />
<code>Search-ADAccount -AccountDisabled | select Name,LastLogonDate,Enabled</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Å –≤—Ä–µ–º–µ–Ω–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ
–≤—Ö–æ–¥–∞</p>
<p><code>Get-ADUser -Identity support4 -Properties PasswordLastSet,PasswordExpired,PasswordNeverExpires</code><br />
<code>PasswordLastSet</code> –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è<br />
<code>PasswordExpired=False</code> –ø–∞—Ä–æ–ª—å –∏—Å—Ç–µ–∫ - –Ω–µ—Ç<br />
<code>PasswordNeverExpires=True</code> —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª—è –Ω–µ –∏—Å—Ç–µ–∫–∞–µ—Ç
- –¥–∞<br />
<code>Set-ADAccountPassword support4 -Reset -NewPassword (ConvertTo-SecureString -AsPlainText "password" -Force -Verbose)</code>
–∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏<br />
<code>Set-ADUser -Identity support4 -ChangePasswordAtLogon $True</code>
—Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –≤—Ö–æ–¥–µ –≤ —Å–∏—Å—Ç–µ–º—É</p>
<p><code>$day = (Get-Date).adddays(-90)</code><br />
<code>Get-ADUser -filter {(passwordlastset -le $day)} | ft</code>
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–µ–Ω—è–ª–∏ —Å–≤–æ–π –ø–∞—Ä–æ–ª—å –±–æ–ª—å—à–µ 90 –¥–Ω–µ–π</p>
<p><code>$day = (Get-Date).adddays(-30)</code><br />
<code>Get-ADUser -filter {(Created -ge $day)} -Property Created | select Name,Created</code>
–ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞ 30 –¥–Ω–µ–π</p>
<p><code>$day = (Get-Date).adddays(-360)</code><br />
<code>Get-ADUser -Filter {(LastLogonTimestamp -le $day)} -Property LastLogonTimestamp | select Name,SamAccountName,@{n='LastLogonTimestamp';e={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} | sort -Descending LastLogonTimestamp</code>
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ª–æ–≥–∏–Ω–∏–ª–∏—Å—å –±–æ–ª—å—à–µ 360 –¥–Ω–µ–π. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞
LastLogonTimestamp —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç 9 –¥–æ 14 –¥–Ω–µ–π.<br />
<code>| Disable-ADAccount $_.SamAccountName</code> –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å<br />
<code>-WhatIf</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—ã–≤–æ–¥ –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π</p>
<h3 id="adgroupmember">ADGroupMember</h3>
<p><code>(Get-ADUser -Identity support4 -Properties MemberOf).memberof</code>
—Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ—Å—Ç–æ–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å<br />
<code>Get-ADGroupMember -Identity "Domain Admins" | Select Name,SamAccountName</code>
—Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–µ<br />
<code>Add-ADGroupMember -Identity "Domain Admins" -Members support5</code>
–¥–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É<br />
<code>Remove-ADGroupMember -Identity "Domain Admins" -Members support5 -force</code>
—É–¥–∞–ª–∏—Ç—å –∏–∑ –≥—Ä—É–ø–ø—ã<br />
<code>Get-ADGroup -filter * | where {!($_ | Get-ADGroupMember)} | Select Name</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç—ã—Ö –≥—Ä—É–ø–ø (-Not)</p>
<h3 id="adreplication">ADReplication</h3>
<p><code>Get-Command -Module ActiveDirectory -Name *Replication*</code>
—Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥–ª–µ—Ç–æ–≤ –º–æ–¥—É–ª—è<br />
<code>Get-ADReplicationFailure -Target dc-01</code> —Å–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏<br />
<code>Get-ADReplicationFailure -Target $env:userdnsdomain -Scope Domain</code><br />
<code>Get-ADReplicationPartnerMetadata -Target dc-01 | select Partner,LastReplicationAttempt,LastReplicationSuccess,LastReplicationResult,LastChangeUsn</code>
–≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏ –≤—Ä–µ–º—è —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏<br />
<code>Get-ADReplicationUpToDatenessVectorTable -Target dc-01</code>
Update Sequence Number (USN) —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –Ω–∞
–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è (–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
–∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞), –ø—Ä–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DC –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ USN,
–æ–±—ä–µ–∫—Ç —Å –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–º USN –ø—Ä–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω –≤—ã—Å–æ–∫–∏–º
USN.</p>
<h1 id="repadmin">repadmin</h1>
<p><code>repadmin /replsummary</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ –≤—Å–µ—Ö DC –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é (Source –∏ Destination) –∏ –∏—Ö
—Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å —É—á–µ—Ç–æ–º –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤<br />
<code>repadmin /showrepl $srv</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Å–µ—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –ø–æ
—Ä–µ–ø–ª–∫–∞—Ü–∏–∏ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ Naming Contexts
(DC=ForestDnsZones, DC=DomainDnsZones, CN=Schema,
CN=Configuration)<br />
<code>repadmin /replicate $srv2 $srv1 DC=domain,DC=local</code>
–≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é —Å $srv1 –Ω–∞ $srv2 —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∞
–¥–æ–º–µ–Ω–∞<br />
<code>repadmin /SyncAll /AdeP</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–µ–∂—Å–∞–π—Ç–æ–≤—É—é –∏—Å—Ö–æ–¥—è—â—É—é
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Å–æ –≤—Å–µ–º–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏ –ø–æ
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>/A</code> –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ NC<br />
<code>/d</code> –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä—ã –ø–æ DN (–≤–º–µ—Å—Ç–æ GUID
DNS - –≥–ª–æ–±–∞–ª—å–Ω—ã–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º)<br />
<code>/e</code> –º–µ–∂—Å–∞–π—Ç–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç
—Ç–æ–ª—å–∫–æ —Å DC —Ç–µ–∫—É—â–µ–≥–æ —Å–∞–π—Ç–∞)<br />
<code>/P</code> –∏–∑–≤–µ—â–∞—Ç—å –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö —Å —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
–æ–ø—Ä–∞—à–∏–≤–∞—Ç—å –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö)<br />
<code>repadmin /Queue $srv</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–æ–ª-–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤—Ö–æ–¥—è—â–µ–π
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ (–æ—á–µ—Ä–µ–¥—å), –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å (–ø—Ä–∏—á–∏–Ω–æ–π –º–æ–∂–µ—Ç –±—ã—Ç—å
–±–æ–ª—å—à–æ–µ –∫–æ–ª-–≤–æ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –∏–ª–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ 1000 –æ–±—ä–µ–∫—Ç–æ–≤ —Å–∫—Ä–∏–ø—Ç–æ–º)<br />
<code>repadmin /showbackup *</code> —É–∑–Ω–∞—Ç—å –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ Backup</p>
<p><code>Error: 1722</code> —Å–µ—Ä–≤–µ—Ä rpc –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–æ—à–∏–±–∫–∞ –æ—Ç–∫–∞—Ç–∞
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏). –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º—è –¥–æ–º–µ–Ω–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–µ—Ç–µ–≤–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞, –ø–µ—Ä–≤—ã–º
–¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ –∞–¥—Ä–µ—Å DNS-—Å–µ—Ä–≤–µ—Ä–∞ –¥—Ä—É–≥–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞, –≤—Ç–æ—Ä—ã–º —Å–≤–æ–π
–∞–¥—Ä–µ—Å.<br />
<code>Get-Service -ComputerName $srv | select name,status | ? name -like "RpcSs"</code><br />
<code>Get-Service -ComputerName $srv -Name RpcSs -RequiredServices</code>
–∑–∞–≤–∏—Å–∏–º—ã–µ —Å–ª—É–∂–±—ã<br />
–ó–∞–≤–∏—Å–∏–º—ã–µ —Å–ª—É–∂–±—ã RPC:<br />
‚Äú–°–ª—É–∂–±–∞ —Å–≤–µ–¥–µ–Ω–∏–π –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —Å–µ—Ç—è—Ö‚Äù - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–π
–∑–∞–ø—É—Å–∫. –ï—Å–ª–∏ —Å–ª—É–∂–±–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–æ ‚Äú—Å–ª—É–∂–±—ã —Å–ø–∏—Å–∫–∞ —Å–µ—Ç–µ–π‚Äù, –º–æ–∂–µ—Ç –ø–∞–¥–∞—Ç—å
—Å–≤—è–∑—å —Å –¥–æ–º–µ–Ω–æ–º (netlogon)<br />
‚Äú–¶–µ–Ω—Ç—Ä —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫–ª—é—á–µ–π Kerberos‚Äù<br />
‚ÄúDNS-—Å–µ—Ä–≤–µ—Ä‚Äù<br />
<code>nslookup $srv</code><br />
<code>tnc $srv -p 135</code><br />
<code>repadmin /retry</code> –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É –ø—Ä–∏–≤—è–∑–∫–∏ –∫ —Ü–µ–ª–µ–≤–æ–º—É DC,
–µ—Å–ª–∏ –±—ã–ª–∞ –æ—à–∏–±–∫–∞ 1722 –∏–ª–∏ 1753 (RPC –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)</p>
<p><code>repadmin /showrepl $srv</code><br />
<code>Last attempt @ 2022-07-15 10:46:01 –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —Å –æ—à–∏–±–∫–æ–π, —Ä–µ–∑—É–ª—å—Ç–∞—Ç 8456 (0x2108)</code>
–ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ showrepl —ç—Ç–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞, –µ–≥–æ –æ—à–∏–±–∫–∞: 8457 (0x2109)<br />
<code>Last success @ 2022-07-11 02:29:46</code> –ø–æ—Å–ª–µ–¥–Ω–∏–π —É—Å–ø–µ—Ö<br />
–ö–æ–≥–¥–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∞, –û–° –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ DSA - not
writable –æ–¥–Ω–æ –∏–∑ —á–µ—Ç—ã—Ä–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π:<br />
<code>Path: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\NTDS\Parameters</code><br />
<code>Dsa Not Writable</code><br />
<code>#define DSA_WRITABLE_GEN 1</code> –≤–µ—Ä—Å–∏—è –ª–µ—Å–∞ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å
–û–°<br />
<code>#define DSA_WRITABLE_NO_SPACE 2</code> –Ω–∞ –¥–∏—Å–∫–µ, –≥–¥–µ —Ä–∞–∑–º–µ—â–µ–Ω–∞
–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Active Directory –∏–ª–∏ —Ñ–∞–π–ª—ã –∂—É—Ä–Ω–∞–ª–æ–≤ (–ª–æ–≥–∏), –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
—Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞<br />
<code>#define DSA_WRITABLE_USNROLLBCK 4</code> –æ—Ç–∫–∞—Ç USN –ø—Ä–æ–∏–∑–æ—à–µ–ª –∏–∑-–∑–∞
–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–∫–∞—Ç–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Active Directory –≤–æ –≤—Ä–µ–º–µ–Ω–∏
(–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Å–Ω–∞–ø—à–æ—Ç–∞)<br />
<code>#define DSA_WRITABLE_CORRUPT_UTDV 8</code> –≤–µ–∫—Ç–æ—Ä –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏
–ø–æ–≤—Ä–µ–∂–¥–µ–Ω –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞</p>
<h1 id="dcdiag">dcdiag</h1>
<p><code>dcdiag /s:&lt;DomainController&gt; [/n:&lt;NamingContext&gt;] [[/u:&lt;domain\user&gt;] [/p:&lt;password&gt;]] [{/a|/e}{/q|/v}] [/f:&lt;LogFile&gt;] [/ferr:&lt;ErrorLog&gt;] [/test:&lt;test&gt;] [/fix]</code><br />
<code>dcdiag /Test:replications /s:dc-01</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ—à–∏–±–∫–∏
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>dcdiag /Test:DNS /e /v /q</code> —Ç–µ—Å—Ç DNS<br />
<code>/a</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–∞–Ω–Ω–æ–≥–æ —Å–∞–π—Ç–∞<br />
<code>/e</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è<br />
<code>/q</code> –≤—ã–≤–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö<br />
<code>/v</code> –≤—ã–≤–æ–¥–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é<br />
<code>/fix</code> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –æ—à–∏–±–∫–∏<br />
<code>/test:</code><br />
<code>NetLogons</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Connectivity</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é DNS –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —ç—Ö–æ-–ø–∞–∫–µ—Ç –Ω–∞ –∫–∞–∂–¥—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
–¥–æ–º–µ–Ω–∞ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º LDAP –∏ RPC –∫ –∫–∞–∂–¥–æ–º—É
–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É –¥–æ–º–µ–Ω–∞<br />
<code>Services</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤—Å–µ—Ö —Å–ª—É–∂–±,
–Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è —Ä–∞–±–æ—Ç—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞, –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ
–¥–æ–º–µ–Ω–∞<br />
<code>Systemlog</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –≤ –∂—É—Ä–Ω–∞–ª–∞—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
–¥–æ–º–µ–Ω–∞<br />
<code>FRSEvent</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—à–∏–±–∫–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –≤ —Ä–∞–±–æ—Ç–µ —Å–ª—É–∂–±—ã
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤, —á—Ç–æ –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ–±–ª–µ–º –≤ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏
SYSVOL –∏, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∫–æ–ø–∏–π –æ–±—ä–µ–∫—Ç–æ–≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö
–ø–æ–ª–∏—Ç–∏–∫<br />
<code>FSMOCheck</code> –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª–∏ —Ö–æ–∑—è–µ–≤ –æ–ø–µ—Ä–∞—Ü–∏–π, –∞ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ
–∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞,
–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –≤—Ä–µ–º–µ–Ω–∏, —Å–µ—Ä–≤–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ –∏ —Ü–µ–Ω—Ç—Ä —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è
–∫–ª—é—á–µ–π (–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ KDC, PDC, —Å–µ—Ä–≤–µ—Ä—É
–≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞)<br />
<code>KnowsOfRoleHolders</code> –øg—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –¥–æ–º–µ–Ω–∞ –∫–æ –≤—Å–µ–º –ø—è—Ç–∏ —Ö–æ–∑—è–µ–≤–∞–º –æ–ø–µ—Ä–∞—Ü–∏–π (—Ä–æ–ª—è–º–∏ FSMO)<br />
<code>MachineAccount</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É—á–µ—Ç–Ω–æ–π
–∑–∞–ø–∏—Å–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Å–ª—É–∂–± —ç—Ç–æ–≥–æ
–∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –¥–æ–º–µ–Ω–æ–º). –ï—Å–ª–∏
–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞, –µ–µ –º–æ–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å –ø–æ–º–æ—â—å—é —É—Ç–∏–ª–∏—Ç—ã dcdiag, —É–∫–∞–∑–∞–≤
–ø–∞—Ä–∞–º–µ—Ç—Ä—ã /fixmachineaccount –∏–ª–∏ /recreatemachineaccount<br />
<code>Advertising</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞
—Å–æ–æ–±—â–∞–µ—Ç –æ —Å–µ–±–µ –∏ –æ —Å–≤–æ–µ–π —Ä–æ–ª–∏ —Ö–æ–∑—è–∏–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–π. –≠—Ç–æ—Ç —Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è
–Ω–µ—É–¥–∞—á–Ω–æ, –µ—Å–ª–∏ —Å–ª—É–∂–±–∞ NetLogon –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞<br />
<code>CheckSDRefDom</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –¥–æ–º–µ–Ω–æ–≤ —Å—Å—ã–ª–æ–∫
–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º<br />
<code>CrossRefValidation</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω—ã—Ö
—Å—Å—ã–ª–æ–∫ –¥–ª—è –¥–æ–º–µ–Ω–æ–≤<br />
<code>RRSSysvol</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–ª—è FRS
SYSVOL<br />
<code>Intersite</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–º–µ—à–∞—Ç—å
–Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å–∞–π—Ç–∞–º–∏. –ö–æ–º–ø–∞–Ω–∏—è Microsoft –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç,
—á—Ç–æ –∏–Ω–æ–≥–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç—Ç–æ–≥–æ —Ç–µ—Å—Ç–∞ –º–æ–≥—É—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –Ω–µ—Ç–æ—á–Ω—ã–º–∏<br />
<code>KCCEvent</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±–µ–∑–æ—à–∏–±–æ—á–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤
—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å–∞–π—Ç–∞–º–∏<br />
<code>NCSecDesc</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –¥–ª—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏
–≤ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è<br />
<code>ObjectsReplicated</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–∞
—Å–µ—Ä–≤–µ—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –∏ –æ–±—ä–µ–∫—Ç–æ–≤ —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤<br />
<code>OutboundSecureChannels</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö
–∫–∞–Ω–∞–ª–æ–≤ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º–∏ –¥–æ–º–µ–Ω–∞ –≤ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–º –¥–æ–º–µ–Ω–µ<br />
<code>Replications</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É
–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º–∏ –¥–æ–º–µ–Ω–∞ –∏ —Å–æ–æ–±—â–∞–µ—Ç –æ–±–æ –≤—Å–µ—Ö –æ—à–∏–±–∫–∞—Ö –ø—Ä–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>RidManager</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
—Ö–æ–∑—è–∏–Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤<br />
<code>VerifyEnterpriseReferences</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
—Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ —Å–ª—É–∂–±—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –≤—Å–µ—Ö
–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö –¥–æ–º–µ–Ω–∞ –≤ –ª–µ—Å—É<br />
<code>VerifyReferences</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã—Ö
—Å—Å—ã–ª–æ–∫ —Å–ª—É–∂–±—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º
–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞<br />
<code>VerifyReplicas</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤
–∫–∞—Ç–∞–ª–æ–≥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏—Ö —É—á–∞—Å—Ç–∏–µ –≤
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏</p>
<h1 id="ntdsutil">ntdsutil</h1>
<p>–ü–µ—Ä–µ–Ω–æ—Å –ë–î AD (ntds.dit):<br />
<code>Get-Acl C:\Windows\NTDS | Set-Acl D:\AD-DB</code> —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å NTFS
—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –Ω–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥<br />
<code>Stop-Service -ComputerName dc -name NTDS</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂–±—É
Active Directory Domain Services<br />
<code>ntdsutil</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —É—Ç–∏–ª–∏—Ç—É ntdsutil<br />
<code>activate instance NTDS</code> –≤—ã–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –±–∞–∑—ã
AD<br />
<code>files</code> –ø–µ—Ä–µ–π–¥–µ–º –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç files, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤–æ–∑–º–æ–∂–Ω–æ
–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏—è —Å —Ñ–∞–π–ª–∞–º–∏ –±–∞–∑—ã ntds.dit<br />
<code>move DB to D:\AD-DB\</code> –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –±–∞–∑—É AD –≤ –Ω–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥
(–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω–æ –µ–≥–æ —Å–æ–∑–¥–∞—Ç—å)<br />
<code>info</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ë–î –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–æ–≤–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ<br />
<code>move logs to D:\AD-DB\</code> –ø–µ—Ä–µ–º–µ—Å—Ç–∏–º –≤ —Ç–æ—Ç –∂–µ –∫–∞—Ç–∞–ª–æ–≥ —Ñ–∞–π–ª—ã —Å
–∂—É—Ä–Ω–∞–ª–∞–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π<br />
<code>quit</code><br />
<code>Start-Service -ComputerName dc -name NTDS</code></p>
<p>–°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è DSRM (—Ä–µ–∂–∏–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ª—É–∂–± –∫–∞—Ç–∞–ª–æ–≥–æ–≤):<br />
<code>ntdsutil</code><br />
<code>set dsrm password</code><br />
<code>reset password on server NULL</code><br />
–Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å<br />
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è<br />
<code>quit</code><br />
<code>quit</code></p>
<p>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –ø–∞—Ä–æ–ª–µ–º –£–ó –≤ AD:<br />
<code>ntdsutil</code><br />
<code>set dsrm password</code><br />
<code>sync from domain account dsrmadmin</code><br />
<code>quit</code><br />
<code>quit</code></p>
<p>–û—à–∏–±–∫–∞ 0x00002e2 –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –û–°.<br />
–ó–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–µ–Ω–∏—è WinRE (Windows Recovery Environment)
- Startup Settings - Restart - DSRM (Directory Services Restore
Mode)<br />
<code>reagentc /boottore</code> shutdown /f /r /o /t 0 –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –≤
—Ä–µ–∂–∏–º–µ WinRE - –û–° –Ω–∞ –±–∞–∑–µ WinPE (Windows Preinstallation Environment),
–æ–±—Ä–∞–∑ winre.wim –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å–∫—Ä—ã—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ System Restore<br />
–ù–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å ‚Äî
–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä DSRM. –ü–∞—Ä–æ–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Ä–æ–ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
–¥–æ–º–µ–Ω–∞ ADDS –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (SafeModeAdministratorPassword).<br />
<code>ntdsutil</code><br />
<code>activate instance ntds</code><br />
<code>Files</code><br />
<code>Info</code><br />
<code>integrity</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ë–î<br />
–û—à–∏–±–∫–∞: Failed to open DIT for AD DS/LDS instance NTDS. Error
-2147418113<br />
<code>mkdir c:\ntds_bak</code><br />
<code>xcopy c:\Windows\NTDS\*.* c:\ntds_bak</code> backup —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
–∫–∞—Ç–∞–ª–æ–≥–∞ —Å –ë–î<br />
<code>esentutl /g c:\windows\ntds\ntds.dit</code> –ø—Ä–æ–≤–µ—Ä–∏–º —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å
—Ñ–∞–π–ª–∞<br />
–í—ã–≤–æ–¥: Integrity check completed. Database is CORRUPTED –æ—à–∏–±–∫–∞, –±–∞–∑–∞ AD
–ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞<br />
<code>esentutl /p c:\windows\ntds\ntds.dit</code> –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏<br />
–í—ã–≤–æ–¥: Operation completed successfully in xx seconds. –Ω–µ—Ç –æ—à–∏–±–æ–∫<br />
<code>esentutl /g c:\windows\ntds\ntds.dit</code> –ø—Ä–æ–≤–µ—Ä–∏–º —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å
—Ñ–∞–π–ª–∞<br />
–í—ã–ø–æ–ª–Ω–∏—Ç—å –∞–Ω–∞–ª–∏–∑ —Å–µ–º–∞–Ω—Ç–∏–∫–∏ –±–∞–∑—ã —Å –ø–æ–º–æ—â—å—é ntdsutil:<br />
<code>ntdsutil</code><br />
<code>activate instance ntds</code><br />
<code>semantic database analysis</code><br />
<code>go</code><br />
<code>go fixup</code> –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏<br />
–°–∂–∞—Ç—å —Ñ–∞–π–ª –ë–î:<br />
<code>activate instance ntds</code><br />
<code>files</code><br />
<code>compact to C:\Windows\NTDS\TEMP</code><br />
<code>copy C:\Windows\NTDS\TEMP\ntds.dit C:\Windows\NTDS\ntds.dit</code>
–∑–∞–º–µ–Ω–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª ntds.dit<br />
<code>Del C:\Windows\NTDS\*.log</code> —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –ª–æ–≥ —Ñ–∞–π–ª—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞
NTDS</p>
<h1 id="gpo">GPO</h1>
<p><code>Get-Command -Module GroupPolicy</code><br />
<code>Get-GPO -Domain domain.local -All | ft</code><br />
<code>Get-GPO -Name LAPS</code><br />
<code>[xml](Get-GPOReport LAPS -ReportType Xml)</code><br />
<code>Get-GPPermission -Name LAPS -All</code><br />
<code>Get-GPO LAPS | New-GPLink -Target "ou=servers,dc=domain,dc=local"</code><br />
<code>Set-GPLink -Name LAPS -Target "ou=servers,dc=domain,dc=local" -LinkEnabled No</code><br />
<code>Backup-GPO -Name LAPS -Path "$home\Desktop"</code><br />
<code>Backup-GPO -All -Path "$home\Desktop"</code><br />
<code>Restore-GPO -Name LAPS -Path C:\Backup\GPOs\</code></p>
<h1 id="servermanager">ServerManager</h1>
<p><code>Get-Command *WindowsFeature*</code> source module
ServerManager<br />
<code>Get-WindowsFeature -ComputerName "localhost"</code><br />
<code>Get-WindowsFeature | where Installed -eq $True</code> —Å–ø–∏—Å–æ–∫
—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤<br />
<code>Get-WindowsFeature | where FeatureType -eq "Role"</code>
–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Å–ø–∏—Å–∫—É —Ä–æ–ª–µ–π<br />
<code>Install-WindowsFeature -Name DNS</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å<br />
<code>Get-Command *DNS*</code><br />
<code>Get-DnsServerSetting -ALL</code><br />
<code>Uninstall-WindowsFeature -Name DNS</code> —É–¥–∞–ª–∏—Ç—å —Ä–æ–ª—å</p>
<h3 id="pswa">PSWA</h3>
<p><code>Install-WindowsFeature -Name WindowsPowerShellWebAccess -IncludeManagementTools</code><br />
<code>Install-PswaWebApplication -UseTestCertificate</code> –°–æ–∑–¥–∞—Ç—å
–≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ /pswa<br />
<code>Add-PswaAuthorizationRule -UserGroupName "$domain\Domain Admins" -ComputerName * -ConfigurationName * -RuleName "For Admins"</code>
–¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</p>
<h3 id="wsb-windows-server-backup">WSB (Windows Server Backup)</h3>
<p>–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ backup DC —á–µ—Ä–µ–∑ WSB, —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–ø–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
(System State), –∫—É–¥–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –±–∞–∑–∞ AD (NTDS.DIT), –æ–±—ä–µ–∫—Ç—ã –≥—Ä—É–ø–ø–æ–≤—ã—Ö
–ø–æ–ª–∏—Ç–∏–∫, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–∞—Ç–∞–ª–æ–≥–∞ SYSVOL, —Ä–µ–µ—Å—Ç—Ä, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ IIS, –±–∞–∑–∞ AD CS,
–∏ –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ —Ä–µ—Å—É—Ä—Å—ã. –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑
—Å–ª—É–∂–±—É —Ç–µ–Ω–µ–≤–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è VSS.<br />
<code>Get-WindowsFeature Windows-Server-Backup</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ª–∏ —Ä–æ–ª—å<br />
<code>Add-Windowsfeature Windows-Server-Backup ‚ÄìIncludeallsubfeature</code>
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="va">$path</span><span class="op">=</span><span class="st">&quot;\\</span><span class="va">$srv</span><span class="st">\bak-dc\dc-03\&quot;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$TargetUNC</span><span class="op">=</span><span class="va">$path</span><span class="op">+(</span><span class="fu">get-date</span> <span class="op">-</span>f <span class="st">&#39;yyyy-MM-dd&#39;</span><span class="op">)</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">((</span><span class="fu">Test-Path</span> <span class="op">-</span>Path <span class="va">$path</span><span class="op">)</span> <span class="op">-eq</span> <span class="va">$true</span><span class="op">)</span> <span class="op">{</span><span class="fu">New-Item</span> <span class="op">-</span>Path <span class="va">$TargetUNC</span> <span class="op">-</span>ItemType directory<span class="op">}</span> <span class="co"># –µ—Å–ª–∏ –ø—É—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω, —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–æ –¥–∞—Ç–µ</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="va">$WBadmin_cmd</span> <span class="op">=</span> <span class="st">&quot;wbadmin.exe START BACKUP -backupTarget:</span><span class="va">$TargetUNC</span><span class="st"> -systemState -noverify -vssCopy -quiet&quot;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># $WBadmin_cmd = &quot;wbadmin start backup -backuptarget:$path -include:C:\Windows\NTDS\ntds.dit -quiet&quot; # Backup DB NTDS</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Invoke-Expression</span> <span class="va">$WBadmin_cmd</span></span></code></pre></div>
<h3 id="rds">RDS</h3>
<p><code>Get-Command -Module RemoteDesktop</code><br />
<code>Get-RDServer -ConnectionBroker $broker</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
–≤ —Ñ–µ—Ä–º–µ—ã, —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ–µ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É —Å
—Ä–æ–ª—å—é RDCB<br />
<code>Get-RDRemoteDesktop -ConnectionBroker $broker</code> —Å–ø–∏—Å–æ–∫
–∫–æ–ª–ª–µ–∫—Ü–∏–π<br />
<code>(Get-RDLicenseConfiguration -ConnectionBroker $broker | select *).LicenseServer</code>
—Å–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å —Ä–æ–ª—å—é RDL<br />
<code>Get-RDUserSession -ConnectionBroker $broker</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö
–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π<br />
<code>Disconnect-RDUser -HostServer $srv -UnifiedSessionID $id -Force</code>
–æ—Ç–∫–ª—é—á–∏—Ç—å —Å–µ—Å—Å–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>Get-RDAvailableApp -ConnectionBroker $broker -CollectionName C03</code>
—Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ü–û –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏<br />
<code>(Get-RDSessionCollectionConfiguration -ConnectionBroker $broker -CollectionName C03 | select *).CustomRdpProperty</code>
use redirection server name:i:1<br />
<code>Get-RDConnectionBrokerHighAvailability</code></p>
<h1 id="dnsserver">DNSServer</h1>
<p><code>Get-Command -Module DnsServer</code><br />
<code>Show-DnsServerCache</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤–µ—Å—å –∫—ç—à DNS-—Å–µ—Ä–≤–µ—Ä–∞<br />
<code>Show-DnsServerCache | where HostName -match ru</code><br />
<code>Clear-DnsServerCache</code><br />
<code>Get-DnsServerCache</code><br />
<code>Get-DnsServerDiagnostics</code></p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="va">$zone</span> <span class="op">=</span> <span class="fu">icm</span> <span class="va">$srv</span> <span class="op">{</span>Get-DnsServerZone<span class="op">}</span> <span class="op">|</span> <span class="fu">select</span> ZoneName<span class="op">,</span>ZoneType<span class="op">,</span>DynamicUpdate<span class="op">,</span>ReplicationScope<span class="op">,</span>SecureSecondaries<span class="op">,</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>DirectoryPartitionName <span class="op">|</span> <span class="fu">Out-GridView</span> <span class="op">-</span>Title <span class="st">&quot;DNS Server: </span><span class="va">$srv</span><span class="st">&quot;</span> ‚ÄìPassThru</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="va">$zone_name</span> <span class="op">=</span> <span class="va">$zone</span><span class="op">.</span><span class="fu">ZoneName</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$zone_name</span> <span class="op">-ne</span> <span class="va">$null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">icm</span> <span class="va">$srv</span> <span class="op">{</span>Get-DnsServerResourceRecord <span class="op">-</span>ZoneName <span class="va">$using</span><span class="op">:</span><span class="va">zone_name</span> <span class="op">|</span> <span class="fu">sort</span> RecordType <span class="op">|</span> <span class="fu">select</span> RecordType<span class="op">,</span>HostName<span class="op">,</span> @<span class="op">{</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>Label<span class="op">=</span><span class="st">&quot;IPAddress&quot;</span><span class="op">;</span> Expression<span class="op">={</span><span class="va">$_</span><span class="op">.</span><span class="fu">RecordData</span><span class="op">.</span><span class="fu">IPv4Address</span><span class="op">.</span><span class="fu">IPAddressToString</span><span class="op">}},</span>TimeToLive<span class="op">,</span>Timestamp</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="op">|</span> <span class="fu">select</span> RecordType<span class="op">,</span>HostName<span class="op">,</span>IPAddress<span class="op">,</span>TimeToLive<span class="op">,</span>Timestamp <span class="op">|</span> <span class="fu">Out-GridView</span> <span class="op">-</span>Title <span class="st">&quot;DNS Server: </span><span class="va">$srv</span><span class="st">&quot;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Sync-DnsServerZone ‚Äìpassthru</code> —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–æ–Ω—ã —Å
–¥—Ä—É–≥–∏–º–∏ DC –≤ –¥–æ–º–µ–Ω–µ<br />
<code>Remove-DnsServerZone -Name domain.local</code> —É–¥–∞–ª–∏—Ç—å –∑–æ–Ω—É<br />
<code>Get-DnsServerResourceRecord -ZoneName domain.local -RRType A</code>
–≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ –ê-–∑–∞–ø–∏—Å–∏ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –∑–æ–Ω–µ<br />
<code>Add-DnsServerResourceRecordA -Name new-host-name -IPv4Address 192.168.1.100 -ZoneName domain.local -TimeToLive 01:00:00 -CreatePtr</code>
—Å–æ–∑–¥–∞—Ç—å –ê-–∑–∞–ø–∏—Å—å –∏ PTR –¥–ª—è –Ω–µ–µ<br />
<code>Remove-DnsServerResourceRecord -ZoneName domain.local -RRType A -Name new-host-name ‚ÄìForce</code>
—É–¥–∞–ª–∏—Ç—å –ê-–∑–∞–ø–∏—Å—å</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="va">$DNSServer</span> <span class="op">=</span> <span class="st">&quot;DC-01&quot;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="va">$DNSFZone</span> <span class="op">=</span> <span class="st">&quot;domain.com&quot;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="va">$DataFile</span> <span class="op">=</span> <span class="st">&quot;C:\Scripts\DNS-Create-A-Records-from-File.csv&quot;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># cat $DataFile</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;HostName;IP&quot;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;server-01;192.168.1.10&quot;</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="va">$DNSRR</span> <span class="op">=</span> <span class="op">[</span>WmiClass<span class="op">]</span><span class="st">&quot;\\</span><span class="va">$DNSServer</span><span class="st">\root\MicrosoftDNS:MicrosoftDNS_ResourceRecord&quot;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="va">$ConvFile</span> <span class="op">=</span> <span class="va">$DataFile</span> <span class="op">+</span> <span class="st">&quot;_unicode&quot;</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Content</span> <span class="va">$DataFile</span> <span class="op">|</span> <span class="fu">Set-Content</span> <span class="va">$ConvFile</span> <span class="op">-</span>Encoding Unicode</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="fu">Import-CSV</span> <span class="va">$ConvFile</span> <span class="op">-</span>Delimiter <span class="st">&quot;;&quot;</span> <span class="op">|</span> <span class="fu">ForEach-Object</span> <span class="op">{</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="va">$FQDN</span> <span class="op">=</span> <span class="va">$_</span><span class="op">.</span><span class="fu">HostName</span> <span class="op">+</span> <span class="st">&quot;.&quot;</span> <span class="op">+</span> <span class="va">$DNSFZone</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="va">$IP</span> <span class="op">=</span> <span class="va">$_</span><span class="op">.</span><span class="fu">HostIP</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="va">$TextA</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$FQDN</span><span class="st"> IN A </span><span class="va">$IP</span><span class="st">&quot;</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Void<span class="op">]</span><span class="va">$DNSRR</span><span class="op">.</span><span class="fu">CreateInstanceFromTextRepresentation</span><span class="op">(</span><span class="va">$DNSServer</span><span class="op">,</span><span class="va">$DNSFZone</span><span class="op">,</span><span class="va">$TextA</span><span class="op">)</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="dhcpserver">DHCPServer</h1>
<p><code>Get-Command -Module DhcpServer</code></p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="va">$mac</span> <span class="op">=</span> <span class="fu">icm</span> <span class="va">$srv</span> <span class="op">-</span>ScriptBlock <span class="op">{</span>Get-DhcpServerv4Scope <span class="op">|</span> Get-DhcpServerv4Lease<span class="op">}</span> <span class="op">|</span> <span class="fu">select</span> AddressState<span class="op">,</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>HostName<span class="op">,</span>IPAddress<span class="op">,</span>ClientId<span class="op">,</span>DnsRegistration<span class="op">,</span>DnsRR<span class="op">,</span>ScopeId<span class="op">,</span>ServerIP <span class="op">|</span> <span class="fu">Out-GridView</span> <span class="op">-</span>Title <span class="st">&quot;HDCP Server: </span><span class="va">$srv</span><span class="st">&quot;</span> ‚ÄìPassThru</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="fu">New-Object</span> <span class="op">-</span>ComObject Wscript<span class="op">.</span><span class="fu">Shell</span><span class="op">).</span><span class="fu">Popup</span><span class="op">(</span><span class="va">$mac</span><span class="op">.</span><span class="fu">ClientId</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="va">$mac</span><span class="op">.</span><span class="fu">HostName</span><span class="op">,</span><span class="dv">64</span><span class="op">)</span></span></code></pre></div>
<p><code>Add-DhcpServerv4Reservation -ScopeId 192.168.1.0 -IPAddress 192.168.1.10 -ClientId 00-50-56-C0-00-08 -Description "new reservation"</code></p>
<h1 id="dfs">DFS</h1>
<p><code>dfsutil /root:\\domain.sys\public /export:C:\export-dfs.txt</code>
—ç–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ namespace root<br />
<code>dfsutil /AddFtRoot /Server:\\$srv /Share:public</code> –Ω–∞ –Ω–æ–≤–æ–π
–º–∞—à–∏–Ω–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∫–æ—Ä–µ–Ω—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ–º–µ–Ω–∞<br />
<code>dfsutil /root:\\domain.sys\public /import:C:\export-dfs.txt /&lt;verify /set</code>
Import (–ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º –¥–∞–Ω–Ω—ã—Ö –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ—Ä–µ–Ω—å DFS, —É—Ç–∏–ª–∏—Ç–∞ —Å–æ–∑–¥–∞–µ—Ç
—Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–æ—Ä–Ω—è –≤ —Ç–µ–∫—É—â–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ
–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —É—Ç–∏–ª–∏—Ç–∞ dfsutil)<br />
<code>/verify</code> –≤—ã–≤–æ–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤–Ω–µ—Å–µ–Ω—ã –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ
–∏–º–ø–æ—Ä—Ç–∞, –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è<br />
<code>/set</code> –º–µ–Ω—è–µ—Ç —Ü–µ–ª–µ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω –ø—É—Ç–µ–º –ø–æ–ª–Ω–æ–π
–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –∏ –∑–∞–º–µ–Ω—ã –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω –∏–∑ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º–æ–≥–æ
—Ñ–∞–π–ª–∞<br />
<code>/merge</code> –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω –≤
–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–ª–∏—è–Ω–∏—è, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ —Ñ–∞–π–ª–∞
–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±—É–¥—É—Ç –∏–º–µ—Ç—å –±–æ–ª—å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, —á–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω</p>
<p><code>Export-DfsrClone</code> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–æ–º–∞<br />
<code>Get-DfsrCloneState</code> –ø–æ–ª—É—á–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö<br />
<code>Import-DfsrClone</code> –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–æ–º–∞</p>
<p><code>net use x: \\$srv1\public\*</code> –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∏—Å–∫<br />
<code>Get-DfsrFileHash x:\* | Out-File C:\$srv1.txt</code> –∑–∞–±—Ä–∞—Ç—å hash
–≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –¥–∏—Å–∫–∞ –≤ —Ñ–∞–π–ª (—Ñ–∞–π–ª—ã —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ —Ö–µ—à–∞–º–∏ –≤—Å–µ–≥–¥–∞ —è–≤–ª—è—é—Ç—Å—è
—Ç–æ—á–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞)<br />
<code>net use x: /d</code> –æ—Ç–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å<br />
<code>net use x: \\$srv2\public\*</code><br />
<code>Get-DfsrFileHash x:\* | Out-File C:\$srv2.txt</code><br />
<code>net use x: /d</code><br />
<code>Compare-Object -ReferenceObject (Get-Content C:\$srv1.txt) -DifferenceObject (Get-Content C:\$srv2.txt) -IncludeEqual</code>
—Å—Ä–∞–≤–Ω–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤</p>
<p><code>Get-DfsrBacklog -DestinationComputerName "fs-06" -SourceComputerName "fs-05" -GroupName "folder-rep" -FolderName "folder" -Verbose</code>
–ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –æ–∂–∏–¥–∞—é—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤ –º–µ–∂–¥—É –¥–≤—É–º—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS<br />
<code>Get-DfsrConnection</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏, —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
–∏ —Å—Ç–∞—Ç—É—Å<br />
<code>Get-DfsReplicatedFolder</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏–º—è –∏ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫
–ø–∞–ø–∫–∞–º —Ä–µ–ª–∏–∫–∞—Ü–∏–∏ –≤ —Å–∏—Å—Ç–µ–º–µ DFS<br />
<code>Get-DfsrState -ComputerName fs-06 -Verbose</code> —Å–æ—Å—Ç–æ—è–Ω–∏–µ
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS –¥–ª—è —á–ª–µ–Ω–∞ –≥—Ä—É–ø–ø—ã<br />
<code>Get-DfsReplicationGroup</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –∏ –∏—Ö
—Å—Ç–∞—Ç—É—Å<br />
<code>Add-DfsrConnection</code> —Å–æ–∑–¥–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É —á–ª–µ–Ω–∞–º–∏ –≥—Ä—É–ø–ø—ã
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Add-DfsrMember</code> –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –≤ –≥—Ä—É–ø–ø—É
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>ConvertFrom-DfsrGuid</code> –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã GUID –≤
–ø–æ–Ω—è—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ –≤ –∑–∞–¥–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Get-DfsrConnectionSchedule</code> –ø–æ–ª—É—á–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
–º–µ–∂–¥—É —á–ª–µ–Ω–∞–º–∏ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Get-DfsrGroupSchedule</code> –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Get-DfsrIdRecord</code> –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø–∏—Å–∏ ID –¥–ª—è —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
—Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –ø–∞–ø–æ–∫ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS<br />
<code>Get-DfsrMember</code> –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –≤ –≥—Ä—É–ø–ø–µ
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Get-DfsrMembership</code> –ø–æ–ª—É—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–ª–µ–Ω—Å—Ç–≤–∞ –¥–ª—è —á–ª–µ–Ω–æ–≤
–≥—Ä—É–ø–ø —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Get-DfsrPreservedFiles</code> –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫,
—Ä–∞–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π DFS<br />
<code>Get-DfsrServiceConfiguration</code> –ø–æ–ª—É—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–ª—É–∂–±—ã
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS –¥–ª—è —á–ª–µ–Ω–æ–≤ –≥—Ä—É–ø–ø—ã<br />
<code>Grant-DfsrDelegation</code> –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞–º
–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Revoke-DfsrDelegation</code> –æ—Ç–º–µ–Ω—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>New-DfsReplicationGroup</code> —Å–æ–∑–¥–∞–µ—Ç –≥—Ä—É–ø–ø—É —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>New-DfsReplicatedFolder</code> —Å–æ–∑–¥–∞–µ—Ç —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–∞–ø–∫—É –≤
–≥—Ä—É–ø–ø–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Remove-DfsrConnection</code> —É–¥–∞–ª—è–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É —á–ª–µ–Ω–∞–º–∏
–≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Remove-DfsReplicatedFolder</code> —É–¥–∞–ª—è–µ—Ç —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–∞–ø–∫—É –∏–∑
–≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Remove-DfsReplicationGroup</code> —É–¥–∞–ª—è–µ—Ç –≥—Ä—É–ø–ø—É —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Remove-DfsrMember</code> —É–¥–∞–ª—è–µ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –∏–∑ –≥—Ä—É–ø–ø—ã
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Restore-DfsrPreservedFiles</code> –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏,
—Ä–∞–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π DFS<br />
<code>Set-DfsrConnection</code> –∏–∑–º–µ–Ω—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –º–µ–∂–¥—É
—á–ª–µ–Ω–∞–º–∏ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Set-DfsrConnectionSchedule</code> –∏–∑–º–µ–Ω—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –º–µ–∂–¥—É —á–ª–µ–Ω–∞–º–∏ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Set-DfsReplicatedFolder</code> –∏–∑–º–µ–Ω—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π
–ø–∞–ø–∫–∏<br />
<code>Set-DfsReplicationGroup</code> –∏–∑–º–µ–Ω—è–µ—Ç –≥—Ä—É–ø–ø—É —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Set-DfsrGroupSchedule</code> –∏–∑–º–µ–Ω—è–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Set-DfsrMember</code> –∏–∑–º–µ–Ω—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ-—É—á–∞—Å—Ç–Ω–∏–∫–µ –≤
–≥—Ä—É–ø–ø–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Set-DfsrMembership</code> –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–ª–µ–Ω—Å—Ç–≤–∞ –¥–ª—è
—á–ª–µ–Ω–æ–≤ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Set-DfsrServiceConfiguration</code> –∏–∑–º–µ–Ω—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–ª—É–∂–±—ã
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS<br />
<code>Sync-DfsReplicationGroup</code> —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –º–µ–∂–¥—É
–∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è<br />
<code>Suspend-DfsReplicationGroup</code> –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é
–º–µ–∂–¥—É –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è<br />
<code>Update-DfsrConfigurationFromAD</code> –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±—ã
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS<br />
<code>Write-DfsrHealthReport</code> —Å–æ–∑–¥–∞–µ—Ç –æ—Ç—á–µ—Ç –æ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS<br />
<code>Write-DfsrPropagationReport</code> —Å–æ–∑–¥–∞–µ—Ç –æ—Ç—á–µ—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö
—Ñ–∞–π–ª–æ–≤ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>Start-DfsrPropagationTest</code> —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
—Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –≤ —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ</p>
<h1 id="storagereplica">StorageReplica</h1>
<p><code>Install-WindowsFeature Storage-Replica ‚ÄìIncludeManagementTools -Restart</code><br />
<code>Get-Command -Module StorageReplica</code><br />
<code>Test-SRTopology</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ —Å–µ—Ä–≤–µ—Ä –∏ –∫–∞–Ω–∞–ª
—Å–≤—è–∑–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ Storage Replica<br />
<code>New-SRPartnership -SourceComputerName srv-01 -SourceRGName srv-01-rep-group-01 -SourceVolumeName D: -SourceLogVolumeName L: -DestinationComputerName srv-02 -DestinationRGName srv-02-rep-group-01 -DestinationVolumeName D: -DestinationLogVolumeName L: -LogSizeInBytes 1GB</code><br />
<code>Get-Counter -Counter "\Storage Replica Statistics(*)"</code><br />
<code>Get-WinEvent -ProviderName Microsoft-Windows-StorageReplica -max 10</code><br />
<code>Set-SRPartnership -ReplicationMode Asynchronous</code> –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å
—Ä–µ–∂–∏–º —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π<br />
<code>Set-SRPartnership -NewSourceComputerName srv-02 -SourceRGName srv-02-rep-group-01 -DestinationComputerName srv-01 -DestinationRGName srv-01-rep-group-01</code>
–∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–≤–µ–¥—è –≤—Ç–æ—Ä–∏—á–Ω—É—é –∫–æ–ø–∏—é
–≤ –æ–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º (–ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Å—Ç—Ä–æ—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)<br />
<code>Get-SRGroup</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∑–∞—Ü–∏–∏<br />
<code>Get-SRPartnerShip</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏<br />
<code>(Get-SRGroup).Replicas | Select-Object numofbytesremaining</code>
–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–ª–∏–Ω—É –æ—á–µ—Ä–µ–¥–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è<br />
<code>Get-SRPartnership | Remove-SRPartnership</code> —É–¥–∞–ª–∏—Ç—å —Ä–µ–ø–ª–∏–∑–∞—Ü–∏—é
–Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ<br />
<code>Get-SRGroup | Remove-SRGroup</code> —É–¥–∞–ª–∏—Ç—å —Ä–µ–ø–ª–∏–∑–∞—Ü–∏—é –Ω–∞ –æ–±–æ–∏—Ö
—Å–µ—Ä–≤–µ—Ä–∞—Ö</p>
<h1 id="ps2exe">PS2EXE</h1>
<p><code>Install-Module ps2exe -Repository PSGallery</code><br />
<code>Get-Module -ListAvailable</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π<br />
<code>-noConsole</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GUI, –±–µ–∑ –æ–∫–Ω–∞ –∫–æ–Ω—Å–æ–ª–∏
powershell<br />
<code>-noOutput</code> –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–µ<br />
<code>-noError</code> –±–µ–∑ –≤—ã–≤–æ–¥–∞ –æ—à–∏–±–æ–∫<br />
<code>-requireAdmin</code> –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –ø—Ä–∞–≤–∞
–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞<br />
<code>-credentialGUI</code> –≤—ã–≤–æ–¥ –¥–∏–∞–ª–æ–≥–æ–≤–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è –≤–≤–æ–¥–∞ —É—á–µ—Ç–Ω—ã—Ö
–¥–∞–Ω–Ω—ã—Ö<br />
<code>Invoke-ps2exe -inputFile "$home\Desktop\WinEvent-Viewer-1.1.ps1" -outputFile "$home\Desktop\WEV-1.1.exe" -iconFile "$home\Desktop\log_48px.ico" -title "WinEvent-Viewer" -noConsole -noOutput -noError</code></p>
<h1 id="nssm">NSSM</h1>
<p><code>$powershell_Path = (Get-Command powershell).Source</code><br />
<code>$NSSM_Path = (Get-Command "C:\WinPerf-Agent\NSSM-2.24.exe").Source</code><br />
<code>$Script_Path = "C:\WinPerf-Agent\WinPerf-Agent-1.1.ps1"</code><br />
<code>$Service_Name = "WinPerf-Agent"</code><br />
<code>&amp; $NSSM_Path install $Service_Name $powershell_Path -ExecutionPolicy Bypass -NoProfile -f $Script_Path</code>
—Å–æ–∑–¥–∞—Ç—å Service<br />
<code>&amp; $NSSM_Path start $Service_Name</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å<br />
<code>&amp; $NSSM_Path status $Service_Name</code> —Å—Ç–∞—Ç—É—Å<br />
<code>$Service_Name | Restart-Service</code> –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å<br />
<code>$Service_Name | Get-Service</code> —Å—Ç–∞—Ç—É—Å<br />
<code>$Service_Name | Stop-Service</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å<br />
<code>&amp; $NSSM_Path set $Service_Name description "Check performance CPU and report email"</code>
–∏–∑–º–µ–Ω–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ<br />
<code>&amp; $NSSM_Path remove $Service_Name</code> —É–¥–∞–ª–∏—Ç—å</p>
<h1 id="jobs">Jobs</h1>
<p><code>Get-Job</code> –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á<br />
<code>Start-Job</code> –∑–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞<br />
<code>Stop-Job</code> –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞<br />
<code>Suspend-Job</code> –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–∞<br />
<code>Resume-Job</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–∞<br />
<code>Wait-Job</code> –æ–∂–∏–¥–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã<br />
<code>Receive-Job</code> –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ
–ø—Ä–æ—Ü–µ—Å—Å–∞<br />
<code>Remove-Job</code> —É–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Start-PingJob <span class="op">(</span><span class="va">$Network</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="va">$RNetwork</span> <span class="op">=</span> <span class="va">$Network</span> <span class="op">-replace</span> <span class="st">&quot;\.\d{1,3}$&quot;</span><span class="op">,</span><span class="st">&quot;.&quot;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span>$<span class="dv">4</span> <span class="kw">in</span> <span class="dv">1</span><span class="op">..</span><span class="dv">254</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="va">$ip</span> <span class="op">=</span> <span class="va">$RNetwork</span><span class="op">+</span>$<span class="dv">4</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># —Å–æ–∑–¥–∞–µ–º –∑–∞–¥–∞–Ω–∏—è, –∑–∞–±–∏—Ä–∞–µ–º 3-—é —Å—Ç—Ä–æ–∫—É –≤—ã–≤–æ–¥–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –≤—ã–≤–æ–¥—É ip-–∞–¥—Ä–µ—Å:</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="fu">Start-Job</span> <span class="op">{</span><span class="st">&quot;</span><span class="va">$using</span><span class="op">:</span><span class="va">ip</span><span class="st"> : &quot;</span><span class="op">+(</span>ping <span class="op">-</span>n <span class="dv">1</span> <span class="op">-</span>w <span class="dv">50</span> <span class="va">$using</span><span class="op">:</span><span class="va">ip</span><span class="op">)[</span><span class="dv">2</span><span class="op">]})</span> <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span><span class="va">$True</span><span class="op">){</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="va">$status_job</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Job</span><span class="op">).</span><span class="fu">State</span><span class="op">[</span>-1<span class="op">]</span> <span class="co"># –∑–∞–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$status_job</span> <span class="op">-like</span> <span class="st">&quot;Completed&quot;</span><span class="op">){</span> <span class="co"># –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–∏ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑)</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="va">$ping_out</span> <span class="op">=</span> <span class="fu">Get-Job</span> <span class="op">|</span> <span class="fu">Receive-Job</span> <span class="co"># –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω, –∑–∞–±–∏—Ä–∞–µ–º –≤—ã–≤–æ–¥ –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Job</span> <span class="op">|</span> <span class="fu">Remove-Job</span> <span class="op">-</span>Force <span class="co"># —É–¥–∞–ª—è–µ–º –∑–∞–¥–∞–Ω–∏—è</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="va">$ping_out</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="cf">break</span> <span class="co"># –∑–∞–≤–µ—Ä—à–∞–µ–º —Ü–∏–∫–ª</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="op">}}</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Start-PingJob -Network 192.168.3.0</code><br />
<code>(Measure-Command {Start-PingJob -Network 192.168.3.0}).TotalSeconds</code>
60 Seconds</p>
<h3 id="threadjob">ThreadJob</h3>
<p><code>Install-Module -Name ThreadJob</code><br />
<code>Get-Module ThreadJob -list</code><br />
<code>Start-ThreadJob {ping ya.ru} | Out-Null</code> —Å–æ–∑–¥–∞—Ç—å —Ñ–æ–Ω–æ–≤—É—é
–∑–∞–¥–∞—á—É<br />
<code>Get-Job | Receive-Job -Keep</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∏ –Ω–µ —É–¥–∞–ª—è—Ç—å
–≤—ã–≤–æ–¥<br />
<code>(Get-Job).HasMoreData</code> –µ—Å–ª–∏ False, —Ç–æ –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω—ã
—É–¥–∞–ª–µ–Ω<br />
<code>(Get-Job)[-1].Output</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—ã–≤–æ–¥ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–¥–∞—á–∏</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Start-PingThread <span class="op">(</span><span class="va">$Network</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="va">$RNetwork</span> <span class="op">=</span> <span class="va">$Network</span> <span class="op">-replace</span> <span class="st">&quot;\.\d{1,3}$&quot;</span><span class="op">,</span><span class="st">&quot;.&quot;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span>$<span class="dv">4</span> <span class="kw">in</span> <span class="dv">1</span><span class="op">..</span><span class="dv">254</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="va">$ip</span> <span class="op">=</span> <span class="va">$RNetwork</span><span class="op">+</span>$<span class="dv">4</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># —Å–æ–∑–¥–∞–µ–º –∑–∞–¥–∞–Ω–∏—è, –∑–∞–±–∏—Ä–∞–µ–º 3-—é —Å—Ç—Ä–æ–∫—É –≤—ã–≤–æ–¥–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –≤—ã–≤–æ–¥—É ip-–∞–¥—Ä–µ—Å:</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>Start-ThreadJob <span class="op">{</span><span class="st">&quot;</span><span class="va">$using</span><span class="op">:</span><span class="va">ip</span><span class="st"> : &quot;</span><span class="op">+(</span>ping <span class="op">-</span>n <span class="dv">1</span> <span class="op">-</span>w <span class="dv">50</span> <span class="va">$using</span><span class="op">:</span><span class="va">ip</span><span class="op">)[</span><span class="dv">2</span><span class="op">]})</span> <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span><span class="va">$True</span><span class="op">){</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="va">$status_job</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Job</span><span class="op">).</span><span class="fu">State</span><span class="op">[</span>-1<span class="op">]</span> <span class="co"># –∑–∞–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$status_job</span> <span class="op">-like</span> <span class="st">&quot;Completed&quot;</span><span class="op">){</span> <span class="co"># –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–∏ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑)</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="va">$ping_out</span> <span class="op">=</span> <span class="fu">Get-Job</span> <span class="op">|</span> <span class="fu">Receive-Job</span> <span class="co"># –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω, –∑–∞–±–∏—Ä–∞–µ–º –≤—ã–≤–æ–¥ –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Job</span> <span class="op">|</span> <span class="fu">Remove-Job</span> <span class="op">-</span>Force <span class="co"># —É–¥–∞–ª—è–µ–º –∑–∞–¥–∞–Ω–∏—è</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="va">$ping_out</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="cf">break</span> <span class="co"># –∑–∞–≤–µ—Ä—à–∞–µ–º —Ü–∏–∫–ª</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="op">}}</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Start-PingThread -Network 192.168.3.0</code><br />
<code>(Measure-Command {Start-PingThread -Network 192.168.3.0}).TotalSeconds</code>
24 Seconds</p>
<h3 id="poshrsjob">PoshRSJob</h3>
<div class="sourceCode" id="cb39"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Start-PingRSJob <span class="op">(</span><span class="va">$Network</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="va">$RNetwork</span> <span class="op">=</span> <span class="va">$Network</span> <span class="op">-replace</span> <span class="st">&quot;\.\d{1,3}$&quot;</span><span class="op">,</span><span class="st">&quot;.&quot;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span>$<span class="dv">4</span> <span class="kw">in</span> <span class="dv">1</span><span class="op">..</span><span class="dv">254</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="va">$ip</span> <span class="op">=</span> <span class="va">$RNetwork</span><span class="op">+</span>$<span class="dv">4</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>Start-RSJob <span class="op">{</span><span class="st">&quot;</span><span class="va">$using</span><span class="op">:</span><span class="va">ip</span><span class="st"> : &quot;</span><span class="op">+(</span>ping <span class="op">-</span>n <span class="dv">1</span> <span class="op">-</span>w <span class="dv">50</span> <span class="va">$using</span><span class="op">:</span><span class="va">ip</span><span class="op">)[</span><span class="dv">2</span><span class="op">]})</span> <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="va">$ping_out</span> <span class="op">=</span> Get-RSJob <span class="op">|</span> Receive-RSJob</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="va">$ping_out</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>Get-RSJob <span class="op">|</span> Remove-RSJob</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Start-PingRSJob -Network 192.168.3.0</code><br />
<code>(Measure-Command {Start-PingRSJob -Network 192.168.3.0}).TotalSeconds</code>
10 Seconds</p>
<h1 id="smtp">SMTP</h1>
<div class="sourceCode" id="cb40"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Send-SMTP <span class="op">{</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="kw">param</span> <span class="op">(</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Parameter<span class="op">(</span>Mandatory <span class="op">=</span> <span class="va">$True</span><span class="op">)]</span><span class="va">$mess</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="va">$srv_smtp</span> <span class="op">=</span> <span class="st">&quot;smtp.yandex.ru&quot;</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="va">$port</span> <span class="op">=</span> <span class="st">&quot;587&quot;</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="va">$from</span> <span class="op">=</span> <span class="st">&quot;login1@yandex.ru&quot;</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="va">$to</span> <span class="op">=</span> <span class="st">&quot;login2@yandex.ru&quot;</span> </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="va">$user</span> <span class="op">=</span> <span class="st">&quot;login1&quot;</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="va">$pass</span> <span class="op">=</span> <span class="st">&quot;password&quot;</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="va">$subject</span> <span class="op">=</span> <span class="st">&quot;Service status on Host: </span><span class="va">$hostname</span><span class="st">&quot;</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="va">$Message</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">Mail</span><span class="op">.</span><span class="fu">MailMessage</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="va">$Message</span><span class="op">.</span><span class="fu">From</span> <span class="op">=</span> <span class="va">$from</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="va">$Message</span><span class="op">.</span><span class="fu">To</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="va">$to</span><span class="op">)</span> </span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="va">$Message</span><span class="op">.</span><span class="fu">Subject</span> <span class="op">=</span> <span class="va">$subject</span> </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="va">$Message</span><span class="op">.</span><span class="fu">IsBodyHTML</span> <span class="op">=</span> <span class="va">$true</span> </span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="va">$Message</span><span class="op">.</span><span class="fu">Body</span> <span class="op">=</span> <span class="st">&quot;&lt;h1&gt; </span><span class="va">$mess</span><span class="st"> &lt;/h1&gt;&quot;</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="va">$smtp</span> <span class="op">=</span> <span class="fu">New-Object</span> Net<span class="op">.</span><span class="fu">Mail</span><span class="op">.</span><span class="fu">SmtpClient</span><span class="op">(</span><span class="va">$srv_smtp</span><span class="op">,</span> <span class="va">$port</span><span class="op">)</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="va">$smtp</span><span class="op">.</span><span class="fu">EnableSSL</span> <span class="op">=</span> <span class="va">$true</span> </span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="va">$smtp</span><span class="op">.</span><span class="fu">Credentials</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">NetworkCredential</span><span class="op">(</span><span class="va">$user</span><span class="op">,</span> <span class="va">$pass</span><span class="op">);</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="va">$smtp</span><span class="op">.</span><span class="fu">Send</span><span class="op">(</span><span class="va">$Message</span><span class="op">)</span> </span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Send-SMTP $(Get-Service)</code></p>
<h1 id="hyper-v">Hyper-V</h1>
<p><code>Install-WindowsFeature -Name Hyper-V -IncludeManagementTools -Restart</code>
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å –Ω–∞ Windows Server<br />
<code>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V ‚ÄìAll</code>
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å –Ω–∞ Windows Desktop<br />
<code>Get-Command -Module hyper-v</code><br />
<code>Get-VMHost</code></p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>New-VMSwitch <span class="op">-</span>name NAT <span class="op">-</span>SwitchType Internal <span class="co"># —Å–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä –∏ –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è –Ω–µ–≥–æ</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>Get-NetAdapter <span class="op">|</span> <span class="fu">where</span> InterfaceDescription <span class="op">-match</span> Hyper-V <span class="co"># —Å–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–≤—ã—Ö –∞–¥–∞–ø—Ç–µ—Ä–æ–≤</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>New-NetNat <span class="op">-</span>Name LocalNat <span class="op">-</span>InternalIPInterfaceAddressPrefix <span class="st">&quot;192.168.3.0/24&quot;</span> <span class="co"># –∑–∞–¥–∞—Ç—å —Å–µ—Ç—å</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>Get-NetAdapter <span class="st">&quot;vEthernet (NAT)&quot;</span> <span class="op">|</span> New-NetIPAddress <span class="op">-</span>IPAddress <span class="dv">192.168</span><span class="op">.</span><span class="dv">3.200</span> <span class="op">-</span>AddressFamily IPv4 <span class="op">-</span>PrefixLength <span class="dv">24</span> <span class="co"># –ø—Ä–∏—Å–≤–æ–∏—Ç—å –∞–¥—Ä–µ—Å, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞ –í–ú —É–∫–∞–∑–∞—Ç—å —à–ª—é–∑ 192.168.3.200, —á—Ç–æ –±—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –∑–∞ NAT, –∏–ª–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –í–ú —É–∫–∞–∑–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∞–¥–∞–ø—Ç–µ—Ä</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>Add-NetNatStaticMapping <span class="op">-</span>NatName LocalNat <span class="op">-</span>Protocol TCP <span class="op">-</span>ExternalIPAddress <span class="dv">0.0</span><span class="op">.</span><span class="dv">0.0</span> <span class="op">-</span>ExternalPort <span class="dv">2222</span> <span class="op">-</span>InternalIPAddress <span class="dv">192.168</span><span class="op">.</span><span class="dv">3.103</span> <span class="op">-</span>InternalPort <span class="dv">2121</span> <span class="co"># –ø—Ä–æ–±—Ä–æ—Å, –≤–µ—Å—Ç —Ç—Ä–∞—Ñ–∏–∫ –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–∞ —Ö–æ—Å—Ç Hyper-V TCP/2222, –±—É–¥–µ—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø–æ—Ä—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã –∑–∞ NAT.</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>Get-NetAdapter <span class="op">|</span> <span class="fu">where</span> Name <span class="op">-match</span> NAT<span class="op">).</span><span class="fu">Status</span></span></code></pre></div>
<p><code>Get-NetNatStaticMapping</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø—Ä–æ–±—Ä–æ—Å—ã (NAT)<br />
<code>Get-NetNat</code> —Å–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–π<br />
<code>Remove-NetNatStaticMapping -StaticMappingID 0</code> —É–¥–∞–ª–∏—Ç—å
–ø—Ä–æ–±—Ä–æ—Å<br />
<code>Remove-NetNat -Name LocalNat</code> —É–¥–∞–ª–∏—Ç—å —Å–µ—Ç—å</p>
<p><code>New-VMSwitch -Name Local -AllowManagementOS $True -NetAdapterName "Ethernet 4" -SwitchType External</code>
—Å–æ–∑–¥–∞—Ç—å –≤—à–µ–Ω–∏–π (External) –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä<br />
<code>$VMName = "hv-dc-01"</code></p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="va">$VM</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>Name <span class="op">=</span> <span class="va">$VMName</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>MemoryStartupBytes <span class="op">=</span> 4Gb</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>Generation <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="dt">NewVHDPath</span> <span class="op">=</span> <span class="st">&quot;D:\VM\</span><span class="va">$VMName</span><span class="st">\</span><span class="va">$VMName</span><span class="st">.vhdx&quot;</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>NewVHDSizeBytes <span class="op">=</span> 50Gb</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>BootDevice <span class="op">=</span> <span class="st">&quot;VHD&quot;</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>Path <span class="op">=</span> <span class="st">&quot;D:\VM\</span><span class="va">$VMName</span><span class="st">&quot;</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>SwitchName <span class="op">=</span> <span class="st">&quot;NAT&quot;</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>New-VM @VM</span></code></pre></div>
<p><code>Set-VMDvdDrive -VMName $VMName -Path "C:\Users\Lifailon\Documents\WS-2016.iso"</code><br />
<code>New-VHD -Path "D:\VM\$VMName\disk_d.vhdx" -SizeBytes 10GB</code>
—Å–æ–∑–¥–∞—Ç—å VHDX –¥–∏—Å–∫<br />
<code>Add-VMHardDiskDrive -VMName $VMName -Path "D:\VM\$VMName\disk_d.vhdx"</code>
–ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∏—Å–∫<br />
<code>Get-VM ‚ÄìVMname $VMName | Set-VM ‚ÄìAutomaticStartAction Start</code>
–∞–≤—Ç–æ–∑–∞–ø—É—Å–∫<br />
<code>Get-VM -Name $VMName | Set-VMMemory -StartupBytes 8Gb</code><br />
<code>Set-VMProcessor $VMName -Count 2</code><br />
<code>Get-VM -Name $VMName | Checkpoint-VM -SnapshotName "Snapshot-1"</code><br />
<code>Restore-VMCheckpoint -Name Snapshot-1" -VMName $VMName -Confirm:$false</code><br />
<code>Get-VM | Select -ExpandProperty NetworkAdapters | Select VMName,IPAddresses,Status</code>
–ø–æ–ª—É—á–∏—Ç—å IP –∞–¥—Ä–µ—Å –≤—Å–µ—Ö –í–ú<br />
<code>vmconnect.exe localhost $VMHost</code></p>
<p><code>Get-NetTCPConnection -State Established,Listen | Where-Object LocalPort -Match 2179</code>
–Ω–∞–π—Ç–∏ –ø–æ—Ä—Ç —Å–ª—É—à–∞—Ç–µ–ª—è
<code>Get-Process -Id (Get-NetTCPConnection -State Established,Listen | Where-Object LocalPort -Match 2179).OwningProcess</code>
–Ω–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ ID (vmms/VMConnect)<br />
<code>New-NetFirewallRule -Name "Hyper-V" -DisplayName "Hyper-V" -Group "Hyper-V" -Direction Inbound -Protocol TCP -LocalPort 2179 -Action Allow -Profile Public</code><br />
<code>Get-LocalGroupMember -Group "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã Hyper-V"</code> –∏–ª–∏
‚ÄúHyper-V Administrators‚Äù<br />
<code>Add-LocalGroupMember -Group "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã Hyper-V" -Member "lifailon"</code><br />
<code>Get-VM * | select name,ID</code> –¥–æ–±–∞–≤–∏—Ç—å id –≤ RDCMan –¥–ª—è
–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è<br />
<code>Grant-VMConnectAccess -ComputerName plex-01 -VMName hv-devops-01 -UserName lifailon</code>
–¥–∞—Ç—å –¥–æ—Å—Ç—É–ø –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É<br />
<code>Grant-VMConnectAccess -ComputerName huawei-book -VMName hv-devops-01 -UserName lifailon</code><br />
<code>Get-VMConnectAccess</code><br />
<code>Revoke-VMConnectAccess -VMName hv-devops-01 -UserName lifailon</code></p>
<p>Error: <code>Unknown disconnection reason 3848</code> - –¥–æ–±–∞–≤–∏—Ç—å
–∫–ª—é—á–∏ —Ä–µ–µ—Å—Ç—Ä–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">New-ItemProperty</span> <span class="op">-</span>Path HKLM<span class="op">:</span>\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowFreshCredentialsDomain <span class="op">-</span>Name Hyper-V <span class="op">-</span>PropertyType String <span class="op">-</span>Value <span class="st">&quot;Microsoft Virtual Console Service/*&quot;</span> <span class="op">-</span>Force</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">New-ItemProperty</span> <span class="op">-</span>Path HKLM<span class="op">:</span>\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowDefaultCredentials <span class="op">-</span>Name Hyper-V <span class="op">-</span>PropertyType String <span class="op">-</span>Value <span class="st">&quot;Microsoft Virtual Console Service/*&quot;</span> <span class="op">-</span>Force</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">New-ItemProperty</span> <span class="op">-</span>Path HKLM<span class="op">:</span>\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowFreshCredentialsWhenNTLMOnlyDomain <span class="op">-</span>Name Hyper-V <span class="op">-</span>PropertyType String <span class="op">-</span>Value <span class="st">&quot;Microsoft Virtual Console Service/*&quot;</span> <span class="op">-</span>Force</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>ItemProperty <span class="op">-</span>Path HKLM<span class="op">:</span>\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowDefaultCredentialsDomain <span class="op">-</span>Name Hyper-V <span class="op">-</span>PropertyType String <span class="op">-</span>Value <span class="st">&quot;Microsoft Virtual Console Service/*&quot;</span> <span class="op">-</span>Force</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">New-ItemProperty</span> <span class="op">-</span>Path HKLM<span class="op">:</span>\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowFreshCredentials <span class="op">-</span>Name Hyper-V <span class="op">-</span>PropertyType String <span class="op">-</span>Value <span class="st">&quot;Microsoft Virtual Console Service/*&quot;</span> <span class="op">-</span>Force</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">New-ItemProperty</span> <span class="op">-</span>Path HKLM<span class="op">:</span>\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowFreshCredentialsWhenNTLMOnly <span class="op">-</span>Name Hyper-V <span class="op">-</span>PropertyType String <span class="op">-</span>Value <span class="st">&quot;Microsoft Virtual Console Service/*&quot;</span> <span class="op">-</span>Force</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">New-ItemProperty</span> <span class="op">-</span>Path HKLM<span class="op">:</span>\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowSavedCredentialsWhenNTLMOnly <span class="op">-</span>Name Hyper-V <span class="op">-</span>PropertyType String <span class="op">-</span>Value <span class="st">&quot;Microsoft Virtual Console Service/*&quot;</span> <span class="op">-</span>Force</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="fu">New-ItemProperty</span> <span class="op">-</span>Path HKLM<span class="op">:</span>\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowSavedCredentials <span class="op">-</span>Name Hyper-V <span class="op">-</span>PropertyType String <span class="op">-</span>Value <span class="st">&quot;Microsoft Virtual Console Service/*&quot;</span> <span class="op">-</span>Force</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">New-ItemProperty</span> <span class="op">-</span>Path HKLM<span class="op">:</span>\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowSavedCredentialsDomain <span class="op">-</span>Name Hyper-V <span class="op">-</span>PropertyType String <span class="op">-</span>Value <span class="st">&quot;Microsoft Virtual Console Service/*&quot;</span> <span class="op">-</span>Force</span></code></pre></div>
<h1 id="vmwarepowercli">VMWare/PowerCLI</h1>
<p><code>Install-Module -Name VMware.PowerCLI # -AllowClobber</code>
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å (PackageProvider: nuget)<br />
<code>Get-Module -ListAvailable VMware* | Select Name,Version</code><br />
<code>Import-Module VMware.VimAutomation.Core</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤
—Å–µ—Å—Å–∏—é<br />
<code>Get-PSProvider | format-list Name,PSSnapIn,ModuleName</code>
—Å–ø–∏—Å–æ–∫ –æ—Å–Ω–∞—Å—Ç–æ–∫ Windows PowerShell</p>
<p><code>Get-PowerCLIConfiguration</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è<br />
<code>Set-PowerCLIConfiguration -Scope AllUsers -InvalidCertificateAction ignore -confirm:$false</code>
e—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç, –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
–ø–∞—Ä–∞–º–µ—Ç—Ä–∞ InvalidCertificateAction —Å Unset –Ω–∞ Ignore/Warn<br />
<code>Set-PowerCLIConfiguration -Scope AllUsers -ParticipateInCeip $false</code>
–æ—Ç–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ VMware Customer Experience
Improvement Program (CEIP)</p>
<p><code>Read-Host ‚ÄìAsSecureString | ConvertFrom-SecureString | Out-File "$home\Documents\vcsa_password.txt"</code>
–∑–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª<br />
<code>$esxi = "vcsa.domain.local"</code><br />
<code>$user = "administrator@vsphere.local"</code><br />
<code>$pass = Get-Content "$home\Documents\vcsa_password.txt" | ConvertTo-SecureString</code>
–ø—Ä–æ—á–∏—Ç–∞—Ç—å –ø–∞—Ä–æ–ª—å<br />
<code>$pass = "password"</code><br />
<code>$Cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $user ,$pass</code><br />
<code>Connect-VIServer $esxi -User $Cred.Username -Password $Cred.GetNetworkCredential().password</code>
–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è, –∏—Å–ø–æ–ª—å–∑—É—è PSCredential ($Cred)<br />
<code>Connect-VIServer $esxi -User $user -Password $pass</code>
–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è, –∏—Å–ø–æ–ª—å–∑—É—è –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å</p>
<p><code>Get-Command ‚ÄìModule *vmware*</code><br />
<code>Get-Command ‚ÄìModule *vmware* -name *get*iscsi*</code><br />
<code>Get-IScsiHbaTarget</code><br />
<code>Get-Datacenter</code><br />
<code>Get-Cluster</code><br />
<code>Get-VMHost</code><br />
<code>Get-VMHost | select Name,Model,ProcessorType,MaxEVCMode,NumCpu,CpuTotalMhz,CpuUsageMhz,MemoryTotalGB,MemoryUsageGB</code><br />
<code>Get-VMHostDisk | select VMHost,ScsiLun,TotalSectors</code></p>
<p><code>Get-Datastore</code><br />
<code>Get-Datastore TNAS-vmfs-4tb-01</code><br />
<code>Get-Datastore TNAS-vmfs-4tb-01 | get-vm</code><br />
<code>Get-Datastore -RelatedObject vm-01</code><br />
<code>(Get-Datastore TNAS-vmfs-4tb-01).ExtensionData.Info.GetType()</code><br />
<code>(Get-Datastore TNAS-vmfs-4tb-01).ExtensionData.Info.Vmfs.Extent</code></p>
<p><code>Get-Command ‚ÄìModule *vmware* -name *disk*</code><br />
<code>Get-VM vm-01 | Get-Datastore</code><br />
<code>Get-VM vm-01 | Get-HardDisk</code><br />
<code>Get-VM | Get-HardDisk | select Parent,Name,CapacityGB,StorageFormat,FileName | ft</code><br />
<code>Copy-HardDisk</code><br />
<code>Get-VM | Get-Snapshot</code><br />
<code>Get-VM | where {$_.Powerstate -eq "PoweredOn"}</code><br />
<code>Get-VMHost esxi-05 | Get-VM | where {$_.Powerstate -eq "PoweredOff"} | Move-VM ‚ÄìDestination (Get-VMHost esxi-06)</code></p>
<p><code>Get-VM | select Name,VMHost,PowerState,NumCpu,MemoryGB,</code><br />
<code>@{Name="UsedSpaceGB"; Expression={[int32]($_.UsedSpaceGB)}},@{Name="ProvisionedSpaceGB"; Expression={[int32]($_.ProvisionedSpaceGB)}},</code><br />
<code>CreateDate,CpuHotAddEnabled,MemoryHotAddEnabled,CpuHotRemoveEnabled,Notes</code></p>
<p><code>Get-VMGuest vm-01 | Update-Tools</code><br />
<code>Get-VMGuest vm-01 | select OSFullName,IPAddress,HostName,State,Disks,Nics,ToolsVersion</code><br />
<code>Get-VMGuest * | select -ExpandProperty IPAddress</code><br />
<code>Restart-VMGuest -vm vm-01 -Confirm:$False</code><br />
<code>Start-VM -vm vm-01 -Confirm:$False</code><br />
<code>Shutdown-VMGuest -vm vm-01 -Confirm:$false</code></p>
<p><code>New-VM ‚ÄìName vm-01 -VMHost esxi-06 ‚ÄìResourcePool Production ‚ÄìDiskGB 60 ‚ÄìDiskStorageFormat Thin ‚ÄìDatastore TNAS-vmfs-4tb-01</code><br />
<code>Get-VM vm-01 | Copy-VMGuestFile -Source "\\$srv\Install\Soft\Btest.exe" -Destination "C:\Install\" -LocalToGuest -GuestUser USER -GuestPassword PASS -force</code></p>
<p><code>Get-VM -name vm-01 | Export-VApp -Destination C:\Install -Format OVF</code>
Export template (.ovf, .vmdk, .mf)<br />
<code>Get-VM -name vm-01 | Export-VApp -Destination C:\Install -Format OVA</code></p>
<p><code>Get-VMHostNetworkAdapter | select VMHost,Name,Mac,IP,@{Label="Port Group"; Expression={$_.ExtensionData.Portgroup}} | ft</code><br />
<code>Get-VM | Get-NetworkAdapter | select Parent,Name,Id,Type,MacAddress,ConnectionState,WakeOnLanEnabled | ft</code></p>
<p><code>Get-Command ‚ÄìModule *vmware* -name *event*</code><br />
<code>Get-VIEvent -MaxSamples 1000 | where {($_.FullFormattedMessage -match "power")} | select username,CreatedTime,FullFormattedMessage</code><br />
<code>Get-logtype | select Key,SourceEntityId,Filename,Creator,Info</code><br />
<code>(Get-Log vpxd:vpxd.log).Entries | select -Last 50</code></p>
<p><code>Get-Command ‚ÄìModule *vmware* -name *syslog*</code><br />
<code>Set-VMHostSysLogServer -VMHost esxi-05 -SysLogServer "tcp://192.168.3.100" -SysLogServerPort 3515</code><br />
<code>Get-VMHostSysLogServer -VMHost esxi-05</code></p>
<h1 id="exchangeemshell">Exchange/EMShell</h1>
<p><code>$srv_cas = "exchange-cas"</code><br />
<code>$session_exchange = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://$srv_cas/PowerShell/</code>
-Credential $Cred -Authentication Kerberos<br />
<code>Get-PSSession</code><br />
<code>Import-PSSession $session_exchange -DisableNameChecking</code>
–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é</p>
<p><code>Get-ExchangeServer | select name,serverrole,admindisplayversion,Edition,OriginatingServer,WhenCreated,WhenChanged,DataPath | ft</code>
—Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤</p>
<p><code>Get-ImapSettings</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ IMAP<br />
<code>Get-ExchangeCertificate</code> —Å–ø–∏—Å–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤<br />
<code>Get-ExchangeCertificate -Thumbprint "5CEC8544D4743BC279E5FEA1679F79F5BD0C2B3A" | Enable-ExchangeCertificate -Services  IMAP, POP, IIS, SMTP</code><br />
<code>iisreset</code><br />
<code>Get-ClientAccessService | fl identity, *uri*</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
—Å–ª—É–∂–±—ã –∞–≤—Ç–æ–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤ Exchange 2016<br />
<code>Get-ClientAccessService -Identity $srv | Set-ClientAccessService -AutoDiscoverServiceInternalUri https://mail.domain.ru/Autodiscover/Autodiscover.xml</code>
–∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –≤–Ω–µ—à–Ω–∏–π –∞–¥—Ä–µ—Å<br />
<code>Get-OutlookAnywhere</code> OA –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞–º Outlook
–ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ —Å–≤–æ–∏–º –ø–æ—á—Ç–æ–≤—ã–º —è—â–∏–∫–∞–º –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ (–±–µ–∑
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è VPN)<br />
<code>Get-WebServicesVirtualDirectory</code><br />
<code>Get-OwaVirtualDirectory</code><br />
<code>Get-ActiveSyncVirtualDirectory</code><br />
<code>Get-OabVirtualDirectory</code> –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π
–∞–¥—Ä–µ—Å–Ω–æ–π –∫–Ω–∏–≥–∏<br />
<code>Get-OabVirtualDirectory -Server $srv | Set-OabVirtualDirectory -InternalUrl "https://mail.domain.ru/OAB" -ExternalUrl "https://mail.domain.ru/OAB"</code></p>
<h3 id="roles">Roles</h3>
<p>MS (Mailbox) - —Å–µ—Ä–≤–µ—Ä —Å –ë–î –ø–æ—á—Ç–æ–≤—ã—Ö —è—â–∏–∫–æ–≤ –∏ –æ–±—â–∏—Ö –ø–∞–ø–æ–∫, –æ—Ç–≤–µ—á–∞–µ—Ç
—Ç–æ–ª—å–∫–æ –∑–∞ –∏—Ö —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –Ω–∏–∫–∞–∫–∏—Ö
—Å–æ–æ–±—â–µ–Ω–∏–π.<br />
CAS (Client Access Server) - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ø–æ—á—Ç–æ–≤—ã–º
—è—â–∏–∫–∞–º, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ Outlook Web Access (HTTP –¥–ª—è Outlook
Web App), Outlook Anywhere, ActiveSync (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤),
–∏–Ω—Ç–µ—Ä–Ω–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª—ã POP3 –∏ IMAP4, MAPI –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ Microsoft
Outlook.<br />
Hub Transort - –æ—Ç–≤–µ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏
–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π Exchange, –∞ —Ç–∞–∫–∂–µ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏ Exchange. –°–æ–æ–±—â–µ–Ω–∏—è
–≤—Å–µ–≥–¥–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ä–æ–ª–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ
—Å–µ—Ä–≤–µ—Ä–∞-–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–æ—Ä–∞, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
–Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ—á—Ç–æ–≤—ã—Ö —è—â–∏–∫–æ–≤.<br />
Relay - —Ä–æ–ª—å –ø–æ–≥—Ä–∞–Ω–∏—á–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (—à–ª—é–∑ SMTP –≤ –ø–µ—Ä–∏–º–µ—Ç—Ä–µ
—Å–µ—Ç–∏).</p>
<p>SCP (Service Connection Point) - –∑–∞–ø–∏—Å—å –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ AD, –ø—Ä–∏
—Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ CAS. Outlook –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç SCP, –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ
–Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Å–∞–π—Ç–µ —Å –Ω–∏–º –∏ –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—É WhenCreated ‚Äì –ø–æ –¥–∞—Ç–µ
—Å–æ–∑–¥–∞–Ω–∏—è, –≤—ã–±–∏—Ä–∞—è —Å–∞–º—ã–π —Å—Ç–∞—Ä—ã–π.<br />
Autodiscover. Outlook –≤—ã–±–∏—Ä–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–µ—Ä–≤–µ—Ä–∞ Client Access —Ç–æ—Ç,
–∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–ø–∏—Å–∞–Ω –≤ –∞—Ç—Ä–∏–±—É—Ç–µ RPCClientAccessServer –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–≤–µ–¥–µ–Ω–∏—è –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–µ—Ä–≤–µ—Ä–µ mailbox, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∞
–ª–µ–∂–∏—Ç, –±–µ—Ä—É—Ç—Å—è –∏–∑ AD.</p>
<h3 id="messagetrackinglog">MessageTrackingLog</h3>
<p><code>Get-MessageTrackingLog -ResultSize Unlimited | select Timestamp,Sender,Recipients,RecipientCount,MessageSubject,Source,EventID,ClientHostname,ServerHostname,ConnectorId, @{Name="MessageSize"; Expression={[string]([int]($_.TotalBytes / 1024))+" KB"}},@{Name="MessageLatency"; Expression={$_.MessageLatency -replace "\.\d+$"}}</code><br />
<code>Get-MessageTrackingLog -Start (Get-Date).AddHours(-24) -ResultSize Unlimited | where {[string]$_.recipients -like "*@yandex.ru"}</code>
–≤—ã–≤–µ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞, –≥–¥–µ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º –±—ã–ª —É–∫–∞–∑–∞–Ω–Ω—ã–π
–¥–æ–º–µ–Ω<br />
-Start ‚Äú04/01/2023 09:00:00‚Äù -End ‚Äú04/01/2023 18:00:00‚Äù - –ø–æ–∏—Å–∫ –ø–æ
—É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø—Ä–æ–º–µ–∂—É—Ç–∫—É –≤—Ä–µ–º–µ–Ω–∏<br />
-MessageSubject ‚Äú–¢–µ—Å—Ç‚Äù - –ø–æ–∏—Å–∫ –ø–æ —Ç–µ–º–µ –ø–∏—Å—å–º–∞<br />
-Recipients ‚Äúsupport4@domain.ru‚Äù - –ø–æ–∏—Å–∫ –ø–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—é<br />
-Sender - –ø–æ–∏—Å–∫ –ø–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—é<br />
-EventID ‚Äì –ø–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É —Å–æ–±—ã—Ç–∏—è —Å–µ—Ä–≤–µ—Ä–∞ (RECEIVE, SEND, FAIL, DSN,
DELIVER, BADMAIL, RESOLVE, EXPAND, REDIRECT, TRANSFER, SUBMIT,
POISONMESSAGE, DEFER)<br />
-Server ‚Äì –ø–æ–∏—Å–∫ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ<br />
-messageID ‚Äì —Ç—Ä–µ–∫–∏–Ω–≥ –ø–∏—Å—å–º–∞ –ø–æ –µ–≥–æ ID</p>
<h3 id="mailbox">Mailbox</h3>
<p><code>Get-Mailbox -Database "it2"</code> —Å–ø–∏—Å–æ–∫ –ø–æ—á—Ç–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤
–±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö<br />
<code>Get-Mailbox -resultsize unlimited | ? Emailaddresses -like "support4" | format-list name,emailaddresses,database,servername</code>
–∫–∞–∫—É—é –ë–î, —Å–µ—Ä–≤–µ—Ä –∏ smtp-–∞–¥—Ä–µ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫<br />
<code>Get-Mailbox -Database $db_name -Archive</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∞—Ä—Ö–∏–≤–Ω—ã–µ
–ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏</p>
<p><code>Get-MailboxFolderStatistics -Identity "support4" -FolderScope All | select Name,ItemsInFolder,FolderSize</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–æ–ª-–≤–æ –ø–∏—Å–µ–º –∏ —Ä–∞–∑–º–µ—Ä –≤ –∫–∞–∂–¥–æ–π –ø–∞–ø–∫–µ<br />
<code>Get-MailboxStatistics "support4" | select DisplayName,LastLoggedOnUserAccount,LastLogonTime,LastLogoffTime,ItemCount,TotalItemSize,DeletedItemCount,TotalDeletedItemSize,Database,ServerName</code>
–æ–±—â–µ–µ –∫–æ–ª-–≤–æ –ø–∏—Å–µ–º, –∏—Ö —Ä–∞–∑–º–µ—Ä, –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞ –∏ –≤—ã—Ö–æ–¥–∞, –∏–º—è
—Å–µ—Ä–≤–µ—Ä–∞ –∏ –ë–î<br />
<code>Get-Mailbox -Server s2 | Get-MailboxStatistics | where {$_.Lastlogontime -lt (get-date).AddDays(-30)} | Sort Lastlogontime -desc | ft displayname,Lastlogontime,totalitemsize</code>
—è—â–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å 30 –∏ –±–æ–ª–µ–µ –¥–Ω–µ–π</p>
<p><code>Enable-Mailbox -Identity support9 -Database test_base</code>
—Å–æ–∑–¥–∞—Ç—å –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ AD<br />
<code>New-Mailbox -Name $login -UserPrincipalName "$login@$domain" -Database $select_db -OrganizationalUnit $path -Password (ConvertTo-SecureString -String "$password" -AsPlainText -Force)</code>
—Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é AD<br />
<code>Get-MailboxDatabase -Database $db_name | Remove-MailboxDatabase</code>
—É–¥–∞–ª–∏—Ç—å –ë–î</p>
<p><code>Set-MailBox "support4" -PrimarySmtpAddress support24@domain.ru -EmailAddressPolicyEnabled $false</code>
–¥–æ–±–∞–≤–∏—Ç—å –∏ –∏–∑–º–µ–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π SMTP-–∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã –¥–ª—è
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>Set-Mailbox -Identity "support4" -DeliverToMailboxAndForward $true -ForwardingSMTPAddress "username@outlook.com"</code>
–≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—é –ø–æ—á—Ç—ã (—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è support4 –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É
username@outlook.com)</p>
<h3 id="moverequest">MoveRequest</h3>
<p><code>Get-Mailbox -Database $db_in | New-MoveRequest -TargetDatabase $db_out</code>
–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤—Å–µ –ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏ –∏–∑ –æ–¥–Ω–æ–π –ë–î –≤ –¥—Ä—É–≥—É—é<br />
<code>New-MoveRequest -Identity $db_in -TargetDatabase $db_out</code>
–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –æ–¥–∏–Ω –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫<br />
<code>Get-MoveRequest | Suspend-MoveRequest</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã
–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è<br />
<code>Get-MoveRequest | Remove-MoveRequest</code> —É–¥–∞–ª–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞
–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ<br />
<code>Get-MoveRequest | Get-MoveRequestStatistics</code> —Å—Ç–∞—Ç—É—Å
–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è</p>
<p>Status:<br />
Cleanup - –Ω—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å<br />
Queued - –≤ –æ—á–µ—Ä–µ–¥–∏<br />
InProgress - –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ<br />
Percent Complete - –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è<br />
CompletionInProgress - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞<br />
Completed - –∑–∞–≤–µ—Ä—à–µ–Ω–æ</p>
<p><code>Remove-MoveRequest -Identity $db_name</code> –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è (—É–±—Ä–∞—Ç—å —Å—Ç–∞—Ç—É—Å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —Å –ø–æ—á—Ç–æ–≤–æ–≥–æ —è—â–∏–∫–∞ –∏ –æ—á–∏—Å—Ç–∏—Ç—å
—Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π)<br />
<code>Get-MailboxDatabase | Select Name, MailboxRetention</code> –ø–æ—Å–ª–µ
–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —è—â–∏–∫–æ–≤, —Ä–∞–∑–º–µ—Ä –±–∞–∑—ã –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è, –ø–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –±–∞–∑—ã
–ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, –∫–∞–∫ –ø—Ä–æ–π–¥–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π, –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–µ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ
MailboxRetention<br />
<code>Set-MailboxDatabase -MailboxRetention '0.00:00:00' -Identity $db_name</code>
–∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ</p>
<h3 id="archive">Archive</h3>
<p><code>Enable-Mailbox -Identity $name -Archive</code> –≤–∫–ª—é—á–∏—Ç—å –∞—Ä—Ö–∏–≤
–¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>Get-Mailbox $name | New-MoveReques ‚ÄìArchiveOnly ‚ÄìArchiveTargetDatabase DBArch</code>
–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∞—Ä—Ö–∏–≤–Ω—ã–π –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ –≤ –¥—Ä—É–≥—É—é –ë–î<br />
<code>Get-Mailbox $name | fl Name,Database,ArchiveDatabase</code> –º–µ—Å—Ç–æ
—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –ë–î –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ë–î –µ–≥–æ –∞—Ä—Ö–∏–≤–∞<br />
<code>Disable-Mailbox -Identity $name -Archive</code> –æ—Ç–∫–ª—é—á–∏—Ç—å
–∞—Ä—Ö–∏–≤<br />
<code>Connect-Mailbox -Identity "8734c04e-981e-4ccf-a547-1c1ac7ebf3e2" -Archive -User $name -Database it2</code>
–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø–æ—á—Ç–æ–≤–æ–º—É —è—â–∏–∫—É<br />
<code>Get-Mailbox $name | Set-Mailbox -ArchiveQuota 20GB -ArchiveWarningQuota 19GB</code>
–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–≤–æ—Ç—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –∞—Ä—Ö–∏–≤–∞</p>
<h3 id="quota">Quota</h3>
<p><code>Get-Mailbox -Identity $mailbox | fl IssueWarningQuota, ProhibitSendQuota, ProhibitSendReceiveQuota, UseDatabaseQuotaDefaults</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–≤–æ—Ç—ã –ø–æ—á—Ç–æ–≤–æ–≥–æ —è—â–∏–∫–∞<br />
IssueWarningQuota ‚Äî –∫–≤–æ—Ç–∞, –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –∫–æ—Ç–æ—Ä–æ–π Exchange –æ—Ç–ø—Ä–∞–≤–∏—Ç
—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ<br />
ProhibitSendQuota ‚Äî –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –±—É–¥–µ—Ç –∑–∞–ø—Ä–µ—â–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞<br />
ProhibitSendReceiveQuota ‚Äî –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –±—É–¥–µ—Ç –∑–∞–ø—Ä–µ—â–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏
–ø–æ–ª—É—á–µ–Ω–∏–µ<br />
UseDatabaseQuotaDefaults ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –∫–≤–æ—Ç–∞ –ë–î –∏–ª–∏ false -
–∏–Ω–¥–≤–∏–¥–∏—É–∞–ª—å–Ω—ã–µ<br />
<code>Set-Mailbox -Identity $mailbox -UseDatabaseQuotaDefaults $false -IssueWarningQuota "3 GB" -ProhibitSendQuota "4 GB" -ProhibitSendReceiveQuota "5 GB"</code>
–∑–∞–¥–∞—Ç—å –∫–≤–æ—Ç—É –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
<p><code>Get-MailboxDatabase $db_name | fl Name, *Quota</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–≤–æ—Ç—ã –Ω–∞–ª–æ–∂–µ–Ω–Ω—ã–µ –Ω–∞ –ë–î<br />
<code>Set-MailboxDatabase $db -ProhibitSendReceiveQuota "5 GB" -ProhibitSendQuota "4 GB" -IssueWarningQuota "3 GB"</code>
–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–≤–æ—Ç—ã –Ω–∞ –ë–î</p>
<h3 id="database">Database</h3>
<p><code>Get-MailboxDatabase -Status | select ServerName,Name,DatabaseSize</code>
—Å–ø–∏—Å–æ–∫ –∏ —Ä–∞–∑–º–µ—Ä –≤—Å–µ—Ö –ë–î –Ω–∞ –≤—Å–µ—Ö MX-—Å–µ—Ä–≤–µ—Ä–∞—Ö<br />
<code>New-MailboxDatabase -Name it_2022 -EdbFilePath E:\Bases\it_2022\it_2022.edb -LogFolderPath G:\Logs\it_2022 -OfflineAddressBook "Default Offline Address List" -server exch-mx-01</code>
—Å–æ–∑–¥–∞—Ç—å –ë–î<br />
<code>Restart-Service MSExchangeIS</code><br />
<code>Get-Service | Where {$_ -match "exchange"} | Restart-Service</code><br />
<code>Get-MailboxDatabase -Server exch-01</code> —Å–ø–∏—Å–æ–∫ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –Ω–∞
MX-—Å–µ—Ä–≤–µ—Ä–µ<br />
<code>New-MoveRequest -Identity "support4" -TargetDatabase it_2022</code>
–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ –≤ –Ω–æ–≤—É—é –ë–î<br />
<code>Move-Databasepath $db_name ‚ÄìEdbFilepath "F:\DB\$db_name\$db_name.edb" ‚ÄìLogFolderpath "E:\DB\$db_name\logs\"</code>
–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ë–î –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –ª–æ–≥–∏ –Ω–∞ –¥—Ä—É–≥–æ–π –¥–∏—Å–∫<br />
<code>Set-MailboxDatabase -CircularLoggingEnabled $true -Identity $db_name</code>
–≤–∫–ª—é—á–∏—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –≤–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ (Circular Logging), –≥–¥–µ
–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø–∏—à—É—Ç—Å—è 4 —Ñ–∞–π–ª–∞ –ª–æ–≥–æ–≤ –ø–æ 5 –ú–ë, –ø–æ—Å–ª–µ —á–µ–≥–æ –ø–µ—Ä–≤—ã–π
–ª–æ–≥-—Ñ–∞–π–ª –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è<br />
<code>Set-MailboxDatabase -CircularLoggingEnabled $false -Identity $db_name</code>
–æ—Ç–∫–ª—é—á–∏—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –≤–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞<br />
<code>Get-MailboxDatabase -Server "exch-mx-01" -Status | select EdbFilePath,LogFolderPath,LogFilePrefix</code>
–ø—É—Ç—å –∫ –ë–î, –ª–æ–≥–∞–º, –∏–º—è —Ç–µ–∫—É—â–µ–≥–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥-—Ñ–∞–π–ª–∞</p>
<h3 id="mailboxrepairrequest">MailboxRepairRequest</h3>
<p><code>New-MailboxRepairRequest -Database it2 -CorruptionType ProvisionedFolder, SearchFolder, AggregateCounts, Folderview</code>
–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç (–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω
–æ–¥–∏–Ω –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫) –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ<br />
<code>Get-MailboxRepairRequest -Database it2</code> –ø—Ä–æ–≥—Ä–µ—Å—Å
–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è<br />
–ü–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø—Ä–∞–≤–∏—Ç—å:<br />
ProvisionedFolder ‚Äì –Ω–∞—Ä—É—à–µ–Ω–∏—è –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–ø–æ–∫<br />
SearchFolder ‚Äì –æ—à–∏–±–∫–∏ –≤ –ø–∞–ø–∫–∞—Ö –ø–æ–∏—Å–∫–∞<br />
AggregateCounts ‚Äì –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ
—ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ø–∞–ø–∫–∞—Ö –∏ –∏—Ö —Ä–∞–∑–º–µ—Ä–µ<br />
FolderView ‚Äì –Ω–µ–≤–µ—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º–∏ –ø–∞–ø–æ–∫</p>
<h3 id="eseutil">eseutil</h3>
<p>–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ/–ø–æ–ª—É—á–µ–Ω–∏–∏ –ª—é–±–æ–≥–æ –ø–∏—Å—å–º–∞ Exchange —Å–Ω–∞—á–∞–ª–∞ –≤–Ω–æ—Å–∏—Ç
–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–π –ª–æ–≥, –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç
–Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –†–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ –ª–æ–≥ —Ñ–∞–π–ª–∞ - 1 –ú–±. –ï—Å—Ç—å —Ç—Ä–∏
—Å–ø–æ—Å–æ–±–∞ —É—Ä–µ–∑–∞–Ω–∏—è –ª–æ–≥–æ–≤: DAG, Backup –Ω–∞ –±–∞–∑–µ Volume Shadow Copy, Circular
Logging.</p>
<p>–†—É—á–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:<br />
<code>cd E:\MS_Exchange_2010\MailBox\Reg_v1_MailBoxes\</code> –ø–µ—Ä–µ–π—Ç–∏ –≤
–∫–∞—Ç–∞–ª–æ–≥ —Å –ª–æ–≥–∞–º–∏<br />
<code>ls E*.chk</code> —É–∑–Ω–∞—Ç—å –∏–º—è —Ñ–∞–π–ª–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
–∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∂—É—Ä–Ω–∞–ª–æ–≤<br />
<code>eseutil /mk .\E18.chk</code> —É–∑–Ω–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ñ–∞–π–ª –∂—É—Ä–Ω–∞–ª–∞,
–¥–µ–π—Å—Ç–≤–∏—è –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –±—ã–ª–∏ –∑–∞–Ω–µ—Å–µ–Ω—ã –≤ –ë–î Exchange<br />
<code>Checkpoint: (0x561299,8,16)</code> 561299 –∏–º—è —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª
–ø–æ—Å–ª–µ–¥–Ω–∏–º –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω (–µ–≥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —É–∂–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö)<br />
–ù–∞—Ö–æ–¥–∏–º –≤ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–µ —Ñ–∞–π–ª E0500561299.txt, –º–æ–∂–Ω–æ —É–¥–∞–ª—è—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã
–∂—É—Ä–Ω–∞–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–∞—Ä—à–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞</p>
<p>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î (–µ—Å–ª–∏ –¥–≤–µ –∫–æ–ø–∏–∏ –ë–î —Å –æ—à–∏–±–∫–æ–π):<br />
<code>Get-MailboxDatabaseCopyStatus -Identity db_name\* | Format-List Name,Status,ContentIndexState</code><br />
Status : FailedAndSuspended<br />
ContentIndexState : Failed<br />
Status : Dismounted<br />
ContentIndexState : Failed</p>
<p><code>Get-MailboxDatabase -Server exch-mx-01 -Status | fl Name,EdbFilePath,LogFolderPath</code>
–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –±–∞–∑—ã –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ª–æ–≥–æ–≤<br />
LogFolderPath - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ª–æ–≥–æ–≤<br />
E18 - –∏–º—è —Ç—Ä–∞–Ω–∫–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –ª–æ–≥–∞ (–∏–∑ –Ω–µ–≥–æ —á–∏—Ç–∞—é—Ç—Å—è –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏)<br />
<code>dismount-Database db_name</code> –æ—Ç–º–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ë–î<br />
<code>eseutil /mh D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code>
–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑—É<br />
State: Dirty Shutdown - –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —á–∞—Å—Ç—å
—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ –±–∞–∑—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –±—ã–ª–∞
–æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∞ –∞–≤–∞—Ä–∏–π–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞.<br />
<code>eseutil /ml E:\MS_Exchange_2010\MailBox\db_name\E18</code>
–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ª–æ–≥–∏, –µ—Å–ª–∏ –µ—Å—Ç—å –ª–æ–≥–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏
–æ–Ω–∏ –Ω–µ –∏—Å–ø–æ—Ä—á–µ–Ω—ã, —Ç–æ –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –Ω–∏—Ö, –∏–∑ —Ñ–∞–π–ª–∞ E18 —Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è
–≤—Å–µ –ª–æ–≥–∏, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç–∞—Ç—É—Å - –û–ö</p>
<p>Soft Recovery (–º—è–≥–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ) - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –±–∞–∑—É –≤
—Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è (Clear shutdown) –ø—É—Ç–µ–º –∑–∞–ø–∏—Å–∏
–Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤ –∂—É—Ä–Ω–∞–ª–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –ë–î.<br />
<code>eseutil /R E18 /l E:\MS_Exchange_2010\MailBox\db_name\ /d D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code><br />
<code>eseutil /R E18 /a /i /l E:\MS_Exchange_2010\MailBox\db_name\ /d D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code>
–µ—Å–ª–∏ —Å –ª–æ–≥–∞–º–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫, –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–∑—É
–∏–≥–Ω–æ—Ä–∏—Ä—É—è –æ—à–∏–±–∫—É –≤ –ª–æ–≥–∞—Ö<br />
<code>eseutil /mk D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code>
c–æ—Å—Ç–æ—è–Ω–∏–∏ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫<br />
<code>eseutil /g D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code>
–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ë–î<br />
<code>eseutil /k D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code>
–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Å—É–º–º –±–∞–∑—ã (CRC)</p>
<p>Hard Recovery - –µ—Å–ª–∏ –ª–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ—à–∏–±–∫–∏ –∏ –±–∞–∑–∞ –Ω–µ
–≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, —Ç–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∞–∑—É –±–µ–∑ –ª–æ–≥–æ–≤.<br />
<code>eseutil /p D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code><br />
/p - —É–¥–∞–ª–∏—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞ –∏–∑ –ë–î –∏
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å<br />
<code>esetuil /d D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code>
–≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—é (–µ—Å–ª–∏ –±—ã–ª –ø–æ—Ç–µ—Ä—è–Ω –±–æ–ª—å—à–æ–π –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö, —Ç–æ
–º–æ–∂–µ—Ç —Å–∏–ª—å–Ω–æ —Å–Ω–∏–∑–∏—Ç—å—Å—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)<br />
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—Ä—É—á–Ω—É—é —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã —Å
—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º log –≤ –ø–∞–ø–∫–µ MDBDATA, –ø–µ—Ä–µ–¥ –ø–æ–ø—ã—Ç–∫–æ–π —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É
–¥–∞–Ω–Ω—ã—Ö.<br />
<code>isinteg -s "db_name.edb" -test alltests</code> –ø—Ä–æ–≤–µ—Ä—å—Ç–µ
—Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö<br />
<code>isinteg -s "server_name" -fix -test -alltests</code> –µ—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞
–±—É–¥–µ—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω–∞. –í—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—É –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ —É –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ –Ω–µ
—Å—Ç–∞–Ω–µ—Ç —Å—Ç–∞—Ç—É—Å 0 –∏–ª–∏ —Å—Ç–∞—Ç—É—Å –Ω–µ –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç –º–µ–Ω—è—Ç—å—Å—è, –∏–Ω–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ 3
–ø—Ä–æ—Ö–æ–¥–∞ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.<br />
<code>eseutil /mh D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb | Select-String -Pattern "State:","Log Required:"</code>
–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å<br />
State: Clear shutdown - —É—Å–ø–µ—à–Ω—ã–π —Å—Ç–∞—Ç—É—Å<br />
<code>Log Required</code> —Ç—Ä–µ–±—É—é—Ç—Å—è –ª–∏ —Ñ–∞–π–ª—ã –∂—É—Ä–Ω–∞–ª–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∞–∑–µ,
—á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –≤ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –ï—Å–ª–∏ –±–∞–∑–∞ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞
–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —Ç–æ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–≤–Ω—è—Ç—å—Å—è 0.<br />
<code>mount-Database -force db_name</code> –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ë–î<br />
<code>Get-MailboxDatabase ‚ÄìStatus db_name | fl Mounted</code> —Å—Ç–∞—Ç—É—Å
–ë–î<br />
<code>New-MailboxRepairRequest -Database db_name -CorruptionType SearchFolder,AggregateCounts,ProvisionedFolder,FolderView</code>
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö<br />
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Index.<br />
–ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å—ã –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è, –Ω–æ –ë–î –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —Ç–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏
–ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏ –≤ –Ω–æ–≤—É—é –ë–î.</p>
<p>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –∏–∑ Backup:</p>
<p>1-–π –≤–∞—Ä–∏–∞–Ω—Ç: 1. –û—Ç–º–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –ë–î –∏ —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å
–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å —Ñ–∞–π–ª–∞–º–∏ —Ç–µ–∫—É—â–µ–π –ë–î. 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ —Ç—É –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏–∑
Backup –±–∞–∑—É —Å –ª–æ–≥–∞–º–∏. 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º—è–≥–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î (Soft
Recovery). 5. –ü—Ä–∏–º–æ–Ω–∏—Ç–æ—Ä–≤–∞—Ç—å.</p>
<p>2-–π –≤–∞—Ä–∏–∞–Ω—Ç: 1. –û—Ç–º–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å —Ç–µ–∫—É—â—É—é –ë–î. 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
–ë–î —Å –ª–æ–≥–∞–º–∏ –∏–∑ Backup –≤ –ª—é–±–æ–µ –º–µ—Å—Ç–æ. 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º—è–≥–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
–ë–î (Soft Recovery). 4. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ë–î. 5. –°–æ–∑–¥–∞—Ç—å Recovery Database –∏
—Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –Ω–µ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—É—é –∏–∑ –±—ç–∫–∞–ø–∞ –ë–î, —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ –Ω–µ—ë
–ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏ –≤ –Ω–æ–≤—É—é –ë–î –∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ –Ω–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. 6. –ï—Å–ª–∏
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Dial Tone Recovery, —Ç–æ —Ç–∞–∫ –∂–µ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∏–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ë–î
–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—á—Ç–æ–≤—ã—Ö —è—â–∏–∫–æ–≤.</p>
<p>3-–π –≤–∞—Ä–∏–∞–Ω—Ç: 1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å Soft Repair –∏–ª–∏ Hard
Recovery. 2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ë–î. –£–∫–∞–∑—ã–≤–∞—Ç—å –≤ —Å–≤–æ–π—Å—Ç–≤–∞—Ö: ¬´–±–∞–∑–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å
–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–∞ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏¬ª. 3. –ï—Å–ª–∏ –±–∞–∑–∞ –±—ã–ª–∞ —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ–∑–¥–∞–Ω–∞ –∏
–µ—â–µ –Ω–µ –±—ã–ª–∞ –ø–æ–¥–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞, —Ç–æ —ç—Ç–∞ –ø–∞–ø–∫–∞ –±—É–¥–µ—Ç –ø—É—Å—Ç–∞, —Ç—É–¥–∞ –ø–µ—Ä–µ–º–µ—â–∞–µ–º
–±–∞–∑—É –∏–∑ Backup, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ ESEUTIL –≤–º–µ—Å—Ç–µ —Å–æ –≤—Å–µ–º–∏ —Ñ–∞–π–ª–∞–º–∏.
–£–∫–∞–∑–∞—Ç—å –∏–º—è .edb —Ç–∞–∫–æ–µ –∂–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—ã–ª–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –±–∞–∑—ã. 4.
–ú–æ–Ω—Ç–∏—Ä—É–µ–º –±–∞–∑—É. 5. –ü–µ—Ä–µ–Ω–∞—Ü–µ–ª–∏–≤–∞–µ–º —è—â–∏–∫–∏ —Å–æ —Å—Ç–∞—Ä–æ–π (Mailbox_DB_02),
–Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ–π –±–∞–∑—ã, –Ω–∞ –Ω–æ–≤—É—é –±–∞–∑—É (Mailbox_DB_02_02):
<code>Get-Mailbox -Database Mailbox_DB_02 | where {$_.ObjectClass -NotMatch '(SystemAttendantMailbox|ExOleDbSystemMailbox)'} | Set-Mailbox -Database Mailbox_DB_02_02</code>
6. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö:
<code>New-MailboxRepairRequest -Database "Mailbox_DB_02_02" -CorruptionType ProvisionedFolder, SearchFolder, AggregateCounts, Folderview</code></p>
<h3 id="dial-tone-recovery">Dial Tone Recovery</h3>
<p><code>Get-Mailbox -Database "MailboxDB" | Set-Mailbox -Database "TempDB"</code>
–ø–µ—Ä–µ–Ω–∞—Ü–µ–ª–∏—Ç—å —è—â–∏–∫–∏ —Å –æ–¥–Ω–æ–π –ë–î (–Ω–µ—Ä–∞–±–æ—á–µ–π) –Ω–∞ –¥—Ä—É–≥—É—é (–ø—É—Å—Ç—É—é)<br />
<code>Get-Mailbox -Database TempDB</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏ –≤ –ë–î
TempDB<br />
<code>Restart-Service MSExchangeIS</code> –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É Mailbox
Information Store (–±–∞–Ω–∫–∞ –¥–∞–Ω–Ω—ã—Ö), –∏–Ω–∞—á–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É
–ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å—Ç–∞—Ä–æ–π –ë–î<br />
<code>iisreset</code><br />
<code>Get-Mailbox -Database "TempDB" | Set-Mailbox -Database "MailboxDB"</code>
–ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ä–æ–π –ë–î, –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å
–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ë–î –æ–±—Ä–∞—Ç–Ω–æ<br />
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–¥–µ–ª–∞—Ç—å —Å–ª–∏—è–Ω–∏–µ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ë–î —Å –ø–æ–º–æ—â—å—é Recovery.</p>
<h3 id="recovery-database-rdb">Recovery database (RDB)</h3>
<p><code>New-MailboxDatabase ‚ÄìRecovery ‚ÄìName RecoveryDB ‚ÄìServer $exch_mx ‚ÄìEdbFilePath "D:\TempDB\TempDB.edb" -LogFolderPath "D:\TempDB"</code>
–¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –Ω–æ–≤—ã—Ö –ø–∏—Å–µ–º –∏–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ë–î –≤ –æ—Å–Ω–æ–≤–Ω—É—é –Ω–µ–æ–±—Ö–æ–¥–∏–º —Ç–æ–ª—å–∫–æ —Å–∞–º
—Ñ–∞–π–ª TempDB.edb —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º Clean Shutdown, –∏–∑ –Ω–µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å
—Å–ª—É–∂–µ–±–Ω—É—é –ë–î (–∫–ª—é—á -Recovery)<br />
<code>Mount-Database "D:\TempDB\TempDB.edb"</code> –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
–ë–î<br />
<code>Get-MailboxStatistics -Database RecoveryDB</code><br />
<code>New-MailboxRestoreRequest ‚ÄìSourceDatabase RecoveryDB ‚ÄìSourceStoreMailbox support ‚ÄìTargetMailbox support</code>
—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ—á—Ç–æ–≤–æ–≥–æ —è—â–∏–∫–∞ —Å DisplayName: support –∏–∑ RecoveryDB
–≤ –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ —Å –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–º support —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑—ã. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
–∏—â–µ—Ç –≤ –ø–æ—á—Ç–æ–≤–æ–π –±–∞–∑–µ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ LegacyExchangeDN –ª–∏–±–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç
—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ X500, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –¥—Ä—É–≥–æ–π —è—â–∏–∫,
–Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –∫–ª—é—á -AllowLegacyDNMisMatch<br />
<code>New-MailboxRestoreRequest ‚ÄìSourceDatabase RecoveryDB ‚ÄìSourceStoreMailbox support ‚ÄìTargetMailbox support ‚ÄìTargetRootFolder "Restore"</code>
—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∏—Å—å–º–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ø–∫—É –≤ —è—â–∏–∫–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (—Å–æ–∑–¥–∞–µ—Ç—Å—è
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏), –≤–æ–∑–º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞–ø–∫–∏
-IncludeFolders ‚Äú#Inbox#‚Äù<br />
<code>Get-MailboxRestoreRequest | Get-MailboxRestoreRequestStatistics</code>
—Å—Ç–∞—Ç—É—Å –∑–∞–ø—Ä–æ—Å–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è<br />
<code>Get-MailboxRestoreRequestStatistics -Identity support</code><br />
<code>Get-MailboxRestoreRequest -Status Completed | Remove-MailboxRestoreRequest</code>
—É–¥–∞–ª–∏—Ç—å –≤—Å–µ —É—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã</p>
<h3 id="transport">Transport</h3>
<p><code>Get-TransportServer $srv_cas | select MaxConcurrentMailboxDeliveries,MaxConcurrentMailboxSubmissions,MaxConnectionRatePerMinute,MaxOutboundConnections,MaxPerDomainOutboundConnections,PickupDirectoryMaxMessagesPerMinute</code>
–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞<br />
MaxConcurrentMailboxDeliveries ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
–ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å–µ–º.<br />
MaxConcurrentMailboxSubmissions ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
–ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∏—Å–µ–º.<br />
MaxConnectionRatePerMinute ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤–æ–∑–º–æ–∂–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–∫—Ä—ã—Ç–∏—è
–≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É.<br />
MaxOutboundConnections ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤–æ–∑–º–æ–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π,
–∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å Exchange –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏.<br />
MaxPerDomainOutboundConnections ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤–æ–∑–º–æ–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
–∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å Exchange –¥–ª—è –æ–¥–Ω–æ–≥–æ
—É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞.<br />
PickupDirectoryMaxMessagesPerMinute ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
—Å–æ–æ–±—â–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∏—Å–µ–º –ø–æ –ø–∞–ø–∫–∞–º).<br />
<code>Set-TransportServer exchange-cas -MaxConcurrentMailboxDeliveries 21 -MaxConcurrentMailboxSubmissions 21 -MaxConnectionRatePerMinute 1201 -MaxOutboundConnections 1001 -MaxPerDomainOutboundConnections 21 -PickupDirectoryMaxMessagesPerMinute 101</code>
–∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è</p>
<p><code>Get-TransportConfig | select MaxSendSize, MaxReceiveSize</code>
–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç—Ä–∞—Å–ø–æ—Ä—Ç–∞ (–Ω–∞–∏–º–µ–Ω—å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç,
–ø–æ—Å–ª–µ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞ –∏ –ø–æ—á—Ç–æ–≤–æ–≥–æ —è—â–∏–∫–∞).<br />
<code>New-TransportRule -Name AttachmentLimit -AttachmentSizeOver 15MB -RejectMessageReasonText "Sorry, messages with attachments over 15 MB are not accepted"</code>
—Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ –≤–ª–æ–∂–µ–Ω–∏—è</p>
<h3 id="connector">Connector</h3>
<p><code>Get-ReceiveConnector | select Name,MaxMessageSize,RemoteIPRanges,WhenChanged</code>
–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∏–∂–µ, —á–µ–º
—É –ø–æ—á—Ç–æ–≤–æ–≥–æ —è—â–∏–∫–∞)<br />
<code>Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MaxMessageSize 30Mb</code>
–∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä —É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞ –≤ —Å–ø–∏—Å–∫–µ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤—ã—à–µ, —á–µ–º —É
—Ç—Ä–∞—Å–ø–æ—Ä—Ç–∞)<br />
<code>Get-Mailbox "support4" | select MaxSendSize, MaxReceiveSize</code>
–Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç<br />
<code>Set-Mailbox "support4" -MaxSendSize 30MB -MaxReceiveSize 30MB</code>
–∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä</p>
<p><code>Set-SendConnector -Identity "ConnectorName" -Port 26</code>
–∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏<br />
<code>Get-SendConnector "proxmox" | select port</code></p>
<p><code>Get-ReceiveConnector | select Name,MaxRecipientsPerMessage</code>
–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é Exchange –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–¥—Ä–µ—Å–∞—Ç–æ–≤ –≤
–æ–¥–Ω–æ–º –ø–∏—Å—å–º–µ (200)<br />
<code>Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MaxRecipientsPerMessage 50</code>
–∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ<br />
<code>Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MessageRateLimit 1000</code>
–∑–∞–¥–∞—Ç—å –ª–∏–º–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É –¥–ª—è –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞</p>
<p><code>Get-OfflineAddressbook | Update-OfflineAddressbook</code>
–æ–±–Ω–æ–≤–∏—Ç—å OAB<br />
<code>Get-ClientAccessServer | Update-FileDistributionService</code></p>
<h3 id="pst">PST</h3>
<p><code>New-MailboxExportRequest -Mailbox $name -filepath "\\$srv\pst\$name.PST" # -ContentFilter {(Received -lt "01/01/2021")} -Priority Highest/Lower # -IsArchive</code>
–≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –∏–∑ –∞—Ä—Ö–∏–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>New-MailboxExportRequest -Mailbox $name -IncludeFolders "#Inbox#" -FilePath "\\$srv\pst\$name.PST"</code>
—Ç–æ–ª—å–∫–æ –ø–∞–ø–∫—É –≤—Ö–æ–¥—è—â–∏–µ<br />
<code>New-MailboxImportRequest -Mailbox $name "\\$srv\pst\$name.PST"</code>
–∏–º–ø–æ—Ä—Ç –∏–∑ PST<br />
<code>Get-MailboxExportRequest</code> —Å—Ç–∞—Ç—É—Å –∑–∞–ø—Ä–æ—Å–æ–≤<br />
<code>Get-MailboxExportRequest -Status Completed | Remove-MailboxExportRequest</code>
—É–¥–∞–ª–∏—Ç—å —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã<br />
<code>Remove-MailboxExportRequest -RequestQueue MBXDB01 -RequestGuid 25e0eaf2-6cc2-4353-b83e-5cb7b72d441f</code>
–æ—Ç–º–µ–Ω–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç</p>
<h3 id="distributiongroup">DistributionGroup</h3>
<p><code>Get-DistributionGroup</code> —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø —Ä–∞—Å—Å—ã–ª–∫–∏<br />
<code>Get-DistributionGroupMember "!_–û—Ñ–∏—Å"</code> —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤
–≥—Ä—É–ø–ø–µ<br />
<code>Add-DistributionGroupMember -Identity "!_–û—Ñ–∏—Å" -Member "$name@$domain"</code>
–¥–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É —Ä–∞—Å—Å—ã–ª–∫–∏<br />
<code>Remove-DistributionGroupMember -Identity "!_–û—Ñ–∏—Å" -Member "$name@$domain"</code><br />
<code>New-DistributionGroup -Name "!_–¢–µ—Å—Ç" -Members "$name@$domain"</code>
—Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É<br />
<code>Set-DistributionGroup -Identity "support4" -HiddenFromAddressListsEnabled $true (–∏–ª–∏ Set-Mailbox)</code>
—Å–∫—Ä—ã—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞ –∞–¥—Ä–µ—Å–æ–≤ Exchange</p>
<h3 id="search">Search</h3>
<p><code>Search-Mailbox -Identity "support4" -SearchQuery '–¢–µ–º–∞:"Mikrotik DOWN"'</code>
–ø–æ–∏—Å–∫ –ø–∏—Å–µ–º –ø–æ —Ç–µ–º–µ<br />
<code>Search-Mailbox -Identity "support4" -SearchQuery 'Subject:"Mikrotik DOWN"'</code><br />
<code>Search-Mailbox -Identity "support4" -SearchQuery 'attachment -like:"*.rar"'</code><br />
<code>Search-Mailbox -Identity "support4" -SearchQuery "–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: &lt; 01/01/2020" -DeleteContent -Force</code>
—É–¥–∞–ª–µ–Ω–∏–µ –ø–∏—Å–µ–º –ø–æ –¥–∞—Ç–µ</p>
<p>–§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–µ—Ä–≤–µ—Ä–∞:<br />
<code>20/07/2018</code><br />
<code>07/20/2018</code><br />
<code>20-Jul-2018</code><br />
<code>20/July/2018</code></p>
<h3 id="auditlog">AuditLog</h3>
<p><code>Get-AdminAuditLogConfig</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—É–¥–∏—Ç–∞<br />
<code>Set-Mailbox -Identity "support4" -AuditOwner HardDelete</code>
–¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ HardDelete –ø–∏—Å–µ–º<br />
<code>Set-mailbox -identity "support4" -AuditlogAgelimit 120</code>
—É–∫–∞–∑–∞—Ç—å –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è<br />
<code>Get-mailbox -identity "support4" | Format-list Audit*</code>
–¥–∞–Ω–Ω—ã–µ –∞—É–¥–∏—Ç–∞<br />
<code>Search-MailboxAuditLog -Identity "support4" -LogonTypes Delegate -ShowDetails -Start "2022-02-22 18:00" -End "2022-03-22 18:00"</code>
–ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤<br />
<code>Search-AdminAuditLog -StartDate "02/20/2022" | ft CmdLetName,Caller,RunDate,ObjectModified -Autosize</code>
–ø–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π –∏—Å—Ç–æ—Ä–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –≤ –∂—É—Ä–Ω–∞–ª–µ –∞—É–¥–∏—Ç–∞ Exchange</p>
<h3 id="test">Test</h3>
<p><code>Test-ServiceHealth</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ä–æ–ª–µ–π —Å–µ—Ä–≤–µ—Ä–∞:
–ø–æ—á—Ç–æ–≤—ã—Ö —è—â–∏–∫–æ–≤, –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞, –µ–¥–∏–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏,
—Ç—Ä–∞—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞<br />
<code>$mx_srv_list | %{Test-MapiConnectivity -Server $_}</code> –ø—Ä–æ–≤–µ—Ä–∫–∞
–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è MX-—Å–µ—Ä–≤–µ—Ä–æ–≤ –∫ –ë–î<br />
<code>Test-MAPIConnectivity -Database $db</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
–ª–æ–≥–∏–Ω–∞ –≤ –±–∞–∑—É<br />
<code>Test-MAPIConnectivity ‚ÄìIdentity $user@$domain</code> –ø—Ä–æ–≤–µ—Ä–∫–∞
–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ª–æ–≥–∏–Ω–∞ –≤ –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫<br />
<code>Test-ComputerSecureChannel</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–ª—É–∂–±—ã AD<br />
<code>Test-MailFlow</code> —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –ø–æ—á—Ç—ã</p>
<h3 id="queue">Queue</h3>
<p><code>Get-TransportServer | %{Get-Queue -Server $_.Name}</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –æ—á–µ—Ä–µ–¥–∏ –Ω–∞ –≤—Å–µ—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö<br />
<code>Get-Queue -Identity EXCHANGE-CAS\155530 | Format-List</code>
–ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—á–µ—Ä–µ–¥–∏<br />
<code>Get-Queue -Identity EXCHANGE-CAS\155530 | Get-Message -ResultSize Unlimited | Select FromAddress,Recipients</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ–π (FromAddress) –∏ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –≤
–æ—á–µ—Ä–µ–¥–∏ (Recipients)<br />
<code>Get-Message -Queue EXCHANGE-CAS\155530</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å
–∏–Ω–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏ (—Å–µ—Ä–≤–µ—Ä–ø–∏—Å—å–º–∞)<br />
<code>Resume-Message EXCHANGE-CAS\155530\444010</code> –ø–æ–≤—Ç–æ—Ä–∏—Ç—å
–æ—Ç–ø—Ä–∞–≤–∫—É –ø–∏—Å—å–º–∞ –∏–∑ –æ—á–µ—Ä–µ–¥–∏<br />
<code>Retry-Queue -Filter {Status -eq "Retry"}</code> –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ
–ø–æ–≤—Ç–æ—Ä–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π c —Å—Ç–∞—Ç—É—Å–æ–º ‚Äú–ü–æ–≤—Ç–æ—Ä–∏—Ç—å‚Äù<br />
<code>Get-Queue -Identity EXCHANGE-CAS\155530 | Get-Message -ResultSize unlimited | Remove-Message -WithNDR $False</code>
–æ—á–∏—Å—Ç–∏—Ç—å –æ—á–µ—Ä–µ–¥—å<br />
<code>Get-transportserver EXCHANGE-CAS | Select MessageExpirationTimeout</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ—á–µ—Ä–µ–¥–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, 2 –¥–Ω—è)</p>
<p>Error Exchange 452 4.3.1 Insufficient system resources - –æ–∫–æ–Ω—á–∞–Ω–∏–µ
—Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥—è—Ç—Å—è –æ—á–µ—Ä–µ–¥–∏ —Å–ª—É–∂–±—ã Exchange
Hub Transport, –∑–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Ç–≤–µ—á–∞–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ Back
Pressure, –∫–æ—Ç–æ—Ä—ã–π –≤ —Ç–æ–º —á–∏—Å–ª–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ<br />
–ü–æ—Ä–æ–≥ Medium (90%) ‚Äî –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–æ SMTP –ø–æ—á—Ç—É –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö
–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ–π (–ø–æ—á—Ç–∞ –æ—Ç MAPI –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏ —ç—Ç–æ–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è)<br />
–ü–æ—Ä–æ–≥ High (99%) ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–∞ –ø–æ—á—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç—Å—è<br />
–†–µ—à–µ–Ω–∏–µ: –æ—á–∏—Å—Ç–∏—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä –ª–æ–≥–∏ IIS (C:3SVC1), —É–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä –¥–∏—Å–∫–∞,
–æ—Ç–∫–ª—é—á–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Back Pressure (–ø–ª–æ—Ö–æ–π –≤–∞—Ä–∏–∞–Ω—Ç) –∏–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏
—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ –æ—á–µ—Ä–µ–¥—å –Ω–∞ –¥—Ä—É–≥–æ–π –¥–∏—Å–∫ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –æ–±—ä—ë–º–∞.</p>
<p><code>Get-Service | ? name -like "MSExchangeTransport" | Stop-Service</code>
–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂—É –æ—á–µ—Ä–µ–¥–∏<br />
<code>Rename-Item "C:\Program Files\Microsoft\Exchange Server\V15\TransportRoles\data\Queue" "C:\Program Files\Microsoft\Exchange Server\V15\TransportRoles\data\Queue_old"</code>
–æ—á–∏—Å—Ç–∏—Ç—å –±–∞–∑—É –æ—á–µ—Ä–µ–¥–∏<br />
<code>C:\Program Files\Microsoft\Exchange Server\V15\Bin\EdgeTransport.exe.config</code>
–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—É—Ç—å –∫ –±–¥ —Å –æ—á–µ—Ä–µ–¥—å—é (–±–ª–æ–∫
<appSettings> –∫–ª—é—á–∏ <add key="QueueDatabasePath" value="$new_path" /> –∏
QueueDatabaseLoggingPath)<br />
–î–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –ë–î, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
Mail.que –∏ Trn.chk (–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥–∞—Ö)
–∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –≤ –Ω–æ–≤–æ–µ. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã
–∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π Trn.log, Trntmp.log, Trn nnnn.log , Trnres00001.jrs,
Trnres00002.jrs –∏ Temp.edb –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –≤ –Ω–æ–≤–æ–µ. tmp.edb ‚Äî
–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ö–µ–º—ã —Å–∞–º–æ–π –±–∞–∑—ã, –ø–µ—Ä–µ–Ω–æ—Å—Ç–∏ –Ω–µ –Ω—É–∂–Ω–æ.<br />
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–ª—É–∂–±—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –æ—á–µ—Ä–µ–¥–∏ –∏
—Ñ–∞–π–ª—ã –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è.</p>
<h3 id="defrag">Defrag</h3>
<p><code>Get-MailboxDatabase -Status | ft Name, DatabaseSize, AvailableNewMailboxSpace</code><br />
DatabaseSize - —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä –±–∞–∑—ã<br />
AvailableNewMailboxSpace - –æ–±—ä—ë–º –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü, –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ
–º–æ–∂–Ω–æ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –ø—Ä–∏ –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏<br />
(DatabaseSize ‚Äî AvailableNewMailboxSpace) x 1,1 - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏–º–µ—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–µ –º–µ–Ω–µ–µ 110% –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
–±–∞–∑—ã (–±–µ–∑ —É—á–µ—Ç–∞ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü)<br />
<code>cd $path</code><br />
<code>Dismount-Database "$path\$db_name"</code> –æ—Ç–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ë–î<br />
<code>eseutil /d "$path\$db_name.edb"</code><br />
<code>Mount-Database "$path\$db"</code> –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ë–î</p>
<h3 id="dag-database-availability-group">DAG (Database Availability
Group)</h3>
<p><code>Install-WindowsFeature -Name Failover-Clustering -ComputerName EXCH-MX-01</code>
–æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ Windows Server Failover Cluster<br />
<code>New-DatabaseAvailabilityGroup -Name dag-01 -WitnessServer fs-05 -WitnessDirectory C:\witness_exchange1</code>
—Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤–æ–≥–æ —Å–≤–∏–¥–µ—Ç–µ–ª—è –¥–ª—è –∫–≤–æ—Ä—É–º–∞<br />
Quorum - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è, –≤ –∫–æ—Ç–æ—Ä–æ–º –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è –Ω—É–∂–Ω–æ
–∏–º–µ—Ç—å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≥–æ–ª–æ—Å–æ–≤, —á—Ç–æ –±—ã —Å–¥–µ–ª–∞—Ç—å —Ç–µ–∫—É—â—É—é –∫–æ–ø–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–∞–∫—Ç–∏–≤–Ω–æ–π.<br />
WitnessDirectory ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤–æ–≥–æ
—Ä–µ—Å—É—Ä—Å–∞-—Å–≤–∏–¥–µ—Ç–µ–ª—è.<br />
<code>Set-DatabaseAvailabilityGroup dag-01 ‚ÄìDatabaseAvailabilityGroupIPAdress $ip</code>
–∏–∑–º–µ–Ω–∏—Ç—å ip-–∞–¥—Ä–µ—Å –≥—Ä—É–ø–ø—ã<br />
<code>Get-DatabaseAvailabilityGroup</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≥—Ä—É–ø–ø<br />
<code>Get-DatabaseAvailabilityGroup -Identity dag-01</code><br />
<code>Add-DatabaseAvailabilityGroupServer -Identity dag-01 -MailboxServer EXCH-MX-01</code>
–¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π —Å–µ—Ä–≤–µ—Ä (–≤—Å–µ –ë–î –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö –≤ DAG –¥–æ–ª–∂–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –ø–æ
–æ–¥–∏–Ω–∞–∫–æ–≤–æ–º—É –ø—É—Ç–∏)<br />
<code>Add-MailboxDatabaseCopy -Identity db_name -MailboxServer EXCH-MX-04</code>
–¥–æ–±–∞–≤–∏—Ç—å –∫–æ–ø–∏—é –ë–î<br />
<code>Get-MailboxDatabaseCopyStatus -Identity db_name\* | select Name,Status,LastInspectedLogTime</code>
—Å—Ç–∞—Ç—É—Å –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫–∏–π</p>
<p>Status:<br />
Mounted - —Ä–∞–±–æ—á–∞—è –±–∞–∑–∞<br />
Suspended - –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ<br />
Healthy - —Ä–∞–±–æ—á–∞—è –ø–∞—Å—Å–∏–≤–Ω–∞—è –∫–æ–ø–∏—è<br />
ServiceDown - –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ (–≤—ã–∫–ª—é—á–µ–Ω —Å–µ—Ä–≤–µ—Ä)<br />
Dismounted - –æ—Ç–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞<br />
FailedAndSuspended - –æ—à–∏–±–∫–∞ –∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è<br />
Resynchronizing - –ø—Ä–æ—Ü–µ—Å—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –≥–¥–µ –±—É–¥–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
—É–º–µ–Ω—å—à–∞—Ç—å—Å—è –¥–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏<br />
CopyQueue Length - –¥–ª–∏–Ω–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (0 - –∑–Ω–∞—á–∏—Ç
–≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ –∞–∫—Ç–∏–≤–Ω–æ–π –±–∞–∑—ã —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –≤ –ø–∞—Å—Å–∏–≤–Ω—É—é –∫–æ–ø–∏—é)</p>
<p><code>Resume-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04</code>
–≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å (Resume) –∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–¥ –Ω–∞ EXCH-MX-04 (–∏–∑
—Å—Ç–∞—Ç—É—Å–∞ Suspended –≤ Healthy)<br />
<code>Suspend-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04</code>
–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤ —Å—Ç–∞—Ç—É—Å Suspended)<br />
<code>Update-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04 -DeleteExistingFiles</code>
–æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–ø–∏—é –ë–î (—Å–¥–µ–ª–∞—Ç—å Full Backup)<br />
<code>Set-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04 -ActivationPreference 1</code>
–∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫–æ–ø–∏–π –ë–î (–∫–∞–∫—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, 1 ‚Äì —Å–∞–º–æ–µ
–≤—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)<br />
<code>Move-ActiveMailboxDatabase db_name -ActivateOnServer EXCH-MX-04 -MountDialOverride:None -Confirm:$false</code>
–≤–∫–ª—é—á–∏—Ç—å –∫–æ–ø–∏—é –ë–î –≤ DAG (–ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –∞–∫—Ç–∏–≤–Ω—É—é –∫–æ–ø–∏—é)<br />
<code>Remove-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04 -Confirm:$False</code>
—É–¥–∞–ª–∏—Ç—å –∫–æ–ø–∏–∏ –ø–∞—Å—Å–∏–≤–Ω–æ–π –±–∞–∑—ã –≤ DAG-–≥—Ä—É–ø–ø–µ (—É –ë–î –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–æ
–≤–µ–¥–µ–Ω–∏–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–≥–æ –∂—É—Ä–Ω–∞–ª–∞)<br />
<code>Remove-DatabaseAvailabilityGroupServer -Identity dag-01 -MailboxServer EXCH-MX-04 -ConfigurationOnly</code>
—É–¥–∞–ª–∏—Ç—å MX —Å–µ—Ä–≤–µ—Ä –∏–∑ –≥—Ä—É–ø–ø—ã DAG<br />
<code>Import-Module FailoverClusters</code><br />
<code>Get-ClusterNode EXCH-MX-04 | Remove-ClusterNode -Force</code>
—É–¥–∞–ª–∏—Ç—å –æ—Ç–∫–∞–∑–∞–≤—à–∏–π —É–∑–µ–ª –∏–∑ Windows Failover Cluster</p>
<p><code>Get-DatabaseAvailabilityGroup | Get-DatabaseAvailabilityGroupHealth</code>
–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</p>
<h3 id="index-1">Index</h3>
<p><code>Get-MailboxDatabaseCopyStatus * | select name,status,ContentIndexState,ContentIndexErrorMessage,ActiveDatabaseCopy,LatestCopyBackupTime,CopyQueueLength</code>
—É–∑–Ω–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –∏–Ω–¥–∫—Å–æ–≤ –ë–î –∏ —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏, –Ω–∞ –∫–∞–∫–æ–º —Å–µ—Ä–≤–µ—Ä–µ
–∞–∫—Ç–∏–≤–Ω–∞—è –∫–æ–ø–∏—è –ë–î, –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–ø–∏–∏ –∏ —Ç–µ–∫—É—â–∞—è –æ—á–µ—Ä–µ–¥—å<br />
<code>Get-MailboxDatabaseCopyStatus -Identity $db_name\* | Format-List Name,ContentIndexState</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–ø–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ë–î –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö, –∏ —Å—Ç–∞—Ç—É—Å –∏—Ö
–∏–Ω–¥–µ–∫—Å–æ–≤, –µ—Å–ª–∏ —É –≤—Ç–æ—Ä–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Å—Ç–∞—Ç—É—Å Healthy, –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑
–Ω–µ–≥–æ<br />
<code>Get-MailboxDatabaseCopyStatus -Identity $db_name\EXCH-MX-04 | Update-MailboxDatabaseCopy -SourceServer EXCH-MX-01 -CatalogOnly</code>
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ë–î –∏–∑ –∫–æ–ø–∏–∏<br />
<code>cd %PROGRAMFILES%\Microsoft\Exchange Server\V14\Scripts</code> –∏–ª–∏
v15 –¥–ª—è Exchange 2016<br />
<code>.\ResetSearchIndex.ps1 $db_name</code> —Å–∫—Ä–∏–ø—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
–∏–Ω–¥–µ–∫—Å–∞</p>
<p><code>Get-MailboxDatabaseCopyStatus * | where {$_.ContentIndexState -eq "Failed" -or $_.ContentIndexState -eq "FailedAndSuspended"}</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —É –∫–∞–∫–æ–π –ë–î –ø—Ä–æ–∏–∑–æ—à–µ–ª —Å–±–æ–π —Ä–∞–±–æ—Ç—ã (FailedAndSuspended) –∏–ª–∏
–∏–Ω–¥–µ–∫—Å–∞ (ContentIndexState)</p>
<h1 id="truenas">TrueNAS</h1>
<p><code>import-Module TrueNas</code><br />
<code>(Get-Module TrueNas).ExportedCommands</code><br />
<code>Connect-TrueNasServer -Server tnas-01 -SkipCertificateCheck</code><br />
<code>Get-TrueNasCertificate</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞<br />
<code>Get-TrueNasSetting</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —è–∑—ã–∫–∞, time zone, syslog level
–∏ server, https port<br />
<code>Get-TrueNasUser</code> —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π<br />
<code>Get-TrueNasSystemVersion</code> —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (Physical Memory,
Model, Cores) –∏ Uptime<br />
<code>Get-TrueNasSystemAlert</code> snmp –¥–ª—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–π<br />
<code>Get-TrueNasSystemNTP</code> —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö NTP —Å–µ—Ä–≤–µ—Ä–æ–≤<br />
<code>Get-TrueNasDisk</code> —Å–ø–∏—Å–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –¥–∏—Å–∫–∞<br />
<code>Get-TrueNasInterface</code> —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã<br />
<code>Get-TrueNasGlobalConfig</code> —Å–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏<br />
<code>Get-TrueNasDnsServer</code> –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ DNS-—Å–µ—Ä–≤–µ—Ä–∞<br />
<code>Get-TrueNasIscsiTarget</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å ID –≥—Ä—É–ø–ø—ã –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–æ–≤
–∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö —Ç–∞—Ä–≥–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π portal, authentification –∏
authen-method<br />
<code>Get-TrueNasIscsiInitiator</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≥—Ä—É–ø–ø—ã
–∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–æ–≤<br />
<code>Get-TrueNasIscsiPortal</code> —Å–ª—É—à–∞—Ç–µ–ª—å (Listen) –∏ –ø–æ—Ä—Ç<br />
<code>Get-TrueNasIscsiExtent</code> —Å–ø–∏—Å–æ–∫ ISCSi Target (—Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã,
–ø—É—Ç—å)<br />
<code>Get-TrueNasPool</code> —Å–ø–∏—Å–æ–∫ pool (Id, Path, Status,
Healthy)<br />
<code>Get-TrueNasVolume -Type FILESYSTEM</code> —Å–ø–∏—Å–æ–∫ pool —Ñ–∞–π–ª–æ–≤—ã—Ö
—Å–∏—Å—Ç–µ–º<br />
<code>Get-TrueNasVolume -Type VOLUME</code> —Å–ø–∏—Å–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ –≤ pool –∏ –∏—Ö
—Ä–∞–∑–º–µ—Ä<br />
<code>Get-TrueNasService | ft</code> —Å–ø–∏—Å–æ–∫ —Å–ª—É–∂–± –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å<br />
<code>Start-TrueNasService ssh</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É<br />
<code>Stop-TrueNasService ssh</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂–±—É</p>
<h1 id="veeam">Veeam</h1>
<p><code>Set-ExecutionPolicy AllSigned</code> or Set-ExecutionPolicy
Bypass -Scope Process<br />
<code>Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))</code><br />
<code>choco install veeam-backup-and-replication-console</code><br />
<code>Get-Module Veeam.Backup.PowerShell</code><br />
<code>Get-Command -Module Veeam.Backup.PowerShell</code> or
Get-VBRCommand<br />
<code>Connect-VBRServer -Server $srv -Credential $cred</code> or -User
and -Password<code>- Port 9392</code> default<br />
<code>Get-VBRJob</code><br />
<code>Get-VBRCommand *get*backup*</code><br />
<code>Get-VBRComputerBackupJob</code><br />
<code>Get-VBRBackup</code><br />
<code>Get-VBRBackupRepository</code><br />
<code>Get-VBRBackupSession</code><br />
<code>Get-VBRBackupServerCertificate</code><br />
<code>Get-VBRRestorePoint</code><br />
<code>Get-VBRViProxy</code></p>
<h1 id="rest-api">REST API</h1>
<p><code>$url = "https://habr.com/ru/rss/users/Lifailon/publications/articles/?fl=ru"</code>
RSS –ª–µ–Ω—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–π –Ω–∞ Habr<br />
<code>Invoke-RestMethod $url</code><br />
<code>$iwr = Invoke-WebRequest -Uri $url</code><br />
<code>$iwr | Get-Member</code><br />
<code>$iwr.Content</code><br />
<code>$iwr.StatusCode -eq 200</code><br />
<code>$iwr.Headers</code><br />
<code>$iwr.ParsedHtml | Select lastModified</code><br />
<code>$iwr.Links | fl title,innerText,href</code><br />
<code>$iwr.Images.src</code></p>
<h3 id="methods">Methods</h3>
<p><strong>GET</strong> - Read<br />
<strong>POST</strong> - Create<br />
<strong>PATCH</strong> - Partial update/modify<br />
<strong>PUT</strong> - Update/replace<br />
<strong>DELETE</strong> - Remove</p>
<h3 id="download-image">Download Image</h3>
<div class="sourceCode" id="cb44"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Download-Image <span class="op">{</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="kw">param</span> <span class="op">(</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>Parameter<span class="op">(</span>Mandatory <span class="op">=</span> <span class="va">$True</span><span class="op">)]</span><span class="va">$url</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">$folder</span> <span class="op">=</span> <span class="va">$url</span> <span class="op">-replace</span> <span class="st">&quot;http.+://&quot;</span> <span class="op">-replace</span> <span class="st">&quot;/&quot;</span><span class="op">,</span><span class="st">&quot;-&quot;</span> <span class="op">-replace</span> <span class="st">&quot;-$&quot;</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">$path</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Pictures\</span><span class="va">$folder</span><span class="st">&quot;</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="fu">Test-Path</span> <span class="va">$path</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Remove-Item</span> <span class="va">$path</span> <span class="op">-</span>Recurse <span class="op">-</span>Force</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">New-Item</span> <span class="op">-</span>ItemType Directory <span class="va">$path</span> <span class="op">&gt;</span> <span class="va">$null</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">New-Item</span> <span class="op">-</span>ItemType Directory <span class="va">$path</span> <span class="op">&gt;</span> <span class="va">$null</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="va">$irm</span> <span class="op">=</span> <span class="fu">Invoke-WebRequest</span> <span class="op">-</span>Uri <span class="va">$url</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">foreach</span> <span class="op">(</span><span class="va">$img</span> <span class="kw">in</span> <span class="va">$irm</span><span class="op">.</span><span class="fu">Images</span><span class="op">.</span><span class="fu">src</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">$name</span> <span class="op">=</span> <span class="va">$img</span> <span class="op">-replace</span> <span class="st">&quot;.+/&quot;</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Start-Job</span> <span class="op">{</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">Invoke-WebRequest</span> <span class="va">$using</span><span class="op">:</span><span class="va">img</span> <span class="op">-</span>OutFile <span class="st">&quot;</span><span class="va">$using</span><span class="op">:</span><span class="va">path</span><span class="st">\</span><span class="va">$using</span><span class="op">:</span><span class="va">name</span><span class="st">&quot;</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="op">&gt;</span> <span class="va">$null</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="va">$True</span><span class="op">){</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">$status_job</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Job</span><span class="op">).</span><span class="fu">State</span><span class="op">[</span>-1<span class="op">]</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="va">$status_job</span> <span class="op">-like</span> <span class="st">&quot;Completed&quot;</span><span class="op">){</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Get-Job</span> <span class="op">|</span> <span class="fu">Remove-Job</span> <span class="op">-</span>Force</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}}</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    <span class="va">$count_all</span> <span class="op">=</span> <span class="va">$irm</span><span class="op">.</span><span class="fu">Images</span><span class="op">.</span><span class="fu">src</span><span class="op">.</span><span class="fu">Count</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    <span class="va">$count_down</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Item</span> <span class="va">$path</span>\<span class="op">*).</span><span class="fu">count</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Downloaded </span><span class="va">$count_down</span><span class="st"> of </span><span class="va">$count_all</span><span class="st"> files to </span><span class="va">$path</span><span class="st">&quot;</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Download-Image -url https://losst.pro/</code></p>
<h3 id="token">Token</h3>
<div class="sourceCode" id="cb45"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>https<span class="op">://</span>veeam-11<span class="op">:</span><span class="dv">9419</span><span class="op">/</span>swagger<span class="op">/</span>ui<span class="op">/</span>index<span class="op">.</span><span class="fu">html</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Header</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;x-api-version&quot;</span> <span class="op">=</span> <span class="st">&quot;1.0-rev2&quot;</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="va">$Body</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;grant_type&quot;</span> <span class="op">=</span> <span class="st">&quot;password&quot;</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;username&quot;</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$login</span><span class="st">&quot;</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;password&quot;</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$password</span><span class="st">&quot;</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="va">$vpost</span> <span class="op">=</span> <span class="fu">iwr</span> <span class="st">&quot;https://veeam-11:9419/api/oauth2/token&quot;</span> <span class="op">-</span>Method POST <span class="op">-</span>Headers <span class="va">$Header</span> <span class="op">-</span>Body <span class="va">$Body</span> <span class="op">-</span>SkipCertificateCheck</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="va">$vtoken</span> <span class="op">=</span> <span class="op">((</span><span class="va">$vpost</span><span class="op">.</span><span class="fu">Content</span><span class="op">)</span> <span class="op">-split</span> <span class="st">&#39;&quot;&#39;</span><span class="op">)[</span><span class="dv">3</span><span class="op">]</span></span></code></pre></div>
<h3 id="get">GET</h3>
<div class="sourceCode" id="cb46"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="va">$token</span> <span class="op">=</span> <span class="va">$vtoken</span> <span class="op">|</span> <span class="fu">ConvertTo-SecureString</span> <span class="op">-</span>AsPlainText ‚ÄìForce</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="va">$vjob</span> <span class="op">=</span> <span class="fu">iwr</span> <span class="st">&quot;https://veeam-11:9419/api/v1/jobs&quot;</span> <span class="op">-</span>Method GET <span class="op">-</span>Headers <span class="va">$Header</span> <span class="op">-</span>Authentication Bearer <span class="op">-</span>Token <span class="va">$token</span> <span class="op">-</span>SkipCertificateCheck</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="va">$Header</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;x-api-version&quot;</span> <span class="op">=</span> <span class="st">&quot;1.0-rev1&quot;</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Authorization&quot;</span> <span class="op">=</span> <span class="st">&quot;Bearer </span><span class="va">$vtoken</span><span class="st">&quot;</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="va">$vjob</span> <span class="op">=</span> <span class="fu">iwr</span> <span class="st">&quot;https://veeam-11:9419/api/v1/jobs&quot;</span> <span class="op">-</span>Method GET <span class="op">-</span>Headers <span class="va">$Header</span> <span class="op">-</span>SkipCertificateCheck</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="va">$vjob</span> <span class="op">=</span> <span class="va">$vjob</span><span class="op">.</span><span class="fu">Content</span> <span class="op">|</span> <span class="fu">ConvertFrom-Json</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="va">$vjob</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="st">&quot;https://veeam-11:9419/api/v1/jobs&quot;</span> <span class="op">-</span>Method GET <span class="op">-</span>Headers <span class="va">$Header</span> <span class="op">-</span>SkipCertificateCheck</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="va">$vjob</span><span class="op">.</span><span class="fu">data</span><span class="op">.</span><span class="fu">virtualMachines</span><span class="op">.</span><span class="fu">includes</span><span class="op">.</span><span class="fu">inventoryObject</span></span></code></pre></div>
<h1 id="pode">Pode</h1>
<div class="sourceCode" id="cb47"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Start-PodeServer <span class="op">{</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    Add-PodeEndpoint <span class="op">-</span>Address localhost <span class="op">-</span>Port <span class="st">&quot;8080&quot;</span> <span class="op">-</span>Protocol <span class="st">&quot;HTTP&quot;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">### Get info endpoints</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    Add-PodeRoute <span class="op">-</span>Path <span class="st">&quot;/&quot;</span> <span class="op">-</span>Method <span class="st">&quot;GET&quot;</span> <span class="op">-</span>ScriptBlock <span class="op">{</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>        Write-PodeJsonResponse <span class="op">-</span>Value @<span class="op">{</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;service&quot;</span><span class="op">=</span><span class="st">&quot;/api/service&quot;</span><span class="op">;</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;process&quot;</span><span class="op">=</span><span class="st">&quot;/api/process&quot;</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">### GET</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    Add-PodeRoute <span class="op">-</span>Path <span class="st">&quot;/api/service&quot;</span> <span class="op">-</span>Method <span class="st">&quot;GET&quot;</span> <span class="op">-</span>ScriptBlock <span class="op">{</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        Write-PodeJsonResponse <span class="op">-</span>Value <span class="op">$(</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">Get-Service</span> <span class="op">|</span> <span class="fu">Select-Object</span> Name<span class="op">,</span>@<span class="op">{</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>                Name<span class="op">=</span><span class="st">&quot;Status&quot;</span><span class="op">;</span> Expression<span class="op">={[</span><span class="dt">string</span><span class="op">]</span><span class="va">$_</span><span class="op">.</span><span class="fu">Status</span><span class="op">}</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">},</span>@<span class="op">{</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>                Name<span class="op">=</span><span class="st">&quot;StartType&quot;</span><span class="op">;</span> Expression<span class="op">={[</span><span class="dt">string</span><span class="op">]</span><span class="va">$_</span><span class="op">.</span><span class="fu">StartType</span><span class="op">}</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">)</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    Add-PodeRoute <span class="op">-</span>Path <span class="st">&quot;/api/process&quot;</span> <span class="op">-</span>Method <span class="st">&quot;GET&quot;</span> <span class="op">-</span>ScriptBlock <span class="op">{</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>        Write-PodeJsonResponse <span class="op">-</span>Value <span class="op">$(</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">Get-Process</span> <span class="op">|</span> <span class="fu">Sort-Object</span> <span class="op">-</span>Descending CPU <span class="op">|</span> <span class="fu">Select-Object</span> <span class="op">-</span>First <span class="dv">15</span> ProcessName<span class="op">,</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>            @<span class="op">{</span>Name<span class="op">=</span><span class="st">&quot;ProcessorTime&quot;</span><span class="op">;</span> Expression<span class="op">={</span><span class="va">$_</span><span class="op">.</span><span class="fu">TotalProcessorTime</span> <span class="op">-replace</span> <span class="st">&quot;\.\d+$&quot;</span><span class="op">}},</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>            @<span class="op">{</span>Name<span class="op">=</span><span class="st">&quot;Memory&quot;</span><span class="op">;</span> Expression<span class="op">={[</span><span class="dt">string</span><span class="op">]([</span><span class="dt">int</span><span class="op">](</span><span class="va">$_</span><span class="op">.</span><span class="fu">WS</span> <span class="op">/</span> <span class="dv">1024</span><span class="dt">kb</span><span class="op">))+</span><span class="st">&quot;MB&quot;</span><span class="op">}},</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>            @<span class="op">{</span>Label<span class="op">=</span><span class="st">&quot;RunTime&quot;</span><span class="op">;</span> Expression<span class="op">={((</span><span class="fu">Get-Date</span><span class="op">)</span> <span class="op">-</span> <span class="va">$_</span><span class="op">.</span><span class="fu">StartTime</span><span class="op">)</span> <span class="op">-replace</span> <span class="st">&quot;\.\d+$&quot;</span><span class="op">}}</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">)</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>    Add-PodeRoute <span class="op">-</span>Path <span class="st">&quot;/api/process-html&quot;</span> <span class="op">-</span>Method <span class="st">&quot;GET&quot;</span> <span class="op">-</span>ScriptBlock <span class="op">{</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>        Write-PodeHtmlResponse <span class="op">-</span>Value <span class="op">(</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">Get-Process</span> <span class="op">|</span> <span class="fu">Sort-Object</span> <span class="op">-</span>Descending CPU <span class="op">|</span> <span class="fu">Select-Object</span> <span class="op">-</span>First <span class="dv">15</span> ProcessName<span class="op">,</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>            @<span class="op">{</span>Name<span class="op">=</span><span class="st">&quot;ProcessorTime&quot;</span><span class="op">;</span> Expression<span class="op">={</span><span class="va">$_</span><span class="op">.</span><span class="fu">TotalProcessorTime</span> <span class="op">-replace</span> <span class="st">&quot;\.\d+$&quot;</span><span class="op">}},</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>            @<span class="op">{</span>Name<span class="op">=</span><span class="st">&quot;Memory&quot;</span><span class="op">;</span> Expression<span class="op">={[</span><span class="dt">string</span><span class="op">]([</span><span class="dt">int</span><span class="op">](</span><span class="va">$_</span><span class="op">.</span><span class="fu">WS</span> <span class="op">/</span> <span class="dv">1024</span><span class="dt">kb</span><span class="op">))+</span><span class="st">&quot;MB&quot;</span><span class="op">}},</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>            @<span class="op">{</span>Label<span class="op">=</span><span class="st">&quot;RunTime&quot;</span><span class="op">;</span> Expression<span class="op">={((</span><span class="fu">Get-Date</span><span class="op">)</span> <span class="op">-</span> <span class="va">$_</span><span class="op">.</span><span class="fu">StartTime</span><span class="op">)</span> <span class="op">-replace</span> <span class="st">&quot;\.\d+$&quot;</span><span class="op">}}</span> <span class="co"># Auto ConvertTo-Html</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">)</span></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">### POST</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>    Add-PodeRoute <span class="op">-</span>Path <span class="st">&quot;/api/service&quot;</span> <span class="op">-</span>Method <span class="st">&quot;POST&quot;</span> <span class="op">-</span>ScriptBlock <span class="op">{</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># https://pode.readthedocs.io/en/latest/Tutorials/WebEvent/</span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># $WebEvent | Out-Default</span></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Value</span> <span class="op">=</span> <span class="va">$WebEvent</span><span class="op">.</span><span class="fu">Data</span><span class="op">[</span><span class="st">&quot;ServiceName&quot;</span><span class="op">]</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Status</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Service</span> <span class="op">-</span>Name <span class="va">$Value</span><span class="op">).</span><span class="fu">Status</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>        Write-PodeJsonResponse <span class="op">-</span>Value @<span class="op">{</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Name&quot;</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$Value</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Status&quot;</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$Status</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>irm http://localhost:8080/api/service -Method Get</code><br />
<code>irm http://localhost:8080/api/process -Method Get</code><br />
<code>http://localhost:8080/api/process-html</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
–±—Ä–∞—É–∑–µ—Ä<br />
<code>irm http://localhost:8080/api/service -Method Post -Body @{"ServiceName" = "AnyDesk"}</code></p>
<h1 id="selenium">Selenium</h1>
<p><code>Invoke-Expression(New-Object Net.WebClient).DownloadString("https://raw.githubusercontent.com/Lifailon/Deploy-Selenium/rsa/Deploy-Selenium-Drivers.ps1")</code>
—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏ Chromium —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –≤–µ—Ä—Å–∏–∏ –¥–ª—è
–¥—Ä–∞–π–≤–µ—Ä–∞</p>
<pre><code>$path = &quot;$home\Documents\Selenium\&quot;
$log = &quot;$path\ChromeDriver.log&quot;
$ChromeDriver = &quot;$path\ChromeDriver.exe&quot;
$WebDriver = &quot;$path\WebDriver.dll&quot;
$SupportDriver = &quot;$path\WebDriver.Support.dll&quot;
$Chromium = (Get-ChildItem $path -Recurse | Where-Object Name -like chrome.exe).FullName
Add-Type -Path $WebDriver
Add-Type -Path $SupportDriver
try {
    $ChromeOptions = New-Object OpenQA.Selenium.Chrome.ChromeOptions # —Å–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∑–∞–ø—É—Å–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞
    $ChromeOptions.BinaryLocation = $Chromium # –ø–µ—Ä–µ–¥–∞–µ–º –ø—É—Ç—å –¥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–ø—É—Å–∫ –±—Ä–∞—É–∑–µ—Ä–∞
    $ChromeOptions.AddArgument(&quot;start-maximized&quot;) # –¥–æ–±–∞–≤–ª—è–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
    #$ChromeOptions.AddArgument(&quot;start-minimized&quot;) # –∑–∞–ø—É—Å–∫–∞–µ–º –±—Ä–∞—É–∑–µ—Ä –≤ –æ–∫–Ω–µ
    #$ChromeOptions.AddArgument(&quot;window-size=400,800&quot;) # –∑–∞–ø—É—Å–∫–∞–µ–º –±—Ä–∞—É–∑–µ—Ä —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º –æ–∫–Ω–∞ –≤ –ø–∏–∫—Å–µ–ª—è—Ö
    $ChromeOptions.AcceptInsecureCertificates = $True # –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –Ω–∞ —Å–∞–π—Ç–∞—Ö —Å –Ω–µ –≤–∞–ª–∏–¥–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º
    #$ChromeOptions.AddArgument(&quot;headless&quot;) # —Å–∫—Ä—ã–≤–∞—Ç—å –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
    $ChromeDriverService = [OpenQA.Selenium.Chrome.ChromeDriverService]::CreateDefaultService($ChromeDriver) # —Å–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–ª—É–∂–±—ã –¥—Ä–∞–π–≤–µ—Ä–∞
    $ChromeDriverService.HideCommandPromptWindow = $True # –æ—Ç–∫–ª—é—á–∞–µ–º –≤–µ—Å—å –≤—ã–≤–æ–¥ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞ –≤ –∫–æ–Ω—Å–æ–ª—å (—ç—Ç–æ—Ç –≤—ã–≤–æ–¥ –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å)
    $ChromeDriverService.LogPath = $log # —É–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞ —Å –∂—É—Ä–Ω–∞–ª–æ–º
    $ChromeDriverService.EnableAppendLog = $True # –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –∂—É—Ä–Ω–∞–ª –ø—Ä–∏ –∫–∞–∂–¥–æ–º –Ω–æ–≤–æ–º –∑–∞–ø—É—Å–∫–µ
    #$ChromeDriverService.EnableVerboseLogging = $True # –∫—Ä–æ–º–µ INFO –∏ –æ—à–∏–±–æ–∫, –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å DEBUG —Å–æ–æ–±—â–µ–Ω–∏—è
    $Selenium = New-Object OpenQA.Selenium.Chrome.ChromeDriver($ChromeDriverService, $ChromeOptions) # –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–∞–ø—É—Å–∫ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

    $Selenium.Navigate().GoToUrl(&quot;https://google.com&quot;) # –ø–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Å—Å—ã–ª–∫–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
    #$Selenium.Manage().Window.Minimize() # —Å–≤–µ—Ä–Ω—É—Ç—å –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ –Ω—É–∂–Ω–æ–º—É url (—á—Ç–æ –±—ã —Å—á–∏—Ç–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
    # –ò—â–µ–º –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞:
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::Id(&#39;APjFqb&#39;))
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::XPath(&#39;//*[@id=&quot;APjFqb&quot;]&#39;))
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::Name(&#39;q&#39;))
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::XPath(&#39;//*[@name=&quot;q&quot;]&#39;))
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::ClassName(&#39;gLFyf&#39;))
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::CssSelector(&#39;[jsname=&quot;yZiJbe&quot;]&#39;))
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::TagName(&#39;textarea&#39;)) | Where-Object ComputedAccessibleRole -eq combobox
    $Search.SendKeys(&quot;calculator online&quot;) # –ø–µ—Ä–µ–¥–∞–µ–º —Ç–µ–∫—Å—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É
    $Search.SendKeys([OpenQA.Selenium.Keys]::Enter) # –Ω–∞–∂–∏–º–∞–µ–º Enter –¥–ª—è –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∏—Å–∫–∞

    Start-Sleep 1
    $div = $Selenium.FindElements([OpenQA.Selenium.By]::TagName(&quot;div&quot;))
    $2 = $div | Where-Object {($_.ComputedAccessibleRole -eq &quot;button&quot;) -and ($_.ComputedAccessibleLabel -eq &quot;2&quot;)}
    $2.Click()
    $2.Click()
    $plus = $div | Where-Object {($_.ComputedAccessibleRole -eq &quot;button&quot;) -and ($_.Text -eq &quot;+&quot;)}
    $plus.Click()
    $3 = $Selenium.FindElement([OpenQA.Selenium.By]::CssSelector(&#39;[jsname=&quot;KN1kY&quot;]&#39;))
    $3.Click()
    $3.Click()
    $sum = $Selenium.FindElement([OpenQA.Selenium.By]::CssSelector(&#39;[jsname=&quot;Pt8tGc&quot;]&#39;))
    $sum.Click()
    $result = $Selenium.FindElement([OpenQA.Selenium.By]::CssSelector(&#39;[jsname=&quot;VssY5c&quot;]&#39;)).Text
    Write-Host &quot;Result: $result&quot; -ForegroundColor Green
}
finally {
    $Selenium.Close()
    $Selenium.Quit()
}</code></pre>
<h3 id="selenium-modules">Selenium modules</h3>
<div class="sourceCode" id="cb49"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Invoke-RestMethod</span> https<span class="op">://</span>raw<span class="op">.</span><span class="fu">githubusercontent</span><span class="op">.</span><span class="fu">com</span><span class="op">/</span>Lifailon<span class="op">/</span>Selenium-Modules<span class="op">/</span>rsa<span class="op">/</span>Modules<span class="op">/</span>Get-GPT<span class="op">/</span>Get-GPT<span class="op">.</span><span class="fu">psm1</span> <span class="op">|</span> <span class="fu">Out-File</span> <span class="op">-</span>FilePath <span class="st">&quot;</span><span class="op">$(</span><span class="fu">New-Item</span> <span class="op">-</span>Path <span class="st">&quot;</span><span class="op">$($(</span><span class="va">$Env</span><span class="op">:</span><span class="va">PSModulePath</span> <span class="op">-split</span> <span class="st">&quot;;&quot;</span><span class="op">)[</span><span class="dv">0</span><span class="op">])</span><span class="st">\Get-GPT&quot;</span> <span class="op">-</span>ItemType Directory <span class="op">-</span>Force<span class="op">)</span><span class="st">\Get-GPT.psm1&quot;</span> <span class="op">-</span>Force</span></code></pre></div>
<p><code>Get-GPT "–ò—Å–ø–æ–ª–Ω—è–π —Ä–æ–ª—å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞. –ü–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É —á–∏—Å–µ–ª: 22+33"</code></p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Invoke-RestMethod</span> https<span class="op">://</span>raw<span class="op">.</span><span class="fu">githubusercontent</span><span class="op">.</span><span class="fu">com</span><span class="op">/</span>Lifailon<span class="op">/</span>Selenium-Modules<span class="op">/</span>rsa<span class="op">/</span>Modules<span class="op">/</span>Get-Translation<span class="op">/</span>Get-Translation<span class="op">.</span><span class="fu">psm1</span> <span class="op">|</span> <span class="fu">Out-File</span> <span class="op">-</span>FilePath <span class="st">&quot;</span><span class="op">$(</span><span class="fu">New-Item</span> <span class="op">-</span>Path <span class="st">&quot;</span><span class="op">$($(</span><span class="va">$Env</span><span class="op">:</span><span class="va">PSModulePath</span> <span class="op">-split</span> <span class="st">&quot;;&quot;</span><span class="op">)[</span><span class="dv">0</span><span class="op">])</span><span class="st">\Get-Translation&quot;</span> <span class="op">-</span>ItemType Directory <span class="op">-</span>Force<span class="op">)</span><span class="st">\Get-Translation.psm1&quot;</span> <span class="op">-</span>Force</span></code></pre></div>
<p><code>Get-Translation -Provider DeepL -Text "I translating the text"</code><br />
<code>Get-Translation -Provider DeepL -Text "–Ø –ø–µ—Ä–µ–≤–æ–∂—É —Ç–µ–∫—Å—Ç"</code><br />
<code>Get-Translation -Provider Google -Text "I translating the text"</code><br />
<code>Get-Translation -Provider Google -Text "–Ø –ø–µ—Ä–µ–≤–æ–∂—É —Ç–µ–∫—Å—Ç" -Language en</code></p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Invoke-RestMethod</span> https<span class="op">://</span>raw<span class="op">.</span><span class="fu">githubusercontent</span><span class="op">.</span><span class="fu">com</span><span class="op">/</span>Lifailon<span class="op">/</span>Selenium-Modules<span class="op">/</span>rsa<span class="op">/</span>Modules<span class="op">/</span>Get-SpeedTest<span class="op">/</span>Get-SpeedTest<span class="op">.</span><span class="fu">psm1</span> <span class="op">|</span> <span class="fu">Out-File</span> <span class="op">-</span>FilePath <span class="st">&quot;</span><span class="op">$(</span><span class="fu">New-Item</span> <span class="op">-</span>Path <span class="st">&quot;</span><span class="op">$($(</span><span class="va">$Env</span><span class="op">:</span><span class="va">PSModulePath</span> <span class="op">-split</span> <span class="st">&quot;;&quot;</span><span class="op">)[</span><span class="dv">0</span><span class="op">])</span><span class="st">\Get-SpeedTest&quot;</span> <span class="op">-</span>ItemType Directory <span class="op">-</span>Force<span class="op">)</span><span class="st">\Get-SpeedTest.psm1&quot;</span> <span class="op">-</span>Force</span></code></pre></div>
<p><code>Get-SpeedTest -Provider Libre</code><br />
<code>Get-SpeedTest -Provider Open</code><br />
<code>Get-SpeedTest -Provider Ookla</code></p>
<h1 id="ie">IE</h1>
<p><code>$ie.document.IHTMLDocument3_getElementsByTagName("input")  | select name</code>
–ø–æ–ª—É—á–∏—Ç—å –∏–º–µ–Ω–∞ –≤—Å–µ—Ö Input Box<br />
<code>$ie.document.IHTMLDocument3_getElementsByTagName("button") | select innerText</code>
–ø–æ–ª—É—á–∏—Ç—å –∏–º–µ–Ω–∞ –≤—Å–µ—Ö Button<br />
<code>$ie.Document.documentElement.innerHTML</code> –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å—ã—Ä–æ–π Web
Content (&lt;input name=‚Äúlogin‚Äù tabindex=‚Äú100‚Äù class=‚Äúinput__control
input__input‚Äù id=‚Äúuniq32005644019429136‚Äù spellcheck=‚Äúfalse‚Äù
placeholder=‚Äú–õ–æ–≥–∏–Ω‚Äù)<br />
<code>$All_Elements = $ie.document.IHTMLDocument3_getElementsByTagName("*")</code>
–∑–∞–±—Ä–∞—Ç—å –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã<br />
<code>$Go_Button = $All_Elements | ? innerText -like "go"</code> –ø–æ–∏—Å–∫
—ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ –∏–º–µ–Ω–∏<br />
<code>$Go_Button | select ie9_tagName</code> –ø–æ–ª—É—á–∏—Ç—å TagName (SPAN) –¥–ª—è
–±—ã—Å—Ç—Ä–æ–≥–æ –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –ø–æ–∏—Å–∫–∞<br />
<code>$SPAN_Elements = $ie.document.IHTMLDocument3_getElementsByTagName("SPAN")</code></p>
<div class="sourceCode" id="cb52"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="va">$ie</span> <span class="op">=</span> <span class="fu">New-Object</span> <span class="op">-</span>ComObject InternetExplorer<span class="op">.</span><span class="fu">Application</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="va">$ie</span><span class="op">.</span><span class="fu">navigate</span><span class="op">(</span><span class="st">&quot;https://yandex.ru&quot;</span><span class="op">)</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="va">$ie</span><span class="op">.</span><span class="fu">visible</span> <span class="op">=</span> <span class="va">$true</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="va">$ie</span><span class="op">.</span><span class="fu">document</span><span class="op">.</span><span class="fu">IHTMLDocument3_getElementByID</span><span class="op">(</span><span class="st">&quot;login&quot;</span><span class="op">).</span><span class="fu">value</span> <span class="op">=</span> <span class="st">&quot;Login&quot;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="va">$ie</span><span class="op">.</span><span class="fu">document</span><span class="op">.</span><span class="fu">IHTMLDocument3_getElementByID</span><span class="op">(</span><span class="st">&quot;passwd&quot;</span><span class="op">).</span><span class="fu">value</span> <span class="op">=</span> <span class="st">&quot;Password&quot;</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="va">$Button_Auth</span> <span class="op">=</span> <span class="op">(</span><span class="va">$ie</span><span class="op">.</span><span class="fu">document</span><span class="op">.</span><span class="fu">IHTMLDocument3_getElementsByTagName</span><span class="op">(</span><span class="st">&quot;button&quot;</span><span class="op">))</span> <span class="op">|</span> <span class="op">?</span> innerText <span class="op">-match</span> <span class="st">&quot;–í–æ–π—Ç–∏&quot;</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="va">$Button_Auth</span><span class="op">.</span><span class="fu">Click</span><span class="op">()</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="va">$Result</span> <span class="op">=</span> <span class="va">$ie</span><span class="op">.</span><span class="fu">Document</span><span class="op">.</span><span class="fu">documentElement</span><span class="op">.</span><span class="fu">innerHTML</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="va">$ie</span><span class="op">.</span><span class="fu">Quit</span><span class="op">()</span></span></code></pre></div>
<h1 id="com">COM</h1>
<p><code>$wshell = New-Object -ComObject Wscript.Shell</code><br />
<code>$wshell | Get-Member</code><br />
<code>$link = $wshell.CreateShortcut("$Home\Desktop\Yandex.lnk")</code>
—Å–æ–∑–¥–∞—Ç—å —è—Ä–ª—ã–∫<br />
<code>$link | Get-Member</code><br />
<code>$link.TargetPath = "https://yandex.ru"</code> –∫—É–¥–∞ —Å—Å—ã–ª–∞–µ—Ç—Å—è
(–º–µ—Ç–æ–¥ TargetPath –æ–±—ä–µ–∫—Ç–∞ <span class="math inline">$link –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è
–æ–±—ä–µ–∫—Ç CreateShortcut) \
`$</span>link.Save()` —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å</p>
<p><code>Set-WinUserLanguageList -LanguageList en-us,ru -Force</code>
–∏–∑–º–µ–Ω–∏—Ç—å —è–∑—ã–∫–æ–≤—É—é —Ä–∞—Å–∫–ª–∞–¥–∫—É –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã</p>
<h3 id="wscript.shell.sendkeys">Wscript.Shell.SendKeys</h3>
<p><code>(New-Object -ComObject Wscript.shell).SendKeys([char]173)</code>
–≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫<br />
<code>$wshell.Exec("notepad.exe")</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ<br />
<code>$wshell.AppActivate("–ë–ª–æ–∫–Ω–æ—Ç")</code> —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω–æ–µ
–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</p>
<p><code>$wshell.SendKeys("Login")</code> —Ç–µ–∫—Å—Ç<br />
<code>$wshell.SendKeys("{A 5}")</code> –Ω–∞–ø–µ—á–∞—Ç–∞—Ç—å –±—É–∫–≤—É 5 —Ä–∞–∑
–ø–æ–¥—Ä—è–¥<br />
<code>$wshell.SendKeys("%{TAB}")</code> ALT+TAB<br />
<code>$wshell.SendKeys("^")</code> CTRL<br />
<code>$wshell.SendKeys("%")</code> ALT<br />
<code>$wshell.SendKeys("+")</code> SHIFT<br />
<code>$wshell.SendKeys("{DOWN}")</code> –≤–Ω–∏–∑<br />
<code>$wshell.SendKeys("{UP}")</code> –≤–≤–µ—Ä—Ö<br />
<code>$wshell.SendKeys("{LEFT}")</code> –≤–ª–µ–≤–æ<br />
<code>$wshell.SendKeys("{RIGHT}")</code> –≤–ø—Ä–∞–≤–æ<br />
<code>$wshell.SendKeys("{PGUP}")</code> PAGE UP<br />
<code>$wshell.SendKeys("{PGDN}")</code> PAGE DOWN<br />
<code>$wshell.SendKeys("{BACKSPACE}")</code> BACKSPACE/BKSP/BS<br />
<code>$wshell.SendKeys("{DEL}")</code> DEL/DELETE<br />
<code>$wshell.SendKeys("{INS}")</code> INS/INSERT<br />
<code>$wshell.SendKeys("{PRTSC}")</code> PRINT SCREEN<br />
<code>$wshell.SendKeys("{ENTER}")</code><br />
<code>$wshell.SendKeys("{ESC}")</code><br />
<code>$wshell.SendKeys("{TAB}")</code><br />
<code>$wshell.SendKeys("{END}")</code><br />
<code>$wshell.SendKeys("{HOME}")</code><br />
<code>$wshell.SendKeys("{BREAK}")</code><br />
<code>$wshell.SendKeys("{SCROLLLOCK}")</code><br />
<code>$wshell.SendKeys("{CAPSLOCK}")</code><br />
<code>$wshell.SendKeys("{NUMLOCK}")</code><br />
<code>$wshell.SendKeys("{F1}")</code><br />
<code>$wshell.SendKeys("{F12}")</code><br />
<code>$wshell.SendKeys("{+}{^}{%}{~}{(}{)}{[}{]}{{}{}}")</code></p>
<div class="sourceCode" id="cb53"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get-AltTab <span class="op">{</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="fu">New-Object</span> <span class="op">-</span>ComObject wscript<span class="op">.</span><span class="fu">shell</span><span class="op">).</span><span class="fu">SendKeys</span><span class="op">(</span><span class="st">&quot;%{Tab}&quot;</span><span class="op">)</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Start-Sleep</span> <span class="op">$(</span><span class="fu">Get-Random</span> <span class="op">-</span>Minimum <span class="dv">30</span> <span class="op">-</span>Maximum <span class="dv">180</span><span class="op">)</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>Get-AltTab</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>Get-AltTab</span></code></pre></div>
<h3 id="wscript.shell.popup">Wscript.Shell.Popup</h3>
<p><code>$wshell = New-Object -ComObject Wscript.Shell</code><br />
<code>$output = $wshell.Popup("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ?",0,"–ó–∞–≥–æ–ª–æ–≤–æ–∫",4)</code><br />
<code>if ($output -eq 6) {"yes"} elseif ($output -eq 7) {"no"} else {"no good"}</code></p>
<pre><code>Type:
0 –û–ö
1 –û–ö –∏ –û—Ç–º–µ–Ω–∞
2 –°—Ç–æ–ø, –ü–æ–≤—Ç–æ—Ä, –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å
3 –î–∞, –ù–µ—Ç, –û—Ç–º–µ–Ω–∞
4 –î–∞ –∏ –ù–µ—Ç
5 –ü–æ–≤—Ç–æ—Ä –∏ –û—Ç–º–µ–Ω–∞
16 Stop
32 Question
48 Exclamation
64 Information

Output:
-1 Timeout
1 –û–ö
2 –û—Ç–º–µ–Ω–∞
3 –°—Ç–æ–ø
4 –ü–æ–≤—Ç–æ—Ä
5 –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å
6 –î–∞
7 –ù–µ—Ç</code></pre>
<h3 id="wscript.network">WScript.Network</h3>
<p><code>$wshell = New-Object -ComObject WScript.Network</code><br />
<code>$wshell | Get-Member</code><br />
<code>$wshell.UserName</code><br />
<code>$wshell.ComputerName</code><br />
<code>$wshell.UserDomain</code></p>
<h3 id="shell.application">Shell.Application</h3>
<p><code>$wshell = New-Object -ComObject Shell.Application</code><br />
<code>$wshell | Get-Member</code><br />
<code>$wshell.Explore("C:\")</code><br />
<code>$wshell.Windows() | Get-Member</code> –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –æ—Ç–∫—Ä—ã—Ç—ã–º –≤
–ø—Ä–æ–≤–æ–¥–Ω–∏–∫–µ –∏–ª–∏ –±—Ä–∞—É–∑–µ—Ä–µ Internet Explorer –æ–∫–æ–Ω</p>
<p><code>$shell = New-Object -Com Shell.Application</code><br />
<code>$RecycleBin = $shell.Namespace(10)</code><br />
<code>$RecycleBin.Items()</code></p>
<h3 id="outlook">Outlook</h3>
<p><code>$Outlook = New-Object -ComObject Outlook.Application</code><br />
<code>$Outlook | Get-Member</code><br />
<code>$Outlook.Version</code></p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="va">$Outlook</span> <span class="op">=</span> <span class="fu">New-Object</span> <span class="op">-</span>ComObject Outlook<span class="op">.</span><span class="fu">Application</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Namespace</span> <span class="op">=</span> <span class="va">$Outlook</span><span class="op">.</span><span class="fu">GetNamespace</span><span class="op">(</span><span class="st">&quot;MAPI&quot;</span><span class="op">)</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Folder</span> <span class="op">=</span> <span class="va">$namespace</span><span class="op">.</span><span class="fu">GetDefaultFolder</span><span class="op">(</span><span class="dv">4</span><span class="op">)</span><span class="ch">` </span>–∏—Å—Ö–æ–¥—è—â–∏–µ</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="va">$Folder</span> <span class="op">=</span> <span class="va">$namespace</span><span class="op">.</span><span class="fu">GetDefaultFolder</span><span class="op">(</span><span class="dv">6</span><span class="op">)</span><span class="ch">` </span>–≤—Ö–æ–¥—è—â–∏–µ</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="va">$Explorer</span> <span class="op">=</span> <span class="va">$Folder</span><span class="op">.</span><span class="fu">GetExplorer</span><span class="op">()</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="va">$Explorer</span><span class="op">.</span><span class="fu">Display</span><span class="op">()</span> </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="va">$Outlook</span><span class="op">.</span><span class="fu">Quit</span><span class="op">()</span></span></code></pre></div>
<h3 id="microsoft.update">Microsoft.Update</h3>
<p><code>(New-Object -com 'Microsoft.Update.AutoUpdate').Settings</code><br />
<code>(New-Object -com 'Microsoft.Update.AutoUpdate').Results</code><br />
<code>(New-Timespan -Start ((New-Object -com 'Microsoft.Update.AutoUpdate').Results|Select -ExpandProperty LastInstallationSuccessDate) -End (Get-Date)).hours</code>
–∫–æ–ª-–≤–æ —á–∞—Å–æ–≤, –ø—Ä–æ—à–µ–¥—à–∏—Ö —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–∞—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ Windows.</p>
<h1 id="dotnet">dotNET</h1>
<p><code>[System.Diagnostics.EventLog] | select Assembly,Module</code><br />
<code>$EventLog = [System.Diagnostics.EventLog]::new("Application")</code><br />
<code>$EventLog = New-Object -TypeName System.Diagnostics.EventLog -ArgumentList Application,192.168.3.100</code><br />
<code>$EventLog | Get-Member -MemberType Method</code><br />
<code>$EventLog.MaximumKilobytes</code> –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä
–∂—É—Ä–Ω–∞–ª–∞<br />
<code>$EventLog.Entries</code> –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∂—É—Ä–Ω–∞–ª<br />
<code>$EventLog.Clear()</code> –æ—á–∏—Å—Ç–∏—Ç—å –∂—É—Ä–Ω–∞–ª</p>
<p><code>Join-Path C: Install Test</code><br />
<code>[System.IO.Path]::Combine("C:", "Install", "Test")</code></p>
<h3 id="match">Match</h3>
<p><code>[System.Math] | Get-Member -Static -MemberType Methods</code><br />
<code>[System.Math]::Max(2,7)</code><br />
<code>[System.Math]::Min(2,7)</code><br />
<code>[System.Math]::Floor(3.9)</code><br />
<code>[System.Math]::Truncate(3.9)</code></p>
<h3 id="generatepassword">GeneratePassword</h3>
<p><code>Add-Type -AssemblyName System.Web</code><br />
<code>[System.Web.Security.Membership]::GeneratePassword(10,2)</code></p>
<h3 id="soundplayer">SoundPlayer</h3>
<div class="sourceCode" id="cb56"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="va">$CriticalSound</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Media</span><span class="op">.</span><span class="fu">SoundPlayer</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="va">$CriticalSound</span><span class="op">.</span><span class="fu">SoundLocation</span> <span class="op">=</span> <span class="st">&quot;C:\WINDOWS\Media\Windows Critical Stop.wav&quot;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="va">$CriticalSound</span><span class="op">.</span><span class="fu">Play</span><span class="op">()</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="va">$GoodSound</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Media</span><span class="op">.</span><span class="fu">SoundPlayer</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="va">$GoodSound</span><span class="op">.</span><span class="fu">SoundLocation</span> <span class="op">=</span> <span class="st">&quot;C:\WINDOWS\Media\tada.wav&quot;</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="va">$GoodSound</span><span class="op">.</span><span class="fu">Play</span><span class="op">()</span></span></code></pre></div>
<h3 id="static-class">Static Class</h3>
<p><code>[System.Environment] | Get-Member -Static</code><br />
<code>[System.Environment]::OSVersion</code><br />
<code>[System.Environment]::Version</code><br />
<code>[System.Environment]::MachineName</code><br />
<code>[System.Environment]::UserName</code></p>
<p><code>[System.Diagnostics.Process] | Get-Member -Static</code><br />
<code>[System.Diagnostics.Process]::Start('notepad.exe')</code></p>
<h3 id="clicker">[Clicker]</h3>
<div class="sourceCode" id="cb57"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="va">$cSource</span> <span class="op">=</span> <span class="vs">@&#39;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="vs">using System;</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="vs">using System.Drawing;</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="vs">using System.Runtime.InteropServices;</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="vs">using System.Windows.Forms;</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="vs">public class Clicker</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="vs">{</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="vs">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646270(v=vs.85).aspx</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="vs">[StructLayout(LayoutKind.Sequential)]</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="vs">struct INPUT</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="vs">{ </span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="vs">    public int        type; // 0 = INPUT_MOUSE,</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="vs">                            // 1 = INPUT_KEYBOARD</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="vs">                            // 2 = INPUT_HARDWARE</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="vs">    public MOUSEINPUT mi;</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="vs">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646273(v=vs.85).aspx</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="vs">[StructLayout(LayoutKind.Sequential)]</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="vs">struct MOUSEINPUT</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="vs">{</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a><span class="vs">    public int    dx ;</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="vs">    public int    dy ;</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a><span class="vs">    public int    mouseData ;</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a><span class="vs">    public int    dwFlags;</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a><span class="vs">    public int    time;</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a><span class="vs">    public IntPtr dwExtraInfo;</span></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a><span class="vs">//This covers most use cases although complex mice may have additional buttons</span></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a><span class="vs">//There are additional constants you can use for those cases, see the msdn page</span></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="vs">const int MOUSEEVENTF_MOVED      = 0x0001 ;</span></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a><span class="vs">const int MOUSEEVENTF_LEFTDOWN   = 0x0002 ;</span></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a><span class="vs">const int MOUSEEVENTF_LEFTUP     = 0x0004 ;</span></span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a><span class="vs">const int MOUSEEVENTF_RIGHTDOWN  = 0x0008 ;</span></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a><span class="vs">const int MOUSEEVENTF_RIGHTUP    = 0x0010 ;</span></span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a><span class="vs">const int MOUSEEVENTF_MIDDLEDOWN = 0x0020 ;</span></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a><span class="vs">const int MOUSEEVENTF_MIDDLEUP   = 0x0040 ;</span></span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a><span class="vs">const int MOUSEEVENTF_WHEEL      = 0x0080 ;</span></span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a><span class="vs">const int MOUSEEVENTF_XDOWN      = 0x0100 ;</span></span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a><span class="vs">const int MOUSEEVENTF_XUP        = 0x0200 ;</span></span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a><span class="vs">const int MOUSEEVENTF_ABSOLUTE   = 0x8000 ;</span></span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a><span class="vs">const int screen_length          = 0x10000 ;</span></span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a><span class="vs">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646310(v=vs.85).aspx</span></span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a><span class="vs">[System.Runtime.InteropServices.DllImport(&quot;user32.dll&quot;)]</span></span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a><span class="vs">extern static uint SendInput(uint nInputs, INPUT[] pInputs, int cbSize);</span></span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a><span class="vs">public static void LeftClickAtPoint(int x, int y)</span></span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a><span class="vs">{</span></span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a><span class="vs">    //Move the mouse</span></span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a><span class="vs">    INPUT[] input = new INPUT[3];</span></span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a><span class="vs">    input[0].mi.dx = x*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width);</span></span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a><span class="vs">    input[0].mi.dy = y*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height);</span></span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a><span class="vs">    input[0].mi.dwFlags = MOUSEEVENTF_MOVED | MOUSEEVENTF_ABSOLUTE;</span></span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a><span class="vs">    //Left mouse button down</span></span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a><span class="vs">    input[1].mi.dwFlags = MOUSEEVENTF_LEFTDOWN;</span></span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a><span class="vs">    //Left mouse button up</span></span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a><span class="vs">    input[2].mi.dwFlags = MOUSEEVENTF_LEFTUP;</span></span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a><span class="vs">    SendInput(3, input, Marshal.SizeOf(input[0]));</span></span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a><span class="vs">&#39;@</span></span></code></pre></div>
<p><code>Add-Type -TypeDefinition $cSource -ReferencedAssemblies System.Windows.Forms,System.Drawing</code><br />
<code>[Clicker]::LeftClickAtPoint(1900,1070)</code></p>
<h3 id="audio">[Audio]</h3>
<div class="sourceCode" id="cb58"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Add-Type</span> <span class="op">-</span>Language CsharpVersion3 <span class="op">-</span>TypeDefinition <span class="vs">@&quot;</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="vs">using System.Runtime.InteropServices;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="vs">[Guid(&quot;5CDF2C82-841E-4546-9722-0CF74078229A&quot;), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="vs">interface IAudioEndpointVolume {</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="vs">// f(), g(), ... are unused COM method slots. Define these if you care</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="vs">int f(); int g(); int h(); int i();</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="vs">int SetMasterVolumeLevelScalar(float fLevel, System.Guid pguidEventContext);</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="vs">int j();</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="vs">int GetMasterVolumeLevelScalar(out float pfLevel);</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="vs">int k(); int l(); int m(); int n();</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="vs">int SetMute([MarshalAs(UnmanagedType.Bool)] bool bMute, System.Guid pguidEventContext);</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="vs">int GetMute(out bool pbMute);</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="vs">[Guid(&quot;D666063F-1587-4E43-81F1-B948E807363F&quot;), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="vs">interface IMMDevice {</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="vs">int Activate(ref System.Guid id, int clsCtx, int activationParams, out IAudioEndpointVolume aev);</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="vs">[Guid(&quot;A95664D2-9614-4F35-A746-DE8DB63617E6&quot;), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="vs">interface IMMDeviceEnumerator {</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="vs">int f(); // Unused</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="vs">int GetDefaultAudioEndpoint(int dataFlow, int role, out IMMDevice endpoint);</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="vs">[ComImport, Guid(&quot;BCDE0395-E52F-467C-8E3D-C4579291692E&quot;)] class MMDeviceEnumeratorComObject { }</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="vs">public class Audio {</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a><span class="vs">static IAudioEndpointVolume Vol() {</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a><span class="vs">var enumerator = new MMDeviceEnumeratorComObject() as IMMDeviceEnumerator;</span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="vs">IMMDevice dev = null;</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="vs">Marshal.ThrowExceptionForHR(enumerator.GetDefaultAudioEndpoint(/*eRender*/ 0, /*eMultimedia*/ 1, out dev));</span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a><span class="vs">IAudioEndpointVolume epv = null;</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a><span class="vs">var epvid = typeof(IAudioEndpointVolume).GUID;</span></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a><span class="vs">Marshal.ThrowExceptionForHR(dev.Activate(ref epvid, /*CLSCTX_ALL*/ 23, 0, out epv));</span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a><span class="vs">return epv;</span></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a><span class="vs">public static float Volume {</span></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a><span class="vs">get {float v = -1; Marshal.ThrowExceptionForHR(Vol().GetMasterVolumeLevelScalar(out v)); return v;}</span></span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a><span class="vs">set {Marshal.ThrowExceptionForHR(Vol().SetMasterVolumeLevelScalar(value, System.Guid.Empty));}</span></span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a><span class="vs">public static bool Mute {</span></span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a><span class="vs">get { bool mute; Marshal.ThrowExceptionForHR(Vol().GetMute(out mute)); return mute; }</span></span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a><span class="vs">set { Marshal.ThrowExceptionForHR(Vol().SetMute(value, System.Guid.Empty)); }</span></span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a><span class="vs">&quot;@</span></span></code></pre></div>
<p><code>[Audio]::Volume = 0.50</code><br />
<code>[Audio]::Mute = $true</code></p>
<h3 id="netsessionenum">NetSessionEnum</h3>
<p><a
href="https://learn.microsoft.com/ru-ru/windows/win32/api/lmshare/nf-lmshare-netsessionenum?redirectedfrom=MSDN">Function</a><br />
<a href="https://fuzzysecurity.com/tutorials/24.html">Source</a></p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Invoke-NetSessionEnum <span class="op">{</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="kw">param</span> <span class="op">(</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Parameter<span class="op">(</span>Mandatory <span class="op">=</span> <span class="va">$True</span><span class="op">)][</span><span class="dt">string</span><span class="op">]</span><span class="va">$HostName</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Add-Type</span> <span class="op">-</span>TypeDefinition <span class="vs">@&quot;</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="vs">using System;</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="vs">using System.Diagnostics;</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="vs">using System.Runtime.InteropServices;</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="vs">[StructLayout(LayoutKind.Sequential)]</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="vs">public struct SESSION_INFO_10</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="vs">{</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="vs">    [MarshalAs(UnmanagedType.LPWStr)]public string OriginatingHost;</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="vs">    [MarshalAs(UnmanagedType.LPWStr)]public string DomainUser;</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="vs">    public uint SessionTime;</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="vs">    public uint IdleTime;</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="vs">public static class Netapi32</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="vs">{</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="vs">[DllImport(&quot;Netapi32.dll&quot;, SetLastError=true)]</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="vs">    public static extern int NetSessionEnum(</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="vs">        [In,MarshalAs(UnmanagedType.LPWStr)] string ServerName,</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="vs">        [In,MarshalAs(UnmanagedType.LPWStr)] string UncClientName,</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="vs">        [In,MarshalAs(UnmanagedType.LPWStr)] string UserName,</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a><span class="vs">        Int32 Level,</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="vs">        out IntPtr bufptr,</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a><span class="vs">        int prefmaxlen,</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a><span class="vs">        ref Int32 entriesread,</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a><span class="vs">        ref Int32 totalentries,</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a><span class="vs">        ref Int32 resume_handle);</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a><span class="vs">         </span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a><span class="vs">[DllImport(&quot;Netapi32.dll&quot;, SetLastError=true)]</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a><span class="vs">    public static extern int NetApiBufferFree(</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a><span class="vs">        IntPtr Buffer);</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a><span class="vs">&quot;@</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Create SessionInfo10 Struct</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="va">$SessionInfo10</span> <span class="op">=</span> <span class="fu">New-Object</span> SESSION_INFO_10</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a><span class="va">$SessionInfo10StructSize</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Runtime</span><span class="op">.</span><span class="fu">InteropServices</span><span class="op">.</span><span class="fu">Marshal</span><span class="op">]::</span>SizeOf<span class="op">(</span><span class="va">$SessionInfo10</span><span class="op">)</span><span class="ch">` </span>Grab size to loop bufptr</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a><span class="va">$SessionInfo10</span> <span class="op">=</span> <span class="va">$SessionInfo10</span><span class="op">.</span><span class="fu">GetType</span><span class="op">()</span><span class="ch">` </span>Hacky<span class="op">,</span> but we need this <span class="op">;))</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a><span class="co"># NetSessionEnum params</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a><span class="va">$OutBuffPtr</span> <span class="op">=</span> <span class="op">[</span>IntPtr<span class="op">]::</span>Zero<span class="ch">` </span>Struct output buffer</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a><span class="va">$EntriesRead</span> <span class="op">=</span> <span class="va">$TotalEntries</span> <span class="op">=</span> <span class="va">$ResumeHandle</span> <span class="op">=</span> <span class="dv">0</span><span class="ch">` </span>Counters <span class="op">&amp;</span> ResumeHandle</span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a><span class="va">$CallResult</span> <span class="op">=</span> <span class="op">[</span>Netapi32<span class="op">]::</span>NetSessionEnum<span class="op">(</span><span class="va">$HostName</span><span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="op">[</span>ref<span class="op">]</span><span class="va">$OutBuffPtr</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="op">[</span>ref<span class="op">]</span><span class="va">$EntriesRead</span><span class="op">,</span> <span class="op">[</span>ref<span class="op">]</span><span class="va">$TotalEntries</span><span class="op">,</span> <span class="op">[</span>ref<span class="op">]</span><span class="va">$ResumeHandle</span><span class="op">)</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$CallResult</span> <span class="op">-ne</span> <span class="dv">0</span><span class="op">){</span></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a><span class="fu">echo</span> <span class="st">&quot;Mmm something went wrong!</span><span class="ch">`n</span><span class="st">Error Code: </span><span class="va">$CallResult</span><span class="st">&quot;</span></span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> <span class="op">{</span></span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">([</span>System<span class="op">.</span><span class="fu">IntPtr</span><span class="op">]::</span>Size <span class="op">-eq</span> <span class="dv">4</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a><span class="fu">echo</span> <span class="st">&quot;</span><span class="ch">`n</span><span class="st">Netapi32::NetSessionEnum Buffer Offset  --&gt; 0x</span><span class="op">$(</span><span class="st">&quot;{0:X8}&quot;</span> <span class="op">-</span>f <span class="va">$OutBuffPtr</span><span class="op">.</span><span class="fu">ToInt32</span><span class="op">()</span><span class="st">)&quot;</span></span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> <span class="op">{</span></span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a><span class="fu">echo</span> <span class="st">&quot;</span><span class="ch">`n</span><span class="st">Netapi32::NetSessionEnum Buffer Offset  --&gt; 0x</span><span class="op">$(</span><span class="st">&quot;{0:X16}&quot;</span> <span class="op">-</span>f <span class="va">$OutBuffPtr</span><span class="op">.</span><span class="fu">ToInt64</span><span class="op">()</span><span class="st">)&quot;</span></span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a><span class="fu">echo</span> <span class="st">&quot;Result-set contains </span><span class="va">$EntriesRead</span><span class="st"> session(s)!&quot;</span></span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Change buffer offset to int</span></span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a><span class="va">$BufferOffset</span> <span class="op">=</span> <span class="va">$OutBuffPtr</span><span class="op">.</span><span class="fu">ToInt64</span><span class="op">()</span></span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop buffer entries and cast pointers as SessionInfo10</span></span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="va">$Count</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="op">(</span><span class="va">$Count</span> <span class="op">-lt</span> <span class="va">$EntriesRead</span><span class="op">);</span> <span class="va">$Count</span><span class="op">++){</span></span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a><span class="va">$NewIntPtr</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Intptr</span> <span class="op">-</span>ArgumentList <span class="va">$BufferOffset</span></span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a><span class="va">$Info</span> <span class="op">=</span> <span class="op">[</span>system<span class="op">.</span><span class="fu">runtime</span><span class="op">.</span><span class="fu">interopservices</span><span class="op">.</span><span class="fu">marshal</span><span class="op">]::</span>PtrToStructure<span class="op">(</span><span class="va">$NewIntPtr</span><span class="op">,[</span>type<span class="op">]</span><span class="va">$SessionInfo10</span><span class="op">)</span></span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a><span class="va">$Info</span></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a><span class="va">$BufferOffset</span> <span class="op">=</span> <span class="va">$BufferOffset</span> <span class="op">+</span> <span class="va">$SessionInfo10StructSize</span></span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a><span class="fu">echo</span> <span class="st">&quot;</span><span class="ch">`n</span><span class="st">Calling NetApiBufferFree, no memleaks here!&quot;</span></span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Netapi32<span class="op">]::</span>NetApiBufferFree<span class="op">(</span><span class="va">$OutBuffPtr</span><span class="op">)</span> <span class="op">|</span><span class="fu">Out-Null</span></span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Invoke-NetSessionEnum localhost</code></p>
<h3 id="copyfile">CopyFile</h3>
<p><a
href="https://learn.microsoft.com/ru-ru/windows/win32/api/winbase/nf-winbase-copyfile">Function</a><br />
<a
href="https://devblogs.microsoft.com/scripting/use-powershell-to-interact-with-the-windows-api-part-1/">Source</a></p>
<div class="sourceCode" id="cb60"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="va">$MethodDefinition</span> <span class="op">=</span> <span class="vs">@&quot;</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="vs">[DllImport(&quot;kernel32.dll&quot;, CharSet = CharSet.Unicode)]</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="vs">public static extern bool CopyFile(string lpExistingFileName, string lpNewFileName, bool bFailIfExists);</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="vs">&quot;@</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="va">$Kernel32</span> <span class="op">=</span> <span class="fu">Add-Type</span> <span class="op">-</span>MemberDefinition <span class="va">$MethodDefinition</span> <span class="op">-</span>Name <span class="st">&quot;Kernel32&quot;</span> <span class="op">-</span>Namespace <span class="st">&quot;Win32&quot;</span> <span class="op">-</span>PassThru</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="va">$Kernel32</span><span class="op">::</span>CopyFile<span class="op">(</span><span class="st">&quot;</span><span class="op">$(</span><span class="va">$Env</span><span class="op">:</span><span class="va">SystemRoot</span><span class="op">)</span><span class="st">\System32\calc.exe&quot;</span><span class="op">,</span> <span class="st">&quot;</span><span class="op">$(</span><span class="va">$Env</span><span class="op">:</span><span class="va">USERPROFILE</span><span class="op">)</span><span class="st">\Desktop\calc.exe&quot;</span><span class="op">,</span> <span class="va">$False</span><span class="op">)</span> </span></code></pre></div>
<h3 id="showwindowasync">ShowWindowAsync</h3>
<p><a
href="https://learn.microsoft.com/ru-ru/windows/win32/api/winuser/nf-winuser-showwindowasync">Function</a></p>
<div class="sourceCode" id="cb61"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="va">$Signature</span> <span class="op">=</span> <span class="vs">@&quot;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="vs">[DllImport(&quot;user32.dll&quot;)]public static extern bool ShowWindowAsync(IntPtr hWnd, int nCmdShow);</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="vs">&quot;@</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="va">$ShowWindowAsync</span> <span class="op">=</span> <span class="fu">Add-Type</span> <span class="op">-</span>MemberDefinition <span class="va">$Signature</span> <span class="op">-</span>Name <span class="st">&quot;Win32ShowWindowAsync&quot;</span> <span class="op">-</span>Namespace Win32Functions <span class="op">-</span>PassThru</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="va">$ShowWindowAsync</span> <span class="op">|</span> <span class="fu">Get-Member</span> <span class="op">-</span>Static</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="va">$ShowWindowAsync</span><span class="op">::</span>ShowWindowAsync<span class="op">((</span><span class="fu">Get-Process</span> <span class="op">-</span>Id <span class="va">$pid</span><span class="op">).</span><span class="fu">MainWindowHandle</span><span class="op">,</span> <span class="dv">2</span><span class="op">)</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="va">$ShowWindowAsync</span><span class="op">::</span>ShowWindowAsync<span class="op">((</span><span class="fu">Get-Process</span> <span class="op">-</span>Id <span class="va">$Pid</span><span class="op">).</span><span class="fu">MainWindowHandle</span><span class="op">,</span> <span class="dv">3</span><span class="op">)</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="va">$ShowWindowAsync</span><span class="op">::</span>ShowWindowAsync<span class="op">((</span><span class="fu">Get-Process</span> <span class="op">-</span>Id <span class="va">$Pid</span><span class="op">).</span><span class="fu">MainWindowHandle</span><span class="op">,</span> <span class="dv">4</span><span class="op">)</span></span></code></pre></div>
<h3 id="getasynckeystate">GetAsyncKeyState</h3>
<p><a
href="https://learn.microsoft.com/ru-ru/windows/win32/api/winuser/nf-winuser-getasynckeystate">Function</a></p>
<p><code>Add-Type -AssemblyName System.Windows.Forms</code><br />
<code>[int][System.Windows.Forms.Keys]::F1</code> –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–æ–º–µ—Ä [Int]
–∫–ª–∞–≤–∏—à–∏ –ø–æ –µ–µ –Ω–∞–∑–≤–∞–Ω–∏—é<br />
<code>65..90 | % {"{0} = {1}" -f $_, [System.Windows.Forms.Keys]$_}</code>
–ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –±—É–∫–≤ (A..Z)</p>
<div class="sourceCode" id="cb62"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get-ControlKey <span class="op">{</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="va">$key</span> <span class="op">=</span> <span class="dv">112</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Signature</span> <span class="op">=</span> <span class="vs">@&#39;</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="vs">[DllImport(&quot;user32.dll&quot;, CharSet=CharSet.Auto, ExactSpelling=true)] </span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="vs">public static extern short GetAsyncKeyState(int virtualKeyCode); </span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="vs">&#39;@</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Add-Type</span> <span class="op">-</span>MemberDefinition <span class="va">$Signature</span> <span class="op">-</span>Name Keyboard <span class="op">-</span>Namespace PsOneApi</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dt">bool</span><span class="op">]([</span>PsOneApi<span class="op">.</span><span class="fu">Keyboard</span><span class="op">]::</span>GetAsyncKeyState<span class="op">(</span><span class="va">$key</span><span class="op">)</span> <span class="op">-eq</span> <span class="op">-</span><span class="dv">32767</span><span class="op">)</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Warning</span> <span class="st">&#39;Press F1 to exit&#39;</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span><span class="va">$true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&#39;.&#39;</span> <span class="op">-</span>NoNewline</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>Get-ControlKey<span class="op">)</span> <span class="op">{</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="cf">break</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="fu">Start-Sleep</span> <span class="op">-</span>Seconds <span class="dv">0.5</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="console-api">Console API</h1>
<p><a
href="https://powershell.one/tricks/input-devices/detect-key-press">Source</a></p>
<p><code>[Console] | Get-Member -Static</code><br />
<code>[Console]::BackgroundColor = "Blue"</code><br />
<code>[Console]::OutputEncoding</code> –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –≤ —Ç–µ–∫—É—â–µ–π
—Å–µ—Å—Å–∏–∏<br />
<code>[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding("utf-8")</code>
–∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥–∏—Ä–æ–≤–∫—É –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã<br />
<code>[Console]::outputEncoding = [System.Text.Encoding]::GetEncoding("cp866")</code>
–¥–ª—è ISE<br />
<code>[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding("windows-1251")</code>
–¥–ª—è ps2exe<br />
<code>Get-Service | Out-File $home\Desktop\Service.txt -Encoding oem</code>
&gt;<br />
<code>Get-Service | Out-File $home\Desktop\Service.txt -Append</code>
&gt;&gt;</p>
<div class="sourceCode" id="cb63"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span> <span class="op">{</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">([</span>Console<span class="op">]::</span>KeyAvailable<span class="op">)</span> <span class="op">{</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="va">$keyInfo</span> <span class="op">=</span> <span class="op">[</span>Console<span class="op">]::</span>ReadKey<span class="op">(</span><span class="va">$true</span><span class="op">)</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="cf">break</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;.&quot;</span> <span class="op">-</span>NoNewline</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sleep</span> <span class="dv">1</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">while</span> <span class="op">(</span><span class="va">$true</span><span class="op">)</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="va">$keyInfo</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get-KeyPress <span class="op">{</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="kw">param</span> <span class="op">(</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Parameter<span class="op">(</span>Mandatory<span class="op">)][</span>ConsoleKey<span class="op">]</span><span class="va">$Key</span><span class="op">,</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>System<span class="op">.</span><span class="fu">ConsoleModifiers</span><span class="op">]</span><span class="va">$ModifierKey</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">([</span>Console<span class="op">]::</span>KeyAvailable<span class="op">)</span> <span class="op">{</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="va">$pressedKey</span> <span class="op">=</span> <span class="op">[</span>Console<span class="op">]::</span>ReadKey<span class="op">(</span><span class="va">$true</span><span class="op">)</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="va">$isPressedKey</span> <span class="op">=</span> <span class="va">$key</span> <span class="op">-eq</span> <span class="va">$pressedKey</span><span class="op">.</span><span class="fu">Key</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$isPressedKey</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="va">$pressedKey</span><span class="op">.</span><span class="fu">Modifiers</span> <span class="op">-eq</span> <span class="va">$ModifierKey</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Console<span class="op">]::</span>Beep<span class="op">(</span><span class="dv">1800</span><span class="op">,</span> <span class="dv">200</span><span class="op">)</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="va">$false</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="op">}}}</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Warning</span> <span class="st">&#39;Press Ctrl+Shift+Q to exit&#39;</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span> <span class="op">{</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;.&quot;</span> <span class="op">-</span>NoNewline</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a><span class="va">$pressed</span> <span class="op">=</span> Get-KeyPress <span class="op">-</span>Key Q <span class="op">-</span>ModifierKey <span class="st">&#39;Control,Shift&#39;</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$pressed</span><span class="op">)</span> <span class="op">{</span><span class="cf">break</span><span class="op">}</span></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a><span class="fu">sleep</span> <span class="dv">1</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">while</span> <span class="op">(</span><span class="va">$true</span><span class="op">)</span></span></code></pre></div>
<h1 id="drawing">Drawing</h1>
<p><a
href="https://learn.microsoft.com/en-us/dotnet/api/system.drawing?view=net-7.0&amp;redirectedfrom=MSDN">API</a></p>
<div class="sourceCode" id="cb64"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Add-Type</span> <span class="op">-</span>AssemblyName System<span class="op">.</span><span class="fu">Drawing</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Width</span> <span class="op">=</span> <span class="dv">800</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Height</span> <span class="op">=</span> <span class="dv">400</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="va">$image</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">Bitmap</span><span class="op">(</span><span class="va">$Width</span><span class="op">,</span><span class="va">$Height</span><span class="op">)</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="va">$graphic</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">Graphics</span><span class="op">]::</span>FromImage<span class="op">(</span><span class="va">$image</span><span class="op">)</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="va">$background_color</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">Brushes</span><span class="op">]::</span>Blue <span class="co"># –∑–∞–¥–∞—Ç—å —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ (—Å–∏–Ω–∏–π)</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="va">$graphic</span><span class="op">.</span><span class="fu">FillRectangle</span><span class="op">(</span><span class="va">$background_color</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="va">$image</span><span class="op">.</span><span class="fu">Width</span><span class="op">,</span> <span class="va">$image</span><span class="op">.</span><span class="fu">Height</span><span class="op">)</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="va">$text_color</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">Brushes</span><span class="op">]::</span>White <span class="co"># –∑–∞–¥–∞—Ç—å —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ (–±–µ–ª—ã–π)</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="va">$font</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">Font</span><span class="op">(</span><span class="st">&quot;Arial&quot;</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">FontStyle</span><span class="op">]::</span>Bold<span class="op">)</span> <span class="co"># –∑–∞–¥–∞—Ç—å —à—Ä–∏—Ñ—Ç</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="va">$text</span> <span class="op">=</span> <span class="st">&quot;PowerShell&quot;</span> <span class="co"># —É–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="va">$text_position</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">RectangleF</span><span class="op">(</span><span class="dv">320</span><span class="op">,</span> <span class="dv">180</span><span class="op">,</span> <span class="dv">300</span><span class="op">,</span> <span class="dv">100</span><span class="op">)</span>  <span class="co"># –∑–∞–¥–∞—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ (x, y, width, height)</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="va">$graphic</span><span class="op">.</span><span class="fu">DrawString</span><span class="op">(</span><span class="va">$text</span><span class="op">,</span> <span class="va">$font</span><span class="op">,</span> <span class="va">$text_color</span><span class="op">,</span> <span class="va">$text_position</span><span class="op">)</span> <span class="co"># –Ω–∞–Ω–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="va">$image</span><span class="op">.</span><span class="fu">Save</span><span class="op">(</span><span class="st">&quot;</span><span class="va">$home</span><span class="st">\desktop\powershell_image.bmp&quot;</span><span class="op">,</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">Imaging</span><span class="op">.</span><span class="fu">ImageFormat</span><span class="op">]::</span>Bmp<span class="op">)</span> <span class="co"># —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="va">$image</span><span class="op">.</span><span class="fu">Dispose</span><span class="op">()</span> <span class="co"># –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤</span></span></code></pre></div>
<p><code>$path = "$home\desktop\powershell_image.bmp"</code><br />
<code>Invoke-Item $path</code></p>
<div class="sourceCode" id="cb65"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="va">$src_image</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">Image</span><span class="op">]::</span>FromFile<span class="op">(</span><span class="va">$path</span><span class="op">)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Width</span> <span class="op">=</span> <span class="dv">400</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Height</span> <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="va">$dst_image</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">Bitmap</span> <span class="op">-</span>ArgumentList <span class="va">$src_image</span><span class="op">,</span> <span class="va">$Width</span><span class="op">,</span> <span class="va">$Height</span> <span class="co"># –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="va">$dst_image</span><span class="op">.</span><span class="fu">Save</span><span class="op">(</span><span class="st">&quot;</span><span class="va">$home</span><span class="st">\desktop\powershell_image_resize.bmp&quot;</span><span class="op">,</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">Imaging</span><span class="op">.</span><span class="fu">ImageFormat</span><span class="op">]::</span>Bmp<span class="op">)</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="va">$rotated_image</span> <span class="op">=</span> <span class="va">$src_image</span><span class="op">.</span><span class="fu">Clone</span><span class="op">()</span> <span class="co"># —Å–æ–∑–¥–∞—Ç—å –∫–æ–ø–∏—é –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="va">$rotated_image</span><span class="op">.</span><span class="fu">RotateFlip</span><span class="op">([</span>System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">RotateFlipType</span><span class="op">]::</span>Rotate180FlipNone<span class="op">)</span> <span class="co"># –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ 180 –≥—Ä–∞–¥—É—Å–æ–≤</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="va">$rotated_image</span><span class="op">.</span><span class="fu">Save</span><span class="op">(</span><span class="st">&quot;</span><span class="va">$home</span><span class="st">\desktop\powershell_image_rotated.bmp&quot;</span><span class="op">,</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Drawing</span><span class="op">.</span><span class="fu">Imaging</span><span class="op">.</span><span class="fu">ImageFormat</span><span class="op">]::</span>Bmp<span class="op">)</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="va">$src_image</span><span class="op">.</span><span class="fu">Dispose</span><span class="op">()</span> <span class="co"># –∑–∞–∫—Ä—ã—Ç—å (–æ—Ç–ø—É—Å—Ç–∏—Ç—å) –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª</span></span></code></pre></div>
<h1 id="objectevent">ObjectEvent</h1>
<div class="sourceCode" id="cb66"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="va">$Timer</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Timers</span><span class="op">.</span><span class="fu">Timer</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Timer</span><span class="op">.</span><span class="fu">Interval</span> <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="dt">Register</span><span class="op">-</span>ObjectEvent <span class="op">-</span>InputObject <span class="va">$Timer</span> <span class="op">-</span>EventName Elapsed <span class="op">-</span>SourceIdentifier Timer<span class="op">.</span><span class="fu">Output</span> <span class="op">-</span>Action <span class="op">{</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="va">$Random</span> <span class="op">=</span> <span class="fu">Get-Random</span> <span class="op">-</span>Min <span class="dv">0</span> <span class="op">-</span>Max <span class="dv">100</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="dt">Write</span><span class="op">-</span>Host <span class="va">$Random</span> </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="va">$Timer</span><span class="op">.</span><span class="fu">Enabled</span> <span class="op">=</span> <span class="va">$True</span></span></code></pre></div>
<p><code>$Timer.Enabled = $False</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å<br />
<code>$Timer | Get-Member -MemberType Event</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫
–≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –æ–±—ä–µ–∫—Ç–∞<br />
<code>Get-EventSubscriber</code> —Å–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞
—Å–æ–±—ã—Ç–∏—è –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏<br />
<code>Unregister-Event -SourceIdentifier Timer.Output</code> —É–¥–∞–ª—è–µ—Ç
—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ –ø–æ –∏–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏—è (EventName) –∏–ª–∏ –≤—Å–µ
*<br />
<code>-Forward</code> –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å–µ–∞–Ω—Å–∞
(New-PSSession) –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ–∞–Ω—Å<br />
<code>-SupportEvent</code> –Ω–µ –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏—è –Ω–∞
—ç–∫—Ä–∞–Ω (–∏ Get-EventSubscriber –∏ Get-Job)</p>
<pre><code>Register-EngineEvent -SourceIdentifier PowerShell.Exiting -Action {
$date = Get-Date -f hh:mm:ss
(New-Object -ComObject Wscript.Shell).Popup(&quot;PowerShell Exit: $date&quot;,0,&quot;Action&quot;,64)
}</code></pre>
<h1 id="sockets">Sockets</h1>
<h3 id="udp-socket">UDP Socket</h3>
<p><a
href="https://cloudbrothers.info/en/test-udp-connection-powershell/">Source</a></p>
<div class="sourceCode" id="cb68"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Start-UDPServer <span class="op">{</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="kw">param</span><span class="op">(</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Port</span> <span class="op">=</span> <span class="dv">5201</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="va">$RemoteComputer</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">IPEndPoint</span><span class="op">([</span>System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">IPAddress</span><span class="op">]::</span>Any<span class="op">,</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span> <span class="op">{</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="va">$UdpObject</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">Sockets</span><span class="op">.</span><span class="fu">UdpClient</span><span class="op">(</span><span class="va">$Port</span><span class="op">)</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="va">$ReceiveBytes</span> <span class="op">=</span> <span class="va">$UdpObject</span><span class="op">.</span><span class="fu">Receive</span><span class="op">([</span>ref<span class="op">]</span><span class="va">$RemoteComputer</span><span class="op">)</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="va">$UdpObject</span><span class="op">.</span><span class="fu">Close</span><span class="op">()</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="va">$ASCIIEncoding</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Text</span><span class="op">.</span><span class="fu">ASCIIEncoding</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$ReturnString</span> <span class="op">=</span> <span class="va">$ASCIIEncoding</span><span class="op">.</span><span class="fu">GetString</span><span class="op">(</span><span class="va">$ReceiveBytes</span><span class="op">)</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>PSCustomObject<span class="op">]</span>@<span class="op">{</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>LocalDateTime <span class="op">=</span> <span class="op">$(</span><span class="fu">Get-Date</span> <span class="op">-</span>UFormat <span class="st">&quot;%Y-%m-%d %T&quot;</span><span class="op">)</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>ClientIP      <span class="op">=</span> <span class="va">$RemoteComputer</span><span class="op">.</span><span class="fu">address</span><span class="op">.</span><span class="fu">ToString</span><span class="op">()</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>ClientPort    <span class="op">=</span> <span class="va">$RemoteComputer</span><span class="op">.</span><span class="fu">Port</span><span class="op">.</span><span class="fu">ToString</span><span class="op">()</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>Message       <span class="op">=</span> <span class="va">$ReturnString</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Start-UDPServer -Port 5201</code></p>
<h3 id="test-netudpconnection">Test-NetUDPConnection</h3>
<div class="sourceCode" id="cb69"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Test-NetUDPConnection <span class="op">{</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="kw">param</span><span class="op">(</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$ComputerName</span> <span class="op">=</span> <span class="st">&quot;127.0.0.1&quot;</span><span class="op">,</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>int32<span class="op">]</span><span class="va">$PortServer</span>    <span class="op">=</span> <span class="dv">5201</span><span class="op">,</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>int32<span class="op">]</span><span class="va">$PortClient</span>    <span class="op">=</span> <span class="dv">5211</span><span class="op">,</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="va">$Message</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="kw">begin</span> <span class="op">{</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="va">$UdpObject</span> <span class="op">=</span> <span class="fu">New-Object</span> system<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">Sockets</span><span class="op">.</span><span class="fu">Udpclient</span><span class="op">(</span><span class="va">$PortClient</span><span class="op">)</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="va">$UdpObject</span><span class="op">.</span><span class="fu">Connect</span><span class="op">(</span><span class="va">$ComputerName</span><span class="op">,</span> <span class="va">$PortServer</span><span class="op">)</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="cf">process</span> <span class="op">{</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="va">$ASCIIEncoding</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Text</span><span class="op">.</span><span class="fu">ASCIIEncoding</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(!</span><span class="va">$Message</span><span class="op">)</span> <span class="op">{</span><span class="va">$Message</span> <span class="op">=</span> <span class="fu">Get-Date</span> <span class="op">-</span>UFormat <span class="st">&quot;%Y-%m-%d %T&quot;</span><span class="op">}</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="va">$Bytes</span> <span class="op">=</span> <span class="va">$ASCIIEncoding</span><span class="op">.</span><span class="fu">GetBytes</span><span class="op">(</span><span class="va">$Message</span><span class="op">)</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>void<span class="op">]</span><span class="va">$UdpObject</span><span class="op">.</span><span class="fu">Send</span><span class="op">(</span><span class="va">$Bytes</span><span class="op">,</span> <span class="va">$Bytes</span><span class="op">.</span><span class="fu">length</span><span class="op">)</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> <span class="op">{</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="va">$UdpObject</span><span class="op">.</span><span class="fu">Close</span><span class="op">()</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Test-NetUDPConnection -ComputerName 127.0.0.1 -PortServer 5201</code><br />
<code>Test-NetUDPConnection -ComputerName 127.0.0.1 -PortServer 514 -Message "&lt;30&gt;May 31 00:00:00 HostName multipathd[784]: Test message"</code></p>
<h3 id="tcp-socket">TCP Socket</h3>
<div class="sourceCode" id="cb70"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Start-TCPServer <span class="op">{</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="kw">param</span><span class="op">(</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Port</span> <span class="op">=</span> <span class="dv">5201</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span> <span class="op">{</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="va">$TcpObject</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">Sockets</span><span class="op">.</span><span class="fu">TcpListener</span><span class="op">(</span><span class="va">$port</span><span class="op">)</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="va">$ReceiveBytes</span> <span class="op">=</span> <span class="va">$TcpObject</span><span class="op">.</span><span class="fu">Start</span><span class="op">()</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="va">$ReceiveBytes</span> <span class="op">=</span> <span class="va">$TcpObject</span><span class="op">.</span><span class="fu">AcceptTcpClient</span><span class="op">()</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="va">$TcpObject</span><span class="op">.</span><span class="fu">Stop</span><span class="op">()</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="va">$ReceiveBytes</span><span class="op">.</span><span class="fu">Client</span><span class="op">.</span><span class="fu">RemoteEndPoint</span> <span class="op">|</span> <span class="fu">select</span> Address<span class="op">,</span>Port</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Start-TCPServer -Port 5201</code><br />
<code>Test-NetConnection -ComputerName 127.0.0.1 -Port 5201</code></p>
<h3 id="wakeonlan">WakeOnLan</h3>
<p>Broadcast package consisting of 6 byte filled ‚Äú0xFF‚Äù and then 96 byte
where the mac address is repeated 16 times</p>
<div class="sourceCode" id="cb71"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Send-WOL <span class="op">{</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="kw">param</span> <span class="op">(</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Parameter<span class="op">(</span>Mandatory <span class="op">=</span> <span class="va">$True</span><span class="op">)]</span><span class="va">$Mac</span><span class="op">,</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="va">$IP</span><span class="op">,</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dt">int</span><span class="op">]</span><span class="va">$Port</span> <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="va">$Mac</span> <span class="op">=</span> <span class="va">$Mac</span><span class="op">.</span><span class="fu">replace</span><span class="op">(</span><span class="st">&quot;:&quot;</span><span class="op">,</span> <span class="st">&quot;-&quot;</span><span class="op">)</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(!</span><span class="va">$IP</span><span class="op">)</span> <span class="op">{</span><span class="va">$IP</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">IPAddress</span><span class="op">]::</span>Broadcast<span class="op">}</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="va">$SynchronizationChain</span> <span class="op">=</span> <span class="op">[</span><span class="dt">byte</span><span class="op">[]](,</span><span class="dv">0xFF</span> <span class="op">*</span> <span class="dv">6</span><span class="op">)</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="va">$ByteMac</span> <span class="op">=</span> <span class="va">$Mac</span><span class="op">.</span><span class="fu">Split</span><span class="op">(</span><span class="st">&quot;-&quot;</span><span class="op">)</span> <span class="op">|</span> <span class="op">%{[</span><span class="dt">byte</span><span class="op">](</span><span class="st">&quot;0x&quot;</span> <span class="op">+</span> <span class="va">$_</span><span class="op">)}</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="va">$Package</span> <span class="op">=</span> <span class="va">$SynchronizationChain</span> <span class="op">+</span> <span class="op">(</span><span class="va">$ByteMac</span> <span class="op">*</span> <span class="dv">16</span><span class="op">)</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="va">$UdpClient</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">Sockets</span><span class="op">.</span><span class="fu">UdpClient</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="va">$UdpClient</span><span class="op">.</span><span class="fu">Connect</span><span class="op">(</span><span class="va">$IP</span><span class="op">,</span> <span class="va">$port</span><span class="op">)</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="va">$UdpClient</span><span class="op">.</span><span class="fu">Send</span><span class="op">(</span><span class="va">$Package</span><span class="op">,</span> <span class="va">$Package</span><span class="op">.</span><span class="fu">Length</span><span class="op">)</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="va">$UdpClient</span><span class="op">.</span><span class="fu">Close</span><span class="op">()</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Send-WOL -Mac "D8-BB-C1-70-A3-4E"</code><br />
<code>Send-WOL -Mac "D8-BB-C1-70-A3-4E" -IP 192.168.3.100</code></p>
<h3 id="encoding">Encoding</h3>
<p><code>$ByteText = [System.Text.Encoding]::UTF8.GetBytes("password")</code><br />
<code>$Text = [System.Text.Encoding]::UTF8.GetString($ByteText)</code></p>
<h3 id="base64">Base64</h3>
<p><code>$text = "password"</code><br />
<code>$byte = [System.Text.Encoding]::Unicode.GetBytes($text)</code><br />
<code>$base64 = [System.Convert]::ToBase64String($byte)</code><br />
<code>$decode_base64 = [System.Convert]::FromBase64String($base64)</code><br />
<code>$decode_string = [System.Text.Encoding]::Unicode.GetString($decode_base64)</code></p>
<p><code>$path_image = "$home\Documents\1200x800.jpg"</code><br />
<code>$BBase64 = [System.Convert]::ToBase64String((Get-Content $path_image -Encoding Byte))</code><br />
<code>Add-Type -assembly System.Drawing</code><br />
<code>$Image = [System.Drawing.Bitmap]::FromStream([IO.MemoryStream][Convert]::FromBase64String($BBase64))</code><br />
<code>$Image.Save("$home\Desktop\1200x800.jpg")</code></p>
<h3 id="http-listener">HTTP Listener</h3>
<div class="sourceCode" id="cb72"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="va">$httpListener</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">HttpListener</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="va">$httpListener</span><span class="op">.</span><span class="fu">Prefixes</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="st">&quot;http://+:8888/&quot;</span><span class="op">)</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="va">$httpListener</span><span class="op">.</span><span class="fu">Start</span><span class="op">()</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(!([</span>console<span class="op">]::</span>KeyAvailable<span class="op">))</span> <span class="op">{</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="va">$info</span> <span class="op">=</span> <span class="fu">Get-Service</span> <span class="op">|</span> <span class="fu">select</span> name<span class="op">,</span>status <span class="op">|</span> <span class="fu">ConvertTo-HTML</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="va">$context</span> <span class="op">=</span> <span class="va">$httpListener</span><span class="op">.</span><span class="fu">GetContext</span><span class="op">()</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="va">$context</span><span class="op">.</span><span class="fu">Response</span><span class="op">.</span><span class="fu">StatusCode</span> <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="va">$context</span><span class="op">.</span><span class="fu">Response</span><span class="op">.</span><span class="fu">ContentType</span> <span class="op">=</span> <span class="st">&#39;text/HTML&#39;</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="va">$WebContent</span> <span class="op">=</span> <span class="va">$info</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="va">$EncodingWebContent</span> <span class="op">=</span> <span class="op">[</span>Text<span class="op">.</span><span class="fu">Encoding</span><span class="op">]::</span>UTF8<span class="op">.</span><span class="fu">GetBytes</span><span class="op">(</span><span class="va">$WebContent</span><span class="op">)</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="va">$context</span><span class="op">.</span><span class="fu">Response</span><span class="op">.</span><span class="fu">OutputStream</span><span class="op">.</span><span class="fu">Write</span><span class="op">(</span><span class="va">$EncodingWebContent</span> <span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="va">$EncodingWebContent</span><span class="op">.</span><span class="fu">Length</span><span class="op">)</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="va">$context</span><span class="op">.</span><span class="fu">Response</span><span class="op">.</span><span class="fu">Close</span><span class="op">()</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>Get-NetTcpConnection <span class="op">-</span>LocalPort <span class="dv">8888</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="fu">Get-Date</span><span class="op">).</span><span class="fu">datetime</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="va">$httpListener</span><span class="op">.</span><span class="fu">Close</span><span class="op">()</span></span></code></pre></div>
<h3 id="webclient">WebClient</h3>
<p><code>[System.Net.WebClient] | Get-Member</code><br />
<code>(New-Object Net.WebClient).DownloadString("https://raw.githubusercontent.com/Lifailon/PowerShell-Commands/rsa/README.md")</code></p>
<h3 id="certificate">Certificate</h3>
<div class="sourceCode" id="cb73"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get-WebCertificate <span class="op">(</span><span class="va">$srv</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="va">$iwr</span> <span class="op">=</span> <span class="fu">iwr</span> <span class="va">$srv</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="va">$status_code</span> <span class="op">=</span> <span class="va">$iwr</span><span class="op">.</span><span class="fu">StatusCode</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="va">$status</span> <span class="op">=</span> <span class="va">$iwr</span><span class="op">.</span><span class="fu">BaseResponse</span><span class="op">.</span><span class="fu">StatusCode</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="va">$info</span> <span class="op">=</span> <span class="va">$iwr</span><span class="op">.</span><span class="fu">BaseResponse</span><span class="op">.</span><span class="fu">Server</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="va">$spm</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">ServicePointManager</span><span class="op">]::</span>FindServicePoint<span class="op">(</span><span class="va">$srv</span><span class="op">)</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="va">$date_end</span> <span class="op">=</span> <span class="va">$spm</span><span class="op">.</span><span class="fu">Certificate</span><span class="op">.</span><span class="fu">GetExpirationDateString</span><span class="op">()</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="va">$cert_name</span> <span class="op">=</span> <span class="op">(</span><span class="va">$spm</span><span class="op">.</span><span class="fu">Certificate</span><span class="op">.</span><span class="fu">Subject</span><span class="op">)</span> <span class="op">-replace</span> <span class="st">&quot;CN=&quot;</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="va">$cert_owner</span> <span class="op">=</span> <span class="op">(((</span><span class="va">$spm</span><span class="op">.</span><span class="fu">Certificate</span><span class="op">.</span><span class="fu">Issuer</span><span class="op">)</span> <span class="op">-split</span> <span class="st">&quot;, &quot;</span><span class="op">)</span> <span class="op">|</span> <span class="fu">where</span> <span class="op">{</span><span class="va">$_</span> <span class="op">-match</span> <span class="st">&quot;O=&quot;</span><span class="op">})</span> <span class="op">-replace</span> <span class="st">&quot;O=&quot;</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="va">$Collections</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Collections</span><span class="op">.</span><span class="fu">Generic</span><span class="op">.</span><span class="fu">List</span><span class="op">[</span>System<span class="op">.</span><span class="fu">Object</span><span class="op">]</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="va">$Collections</span><span class="op">.</span><span class="fu">Add</span><span class="op">([</span>PSCustomObject<span class="op">]</span>@<span class="op">{</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>Host <span class="op">=</span> <span class="va">$srv</span><span class="op">;</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>Server <span class="op">=</span> <span class="va">$info</span><span class="op">;</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>Status <span class="op">=</span>  <span class="va">$status</span><span class="op">;</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>StatusCode <span class="op">=</span> <span class="va">$status_code</span><span class="op">;</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>Certificate <span class="op">=</span> <span class="va">$cert_name</span><span class="op">;</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>Issued <span class="op">=</span> <span class="va">$cert_owner</span><span class="op">;</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="kw">End</span> <span class="op">=</span> <span class="va">$date_end</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="op">})</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="va">$Collections</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Get-WebCertificate https://google.com</code></p>
<h1 id="excel">Excel</h1>
<div class="sourceCode" id="cb74"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="va">$path</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Desktop\Services-to-Excel.xlsx&quot;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Excel</span> <span class="op">=</span> <span class="fu">New-Object</span> <span class="op">-</span>ComObject Excel<span class="op">.</span><span class="fu">Application</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Excel</span><span class="op">.</span><span class="fu">Visible</span> <span class="op">=</span> <span class="va">$false</span><span class="ch">` </span>–æ—Ç–∫–ª—é—á–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç–∏–µ GUI</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkBook</span> <span class="op">=</span> <span class="va">$Excel</span><span class="op">.</span><span class="fu">Workbooks</span><span class="op">.</span><span class="fu">Add</span><span class="op">()</span><span class="ch">` </span>–°–æ–∑–¥–∞—Ç—å –∫–Ω–∏–≥—É</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span> <span class="op">=</span> <span class="va">$ExcelWorkBook</span><span class="op">.</span><span class="fu">Worksheets</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">1</span><span class="op">)</span><span class="ch">` </span>–°–æ–∑–¥–∞—Ç—å –ª–∏—Å—Ç</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Name</span> <span class="op">=</span> <span class="st">&quot;Services&quot;</span><span class="ch">` </span>–∑–∞–¥–∞—Ç—å –∏–º—è –ª–∏—Å—Ç–∞</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Cells</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">)</span> <span class="op">=</span> <span class="st">&quot;Name service&quot;</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–¥–∞—Ç—å –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤:</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Cells</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">)</span> <span class="op">=</span> <span class="st">&quot;Description&quot;</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Cells</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">3</span><span class="op">)</span> <span class="op">=</span> <span class="st">&quot;Status&quot;</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Cells</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">4</span><span class="op">)</span> <span class="op">=</span> <span class="st">&quot;Startup type&quot;</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Rows</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">1</span><span class="op">).</span><span class="fu">Font</span><span class="op">.</span><span class="fu">Bold</span> <span class="op">=</span> <span class="va">$true</span><span class="ch">` </span>–≤—ã–¥–µ–ª–∏—Ç—å –∂–∏—Ä–Ω—ã–º —à—Ä–∏—Ñ—Ç–æ–º</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Rows</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">1</span><span class="op">).</span><span class="fu">Font</span><span class="op">.</span><span class="fu">size</span><span class="op">=</span><span class="dv">14</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="co"># –ó–∞–¥–∞—Ç—å —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–æ–∫:</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Columns</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">1</span><span class="op">).</span><span class="fu">ColumnWidth</span><span class="op">=</span><span class="dv">30</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Columns</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">2</span><span class="op">).</span><span class="fu">ColumnWidth</span><span class="op">=</span><span class="dv">80</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Columns</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">3</span><span class="op">).</span><span class="fu">ColumnWidth</span><span class="op">=</span><span class="dv">15</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Columns</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">4</span><span class="op">).</span><span class="fu">ColumnWidth</span><span class="op">=</span><span class="dv">25</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="va">$services</span> <span class="op">=</span>  <span class="fu">Get-Service</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="va">$counter</span> <span class="op">=</span> <span class="dv">2</span><span class="ch">` </span>–∑–∞–¥–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$service</span> <span class="kw">in</span> <span class="va">$services</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a><span class="va">$status</span> <span class="op">=</span> <span class="va">$service</span><span class="op">.</span><span class="fu">Status</span></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$status</span> <span class="op">-eq</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a><span class="va">$status_type</span> <span class="op">=</span> <span class="st">&quot;Stopped&quot;</span></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">elseif</span> <span class="op">(</span><span class="va">$status</span> <span class="op">-eq</span> <span class="dv">4</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a><span class="va">$status_type</span> <span class="op">=</span> <span class="st">&quot;Running&quot;</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a><span class="va">$Start</span> <span class="op">=</span> <span class="va">$service</span><span class="op">.</span><span class="fu">StartType</span></span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$Start</span> <span class="op">-eq</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a><span class="va">$start_type</span> <span class="op">=</span> <span class="st">&quot;Delayed start&quot;</span></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">elseif</span> <span class="op">(</span><span class="va">$Start</span> <span class="op">-eq</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a><span class="va">$start_type</span> <span class="op">=</span> <span class="st">&quot;Automatic&quot;</span></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">elseif</span> <span class="op">(</span><span class="va">$Start</span> <span class="op">-eq</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a><span class="va">$start_type</span> <span class="op">=</span> <span class="st">&quot;Manually&quot;</span></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">elseif</span> <span class="op">(</span><span class="va">$Start</span> <span class="op">-eq</span> <span class="dv">4</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a><span class="va">$start_type</span> <span class="op">=</span> <span class="st">&quot;Disabled&quot;</span></span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Columns</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">1</span><span class="op">).</span><span class="fu">Rows</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="va">$counter</span><span class="op">)</span> <span class="op">=</span> <span class="va">$service</span><span class="op">.</span><span class="fu">Name</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Columns</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">2</span><span class="op">).</span><span class="fu">Rows</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="va">$counter</span><span class="op">)</span> <span class="op">=</span> <span class="va">$service</span><span class="op">.</span><span class="fu">DisplayName</span></span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Columns</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">3</span><span class="op">).</span><span class="fu">Rows</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="va">$counter</span><span class="op">)</span> <span class="op">=</span> <span class="va">$status_type</span></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Columns</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">4</span><span class="op">).</span><span class="fu">Rows</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="va">$counter</span><span class="op">)</span> <span class="op">=</span> <span class="va">$start_type</span></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$status_type</span> <span class="op">-eq</span> <span class="st">&quot;Running&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Columns</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">3</span><span class="op">).</span><span class="fu">Rows</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="va">$counter</span><span class="op">).</span><span class="fu">Font</span><span class="op">.</span><span class="fu">Bold</span> <span class="op">=</span> <span class="va">$true</span></span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a><span class="va">$counter</span><span class="op">++</span><span class="ch">` </span><span class="op">+</span><span class="dv">1</span> —É–≤–µ–ª–∏—á–∏—Ç—å –¥–ª—è —Å—á–µ—Ç—á–∏–∫–∞ —Å—Ç—Ä–æ–∫–∏ Rows</span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkBook</span><span class="op">.</span><span class="fu">SaveAs</span><span class="op">(</span><span class="va">$path</span><span class="op">)</span></span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkBook</span><span class="op">.</span><span class="fu">close</span><span class="op">(</span><span class="va">$true</span><span class="op">)</span></span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a><span class="va">$Excel</span><span class="op">.</span><span class="fu">Quit</span><span class="op">()</span></span></code></pre></div>
<h3 id="excel.application.open">Excel.Application.Open</h3>
<div class="sourceCode" id="cb75"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="va">$path</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Desktop\Services-to-Excel.xlsx&quot;</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Excel</span> <span class="op">=</span> <span class="fu">New-Object</span> <span class="op">-</span>ComObject Excel<span class="op">.</span><span class="fu">Application</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Excel</span><span class="op">.</span><span class="fu">Visible</span> <span class="op">=</span> <span class="va">$false</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkBook</span> <span class="op">=</span> <span class="va">$excel</span><span class="op">.</span><span class="fu">Workbooks</span><span class="op">.</span><span class="fu">Open</span><span class="op">(</span><span class="va">$path</span><span class="op">)</span><span class="ch">` </span>–æ—Ç–∫—Ä—ã—Ç—å xlsx-—Ñ–∞–π–ª</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkBook</span><span class="op">.</span><span class="fu">Sheets</span> <span class="op">|</span> <span class="fu">select</span> Name<span class="op">,</span>Index<span class="ch">` </span>–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ª–∏—Å—Ç—ã</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="va">$ExcelWorkSheet</span> <span class="op">=</span> <span class="va">$ExcelWorkBook</span><span class="op">.</span><span class="fu">Sheets</span><span class="op">.</span><span class="fu">Item</span><span class="op">(</span><span class="dv">1</span><span class="op">)</span><span class="ch">` </span>–æ—Ç–∫—Ä—ã—Ç—å –ª–∏—Å—Ç –ø–æ –Ω–æ–º–µ—Ä—É Index</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">..</span><span class="dv">100</span> <span class="op">|</span> <span class="op">%{</span><span class="va">$ExcelWorkSheet</span><span class="op">.</span><span class="fu">Range</span><span class="op">(</span><span class="st">&quot;A</span><span class="va">$_</span><span class="st">&quot;</span><span class="op">).</span><span class="fu">Text</span><span class="op">}</span><span class="ch">` </span>–ø—Ä–æ—á–∏—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ –ê —Å—Ç—Ä–æ–∫–∏ c <span class="dv">1</span> –ø–æ <span class="dv">100</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="va">$Excel</span><span class="op">.</span><span class="fu">Quit</span><span class="op">()</span></span></code></pre></div>
<h3 id="importexcel">ImportExcel</h3>
<p><code>Install-Module -Name ImportExcel</code><br />
<code>$data | Export-Excel .\Data.xlsx</code><br />
<code>$data = Import-Excel .\Data.xlsx</code></p>
<p><code>$data = ps</code><br />
<code>$Chart = New-ExcelChartDefinition -XRange CPU -YRange WS -Title "Process" -NoLegend</code><br />
<code>$data | Export-Excel .\ps.xlsx -AutoNameRange -ExcelChartDefinition $Chart -Show</code></p>
<h1 id="csv">CSV</h1>
<p><code>Get-Service | Select Name,DisplayName,Status,StartType | Export-Csv -path "$home\Desktop\Get-Service.csv" -Append -Encoding Default</code>
—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ csv (-Encoding UTF8)<br />
<code>Import-Csv "$home\Desktop\Get-Service.csv" -Delimiter ","</code>
–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤</p>
<div class="sourceCode" id="cb76"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="va">$data</span> <span class="op">=</span> <span class="fu">ConvertFrom-Csv</span> <span class="vs">@&quot;</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="vs">Region,State,Units,Price</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="vs">West,Texas,927,923.71</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="va">$null</span><span class="vs">,Tennessee,466,770.67</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="vs">&quot;@</span></span></code></pre></div>
<p><code>$systeminfo = systeminfo /FO csv | ConvertFrom-Csv</code> –≤—ã–≤–æ–¥
—Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ CSV –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –æ–±—ä–µ–∫—Ç<br />
<code>$systeminfo."–ü–æ–ª–Ω—ã–π –æ–±—ä–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏"</code><br />
<code>$systeminfo."–î–æ—Å—Ç—É–ø–Ω–∞—è —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç—å"</code></p>
<h3 id="convertfrom-string">ConvertFrom-String</h3>
<div class="sourceCode" id="cb77"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="st">log = </span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="st">{</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="st">   level = 4;</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="st">};</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span> <span class="op">|</span> ConvertFrom-String<span class="ch">` </span>—Å–æ–∑–¥–∞–µ—Ç PSCustomObject <span class="op">(</span>—Ä–∞–∑–±–∏–≤–∞–µ—Ç –ø–æ –ø—Ä–æ–±–µ–ª–∞–º<span class="op">,</span> —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã –∏ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏<span class="op">)</span></span></code></pre></div>
<h3 id="convertfrom-stringdata">ConvertFrom-StringData</h3>
<div class="sourceCode" id="cb78"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="st">key1 = value1</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="st">key2 = value2</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">|</span> <span class="fu">ConvertFrom-StringData</span> <span class="co"># —Å–æ–∑–¥–∞–µ—Ç Hashtable</span></span></code></pre></div>
<h1 id="xml">XML</h1>
<div class="sourceCode" id="cb79"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="va">$xml</span> <span class="op">=</span> <span class="op">[</span>xml<span class="op">](</span><span class="fu">Get-Content</span> <span class="va">$home</span>\desktop\test<span class="op">.</span><span class="fu">rdg</span><span class="op">)</span><span class="ch">` </span>–ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ XML-—Ñ–∞–π–ª–∞</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="va">$xml</span><span class="op">.</span><span class="fu">load</span><span class="op">(</span><span class="st">&quot;</span><span class="va">$home</span><span class="st">\desktop\test.rdg&quot;</span><span class="op">)</span><span class="ch">` </span>–æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="va">$xml</span><span class="op">.</span><span class="fu">RDCMan</span><span class="op">.</span><span class="fu">file</span><span class="op">.</span><span class="fu">group</span><span class="op">.</span><span class="fu">properties</span><span class="op">.</span><span class="fu">name</span><span class="ch">` </span>–∏–º–µ–Ω–∞ –≥—Ä—É–ø–ø</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="va">$xml</span><span class="op">.</span><span class="fu">RDCMan</span><span class="op">.</span><span class="fu">file</span><span class="op">.</span><span class="fu">group</span><span class="op">.</span><span class="fu">server</span><span class="op">.</span><span class="fu">properties</span><span class="ch">` </span>–∏–º–µ–Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="va">$xml</span><span class="op">.</span><span class="fu">RDCMan</span><span class="op">.</span><span class="fu">file</span><span class="op">.</span><span class="fu">group</span><span class="op">[</span><span class="dv">3</span><span class="op">].</span><span class="fu">server</span><span class="op">.</span><span class="fu">properties</span><span class="ch">` </span>—Å–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ <span class="dv">4</span><span class="op">-</span>–π –≥—Ä—É–ø–ø–µ</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="va">$xml</span><span class="op">.</span><span class="fu">RDCMan</span><span class="op">.</span><span class="fu">file</span><span class="op">.</span><span class="fu">group</span><span class="op">[</span><span class="dv">3</span><span class="op">].</span><span class="fu">server</span><span class="op">.</span><span class="fu">properties</span> <span class="op">|</span> <span class="op">?</span> name <span class="op">-like</span> ADIRK<span class="op">).</span><span class="fu">Name</span> <span class="op">=</span> <span class="st">&quot;New-Name&quot;</span><span class="ch">` </span>–∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="va">$xml</span><span class="op">.</span><span class="fu">RDCMan</span><span class="op">.</span><span class="fu">file</span><span class="op">.</span><span class="fu">group</span><span class="op">[</span><span class="dv">3</span><span class="op">].</span><span class="fu">server</span><span class="op">[</span><span class="dv">0</span><span class="op">].</span><span class="fu">properties</span><span class="op">.</span><span class="fu">displayName</span> <span class="op">=</span> <span class="st">&quot;New-displayName&quot;</span> </span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="va">$xml</span><span class="op">.</span><span class="fu">RDCMan</span><span class="op">.</span><span class="fu">file</span><span class="op">.</span><span class="fu">group</span><span class="op">[</span><span class="dv">3</span><span class="op">].</span><span class="fu">server</span><span class="op">[</span><span class="dv">1</span><span class="op">].</span><span class="fu">RemoveAll</span><span class="op">()</span><span class="ch">` </span>—É–¥–∞–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç <span class="op">(</span><span class="dv">2</span><span class="op">-</span>–π —Å–µ—Ä–≤–µ—Ä –≤ —Å–ø–∏—Å–∫–µ<span class="op">)</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="va">$xml</span><span class="op">.</span><span class="fu">Save</span><span class="op">(</span><span class="va">$file</span><span class="op">)</span><span class="ch">` </span>—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–±—ä–µ–∫—Ç–∞ –≤ —Ñ–∞–π–ª–∞</span></code></pre></div>
<p><code>Get-Service | Export-Clixml -path $home\desktop\test.xml</code>
—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç PowerShell –≤ XML<br />
<code>Import-Clixml -Path $home\desktop\test.xml</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
–æ–±—ä–µ–∫—Ç XML –≤ PowerShell<br />
<code>ConvertTo-Xml (Get-Service)</code></p>
<h3 id="get-credtoxml">Get-CredToXML</h3>
<div class="sourceCode" id="cb80"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get-CredToXML <span class="op">{</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span> <span class="op">(</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">$CredFile</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Documents\cred.xml&quot;</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="fu">Test-Path</span> <span class="va">$CredFile</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Import-Clixml</span> <span class="op">-</span>path <span class="va">$CredFile</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elseif</span> <span class="op">(!(</span><span class="fu">Test-Path</span> <span class="va">$CredFile</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Cred</span> <span class="op">=</span> <span class="fu">Get-Credential</span> <span class="op">-</span>Message <span class="st">&quot;Enter credential&quot;</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="va">$Cred</span> <span class="op">-ne</span> <span class="va">$null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Cred</span> <span class="op">|</span> <span class="fu">Export-CliXml</span> <span class="op">-</span>Path <span class="va">$CredFile</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Cred</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>$Cred = Get-CredToXML</code><br />
<code>$Login = $Cred.UserName</code><br />
<code>$PasswordText = $Cred.GetNetworkCredential().password</code>
–ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–µ</p>
<h3 id="xmlwriter-extensible-markup-language">XmlWriter (Extensible
Markup Language)</h3>
<div class="sourceCode" id="cb81"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="va">$XmlWriterSettings</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Xml</span><span class="op">.</span><span class="fu">XmlWriterSettings</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="va">$XmlWriterSettings</span><span class="op">.</span><span class="fu">Indent</span> <span class="op">=</span> <span class="va">$true</span><span class="ch">` </span>–≤–∫–ª—é—á–∏—Ç—å –æ—Ç—Å—Ç—É–ø—ã</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="va">$XmlWriterSettings</span><span class="op">.</span><span class="fu">IndentChars</span> <span class="op">=</span> <span class="st">&quot;    &quot;</span><span class="ch">` </span>–∑–∞–¥–∞—Ç—å –æ—Ç—Å—Ç—É–ø</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="va">$XmlFilePath</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\desktop\test.xml&quot;</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="va">$XmlObjectWriter</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">XML</span><span class="op">.</span><span class="fu">XmlWriter</span><span class="op">]::</span>Create<span class="op">(</span><span class="va">$XmlFilePath</span><span class="op">,</span> <span class="va">$XmlWriterSettings</span><span class="op">)</span><span class="ch">` </span>—Å–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">WriteStartDocument</span><span class="op">()</span><span class="ch">` </span>–Ω–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å –≤ –¥–æ–∫—É–º–µ–Ω—Ç</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">WriteComment</span><span class="op">(</span><span class="st">&quot;Comment&quot;</span><span class="op">)</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">WriteStartElement</span><span class="op">(</span><span class="st">&quot;Root&quot;</span><span class="op">)</span><span class="ch">` </span>—Å–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç<span class="op">,</span> –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ—á–µ—Ä–Ω–∏–µ –æ–±—ä–µ–∫—Ç—ã</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>    <span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">WriteStartElement</span><span class="op">(</span><span class="st">&quot;Configuration&quot;</span><span class="op">)</span><span class="ch">` </span>—Å–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –¥–æ—á–µ—Ä–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è BaseSettings</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">WriteElementString</span><span class="op">(</span><span class="st">&quot;Language&quot;</span><span class="op">,</span><span class="st">&quot;RU&quot;</span><span class="op">)</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">WriteStartElement</span><span class="op">(</span><span class="st">&quot;Fonts&quot;</span><span class="op">)</span>         <span class="co"># &lt;Fonts&gt;</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">WriteElementString</span><span class="op">(</span><span class="st">&quot;Name&quot;</span><span class="op">,</span><span class="st">&quot;Arial&quot;</span><span class="op">)</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>            <span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">WriteElementString</span><span class="op">(</span><span class="st">&quot;Size&quot;</span><span class="op">,</span><span class="st">&quot;12&quot;</span><span class="op">)</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">WriteEndElement</span><span class="op">()</span>                  <span class="co"># &lt;/Fonts&gt;</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>    <span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">WriteEndElement</span><span class="op">()</span><span class="ch">` </span>–∫–æ–Ω–µ—á–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç <span class="op">&lt;/</span>Configuration<span class="op">&gt;</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">WriteEndElement</span><span class="op">()</span><span class="ch">` </span>–∫–æ–Ω–µ—á–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç <span class="op">&lt;/</span>Root<span class="op">&gt;</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">WriteEndDocument</span><span class="op">()</span><span class="ch">` </span>–∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –¥–æ–∫—É–º–µ–Ω—Ç</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a><span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">Flush</span><span class="op">()</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="va">$XmlObjectWriter</span><span class="op">.</span><span class="fu">Close</span><span class="op">()</span></span></code></pre></div>
<h3 id="createelement">CreateElement</h3>
<div class="sourceCode" id="cb82"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="va">$xml</span> <span class="op">=</span> <span class="op">[</span>xml<span class="op">](</span><span class="fu">gc</span> <span class="va">$home</span>\desktop\test<span class="op">.</span><span class="fu">xml</span><span class="op">)</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="va">$xml</span><span class="op">.</span><span class="fu">Root</span><span class="op">.</span><span class="fu">Configuration</span><span class="op">.</span><span class="fu">Fonts</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="va">$NewElement</span> <span class="op">=</span> <span class="va">$xml</span><span class="op">.</span><span class="fu">CreateElement</span><span class="op">(</span><span class="st">&quot;Fonts&quot;</span><span class="op">)</span><span class="ch">` </span>–≤—ã–±—Ä–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∫—É–¥–∞ –¥–æ–±–∞–≤–∏—Ç—å</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="va">$NewElement</span><span class="op">.</span><span class="fu">set_InnerXML</span><span class="op">(</span><span class="st">&quot;&lt;Name&gt;Times New Roman&lt;/Name&gt;&lt;Size&gt;14&lt;/Size&gt;&quot;</span><span class="op">)</span><span class="ch">` </span>–ó–∞–ø–æ–ª–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –¥–æ—á–µ—Ä–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã Fonts</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="va">$xml</span><span class="op">.</span><span class="fu">Root</span><span class="op">.</span><span class="fu">Configuration</span><span class="op">.</span><span class="fu">AppendChild</span><span class="op">(</span><span class="va">$NewElement</span><span class="op">)</span><span class="ch">` </span>–¥–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–æ–π –≤ Configuration <span class="op">(</span>—Ä–æ–¥–∏—Ç–µ–ª—å Fonts<span class="op">)</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="va">$xml</span><span class="op">.</span><span class="fu">Save</span><span class="op">(</span><span class="st">&quot;</span><span class="va">$home</span><span class="st">\desktop\test.xml&quot;</span><span class="op">)</span></span></code></pre></div>
<h1 id="json">JSON</h1>
<div class="sourceCode" id="cb83"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="va">$log</span> <span class="op">=</span> <span class="st">&#39;</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="st">{</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;log&quot;: {</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;level&quot;: 7</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span> <span class="op">|</span> <span class="fu">ConvertFrom-Json</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Service</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="va">$OOKLA</span>  <span class="op">=</span> <span class="st">&#39;</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="st">{</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;result&quot; : </span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="st">{&quot;date&quot;:1683534970,&quot;id&quot;:&quot;14708271987&quot;,&quot;connection_icon&quot;:&quot;wireless&quot;,&quot;download&quot;:33418,&quot;upload&quot;:35442,&quot;latency&quot;:15,&quot;distance&quot;:50,&quot;country_code&quot;:&quot;RU&quot;,&quot;server_id&quot;:2707,&quot;server_name&quot;:&quot;Bryansk&quot;,&quot;sponsor_name&quot;:&quot;DOM.RU&quot;,&quot;sponsor_url&quot;:null,&quot;connection_mode&quot;:&quot;multi&quot;,&quot;isp_name&quot;:&quot;Resource Link&quot;,&quot;isp_rating&quot;:&quot;4.0&quot;,&quot;test_rank&quot;:63,&quot;test_grade&quot;:&quot;B-&quot;,&quot;test_rating&quot;:4,&quot;idle_latency&quot;:&quot;17&quot;,&quot;download_latency&quot;:&quot;116&quot;,&quot;upload_latency&quot;:&quot;75&quot;,&quot;additional_servers&quot;:</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="st">[{&quot;server_id&quot;:8191,&quot;server_name&quot;:&quot;Bryansk&quot;,&quot;sponsor_name&quot;:&quot;SectorTelecom.ru&quot;},{&quot;server_id&quot;:46278,&quot;server_name&quot;:&quot;Fokino&quot;,&quot;sponsor_name&quot;:&quot;Fokks - Promyshlennaya avtomatika Ltd.&quot;},{&quot;server_id&quot;:18218,&quot;server_name&quot;:&quot;Bryansk&quot;,&quot;sponsor_name&quot;:&quot;RIA-link Ltd.&quot;}],</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;path&quot;:&quot;result\u002F14708271987&quot;,&quot;hasSecondary&quot;:true</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span> <span class="op">|</span> <span class="fu">ConvertFrom-Json</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a><span class="va">$ookla</span><span class="op">.</span><span class="fu">result</span></span></code></pre></div>
<h1 id="yaml">YAML</h1>
<div class="sourceCode" id="cb84"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Import-Module</span> PSYaml<span class="ch">` </span>–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Docker<span class="op">/</span>Ansible</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="va">$netplan</span> <span class="op">=</span> <span class="st">&quot;</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="st">network:</span><span class="ch">` </span><span class="st">—Å–ª–æ–≤–∞—Ä—å –ø–æ —Ç–∏–ø—É - –∫–ª—é—á : –∑–Ω–∞—á–µ–Ω–∏–µ —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Å–ª–æ–≤–∞—Ä—è–º–∏</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="st">  ethernets:</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="st">    ens160:</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="st">      dhcp4: yes</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="st">      dhcp6: no</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="st">      nameservers:</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="st">        addresses:</span><span class="ch">` </span><span class="st">[8.8.8.8, 1.1.1.1]</span><span class="ch">` </span><span class="st">—Å–ø–∏—Å–æ–∫ –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–∫)</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="st">          - 8.8.8.8</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="st">          - 1.1.1.1</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="st">  version: 2</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="va">$network</span> <span class="op">=</span> ConvertFrom-Yaml <span class="va">$netplan</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="va">$network</span><span class="op">.</span><span class="fu">Values</span><span class="op">.</span><span class="fu">ethernets</span><span class="op">.</span><span class="fu">ens160</span><span class="op">.</span><span class="fu">nameservers</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="va">$DataType</span> <span class="op">=</span> <span class="st">&quot;</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="st">int: !!int 10.1</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="st">flo: !!float 10.1</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a><span class="st">str: !!str string</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a><span class="st">bool: !!bool</span><span class="ch">` </span><span class="st">boolean</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<h1 id="html">HTML</h1>
<h3 id="convertfrom-html">ConvertFrom-Html</h3>
<div class="sourceCode" id="cb85"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> ConvertFrom-Html <span class="op">{</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span> <span class="op">(</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>Parameter<span class="op">(</span>ValueFromPipeline<span class="op">)]</span><span class="va">$url</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">$irm</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="va">$url</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">$HTMLFile</span> <span class="op">=</span> <span class="fu">New-Object</span> <span class="op">-</span>ComObject HTMLFile</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">$Bytes</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Text</span><span class="op">.</span><span class="fu">Encoding</span><span class="op">]::</span>Unicode<span class="op">.</span><span class="fu">GetBytes</span><span class="op">(</span><span class="va">$irm</span><span class="op">)</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>    <span class="va">$HTMLFile</span><span class="op">.</span><span class="fu">write</span><span class="op">(</span><span class="va">$Bytes</span><span class="op">)</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">(</span><span class="va">$HTMLFile</span><span class="op">.</span><span class="fu">all</span> <span class="op">|</span> <span class="fu">where</span> <span class="op">{</span><span class="va">$_</span><span class="op">.</span><span class="fu">tagname</span> <span class="op">-eq</span> <span class="st">&quot;body&quot;</span><span class="op">}).</span><span class="fu">innerText</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="va">$apache_status</span> <span class="op">=</span> <span class="st">&quot;http://192.168.3.102/server-status&quot;</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="va">$apache_status</span> <span class="op">|</span> ConvertFrom-Html</span></code></pre></div>
<h3 id="convertto-html">ConvertTo-Html</h3>
<p><code>Get-Process | select Name, CPU | ConvertTo-Html -As Table &gt; "$home\desktop\proc-table.html"</code>
–≤—ã–≤–æ–¥ –≤ —Ñ–æ—Ä–º–∞—Ç–µ List (Format-List) –∏–ª–∏ Table (Format-Table)</p>
<div class="sourceCode" id="cb86"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="va">$servers</span> <span class="op">=</span> <span class="st">&quot;ya.ru&quot;</span><span class="op">,</span><span class="st">&quot;ya.com&quot;</span><span class="op">,</span><span class="st">&quot;google.com&quot;</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="va">$path</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Desktop\Ping.html&quot;</span> </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="va">$header</span> <span class="op">=</span> <span class="vs">@&quot;</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; lang=&quot;en&quot; xml:lang=&quot;en&quot;&gt;</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;head&gt;</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;title&gt;–û—Ç—á–µ—Ç –æ —Å—Ç–∞—Ç—É—Å–µ —Å–µ—Ä–≤–µ—Ä–æ–≤&lt;/title&gt;</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;style type=&quot;text/css&quot;&gt;</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;!--</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="vs">body {</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="vs">background-color: #E0E0E0;</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="vs">font-family: sans-serif</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="vs">table, th, td {</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="vs">background-color: white;</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="vs">border-collapse:collapse;</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="vs">border: 1px solid black;</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="vs">padding: 5px</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="vs">--&gt;</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="vs">&quot;@</span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="va">$body</span> <span class="op">=</span> <span class="vs">@&quot;</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;h1&gt;Ping status&lt;/h1&gt;</span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;p&gt;</span><span class="op">$(</span><span class="fu">get-date</span> <span class="op">-</span>Format <span class="st">&quot;dd.MM.yyyy hh:mm&quot;</span><span class="op">)</span><span class="vs">.&lt;/p&gt;</span></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a><span class="vs">&quot;@</span></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a><span class="va">$results</span> <span class="op">=</span> <span class="cf">foreach</span> <span class="op">(</span><span class="va">$server</span> <span class="kw">in</span> <span class="va">$servers</span><span class="op">)</span> <span class="op">{</span> </span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="fu">Test-Connection</span> <span class="va">$server</span> <span class="op">-</span>Count <span class="dv">1</span> <span class="op">-</span>ea <span class="dv">0</span> <span class="op">-</span>Quiet<span class="op">)</span> <span class="op">{</span> </span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">$status</span> <span class="op">=</span> <span class="st">&quot;Up&quot;</span> </span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span> </span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">$status</span> <span class="op">=</span> <span class="st">&quot;Down&quot;</span></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>PSCustomObject<span class="op">]</span>@<span class="op">{</span></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>        Name <span class="op">=</span> <span class="va">$server</span></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>        Status <span class="op">=</span> <span class="va">$status</span></span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a><span class="va">$results</span> <span class="op">|</span> <span class="fu">ConvertTo-Html</span> <span class="op">-</span>head <span class="va">$header</span> <span class="op">-</span>body <span class="va">$body</span> <span class="op">|</span> <span class="cf">foreach</span> <span class="op">{</span></span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>    <span class="va">$_</span> <span class="op">-replace</span> <span class="st">&quot;&lt;td&gt;Down&lt;/td&gt;&quot;</span><span class="op">,</span><span class="st">&quot;&lt;td style=&#39;background-color:#FF8080&#39;&gt;Down&lt;/td&gt;&quot;</span> <span class="op">-replace</span> <span class="st">&quot;&lt;td&gt;Up&lt;/td&gt;&quot;</span><span class="op">,</span><span class="st">&quot;&lt;td style=&#39;background-color:#5BCCF3&#39;&gt;Up&lt;/td&gt;&quot;</span></span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="op">|</span> <span class="fu">Out-File</span> <span class="va">$path</span></span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a><span class="fu">Invoke-Item</span> <span class="va">$path</span></span></code></pre></div>
<h3 id="pswritehtml">PSWriteHTML</h3>
<div class="sourceCode" id="cb87"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Import-Module</span> PSWriteHTML</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="fu">Get-Module</span> PSWriteHTML<span class="op">).</span><span class="fu">ExportedCommands</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Service</span> <span class="op">|</span> Out-GridHtml <span class="op">-</span>FilePath <span class="op">~</span>\Desktop\Get-Service-Out-GridHtml<span class="op">.</span><span class="fu">html</span></span></code></pre></div>
<h3 id="htmlreport">HtmlReport</h3>
<div class="sourceCode" id="cb88"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Import-Module</span> HtmlReport</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="va">$topVM</span> <span class="op">=</span> <span class="fu">ps</span> <span class="op">|</span> <span class="fu">Sort</span> PrivateMemorySize <span class="op">-</span>Descending <span class="op">|</span> <span class="fu">Select</span> <span class="op">-</span>First <span class="dv">10</span> <span class="op">|</span> <span class="op">%{,@((</span><span class="va">$_</span><span class="op">.</span><span class="fu">ProcessName</span> <span class="op">+</span> <span class="st">&quot; &quot;</span> <span class="op">+</span> <span class="va">$_</span><span class="op">.</span><span class="fu">Id</span><span class="op">),</span> <span class="va">$_</span><span class="op">.</span><span class="fu">PrivateMemorySize</span><span class="op">)}</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="va">$topCPU</span> <span class="op">=</span> <span class="fu">ps</span> <span class="op">|</span> <span class="fu">Sort</span> CPU <span class="op">-</span>Descending <span class="op">|</span> <span class="fu">Select</span> <span class="op">-</span>First <span class="dv">10</span> <span class="op">|</span> <span class="op">%{,@((</span><span class="va">$_</span><span class="op">.</span><span class="fu">ProcessName</span> <span class="op">+</span> <span class="st">&quot; &quot;</span> <span class="op">+</span> <span class="va">$_</span><span class="op">.</span><span class="fu">Id</span><span class="op">),</span> <span class="va">$_</span><span class="op">.</span><span class="fu">CPU</span><span class="op">)}</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>New-Report <span class="op">-</span>Title <span class="st">&quot;Piggy Processes&quot;</span> <span class="op">-</span>Input <span class="op">{</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>New-Chart Bar <span class="st">&quot;Top VM Users&quot;</span> <span class="op">-</span>input <span class="va">$topVm</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>New-Chart Column <span class="st">&quot;Top CPU Overall&quot;</span> <span class="op">-</span>input <span class="va">$topCPU</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ps</span> <span class="op">|</span> <span class="fu">Select</span> ProcessName<span class="op">,</span> Id<span class="op">,</span> CPU<span class="op">,</span> WorkingSet<span class="op">,</span> <span class="op">*</span>MemorySize <span class="op">|</span> New-Table <span class="st">&quot;All Processes&quot;</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="op">&gt;</span> <span class="op">~</span>\Desktop\Get-Process-HtmlReport<span class="op">.</span><span class="fu">html</span></span></code></pre></div>
<h1 id="sqlite">SQLite</h1>
<div class="sourceCode" id="cb89"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="va">$path</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Documents\Get-Service.db&quot;</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Module</span> <span class="op">=</span> <span class="fu">Get-Module</span> MySQLite</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$Module</span> <span class="op">-eq</span> <span class="va">$null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>Install-Module MySQLite <span class="op">-</span>Repository PSGallery <span class="op">-</span>Scope CurrentUser</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Import-Module</span> MySQLite</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>New-MySQLiteDB <span class="op">-</span>Path <span class="va">$path</span> <span class="co"># —Å–æ–∑–¥–∞—Ç—å –ë–î</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>Invoke-MySQLiteQuery <span class="op">-</span>Path <span class="va">$path</span> <span class="op">-</span>Query <span class="st">&quot;CREATE TABLE Service (Name TEXT NOT NULL, DisplayName TEXT NOT NULL, Status TEXT NOT NULL);&quot;</span> <span class="co"># —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="va">$Service</span> <span class="op">=</span> <span class="fu">Get-Service</span> <span class="op">|</span> <span class="fu">select</span> Name<span class="op">,</span>DisplayName<span class="op">,</span>Status</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$S</span> <span class="kw">in</span> <span class="va">$Service</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="va">$Name</span> <span class="op">=</span> <span class="va">$S</span><span class="op">.</span><span class="fu">Name</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="va">$DName</span> <span class="op">=</span> <span class="va">$S</span><span class="op">.</span><span class="fu">DisplayName</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="va">$Status</span> <span class="op">=</span> <span class="va">$S</span><span class="op">.</span><span class="fu">Status</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>Invoke-MySQLiteQuery <span class="op">-</span>Path <span class="va">$path</span> <span class="op">-</span>Query <span class="st">&quot;INSERT INTO Service (Name, DisplayName, Status) VALUES (&#39;</span><span class="va">$Name</span><span class="st">&#39;, &#39;</span><span class="va">$DName</span><span class="st">&#39;, &#39;</span><span class="va">$Status</span><span class="st">&#39;);&quot;</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>(Get-MySQLiteDB $path).Tables</code> —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ<br />
<code>Invoke-MySQLiteQuery -Path $path -Query "SELECT name FROM sqlite_master WHERE type='table';"</code>
—Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ<br />
<code>Invoke-MySQLiteQuery -Path $path -Query "DROP TABLE Service;"</code>
—É–¥–∞–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É</p>
<div class="sourceCode" id="cb90"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="va">$TableName</span> <span class="op">=</span> <span class="st">&quot;Service&quot;</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>Invoke-MySQLiteQuery <span class="op">-</span>Path <span class="va">$path</span> <span class="op">-</span>Query <span class="st">&quot;SELECT * FROM </span><span class="va">$TableName</span><span class="st">&quot;</span> <span class="co"># –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–∞–±–ª–∏—Ü—ã (–≤ —Ñ–æ—Ä–º–∞—Ç–µ –æ–±—ä–µ–∫—Ç–∞)</span></span></code></pre></div>
<p><code>Get-Service | select  Name,DisplayName,Status | ConvertTo-MySQLiteDB -Path $path -TableName Service -force</code>
–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –≤ —Ç–∞–±–ª–∏—Ü—É</p>
<h3 id="database-password">Database password</h3>
<div class="sourceCode" id="cb91"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="va">$Connection</span> <span class="op">=</span> New-SQLiteConnection <span class="op">-</span>DataSource <span class="va">$path</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Connection</span><span class="op">.</span><span class="fu">ChangePassword</span><span class="op">(</span><span class="st">&quot;password&quot;</span><span class="op">)</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Connection</span><span class="op">.</span><span class="fu">Close</span><span class="op">()</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>Invoke-SqliteQuery <span class="op">-</span>Query <span class="st">&quot;SELECT * FROM Service&quot;</span> <span class="op">-</span>DataSource <span class="st">&quot;</span><span class="va">$path</span><span class="st">;Password=password&quot;</span></span></code></pre></div>
<h1 id="mysql">MySQL</h1>
<p><code>apt -y install mysql-server mysql-client</code><br />
<code>mysql -V</code><br />
<code>systemctl status mysql</code><br />
<code>mysqladmin -u root password</code> –∑–∞–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å root</p>
<p><code>nano /etc/mysql/mysql.conf.d/mysqld.cnf</code></p>
<pre><code>[mysqld]
user            = mysql
# pid-file      = /var/run/mysqld/mysqld.pid
# socket        = /var/run/mysqld/mysqld.sock
# port          = 3306
# datadir       = /var/lib/mysql
# tmpdir                = /tmp
bind-address            = 0.0.0.0
mysqlx-bind-address     = 0.0.0.0
log_error = /var/log/mysql/error.log</code></pre>
<p><code>systemctl restart mysql</code><br />
<code>ss -tulnp | grep 3306</code><br />
<code>ufw allow 3306/tcp</code><br />
<code>nc -zv 192.168.1.253 3306</code><br />
<code>tnc 192.168.1.253 -p 3306</code></p>
<p><code>mysql -u root -p</code><br />
<code>SELECT user(), now(), version();</code><br />
<code>quit;</code></p>
<p><code>mysql -u root -p -e 'SHOW TABLES FROM db_aduser;'</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –±–µ–∑ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–æ–Ω—Å–æ–ª–∏ MySQL</p>
<p><code>CREATE</code> —Å–æ–∑–¥–∞—Ç—å –ë–î, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ç–∞–±–ª–∏—Ü—É<br />
<code>ALTER</code> —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Ç–∞–±–ª–∏—Ü–µ<br />
<code>DROP</code> —É–¥–∞–ª–∏—Ç—å –ë–î, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ç–∞–±–ª–∏—Ü—É<br />
<code>USE</code> –≤—ã–±—Ä–∞—Ç—å –ë–î<br />
<code>SHOW</code> –≤—ã–≤–µ—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ë–î, –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (GRANTS),
–Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞<br />
<code>GRANT</code> –¥–∞—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∫ –ë–î<br />
<code>REVOKE</code> —É–¥–∞–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –ë–î<br />
<code>UPDATE</code> –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞, –∑–Ω–∞—á–µ–Ω–∏—è —Å —Ç–∞–±–ª–∏—Ü–µ<br />
<code>FLUSH</code> –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞<br />
<code>SELECT</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –ë–î, –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ<br />
<code>INSERT</code> –≤–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ<br />
<code>DELETE</code> —É–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ (FROM) —Ç–∞–±–ª–∏—Ü–µ</p>
<h3 id="data-type">DATA TYPE</h3>
<p><code>VARCHAR(N)</code> —Å—Ç—Ä–æ–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã, –≤ —Ñ–æ—Ä–º–∞—Ç–µ ASCII, –≥–¥–µ
–æ–¥–∏–Ω —Å–∏–º–≤–æ–ª –∑–∞–Ω–∏–º–∞–µ—Ç 1 –±–∞–π—Ç, —á–∏—Å–ª–æ–º N —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–∞—è
–¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏<br />
<code>NVARCHAR(N)</code> —Å—Ç—Ä–æ–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã, –≤ —Ñ–æ—Ä–º–∞—Ç–µ Unicode, –≥–¥–µ
–æ–¥–∏–Ω —Å–∏–º–≤–æ–ª –∑–∞–Ω–∏–º–∞–µ—Ç 2 –±–∞–π—Ç–∞<br />
<code>CHAR(N)/nchar(N)</code> —Å—Ç—Ä–æ–∫–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã, –∫–æ—Ç–æ—Ä–∞—è –≤—Å–µ–≥–¥–∞
–¥–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–ø—Ä–∞–≤–∞ –ø—Ä–æ–±–µ–ª–∞–º–∏ –¥–æ –¥–ª–∏–Ω—ã N –∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –æ–Ω–∞ –∑–∞–Ω–∏–º–∞–µ—Ç
—Ä–æ–≤–Ω–æ N —Å–∏–º–≤–æ–ª–æ–≤<br />
<code>INT</code> —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –æ—Ç -2147483648 –¥–æ 2147483647, –∑–∞–Ω–∏–º–∞–µ—Ç 4
–±–∞–π—Ç–∞<br />
<code>FLOAT</code> —á–∏—Å–ª–æ, –≤ –∫–æ—Ç–æ—Ä–æ–º –º–æ–∂–µ—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –¥–µ—Å—è—Ç–∏—á–Ω–∞—è
—Ç–æ—á–∫–∞ (–∑–∞–ø—è—Ç–∞—è)<br />
<code>BIT</code> —Ñ–ª–∞–≥, –î–∞ - 1 –∏–ª–∏ –ù–µ—Ç - 0<br />
<code>DATE</code> —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä 25.05.2023<br />
<code>TIME</code> 23:30:55.1234567<br />
<code>DATETIME</code> 25.05.2023 23:30:55.1234567</p>
<h3 id="database-1">DATABASE</h3>
<pre><code>SHOW databases;                                                                     # –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –ë–î
CREATE DATABASE db_aduser;                                                          # —Å–æ–∑–¥–∞—Ç—å –ë–î
CREATE DATABASE db_rep DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;  # —Å–æ–∑–¥–∞—Ç—å –ë–î —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π UTF-8
DROP DATABASE db_rep;                                                               # —É–¥–∞–ª–∏—Ç—å –ë–î
USE db_aduser;                                                                      # –≤—ã–±—Ä–∞—Ç—å/–ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –ë–î
SELECT database();                                                                  # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –ë–î</code></pre>
<h3 id="user">USER</h3>
<pre><code>SELECT USER,HOST FROM mysql.user;                                     # –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –£–ó
CREATE USER posh@localhost IDENTIFIED BY &#39;1qaz!QAZ&#39;;                  # —Å–æ–∑–¥–∞—Ç—å –£–ó, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
CREATE USER posh@localhost IDENTIFIED BY &#39;1qaz!QAZ&#39;;                  # —Å–æ–∑–¥–∞—Ç—å –£–ó, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è —Å —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
CREATE USER posh@&#39;192.168.3.99&#39; IDENTIFIED BY &#39;1qaz!QAZ&#39;;             # –£–ó –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
CREATE USER &#39;admin&#39;@&#39;%&#39; IDENTIFIED BY &#39;Admin12#&#39;;                     # –£–ó –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ —Å –ª—é–±–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (% - wildcard)
DROP USER posh@localhost;                                             # —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SHOW GRANTS FOR posh@&#39;%&#39;;                                             # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
GRANT ALL PRIVILEGES ON db_aduser.* TO posh@&#39;192.168.3.99&#39;;           # –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è posh –∫ –ë–î db_aduser
GRANT ALL PRIVILEGES ON *.* TO posh@&#39;%&#39;;                              # –¥–æ—Å—Ç—É–ø –∫ –≤—Å–µ–º –ë–î c –ª—é–±–æ–≥–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ —Ö–æ—Å—Ç–∞
GRANT SELECT,DELETE ON mysql.* TO posh@&#39;%&#39;;                           # –ø—Ä–∞–≤–∞ SELECT –∏ DELETE –Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –ë–î mysql
REVOKE DELETE ON mysql.* FROM posh@&#39;%&#39;;                               # —É–¥–∞–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø DELETE
UPDATE mysql.user SET super_priv=&#39;Y&#39; WHERE USER=&#39;posh&#39; AND host=&#39;%&#39;;  # –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∏–≤–µ–ª–µ–≥–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT USER,HOST,super_priv FROM mysql.user;                          # —Å–ø–∏—Å–æ–∫ –£–ó –∏ —Ç–∞–±–ª–∏—Ü–∞ —Å –ø—Ä–∞–≤–∞–º–∏ SUPER privilege
FLUSH PRIVILEGES;                                                     # –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞</code></pre>
<h3 id="table">TABLE</h3>
<pre><code>SHOW TABLES;               # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
SHOW TABLES LIKE &#39;%user&#39;;  # –ø–æ–∏—Å–∫ —Ç–∞–±–ª–∏—Ü—ã –ø–æ wildcard-–∏–º–µ–Ω–∏
CREATE TABLE table_aduser (id INT NOT NULL AUTO_INCREMENT, Name VARCHAR(100), email VARCHAR(100), PRIMARY KEY (ID));  # —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É
DROP TABLE table_aduser;   # —É–¥–∞–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É</code></pre>
<h3 id="column">COLUMN</h3>
<pre><code>SHOW COLUMNS FROM table_aduser;                                                         # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–±—Ü–æ–≤ –∏ –∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞
ALTER TABLE table_aduser DROP COLUMN id;                                                # —É–¥–∞–ª–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü id
ALTER TABLE table_aduser ADD COLUMN info VARCHAR(10);                                   # –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü info
ALTER TABLE table_aduser CHANGE info new_info VARCHAR(100);                             # –∏–∑–º–µ–Ω–∏—Ç—å –∏–º—è —Å—Ç–æ–ª–±—Ü–∞ info –Ω–∞ new_info –∏ –µ–≥–æ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö
ALTER TABLE table_aduser ADD COLUMN (id INT NOT NULL AUTO_INCREMENT, PRIMARY KEY (ID)); # –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü id</code></pre>
<h3 id="insert">INSERT</h3>
<pre><code>INSERT table_aduser (Name,email) VALUES (&#39;Alex&#39;,&#39;no-email&#39;);
INSERT table_aduser (Name,email) VALUES (&#39;Alex&#39;,&#39;no-email&#39;);
INSERT table_aduser (Name) VALUES (&#39;Support&#39;);
INSERT table_aduser (Name) VALUES (&#39;Jack&#39;);</code></pre>
<h3 id="select">SELECT</h3>
<pre><code>SELECT * FROM table_aduser;                     # —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—Å–µ—Ö —Å—Ç–æ–±—Ü–æ–≤ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π (FROM) —Ç–∞–±–ª–∏—Ü–µ
SELECT Name,email FROM table_aduser;            # —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Å—Ç–æ–±—Ü–æ–≤
SELECT DISTINCT Name,Email FROM table_aduser;   # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π)
SELECT * FROM table_aduser ORDER BY Name;       # –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ Name
SELECT * FROM table_aduser ORDER BY Name DESC;  # –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
SELECT COUNT(*) FROM table_aduser;              # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ
SELECT COUNT(new_info) FROM table_aduser;       # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Å—Ç–æ–ª–±—Ü–µ</code></pre>
<h3 id="where">WHERE</h3>
<pre><code>NOT; AND; OR                                                  # –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º —É—Å–ª–æ–≤–∏–π
SELECT * FROM table_aduser WHERE Name = &#39;Alex&#39;;               # –ø–æ–∏—Å–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É
SELECT * FROM table_aduser WHERE NOT Name != &#39;Alex&#39;;          # —É—Å–ª–æ–≤–∏–µ NOT –≥–¥–µ Name –Ω–µ —Ä–∞–≤–µ–Ω –∑–Ω–∞—á–µ–Ω–∏—é
SELECT * FROM table_aduser WHERE email != &#39;&#39;;                 # –≤—ã–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ email –Ω–µ —Ä–∞–Ω–æ null
SELECT * FROM table_aduser WHERE email != &#39;&#39; OR id &gt; 1000;    # –∏–ª–∏ id –≤—ã—à–µ 1000
SELECT * FROM table_aduser WHERE Name RLIKE &quot;support&quot;;        # —Ä–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–µ–º—ã–π (RLIKE) –ø–æ–∏—Å–∫
SELECT * FROM table_aduser WHERE Name RLIKE &quot;^support&quot;;       # –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å —ç—Ç–æ–≥–æ —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è</code></pre>
<h3 id="delete">DELETE</h3>
<pre><code>SELECT * FROM table_aduser WHERE Name RLIKE &quot;alex&quot;;   # –Ω–∞–π—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
DELETE FROM table_aduser WHERE Name RLIKE &quot;alex&quot;;     # Query OK, 2 rows affected # —É–¥–∞–ª–µ–Ω–æ –¥–≤–µ —Å—Ç—Ä–æ–∫–∏
DELETE FROM table_aduser;                             # —É–¥–∞–ª–∏—Ç—å –í–°–ï –∑–Ω–∞—á–µ–Ω–∏—è</code></pre>
<h3 id="update">UPDATE</h3>
<pre><code>SELECT * FROM table_aduser WHERE Name = &#39;Jack&#39;;             # –Ω–∞–π—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º
UPDATE table_aduser SET Name = &#39;Alex&#39; WHERE Name = &#39;Jack&#39;;  # –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ &#39;Jack&#39; –Ω–∞ &#39;Alex&#39;
UPDATE db_aduser.table_aduser SET Name=&#39;BCA&#39; WHERE id=1;    # –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å—Ç—Ä–æ–∫–µ —Å ID 1</code></pre>
<h3 id="check">CHECK</h3>
<pre><code>CHECK TABLE db_aduser.table_aduser;     # –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
ANALYZE TABLE db_aduser.table_aduser;   # –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
OPTIMIZE TABLE db_aduser.table_aduser;  # –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
REPAIR TABLE db_aduser.table_aduser;    # –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
TRUNCATE TABLE db_aduser.table_aduser;  # –æ—á–∏—Å—Ç–∏—Ç—å</code></pre>
<h3 id="dump">DUMP</h3>
<pre><code>mysqldump -u root -p --databases db_aduser &gt; /bak/db_aduser.sql
mysql -u root -p db_aduser &lt; /bak/db_aduser.sql

crontab -e
00 22 * * * /usr/bin/mysqldump -uroot -p1qaz!QAZ db_zabbix | /bin/bzip2 &gt; `date +/dump/zabbix/zabbix-\%d-\%m-\%Y-\%H:\%M.bz2`
00 23 * * * /usr/bin/mysqldump -uroot -p1qaz!QAZ db_zabbix &gt; `date +/dump/smb/zabbix-\%d-\%m-\%Y-\%H:\%M.sql`
0 0 * * * find /dump/zabbix -mtime +7 -exec rm {} \;

mysqldump -u root --single-transaction db_zabbix &gt; /dump/zabbix/db_zabbix.sql
mysql -u user_zabbix -p -e &#39;CREATE DATABASE db_zabbix;&#39;
mysql -u user_zabbix -p db_zabbix &lt; /root/db_zabbix.sql</code></pre>
<h3 id="innodb_force_recovery">innodb_force_recovery</h3>
<pre><code>sed -i &#39;/innodb_force_recovery/d&#39; /etc/mysql/my.cnf # —É–¥–∞–ª–∏—Ç—å
mode=6; sed -i &quot;/^\[mysqld\]/{N;s/$/\ninnodb_force_recovery=$mode/}&quot; /etc/mysql/my.cnf # –¥–æ–±–∞–≤–∏—Ç—å mode 6
systemctl restart mysql

[mysqld]
innodb_force_recovery=1 # —Å–µ—Ä–≤–µ—Ä –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –µ—Å—Ç—å –ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ InnoDB –∏–ª–∏ –Ω–µ—Ç
innodb_force_recovery=2 # —É–¥–∞–µ—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É –∑–∞ —Å—á–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ—Ç–æ–∫–∞ –∫–æ–º–∞–Ω–¥, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —á–∞—Å—Ç–∏—á–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –∏–ª–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã (–Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–æ–Ω–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
innodb_force_recovery=3 # –æ—Ç–º–µ–Ω—è–µ—Ç –æ—Ç–∫–∞—Ç –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (–Ω–µ –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–∫–∞—Ç–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
innodb_force_recovery=6 # –∑–∞–ø—É—Å–∫ –°–£–ë–î –≤ —Ä–µ–∂–∏–º–µ read only</code></pre>
<h3 id="mysql-connector-net">MySQL Connector NET</h3>
<h3 id="add-aduser">Add-ADUser</h3>
<div class="sourceCode" id="cb105"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="va">$ip</span> <span class="op">=</span> <span class="st">&quot;192.168.1.253&quot;</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="va">$user</span> <span class="op">=</span> <span class="st">&quot;posh&quot;</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="va">$pass</span> <span class="op">=</span> <span class="st">&quot;1qaz!QAZ&quot;</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="va">$db</span> <span class="op">=</span> <span class="st">&quot;db_aduser&quot;</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Add-Type</span> ‚ÄìPath <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Documents\MySQL-Connector-NET\8.0.31-4.8\MySql.Data.dll&quot;</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="va">$Connection</span> <span class="op">=</span> <span class="op">[</span>MySql<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">MySqlClient</span><span class="op">.</span><span class="fu">MySqlConnection</span><span class="op">]</span>@<span class="op">{</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>ConnectionString<span class="op">=</span><span class="st">&quot;server=</span><span class="va">$ip</span><span class="st">;uid=</span><span class="va">$user</span><span class="st">;pwd=</span><span class="va">$pass</span><span class="st">;database=</span><span class="va">$db</span><span class="st">&quot;</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="va">$Connection</span><span class="op">.</span><span class="fu">Open</span><span class="op">()</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="va">$Command</span> <span class="op">=</span> <span class="fu">New-Object</span> MySql<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">MySqlClient</span><span class="op">.</span><span class="fu">MySqlCommand</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="va">$Command</span><span class="op">.</span><span class="fu">Connection</span> <span class="op">=</span> <span class="va">$Connection</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="va">$UserList</span> <span class="op">=</span> <span class="fu">Get-ADUser</span> <span class="op">-</span>filter <span class="op">*</span> <span class="op">-</span>properties name<span class="op">,</span>EmailAddress</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$user</span> <span class="kw">in</span> <span class="va">$UserList</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="va">$uname</span><span class="op">=</span><span class="va">$user</span><span class="op">.</span><span class="fu">Name</span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="va">$uemail</span><span class="op">=</span><span class="va">$user</span><span class="op">.</span><span class="fu">EmailAddress</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="va">$Command</span><span class="op">.</span><span class="fu">CommandText</span> <span class="op">=</span> <span class="st">&quot;INSERT INTO table_aduser (Name,Email) VALUES (&#39;</span><span class="va">$uname</span><span class="st">&#39;,&#39;</span><span class="va">$uemail</span><span class="st">&#39;)&quot;</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="va">$Command</span><span class="op">.</span><span class="fu">ExecuteNonQuery</span><span class="op">()</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="va">$Connection</span><span class="op">.</span><span class="fu">Close</span><span class="op">()</span></span></code></pre></div>
<h3 id="get-aduser">Get-ADUser</h3>
<div class="sourceCode" id="cb106"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="va">$ip</span> <span class="op">=</span> <span class="st">&quot;192.168.1.253&quot;</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="va">$user</span> <span class="op">=</span> <span class="st">&quot;posh&quot;</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="va">$pass</span> <span class="op">=</span> <span class="st">&quot;1qaz!QAZ&quot;</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="va">$db</span> <span class="op">=</span> <span class="st">&quot;db_aduser&quot;</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Add-Type</span> ‚ÄìPath <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Documents\MySQL-Connector-NET\8.0.31-4.8\MySql.Data.dll&quot;</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="va">$Connection</span> <span class="op">=</span> <span class="op">[</span>MySql<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">MySqlClient</span><span class="op">.</span><span class="fu">MySqlConnection</span><span class="op">]</span>@<span class="op">{</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>ConnectionString <span class="op">=</span> <span class="st">&quot;server=</span><span class="va">$ip</span><span class="st">;uid=</span><span class="va">$user</span><span class="st">;pwd=</span><span class="va">$pass</span><span class="st">;database=</span><span class="va">$db</span><span class="st">&quot;</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="va">$Connection</span><span class="op">.</span><span class="fu">Open</span><span class="op">()</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="va">$Command</span> <span class="op">=</span> <span class="fu">New-Object</span> MySql<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">MySqlClient</span><span class="op">.</span><span class="fu">MySqlCommand</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="va">$Command</span><span class="op">.</span><span class="fu">Connection</span> <span class="op">=</span> <span class="va">$Connection</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="va">$MYSQLDataAdapter</span> <span class="op">=</span> <span class="fu">New-Object</span> MySql<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">MySqlClient</span><span class="op">.</span><span class="fu">MySqlDataAdapter</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="va">$MYSQLDataSet</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">DataSet</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="va">$Command</span><span class="op">.</span><span class="fu">CommandText</span> <span class="op">=</span> <span class="st">&quot;SELECT * FROM table_aduser&quot;</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="va">$MYSQLDataAdapter</span><span class="op">.</span><span class="fu">SelectCommand</span> <span class="op">=</span> <span class="va">$Command</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="va">$NumberOfDataSets</span> <span class="op">=</span> <span class="va">$MYSQLDataAdapter</span><span class="op">.</span><span class="fu">Fill</span><span class="op">(</span><span class="va">$MYSQLDataSet</span><span class="op">,</span> <span class="st">&quot;data&quot;</span><span class="op">)</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a><span class="va">$Collections</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Collections</span><span class="op">.</span><span class="fu">Generic</span><span class="op">.</span><span class="fu">List</span><span class="op">[</span>System<span class="op">.</span><span class="fu">Object</span><span class="op">]</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span><span class="op">(</span><span class="va">$DataSet</span> <span class="kw">in</span> <span class="va">$MYSQLDataSet</span><span class="op">.</span><span class="fu">tables</span><span class="op">[</span><span class="dv">0</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a><span class="va">$Collections</span><span class="op">.</span><span class="fu">Add</span><span class="op">([</span>PSCustomObject<span class="op">]</span>@<span class="op">{</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>Name <span class="op">=</span> <span class="va">$DataSet</span><span class="op">.</span><span class="fu">name</span><span class="op">;</span></span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>Mail <span class="op">=</span> <span class="va">$DataSet</span><span class="op">.</span><span class="fu">email</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="op">})</span></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a><span class="va">$Connection</span><span class="op">.</span><span class="fu">Close</span><span class="op">()</span></span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a><span class="va">$Collections</span></span></code></pre></div>
<h1 id="mssql">MSSQL</h1>
<p><code>wget -qO- https://packages.microsoft.com/keys/microsoft.asc | apt-key add -</code>
–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å GPG-–∫–ª—é—á –¥–ª—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è<br />
<code>https://packages.microsoft.com/config/ubuntu/</code> –≤—ã–±—Ä–∞—Ç—å
—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å URL<br />
<code>add-apt-repository "$(wget -qO- https://packages.microsoft.com/config/ubuntu/20.04/mssql-server-2019.list)"</code><br />
<code>apt-get update</code> –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤<br />
<code>apt-get install mssql-server</code><br />
<code>/opt/mssql/bin/mssql-conf setup</code> —Å–∫—Ä–∏–ø—Ç –Ω–∞—á–∞–ª—å–Ω–æ–π
–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–≤—ã–±—Ä–∞—Ç—å —Ä–µ–¥–∞–∫—Ü–∏—é, 3 - express –∏ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ 9 –∏–∑
11)<br />
<code>systemctl status mssql-server</code><br />
<code>curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -</code>
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç<br />
<code>curl https://packages.microsoft.com/config/ubuntu/20.04/prod.list | tee /etc/apt/sources.list.d/msprod.list</code><br />
<code>apt-get update</code><br />
<code>apt-get install mssql-tools</code><br />
<code>echo 'export PATH="$PATH:/opt/mssql-tools/bin"' &gt;&gt; ~/.bashrc</code>
–¥–æ–±–∞–≤–∏—Ç—å –≤ –¥–æ–º–∞—à–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ —Ñ–∞–π–ª–∞ bashrc, —á—Ç–æ –±—ã –Ω–µ –ø–∏—Å–∞—Ç—å –ø—É—Ç—å –∫
–∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É<br />
<code>export PATH="$PATH:/opt/mssql-tools/bin"</code><br />
<code>iptables -I INPUT 1 -p tcp --dport 1433 -j ACCEPT</code></p>
<pre><code>sqlcmd -S localhost -U SA
CREATE DATABASE itinvent
go
SELECT name FROM master.dbo.sysdatabases
go</code></pre>
<h3 id="system.data.sqlclient">System.Data.SqlClient</h3>
<div class="sourceCode" id="cb108"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="va">$user</span> <span class="op">=</span> <span class="st">&quot;itinvent&quot;</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="va">$pass</span> <span class="op">=</span> <span class="st">&quot;itinvent&quot;</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="va">$db</span>   <span class="op">=</span> <span class="st">&quot;itinvent&quot;</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="va">$srv</span>  <span class="op">=</span> <span class="st">&quot;192.168.3.103&quot;</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlConnection</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">SqlClient</span><span class="op">.</span><span class="fu">SqlConnection</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlConnection</span><span class="op">.</span><span class="fu">ConnectionString</span> <span class="op">=</span> <span class="st">&quot;server=</span><span class="va">$srv</span><span class="st">;database=</span><span class="va">$db</span><span class="st">;user id=</span><span class="va">$user</span><span class="st">;password=</span><span class="va">$pass</span><span class="st">;Integrated Security=false&quot;</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlCommand</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">SqlClient</span><span class="op">.</span><span class="fu">SqlCommand</span><span class="ch">` </span>–∫–ª–∞—Å—Å —Ñ–æ—Ä–º–∞—Ç–∞ –∫–æ–º–∞–Ω–¥—ã</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlCommand</span><span class="op">.</span><span class="fu">CommandText</span> <span class="op">=</span> <span class="st">&quot;SELECT * FROM ITINVENT.dbo.USERS&quot;</span><span class="ch">` </span>–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–∞–±–ª–∏—Ü—ã</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="co">#$SqlCommand.CommandText = &quot;SELECT LICENCE_DATE,DESCR,MODEL_NO,TYPE_NO FROM ITINVENT.dbo.ITEMS where LICENCE_DATE IS NOT NULL&quot;</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlCommand</span><span class="op">.</span><span class="fu">Connection</span> <span class="op">=</span> <span class="va">$SqlConnection</span><span class="ch">` </span>–ø–µ—Ä–µ–¥–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlAdapter</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">SqlClient</span><span class="op">.</span><span class="fu">SqlDataAdapter</span><span class="ch">` </span>—Å–æ–∑–¥–∞—Ç—å –∞–¥–∞–ø—Ç–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è <span class="fu">SELECT</span> –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlAdapter</span><span class="op">.</span><span class="fu">SelectCommand</span> <span class="op">=</span> <span class="va">$SqlCommand</span><span class="ch">` </span>–ø–µ—Ä–µ–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—É</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="va">$DataSet</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">DataSet</span><span class="ch">` </span>—Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç –ø—Ä–∏–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞ XML</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlAdapter</span><span class="op">.</span><span class="fu">Fill</span><span class="op">(</span><span class="va">$DataSet</span><span class="op">)</span><span class="ch">` </span>–∑–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –æ—Ç –∞–¥–∞–ø—Ç–µ—Ä–∞ <span class="op">(</span>–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª-–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤<span class="op">)</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlConnection</span><span class="op">.</span><span class="fu">Close</span><span class="op">()</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a><span class="va">$Data</span> <span class="op">=</span> <span class="va">$DataSet</span><span class="op">.</span><span class="fu">Tables</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="va">$Data</span><span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">|</span> <span class="fu">ft</span></span></code></pre></div>
<h3 id="sqlclient-insert">SqlClient INSERT</h3>
<div class="sourceCode" id="cb109"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="va">$user</span> <span class="op">=</span> <span class="st">&quot;itinvent&quot;</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="va">$pass</span> <span class="op">=</span> <span class="st">&quot;itinvent&quot;</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="va">$db</span>   <span class="op">=</span> <span class="st">&quot;db_test&quot;</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="va">$srv</span>  <span class="op">=</span> <span class="st">&quot;192.168.3.103&quot;</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="va">$sql</span> <span class="op">=</span> <span class="st">&quot;INSERT INTO table_test (column_user) VALUES (&#39;lifailon&#39;)&quot;</span><span class="ch">` </span>–¥–æ–±–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É table_test –≤ –∫–æ–ª–æ–Ω–∫—É column_user</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlConnection</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">SqlClient</span><span class="op">.</span><span class="fu">SqlConnection</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlConnection</span><span class="op">.</span><span class="fu">ConnectionString</span> <span class="op">=</span> <span class="st">&quot;server=</span><span class="va">$srv</span><span class="st">;database=</span><span class="va">$db</span><span class="st">;user id=</span><span class="va">$user</span><span class="st">;password=</span><span class="va">$pass</span><span class="st">;Integrated Security=false&quot;</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlCommand</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">SqlClient</span><span class="op">.</span><span class="fu">SqlCommand</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlCommand</span><span class="op">.</span><span class="fu">CommandText</span> <span class="op">=</span> <span class="va">$sql</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlCommand</span><span class="op">.</span><span class="fu">Connection</span> <span class="op">=</span> <span class="va">$SqlConnection</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlConnection</span><span class="op">.</span><span class="fu">Open</span><span class="op">()</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="va">$rowsAffected</span> <span class="op">=</span> <span class="va">$SqlCommand</span><span class="op">.</span><span class="fu">ExecuteNonQuery</span><span class="op">();</span><span class="ch">` </span>–¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ INSERT<span class="op">/</span>UPDATE<span class="op">/</span>DELETE –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SqlDataAdapter</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="va">$SqlConnection</span><span class="op">.</span><span class="fu">Close</span><span class="op">()</span></span></code></pre></div>
<h3 id="ssms-insert">SSMS INSERT</h3>
<pre><code>USE [db_test]
GO
INSERT INTO [dbo].[table_test]
           ([column_user])
     VALUES
           (&#39;lifailon&#39;)
GO
SELECT TOP (1000) [column_user]
FROM [db_test].[dbo].[table_test]</code></pre>
<h3 id="t-sql">T-SQL</h3>
<ul>
<li><p>DDL (Data Definition Language / –Ø–∑—ã–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö). –ö —ç—Ç–æ–º—É
—Ç–∏–ø—É –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞—é—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–±–ª–∏—Ü—ã, –∏–Ω–¥–µ–∫—Å—ã,
—Ö—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã.<br />
<code>CREATE</code> —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Å–∞–º—É –±–∞–∑—É –¥–∞–Ω—ã—Ö,
—Ç–∞–±–ª–∏—Ü—ã, –∏–Ω–¥–µ–∫—Å—ã –∏ —Ç.–¥.)<br />
<code>ALTER</code> –∏–∑–º–µ–Ω—è–µ—Ç –æ–±—ä–µ–∫—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö<br />
<code>DROP</code> —É–¥–∞–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö<br />
<code>TRUNCATE</code> —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü</p></li>
<li><p>DML (Data Manipulation Language / –Ø–∑—ã–∫ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã–º–∏). –ö
—ç—Ç–æ–º—É —Ç–∏–ø—É –æ—Ç–Ω–æ—Å—è—Ç –∫–æ–º–∞–Ω–¥—ã –ø–æ –≤—ã–±–æ—Ä—É, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é, –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –∏ —É–¥–∞–ª–µ–Ω–∏—é
–¥–∞–Ω–Ω—ã—Ö.<br />
<code>SELECT</code> –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î<br />
<code>UPDATE</code> –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ<br />
<code>INSERT</code> –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ<br />
<code>DELETE</code> —É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ</p></li>
<li><p>DCL (Data Control Language / –Ø–∑—ã–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º). –ö
—ç—Ç–æ–º—É —Ç–∏–ø—É –æ—Ç–Ω–æ—Å—è—Ç –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–ø—Ä–∞–≤–ª—è—é—Ç –ø—Ä–∞–≤–∞–º–∏ –ø–æ –¥–æ—Å—Ç—É–ø—É –∫
–¥–∞–Ω–Ω—ã–º.<br />
<code>GRANT</code> –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º<br />
<code>REVOKE</code> –æ—Ç–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º</p></li>
</ul>
<pre><code>-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
DECLARE @text NVARCHAR(20), @int INT;
SET @text=&#39;Test&#39;;
SET @int = 21;
select @text,@int

-- –ò–º–µ–Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ 
Select @@SERVERNAME as [Server\Instance]; 

-- –≤–µ—Ä—Å–∏—è SQL Server 
Select @@VERSION as SQLServerVersion; 

-- –¢–µ–∫—É—â–∞—è –ë–î (–ë–î, –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∫–æ—Ç–æ—Ä–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å)
Select DB_NAME() AS CurrentDB_Name;

-- –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–º–µ–Ω—Ç–∞ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
SELECT  @@Servername AS ServerName ,
        create_date AS  ServerStarted ,
        DATEDIFF(s, create_date, GETDATE()) / 86400.0 AS DaysRunning ,
        DATEDIFF(s, create_date, GETDATE()) AS SecondsRunnig
FROM    sys.databases
WHERE   name = &#39;tempdb&#39;;

-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
SELECT  @@Servername AS Server ,
        DB_NAME(database_id) AS DatabaseName ,
        COUNT(database_id) AS Connections ,
        Login_name AS  LoginName ,
        MIN(Login_Time) AS Login_Time ,
        MIN(COALESCE(last_request_end_time, last_request_start_time))
                                                         AS  Last_Batch
FROM    sys.dm_exec_sessions
WHERE   database_id &gt; 0
        AND DB_NAME(database_id) NOT IN ( &#39;master&#39;, &#39;msdb&#39; )
GROUP BY database_id ,
         login_name
ORDER BY DatabaseName;

-- –°—Ç–∞—Ç—É—Å Backup
SELECT  @@Servername AS ServerName ,
        d.Name AS DBName ,
        MAX(b.backup_finish_date) AS LastBackupCompleted
FROM    sys.databases d
        LEFT OUTER JOIN msdb..backupset b
                    ON b.database_name = d.name
                       AND b.[type] = &#39;D&#39;
GROUP BY d.Name
ORDER BY d.Name;

-- –ü—É—Ç—å –∫ Backup
SELECT  @@Servername AS ServerName ,
        d.Name AS DBName ,
        b.Backup_finish_date ,
        bmf.Physical_Device_name
FROM    sys.databases d
        INNER JOIN msdb..backupset b ON b.database_name = d.name
                                        AND b.[type] = &#39;D&#39;
        INNER JOIN msdb.dbo.backupmediafamily bmf ON b.media_set_id = bmf.media_set_id
ORDER BY d.NAME ,
        b.Backup_finish_date DESC; 

-- –í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ë–î, –º–æ–¥–µ–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –ø—É—Ç—å –∫ mdf/ldf
EXEC sp_helpdb; 
SELECT  @@SERVERNAME AS Server ,
        d.name AS DBName ,
        create_date ,
        recovery_model_Desc AS RecoveryModel ,
        m.physical_name AS FileName
FROM    sys.databases d
        JOIN sys.master_files m ON d.database_id = m.database_id
ORDER BY d.name;

-- –†–∞–∑–º–µ—Ä –ë–î
with fs
as
(
    select database_id, type, size * 8.0 / 1024 size
    from sys.master_files
)
select 
    name,
    (select sum(size) from fs where type = 0 and fs.database_id = db.database_id) DataFileSizeMB,
    (select sum(size) from fs where type = 1 and fs.database_id = db.database_id) LogFileSizeMB
from sys.databases 

-- –ü–æ–∏—Å–∫ —Ç–∞–±–ª–∏—Ü—ã –ø–æ –º–∞—Å–∫–µ –∏–º–µ–Ω–∏ (–≤—ã–≤–æ–¥: –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ö–µ–º—ã –≥–¥–µ —Ä–∞—Å–ø–æ–ª–æ–≥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç, —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞, –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏):
select [object_id], [schema_id],
       schema_name([schema_id]) as [schema_name], 
       [name], 
       [type], 
       [type_desc], 
       [create_date], 
       [modify_date]
from sys.all_objects
-- where [name]=&#39;INVENT&#39;;
where [name] like &#39;%INVENT%&#39;;

-- –ö–æ–ª-–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö
SELECT  @@ServerName AS Server ,
        DB_NAME() AS DBName ,
        OBJECT_SCHEMA_NAME(p.object_id) AS SchemaName ,
        OBJECT_NAME(p.object_id) AS TableName ,
        i.Type_Desc ,
        i.Name AS IndexUsedForCounts ,
        SUM(p.Rows) AS Rows
FROM    sys.partitions p
        JOIN sys.indexes i ON i.object_id = p.object_id
                              AND i.index_id = p.index_id
WHERE   i.type_desc IN ( &#39;CLUSTERED&#39;, &#39;HEAP&#39; )
                             -- This is key (1 index per table) 
        AND OBJECT_SCHEMA_NAME(p.object_id) &lt;&gt; &#39;sys&#39;
GROUP BY p.object_id ,
        i.type_desc ,
        i.Name
ORDER BY SchemaName ,
        TableName; 

-- –ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫–æ–≤–æ–µ (nvarchar) –∑–Ω–∞—á–µ–Ω–∏–µ 2023 –ø–æ –≤—Å–µ–º —Ç–∞–±–ª–∏—Ü–∞–º –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
-- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∫–∞–∫–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ —Å—Ç–æ–ª–±—Ü–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ, –∞ —Ç–∞–∫–∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–∞—Ä—ã —Ç–∞–±–ª–∏—Ü–∞-–∫–æ–ª–æ–Ω–∫–∞
set nocount on
declare @name varchar(128), @substr nvarchar(4000), @column varchar(128)
set @substr = &#39;%2023%&#39;
declare @sql nvarchar(max);
create table`rslt 
(table_name varchar(128), field_name varchar(128), [value] nvarchar(max))
declare s cursor for select table_name as table_name from information_schema.tables where table_type = &#39;BASE TABLE&#39; order by table_name
open s
fetch next from s into @name
while @@fetch_status = 0
begin
declare c cursor for 
select quotename(column_name) as column_name from information_schema.columns 
where data_type in (&#39;text&#39;, &#39;ntext&#39;, &#39;varchar&#39;, &#39;char&#39;, &#39;nvarchar&#39;, &#39;char&#39;, &#39;sysname&#39;, &#39;int&#39;, &#39;tinyint&#39;) and table_name  = @name
set @name = quotename(@name)
open c
fetch next from c into @column
while @@fetch_status = 0
begin
--print &#39;Processing table - &#39; + @name + &#39;, column - &#39; + @column
set @sql=&#39;insert into`rslt select &#39;&#39;&#39; + @name + &#39;&#39;&#39; as Table_name, &#39;&#39;&#39; + @column + &#39;&#39;&#39;, cast(&#39; + @column + 
&#39; as nvarchar(max)) from&#39; + @name + &#39; where cast(&#39; + @column + &#39; as nvarchar(max)) like &#39;&#39;&#39; + @substr + &#39;&#39;&#39;&#39;;
print @sql;
exec(@sql);
fetch next from c into @column;
end
close c
deallocate c
fetch next from s into @name
end
select table_name as [Table Name], field_name as [Field Name], count(*) as [Found Mathes] from`rslt
group by table_name, field_name
order by table_name, field_name
drop table`rslt
close s
deallocate s

-- –ü–æ–∏—Å–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ [CI_HISTORY] –∏ —Å—Ç–æ–ª–±—Ü—É [HIST_ID]:
SELECT * FROM ITINVENT.dbo.CI_HISTORY where [HIST_ID] like &#39;%2023%&#39;;

-- –£–∑–Ω–∞—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—é –∏–Ω–¥–µ–∫—Å–æ–≤
DECLARE @db_id SMALLINT;
SET @db_id = DB_ID(N&#39;itinvent&#39;);
IF @db_id IS NULL
BEGIN;
    PRINT N&#39;–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è –±–∞–∑—ã&#39;;
END;
ELSE
BEGIN;
    SELECT
        object_id AS [ID –æ–±—ä–µ–∫—Ç–∞],
        index_id AS [ID –∏–Ω–¥–µ–∫—Å–∞],
        index_type_desc AS [–¢–∏–ø –∏–Ω–¥–µ–∫—Å–∞],
        avg_fragmentation_in_percent AS [–§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –≤ %]
        
    FROM sys.dm_db_index_physical_stats(@db_id, NULL, NULL, NULL , &#39;LIMITED&#39;)
     
    ORDER BY [avg_fragmentation_in_percent] DESC;
END;
GO

-- TempDB
-- Initial size - –Ω–∞—á–∞–ª—å–Ω—ã–π/–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ë–î (1024 MB)
-- Autogrowh - –ø—Ä–∏—Ä–æ—Å—Ç (512MB)
-- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é tempdb –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –∞–≤—Ç–æ-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (Autogrow) –∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ SQL Server –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª—ã —ç—Ç–æ–π –ë–î —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.
-- –£–≤–µ–ª–∏—á–∏–≤ —Ä–∞–∑–º–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤ tempdb, –º–æ–∂–Ω–æ —Å–≤–µ—Å—Ç–∏ –∫ –º–∏–Ω–∏–º—É–º—É –∑–∞—Ç—Ä–∞—Ç—ã —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∞–≤—Ç–æ-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.

-- –ò–∑–º–µ–Ω–∏—Ç—å –ø—É—Ç—å –∫ –ë–î:
USE master;
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = tempdev, FILENAME = &#39;F:\tempdb.mdf&#39;);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp2, FILENAME = &#39;F:\tempdb_mssql_2.ndf&#39;);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp3, FILENAME = &#39;F:\tempdb_mssql_3.ndf&#39;);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp4, FILENAME = &#39;F:\tempdb_mssql_4.ndf&#39;);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp5, FILENAME = &#39;F:\tempdb_mssql_5.ndf&#39;);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp6, FILENAME = &#39;F:\tempdb_mssql_6.ndf&#39;);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp7, FILENAME = &#39;F:\tempdb_mssql_7.ndf&#39;);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp8, FILENAME = &#39;F:\tempdb_mssql_8.ndf&#39;);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = templog, FILENAME = &#39;F:\templog.ldf&#39;);
GO

-- –£–∫–∞–∑–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:
MODIFY FILE (NAME = temp2, FILENAME = &#39;F:\tempdb_mssql_2.ndf&#39; , SIZE = 1048576KB , FILEGROWTH = 524288KB);</code></pre>
<h3 id="—Ç–∏–ø-—Ä–µ–∑–µ—Ä–≤–Ω–æ–π-–∫–æ–ø–∏–∏">–¢–∏–ø —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏</h3>
<ul>
<li>Full (–ü–æ–ª–Ω–∞—è –∫–æ–ø–∏—è). –ö–æ–≥–¥–∞ —Å—Ç–∞—Ä—Ç—É–µ—Ç –ø–æ–ª–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ,
–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è Log Sequence Number (LSN - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –∂—É—Ä–Ω–∞–ª–∞),
–∞ —Ç–∞–∫ –∂–µ LSN –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∏ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø–æ–ª–Ω–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è. –≠—Ç–æ—Ç
LSN —è–≤–ª—è–µ—Ç—Å—è –º–µ—Ö–∞–Ω–∏–∑–º–æ–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º SQL Server, —á—Ç–æ–±—ã –∑–Ω–∞—Ç—å, –≤ –∫–∞–∫–æ–º
–ø–æ—Ä—è–¥–∫–µ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã INSERT, UPDATE –∏–ª–∏ DELETE. –ü—Ä–∏ —ç—Ç–æ–º
–Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö LSN –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è, –∫–∞–∫ —á–∞—Å—Ç–∏ –ø–æ–ª–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞,
–æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ
–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–∏ –ø–æ–ª–Ω–æ–º —Ä–µ–∑–µ—Ä–≤–Ω–æ–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è
–∏–∑–º–µ–Ω–µ–Ω–∏—è, –ø—Ä–æ–∏–∑–æ—à–µ–¥—à–∏–µ –≤–æ –≤—Ä–µ–º—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è. –≠—Ç–æ
–æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–∞–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
–±—ç–∫–∞–ø–∞.</li>
<li>Differential (–¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è/—Ä–∞–∑–Ω–æ—Å—Ç–Ω–∞—è –∫–æ–ø–∏—è). –•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã—Ö,
–∏–∑–º–µ–Ω–∏–≤—à–∏–µ—Å—è —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ü–æ–ª–Ω–æ–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏. –ü—Ä–∏
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ü–æ–ª–Ω—É—é —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –≤
—Ä–µ–∂–∏–º–µ NORECOVERY, –ø–æ—Ç–æ–º –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ª—é–±—É—é –∏–∑ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –†–∞–∑–Ω–æ—Å—Ç–Ω—ã—Ö
–∫–æ–ø–∏–π, –±–µ–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ü–æ–ª–Ω–æ–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –†–∞–∑–Ω–æ—Å—Ç–Ω–∞—è –∫–æ–ø–∏—è
–±–µ—Å–ø–æ–ª–µ–∑–Ω–∞. –ö–∞–∂–¥–∞—è –ø–æ—Å–ª–µ–¥—É—é—â–∞—è –†–∞–∑–Ω–æ—Å—Ç–Ω–∞—è –∫–æ–ø–∏—è –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ
–¥–∞–Ω–Ω—ã–µ, –≤—Ö–æ–¥—è—â–∏–µ –≤ –ø—Ä–µ–¥—ã–¥—É—â—É—é –†–∞–∑–Ω–æ—Å—Ç–Ω—É—é —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é, —Å–¥–µ–ª–∞–Ω–Ω—É—é
–ø–æ—Å–ª–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ü–æ–ª–Ω–æ–π –∫–æ–ø–∏–∏.</li>
<li>Incremental (–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è/–∫–æ–ø–∏—è –∂—É—Ä–Ω–∞–ª–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π). –†–µ–∑–µ—Ä–≤–Ω–æ–µ
–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∫–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ
–ø—Ä–æ–∏–∑–æ—à–ª–∏ —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ –∑–∞—Ç–µ–º —É—Ä–µ–∑–∞–µ—Ç
–∂—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
–ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (LSN), –±—ç–∫–∞–ø –∂—É—Ä–Ω–∞–ª–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç—Ç–æ—Ç
–ø–æ—Ä—è–¥–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –ë—ç–∫–∞–ø—ã –∂—É—Ä–Ω–∞–ª–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–æ–ª–∂–Ω—ã –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è
–ø–æ –ø–æ—Ä—è–¥–∫—É. –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—Å—è —Ü–µ–ø–æ—á–∫–∞
—Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π: –ø–æ–ª–Ω–∞—è –∏ –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∂—É—Ä–Ω–∞–ª–∞
—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.</li>
</ul>
<h3 id="–º–æ–¥–µ–ª–∏-–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è">–ú–æ–¥–µ–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è</h3>
<ul>
<li>Simple (–ü—Ä–æ—Å—Ç–∞—è). –•—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –∂–∏–∑–Ω–∏ –æ—Å—Ç–∞—Ç–æ–∫
–∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–ª–æ–≥) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è.
–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞, –ø–æ—ç—Ç–æ–º—É –æ—Å—Ç–∞–µ—Ç—Å—è
—Å–∞–º–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –æ–ø—Ü–∏–π –ø–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é. –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
Always On, Point-In-Time –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ, –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∂—É—Ä–Ω–∞–ª–∞
—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.</li>
<li>Full (–ü–æ–ª–Ω–∞—è). –•—Ä–∞–Ω–∏—Ç—Å—è –∂—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ë–î —Å
–º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –ñ—É—Ä–Ω–∞–ª
—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–µ –±—É–¥–µ—Ç –æ—á–∏—â–∞—Ç—å—Å—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω–∞
—Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.</li>
<li>Bulk logged (–° –Ω–µ–ø–æ–ª–Ω—ã–º –ø—Ä–æ—Ç–æ–∫–æ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º). –ò–¥–µ–Ω—Ç–∏—á–Ω–∞ Full, –∑–∞
–∏—Å–∫–ª—é—á–µ–Ω–∏–µ: SELECT INTO, BULK INSERT –∏ BCP, INSERT INTO SELECT, –æ–ø–µ—Ä–∞—Ü–∏–∏
—Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ (CREATE INDEX, ALTER INDEX REBUILD, DROP INDEX)</li>
</ul>
<h3 id="—Å–∏—Å—Ç–µ–º–Ω—ã–µ-–±–¥">–°–∏—Å—Ç–µ–º–Ω—ã–µ –ë–î</h3>
<ul>
<li>master. –•—Ä–∞–Ω—è—Ç—Å—è –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã,
—Å–≤–µ–¥–µ–Ω—å—è –æ–± —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å—è—Ö –≤—Ö–æ–¥–∞, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–±–æ –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö –±–∞–∑–∞—Ö
–¥–∞–Ω–Ω—ã—Ö) –¥–ª—è —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ SQL Server.</li>
<li>tempdb. –†–∞–±–æ—á–µ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫
–≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö—Ä–∞–Ω–∏–º—ã–µ
–ø—Ä–æ—Ü–µ–¥—É—Ä—ã, —Ç–∞–±–ª–∏—á–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∫—É—Ä—Å–æ—Ä—ã. –ü–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º
–∑–∞–ø—É—Å–∫–µ SQL Server.</li>
<li>model. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ —à–∞–±–ª–æ–Ω–∞ –¥–ª—è –≤—Å–µ—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö,
—Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö –≤ —ç–∫–∑–µ–º–ø–ª—è—Ä–µ SQL Server, –≤—Å–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö model,
–≤–∫–ª—é—á–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ —Å–æ–∑–¥–∞–≤–∞–µ–º—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –¢–∞–∫
–∫–∞–∫ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö tempdb —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ SQL Server, –±–∞–∑–∞
–¥–∞–Ω–Ω—ã—Ö model –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ SQL Server.</li>
<li>msdb. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≥–µ–Ω—Ç–æ–º SQL Server –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (–æ–ø–µ—Ä–∞—Ç–æ—Ä) –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π, –∞ —Ç–∞–∫–∂–µ –¥—Ä—É–≥–∏–º–∏
–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏. SQL Server —Ö—Ä–∞–Ω–∏—Ç –ø–æ–ª–Ω—ã–π –∂—É—Ä–Ω–∞–ª —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö msdb. –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ—á—Ç—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä—É
–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: USE [msdb].</li>
<li>resource. –î–æ—Å—Ç—É–ø–Ω–∞—è —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç
–≤—Å–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä sys.objects, —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –±–∞–∑–µ
–¥–∞–Ω–Ω—ã—Ö resource, –Ω–æ –ª–æ–≥–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ —Å—Ö–µ–º–µ sys –∫–∞–∂–¥–æ–π –±–∞–∑—ã
–¥–∞–Ω–Ω—ã—Ö.</li>
</ul>
<h3 id="—Ä–µ–≥–ª–∞–º–µ–Ω—Ç–Ω—ã–µ-–æ–ø–µ—Ä–∞—Ü–∏–∏">–†–µ–≥–ª–∞–º–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h3>
<ul>
<li>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</li>
</ul>
<p><code>DBCC CHECKDB</code></p>
<ul>
<li><p>–ò–Ω–¥–µ–∫—Å—ã. –ò–Ω–¥–µ–∫—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑
–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–∏—Å–∫–∞/–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏
–∫–∞–∂–¥–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ —Ç–∞–±–ª–∏—Ü–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –ò–Ω–¥–µ–∫—Å —É—Å–∫–æ—Ä—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—Ä–æ—Å–∞,
–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å—Ç—Ä–æ–∫–∞–º –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ç–æ–º—É,
–∫–∞–∫ —É–∫–∞–∑–∞—Ç–µ–ª—å –≤ –∫–Ω–∏–≥–µ –ø–æ–º–æ–≥–∞–µ—Ç –≤–∞–º –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.
–ò–Ω–¥–µ–∫—Å—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –ø—É—Ç—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–Ω–∞—á–µ–Ω–∏–π
–≤ —ç—Ç–∏—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –µ–≥–æ
—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞. MS SQL Server —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ—Ç –∏ –∏–∑–º–µ–Ω—è–µ—Ç –∏–Ω–¥–µ–∫—Å—ã –ø—Ä–∏
—Ä–∞–±–æ—Ç–µ —Å –±–∞–∑–æ–π. –° —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ –¥–∞–Ω–Ω—ã–µ –≤ –∏–Ω–¥–µ–∫—Å–µ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è
—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏, —Ç.–µ. —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–Ω—ã–º–∏ –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ
—Å–Ω–∏–∂–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤. –ï—Å–ª–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç 5
–¥–æ 30% (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ –≤ –∑–∞–¥–∞–Ω–∏–∏ 15%), —Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –µ–µ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å —Å
–ø–æ–º–æ—â—å—é —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, –ø—Ä–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤—ã—à–µ 30% (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ –∑–∞–¥–∞—á–µ
&gt; 30% —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —á–∏—Å–ª–æ —Å—Ç—Ä–∞–Ω–∏—Ü &gt; 1000) –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª–Ω–æ–µ
–ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤. –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–ª–∞–Ω–æ–≤–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ
—Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è.</p></li>
<li><p>–†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è (Reorganize) –∏–ª–∏ –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–∞ ‚Äî —ç—Ç–æ —Å–µ—Ä–∏—è
–Ω–µ–±–æ–ª—å—à–∏—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π —Å—Ç—Ä–∞–Ω–∏—Ü —Ç–∞–∫, —á—Ç–æ–±—ã –∏–Ω–¥–µ–∫—Å –Ω–µ –±—ã–ª
—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω. –ü–æ—Å–ª–µ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è. –í–æ –≤—Ä–µ–º—è
–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—á—Ç–∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç
—Ä–∞–±–æ—Ç–∞—Ç—å.</p></li>
</ul>
<p><code>sp_msforeachtable N'DBCC INDEXDEFRAG (&lt;–∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö&gt;, ''?'')'</code></p>
<ul>
<li>–ü–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ (Rebuild) –∏–Ω–¥–µ–∫—Å–æ–≤ (–∏–ª–∏ –∑–∞–¥–∞—á–∞ –≤ –º–∞—Å—Ç–µ—Ä–µ –ø–ª–∞–Ω–æ–≤
–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å) –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª–Ω–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è
–∏–Ω–¥–µ–∫—Å–æ–≤. –í –≤–µ—Ä—Å–∏–∏ MS SQL Server Standard –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö
–∫–ª–∏–µ–Ω—Ç–æ–≤ –æ—Ç –±–∞–∑—ã –Ω–∞ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏. –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏—è
–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.</li>
</ul>
<p><code>sp_msforeachtable N'DBCC DBREINDEX (''?'')'</code></p>
<ul>
<li>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Äî –Ω–µ–±–æ–ª—å—à–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–æ–±—ã—á–Ω–æ –¥–æ 200
—Å—Ç—Ä–æ–∫), –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –æ–±–æ–±—â–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, –∫–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏
–∫–∞–∫ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ. –ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–µ—Ä–≤–µ—Ä
–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ, –∫–∞–∫ –ª—É—á—à–µ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–ø—Ä–æ—Å. –ö–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∑–∞–ø—Ä–æ—Å—ã
–∫ –ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, SELECT) –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –¥–∞–Ω–Ω—ã–µ, –Ω–æ –Ω–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç–µ —Ç–æ, –∫–∞–∫
—ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω—ã. –í –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö
–ø–æ–º–æ–≥–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞. –í–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
–¥–∞–Ω–Ω—ã–µ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è.</li>
</ul>
<p><code>exec sp_msforeachtable N'UPDATE STATISTICS ? WITH FULLSCAN'</code></p>
<ul>
<li>–û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω–æ–≥–æ –∫—ç—à–∞, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.
–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä MS SQL Server –∫—ç—à–∏—Ä—É–µ—Ç –ø–ª–∞–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∏—Ö –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ
–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —ç–∫–æ–Ω–æ–º–∏—Ç—å –≤—Ä–µ–º—è, –∑–∞—Ç—Ä–∞—á–∏–≤–∞–µ–º–æ–µ
–Ω–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏—é –∑–∞–ø—Ä–æ—Å–∞ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —Ç–∞–∫–æ–π –∂–µ –∑–∞–ø—Ä–æ—Å —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–ª—Å—è
–∏ –µ–≥–æ –ø–ª–∞–Ω –∏–∑–≤–µ—Å—Ç–µ–Ω. –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –Ω–µ –±—É–¥–µ—Ç –æ—á–∏—â–µ–Ω
–ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–π –∫—ç—à, —Ç–æ SQL Server –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å —Å—Ç–∞—Ä—ã–π (–Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π) –ø–ª–∞–Ω
–∑–∞–ø—Ä–æ—Å–∞ –∏–∑ –∫—ç—à–∞ –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –Ω–æ–≤—ã–π (–±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π)
–ø–ª–∞–Ω.</li>
</ul>
<p><code>DBCC FREEPROCCACHE</code></p>
<h1 id="influxdb">InfluxDB</h1>
<p><a href="https://www.influxdata.com/downloads">Download InfluxDB 1.x
Open Source</a> <a
href="https://github.com/CymaticLabs/InfluxDBStudio">InfluxDB-Studio</a></p>
<h3 id="install-windows">Install Windows</h3>
<div class="sourceCode" id="cb112"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Invoke-RestMethod</span> <span class="st">&quot;https://dl.influxdata.com/influxdb/releases/influxdb-1.8.10_windows_amd64.zip&quot;</span> <span class="op">-</span>OutFile <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\influxdb-1.8.10_windows_amd64.zip&quot;</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>Expand-Archive <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\influxdb-1.8.10_windows_amd64.zip&quot;</span> <span class="op">-</span>DestinationPath <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Documents\&quot;</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\influxdb-1.8.10_windows_amd64.zip&quot;</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="op">&amp;</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\influxdb-1.8.10-1\influxd.exe&quot;</span></span></code></pre></div>
<h3 id="install-ubuntu">Install Ubuntu</h3>
<div class="sourceCode" id="cb113"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://dl.influxdata.com/influxdb/releases/influxdb_1.8.10_amd64.deb</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> dpkg <span class="at">-i</span> influxdb_1.8.10_amd64.deb</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> start influxdb</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> status influxdb</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ps</span> aux <span class="kw">|</span> <span class="fu">grep</span> influxdb <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-Ev</span> <span class="st">&quot;grep&quot;</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="fu">netstat</span> <span class="at">-natpl</span> <span class="kw">|</span> <span class="fu">grep</span> 80<span class="pp">[</span><span class="ss">8</span><span class="pp">-</span><span class="ss">9</span><span class="pp">][</span><span class="ss">3</span><span class="pp">-</span><span class="ss">9</span><span class="pp">]</span></span></code></pre></div>
<h3 id="api">API</h3>
<div class="sourceCode" id="cb114"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> /etc/influxdb/influxdb.conf</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="ex">[http]</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="ex">enabled</span> = true</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="ex">bind-address</span> = <span class="st">&quot;:8086&quot;</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="ex">auth-enabled</span> = false</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> restart influxdb</span></code></pre></div>
<h3 id="chronograf">Chronograf</h3>
<pre><code>wget https://dl.influxdata.com/chronograf/releases/chronograf-1.10.2_windows_amd64.zip -UseBasicParsing -OutFile chronograf-1.10.2_windows_amd64.zip
Expand-Archive .\chronograf-1.10.2_windows_amd64.zip -DestinationPath &#39;C:\Program Files\InfluxData\chronograf\&#39;

wget https://dl.influxdata.com/chronograf/releases/chronograf_1.10.2_amd64.deb
sudo dpkg -i chronograf_1.10.2_amd64.deb
systemctl status influxdb
http://192.168.3.102:8888</code></pre>
<h3 id="grafana">Grafana</h3>
<p><a href="https://grafana.com/grafana/download">Download</a></p>
<p><code>invoke-RestMethod https://dl.grafana.com/enterprise/release/grafana-enterprise-10.3.1.windows-amd64.msi -OutFile "$home\Download\grafana.msi"</code></p>
<div class="sourceCode" id="cb116"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="ex">apt-get</span> install <span class="at">-y</span> adduser libfontconfig1 musl</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://dl.grafana.com/enterprise/release/grafana-enterprise_10.3.1_amd64.deb</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="ex">dpkg</span> <span class="at">-i</span> grafana-enterprise_10.3.1_amd64.deb</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> start grafana-server</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="ex">systemctl</span> status grafana-server</span></code></pre></div>
<h3 id="cli-client">CLI Client</h3>
<p><code>apt install influxdb-client</code><br />
<code>influx</code><br />
<code>influx --host 192.168.3.102 --username admin --password password</code></p>
<div class="sourceCode" id="cb117"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="va">$influx_client_exec</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Documents\influxdb-1.8.10-1\influx.exe&quot;</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="op">&amp;</span> <span class="va">$influx_client_exec</span> <span class="op">-</span>host <span class="dv">192.168</span><span class="op">.</span><span class="dv">3.102</span> <span class="op">-</span>port <span class="dv">8086</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="dt">help</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>show databases</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>use PowerShell</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> <span class="st">&quot;HardwareMonitor&quot;</span> <span class="fu">WHERE</span> time <span class="op">&gt;</span> now<span class="op">()</span> <span class="op">-</span> 5m</span></code></pre></div>
<h3 id="users">USERS</h3>
<p><code>SHOW USERS</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö –ø—Ä–∞–≤–∞
–¥–æ—Å—Ç—É–ø–∞<br />
<code>CREATE USER admin WITH PASSWORD 'password' WITH ALL PRIVILEGES</code>
—Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>GRANT ALL PRIVILEGES TO "admin"</code> –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞
–¥–æ—Å—Ç—É–ø–∞<br />
<code>GRANT READ ON "database" TO "admin"</code> –¥–æ—Å—Ç—É–ø –Ω–∞ —á—Ç–µ–Ω–∏–µ –¥–ª—è –ë–î
–∏–ª–∏ –∑–∞–ø–∏—Å—å (WRITE)<br />
<code>REVOKE ALL PRIVILEGES FROM "admin"</code> –æ—Ç–æ–∑–≤–∞—Ç—å –ø—Ä–∞–≤–∞
–¥–æ—Å—Ç—É–ø–∞<br />
<code>SHOW GRANTS FOR "admin"</code> –ë–î –∏ –ø—Ä–∏–≤–µ–ª–µ–≥–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è
—É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>SET PASSWORD FOR "admin" = 'new_password'</code> –∏–∑–º–µ–Ω–∏—Ç—å
–ø–∞—Ä–æ–ª—å<br />
<code>DROP USER "admin"</code> —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
<h3 id="database-2">DATABASE</h3>
<p><code>CREATE DATABASE powershell</code> —Å–æ–∑–¥–∞—Ç—å –ë–î<br />
<code>SHOW DATABASES</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ë–î<br />
<code>DROP DATABASE powershell</code> —É–¥–∞–ª–∏—Ç—å –ë–î<br />
<code>USE powershell</code><br />
<code>SHOW measurements</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã<br />
<code>INSERT performance,host=console,counter=CPU value=0.88</code>
–∑–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É performance</p>
<h3 id="measurement">MEASUREMENT</h3>
<p><code>SHOW TAG KEYS FROM "HardwareMonitor"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ —Ç—ç–≥–∏
–≤ —Ç–∞–±–ª–∏—Ü–µ<br />
<code>SHOW TAG VALUES FROM "HardwareMonitor" WITH KEY = "HardwareName"</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ç—ç–≥–∞<br />
<code>SHOW FIELD KEYS FROM "HardwareMonitor"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ Field
Tags –∏ –∏—Ö —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö<br />
<code>SHOW SERIES FROM "HardwareMonitor"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö
—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Ä–∏–π –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ. –°–µ—Ä–∏—è - —ç—Ç–æ –Ω–∞–±–æ—Ä —Ç–æ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö,
–∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Ç–µ–≥–æ–≤, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º
–≤—Ä–µ–º–µ–Ω–∏.<br />
<code>DROP SERIES FROM "HardwareMonitor"</code> –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤
—Ç–∞–±–ª–∏—Ü–µ<br />
<code>DROP MEASUREMENT "HardwareMonitor"</code> —É–¥–∞–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É</p>
<h3 id="selectwhere">SELECT/WHERE</h3>
<p><code>SELECT * FROM performance</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤
—Ç–∞–±–ª–∏—Ü–µ<br />
<code>SELECT value FROM performance</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Å—Ç–æ–ª–±—Ü—É
value (—Ç–æ–ª—å–∫–æ Field Keys)<br />
<code>SELECT * FROM performance limit 10</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å 10 –µ–¥–∏–Ω–∏—Ü
–¥–∞–Ω–Ω—ã—Ö<br />
<code>SELECT * FROM performance WHERE time &gt; now() -2d</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 –¥–Ω—è<br />
<code>SELECT * FROM performance WHERE time &gt; now() +3h -5m</code>
–¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –º–∏–Ω—É—Ç (+3 —á–∞—Å–∞ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ UTC 0 -5
–º–∏–Ω—É—Ç)<br />
<code>SELECT * FROM performance WHERE counter = 'CPU'</code> –≤—ã–±–æ—Ä–∫–∞ –ø–æ
—Ç—ç–≥—É<br />
<code>SELECT upload/1000 FROM speedtest WHERE upload/1000 &lt;= 250</code>
–≤—ã–±–æ—Ä–∫–∞ –ø–æ —Å—Ç–æ–ª–±—Ü—É upload –∏ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≤—ã–≤–æ–¥ –Ω–∞ 1000, –≤—ã–≤–µ—Å—Ç–∏ upload
–º–µ–Ω—å—à–µ 250<br />
<code>DELETE FROM performance WHERE time &gt; now() -1h</code> —É–¥–∞–ª–∏—Ç—å
–¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 1/4 —á–∞—Å–∞<br />
<code>DELETE FROM performance WHERE time &lt; now() -24h</code> —É–¥–∞–ª–∏—Ç—å
–¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤</p>
<h3 id="regex-1">REGEX</h3>
<p><code>SELECT * FROM "win_pdisk" WHERE instance =~/.*C:/ and time &gt; now() - 5m</code>
–∏<br />
<code>SELECT * FROM "win_pdisk" WHERE instance =~/.*E:/ or instance =~ /.*F:/</code>
–∏–ª–∏<br />
<code>SELECT * FROM "win_pdisk" WHERE instance !~ /.*Total/</code> –Ω–µ
—Ä–∞–≤–Ω–æ (–∏—Å–∫–ª—é—á–∏—Ç—å)<br />
<code>SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m and HardwareName =~ /Intel/</code>
–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–≤–Ω–æ<br />
<code>SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m and HardwareName =~ /Intel.+i7/</code>
—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç 12th_Gen_Intel_Core_i7-1260P<br />
<code>SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m and HardwareName =~ /^Intel/</code>
–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ Intel<br />
<code>SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m and HardwareName =~ /00$/</code>
–∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 00</p>
<h3 id="group-by-tag_key">GROUP BY tag_key</h3>
<p><code>SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m and SensorName = 'Temperature' GROUP BY HardwareName</code>
—Å–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≥—Ä—É–ø–ø—ã –ø–æ —Ç—ç–≥—É HardwareName<br />
<code>SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m and SensorName = 'Temperature' GROUP BY Host,HardwareName</code>
–±–æ–ª—å—à–µ –≥—Ä—É–ø–ø –ø–æ –¥–≤—É–º —Ç—ç–≥–∞–∞–º</p>
<h3 id="functionsfield_key">Functions(field_key)</h3>
<p><a
href="https://docs.influxdata.com/influxdb/v1.8/query_language/functions">Functions</a></p>
<p><code>SELECT instance,LAST(Avg._Disk_Read_Queue_Length) FROM "win_pdisk" GROUP BY instance</code>
–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É/—Ç–µ–∫—É—â–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é<br />
<code>SELECT instance,FIRST(Avg._Disk_Read_Queue_Length) FROM "win_pdisk" GROUP BY instance</code>
–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ –ø–µ—Ä–≤–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –∑–∞ –≤–µ—Å—å –∏–ª–∏ —É–∫–∞–∑–∞–Ω–Ω—ã–π –æ—Ç—Ä–µ–∑–æ–∫
–≤—Ä–µ–º–µ–Ω–∏<br />
<code>SELECT instance,MIN(Avg._Disk_Read_Queue_Length) FROM "win_pdisk" GROUP BY instance</code>
–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è<br />
<code>SELECT instance,MAX(Avg._Disk_Read_Queue_Length) FROM "win_pdisk" GROUP BY instance</code>
–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è<br />
<code>SELECT SUM(Bytes_Received_persec) FROM "win_net" GROUP BY instance</code>
—Å—É–º–º–∞—Ö –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π<br />
<code>SELECT COUNT(Bytes_Received_persec) FROM "win_net" WHERE Bytes_Received_persec &gt;= 0 GROUP BY instance</code>
–∫–æ–ª-–≤–æ –¥–∞–Ω–Ω—ã—Ö, –≥–¥–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ 0<br />
<code>SELECT MEAN(Bytes_Received_persec) FROM "win_net" WHERE Bytes_Received_persec &lt; 1000 GROUP BY instance</code>
—Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º –æ—Ç 0 –¥–æ 1000 (509)</p>
<p><code>SELECT *,MAX(Value) FROM "HardwareMonitor" WHERE time &gt; now() -1h GROUP BY SensorName,Host</code>
—Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—ã –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–±—Ü–∞
Value –∫–∞–∂–¥–æ–≥–æ —Ç—ç–≥–∞ SensorName –∏ —Ö–æ—Å—Ç–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å<br />
<code>SELECT *,MAX(Value) FROM "HardwareMonitor" WHERE time &gt; now() -1h and SensorName = 'CPU_Package' GROUP BY Host</code>
–º–∞—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ CPU_Package –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
—Ö–æ—Å—Ç–∞<br />
<code>SELECT MEAN(Value) FROM "HardwareMonitor" WHERE time &gt; now() -1h and SensorName = 'CPU_Package' GROUP BY Host</code>
—Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ CPU_Package –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å</p>
<h3 id="policy">POLICY</h3>
<p><code>CREATE DATABASE powershell WITH DURATION 48h REPLICATION 1 NAME "del2d"</code>
—Å–æ–∑–¥–∞—Ç—å –ë–î —Å –ø–æ–ª–∏—Ç–∏–∫–æ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è 2 –¥–Ω—è<br />
<code>CREATE RETENTION POLICY del2h ON powershell DURATION 2h REPLICATION 1</code>
—Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ø–æ–ª–∏—Ç–∏–∫—É —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è –ë–î<br />
<code>CREATE RETENTION POLICY del6h ON powershell DURATION 6h REPLICATION 1 SHARD DURATION 2h</code>
—É–∫–∞–∑–∞—Ç—å –ø–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è 6 —á–∞—Å–æ–≤ + 2 —á–∞—Å–∞ –¥–æ –æ—á–∏—Å—Ç–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1—á –∏–ª–∏
–±–æ–ª—å—à–µ)<br />
<code>ALTER RETENTION POLICY del6h ON powershell DEFAULT</code> –∏–∑–º–µ–Ω–∏—Ç—å
(ALTER) –ø–æ–ª–∏—Ç–∏–∫—É —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è –ë–î –Ω–∞ del6h (DEFAULT)<br />
<code>DROP RETENTION POLICY del2d ON powershell</code> —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏
—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ–º—É —É–¥–∞–ª–µ–Ω–∏—é –≤—Å–µ—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π (—Ç–∞–±–ª–∏—Ü) –∏
–¥–∞–Ω–Ω—ã—Ö, —Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è –≤ –ø–æ–ª–∏—Ç–∏–∫–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è<br />
<code>SHOW RETENTION POLICIES ON PowerShell</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å
–¥–µ–π—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PowerShell</p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="va">$data</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> http<span class="op">://</span><span class="dv">192.168</span><span class="op">.</span><span class="dv">3.102</span><span class="op">:</span><span class="dv">8086</span><span class="op">/</span>query<span class="op">?</span>q<span class="op">=</span><span class="st">&quot;SHOW RETENTION POLICIES ON PowerShell&quot;</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="va">$col</span> <span class="op">=</span> <span class="va">$data</span><span class="op">.</span><span class="fu">results</span><span class="op">.</span><span class="fu">series</span><span class="op">.</span><span class="fu">columns</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="va">$val</span> <span class="op">=</span> <span class="va">$data</span><span class="op">.</span><span class="fu">results</span><span class="op">.</span><span class="fu">series</span><span class="op">.</span><span class="fu">values</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="va">$mass</span>    <span class="op">=</span> <span class="op">@()</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="va">$mass</span>   <span class="op">+=</span> <span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$col</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$v</span> <span class="kw">in</span> <span class="va">$val</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">$mass</span> <span class="op">+=</span> <span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$v</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="va">$mass</span> <span class="op">=</span> <span class="va">$mass</span> <span class="op">-replace</span> <span class="st">&#39;^&#39;</span><span class="op">,</span><span class="st">&#39;&quot;&#39;</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="va">$mass</span> <span class="op">=</span> <span class="va">$mass</span> <span class="op">-replace</span> <span class="st">&#39;$&#39;</span><span class="op">,</span><span class="st">&#39;&quot;&#39;</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a><span class="va">$mass</span> <span class="op">=</span> <span class="va">$mass</span> <span class="op">-replace</span> <span class="st">&#39;\s&#39;</span><span class="op">,</span><span class="st">&#39;&quot;,&quot;&#39;</span></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="va">$mass</span> <span class="op">|</span> <span class="fu">ConvertFrom-Csv</span></span></code></pre></div>
<h3 id="api-post">API POST</h3>
<p>–í–º–µ—Å—Ç–æ —Ç–∞–±–ª–∏—Ü –≤ InfluxDB –∏–º–µ—é—Ç—Å—è –∏–∑–º–µ—Ä–µ–Ω–∏—è. –í–º–µ—Å—Ç–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ –Ω–µ–π
–µ—Å—Ç—å —Ç–µ–≥–∏ –∏ –ø–æ–ª—è.</p>
<pre><code>   Table                        Tag (string/int)                          Field (double/int)           TIMESTAMP
measurement,Tag_Keys1=Tag_Values1,Tag_Keys2=Tag_Values2 Field_Keys1=&quot;Values&quot;,Field_Keys2=&quot;Values&quot; 0000000000000000000
           1                                           2                                         3

$ip        = &quot;192.168.3.104&quot;
$port      = &quot;8086&quot;
$db        = &quot;powershell&quot;
$table     = &quot;speedtest&quot;
$ipp       = $ip+&quot;:&quot;+$port
$url       = &quot;http://$ipp/write?db=$db&quot;
$user      = &quot;admin&quot;
$pass      = &quot;password&quot; | ConvertTo-SecureString -AsPlainText -Force
$cred      = [System.Management.Automation.PSCredential]::new($user,$pass)
$unixtime  = (New-TimeSpan -Start (Get-Date &quot;01/01/1970&quot;) -End (Get-Date)).TotalSeconds
$timestamp = ([string]$unixtime -replace &quot;\..+&quot;) + &quot;000000000&quot;

Invoke-RestMethod -Method POST -Uri $url -Body &quot;$table,host=$(hostname) download=200000,upload=300000,ping=3 $timestamp&quot;</code></pre>
<h3 id="api-get">API GET</h3>
<p><code>curl http://192.168.3.104:8086/query --data-urlencode "q=SHOW DATABASES"</code>
pwsh7 (ConvertFrom-Json) and bash</p>
<p><code>$dbs = irm "http://192.168.3.104:8086/query?q=SHOW DATABASES"</code><br />
<code>$dbs = irm "http://192.168.3.104:8086/query?epoch=ms&amp;u=admin&amp;p=password&amp;q=SHOW DATABASES"</code><br />
<code>$dbs.results.series.values</code></p>
<div class="sourceCode" id="cb120"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="va">$ip</span>    <span class="op">=</span> <span class="st">&quot;192.168.3.104&quot;</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="va">$port</span>  <span class="op">=</span> <span class="st">&quot;8086&quot;</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="va">$db</span>    <span class="op">=</span> <span class="st">&quot;powershell&quot;</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="va">$table</span> <span class="op">=</span> <span class="st">&quot;speedtest&quot;</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="va">$query</span> <span class="op">=</span> <span class="st">&quot;SELECT * FROM </span><span class="va">$table</span><span class="st">&quot;</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="va">$ipp</span>   <span class="op">=</span> <span class="va">$ip</span><span class="op">+</span><span class="st">&quot;:&quot;</span><span class="op">+</span><span class="va">$port</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="va">$url</span>   <span class="op">=</span> <span class="st">&quot;http://</span><span class="va">$ipp</span><span class="st">/query?db=</span><span class="va">$db</span><span class="st">&amp;q=</span><span class="va">$query</span><span class="st">&quot;</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="va">$data</span>  <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method GET <span class="op">-</span>Uri <span class="va">$url</span><span class="ch">` </span><span class="op">-</span>Credential <span class="va">$cred</span> </span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="va">$data</span><span class="op">.</span><span class="fu">results</span><span class="op">.</span><span class="fu">series</span><span class="op">.</span><span class="fu">name</span>   <span class="ch">` </span>–∏–º—è —Ç–∞–±–ª–∏—Ü—ã</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="va">$data</span><span class="op">.</span><span class="fu">results</span><span class="op">.</span><span class="fu">series</span><span class="op">.</span><span class="fu">columns</span><span class="ch">` </span>—Å—Ç–æ–ª–±—Ü—ã<span class="op">/</span>–∫–ª—é—á–∏</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="va">$data</span><span class="op">.</span><span class="fu">results</span><span class="op">.</span><span class="fu">series</span><span class="op">.</span><span class="fu">values</span> <span class="ch">` </span>–¥–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ</span></code></pre></div>
<h3 id="endpoints">Endpoints</h3>
<p><a href="https://docs.influxdata.com/influxdb/v1.7/tools/api/">API
doc</a></p>
<div class="sourceCode" id="cb121"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="va">$stats</span> <span class="op">=</span> <span class="fu">irm</span> http<span class="op">://</span><span class="dv">192.168</span><span class="op">.</span><span class="dv">3.104</span><span class="op">:</span><span class="dv">8086</span><span class="op">/</span>debug<span class="op">/</span>vars<span class="ch">` </span>—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="va">$stats</span><span class="op">.</span><span class="st">&quot;database:powershell&quot;</span><span class="op">.</span><span class="fu">values</span><span class="ch">` </span>–∫–æ–ª-–≤–æ —Ç–∞–±–ª–∏—Ü –∫ –ë–î</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="va">$stats</span><span class="op">.</span><span class="fu">queryExecutor</span><span class="op">.</span><span class="fu">values</span><span class="ch">` </span>–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ query-–∑–∞–ø—Ä–æ—Å–æ–≤ <span class="op">(</span>–æ–±—Ä–∞—â–µ–Ω–∏–π –∫ endpoint <span class="op">/</span>query<span class="op">)</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="va">$stats</span><span class="op">.</span><span class="fu">write</span><span class="op">.</span><span class="fu">values</span><span class="ch">` </span>–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ write-–∑–∞–ø—Ä–æ—Å–æ–≤</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="va">$stats</span><span class="op">.</span><span class="fu">system</span><span class="op">.</span><span class="fu">uptime</span></span></code></pre></div>
<p><code>http://192.168.3.104:8086/debug/requests</code> –∫–æ–ª-–≤–æ
–∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –∫–æ–Ω–µ—á–Ω—ã–º —Ç–æ—á–∫–∞–º /write–∏ /query<br />
<code>http://192.168.3.104:8086/debug/pprof</code><br />
<code>http://192.168.3.104:8086/ping</code><br />
<code>http://192.168.3.104:8086/query</code><br />
<code>http://192.168.3.104:8086/write</code></p>
<p><code>http://192.168.3.99:8086/api/v2/setup</code><br />
<code>http://192.168.3.99:8086/api/v2/config</code><br />
<code>http://192.168.3.99:8086/api/v2/write</code></p>
<h3 id="pingto-influxdb">PingTo-InfluxDB</h3>
<div class="sourceCode" id="cb122"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span><span class="va">$true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">$tz</span> <span class="op">=</span> <span class="op">(</span>Get-TimeZone<span class="op">).</span><span class="fu">BaseUtcOffset</span><span class="op">.</span><span class="fu">TotalMinutes</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">$unixtime</span>  <span class="op">=</span> <span class="op">(</span><span class="fu">New-TimeSpan</span> <span class="op">-</span>Start <span class="op">(</span><span class="fu">Get-Date</span> <span class="st">&quot;01/01/1970&quot;</span><span class="op">)</span> <span class="op">-</span>End <span class="op">((</span><span class="fu">Get-Date</span><span class="op">).</span><span class="fu">AddMinutes</span><span class="op">(-</span><span class="va">$tz</span><span class="op">))).</span><span class="fu">TotalSeconds</span><span class="ch">` </span><span class="op">-</span>3h UTC</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">$timestamp</span> <span class="op">=</span> <span class="op">([</span><span class="dt">string</span><span class="op">]</span><span class="va">$unixtime</span> <span class="op">-replace</span> <span class="st">&quot;\..+&quot;</span><span class="op">)</span> <span class="op">+</span> <span class="st">&quot;000000000&quot;</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">$tnc</span> <span class="op">=</span> tnc <span class="dv">8.8</span><span class="op">.</span><span class="dv">8.8</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">$Status</span> <span class="op">=</span> <span class="va">$tnc</span><span class="op">.</span><span class="fu">PingSucceeded</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">$RTime</span> <span class="op">=</span> <span class="va">$tnc</span><span class="op">.</span><span class="fu">PingReplyDetails</span><span class="op">.</span><span class="fu">RoundtripTime</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method POST <span class="op">-</span>Uri <span class="st">&quot;http://192.168.3.104:8086/write?db=powershell&quot;</span> <span class="op">-</span>Body <span class="st">&quot;ping,host=</span><span class="op">$(</span>hostname<span class="op">)</span><span class="st"> status=</span><span class="va">$status</span><span class="st">,rtime=</span><span class="va">$RTime</span><span class="st"> </span><span class="va">$timestamp</span><span class="st">&quot;</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sleep</span> <span class="dv">1</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>SELECT * FROM ping WHERE status = false</code></p>
<h3 id="performanceto-influxdb">PerformanceTo-InfluxDB</h3>
<div class="sourceCode" id="cb123"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> ConvertTo-Encoding <span class="op">([</span><span class="dt">string</span><span class="op">]</span><span class="va">$From</span><span class="op">,</span> <span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$To</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Begin</span> <span class="op">{</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">$encFrom</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Text</span><span class="op">.</span><span class="fu">Encoding</span><span class="op">]::</span>GetEncoding<span class="op">(</span><span class="va">$from</span><span class="op">)</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">$encTo</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Text</span><span class="op">.</span><span class="fu">Encoding</span><span class="op">]::</span>GetEncoding<span class="op">(</span><span class="va">$to</span><span class="op">)</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">Process</span> <span class="op">{</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">$bytes</span> <span class="op">=</span> <span class="va">$encTo</span><span class="op">.</span><span class="fu">GetBytes</span><span class="op">(</span><span class="va">$_</span><span class="op">)</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">$bytes</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Text</span><span class="op">.</span><span class="fu">Encoding</span><span class="op">]::</span>Convert<span class="op">(</span><span class="va">$encFrom</span><span class="op">,</span> <span class="va">$encTo</span><span class="op">,</span> <span class="va">$bytes</span><span class="op">)</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">$encTo</span><span class="op">.</span><span class="fu">GetString</span><span class="op">(</span><span class="va">$bytes</span><span class="op">)</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="va">$localization</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Culture</span><span class="op">).</span><span class="fu">LCID</span><span class="ch">` </span>—Ç–µ–∫—É—â–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$localization</span> <span class="op">-eq</span> <span class="dv">1049</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>    <span class="va">$performance</span> <span class="op">=</span> <span class="st">&quot;\\</span><span class="op">$(</span>hostname<span class="op">)</span><span class="st">\–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä(_Total)\% –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞&quot;</span> <span class="op">|</span> ConvertTo-Encoding UTF-8 windows-1251<span class="ch">` </span>–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∫–∏—Ä–∏–ª–ª–∏—Ü—É</span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>    <span class="va">$performance</span> <span class="op">=</span> <span class="st">&quot;\Processor(_Total)\% Processor Time&quot;</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a><span class="va">$tz</span> <span class="op">=</span> <span class="op">(</span>Get-TimeZone<span class="op">).</span><span class="fu">BaseUtcOffset</span><span class="op">.</span><span class="fu">TotalMinutes</span></span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span><span class="va">$true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>    <span class="va">$unixtime</span>  <span class="op">=</span> <span class="op">(</span><span class="fu">New-TimeSpan</span> <span class="op">-</span>Start <span class="op">(</span><span class="fu">Get-Date</span> <span class="st">&quot;01/01/1970&quot;</span><span class="op">)</span> <span class="op">-</span>End <span class="op">((</span><span class="fu">Get-Date</span><span class="op">).</span><span class="fu">AddMinutes</span><span class="op">(-</span><span class="va">$tz</span><span class="op">))).</span><span class="fu">TotalSeconds</span><span class="ch">` </span><span class="op">-</span>3h UTC</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>    <span class="va">$timestamp</span> <span class="op">=</span> <span class="op">([</span><span class="dt">string</span><span class="op">]</span><span class="va">$unixtime</span> <span class="op">-replace</span> <span class="st">&quot;\..+&quot;</span><span class="op">)</span> <span class="op">+</span> <span class="st">&quot;000000000&quot;</span></span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="dt">double</span><span class="op">]</span><span class="va">$value</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Counter</span> <span class="va">$performance</span><span class="op">).</span><span class="fu">CounterSamples</span><span class="op">.</span><span class="fu">CookedValue</span><span class="op">.</span><span class="fu">ToString</span><span class="op">(</span><span class="st">&quot;0.00&quot;</span><span class="op">).</span><span class="fu">replace</span><span class="op">(</span><span class="st">&quot;,&quot;</span><span class="op">,</span><span class="st">&quot;.&quot;</span><span class="op">)</span><span class="ch">` </span>–æ–∫—Ä—É–≥–ª–∏—Ç—å –≤ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö Double</span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method POST <span class="op">-</span>Uri <span class="st">&quot;http://192.168.3.104:8086/write?db=powershell&quot;</span> <span class="op">-</span>Body <span class="st">&quot;performance,host=</span><span class="op">$(</span>hostname<span class="op">)</span><span class="st">,counter=CPU value=</span><span class="va">$value</span><span class="st"> </span><span class="va">$timestamp</span><span class="st">&quot;</span></span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sleep</span> <span class="dv">5</span></span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="service">Service</h3>
<div class="sourceCode" id="cb124"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="va">$powershell_Path</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Command</span> powershell<span class="op">).</span><span class="fu">Source</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="va">$NSSM_Path</span> <span class="op">=</span> <span class="st">&quot;C:\NSSM\NSSM-2.24.exe&quot;</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Script_Path</span> <span class="op">=</span> <span class="st">&quot;C:\NSSM\PerformanceTo-InfluxDB.ps1&quot;</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="va">$Service_Name</span> <span class="op">=</span> <span class="st">&quot;PerformanceTo-InfluxDB&quot;</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="op">&amp;</span> <span class="va">$NSSM_Path</span> install <span class="va">$Service_Name</span> <span class="va">$powershell_Path</span> <span class="op">-</span>ExecutionPolicy Bypass <span class="op">-</span>NoProfile <span class="op">-</span>f <span class="va">$Script_Path</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Service</span> <span class="va">$Service_Name</span> <span class="op">|</span> <span class="fu">Start-Service</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Service</span> <span class="va">$Service_Name</span> <span class="op">|</span> <span class="fu">Set-Service</span> <span class="op">-</span>StartupType Automatic</span></code></pre></div>
<h1 id="telegraf">Telegraf</h1>
<p><a
href="https://docs.influxdata.com/telegraf/v1.27/plugins/#input-plugins">Plugins</a></p>
<p><code>iwr https://dl.influxdata.com/telegraf/releases/telegraf-1.27.1_windows_amd64.zip -UseBasicParsing -OutFile telegraf-1.27.1_windows_amd64.zip</code><br />
<code>Expand-Archive .\telegraf-1.27.1_windows_amd64.zip -DestinationPath "C:\Telegraf"</code><br />
<code>rm telegraf-1.27.1_windows_amd64.zip</code><br />
<code>cd C:\Telegraf</code><br />
<code>.\telegraf.exe -sample-config --input-filter cpu:mem:dns_query --output-filter influxdb &gt; telegraf_nt.conf</code>
—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å –≤—ã–±–∞—Ä–Ω–Ω—ã–º–∏ –ø–ª–∞–≥–∏–Ω–∞–º–∏ –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫<br />
<code>Start-Process notepad++ C:\Telegraf\telegraf_nt.conf</code></p>
<pre><code>[[outputs.influxdb]]
  urls = [&quot;http://192.168.3.104:8086&quot;]
  database = &quot;telegraf_nt&quot;
  username = &quot;user&quot;
  password = &quot;pass&quot;
[[inputs.cpu]]
  percpu = false
  totalcpu = true
[[inputs.dns_query]]
  servers = [&quot;8.8.8.8&quot;]
  network = &quot;udp&quot;
  domains = [&quot;.&quot;]
  record_type = &quot;A&quot;
  port = 53
  timeout = &quot;2s&quot;</code></pre>
<p><code>.\telegraf.exe --test -config C:\Telegraf\telegraf_nt.conf</code>
—Ç–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ —Å –≤—ã–≤–æ–¥–æ–º –≤ –∫–æ–Ω—Å–æ–ª—å)<br />
<code>C:\Telegraf\telegraf.exe -config C:\Telegraf\telegraf_nt.conf</code>
–∑–∞–ø—É—Å—Ç–∏—Ç—å telegraf (—Ç–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö)<br />
<code>.\telegraf.exe --config "C:\Telegraf\telegraf_nt.conf" --service install</code>
—Å–æ–∑–¥–∞—Ç—å —Å–ª—É–∂–±—É<br />
<code>Get-Service telegraf | Start-Service</code><br />
<code>.\telegraf.exe --service uninstall</code></p>
<p><code>USE telegraf</code><br />
<code>SELECT usage_idle,usage_system,usage_user FROM cpu</code></p>
<h1 id="elasticsearch">Elasticsearch</h1>
<p><code>Install-Module -Name Elastic.Console -AllowPrerelease</code> <a
href="https://github.com/elastic/powershell/blob/master/Elastic.Console/README.md">github
source</a><br />
<code>Get-Command -Module Elastic.Console</code><br />
<code>Get-ElasticsearchVersion</code><br />
<code>Set-ElasticsearchVersion 7.3.0</code><br />
<code>Invoke-Elasticsearch</code> REST API –∑–∞–ø—Ä–æ—Å—ã</p>
<h1 id="cdata">CData</h1>
<p><a href="https://www.powershellgallery.com/profiles/CData">PowerShell
Gallery CData</a><br />
<a
href="https://www.cdata.com/kb/tech/elasticsearch-ado-powershell.rst">Automate
Elasticsearch Integration Tasks from PowerShell</a></p>
<p><code>Install-Module ElasticsearchCmdlets</code> <a
href="https://www.powershellgallery.com/packages/ElasticsearchCmdlets/23.0.8565.1">–ø–∞–∫–µ—Ç
–¥—Ä–∞–π–≤–µ—Ä–∞ –≤ psgallery</a><br />
<code>Import-Module ElasticsearchCmdlets</code><br />
<code>Get-Command -Module ElasticsearchCmdlets</code></p>
<div class="sourceCode" id="cb126"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="va">$elasticsearch</span> <span class="op">=</span> Connect-Elasticsearch  <span class="op">-</span>Server <span class="st">&quot;</span><span class="va">$Server</span><span class="st">&quot;</span> <span class="op">-</span>Port <span class="st">&quot;</span><span class="va">$Port</span><span class="st">&quot;</span> <span class="op">-</span>User <span class="st">&quot;</span><span class="va">$User</span><span class="st">&quot;</span> <span class="op">-</span>Password <span class="st">&quot;</span><span class="va">$Password</span><span class="st">&quot;</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="va">$shipcity</span> <span class="op">=</span> <span class="st">&quot;New York&quot;</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="va">$orders</span> <span class="op">=</span> Select-Elasticsearch <span class="op">-</span>Connection <span class="va">$elasticsearch</span> <span class="op">-</span>Table <span class="st">&quot;Orders&quot;</span> <span class="op">-</span>Where <span class="st">&quot;ShipCity = </span><span class="ch">`&#39;</span><span class="va">$ShipCity</span><span class="ch">`&#39;</span><span class="st">&quot;</span><span class="ch">` </span>–ø–æ–∏—Å–∫ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="va">$orders</span> <span class="op">=</span> Invoke-Elasticsearch <span class="op">-</span>Connection <span class="va">$elasticsearch</span> <span class="op">-</span>Query <span class="st">&#39;SELECT * FROM Orders WHERE ShipCity = @ShipCity&#39;</span> <span class="op">-</span>Params @<span class="op">{</span><span class="st">&#39;@ShipCity&#39;</span><span class="op">=</span><span class="st">&#39;New York&#39;</span><span class="op">}</span><span class="ch">` </span>SQL –∑–∞–ø—Ä–æ—Å—ã</span></code></pre></div>
<h3 id="ado.net-assembly">ADO.NET Assembly</h3>
<p><code>Install-Package CData.Elasticsearch</code> <a
href="https://www.nuget.org/packages/CData.Elasticsearch">–ø–∞–∫–µ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞
–≤ nuget</a><br />
<code>[Reflection.Assembly]::LoadFile("C:\Program Files\PackageManagement\NuGet\Packages\CData.Elasticsearch.23.0.8565\lib\net40\System.Data.CData.Elasticsearch.dll")</code></p>
<div class="sourceCode" id="cb127"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="va">$connect</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">CData</span><span class="op">.</span><span class="fu">Elasticsearch</span><span class="op">.</span><span class="fu">ElasticsearchConnection</span><span class="op">(</span><span class="st">&quot;Server=127.0.0.1;Port=9200;User=admin;Password=123456;&quot;</span><span class="op">)</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="va">$connect</span><span class="op">.</span><span class="fu">Open</span><span class="op">()</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="va">$sql</span> <span class="op">=</span> <span class="st">&quot;SELECT OrderName, Freight from Orders&quot;</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="va">$da</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">CData</span><span class="op">.</span><span class="fu">Elasticsearch</span><span class="op">.</span><span class="fu">ElasticsearchDataAdapter</span><span class="op">(</span><span class="va">$sql</span><span class="op">,</span> <span class="va">$conn</span><span class="op">)</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="va">$dt</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">DataTable</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="va">$da</span><span class="op">.</span><span class="fu">Fill</span><span class="op">(</span><span class="va">$dt</span><span class="op">)</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="va">$dt</span><span class="op">.</span><span class="fu">Rows</span> <span class="op">|</span> <span class="cf">foreach</span> <span class="op">{</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="va">$_</span><span class="op">.</span><span class="fu">ordername</span> <span class="va">$_</span><span class="op">.</span><span class="fu">freight</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="update-1">UPDATE</h3>
<div class="sourceCode" id="cb128"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>Update-Elasticsearch <span class="op">-</span>Connection <span class="va">$Elasticsearch</span> <span class="op">-</span>Columns <span class="op">@(</span><span class="st">&#39;OrderName&#39;</span><span class="op">,</span><span class="st">&#39;Freight&#39;</span><span class="op">)</span> <span class="op">-</span>Values <span class="op">@(</span><span class="st">&#39;MyOrderName&#39;</span><span class="op">,</span> <span class="st">&#39;MyFreight&#39;</span><span class="op">)</span> <span class="op">-</span>Table Orders <span class="op">-</span>Id <span class="st">&quot;MyId&quot;</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="va">$cmd</span> <span class="op">=</span>  <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">CData</span><span class="op">.</span><span class="fu">Elasticsearch</span><span class="op">.</span><span class="fu">ElasticsearchCommand</span><span class="op">(</span><span class="st">&quot;UPDATE Orders SET ShipCity=&#39;New York&#39; WHERE Id = @myId&quot;</span><span class="op">,</span> <span class="va">$conn</span><span class="op">)</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="va">$cmd</span><span class="op">.</span><span class="fu">Parameters</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span>new System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">CData</span><span class="op">.</span><span class="fu">Elasticsearch</span><span class="op">.</span><span class="fu">ElasticsearchParameter</span><span class="op">(</span><span class="st">&quot;@myId&quot;</span><span class="op">,</span><span class="st">&quot;10456255-0015501366&quot;</span><span class="op">))</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="va">$cmd</span><span class="op">.</span><span class="fu">ExecuteNonQuery</span><span class="op">()</span></span></code></pre></div>
<h3 id="insert-1">INSERT</h3>
<div class="sourceCode" id="cb129"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>Add-Elasticsearch <span class="op">-</span>Connection <span class="va">$Elasticsearch</span> <span class="op">-</span>Table Orders <span class="op">-</span>Columns <span class="op">@(</span><span class="st">&quot;OrderName&quot;</span><span class="op">,</span> <span class="st">&quot;Freight&quot;</span><span class="op">)</span> <span class="op">-</span>Values <span class="op">@(</span><span class="st">&quot;MyOrderName&quot;</span><span class="op">,</span> <span class="st">&quot;MyFreight&quot;</span><span class="op">)</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="va">$cmd</span> <span class="op">=</span>  <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">CData</span><span class="op">.</span><span class="fu">Elasticsearch</span><span class="op">.</span><span class="fu">ElasticsearchCommand</span><span class="op">(</span><span class="st">&quot;INSERT INTO Orders (ShipCity) VALUES (@myShipCity)&quot;</span><span class="op">,</span> <span class="va">$conn</span><span class="op">)</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="va">$cmd</span><span class="op">.</span><span class="fu">Parameters</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span>new System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">CData</span><span class="op">.</span><span class="fu">Elasticsearch</span><span class="op">.</span><span class="fu">ElasticsearchParameter</span><span class="op">(</span><span class="st">&quot;@myShipCity&quot;</span><span class="op">,</span><span class="st">&quot;New York&quot;</span><span class="op">))</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="va">$cmd</span><span class="op">.</span><span class="fu">ExecuteNonQuery</span><span class="op">()</span></span></code></pre></div>
<h3 id="delete-1">DELETE</h3>
<div class="sourceCode" id="cb130"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>Remove-Elasticsearch <span class="op">-</span>Connection <span class="va">$Elasticsearch</span> <span class="op">-</span>Table <span class="st">&quot;Orders&quot;</span> <span class="op">-</span>Id <span class="st">&quot;MyId&quot;</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="va">$cmd</span> <span class="op">=</span>  <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">CData</span><span class="op">.</span><span class="fu">Elasticsearch</span><span class="op">.</span><span class="fu">ElasticsearchCommand</span><span class="op">(</span><span class="st">&quot;DELETE FROM Orders WHERE Id=@myId&quot;</span><span class="op">,</span> <span class="va">$conn</span><span class="op">)</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="va">$cmd</span><span class="op">.</span><span class="fu">Parameters</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span>new System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">CData</span><span class="op">.</span><span class="fu">Elasticsearch</span><span class="op">.</span><span class="fu">ElasticsearchParameter</span><span class="op">(</span><span class="st">&quot;@myId&quot;</span><span class="op">,</span><span class="st">&quot;001d000000YBRseAAH&quot;</span><span class="op">))</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="va">$cmd</span><span class="op">.</span><span class="fu">ExecuteNonQuery</span><span class="op">()</span></span></code></pre></div>
<h1 id="odbc">ODBC</h1>
<p><code>Get-Command -Module Wdac</code><br />
<code>Get-OdbcDriver | ft</code> —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤</p>
<p><a
href="https://www.elastic.co/guide/en/elasticsearch/reference/current/sql-client-apps-ps1.html">Elasticsearch
ODBC –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º Elasticsearch –∏–∑ Microsoft
PowerShell</a></p>
<div class="sourceCode" id="cb131"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="va">$connectstring</span> <span class="op">=</span> <span class="st">&quot;DSN=Local Elasticsearch;&quot;</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="va">$sql</span> <span class="op">=</span> <span class="st">&quot;SELECT * FROM library&quot;</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="va">$conn</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">Odbc</span><span class="op">.</span><span class="fu">OdbcConnection</span><span class="op">(</span><span class="va">$connectstring</span><span class="op">)</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="va">$conn</span><span class="op">.</span><span class="fu">open</span><span class="op">()</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="va">$cmd</span> <span class="op">=</span> <span class="fu">New-Object</span> system<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">Odbc</span><span class="op">.</span><span class="fu">OdbcCommand</span><span class="op">(</span><span class="va">$sql</span><span class="op">,</span><span class="va">$conn</span><span class="op">)</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="va">$da</span> <span class="op">=</span> <span class="fu">New-Object</span> system<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">Odbc</span><span class="op">.</span><span class="fu">OdbcDataAdapter</span><span class="op">(</span><span class="va">$cmd</span><span class="op">)</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="va">$dt</span> <span class="op">=</span> <span class="fu">New-Object</span> system<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">datatable</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="va">$null</span> <span class="op">=</span> <span class="va">$da</span><span class="op">.</span><span class="fu">fill</span><span class="op">(</span><span class="va">$dt</span><span class="op">)</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="va">$conn</span><span class="op">.</span><span class="fu">close</span><span class="op">()</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="va">$dt</span></span></code></pre></div>
<h1 id="postgresql">PostgreSQL</h1>
<p><a href="https://www.postgresql.org/ftp/odbc/versions/msi/">–°–∫–∞—á–∞—Ç—å –∏
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä</a></p>
<div class="sourceCode" id="cb132"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="va">$dbServer</span> <span class="op">=</span> <span class="st">&quot;192.168.3.101&quot;</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="va">$port</span> <span class="op">=</span> <span class="st">&quot;5432&quot;</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="va">$dbName</span> <span class="op">=</span> <span class="st">&quot;test&quot;</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="va">$dbUser</span> <span class="op">=</span> <span class="st">&quot;admin&quot;</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="va">$dbPass</span> <span class="op">=</span> <span class="st">&quot;admin&quot;</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="va">$szConnect</span> <span class="op">=</span> <span class="st">&quot;Driver={PostgreSQL Unicode(x64)};Server=</span><span class="va">$dbServer</span><span class="st">;Port=</span><span class="va">$port</span><span class="st">;Database=</span><span class="va">$dbName</span><span class="st">;Uid=</span><span class="va">$dbUser</span><span class="st">;Pwd=</span><span class="va">$dbPass</span><span class="st">;&quot;</span> </span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="va">$cnDB</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">Odbc</span><span class="op">.</span><span class="fu">OdbcConnection</span><span class="op">(</span><span class="va">$szConnect</span><span class="op">)</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="va">$dsDB</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">DataSet</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span> <span class="op">{</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>    <span class="va">$cnDB</span><span class="op">.</span><span class="fu">Open</span><span class="op">()</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">$adDB</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">Odbc</span><span class="op">.</span><span class="fu">OdbcDataAdapter</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>    <span class="va">$adDB</span><span class="op">.</span><span class="fu">SelectCommand</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">Odbc</span><span class="op">.</span><span class="fu">OdbcCommand</span><span class="op">(</span><span class="st">&quot;SELECT id, name, age, login FROM public.users&quot;</span> <span class="op">,</span> <span class="va">$cnDB</span><span class="op">)</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>    <span class="va">$adDB</span><span class="op">.</span><span class="fu">Fill</span><span class="op">(</span><span class="va">$dsDB</span><span class="op">)</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>    <span class="va">$cnDB</span><span class="op">.</span><span class="fu">Close</span><span class="op">()</span></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="cf">catch</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">Odbc</span><span class="op">.</span><span class="fu">OdbcException</span><span class="op">]</span> <span class="op">{</span></span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>    <span class="va">$_</span><span class="op">.</span><span class="fu">Exception</span></span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a>    <span class="va">$_</span><span class="op">.</span><span class="fu">Exception</span><span class="op">.</span><span class="fu">Message</span></span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a>    <span class="va">$_</span><span class="op">.</span><span class="fu">Exception</span><span class="op">.</span><span class="fu">ItemName</span></span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$row</span> <span class="kw">in</span> <span class="va">$dsDB</span><span class="op">[</span><span class="dv">0</span><span class="op">].</span><span class="fu">Tables</span><span class="op">[</span><span class="dv">0</span><span class="op">].</span><span class="fu">Rows</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a>    <span class="va">$row</span><span class="op">.</span><span class="fu">login</span></span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a>    <span class="va">$row</span><span class="op">.</span><span class="fu">age</span></span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="wmi">WMI</h1>
<h3
id="wmicim-windows-management-instrumentationcommon-information-model">WMI/CIM
(Windows Management Instrumentation/Common Information Model)</h3>
<p><code>Get-WmiObjec -ComputerName localhost -Namespace root -class "__NAMESPACE" | select name,__namespace</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –¥–æ—á–µ—Ä–Ω–∏–∏ Namespace (–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –≥—Ä—É–ø–ø—ã)<br />
<code>Get-WmiObject -List</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –∫–ª–∞—Å—Å—ã –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω
‚Äúroot‚Äù (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), —Å–≤–æ–π—Å—Ç–≤–∞ (–æ–ø–∏—Å—ã–≤–∞—é—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ —Ç–µ–∫—É—â–µ–µ
—Å–æ—Å—Ç–æ—è–Ω–∏–µ —É–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞) –∏ –∏—Ö –º–µ—Ç–æ–¥—ã (–∫–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç
–≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞–¥ —ç—Ç–∏–º —Ä–µ—Å—É—Ä—Å–æ–º)<br />
<code>Get-WmiObject -List | Where-Object {$_.name -match "video"}</code>
–ø–æ–∏—Å–∫ –∫–ª–∞—Å—Å–∞ –ø–æ –∏–º–µ–Ω–∏, –µ–≥–æ —Å–≤–æ–π—Å—Ç–≤ –∏ –º–µ—Ç–æ–¥–æ–≤<br />
<code>Get-WmiObject -ComputerName localhost -Class Win32_VideoController</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–≤–æ–π—Å—Ç–≤ –∫–ª–∞—Å—Å–∞</p>
<p><code>gwmi -List | where name -match "service" | ft -auto</code> –µ—Å–ª–∏
–≤ —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç Methods, —Ç–æ –º–æ–∂–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å
{StartService, StopService}<br />
<code>gwmi -Class win32_service | select *</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö
—Å–ª—É–∂–± –∏ –≤—Å–µ—Ö –∏—Ö —Å–≤–æ–π—Å—Ç–≤<br />
<code>Get-CimInstance Win32_service</code> –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä—è–º—É—é –∫
‚Äúroot‚Äù<br />
<code>gwmi win32_service -Filter "name='Zabbix Agent'"</code>
–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ –∏–º–µ–Ω–∏<br />
<code>(gwmi win32_service -Filter "name='Zabbix Agent'").State</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ<br />
<code>gwmi win32_service -Filter "State = 'Running'"</code>
–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ —Å–ª—É–∂–±—ã<br />
<code>gwmi win32_service -Filter "StartMode = 'Auto'"</code>
–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–ª—É–∂–±—ã –ø–æ –º–µ—Ç–æ–¥—É –∑–∞–ø—É—Å–∫–∞<br />
<code>gwmi -Query 'select * from win32_service where startmode="Auto"'</code>
WQL-–∑–∞–ø—Ä–æ—Å (WMI Query Language)<br />
<code>gwmi win32_service | Get-Member -MemberType Method</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –º–µ—Ç–æ–¥—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è (Delete,
StartService)<br />
<code>(gwmi win32_service -Filter 'name="Zabbix Agent"').Delete()</code>
—É–¥–∞–ª–∏—Ç—å —Å–ª—É–∂–±—É<br />
<code>(gwmi win32_service -Filter 'name="MSSQL$MSSQLE"').StartService()</code>
–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É</p>
<p><code>Get-CimInstance -ComputerName $srv Win32_OperatingSystem | select LastBootUpTime</code>
–≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è<br />
<code>gwmi -ComputerName $srv -Class Win32_OperatingSystem | select LocalDateTime,LastBootUpTime</code>
—Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è<br />
<code>gwmi Win32_OperatingSystem | Get-Member -MemberType Method</code>
–º–µ—Ç–æ–¥—ã reboot –∏ shutdown<br />
<code>(gwmi Win32_OperatingSystem -EnableAllPrivileges).Reboot()</code>
–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å –∫–ª—é—á–µ–º –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–µ–ª–µ–≥–∏–π<br />
<code>(gwmi Win32_OperatingSystem -EnableAllPrivileges).Win32Shutdown(0)</code>
–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
<div class="sourceCode" id="cb133"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="va">$system</span> <span class="op">=</span> <span class="fu">Get-WmiObject</span> <span class="op">-</span>Class Win32_OperatingSystem</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="va">$InstallDate</span> <span class="op">=</span> <span class="op">[</span>Management<span class="op">.</span><span class="fu">ManagementDateTimeconverter</span><span class="op">]::</span>ToDateTime<span class="op">(</span><span class="va">$system</span><span class="op">.</span><span class="fu">installdate</span><span class="op">)</span><span class="ch">` </span>–ü–æ–ª—É—á–∞–µ–º –¥–∞—Ç—É —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –û–°</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="va">$AfterInstallDays</span> <span class="op">=</span> <span class="op">((</span><span class="fu">Get-Date</span><span class="op">)</span> ‚Äî <span class="va">$Installdate</span><span class="op">).</span><span class="fu">Days</span><span class="ch">` </span>–í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è<span class="op">,</span> –ø—Ä–æ—à–µ–¥—à–µ–µ —Å –º–æ–º–µ–Ω—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="va">$ShortInstallDate</span> <span class="op">=</span> <span class="st">&quot;{0:yyyy-MM-dd HH:MM}&quot;</span> <span class="op">-</span>f <span class="op">(</span><span class="va">$InstallDate</span><span class="op">)</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;–°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: </span><span class="va">$ShortInstallDate</span><span class="st"> (–ü—Ä–æ—à–ª–æ </span><span class="va">$AfterInstalldays</span><span class="st"> –¥–Ω–µ–π)&quot;</span></span></code></pre></div>
<p><code>(Get-WmiObject win32_battery).estimatedChargeRemaining</code>
–∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö<br />
<code>gwmi Win32_UserAccount</code> –¥–æ–º–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏<br />
<code>(gwmi Win32_SystemUsers).PartComponent</code><br />
<code>Get-CimInstance -ClassName Win32_LogonSession</code><br />
<code>Get-CimInstance -ClassName Win32_BIOS</code></p>
<p><code>gwmi -list -Namespace root\CIMV2\Terminalservices</code><br />
<code>(gwmi -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).AllowTSConnections</code><br />
<code>(gwmi -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).SetAllowTSConnections(1)</code>
–≤–∫–ª—é—á–∏—Ç—å RDP</p>
<pre><code>$srv = &quot;localhost&quot;
gwmi Win32_logicalDisk -ComputerName $srv | where {$_.Size -ne $null} | select @{
Label=&quot;Value&quot;; Expression={$_.DeviceID}}, @{Label=&quot;AllSize&quot;; Expression={
[string]([int]($_.Size/1Gb))+&quot; GB&quot;}},@{Label=&quot;FreeSize&quot;; Expression={
[string]([int]($_.FreeSpace/1Gb))+&quot; GB&quot;}}, @{Label=&quot;Free%&quot;; Expression={
[string]([int]($_.FreeSpace/$_.Size*100))+&quot; %&quot;}}</code></pre>
<h3 id="nla-network-level-authentication">NLA (Network Level
Authentication)</h3>
<p><code>(gwmi -class "Win32_TSGeneralSetting" -Namespace root\cimv2\Terminalservices -Filter "TerminalName='RDP-tcp'").UserAuthenticationRequired</code><br />
<code>(gwmi -class "Win32_TSGeneralSetting" -Namespace root\cimv2\Terminalservices -Filter "TerminalName='RDP-tcp'").SetUserAuthenticationRequired(1)</code>
–≤–∫–ª—é—á–∏—Ç—å NLA<br />
<code>Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name SecurityLayer</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (2)<br />
<code>Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name UserAuthentication</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (1)<br />
<code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name SecurityLayer -Value 0</code>
–∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ<br />
<code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name UserAuthentication -Value 0</code><br />
<code>REG ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters /v AllowEncryptionOracle /t REG_DWORD /d 2</code>
–æ—Ç–∫–ª—é—á–∏—Ç—å –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä–∫—É –≤–µ—Ä—Å–∏–∏ CredSSP, –µ—Å–ª–∏ –Ω–∞
—Ü–µ–ª–µ–≤–æ–º –∫–æ–º—å—é—Ç–µ—Ä–µ-—Å–µ—Ä–≤–µ—Ä–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è KB4512509 –æ—Ç –º–∞—è
2018 –≥–æ–¥–∞</p>
<h1 id="regedit">Regedit</h1>
<p><code>Get-PSDrive</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∏—Å–∫–æ–≤/—Ä–∞–∑–¥–µ–ª–æ–≤, –∏—Ö
—Ä–∞–∑–º–µ—Ä –∏ –≤–µ—Ç–æ–∫ —Ä–µ–µ—Å—Ç—Ä–∞<br />
<code>cd HKLM:\</code> HKEY_LOCAL_MACHINE<br />
<code>cd HKCU:\</code> HKEY_CURRENT_USER<br />
<code>Get-Item</code> –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–µ—Ç–∫–µ —Ä–µ–µ—Å—Ç—Ä–∞<br />
<code>New-Item</code> —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª —Ä–µ–µ—Å—Ç—Ä–∞<br />
<code>Remove-Item</code> —É–¥–∞–ª–∏—Ç—å –≤–µ—Ç–∫—É —Ä–µ–µ—Å—Ç—Ä–∞<br />
<code>Get-ItemProperty</code> –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π/–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
—Ä–µ–µ—Å—Ç—Ä–∞ (—ç—Ç–æ —Å–≤–æ–π—Å—Ç–≤–∞ –≤–µ—Ç–∫–∏ —Ä–µ–µ—Å—Ç—Ä–∞, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–≤–æ–π—Å—Ç–≤–∞–º —Ñ–∞–π–ª–∞)<br />
<code>Set-ItemProperty</code> –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
—Ä–µ–µ—Å—Ç—Ä–∞<br />
<code>New-ItemProperty</code> —Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞<br />
<code>Remove-ItemProperty</code> —É–¥–∞–ª–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä</p>
<p><code>Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Select DisplayName</code>
—Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º<br />
<code>Get-Item HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002</code>
–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ Items<br />
<code>(Get-ItemProperty HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002)."New Signature"</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (Value) —Å–≤–æ–π—Å—Ç–≤–∞ (Property) Items<br />
<code>$reg_path = "HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002"</code><br />
<code>$sig_name = "auto"</code><br />
<code>Set-ItemProperty -Path $reg_path -Name "New Signature" -Value $sig_name</code>
–∏–∑–º–µ–Ω–∏—Ç—å –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–Ω–µ –≤–µ—Ç–∫–∏ (Path) —Å–≤–æ–π—Å—Ç–≤–æ (Name) —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º
(Value)<br />
<code>Set-ItemProperty -Path $reg_path -Name "Reply-Forward Signature" -Value $sig_name</code></p>
<pre><code>Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\taskmgr.exe]
&quot;Debugger&quot;=&quot;\&quot;C:\\Windows\\System32\\Taskmgr.exe\&quot;&quot;</code></pre>
<h1 id="performance">Performance</h1>
<p><code>lodctr /R</code> –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å—á–µ—Ç—á–∏–∫–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑
—Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∞—Ä—Ö–∏–≤–æ–≤ (—Ç–∞–∫ –∂–µ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç —Å—á–µ—Ç—á–∏–∫–∏ –¥–ª—è CIM,
–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è cpu Win32_PerfFormattedData_PerfOS_Processor –∏ iops
Win32_PerfFormattedData_PerfDisk_PhysicalDisk)<br />
<code>(Get-Counter -ListSet *).CounterSetName</code> –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö
–¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—á–µ—Ç—á–∏–∫–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º–µ<br />
<code>(Get-Counter -ListSet *memory*).Counter</code> –ø–æ–∏—Å–∫ –ø–æ
wildcard-–∏–º–µ–Ω–∏ –≤–æ –≤—Å–µ—Ö —Å—á–µ—Ç—á–∏–∫–∞—Ö (–≤–∫–ª—é—á–∞—è –¥–æ—á–µ—Ä–Ω–∏–∏)<br />
<code>Get-Counter "\Memory\Available MBytes"</code> –æ–±—ä–µ–º —Å–≤–æ–±–æ–¥–Ω–æ–π
–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏<br />
<code>Get-Counter -cn $srv "\LogicalDisk(*)\% Free Space"</code> %
—Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö –¥–∏—Å–∫–æ–≤<br />
<code>(Get-Counter "\Process(*)\ID Process").CounterSamples</code><br />
<code>Get-Counter "\Processor(_Total)\% Processor Time" ‚ÄìComputerName $srv -MaxSamples 5 -SampleInterval 2</code>
5 –ø—Ä–æ–≤–µ—Ä–æ–∫ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã<br />
<code>Get-Counter "\–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä(_Total)\% –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞" -Continuous</code>
–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ<br />
<code>(Get-Counter "\–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä(*)\% –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞").CounterSamples</code></p>
<p><code>(Get-Counter -ListSet *–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å*).Counter</code> –Ω–∞–π—Ç–∏ –≤—Å–µ
—Å—á–µ—Ç—á–∏–∫–∏<br />
<code>Get-Counter "\–°–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å(*)\–í—Å–µ–≥–æ –±–∞–π—Ç/—Å"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å
–≤—Å–µ –∞–¥–∞–ø—Ç–µ—Ä—ã (–≤—ã–±—Ä–∞—Ç—å –¥–µ–π—Å—Ç–≤—É—é—â–∏–π –ø–æ —Ç—Ä–∞—Ñ–∏–∫—É)</p>
<div class="sourceCode" id="cb136"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="va">$WARNING</span> <span class="op">=</span> <span class="dv">25</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="va">$CRITICAL</span> <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="va">$TransferRate</span> <span class="op">=</span> <span class="op">((</span><span class="fu">Get-Counter</span> <span class="st">&quot;\\huawei-mb-x-pro\—Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å(intel[r] wi-fi 6e ax211 160mhz)\–≤—Å–µ–≥–æ –±–∞–π—Ç/—Å&quot;</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="op">).</span><span class="fu">countersamples</span> <span class="op">|</span> <span class="fu">select</span> <span class="op">-</span>ExpandProperty CookedValue<span class="op">)*</span><span class="dv">8</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="va">$NetworkUtilisation</span> <span class="op">=</span> <span class="op">[</span>math<span class="op">]::</span>round<span class="op">(</span><span class="va">$TransferRate</span><span class="op">/</span><span class="dv">1000000000</span><span class="op">*</span><span class="dv">100</span><span class="op">,</span><span class="dv">2</span><span class="op">)</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$NetworkUtilisation</span> <span class="op">-gt</span> <span class="va">$CRITICAL</span><span class="op">){</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Output</span> <span class="st">&quot;CRITICAL: </span><span class="op">$(</span><span class="va">$NetworkUtilisation</span><span class="op">)</span><span class="st"> % Network utilisation, </span><span class="op">$(</span><span class="va">$TransferRate</span><span class="op">.</span><span class="fu">ToString</span><span class="op">(</span><span class="st">&#39;N0&#39;</span><span class="op">)</span><span class="st">) b/s&quot;</span>   </span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="co">#exit 2     </span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$NetworkUtilisation</span> <span class="op">-gt</span> <span class="va">$WARNING</span><span class="op">){</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Output</span> <span class="st">&quot;WARNING: </span><span class="op">$(</span><span class="va">$NetworkUtilisation</span><span class="op">)</span><span class="st"> % Network utilisation, </span><span class="op">$(</span><span class="va">$TransferRate</span><span class="op">.</span><span class="fu">ToString</span><span class="op">(</span><span class="st">&#39;N0&#39;</span><span class="op">)</span><span class="st">) b/s&quot;</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a><span class="co">#exit 1</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Output</span> <span class="st">&quot;OK: </span><span class="op">$(</span><span class="va">$NetworkUtilisation</span><span class="op">)</span><span class="st"> % Network utilisation, </span><span class="op">$(</span><span class="va">$TransferRate</span><span class="op">.</span><span class="fu">ToString</span><span class="op">(</span><span class="st">&#39;N0&#39;</span><span class="op">)</span><span class="st">) b/s&quot;</span>   </span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a><span class="co">#exit 0</span></span></code></pre></div>
<h1 id="snmp">SNMP</h1>
<h3 id="setup-snmp-service">Setup SNMP Service</h3>
<p><code>Install-WindowsFeature SNMP-Service,SNMP-WMI-Provider -IncludeManagementTools</code>
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å SNMP –∏ WMI –ø—Ä–æ–≤–∞–π–¥–µ—Ä —á–µ—Ä–µ–∑ Server Manager<br />
<code>Get-WindowsFeature SNMP*</code><br />
<code>Add-WindowsCapability -Online -Name SNMP.Client~~~~0.0.1.0</code>
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Feature On Demand –¥–ª—è Windows
10/11<code>\</code>Get-Service SNMP<em><code>\</code>Get-NetFirewallrule
-DisplayName </em>snmp* | ft<code>\</code>Get-NetFirewallrule
-DisplayName <em>snmp</em> | Enable-NetFirewallRule`</p>
<h3 id="setting-snmp-service-via-regedit">Setting SNMP Service via
Regedit</h3>
<p>Agent:<br />
<code>New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\RFC1156Agent" -Name "sysContact" -Value "lifailon-user"</code>
—Å–æ–∑–¥–∞—Ç—å (New) –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å (Set)<br />
<code>New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\RFC1156Agent" -Name "sysLocation" -Value "plex-server"</code></p>
<p>Security:<br />
<code>New-Item -Path "HKLM:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\public"</code>
—Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π community string<br />
<code>New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\SNMP\Parameters\ValidCommunities" -Name "public" -Value 16</code>
–Ω–∞–∑–Ω–∞—á–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ public<br />
<code>1 ‚Äî NONE</code><br />
<code>2 ‚Äî NOTIFY</code> –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å SNMP –ª–æ–≤—É—à–∫–∏<br />
<code>4 ‚Äî READ ONLY</code> –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞<br />
<code>8 ‚Äî READ WRITE</code> –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –∏–∑–º–µ–Ω—è—Ç—å
–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞<br />
<code>16 ‚Äî READ CREATE</code> –ø–æ–∑–≤–æ–ª—è–µ—Ç —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –∏–∑–º–µ–Ω—è—Ç—å –∏
—Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã<br />
<code>New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\SNMP\Parameters\PermittedManagers" -Name "1" -Value "192.168.3.99"</code>
–æ—Ç –∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã<br />
<code>Get-Service SNMP | Restart-Service</code></p>
<h3 id="snmpwalk">snmpwalk</h3>
<p><code>snmpwalk -v 2c -c public 192.168.3.100</code><br />
<code>snmpwalk -v 2c -c public -O e 192.168.3.100</code></p>
<h3 id="snmp-modules">SNMP Modules</h3>
<p><code>Install-Module -Name SNMP</code><br />
<code>Get-SnmpData -IP 192.168.3.100 -OID 1.3.6.1.2.1.1.4.0 -UDPport 161 -Community public</code><br />
<code>(Get-SnmpData -IP 192.168.3.100 -OID 1.3.6.1.2.1.1.4.0).Data</code><br />
<code>Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.1</code>
–ø—Ä–æ–π—Ç–∏—Å—å –ø–æ –¥–µ—Ä–µ–≤—É OID<br />
<code>Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.25.6.3.1.2</code>
—Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ü–û<br />
<code>Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.25.2.3.1</code>
—Å–ø–∏—Å–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ –∏ –ø–∞–º—è—Ç–∏ (C: D: Virtual Memory –∏ Physical Memory)<br />
<code>Set-SnmpData</code> –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</p>
<p><code>Install-Module -Name SNMPv3</code><br />
<code>Invoke-SNMPv3Get</code> –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ–¥–Ω–æ–º—É OID<br />
<code>Invoke-SNMPv3Set</code> –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö<br />
<code>Invoke-SNMPv3Walk</code> –æ–±—Ö–æ–¥ –ø–æ –¥–µ—Ä–µ–≤—É OID<br />
<code>Invoke-SNMPv3Walk -UserName lifailon -Target 192.168.3.100 -AuthSecret password -PrivSecret password -OID 1.3.6.1.2.1.1 -AuthType MD5 -PrivType AES128</code></p>
<h3 id="lextm.sharpsnmplib">Lextm.SharpSnmpLib</h3>
<p><a
href="https://learn.microsoft.com/ru-ru/powershell/dsc/reference/resources/windows/fileresource?view=dsc-1.1">–°–∏–Ω—Ç–∞–∫—Å–∏—Å</a><br />
<a
href="https://api.nuget.org/v3-flatcontainer/lextm.sharpsnmplib/12.5.2/lextm.sharpsnmplib.12.5.2.nupkg">Download
lib</a></p>
<p><code>Add-Type -LiteralPath "$home\Desktop\lextm.sharpsnmplib-12.5.2\net471\SharpSnmpLib.dll"</code></p>
<div class="sourceCode" id="cb137"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="va">$port</span> <span class="op">=</span> <span class="dv">161</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="va">$OID</span> <span class="op">=</span> <span class="st">&quot;1.3.6.1.2.1.1.4.0&quot;</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="va">$variableList</span> <span class="op">=</span> <span class="fu">New-Object</span> Collections<span class="op">.</span><span class="fu">Generic</span><span class="op">.</span><span class="fu">List</span><span class="op">[</span>Lextm<span class="op">.</span><span class="fu">SharpSnmpLib</span><span class="op">.</span><span class="fu">Variable</span><span class="op">]</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="va">$variableList</span><span class="op">.</span><span class="fu">Add</span><span class="op">([</span>Lextm<span class="op">.</span><span class="fu">SharpSnmpLib</span><span class="op">.</span><span class="fu">Variable</span><span class="op">]::</span>new<span class="op">([</span>Lextm<span class="op">.</span><span class="fu">SharpSnmpLib</span><span class="op">.</span><span class="fu">ObjectIdentifier</span><span class="op">]::</span>new<span class="op">(</span><span class="va">$OID</span><span class="op">)))</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="va">$timeout</span> <span class="op">=</span> <span class="dv">3000</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Net<span class="op">.</span><span class="fu">IPAddress</span><span class="op">]</span><span class="va">$ip</span> <span class="op">=</span> <span class="st">&quot;192.168.3.100&quot;</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="va">$endpoint</span> <span class="op">=</span> <span class="fu">New-Object</span> Net<span class="op">.</span><span class="fu">IpEndPoint</span> <span class="va">$ip</span><span class="op">,</span> <span class="va">$port</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="va">$Community</span> <span class="op">=</span> <span class="st">&quot;public&quot;</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Lextm<span class="op">.</span><span class="fu">SharpSnmpLib</span><span class="op">.</span><span class="fu">VersionCode</span><span class="op">]</span><span class="va">$Version</span> <span class="op">=</span> <span class="st">&quot;V2&quot;</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="va">$message</span> <span class="op">=</span> <span class="op">[</span>Lextm<span class="op">.</span><span class="fu">SharpSnmpLib</span><span class="op">.</span><span class="fu">Messaging</span><span class="op">.</span><span class="fu">Messenger</span><span class="op">]::</span>Get<span class="op">(</span></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a><span class="va">$Version</span><span class="op">,</span></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="va">$endpoint</span><span class="op">,</span></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="va">$Community</span><span class="op">,</span></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="va">$variableList</span><span class="op">,</span></span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a><span class="va">$TimeOut</span></span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a><span class="va">$message</span><span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">ToString</span><span class="op">()</span></span></code></pre></div>
<h3 id="walk">Walk</h3>
<div class="sourceCode" id="cb138"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Lextm<span class="op">.</span><span class="fu">SharpSnmpLib</span><span class="op">.</span><span class="fu">ObjectIdentifier</span><span class="op">]</span><span class="va">$OID</span> <span class="op">=</span> <span class="st">&quot;1.3.6.1.2.1.1&quot;</span> <span class="co"># –¥–µ—Ä–µ–≤–æ –∏–ª–∏ –∫–æ–Ω–µ—á–Ω—ã–π OID</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="va">$WalkMode</span> <span class="op">=</span> <span class="op">[</span>Lextm<span class="op">.</span><span class="fu">SharpSnmpLib</span><span class="op">.</span><span class="fu">Messaging</span><span class="op">.</span><span class="fu">WalkMode</span><span class="op">]::</span>WithinSubtree <span class="co"># —Ä–µ–∂–∏–º –æ–±—Ö–æ–¥–∞ –ø–æ –¥–µ—Ä–µ–≤—É</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="va">$results</span> <span class="op">=</span> <span class="fu">New-Object</span> Collections<span class="op">.</span><span class="fu">Generic</span><span class="op">.</span><span class="fu">List</span><span class="op">[</span>Lextm<span class="op">.</span><span class="fu">SharpSnmpLib</span><span class="op">.</span><span class="fu">Variable</span><span class="op">]</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="va">$message</span> <span class="op">=</span> <span class="op">[</span>Lextm<span class="op">.</span><span class="fu">SharpSnmpLib</span><span class="op">.</span><span class="fu">Messaging</span><span class="op">.</span><span class="fu">Messenger</span><span class="op">]::</span>Walk<span class="op">(</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="va">$Version</span><span class="op">,</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="va">$endpoint</span><span class="op">,</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="va">$Community</span><span class="op">,</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="va">$OID</span><span class="op">,</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>  <span class="va">$results</span><span class="op">,</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>  <span class="va">$TimeOut</span><span class="op">,</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>  <span class="va">$WalkMode</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="va">$results</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a><span class="va">$results2</span> <span class="op">=</span> <span class="op">@()</span></span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$d</span> <span class="kw">in</span> <span class="va">$results</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a><span class="va">$results2</span> <span class="op">+=[</span>PSCustomObject<span class="op">]</span>@<span class="op">{</span><span class="st">&#39;ID&#39;</span><span class="op">=</span><span class="va">$d</span><span class="op">.</span><span class="fu">id</span><span class="op">.</span><span class="fu">ToString</span><span class="op">();</span><span class="st">&#39;Data&#39;</span><span class="op">=</span><span class="va">$d</span><span class="op">.</span><span class="fu">Data</span><span class="op">.</span><span class="fu">ToString</span><span class="op">()}</span> <span class="co"># –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ –≤ —Å—Ç—Ä–æ–∫—É</span></span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a><span class="va">$results2</span></span></code></pre></div>
<h1 id="zabbix">Zabbix</h1>
<h3 id="zabbix-agent-deploy">Zabbix Agent Deploy</h3>
<div class="sourceCode" id="cb139"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="va">$url</span> <span class="op">=</span> <span class="st">&quot;https://cdn.zabbix.com/zabbix/binaries/stable/6.4/6.4.5/zabbix_agent2-6.4.5-windows-amd64-static.zip&quot;</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="va">$path</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\zabbix-agent2-6.4.5.zip&quot;</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="va">$WebClient</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">WebClient</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="va">$WebClient</span><span class="op">.</span><span class="fu">DownloadFile</span><span class="op">(</span><span class="va">$url</span><span class="op">,</span> <span class="va">$path</span><span class="op">)</span><span class="ch">` </span>—Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>Expand-Archive <span class="va">$path</span> <span class="op">-</span>DestinationPath <span class="st">&quot;C:\zabbix-agent2-6.4.5\&quot;</span><span class="ch">` </span>—Ä–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$path</span><span class="ch">` </span>—É–¥–∞–ª–∏—Ç—å –∞—Ä—Ö–∏–≤</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>New-NetFirewallRule <span class="op">-</span>DisplayName <span class="st">&quot;Zabbix-Agent&quot;</span> <span class="op">-</span>Profile Any <span class="op">-</span>Direction Inbound <span class="op">-</span>Action Allow <span class="op">-</span>Protocol TCP <span class="op">-</span>LocalPort <span class="dv">10050</span><span class="op">,</span><span class="dv">10051</span><span class="ch">` </span>–æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç—ã –≤ <span class="fu">FW</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="va">$Zabbix_Server</span> <span class="op">=</span> <span class="st">&quot;192.168.3.102&quot;</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a><span class="va">$conf</span> <span class="op">=</span> <span class="st">&quot;C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.conf&quot;</span></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a><span class="va">$cat</span> <span class="op">=</span> <span class="fu">cat</span> <span class="va">$conf</span></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="va">$rep</span> <span class="op">=</span> <span class="va">$cat</span> <span class="op">-replace</span> <span class="st">&quot;Server=.+&quot;</span><span class="op">,</span><span class="st">&quot;Server=</span><span class="va">$Zabbix_Server</span><span class="st">&quot;</span></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a><span class="va">$rep</span> <span class="op">|</span> <span class="fu">Select-String</span> Server<span class="op">=</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a><span class="va">$rep</span> <span class="op">&gt;</span> <span class="va">$conf</span></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a><span class="va">$exe</span> <span class="op">=</span> <span class="st">&quot;C:\zabbix-agent2-6.4.5\bin\zabbix_agent2.exe&quot;</span></span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="va">$exe</span> <span class="op">--</span>config <span class="va">$conf</span> <span class="op">--</span>install<span class="ch">` </span>—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂–±—É</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Service</span> <span class="op">*</span>Zabbix<span class="op">*</span>Agent<span class="op">*</span> <span class="op">|</span> Start-Service<span class="ch">` </span>–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É</span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a><span class="co">#.$exe --config $conf --uninstall` —É–¥–∞–ª–∏—Ç—å —Å–ª—É–∂–±—É</span></span></code></pre></div>
<h3 id="zabbix_sender">zabbix_sender</h3>
<p>–°–æ–∑–¥–∞—Ç—å host - –∑–∞–¥–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∏–º—è (powershell-host) –∏ –¥–æ–±–∞–≤–∏—Ç—å –≤
–≥—Ä—É–ø–ø—É<br />
–°–æ–∑–¥–∞—Ç—å Items:<br />
Name: Service Count<br />
Type: Zabbix trapper<br />
Key: service.count<br />
Type of Information: Numeric</p>
<div class="sourceCode" id="cb140"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="va">$path</span> <span class="op">=</span> <span class="st">&quot;C:\zabbix-agent2-6.4.5\bin&quot;</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="va">$scount</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Service</span><span class="op">).</span><span class="fu">Count</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="va">$path</span>\zabbix_sender<span class="op">.</span><span class="fu">exe</span> <span class="op">-</span>z <span class="dv">192.168</span><span class="op">.</span><span class="dv">3.102</span> <span class="op">-</span>s <span class="st">&quot;powershell-host&quot;</span> <span class="op">-</span>k service<span class="op">.</span><span class="fu">count</span> <span class="op">-</span>o <span class="va">$scount</span></span></code></pre></div>
<h3 id="zabbix_get">zabbix_get</h3>
<p><code>apt install zabbix-get</code><br />
<code>nano /etc/zabbix/zabbix_agentd.conf</code><br />
<code>Server=127.0.0.1,192.168.3.102,192.168.3.99</code> –¥–æ–±–∞–≤–∏—Ç—å
—Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö zabbix_get —Å –∞–≥–µ–Ω—Ç–∞ (–∫–∞–∫ –∏—Ö –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç
—Å–µ—Ä–≤–µ—Ä)</p>
<p><code>.$path\zabbix_get -s 192.168.3.101 -p 10050 -k agent.version</code>
–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é –∞–≥–µ–Ω—Ç–∞<br />
<code>.$path\zabbix_get -s 192.168.3.101 -p 10050 -k agent.ping</code> 1
- ok<br />
<code>.$path\zabbix_get -s 192.168.3.101 -p 10050 -k net.if.discovery</code>
—Å–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤<br />
<code>.$path\zabbix_get -s 192.168.3.101 -p 10050 -k net.if.in["ens33"]</code><br />
<code>.$path\zabbix_get -s 192.168.3.101 -p 10050 -k net.if.out["ens33"]</code></p>
<h3 id="userparameter">UserParameter</h3>
<p><code>UserParameter=process.count,powershell -Command "(Get-Process).Count"</code><br />
<code>UserParameter=process.vm[*],powershell -Command "(Get-Process $1).ws"</code></p>
<p>Test:<br />
<code>C:\zabbix-agent2-6.4.5\bin\zabbix_get.exe -s 127.0.0.1 -p 10050 -k process.count</code><br />
<code>C:\zabbix-agent2-6.4.5\bin\zabbix_get.exe -s 127.0.0.1 -p 10050 -k process.vm[zabbix_agent2]</code><br />
<code>C:\zabbix-agent2-6.4.5\bin\zabbix_get.exe -s 127.0.0.1 -p 10050 -k process.vm[powershell]</code></p>
<p>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ Items:<br />
key: <code>process.count</code><br />
key: <code>process.vm[zabbix_agent2]</code></p>
<h3 id="include">Include</h3>
<ul>
<li><p>–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä Include –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
–ø–æ–¥–∫–ª—é—á–∞–µ–º—ã—Ö –ø–ª–∞–≥–∏–Ω–æ–≤
<code>'Include=.\zabbix_agent2.d\plugins.d\*.conf' &gt;&gt; C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.conf</code></p></li>
<li><p>–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≤
–∫–∞—Ç–∞–ª–æ–≥–µ, –ø—É—Ç—å –∫ –∫–æ—Ç–æ—Ä–æ–º—É —É–∫–∞–∑–∞–Ω –≤ zabbix_agentd.conf<br />
<code>'UserParameter=Get-Query-Param[*],powershell.exe -noprofile -executionpolicy bypass -File C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.d\scripts\User-Sessions\Get-Query-Param.ps1 $1' &gt; C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.d\plugins.d\User-Sessions.conf</code></p></li>
<li><p>–ü–æ–º–µ—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç Get-Query-Param.ps1 –≤ –∫–∞—Ç–∞–ª–æ–≥, –ø—É—Ç—å –∫ –∫–æ—Ç–æ—Ä–æ–º—É
—É–∫–∞–∑–∞–Ω –≤ User-Sessions.conf. –°–∫—Ä–∏–ø—Ç —Å–æ–¥–µ—Ä–∂–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã,
–∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ—Ç Zabbix —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∏—Ö –≤ —Ñ—É–Ω–∫—Ü–∏–∏
—Å–∫—Ä–∏–ø—Ç–∞.</p></li>
</ul>
<div class="sourceCode" id="cb141"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Param</span><span class="op">([</span><span class="dt">string</span><span class="op">]</span><span class="va">$select</span><span class="op">)</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$select</span> <span class="op">-eq</span> <span class="st">&quot;ACTIVEUSER&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>Get-Query <span class="op">|</span> <span class="fu">where</span> status <span class="op">-match</span> <span class="st">&quot;Active&quot;</span><span class="op">).</span><span class="fu">User</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$select</span> <span class="op">-eq</span> <span class="st">&quot;INACTIVEUSER&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>Get-Query <span class="op">|</span> <span class="fu">where</span> status <span class="op">-match</span> <span class="st">&quot;Disconnect&quot;</span><span class="op">).</span><span class="fu">User</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$select</span> <span class="op">-eq</span> <span class="st">&quot;ACTIVECOUNT&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>Get-Query <span class="op">|</span> <span class="fu">where</span> status <span class="op">-match</span> <span class="st">&quot;Active&quot;</span><span class="op">).</span><span class="fu">Status</span><span class="op">.</span><span class="fu">Count</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$select</span> <span class="op">-eq</span> <span class="st">&quot;INACTIVECOUNT&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>Get-Query <span class="op">|</span> <span class="fu">where</span> status <span class="op">-match</span> <span class="st">&quot;Disconnect&quot;</span><span class="op">).</span><span class="fu">Status</span><span class="op">.</span><span class="fu">Count</span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<ul>
<li>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–∫—Ä–∏–ø—Ç–∞:</li>
</ul>
<p><code>$path = "C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.d\scripts\User-Sessions"</code><br />
<code>.$path\Get-Query-Param.ps1 ACTIVEUSER</code><br />
<code>.$path\Get-Query-Param.ps1 INACTIVEUSER</code><br />
<code>.$path\Get-Query-Param.ps1 ACTIVECOUNT</code><br />
<code>.$path\Get-Query-Param.ps1 INACTIVECOUNT</code></p>
<ul>
<li>–°–æ–∑–¥–∞—Ç—å Items —Å –∫–ª—é—á–∞–º–∏:</li>
</ul>
<p><code>Get-Query-Param[ACTIVEUSER]</code> Type: Text<br />
<code>Get-Query-Param[INACTIVEUSER]</code> Type: Text<br />
<code>Get-Query-Param[ACTIVECOUNT]</code> Type: Int<br />
<code>Get-Query-Param[INACTIVECOUNT]</code> Type: Int</p>
<ul>
<li>–ú–∞–∫—Ä–æ—Å—ã:</li>
</ul>
<p><code>{$ACTIVEMAX} = 16</code><br />
<code>{$ACTIVEMIN} = 0</code></p>
<ul>
<li>–¢—Ä–∏–≥–≥–µ—Ä—ã:</li>
</ul>
<p><code>last(/Windows-User-Sessions/Get-Query-Param[ACTIVECOUNT])&gt;{$ACTIVEMAX}</code><br />
<code>min(/Windows-User-Sessions/Get-Query-Param[ACTIVECOUNT],24h)={$ACTIVEMIN}</code></p>
<h3 id="zabbix_agent2.conf">zabbix_agent2.conf</h3>
<pre><code># –ê–≥–µ–Ω—Ç –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ø–∞—Å—Å–∏–≤–Ω–æ–º (—Å–µ—Ä–≤–µ—Ä –∑–∞–±–∏—Ä–∞–µ—Ç —Å–∞–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é) –∏ –∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ (–∞–≥–µ–Ω—Ç —Å–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç):
Server=192.168.3.102
ServerActive=192.168.3.102
# –¢—Ä–µ–±—É–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç—å hostname –¥–ª—è ServerActive:
Hostname=huawei-book-01
# –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–º–µ–Ω–∏ —Ö–æ—Å—Ç–∞ (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –µ—Å–ª–∏ –∏–º—è —Ö–æ—Å—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ):
# HostnameItem=system.hostname
# –ö–∞–∫ —á–∞—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫, –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (Range: 60-3600):
RefreshActiveChecks=120
# IP-–∞–¥—Ä–µ—Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–ª—è –∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π:
# SourceIP=
# –ê–≥–µ–Ω—Ç –±—É–¥–µ—Ç —Å–ª—É—à–∞—Ç—å –Ω–∞ —ç—Ç–æ–º –ø–æ—Ä—Ç—É —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º (Range: 1024-32767):
# ListenPort=10050
# –°–ø–∏—Å–æ–∫ IP-–∞–¥—Ä–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∞–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—Å–ª—É—à–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
# ListenIP=0.0.0.0
# –ê–≥–µ–Ω—Ç –±—É–¥–µ—Ç –ø—Ä–æ—Å–ª—É—à–∏–≤–∞—Ç—å —ç—Ç–æ—Ç –ø–æ—Ä—Ç –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Å—Ç–∞—Ç—É—Å–∞ HTTP (Range: 1024-32767):
# StatusPort=
ControlSocket=\\.\pipe\agent.sock
# –ö—É–¥–∞ –≤–µ—Å—Ç–∏ –∂—É—Ä–Ω–∞–ª (file/syslog/console):
LogType=file
LogFile=C:\zabbix-agent2-6.4.5\zabbix_agent2.log
# –†–∞–∑–º–µ—Ä –ª–æ–≥–∞ –æ—Ç 0-1024 MB (0 - –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤)
LogFileSize=100
# –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è. 4 - –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (–≤—ã–¥–∞–µ—Ç –º–Ω–æ–≥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
DebugLevel=4</code></pre>
<h3 id="api-token">API Token</h3>
<p><a
href="https://www.zabbix.com/documentation/current/en/manual/api/reference">Documentation</a></p>
<p><code>$ip = "192.168.3.102"</code><br />
<code>$url = "http://$ip/zabbix/api_jsonrpc.php"</code></p>
<div class="sourceCode" id="cb143"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="va">$data</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;jsonrpc&quot;</span><span class="op">=</span><span class="st">&quot;2.0&quot;</span><span class="op">;</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;method&quot;</span><span class="op">=</span><span class="st">&quot;user.login&quot;</span><span class="op">;</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;params&quot;</span><span class="op">=</span>@<span class="op">{</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;username&quot;</span><span class="op">=</span><span class="st">&quot;Admin&quot;</span><span class="op">;</span><span class="ch">` </span>–≤ –≤–µ—Ä—Å–∏–∏ –¥–æ <span class="dv">6.4</span> –ø–∞—Ä–∞–º–µ—Ç—Ä <span class="st">&quot;user&quot;</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;password&quot;</span><span class="op">=</span><span class="st">&quot;zabbix&quot;</span><span class="op">;</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;id&quot;</span><span class="op">=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="va">$token</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method POST <span class="op">-</span>Uri <span class="va">$url</span> <span class="op">-</span>Body <span class="op">(</span><span class="va">$data</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span><span class="op">)</span> <span class="op">-</span>ContentType <span class="st">&quot;application/json&quot;</span><span class="op">).</span><span class="fu">Result</span></span></code></pre></div>
<p><code>$token = "2eefd25fdf1590ebcdb7978b5bcea1fff755c65b255da8cbd723181b639bb789"</code>
—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –≤ UI
(http://192.168.3.102/zabbix/zabbix.php?action=token.list)</p>
<h3 id="user.get">user.get</h3>
<div class="sourceCode" id="cb144"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="va">$data</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;jsonrpc&quot;</span><span class="op">=</span><span class="st">&quot;2.0&quot;</span><span class="op">;</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;method&quot;</span><span class="op">=</span><span class="st">&quot;user.get&quot;</span><span class="op">;</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;params&quot;</span><span class="op">=</span>@<span class="op">{</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;auth&quot;</span><span class="op">=</span><span class="va">$token</span><span class="op">;</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;id&quot;</span><span class="op">=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="va">$users</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method POST <span class="op">-</span>Uri <span class="va">$url</span> <span class="op">-</span>Body <span class="op">(</span><span class="va">$data</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span><span class="op">)</span> <span class="op">-</span>ContentType <span class="st">&quot;application/json&quot;</span><span class="op">).</span><span class="fu">Result</span></span></code></pre></div>
<h3 id="problem.get">problem.get</h3>
<div class="sourceCode" id="cb145"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="va">$data</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;jsonrpc&quot;</span><span class="op">=</span><span class="st">&quot;2.0&quot;</span><span class="op">;</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;method&quot;</span><span class="op">=</span><span class="st">&quot;problem.get&quot;</span><span class="op">;</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;params&quot;</span><span class="op">=</span>@<span class="op">{</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;auth&quot;</span><span class="op">=</span><span class="va">$token</span><span class="op">;</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;id&quot;</span><span class="op">=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method POST <span class="op">-</span>Uri <span class="va">$url</span> <span class="op">-</span>Body <span class="op">(</span><span class="va">$data</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span><span class="op">)</span> <span class="op">-</span>ContentType <span class="st">&quot;application/json&quot;</span><span class="op">).</span><span class="fu">Result</span></span></code></pre></div>
<h3 id="host.get">host.get</h3>
<p>–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ö–æ—Å—Ç–æ–≤ (–∏–º—è –∏ id)</p>
<p><a
href="https://www.zabbix.com/documentation/current/en/manual/api/reference/host">Endpoint
host</a></p>
<p>host.create - creating new hosts<br />
host.delete - deleting hosts<br />
host.get - retrieving hosts<br />
host.massadd - adding related objects to hosts<br />
host.massremove - removing related objects from hosts<br />
host.massupdate - replacing or removing related objects from hosts<br />
host.update - updating hosts</p>
<div class="sourceCode" id="cb146"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="va">$data</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;jsonrpc&quot;</span><span class="op">=</span><span class="st">&quot;2.0&quot;</span><span class="op">;</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;method&quot;</span><span class="op">=</span><span class="st">&quot;host.get&quot;</span><span class="op">;</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;params&quot;</span><span class="op">=</span>@<span class="op">{</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;output&quot;</span><span class="op">=@(</span><span class="ch">` </span>–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;hostid&quot;</span><span class="op">;</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;host&quot;</span><span class="op">;</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">);</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;id&quot;</span><span class="op">=</span><span class="dv">2</span><span class="op">;</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;auth&quot;</span><span class="op">=</span><span class="va">$token</span><span class="op">;</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="va">$hosts</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method POST <span class="op">-</span>Uri <span class="va">$url</span> <span class="op">-</span>Body <span class="op">(</span><span class="va">$data</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span><span class="op">)</span> <span class="op">-</span>ContentType <span class="st">&quot;application/json&quot;</span><span class="op">).</span><span class="fu">Result</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a><span class="va">$host_id</span> <span class="op">=</span> <span class="va">$hosts</span><span class="op">[</span><span class="dv">3</span><span class="op">].</span><span class="fu">hostid</span><span class="ch">` </span>–∑–∞–±—Ä–∞—Ç—å id —Ö–æ—Å—Ç–∞ –ø–æ –∏–Ω–¥–µ–∫—Å—É</span></code></pre></div>
<h3 id="item.get">item.get</h3>
<p>–ü–æ–ª—É—á–∏—Ç—å id —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö –ø–æ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—é –∫–ª—é—á–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ
—Ö–æ—Å—Ç–∞</p>
<div class="sourceCode" id="cb147"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="va">$data</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;jsonrpc&quot;</span><span class="op">=</span><span class="st">&quot;2.0&quot;</span><span class="op">;</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;method&quot;</span><span class="op">=</span><span class="st">&quot;item.get&quot;</span><span class="op">;</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;params&quot;</span><span class="op">=</span>@<span class="op">{</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;hostids&quot;</span><span class="op">=@(</span><span class="va">$host_id</span><span class="op">);</span><span class="ch">` </span>–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Ö–æ—Å—Ç—É</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;auth&quot;</span><span class="op">=</span><span class="va">$token</span><span class="op">;</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;id&quot;</span><span class="op">=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a><span class="va">$items</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method POST <span class="op">-</span>Uri <span class="va">$url</span> <span class="op">-</span>Body <span class="op">(</span><span class="va">$data</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span><span class="op">)</span> <span class="op">-</span>ContentType <span class="st">&quot;application/json&quot;</span><span class="op">).</span><span class="fu">Result</span></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="va">$items_id</span> <span class="op">=</span> <span class="op">(</span><span class="va">$items</span> <span class="op">|</span> <span class="fu">where</span> key_ <span class="op">-match</span> system<span class="op">.</span><span class="fu">uptime</span><span class="op">).</span><span class="fu">itemid</span><span class="ch">` </span>–∑–∞–±—Ä–∞—Ç—å id —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–∞–Ω–Ω—ã—Ö</span></code></pre></div>
<h3 id="history.get">history.get</h3>
<p>–ü–æ–ª—É—á–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –µ–≥–æ id</p>
<div class="sourceCode" id="cb148"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="va">$data</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;jsonrpc&quot;</span><span class="op">=</span><span class="st">&quot;2.0&quot;</span><span class="op">;</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;method&quot;</span><span class="op">=</span><span class="st">&quot;history.get&quot;</span><span class="op">;</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;params&quot;</span><span class="op">=</span>@<span class="op">{</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;hostids&quot;</span><span class="op">=@(</span><span class="va">$host_id</span><span class="op">);</span> <span class="ch">` </span>—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ö–æ—Å—Ç—É</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;itemids&quot;</span><span class="op">=@(</span><span class="va">$items_id</span><span class="op">);</span><span class="ch">` </span>—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —ç–ª–µ–º–µ–Ω—Ç—É –¥–∞–Ω–Ω—ã—Ö</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;auth&quot;</span><span class="op">=</span><span class="va">$token</span><span class="op">;</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;id&quot;</span><span class="op">=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="va">$items_data_uptime</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method POST <span class="op">-</span>Uri <span class="va">$url</span> <span class="op">-</span>Body <span class="op">(</span><span class="va">$data</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span><span class="op">)</span> <span class="op">-</span>ContentType <span class="st">&quot;application/json&quot;</span><span class="op">).</span><span class="fu">Result</span><span class="ch">` </span>–ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–ª—é—á—É —É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞</span></code></pre></div>
<h3 id="convert-secconds-to-timespan-and-datetime">Convert Secconds To
TimeSpan and DateTime</h3>
<p><code>$sec = $items_data_uptime.value</code></p>
<div class="sourceCode" id="cb149"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> ConvertSecondsTo-TimeSpan <span class="op">{</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span> <span class="op">(</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">$insec</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">$TimeSpan</span> <span class="op">=</span> <span class="op">[</span>TimeSpan<span class="op">]::</span>fromseconds<span class="op">(</span><span class="va">$insec</span><span class="op">)</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;{0:dd&#39; day &#39;hh\:mm\:ss}&quot;</span> <span class="op">-</span>f <span class="va">$TimeSpan</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>$UpTime = ConvertSecondsTo-TimeSpan $sec[-1]</code></p>
<h3 id="convert-from-unix-time">Convert From Unix Time</h3>
<p><code>$time = $items_data_uptime.clock</code></p>
<div class="sourceCode" id="cb150"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> ConvertFrom-UnixTime <span class="op">{</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span> <span class="op">(</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">$intime</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">$EpochTime</span> <span class="op">=</span> <span class="op">[</span>DateTime<span class="op">]</span><span class="st">&quot;1/1/1970&quot;</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">$TimeZone</span> <span class="op">=</span> Get-TimeZone</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">$UTCTime</span> <span class="op">=</span> <span class="va">$EpochTime</span><span class="op">.</span><span class="fu">AddSeconds</span><span class="op">(</span><span class="va">$intime</span><span class="op">)</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>    <span class="va">$UTCTime</span><span class="op">.</span><span class="fu">AddMinutes</span><span class="op">(</span><span class="va">$TimeZone</span><span class="op">.</span><span class="fu">BaseUtcOffset</span><span class="op">.</span><span class="fu">TotalMinutes</span><span class="op">)</span></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>$GetDataTime = ConvertFrom-UnixTime $time[-1]</code></p>
<p><code>($hosts | where hostid -eq $host_id).host</code> –ø–æ–ª—É—á–∏—Ç—å –∏–º—è
—Ö–æ—Å—Ç–∞<br />
<code>$UpTime</code> –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã
—Ö–æ—Å—Ç–∞<br />
<code>$GetDataTime</code> –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è</p>
<h1 id="pki">pki</h1>
<p><code>New-SelfSignedCertificate -CertStoreLocation Cert:\LocalMachine\My -DnsName "$env:computername" -FriendlyName "Test Certificate" -NotAfter (Get-Date).AddYears(5)</code>
—Å–æ–∑–¥–∞—Ç—å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–≤ LocalMachine- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
–∫–æ–º–ø—å—é—Ç–µ—Ä–∞) —Å —Å—Ä–æ–∫–æ–º –¥–µ–π—Å—Ç–≤–∏—è 5 –ª–µ—Ç</p>
<p><code>Get-ChildItem -Path Cert:\CurrentUser\Root\</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö
—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –î–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ –¶–° –¢–µ–∫—É—â–µ–≥–æ
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>Get-ChildItem -Path Cert:\CurrentUser\My\</code> —Å–ø–∏—Å–æ–∫
—Å–∞–º–æ–∑–∞–≤–µ—Ä—è—é—â–∏—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ –õ–∏—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¢–µ–∫—É—â–µ–≥–æ
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>Get-ChildItem -Path Cert:\LocalMachine\My\</code> —Å–ø–∏—Å–æ–∫
—Å–∞–º–æ–∑–∞–≤–µ—Ä—è—é—â–∏—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ –õ–∏—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –õ–æ–∫–∞–ª—å–Ω–æ–≥–æ
–∫–æ–º–ø—å—é—Ç–µ—Ä–∞<br />
<code>Get-ChildItem -Path Cert:\LocalMachine\My\ | select NotBefore,NotAfter,Thumbprint,Subject</code>
—Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞<br />
<code>Get-ChildItem -Path Cert:\LocalMachine\My\ | where Thumbprint -eq D9356FB774EE0E6206B7D5B59B99102CA5B17BDA</code>
–ø–æ–∏—Å–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ –æ—Ç–ø–µ—á–∞—Ç–∫—É</p>
<p><code>Get-ChildItem -Path $env:APPDATA\Microsoft\SystemCertificates\My\Certificates\</code>
—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ, –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É,
—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É –≤ –ª–∏—á–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>Get-ChildItem -Path $env:APPDATA\Microsoft\SystemCertificates\My\Keys\</code>
—Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—ä–µ–∫—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã—Ö –∫–ª—é—á–µ–π, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
–∫–ª—é—á–µ–π (KSP)<br />
<code>Get-ChildItem -Path HKCU:\Software\Microsoft\SystemCertificates\CA\Certificates | ft -AutoSize</code>
—Å–ø–∏—Å–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ —Ä–µ–µ—Å—Ç—Ä–µ –≤–æ—à–µ–¥—à–µ–≥–æ –≤ —Å–∏—Å—Ç–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
<p><code>$cert = (Get-ChildItem -Path Cert:\CurrentUser\My\)[1]</code>
–≤—ã–±—Ä–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç<br />
<code>$cert | Remove-Item</code> —É–¥–∞–ª–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</p>
<p><code>Export-Certificate -FilePath $home\Desktop\certificate.cer -Cert $cert</code>
—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç<br />
<code>$cert.HasPrivateKey</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞<br />
<code>$pass = "password" | ConvertTo-SecureString -AsPlainText -Force</code>
—Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞<br />
<code>Export-PfxCertificate -FilePath $home\Desktop\certificate.pfx -Password $pass -Cert $certificate</code>
—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å –∑–∞–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–µ–º</p>
<p><code>Import-Certificate -FilePath $home\Desktop\certificate.cer -CertStoreLocation Cert:\CurrentUser\My</code>
–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç<br />
<code>Import-PfxCertificate -Exportable -Password $pass -CertStoreLocation Cert:\CurrentUser\My -FilePath $home\Desktop\certificate.pfx</code></p>
<h1 id="openssl">OpenSSL</h1>
<div class="sourceCode" id="cb151"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Invoke-WebRequest</span> <span class="op">-</span>Uri https<span class="op">://</span>slproweb<span class="op">.</span><span class="fu">com</span><span class="op">/</span>download<span class="op">/</span>Win64OpenSSL_Light-3_1_1<span class="op">.</span><span class="fu">msi</span> <span class="op">-</span>OutFile <span class="va">$home</span>\Downloads\OpenSSL-Light-3<span class="op">.</span><span class="dv">1.1</span><span class="op">.</span><span class="fu">msi</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Start-Process</span> <span class="va">$home</span>\Downloads\OpenSSL-Light-3<span class="op">.</span><span class="dv">1.1</span><span class="op">.</span><span class="fu">msi</span> <span class="op">-</span>ArgumentList <span class="st">&#39;/quiet&#39;</span> <span class="op">-</span>Wait<span class="ch">` </span>—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å msi –ø–∞–∫–µ—Ç –≤ —Ç–∏—Ö–æ–º —Ä–µ–∂–∏–º–µ <span class="op">(</span>–∑–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞<span class="op">)</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$home</span>\Downloads\OpenSSL-Light-3<span class="op">.</span><span class="dv">1.1</span><span class="op">.</span><span class="fu">msi</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cd</span> <span class="st">&quot;C:\Program Files\OpenSSL-Win64\bin&quot;</span></span></code></pre></div>
<ul>
<li><p>–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è PFX<br />
<code>openssl pkcs12 -in "C:\Cert\domain.ru.pfx" -out "C:\Cert\domain.ru.pem" -nodes</code>
—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∏–º–µ—é—â–∏–π—Å—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á –≤ .pem-—Ñ–∞–π–ª –±–µ–∑ –ø–∞—Ä–æ–ª—è
—Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–∞—Ä–æ–ª—è<br />
<code>openssl pkcs12 -export -in "C:\Cert\domain.ru.pem" -out "C:\Cert\domain.ru_password.pfx" -nodes</code>
–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º .pem –æ–±—Ä–∞—Ç–Ω–æ –≤ .pfx c —É–∫–∞–∑–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è</p></li>
<li><p>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∏ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ PEM –≤ PFX<br />
<code>openssl pkcs12 -export -in "C:\tmp\vpn\vpn.itproblog.ru-crt.pem" -inkey "C:\tmp\vpn\vpn.itproblog.ru-key.pem" -out "C:\tmp\vpn\vpn.iiproblog.ru.pfx"</code><br />
in ‚Äì –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–æ–º<br />
inkey ‚Äì –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞ —Å –∑–∞–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–æ–º<br />
out ‚Äì –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
(pfx)</p></li>
<li><p>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PFX –≤ CRT<br />
<code>openssl pkcs12 -in "C:\OpenSSL-Win64\bin\_.domain.ru.pfx" -clcerts -out "C:\OpenSSL-Win64\bin\_.domain.ru.crt"</code>
—É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–π –∏ 2 —Ä–∞–∑–∞ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å PEM pass phrase (—Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç
EGIN CERTIFICATE –∏ BEGIN ENCRYPTED PRIVATE KEY)<br />
<code>openssl pkcs12 -in "C:\OpenSSL-Win64\bin\_.domain.ru.pfx" -clcerts -nokeys -out "C:\OpenSSL-Win64\bin\_.domain.ru.crt"</code>
–±–µ–∑ –∫–ª—é—á–∞, –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç—É—é —á–∞—Å—Ç—å (—Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ EGIN
CERTIFICATE)</p></li>
<li><p>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PFX –≤ KEY<br />
<code>openssl pkcs12 -in "C:\OpenSSL-Win64\bin\_.domain.ru.pfx" -nocerts -out "C:\OpenSSL-Win64\bin\_.domain.ru.key"</code>
—Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ BEGIN ENCRYPTED PRIVATE KEY</p></li>
<li><p>–°–Ω—è—Ç—å –ø–∞—Ä–æ–ª—å –∫ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ .key<br />
<code>openssl rsa -in "C:\OpenSSL-Win64\bin\_.domain.ru.key" -out "C:\OpenSSL-Win64\bin\_.domain.ru-decrypted.key"</code></p></li>
<li><p>CRT –∏ KEY –≤ PFX:<br />
<code>openssl pkcs12 -inkey certificate.key -in certificate.crt -export -out certificate.pfx</code></p></li>
</ul>
<h1 id="openvpn">OpenVPN</h1>
<p><code>Invoke-WebRequest -Uri https://swupdate.openvpn.org/community/releases/OpenVPN-2.6.5-I001-amd64.msi -OutFile $home\Downloads\OpenVPN-2.6.5.msi</code><br />
<code>Start-Process $home\Downloads\OpenVPN-2.6.5.msi -ArgumentList '/quiet /SELECT_OPENSSL_UTILITIES=1' -Wait</code><br />
<code>msiexec /i $home\Downloads\OpenVPN-2.6.5.msi ADDLOCAL=EasyRSA /passive /quiet # —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç EasyRSA Certificate Management Scripts</code><br />
<code># msiexec /i $home\Downloads\OpenVPN-2.6.5.msi ADDLOCAL=OpenVPN.Service,Drivers,Drivers.Wintun,OpenVPN,OpenVPN.GUI,OpenVPN.GUI.OnLogon,EasyRSA /passive</code>
–≤—ã–±–æ—Ä–æ—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞<br />
<code># Invoke-WebRequest -Uri https://github.com/OpenVPN/easy-rsa/releases/download/v3.1.5/EasyRSA-3.1.5-win64.zip -OutFile $home\Downloads\EasyRSA-3.1.5.zip</code>
—Å–∫–∞—á–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç EasyRSA<br />
<code>rm $home\Downloads\OpenVPN-2.6.5.msi</code></p>
<p><code>cd "C:\Program Files\OpenVPN\easy-rsa"</code><br />
<code>Copy-Item vars.example vars</code> —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è
EasyRSA</p>
<pre><code>set_var EASYRSA_TEMP_DIR &quot;$EASYRSA_PKI&quot;
set_var EASYRSA_REQ_COUNTRY &quot;RU&quot;
set_var EASYRSA_REQ_PROVINCE &quot;MSK&quot;
set_var EASYRSA_REQ_CITY &quot;MSK&quot;
set_var EASYRSA_REQ_ORG &quot;FAILON.NET&quot;
set_var EASYRSA_REQ_EMAIL &quot;lifailon@domain.ru&quot;
set_var EASYRSA_REQ_OU &quot;IT&quot;
#set_var EASYRSA_KEY_SIZE 2048
#set_var EASYRSA_CA_EXPIRE 3650
#set_var EASYRSA_CERT_EXPIRE 825</code></pre>
<p><code>.\EasyRSA-Start.bat</code> —Å—Ä–µ–¥–∞ EasyRSA Shell<br />
<code>easyrsa init-pki</code> –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PKI, —Å–æ–∑–¥–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:
C:Files-rsa–∏ —á–∏—Ç–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞ -rsa<br />
<code>easyrsa build-ca</code> –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ—Ä–Ω–µ–≤–æ–≥–æ CA —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–∞—Ä–æ–ª—è
–∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∏–º—è —Å–µ—Ä–≤–µ—Ä–∞ (.crt –∏ .key)<br />
<code>easyrsa gen-req server nopass</code> –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
–∏ –∫–ª—é—á –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ OpenVPN - yes (.req –∏ .key)<br />
<code>easyrsa sign-req server server</code> –ø–æ–¥–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–ø—É—Å–∫
—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ —Å –ø–æ–º–æ—â—å—é CA - yes (.crt)<br />
<code>easyrsa gen-dh</code> —Å–æ–∑–¥–∞—Ç—å –∫–ª—é—á –î–∏—Ñ—Ñ–∏-–•–µ–ª–ª–º–∞–Ω–∞ (.pem)<br />
<code>easyrsa gen-req client1</code>
nopass<code>–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∏ –∫–ª—é—á –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ OpenVPN (\pki\reqs\client1.req –∏ \pki\private\client1.key)</code><br />
<code>easyrsa sign-req client client1</code> –ø–æ–¥–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–ø—É—Å–∫
—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ —Å –ø–æ–º–æ—â—å—é CA - yes (1.crt)<br />
<code>easyrsa revoke client1</code> –æ—Ç–æ–∑–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>openssl rsa -in "C:\Program Files\OpenVPN\easy-rsa\pki\private\client1.key" -out "C:\Program Files\OpenVPN\easy-rsa\pki\private\client1_nopass.key"</code>
—Å–Ω—è—Ç—å –∑–∞—â–∏—Ç—É –ø–∞—Ä–æ–ª–µ–º –¥–ª—è –∫–ª—é—á–∞ (BEGIN ENCRYPTED PRIVATE KEY -&gt; BEGIN
PRIVATE KEY)<br />
<code>exit</code><br />
<code>cd "C:\Program Files\OpenVPN\bin"</code><br />
<code>.\openvpn --genkey secret ta.key</code> –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ tls-auth
(.key)<br />
<code>Move-Item "C:\Program Files\OpenVPN\bin\ta.key" "C:\Program Files\OpenVPN\easy-rsa\pki\"</code></p>
<h3 id="server.ovpn">server.ovpn</h3>
<p><code># Copy-Item "C:\Program Files\OpenVPN\sample-config\server.ovpn" "C:\Program Files\OpenVPN\config-auto\server.ovpn"</code><br />
<code>New-Item -ItemType File -Path "C:\Program Files\OpenVPN\config-auto\server.ovpn"</code></p>
<pre><code>port 1194
proto udp
# –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç—É–Ω–Ω–µ–ª–µ (ethernet —Ñ—Ä–µ–π–º—ã - tap –∏–ª–∏ ip –ø–∞–∫–µ—Ç—ã - tun)
dev tun
ca &quot;C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\ca.crt&quot;
cert &quot;C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\issued\\server.crt&quot;
key &quot;C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\private\\server.key&quot;
dh &quot;C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\dh.pem&quot;
server 192.168.4.0 255.255.255.0
# –•—Ä–∞–Ω–∏—Ç —Å–ø–∏—Å–æ–∫ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è ip –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤, —á—Ç–æ –±—ã –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ç–æ—Ç –∂–µ –∞–¥—Ä–µ—Å –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
# ifconfig-pool-persist &quot;C:\\Program Files\\OpenVPN\\dhcp-client-list.txt&quot;
# –†–∞–∑—Ä–µ—à–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞–º –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –ø–æ–¥ –æ–¥–Ω–∏–º –∫–ª—é—á–æ–º
# duplicate-cn
# max-clients 30
# –†–∞–∑—Ä–µ—à–∏—Ç—å –æ–±–º–µ–Ω —Ç—Ä–∞—Ñ–∏–∫–æ–º –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏
client-to-client
# compress
tls-auth &quot;C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\ta.key&quot; 0
cipher AES-256-GCM
keepalive 20 60
# –ù–µ –ø–µ—Ä–µ—á–∏—Ç–∞–≤–∞—Ç—å —Ñ–∞–π–ª—ã –∫–ª—é—á–µ–π –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Ç—É–Ω–Ω–µ–ª—è
persist-key
# –û—Å—Ç–∞–≤–ª—è–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ tun/tap –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ OpenVPN
persist-tun
status &quot;C:\\Program Files\\OpenVPN\\log\\status.log&quot;
log &quot;C:\\Program Files\\OpenVPN\\log\\openvpn.log&quot;
verb 3
mute 20
windows-driver wintun
# –û—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–æ–¥—Å–µ—Ç–∏ –∑–∞ —Å–µ—Ä–≤–µ—Ä–æ–º
push &quot;route 192.168.3.0 255.255.255.0&quot;
push &quot;route 192.168.4.0 255.255.255.0&quot;
# –ó–∞–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫–ª–∏–µ–Ω—Ç–∞ (–≤ —Ç–æ–º —á–∏—Å–ª–µ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Ç—Ä–∞—Ñ–∏–∫) –Ω–∞ OpenVPN —Å–µ—Ä–≤–µ—Ä
# push &quot;redirect-gateway def1&quot;
# push &quot;dhcp-option DNS 192.168.3.101&quot;
# push &quot;dhcp-option DOMAIN failon.net&quot;</code></pre>
<p><code>New-NetFirewallRule -DisplayName "AllowOpenVPN-In" -Direction Inbound -Protocol UDP ‚ÄìLocalPort 1194 -Action Allow</code>
–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ<br />
<code>New-NetFirewallRule -DisplayName "AllowOpenVPN-Out" -Direction Outbound -Protocol UDP ‚ÄìLocalPort 1194 -Action Allow</code>
–Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ<br />
<code>Get-Service *openvpn* | Restart-Service</code></p>
<h3 id="client.ovpn">client.ovpn</h3>
<p><code># Copy-Item "C:\Program Files\OpenVPN\sample-config\client.ovpn" "C:\Program Files\OpenVPN\config-auto\client.ovpn"</code><br />
<code>New-Item -ItemType File -Path "C:\Program Files\OpenVPN\config-auto\client.ovpn"</code></p>
<pre><code>client
dev tun
proto udp
remote 26.115.154.67 1194
resolv-retry infinite
nobind
persist-key
persist-tun
ca ca.crt
cert client1.crt
key client1.key
remote-cert-tls server
tls-auth ta.key 1
cipher AES-256-GCM
connect-retry-max 25
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä wintun –∏ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –¥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ openvpn gui
windows-driver wintun
verb 3</code></pre>
<h3 id="client">Client</h3>
<p><code>iwr -Uri https://openvpn.net/downloads/openvpn-connect-v3-windows.msi -OutFile "$home\downloads\OpenVPN-Connect-3.msi"</code><br />
–ü–µ—Ä–µ–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –∫–ª—é—á–∏:<br />
<code>client.ovpn</code><br />
<code>ca.crt</code><br />
<code>dh.pem</code><br />
<code>ta.key</code><br />
<code>client1.crt</code><br />
<code>client1.key</code></p>
<h1 id="route">Route</h1>
<p><code>Get-Service RemoteAccess | Stop-Service</code><br />
<code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters" -Name "IPEnableRouter" -Value 1</code>
–≤–∫–ª—é—á–∞–µ—Ç IP –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é<br />
<code>(Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters").IPEnableRouter</code><br />
<code>Get-NetIPInterface | select ifIndex,InterfaceAlias,AddressFamily,ConnectionState,Forwarding | ft</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã<br />
<code>Set-NetIPInterface -ifIndex 13 -Forwarding Enabled</code> –≤–∫–ª—é—á–∏—Ç—å
–ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—é –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ</p>
<p><code>sysctl net.ipv4.ip_forward=1</code><br />
<code>echo "sysctl net.ipv4.ip_forward = 1" &gt;&gt; /etc/sysctl.conf</code></p>
<p><code>Get-NetRoute</code><br />
<code>New-NetRoute -DestinationPrefix "192.168.3.0/24" -NextHop "192.168.4.1" -InterfaceIndex 8</code><br />
<code>route -p add 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 1</code><br />
<code>route -p change 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 2</code><br />
<code>route -p add 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 1 if 7</code>
—É–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å—ã–ª–∞—Ç—å –ø–∞–∫–µ—Ç
(Wintun Userspace Tunnel)<br />
<code>route print -4</code><br />
<code>route delete 192.168.3.0</code></p>
<p><code>tracert 192.168.3.101</code> —Å 192.168.4.6</p>
<pre><code>1    17 ms     *       22 ms  192.168.4.1
2    12 ms    13 ms    14 ms  192.168.3.101</code></pre>
<p><code>route add -net 192.168.4.0 netmask 255.255.255.0 gw 192.168.3.100</code><br />
<code>route -e</code></p>
<p><code>traceroute 192.168.4.6</code> —Å 192.168.3.101</p>
<pre><code>1  192.168.3.100 (192.168.3.100)  0.148 ms  0.110 ms  0.106 ms
2  192.168.4.6 (192.168.4.6)  14.573 ms * *</code></pre>
<p><code>ping 192.168.3.101 -t</code> —Å 192.168.4.6<br />
<code>tcpdump -n -i ens33 icmp</code> –Ω–∞ 192.168.3.101</p>
<pre><code>14:36:34.533771 IP 192.168.4.6 &gt; 192.168.3.101: ICMP echo request, id 1, seq 2962, length 40 # –æ—Ç–ø—Ä–∞–≤–∏–ª –∑–∞–ø—Ä–æ—Å
14:36:34.533806 IP 192.168.3.101 &gt; 192.168.4.6: ICMP echo reply, id 1, seq 2962, length 40 # –æ—Ç–ø—Ä–∞–≤–∏–ª –æ—Ç–≤–µ—Ç</code></pre>
<h1 id="nat">NAT</h1>
<p><code>Get-Command -Module NetNat</code><br />
<code>New-NetNat -Name LocalNat -InternalIPInterfaceAddressPrefix "192.168.3.0/24"</code><br />
<code>Add-NetNatStaticMapping -NatName LocalNat -Protocol TCP -ExternalIPAddress 0.0.0.0 -ExternalPort 80 -InternalIPAddress 192.168.3.102 -InternalPort 80</code><br />
<code>Remove-NetNatStaticMapping -StaticMappingID 0</code><br />
<code>Remove-NetNat -Name LocalNat</code></p>
<h1 id="wireguard">WireGuard</h1>
<p><code>Invoke-WebRequest "https://download.wireguard.com/windows-client/wireguard-amd64-0.5.3.msi" -OutFile "$home\Downloads\WireGuard-Client-0.5.3.msi"</code><br />
<code>msiexec.exe /i "$home\Downloads\WireGuard-Client-0.5.3.msi" DO_NOT_LAUNCH=1 /qn</code><br />
<code>Invoke-WebRequest "http://www.wiresock.net/downloads/wiresock-vpn-gateway-x64-1.1.4.1.msi" -OutFile "$home\Downloads\WireSock-VPN-Gateway-1.1.4.1.msi"</code><br />
<code>msiexec.exe /i "http://www.wiresock.net/downloads/wiresock-vpn-gateway-x64-1.1.4.1.msi" /qn</code><br />
<code>$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")</code><br />
<code>wg-quick-config -add -start</code><br />
<code>26.115.154.67:8181</code><br />
<code>192.168.21.4/24</code><br />
<code>Successfully saved client configuration: C:\ProgramData\NT KERNEL\WireSock VPN Gateway\wsclient_1.conf</code><br />
<code>Successfully saved server configuration: C:\ProgramData\NT KERNEL\WireSock VPN Gateway\wiresock.conf</code><br />
<code>get-service *wire*</code><br />
<code>wg show</code><br />
<code>wg-quick-config -add -restart</code> add client</p>
<p>wiresock.conf</p>
<pre><code>[Interface]
PrivateKey = gCHC0g2JPwr6sXPiaOL4/KTkMyjN9TculrJUA/GORV8=
Address = 192.168.21.5/24
ListenPort = 8181

[Peer]
PublicKey = NoSxjew2RCHiUzI6mlahjd4I+0EcLsoYom/H01z91yU=
AllowedIPs = 192.168.21.6/32</code></pre>
<p>wsclient_1.conf (–¥–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –≤ AllowedIPs)</p>
<pre><code>[Interface]
PrivateKey = yIpRQRmaGrrk9Y+49E8JhEpFmKzSeecvUAdeNgf1hUM=
Address = 192.168.21.6/24
DNS = 8.8.8.8, 1.1.1.1
MTU = 1420

[Peer]
PublicKey = Fp7674VSYeGj8CYt6RCKR7Qz1y/IKUXCw8ImOFhX3hk=
AllowedIPs = 192.168.21.0/24, 192.168.3.0/24
Endpoint = 26.115.154.67:8181
PersistentKeepalive = 25</code></pre>
<h1 id="vpnclient">VpnClient</h1>
<p><code>Get-Command -Module VpnClient</code><br />
<code>Add-VpnConnection -Name "vpn-failon" -ServerAddress "26.115.154.67" -TunnelType L2TP -L2tpPsk "123098" -EncryptionLevel "Required" -AuthenticationMethod MSChapv2 -RememberCredential -AllUserConnection ‚ÄìPassThru -Force</code><br />
<code>-TunnelType PPTP/L2TP/SSTP/IKEv2/Automatic</code><br />
<code>-L2tpPsk</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–π –∫–ª—é—á –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–±–µ–∑
–ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –¥–ª—è L2TP –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç)<br />
<code>-AuthenticationMethod Pap/Chap/MSChapv2/Eap/MachineCertificate</code><br />
<code>-EncryptionLevel NoEncryption/Optional/Required/Maximum/Custom</code><br />
<code>-SplitTunneling</code> –∑–∞–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ VPN-—Ç—É–Ω–Ω–µ–ª—å
(–≤–∫–ª—é—á–µ–Ω–∏–µ Use default gateway on remote network –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
VPN –∞–¥–∞–ø—Ç–µ—Ä–∞)<br />
<code>-UseWinlogonCredential</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ VPN —Å–µ—Ä–≤–µ—Ä–µ<br />
<code>-RememberCredential</code> —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è
VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –∏ –ø–∞—Ä–æ–ª—å —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–∏—Å–ø–µ—Ç—á–µ—Ä —É—á–µ—Ç–Ω—ã—Ö
–¥–∞–Ω–Ω—ã—Ö Windows –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)<br />
<code>-DnsSuffix domain.local</code><br />
<code>-AllUserConnection</code> —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
–¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª:
C:.pbk)</p>
<p><code>Install-Module -Name VPNCredentialsHelper</code> –º–æ–¥—É–ª—å –¥–ª—è
—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–∏–Ω–∞ –∏ –ø–∞—Ä–æ–ª—è –≤ Windows Credential Manager –¥–ª—è VPN
–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è<br />
<code>Set-VpnConnectionUsernamePassword -connectionname vpn-failon -username user1 -password password</code></p>
<p><code>rasdial "vpn-failon"</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è<br />
<code>Get-VpnConnection -AllUserConnection | select *</code> —Å–ø–∏—Å–æ–∫ VPN
–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–∞–π—Å—Ç—Ä–æ–π–∫–∏ –∏ —Ç–µ–∫—É—â–∏–π
—Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (ConnectionStatus)<br />
<code>Add-VpnConnectionRoute -ConnectionName vpn-failon -DestinationPrefix 192.168.3.0/24 ‚ÄìPassThru</code>
–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –º–∞—Ä—à—Ä—É—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç
–∞–∫—Ç–∏–≤–µ–Ω –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ VPN<br />
<code>Remove-VpnConnection -Name vpn-failon -AllUserConnection -Force</code>
—É–¥–∞–ª–∏—Ç—å</p>
<p><code>Set-VpnConnection -Name "vpn-failon" -SplitTunneling $True</code>
–≤–∫–ª—é—á–∏—Ç—å —Ä–∞–∑–¥–µ–ª—å–Ω–æ–µ —Ç—É–Ω–µ–ª–ª–∏—Ä–æ–≤–∞–Ω–∏–µ<br />
<code>Add-VpnConnectionRoute -ConnectionName "vpn-failon" -DestinationPrefix 172.22.22.0/24</code>
–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏ —á–µ—Ä–µ–∑ VPN-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ<br />
<code>(Get-VpnConnection -ConnectionName "vpn-failon").routes</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è<br />
<code>Remove-VpnConnectionRoute -ConnectionName "vpn-failon" -DestinationPrefix "172.22.23.0/24"</code></p>
<h1 id="proxy">Proxy</h1>
<p><code>$user = "lifailon"</code><br />
<code>$pass = "Proxy"</code><br />
<code>$SecureString = ConvertTo-SecureString $pass -AsPlainText -Force</code><br />
<code>$Credential = New-Object System.Management.Automation.PSCredential($user, $SecureString)</code><br />
<code>[System.Net.Http.HttpClient]::DefaultProxy = New-Object System.Net.WebProxy("http://192.168.3.100:9090")</code><br />
<code>[System.Net.Http.HttpClient]::DefaultProxy.Credentials = [System.Net.CredentialCache]::DefaultCredentials</code><br />
<code>[System.Net.Http.HttpClient]::DefaultProxy.Credentials = $Credential</code><br />
<code>Invoke-RestMethod http://ifconfig.me/ip</code><br />
<code>Invoke-RestMethod https://kinozal.tv/rss.xml</code></p>
<h1 id="netsh">netsh</h1>
<h3 id="proxy-1">Proxy</h3>
<p><code>netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=192.168.3.108</code><br />
<code>netsh interface portproxy show all</code><br />
<code>netsh interface portproxy delete v4tov4 listenport=8080 listenaddress=0.0.0.0</code></p>
<h3 id="wlan">Wlan</h3>
<p><code>netsh wlan show profile</code> —Å–ø–∏—Å–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã –ø—Ä–æ—Ñ–∏–ª–µ–π Wi-Fi
–∏ –ø–∞—Ä–æ–ª–µ–π<br />
<code>netsh wlan show interfaces</code> —Ö–∞—Ä-–∫–∏ —Ç–µ–∫—É—â–µ–π —Å–µ—Ç–∏ (MAC,
speed)<br />
<code>netsh wlan show profile SSID-Name-Network key=clear</code>
–æ—á–∏—Å—Ç–∏—Ç—å –ø–∞—Ä–æ–ª—å<br />
<code>netsh wlan show networks</code> —Å–ø–∏—Å–æ–∫ –≤–∏–¥–µ–º—ã—Ö —Å–µ—Ç–µ–π<br />
<code>netsh wlan disconnect</code> –æ—Ç–∫–ª—é—á–∏—Ç—å—Å—è –æ—Ç Wi-Fi<br />
<code>netsh wlan connect name="SSID-Name-Network"</code>
–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è<br />
<code>netsh wlan show drivers</code> –¥—Ä–∞–π–≤–µ—Ä Wi-Fi<br />
<code>netsh wlan set hostednetwork mode=allow ssid="WiFi-Test" key="password"</code>
—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ Wi-Fi (SoftAP)</p>
<h3 id="firewall-1">Firewall</h3>
<p><code>netsh advfirewall set allprofiles state off</code> –æ—Ç–∫–ª—é—á–∏—Ç—å
fw<br />
<code>netsh advfirewall reset</code> —Å–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏<br />
<code>netsh advfirewall firewall add rule name="Open Remote Desktop" protocol=TCP dir=in localport=3389 action=allow</code>
–æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç 3389<br />
<code>netsh advfirewall firewall add rule name="All ICMP V4" dir=in action=allow protocol=icmpv4</code>
–æ—Ç–∫—Ä—ã—Ç—å icmp</p>
<h1 id="openssh">OpenSSH</h1>
<p><code>Get-WindowsCapability -Online | ? Name -like 'OpenSSH.Client*'</code><br />
<code>Add-WindowsCapability -Online -Name OpenSSH.Client*</code><br />
<code>dism /Online /Add-Capability /CapabilityName:OpenSSH.Client~~~~0.0.1.0</code><br />
<code>iwr https://github.com/PowerShell/Win32-OpenSSH/releases/download/v9.2.2.0p1-Beta/OpenSSH-Win64-v9.2.2.0.msi -OutFile $home\Downloads\OpenSSH-Win64-v9.2.2.0.msi</code>
—Å–∫–∞—á–∞—Ç—å<br />
<code>msiexec /i $home\Downloads\OpenSSH-Win64-v9.2.2.0.msi</code>
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å msi –ø–∞–∫–µ—Ç<br />
<code>Set-Service sshd -StartupType Automatic</code><br />
<code>Get-NetTCPConnection | where LocalPort -eq 22</code><br />
<code>New-NetFirewallRule -Name sshd -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22</code><br />
<code>Get-NetFirewallRule -Name *ssh*</code><br />
<code>Start-Process notepad++ C:\Programdata\ssh\sshd_config</code>
–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª<br />
<code>GSSAPIAuthentication yes</code> –≤–∫–ª—é—á–∏—Ç—å Kerberos –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
(—á–µ—Ä–µ–∑ AD)<br />
<code>SyslogFacility LOCAL0</code> –≤–∫–ª—é—á–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ –≤
—Ñ–∞–π–ª (C:.log)<br />
<code>LogLevel INFO</code><br />
<code>Restart-Service sshd</code><br />
<code>ssh -K $srv</code> –≤—ã–ø–æ–ª–Ω–∏—Ç—å Kerberos –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é<br />
<code>ssh Lifailon@192.168.3.99 -p 22</code><br />
<code>pwsh -command Get-Service</code><br />
<code>ssh -L 3101:192.168.3.101:22 -R 3101:192.168.3.101:22 lifailon@192.168.3.101 -p 22</code>
SSH Tunnel lifailon@localhost:3101 -&gt; 192.168.3.101:3101</p>
<h1 id="winrm">WinRM</h1>
<p><code>Enter-PSSession -ComputerName $srv</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫
PowerShell —Å–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ PSRemoting. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ
FQDN-–∏–º–µ–Ω–∏<br />
<code>Invoke-Command $srv -ScriptBlock {Get-ComputerInfo}</code>
–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ PSRemoting<br />
<code>$session = New-PSSession $srv</code> –æ—Ç–∫—Ä—ã—Ç—å —Å–µ—Å—Å–∏—é<br />
<code>Get-PSSession</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏<br />
<code>icm -Session $session {$srv = $using:srv}</code> –ø–µ—Ä–µ–¥–∞—Ç—å
–ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ ($using) –≤ —É–¥–∞–ª–µ–Ω–Ω—É—é<br />
<code>Disconnect-PSSession $session</code> –∑–∞–∫—Ä—ã—Ç—å —Å–µ—Å—Å–∏—é<br />
<code>Remove-PSSession $session</code> —É–¥–∞–ª–∏—Ç—å —Å–µ—Å—Å–∏—é<br />
<code>Import-Module -Name ActiveDirectory -PSSession $srv</code>
–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å —Å —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ –ª–æ–∫–∞–ª—å–Ω—É—é —Å–µ—Å—Å–∏—é</p>
<h3 id="windows-remote-management-configuration">Windows Remote
Management Configuration</h3>
<p><code>winrm quickconfig -quiet</code> –∏–∑–º–µ–Ω–∏—Ç –∑–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã WinRM –Ω–∞
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π, –∑–∞–¥–∞—Å—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ WinRM –∏ –¥–æ–±–∞–≤–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è
–¥–ª—è –ø–æ—Ä—Ç–æ–≤ –≤ fw<br />
<code>Enable-PSRemoting ‚ÄìForce</code> –≤–∫–ª—é—á–∏—Ç—å PowerShell Remoting,
—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ–º–µ–Ω–Ω–æ–≥–æ –∏ —á–∞—Å—Ç–Ω–æ–≥–æ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π Windows<br />
<code>Enable-PSRemoting -SkipNetworkProfileCheck -Force</code> –¥–ª—è
–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ –æ–±—â–µ–π (public) —Å–µ—Ç–∏ (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤–µ—Ä—Å–∏–∏ powershell
6)</p>
<p><code>$NetProfiles = Get-NetConnectionProfile</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å
–ø—Ä–æ—Ñ–∏–ª–∏ —Å–µ—Ç–µ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π<br />
<code>Set-NetConnectionProfile -InterfaceIndex $NetProfiles[1].InterfaceIndex -NetworkCategory Private</code>
–∏–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø —Å–µ—Ç–∏ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è (DomainAuthenticated/Public)<br />
<code>(Get-CimInstance -ClassName Win32_ComputerSystem).PartOfDomain</code>
–ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–æ–º–ø—å—é—Ç–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –¥–æ–º–µ–Ω AD<br />
<code>Get-Service WinRM | Set-Service -StartupType AutomaticDelayedStart</code>
–æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫<br />
<code>Get-Service -Name winrm -RequiredServices</code> —Å—Ç–∞—Ç—É—Å –∑–∞–≤–∏—Å–∏–º—ã—Ö
—Å–ª—É–∂–±<br />
<code>New-NetFirewallRule -Profile Any -DisplayName "WinRM HTTP" -Direction Inbound -Protocol TCP -LocalPort 5985,5986</code><br />
<code>Test-NetConnection $srv -port 5895</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç<br />
<code>Test-WSMan $srv -ErrorAction Ignore</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É WinRM
–Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –æ—à–∏–±–æ–∫ –¥–ª—è —Å–∫—Ä–∏–ø—Ç–∞) –∏–ª–∏
–ª–æ–∫–∞–ª—å–Ω–æ (localhost)</p>
<p><code>$Cert = New-SelfSignedCertificate -CertStoreLocation Cert:\LocalMachine\My -DnsName "$env:computername" -FriendlyName "WinRM HTTPS Certificate" -NotAfter (Get-Date).AddYears(5)</code>
—Å–æ–∑–¥–∞—Ç—å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç<br />
<code>$Thumbprint = $Cert.Thumbprint</code> –∑–∞–±—Ä–∞—Ç—å –æ—Ç–ø–µ—á–∞—Ç–æ–∫<br />
<code>New-Item -Path WSMan:\Localhost\Listener -Transport HTTPS -Address * -CertificateThumbprint $Thumbprint -Name WinRM_HTTPS_Listener -Force</code>
—Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å–ª—É—à–∏–≤–∞—Ç–µ–ª—å<br />
<code>New-NetFirewallRule -DisplayName 'WinRM HTTPS' -Profile Domain,Private -Direction Inbound -Action Allow -Protocol TCP -LocalPort 5986</code>
–æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç –≤ fw</p>
<pre><code>$selector_set = @{
    Address = &quot;*&quot;
    Transport = &quot;HTTPS&quot;
}
$value_set = @{
    CertificateThumbprint = &quot;66ABFDA044D8C85135048186E2FDC0DBE6125163&quot;
}
New-WSManInstance -ResourceURI &quot;winrm/config/Listener&quot; -SelectorSet $selector_set -ValueSet $value_set</code></pre>
<p><code>winrm get winrm/config</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
(Client/Service)<br />
<code>winrm get winrm/config/service/auth</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ<br />
<code>winrm enumerate winrm/config/listener</code> —Ç–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–ø—Ä–æ—Å–ª—É—à–∏–≤–∞—Ç–µ–ª–µ–π WinRM (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ—Ç–ø–µ—á–∞—Ç–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –¥–ª—è HTTPS
5986)<br />
<code>Get-ChildItem -Path Cert:\LocalMachine\My\ | where Thumbprint -eq D9356FB774EE0E6206B7D5B59B99102CA5B17BDA | select *</code>
–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ</p>
<p><code>ls WSMan:\localhost\Client</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∫–ª–∏–µ–Ω—Ç–∞<br />
<code>ls WSMan:\localhost\Service</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞<br />
<code>ls WSMan:\localhost\Service\auth</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ WinRM —Å–µ—Ä–≤–µ—Ä–∞<br />
<code>Set-Item -path WSMan:\localhost\Service\auth\basic -value $true</code>
—Ä–∞–∑—Ä–µ—à–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∫ —Ç–µ–∫—É—â–µ–º—É —Å–µ—Ä–≤–µ—Ä—É<br />
<code>ls HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\WSMAN</code>
–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ä–µ–µ—Å—Ç—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –∞—É–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ _basic =
1)<br />
<code>Set-Item WSMan:\localhost\Client\TrustedHosts -Value 192.168.* -Force</code>
–¥–æ–±–∞–≤–∏—Ç—å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ö–æ—Å—Ç—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ, —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–∞
Negotiate –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ NTLM<br />
<code>Set-Item WSMan:\localhost\Client\TrustedHosts -Value 192.168.3.100 -Concatenate -Force</code>
–¥–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä<br />
<code>ls WSMan:\localhost\Client\TrustedHosts</code><br />
<code>Set-Item WSMan:\localhost\Client\AllowUnencrypted $true</code>
–≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á–∞ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞<br />
<code>Set-Item WSMan:\localhost\Service\AllowUnencrypted $true</code>
–≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á–∞ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞
(–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—ã—Ç—å –≤ private —Å–µ—Ç–∏)</p>
<p><code>Get-PSSessionConfiguration</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤–∫–ª—é—á–µ–Ω –ª–∏
PSremoting –∏ –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø, –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω–æ
–ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ WinRM<br />
<code>Set-PSSessionConfiguration -Name Microsoft.PowerShell -ShowSecurityDescriptorUI</code>
–Ω–∞–∑–Ω–∞—á–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ (–¥–æ
–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∫–∏)<br />
<code>(Get-PSSessionConfiguration -Name "Microsoft.PowerShell").SecurityDescriptorSDDL</code>
–ø–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ SDDL<br />
<code>Set-PSSessionConfiguration -Name Microsoft.PowerShell -SecurityDescriptorSDDL $SDDL</code>
–ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –Ω–∞ –¥—Ä—É–≥–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
GUI<br />
</p>
<p><code>New-LocalUser "WinRM-Writer" -Password (ConvertTo-SecureString -AsPlainText "123098")</code>
—Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br />
<code>Add-LocalGroupMember -Group "Remote Management Users" -Member "WinRM-Writer"</code>
–¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è WinRM-Writer –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –≥—Ä—É–ø–ø—É –¥–æ—Å—Ç—É–ø–∞
‚Äú–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è‚Äù<br />
<code>cmdkey /add:192.168.3.99 /user:WinRM-Writer /pass:123098</code>
—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ CredentialManager <code>cmdkey /list</code><br />
<code>Import-Module CredentialManager</code><br />
<code>Add-Type -AssemblyName System.Web</code><br />
<code>New-StoredCredential -Target 192.168.3.99 -UserName WinRM-Writer -Password 123098 -Comment WinRM</code>
—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ CredentialManager (–∏–∑ PS5)<br />
<code>Get-StoredCredential -AsCredentialObject</code><br />
<code>$cred = Get-StoredCredential -Target 192.168.3.99</code><br />
<code>Enter-PSSession -ComputerName 192.168.3.99 -Credential $cred -Authentication Negotiate</code><br />
<code>Enter-PSSession -ComputerName 192.168.3.99 -Credential $cred -Authentication Basic -Port 5985</code>
—Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ allowunencrypted –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏
–∫–ª–∏–µ–Ω—Ç–∞<br />
<code>winrs -r:http://192.168.3.100:5985/wsman -u:WinRM-Writer -p:123098 ipconfig</code>
–ø–µ—Ä–µ–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—É —á–µ—Ä–µ–∑ winrs (-?)<br />
<code>winrs -r:https://192.168.3.100:5985/wsman -u:WinRM-Writer -p:123098 -ssl ipconfig</code>
—á–µ—Ä–µ–∑ https<br />
<code>pwsh -Command "Install-Module -Name PSWSMan"</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
–º–æ–¥—É–ª—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ Linux —Å–∏—Å—Ç–µ–º–µ</p>
<h3 id="kerberos">Kerberos</h3>
<p><code>.\CheckMaxTokenSize.ps1 -Principals login -OSEmulation $true -Details $true</code>
—É–∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–æ–∫–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –¥–æ–º–µ–Ω–µ<br />
<code>Get-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Parameters | select maxtokensize</code>
–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ<br />
<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\HTTP\Parameters</code>
–∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä–∞, –µ—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø–∞–∫–µ—Ç–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 16 –ö–±
(–∏–∑ –∑–∞ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª-–≤–∞ –≥—Ä—É–ø–ø)<br />
<code>MaxFieldLength —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 0000ffff (65535)</code><br />
<code>MaxRequestBytes —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 0000ffff (65535)</code></p>
<h1 id="packagemanagement">PackageManagement</h1>
<p><code>Import-Module PackageManagement</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
–º–æ–¥—É–ª—å<br />
<code>Get-Module PackageManagement</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥—É–ª–µ<br />
<code>Get-Command -Module PackageManagement</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ
–∫–æ–º–∞–Ω–¥–ª–µ—Ç—ã –º–æ–¥—É–ª—è<br />
<code>Get-Package</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
PowerShellGallery<br />
<code>Get-Package -ProviderName msi,Programs</code> —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö
–ø—Ä–æ–≥—Ä–∞–º–º
<code>[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12</code>
–≤–∫–ª—é—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª TLS 1.2 (–µ—Å–ª–∏ –Ω–µ –æ—Ç–∫–ª—é—á–µ–Ω—ã –ø—Ä–æ—Ç–æ–∫–æ–ª—ã TLS
1.0 –∏ 1.1)<br />
<code>Find-PackageProvider</code> –ø–æ–∏—Å–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤<br />
<code>Install-PackageProvider PSGallery -force</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
–∏—Å—Ç–æ—á–Ω–∏–∫<br />
<code>Install-PackageProvider NuGet -force</code><br />
<code>Install-PackageProvider Chocolatey -force</code><br />
<code>Get-PackageSource</code> –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤<br />
<code>Set-PackageSource -Name PSGallery -Trusted</code> –ø–æ
—É–º–æ–ª—á–∞–Ω–∏—é<br />
<code>Find-Package -Name *Veeam* -Source PSGallery</code> –ø–æ–∏—Å–∫ –ø–∞–∫–µ—Ç–æ–≤
—Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞<br />
<code>Install-Package -Name VeeamLogParser -ProviderName PSGallery -scope CurrentUser</code><br />
<code>Get-Command *Veeam*</code><br />
<code>Import-Module -Name VeeamLogParser</code> –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥—É–ª—å<br />
<code>Get-Module VeeamLogParser | select -ExpandProperty ExportedCommands</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π</p>
<h3 id="winget">winget</h3>
<p><a href="https://github.com/microsoft/winget-cli">Source</a> <a
href="https://winget.run">Web</a></p>
<p><code>winget list</code> —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤<br />
<code>winget search VLC</code> –Ω–∞–π—Ç–∏ –ø–∞–∫–µ—Ç<br />
<code>winget show VideoLAN.VLC</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–∫–µ—Ç–µ<br />
<code>winget show VideoLAN.VLC --versions</code> —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–µ—Ä—Å–∏–π
–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏<br />
<code>winget install VideoLAN.VLC</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç<br />
<code>winget uninstall VideoLAN.VLC</code> —É–¥–∞–ª–∏—Ç—å –ø–∞–∫–µ—Ç<br />
<code>winget download jqlang.jq</code> –∑–∞–≥—Ä—É–∑–∫–∏—Ç—å –ø–∞–∫–µ—Ç
(https://github.com/jqlang/jq/releases/download/jq-1.7/jq-windows-amd64.exe)<br />
<code>winget install jqlang.jq</code> –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ä–µ–¥—É –∏
–ø—Å–µ–≤–¥–æ–Ω–∏–º –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ jq<br />
<code>winget uninstall jqlang.jq</code></p>
<h3 id="jqlang-install">jqlang-install</h3>
<div class="sourceCode" id="cb161"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>uri<span class="op">]</span><span class="va">$url</span> <span class="op">=</span> <span class="op">$($(</span><span class="fu">irm</span> https<span class="op">://</span>api<span class="op">.</span><span class="fu">github</span><span class="op">.</span><span class="fu">com</span><span class="op">/</span>repos<span class="op">/</span>jqlang<span class="op">/</span>jq<span class="op">/</span>releases<span class="op">/</span>latest<span class="op">).</span><span class="fu">assets</span><span class="op">.</span><span class="fu">browser_download_url</span> <span class="op">-match</span> <span class="st">&quot;windows-amd64&quot;</span><span class="op">).</span><span class="fu">ToString</span><span class="op">()</span> <span class="co"># –ø–æ–ª—É—á–∏—Ç—å –≤–µ—Ä—Å–∏—é latest –Ω–∞ GitHub</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">irm</span> <span class="va">$url</span> <span class="op">-</span>OutFile <span class="st">&quot;C:\Windows\System32\jq.exe&quot;</span> <span class="co"># –∑–∞–≥—Ä—É–∑–∏—Ç—å jq.exe</span></span></code></pre></div>
<h3 id="scoop">Scoop</h3>
<p><code>Set-ExecutionPolicy RemoteSigned -Scope CurrentUser</code><br />
<code>irm get.scoop.sh | iex</code> —É—Å—Ç–∞–Ω–æ–≤–∫–∞<br />
<code>scoop help</code><br />
<code>scoop search jq</code><br />
<code>scoop info jq</code><br />
<code>(scoop info jq).version</code><br />
<code>scoop cat jq</code><br />
<code>scoop download jq</code> C:<br />
<code>scoop install jq</code> C:\1.7<br />
<code>scoop list</code><br />
<code>(scoop list).version</code><br />
<code>scoop uninstall jq</code></p>
<h3 id="chocolatey">Chocolatey</h3>
<div class="sourceCode" id="cb162"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Set-ExecutionPolicy</span> Bypass <span class="op">-</span>Scope <span class="cf">Process</span> <span class="op">-</span>Force<span class="op">;</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">ServicePointManager</span><span class="op">]::</span>SecurityProtocol <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">ServicePointManager</span><span class="op">]::</span>SecurityProtocol <span class="op">-bor</span> <span class="dv">3072</span><span class="op">;</span> <span class="fu">iex</span> <span class="op">((</span><span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">WebClient</span><span class="op">).</span><span class="fu">DownloadString</span><span class="op">(</span><span class="st">&#39;https://community.chocolatey.org/install.ps1&#39;</span><span class="op">))</span></span></code></pre></div>
<p><code>choco -v</code><br />
<code>choco -help</code><br />
<code>choco list</code><br />
<code>choco install adobereader</code></p>
<h1 id="nuget">NuGet</h1>
<p><code>Invoke-RestMethod https://dist.nuget.org/win-x86-commandline/latest/nuget.exe -OutFile "$home\Documents\nuget.exe"</code><br />
<code>Invoke-Expression "$home\Documents\nuget.exe search Selenium.WebDriver"</code><br />
<code>Invoke-Expression "$home\Documents\nuget.exe install Selenium.WebDriver"</code><br />
<code>Get-Item $home\Documents\*Selenium*</code></p>
<p><code>&amp; "$home\Documents\nuget.exe" list console-translate</code><br />
<code>$nuget_api_key = "&lt;API-KEY&gt;"</code><br />
<code>$source = "https://api.nuget.org/v3/index.json"</code><br />
<code>$Name = "Console-Translate"</code><br />
<code>$path = "$home\Documents\$Name"</code><br />
<code>New-Item -Type Directory $path</code><br />
<code>Copy-Item "$home\Documents\Git\$Name\$Name\0.2\*" "$path\"</code><br />
<code>Copy-Item "$home\Documents\Git\$Name\LICENSE" "$path\"</code><br />
<code>Copy-Item "$home\Documents\Git\$Name\README.md" "$path\"</code></p>
<div class="sourceCode" id="cb163"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;&lt;?xml version=&quot;1.0&quot;?&gt;</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;package &gt;</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;metadata&gt;</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;id&gt;Console-Translate&lt;/id&gt;</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;version&gt;0.2.2&lt;/version&gt;</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;authors&gt;Lifailon&lt;/authors&gt;</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;owners&gt;Lifailon&lt;/owners&gt;</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;description&gt;Cross-platform client for translating text in the console, uses API Google (edded public free token), MyMemory and DeepLX (no token required)&lt;/description&gt;</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;tags&gt;PowerShell, Module, Translate, api&lt;/tags&gt;</span></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;projectUrl&gt;https://github.com/Lifailon/Console-Translate&lt;/projectUrl&gt;</span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;contentFiles&gt;</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;files include=&quot;Console-Translate.psm1&quot; buildAction=&quot;Content&quot; /&gt;</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;files include=&quot;Console-Translate.psd1&quot; buildAction=&quot;Content&quot; /&gt;</span></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;files include=&quot;lang-iso-639-1.csv&quot; buildAction=&quot;Content&quot; /&gt;</span></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;files include=&quot;README.md&quot; buildAction=&quot;Content&quot; /&gt;</span></span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;files include=&quot;LICENSE&quot; buildAction=&quot;Content&quot; /&gt;</span></span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/contentFiles&gt;</span></span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/metadata&gt;</span></span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/package&gt;&#39;</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">$path</span><span class="st">\</span><span class="va">$Name</span><span class="st">.nuspec&quot;</span></span></code></pre></div>
<p><code>Set-Location $path</code><br />
<code>&amp; "$home\Documents\nuget.exe" pack "$path\$Name.nuspec"</code><br />
<code>&amp; "$home\Documents\nuget.exe" push "$path\$Name.0.2.2.nupkg" -ApiKey $nuget_api_key -Source $source</code><br />
<code>&amp; "$home\Documents\nuget.exe" push "$path\$Name.0.2.2.nupkg" -ApiKey $nuget_api_key -Source $source -SkipDuplicate</code></p>
<p><code>Install-Package Console-Translate -Source nuget.org</code><br />
<code>Get-Package Console-Translate | select *</code></p>
<p><code>Register-PSRepository -Name "NuGet" -SourceLocation "https://www.nuget.org/api/v2" -InstallationPolicy Trusted</code><br />
<code>Get-PSRepository</code><br />
<code>Find-Module -Name Console-Translate</code><br />
<code>Install-Module Console-Translate -Repository NuGet</code></p>
<p><code>&amp; "$home\Documents\nuget.exe" delete Console-Translate 0.2.0 -Source https://api.nuget.org/v3/index.json -ApiKey $nuget_api_key -NoPrompt</code></p>
<h1 id="git">Git</h1>
<p><code>git --version</code><br />
<code>git config --global user.name "Lifailon"</code> –¥–æ–±–∞–≤–∏—Ç—å –∏–º—è –¥–ª—è
–∫–æ–º–º–∏—Ç–æ–≤<br />
<code>git config --global user.email "lifailon@yandex.ru"</code><br />
<code>git config --global --edit</code><br />
<code>ssh-keygen -t rsa -b 4096</code><br />
<code>Get-Service | where name -match "ssh-agent" | Set-Service -StartupType Automatic</code><br />
<code>Get-Service | where name -match "ssh-agent" | Start-Service</code><br />
<code>Get-Service | where name -match "ssh-agent" | select Name,Status,StartType</code><br />
<code>ssh-agent</code><br />
<code>ssh-add C:\Users\Lifailon\.ssh\id_rsa</code><br />
<code>cat ~\.ssh\id_rsa.pub | Set-Clipboard</code> copy to <a
href="https://github.com/settings/keys">settings keys</a><br />
<code>cd $home\Documents\Git</code><br />
<code>git clone git@github.com:Lifailon/PowerShell-Commands</code><br />
<code>cd PowerShell-Commands</code><br />
<code>git grep powershell</code> –ø–æ–∏—Å–∫ —Ç–µ–∫—Å—Ç–∞ –≤ —Ñ–∞–π–ª–∞—Ö<br />
<code>git pull</code> —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞<br />
<code>git status</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ —Ñ–∞–π–ª–∞–º<br />
<code>git diff</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å—Ç—Ä–æ—á–Ω–æ<br />
<code>git add .</code> –¥–æ–±–∞–≤–∏—Ç—å (–ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å) –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ –≤—Å–µ—Ö
—Ñ–∞–π–ª–∞—Ö<br />
<code>git commit -m "added file and changed file"</code> —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
–∏–∑–º–µ–Ω–µ–Ω–∏—è —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º<br />
<code>git push</code> —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å
—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º<br />
<code>git branch dev</code> —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É<br />
<code>git switch dev</code> –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥—É—é –≤–µ—Ç–∫—É<br />
<code>git push --set-upstream origin dev</code> –¥–æ–±–∞–≤–∏—Ç—å –≤–µ—Ç–∫—É<br />
<code>git branch -d dev</code> —É–¥–∞–ª–∏—Ç—å –≤–µ—Ç–∫—É<br />
<code>git diff rsa</code> —Å—Ä–∞–≤–Ω–∏—Ç—å —Ñ–∞–π–ª—ã —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏ —Å —Ñ–∞–π–ª–∞–º–∏ –≤
—É–∫–∞–∑–∞–Ω–Ω–æ–π –≤–µ—Ç–∫–∏ rsa<br />
<code>git merge dev</code> —Å–ª–∏—è–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏ (rsa/master) —Å
—É–∫–∞–∑–∞–Ω–Ω–æ–π (dev)<br />
<code>git log --oneline --all</code> –ª–æ–≥ –∫–æ–º–º–∏—Ç–æ–≤<br />
<code>git log --graph</code> –∫–æ–º–º–∏—Ç—ã –∏ —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–µ—Ç–æ–∫<br />
<code>git show d01f09dead3a6a8d75dda848162831c58ca0ee13</code>
–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –ª–æ–≥ –ø–æ –Ω–æ–º–µ—Ä—É –∫–æ–º–º–∏—Ç–∞<br />
<code>git checkout filename</code> –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ
–∫–æ–º–∞–Ω–¥—ã add<br />
<code>git checkout d01f09dead3a6a8d75dda848162831c58ca0ee13</code>
–ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã —Ä–∞–±–æ—á–µ–π –∫–æ–ø–∏–∏ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–æ–º–º–∏—Ç (–∏–∑–º–µ–Ω–∏—Ç—å
HEAD –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–æ–º–º–∏—Ç)<br />
<code>git reset HEAD filename</code> –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ
–∏–Ω–¥–µ–∫—Å–∞, –µ—Å–ª–∏ –±—ã–ª add –Ω–æ –Ω–µ –±—ã–ª–æ commit, —Ç–µ–º —Å–∞–º—ã–º –≤–µ—Ä–Ω—É—Ç—å—Å—è –¥–æ
–ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–µ—Ä—Å–∏–∏ (–∫–æ–º–º–∏—Ç–∞) –∏ –ø–æ—Ç–æ–º –≤—ã–ø–æ–ª–Ω–∏—Ç—å
checkout<br />
<code>git reset --mixed HEAD filename</code> –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ—Å—è –≤
–æ—Ç–º–µ–Ω—è–µ–º–æ–º –∫–æ–º–º–∏—Ç–µ, –Ω–µ –¥–æ–ª–∂–Ω—ã –∏—Å—á–µ–∑–Ω—É—Ç—å, –æ–Ω–∏ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –≤–∏–¥–µ
–ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ä–∞–±–æ—á–µ–π –∫–æ–ø–∏–∏<br />
<code>git restore filename</code> –æ—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤
—Ä–∞–±–æ—á–µ–π –∫–æ–ø–∏–∏<br />
<code>git restore --source d01f09dead3a6a8d75dda848162831c58ca0ee13 filename</code>
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –ø–æ —Ö—ç—à—É –∏–Ω–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞
–∫–æ–º–º–∏—Ç–∞<br />
<code>git revert HEAD --no-edit</code> –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç, –±–µ–∑
—É–∫–∞–∑–∞–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è (—Å–æ–±—ã—Ç–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ git log)<br />
<code>git reset --hard d01f09dead3a6a8d75dda848162831c58ca0ee13</code>
—É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–æ–º–º–∏—Ç—ã –¥–æ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ (–∏ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –¥–æ –Ω–µ–≥–æ)</p>
<h1 id="dsc">DSC</h1>
<p><code>Import-Module PSDesiredStateConfiguration</code><br />
<code>Get-Command -Module PSDesiredStateConfiguration</code><br />
<code>(Get-Module PSDesiredStateConfiguration).ExportedCommands</code><br />
<code>Get-DscLocalConfigurationManager</code></p>
<p><code>Get-DscResource</code><br />
<code>Get-DscResource -Name File -Syntax</code> <a
href="https://learn.microsoft.com/ru-ru/powershell/dsc/reference/resources/windows/fileresource?view=dsc-1.1">—Å–∏–Ω—Ç–∞–∫—Å–∏—Å</a></p>
<p><code>Ensure = Present</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω–∞ (–∫–∞—Ç–∞–ª–æ–≥
–¥–æ–ª–∂–µ–Ω –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å, –ø—Ä–æ—Ü–µ—Å—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω, –µ—Å–ª–∏ –Ω–µ—Ç ‚Äì —Å–æ–∑–¥–∞—Ç—å,
–∑–∞–ø—É—Å—Ç–∏—Ç—å)<br />
<code>Ensure = Absent</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã–∫–ª—é—á–µ–Ω–∞ (–∫–∞—Ç–∞–ª–æ–≥–∞
–±—ã—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ, –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω, –µ—Å–ª–∏ –Ω–µ—Ç ‚Äì —É–¥–∞–ª–∏—Ç—å,
–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å)</p>
<div class="sourceCode" id="cb164"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>Configuration TestConfiguraion</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>    Ctrl<span class="op">+</span>Space</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>Configuration DSConfigurationProxy </span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>    Node vproxy-01 </span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>        File CreateDir</span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>            Ensure <span class="op">=</span> <span class="st">&quot;Present&quot;</span></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">Type</span> <span class="op">=</span> <span class="st">&quot;Directory&quot;</span></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>            DestinationPath <span class="op">=</span> <span class="st">&quot;C:\Temp&quot;</span></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a>        Service StopW32time</span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>            Name <span class="op">=</span> <span class="st">&quot;w32time&quot;</span></span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>            State <span class="op">=</span> <span class="st">&quot;Stopped&quot;</span><span class="ch">` </span>Running</span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>        WindowsProcess RunCalc</span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a>            Ensure <span class="op">=</span> <span class="st">&quot;Present&quot;</span></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a>            Path <span class="op">=</span> <span class="st">&quot;C:\WINDOWS\system32\calc.exe&quot;</span></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a>            Arguments <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a>        Registry RegSettings</span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a>            Ensure <span class="op">=</span> <span class="st">&quot;Present&quot;</span></span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a>            Key <span class="op">=</span> <span class="st">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\MySoft&quot;</span></span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a>            ValueName <span class="op">=</span> <span class="st">&quot;TestName&quot;</span></span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a>            ValueData <span class="op">=</span> <span class="st">&quot;TestValue&quot;</span></span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a>            ValueType <span class="op">=</span> <span class="st">&quot;String&quot;</span></span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a><span class="co">#       WindowsFeature IIS</span></span>
<span id="cb164-36"><a href="#cb164-36" aria-hidden="true" tabindex="-1"></a><span class="co">#       {</span></span>
<span id="cb164-37"><a href="#cb164-37" aria-hidden="true" tabindex="-1"></a><span class="co">#            Ensure = &quot;Present&quot;</span></span>
<span id="cb164-38"><a href="#cb164-38" aria-hidden="true" tabindex="-1"></a><span class="co">#            Name = &quot;Web-Server&quot;</span></span>
<span id="cb164-39"><a href="#cb164-39" aria-hidden="true" tabindex="-1"></a><span class="co">#       }</span></span>
<span id="cb164-40"><a href="#cb164-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb164-41"><a href="#cb164-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>$Path = (DSConfigurationProxy).DirectoryName</code><br />
<code>Test-DscConfiguration -Path $Path | select *</code>
ResourcesInDesiredState - —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ, ResourcesNotInDesiredState - –Ω–µ
–Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ (–Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç)<br />
<code>Start-DscConfiguration -Path $Path</code><br />
<code>Get-Job</code><br />
<code>$srv = "vproxy-01"</code><br />
<code>Get-Service -ComputerName $srv | ? name -match w32time # Start-Service</code><br />
<code>icm $srv {Get-Process | ? ProcessName -match calc} | ft # Stop-Process -Force</code><br />
<code>icm $srv {ls C:\ | ? name -match Temp} | ft</code>
rm<code>```PowerShell Configuration InstallPowerShellCore {     Import-DscResource -ModuleName PSDesiredStateConfiguration     Node localhost {         Script InstallPowerShellCore {             GetScript = {                 return @{                     GetScript = $GetScript                 }             }             SetScript = {                 [string]$url = $(Invoke-RestMethod https://api.github.com/repos/PowerShell/PowerShell/releases/latest).assets.browser_download_url -match "win-x64.zip"                 $downloadPath = "$home\Downloads\PowerShell.zip"                 $installPath = "$env:ProgramFiles\PowerShell\7"                 Invoke-WebRequest -Uri $url -OutFile $downloadPath                 Expand-Archive -Path $downloadPath -DestinationPath $installPath -Force             }             TestScript = {                 return Test-Path "$env:ProgramFiles\PowerShell\7\pwsh.exe"             }         }     } } ```</code>$Path
=
(InstallPowerShellCore).DirectoryName<code>\</code>Test-DscConfiguration
-Path $Path<code>\</code>Start-DscConfiguration -Path $path -Wait
-Verbose<code>\</code>Get-Job`</p>
<h1 id="ansible">Ansible</h1>
<p><code>apt -y update &amp;&amp; apt -y upgrade</code><br />
<code>apt -y install ansible</code> v2.10.8<br />
<code>apt -y install ansible-core</code> v2.12.0<br />
<code>apt -y install sshpass</code></p>
<p><code>ansible-galaxy collection install ansible.windows</code>
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é –º–æ–¥—É–ª–µ–π<br />
<code>ansible-galaxy collection install community.windows</code><br />
<code>ansible-galaxy collection list | grep windows</code><br />
<code>ansible-config dump | grep DEFAULT_MODULE_PATH</code> –ø—É—Ç—å
—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥—É–ª–µ–π</p>
<p><code>apt-get -y install python-dev libkrb5-dev krb5-user</code>
–ø–∞–∫–µ—Ç—ã –¥–ª—è Kerberos –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏<br />
<code>apt install python3-pip</code><br />
<code>pip3 install requests-kerberos</code><br />
<code>nano /etc/krb5.conf</code> –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å [realms] –∏
[domain_realm]<br />
<code>kinit -C support4@domail.local</code><br />
<code>klist</code></p>
<p><code>ansible --version</code><br />
<code>config file = None</code><br />
<code>nano /etc/ansible/ansible.cfg</code> —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</p>
<pre><code>[defaults]
inventory = /etc/ansible/hosts
# uncomment this to disable SSH key host checking
# –û—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∫–ª—é—á–∞ ssh (–¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—è –ø–∞—Ä–æ–ª—å)
host_key_checking = False</code></pre>
<p><code>nano /etc/ansible/hosts</code></p>
<pre><code>[us]
pi-hole-01 ansible_host=192.168.3.101
zabbix-01 ansible_host=192.168.3.102
grafana-01 ansible_host=192.168.3.103
netbox-01 ansible_host=192.168.3.104

[all:vars]
ansible_ssh_port=2121
ansible_user=lifailon
ansible_password=123098
path_user=/home/lifailon
ansible_python_interpreter=/usr/bin/python3

[ws]
huawei-book-01 ansible_host=192.168.3.99
plex-01 ansible_host=192.168.3.100

[ws:vars]
ansible_port=5985
#ansible_port=5986
ansible_user=Lifailon
#ansible_user=support4@DOMAIN.LOCAL
ansible_password=123098
ansible_connection=winrm
ansible_winrm_scheme=http
ansible_winrm_transport=basic
#ansible_winrm_transport=kerberos
ansible_winrm_server_cert_validation=ignore
validate_certs=false

[win_ssh]
huawei-book-01 ansible_host=192.168.3.99
plex-01 ansible_host=192.168.3.100

[win_ssh:vars]
ansible_python_interpreter=C:\Users\Lifailon\AppData\Local\Programs\Python\Python311\` –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ä–µ–¥—ã –∏–Ω—Ç–µ—Ä–ø—Ä–∏—Ç–∞—Ç–æ—Ä–∞ Python –≤ Windows
ansible_connection=ssh
#ansible_shell_type=cmd
ansible_shell_type=powershell</code></pre>
<p><code>ansible-inventory --list</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (—á–∏—Ç–∞–µ—Ç
–≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON) –∏–ª–∏ YAML (-y) —Å –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º –≤—Å–µ –ø—Ä–∏–º–µ–Ω—è–µ–º—ã—Ö
–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</p>
<h1 id="win_modules">Win_Modules</h1>
<p><code>ansible us -m ping</code><br />
<code>ansible win_ssh -m ping</code><br />
<code>ansible us -m shell -a "uptime &amp;&amp; df -h | grep lv"</code><br />
<code>ansible us -m setup | grep -iP "mem|proc"</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ
–∂–µ–ª–µ–∑–µ<br />
<code>ansible us -m apt -a "name=mc" -b</code> –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ sudo
(-b)<br />
<code>ansible us -m service -a "name=ssh state=restarted enabled=yes" -b</code>
–ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É<br />
<code>echo "echo test" &gt; test.sh</code><br />
<code>ansible us -m copy -a "src=test.sh dest=/root mode=777" -b</code><br />
<code>ansible us -a "ls /root" -b</code><br />
<code>ansible us -a "cat /root/test.sh" -b</code></p>
<p><code>ansible-doc -l | grep win_</code> <a
href="https://docs.ansible.com/ansible/latest/collections/ansible/windows/">—Å–ø–∏—Å–æ–∫
–≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π Windows</a><br />
<code>ansible ws -m win_ping</code> windows –º–æ–¥—É–ª—å<br />
<code>ansible ws -m win_ping -u WinRM-Writer</code> —É–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏–Ω<br />
<code>ansible ws -m setup</code> —Å–æ–±—Ä–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ
—Å–∏—Å—Ç–µ–º–µ<br />
<code>ansible ws -m win_whoami</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∞–≤–∞—Ö –¥–æ—Å—Ç—É–ø–∞—Ö,
–≥—Ä—É–ø–ø–∞—Ö –¥–æ—Å—Ç—É–ø–∞<br />
<code>ansible ws -m win_shell -a '$PSVersionTable'</code><br />
<code>ansible ws -m win_shell -a 'Get-Service | where name -match "ssh|winrm"'</code><br />
<code>ansible ws -m win_service -a "name=sshd state=stopped"</code><br />
<code>ansible ws -m win_service -a "name=sshd state=started"</code></p>
<h3 id="win_shell-varsdebug">win_shell (vars/debug)</h3>
<p><code>nano /etc/ansible/PowerShell-Vars.yml</code></p>
<pre><code>- hosts: ws
 ` –£–∫–∞–∑–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é –º–æ–¥—É–ª–µ–π
  collections:
  - ansible.windows
 ` –ó–∞–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
  vars:
    SearchName: PermitRoot
  tasks:
  - name: Get port ssh
    win_shell: |
      Get-Content &quot;C:\Programdata\ssh\sshd_config&quot; | Select-String &quot;{{SearchName}}&quot;
   ` –ü–µ—Ä–µ–¥–∞—Ç—å –≤—ã–≤–æ–¥ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
    register: command_output
  - name: Output port ssh
   ` –í—ã–≤–µ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –Ω–∞ —ç–∫—Ä–∞–Ω
    debug:
      var: command_output.stdout_lines</code></pre>
<p><code>ansible-playbook /etc/ansible/PowerShell-Vars.yml</code><br />
<code>ansible-playbook /etc/ansible/PowerShell-Vars.yml --extra-vars "SearchName='LogLevel|Syslog'"</code>
–ø–µ—Ä–µ–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é</p>
<h3 id="win_powershell">win_powershell</h3>
<p><code>nano /etc/ansible/powershell-param.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Run PowerShell script with parameters
    ansible.windows.win_powershell:
      parameters:
        Path: C:\Temp
        Force: true
      script: |
        [CmdletBinding()]
        param (
          [String]$Path,
          [Switch]$Force
        )
        New-Item -Path $Path -ItemType Directory -Force:$Force</code></pre>
<p><code>ansible-playbook /etc/ansible/powershell-param.yml</code></p>
<h3 id="win_chocolatey">win_chocolatey</h3>
<p><code>nano /etc/ansible/setup-adobe-acrobat.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Install Acrobat Reader
    win_chocolatey:
      name: adobereader
      state: present</code></pre>
<p><code>ansible-playbook /etc/ansible/setup-adobe-acrobat.yml</code></p>
<p><code>nano /etc/ansible/setup-openssh.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: install the Win32-OpenSSH service
    win_chocolatey:
      name: openssh
      package_params: /SSHServerFeature
      state: present</code></pre>
<p><code>ansible-playbook /etc/ansible/setup-openssh.yml</code></p>
<h3 id="win_regedit">win_regedit</h3>
<p><code>nano /etc/ansible/win-set-shell-ssh-ps7.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Set the default shell to PowerShell 7 for Windows OpenSSH
    win_regedit:
      path: HKLM:\SOFTWARE\OpenSSH
      name: DefaultShell
     ` data: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
      data: &#39;C:\Program Files\PowerShell\7\pwsh.exe&#39;
      type: string
      state: present</code></pre>
<p><code>ansible-playbook /etc/ansible/win-set-shell-ssh-ps7.yml</code></p>
<h3 id="win_service">win_service</h3>
<p><code>nano /etc/ansible/win-service.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Start service
    win_service:
      name: sshd
      state: started
#     state: stopped
#     state: restarted
#     start_mode: auto</code></pre>
<p><code>ansible-playbook /etc/ansible/win-service.yml</code></p>
<h3 id="win_service_info">win_service_info</h3>
<p><code>nano /etc/ansible/get-service.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Get info for a single service
    win_service_info:
      name: sshd
    register: service_info
  - name: Print returned information
    ansible.builtin.debug:
      var: service_info.services</code></pre>
<p><code>ansible-playbook /etc/ansible/get-service.yml</code></p>
<h3 id="fetchslurp">fetch/slurp</h3>
<p><code>nano /etc/ansible/copy-from-win-to-local.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Retrieve remote file on a Windows host
#   –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –∏–∑ Windows-—Å–∏—Å—Ç–µ–º—ã
    ansible.builtin.fetch:
#   –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª (–ø–µ—Ä–µ–¥–∞—Ç—å –≤ –ø–∞–º—è—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ Base64)
#   ansible.builtin.slurp:
      src: C:\Telegraf\telegraf.conf
      dest: /root/telegraf.conf
      flat: yes
    register: telegraf_conf
  - name: Print returned information
    ansible.builtin.debug:
      msg: &quot;{{ telegraf_conf[&#39;content&#39;] | b64decode }}&quot;</code></pre>
<p><code>ansible-playbook /etc/ansible/copy-from-win-to-local.yml</code></p>
<h3 id="win_copy">win_copy</h3>
<p><code>echo "Get-Service | where name -eq vss | Start-Service" &gt; /home/lifailon/Start-Service-VSS.ps1</code><br />
<code>nano /etc/ansible/copy-file-to-win.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Copy file to win hosts
    win_copy:
      src: /home/lifailon/Start-Service-VSS.ps1
      dest: C:\Users\Lifailon\Desktop\Start-Service-VSS.ps1</code></pre>
<p><code>ansible-playbook /etc/ansible/copy-file-to-win.yml</code></p>
<p><code>curl -OL https://github.com/PowerShell/PowerShell/releases/download/v7.3.6/PowerShell-7.3.6-win-x64.msi</code><br />
<code>nano /etc/ansible/copy-file-to-win.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Copy file to win hosts
    win_copy:
      src: /home/lifailon/PowerShell-7.3.6-win-x64.msi
      dest: C:\Install\PowerShell-7.3.6.msi</code></pre>
<p><code>ansible-playbook /etc/ansible/copy-file-to-win.yml</code></p>
<h3 id="win_command">win_command</h3>
<p><code>nano /etc/ansible/run-script-ps1.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Run PowerShell Script
    win_command: powershell -ExecutionPolicy ByPass -File C:\Users\Lifailon\Desktop\Start-Service-VSS.ps1</code></pre>
<p><code>ansible-playbook /etc/ansible/run-script-ps1.yml</code></p>
<h3 id="win_package">win_package</h3>
<p><code>nano /etc/ansible/setup-msi-package.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Install MSI Package
    win_package:
#     path: C:\Install\7z-23.01.msi
      path: C:\Install\PowerShell-7.3.6.msi
      arguments:
        - /quiet
        - /passive
        - /norestart</code></pre>
<p><code>ansible-playbook /etc/ansible/setup-msi-package.yml</code></p>
<h3 id="win_firewall_rule">win_firewall_rule</h3>
<p><code>nano /etc/ansible/win-fw-open.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Open RDP port
    win_firewall_rule:
      name: Open RDP port
      localport: 3389
      action: allow
      direction: in
      protocol: tcp
      state: present
      enabled: yes</code></pre>
<p><code>ansible-playbook /etc/ansible/win-fw-open.yml</code></p>
<h3 id="win_group">win_group</h3>
<p><code>nano /etc/ansible/win-creat-group.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Create a new group
    win_group:
      name: deploy
      description: Deploy Group
      state: present</code></pre>
<p><code>ansible-playbook /etc/ansible/win-creat-group.yml</code></p>
<h3 id="win_group_membership">win_group_membership</h3>
<p><code>nano /etc/ansible/add-user-to-group.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Add a local and domain user to a local group
    win_group_membership:
      name: deploy
      members:
        - WinRM-Writer
      state: present</code></pre>
<p><code>ansible-playbook /etc/ansible/add-user-to-group.yml</code></p>
<h3 id="win_user">win_user</h3>
<p><code>nano /etc/ansible/creat-win-user.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Creat user
    win_user:
      name: test
      password: 123098
      state: present
      groups:
        - deploy</code></pre>
<p><code>ansible-playbook /etc/ansible/creat-win-user.yml</code></p>
<p><code>nano /etc/ansible/delete-win-user.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Delete user
    ansible.windows.win_user:
      name: test
      state: absent</code></pre>
<p><code>ansible-playbook /etc/ansible/delete-win-user.yml</code></p>
<h3 id="win_feature">win_feature</h3>
<p><code>nano /etc/ansible/install-feature.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Install Windows Feature
      win_feature:
        name: SNMP-Service
        state: present</code></pre>
<p><code>ansible-playbook /etc/ansible/install-feature.yml</code></p>
<h3 id="win_reboot">win_reboot</h3>
<p><code>nano /etc/ansible/win-reboot.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Reboot a slow machine that might have lots of updates to apply
    win_reboot:
      reboot_timeout: 3600</code></pre>
<p><code>ansible-playbook /etc/ansible/win-reboot.yml</code></p>
<h3 id="win_find">win_find</h3>
<p><code>nano /etc/ansible/win-ls.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Find files in multiple paths
    ansible.windows.win_find:
      paths:
      - D:\Install\OpenSource
      patterns: [&#39;*.rar&#39;,&#39;*.zip&#39;,&#39;*.msi&#39;]
     ` –§–∞–π–ª —Å–æ–∑–¥–∞–Ω–Ω—ã–π –º–µ–Ω–µ–µ 7 –¥–Ω–µ–π –Ω–∞–∑–∞–¥
      age: -7d
     ` –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –±–æ–ª—å—à–µ 10MB
      size: 10485760
     ` –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ (–≤ –¥–æ—á–µ—Ä–Ω–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö)
      recurse: true
    register: command_output
  - name: Output
    debug:
      var: command_output</code></pre>
<p><code>ansible-playbook /etc/ansible/win-ls.yml</code></p>
<h3 id="win_uri">win_uri</h3>
<p><code>nano /etc/ansible/rest-get.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: REST GET request to endpoint github
    ansible.windows.win_uri:
      url: https://api.github.com/repos/Lifailon/pSyslog/releases/latest
    register: http_output
  - name: Output
    debug:
      var: http_output</code></pre>
<p><code>ansible-playbook /etc/ansible/rest-get.yml</code></p>
<h3 id="win_updates">win_updates</h3>
<p><code>nano /etc/ansible/win-update.yml</code></p>
<pre><code>- hosts: ws
  tasks:
  - name: Install only particular updates based on the KB numbers
    ansible.windows.win_updates:
      category_names:
      - SecurityUpdates
      - CriticalUpdates
      - UpdateRollups
      - Drivers
     ` –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
     ` accept_list:
     ` - KB2267602
     ` –ü–æ–∏—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
     ` state: searched
     ` –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
     ` state: downloaded
     ` –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
      state: installed
      log_path: C:\Ansible-Windows-Upadte-Log.txt
      reboot: false
    register: wu_output
  - name: Output
    debug:
      var: wu_output</code></pre>
<p><code>ansible-playbook /etc/ansible/win-update.yml</code></p>
<h3 id="win_chocolatey-1">win_chocolatey</h3>
<p><a href="https://chocolatey.org/install">Install</a><br />
<a
href="https://community.chocolatey.org/api/v2/package/chocolatey">API</a><br />
<a
href="https://docs.chocolatey.org/en-us/guides/organizations/organizational-deployment-guide">Deployment</a></p>
<pre><code>- name: Ensure Chocolatey installed from internal repo
  win_chocolatey:
    name: chocolatey
    state: present
    # source: URL-–∞–¥—Ä–µ—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
    source: https://community.chocolatey.org/api/v2/ChocolateyInstall.ps1</code></pre>
<h1 id="gigachat">GigaChat</h1>
<p><a href="https://developers.sber.ru/gigachat/login">Developers
chat</a></p>
<h3 id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤">1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤:</h3>
<p><code>Invoke-WebRequest "https://gu-st.ru/content/lending/russian_trusted_root_ca_pem.crt" -OutFile "$home\Downloads\russian_trusted_root_ca.cer"</code>
—Å–∫–∞—á–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –º–∏–Ω—Ü–∏—Ñ—Ä—ã<br />
<code>Invoke-WebRequest "https://gu-st.ru/content/lending/russian_trusted_sub_ca_pem.crt" -OutFile "$home\Downloads\russian_trusted_sub_ca.cer"</code><br />
<code>Import-Certificate -FilePath "$home\Downloads\russian_trusted_root_ca.cer" -CertStoreLocation "Cert:\CurrentUser\Root"</code>
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –º–∏–Ω—Ü–∏—Ñ—Ä—ã<br />
<code>Import-Certificate -FilePath "$home\Downloads\russian_trusted_sub_ca.cer" -CertStoreLocation "Cert:\CurrentUser\CA"</code></p>
<h3
id="–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è-–ø–æ-sber-id-–∏-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è-–Ω–æ–≤—ã—Ö-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö-–¥–ª—è-–ø–æ–ª—É—á–µ–Ω–∏—è-—Ç–æ–∫–µ–Ω–∞-developers-–≤—Ä–µ–º—è-–∂–∏–∑–Ω–∏-30-–º–∏–Ω—É—Ç">2.
–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ Sber ID –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è
–ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞: <a
href="https://developers.sber.ru/studio">Developers</a> (–≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ 30
–º–∏–Ω—É—Ç)</h3>
<h3
id="—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö-–≤-—Ñ–æ—Ä–º–∞—Ç–µ-base64-–∏–∑-client-id-–∏-client-secret">3.
–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ Base64 –∏–∑ Client ID –∏
Client Secret:</h3>
<div class="sourceCode" id="cb190"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="va">$Client_ID</span>     <span class="op">=</span> <span class="st">&quot;7e6d2f9f-825e-49b7-98f4-62fbb7506427&quot;</span> <span class="co"># [System.Guid]::Parse(&quot;7e6d2f9f-825e-49b7-98f4-62fbb7506427&quot;)</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Client_Secret</span> <span class="op">=</span> <span class="st">&quot;c35113ee-6757-47ba-9853-ea1d0d9db1ef&quot;</span> <span class="co"># [System.Guid]::Parse(&quot;c35113ee-6757-47ba-9853-ea1d0d9db1ef&quot;)</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Client_Join</span>   <span class="op">=</span> <span class="va">$Client_ID</span><span class="op">+</span><span class="st">&quot;:&quot;</span><span class="op">+</span><span class="va">$Client_Secret</span> <span class="co"># –æ–±—ä–µ–¥–∏–Ω—è–µ–º –¥–≤–∞ UUID –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É, —Ä–∞–∑–¥–µ–ª—è—è –∏—Ö —Å–∏–º–≤–æ–ª–æ–º &#39;:&#39;</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="va">$Bytes</span>         <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Text</span><span class="op">.</span><span class="fu">Encoding</span><span class="op">]::</span>UTF8<span class="op">.</span><span class="fu">GetBytes</span><span class="op">(</span><span class="va">$Client_Join</span><span class="op">)</span> <span class="co"># –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –≤ –º–∞—Å—Å–∏–≤ –±–∞–π—Ç</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a><span class="va">$Cred_Base64</span>   <span class="op">=</span> <span class="op">[</span>Convert<span class="op">]::</span>ToBase64String<span class="op">(</span><span class="va">$Bytes</span><span class="op">)</span> <span class="co"># –∫–æ–¥–∏—Ä—É–µ–º –±–∞–π—Ç—ã –≤ —Å—Ç—Ä–æ–∫—É Base64</span></span></code></pre></div>
<h3 id="–ø–æ–ª—É—á–µ–Ω–∏–µ-—Ç–æ–∫–µ–Ω–∞">4. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:</h3>
<p><code>$Cred_Base64   = "N2U2ZDJmOWYtODI1ZS00OWI3LTk4ZjQtNjJmYmI3NTA2NDI3OmIyYzgwZmZmLTEzOGUtNDg1Mi05MjgwLWE2MGI4NTc0YTM2MQ=="</code><br />
<code>$UUID = [System.Guid]::NewGuid()</code> –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º UUID –¥–ª—è
–∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –≤—ã–∑–æ–≤–æ–≤ –∏ —Ä–∞–∑–±–æ—Ä–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤</p>
<div class="sourceCode" id="cb191"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="va">$url</span> <span class="op">=</span> <span class="st">&quot;https://ngw.devices.sberbank.ru:9443/api/v2/oauth&quot;</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Authorization&quot;</span> <span class="op">=</span> <span class="st">&quot;Basic </span><span class="va">$Cred_Base64</span><span class="st">&quot;</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;RqUID&quot;</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$UUID</span><span class="st">&quot;</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Content-Type&quot;</span> <span class="op">=</span> <span class="st">&quot;application/x-www-form-urlencoded&quot;</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="va">$body</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>    scope <span class="op">=</span> <span class="st">&quot;GIGACHAT_API_PERS&quot;</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a><span class="va">$GIGA_TOKEN</span> <span class="op">=</span> <span class="op">$(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="va">$url</span> <span class="op">-</span>Method POST <span class="op">-</span>Headers <span class="va">$headers</span> <span class="op">-</span>Body <span class="va">$body</span><span class="op">).</span><span class="fu">access_token</span></span></code></pre></div>
<h3 id="–ø–∞—Ä–∞–º–µ—Ç—Ä—ã">5. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:</h3>
<div class="sourceCode" id="cb192"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$content</span> <span class="op">=</span> <span class="st">&quot;–ü–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É —á–∏—Å–µ–ª: 22+33&quot;</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$role</span> <span class="op">=</span> <span class="st">&quot;user&quot;</span> <span class="co"># —Ä–æ–ª—å –∞–≤—Ç–æ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (user/assistant/system)</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dt">float</span><span class="op">]</span><span class="va">$temperature</span> <span class="op">=</span> <span class="dv">0.7</span> <span class="co"># —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤—ã–±–æ—Ä–∫–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ 2. –ß–µ–º –≤—ã—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–µ–º –±–æ–ª–µ–µ —Å–ª—É—á–∞–π–Ω—ã–º –±—É–¥–µ—Ç –æ—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏.</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dt">float</span><span class="op">]</span><span class="va">$top_p</span> <span class="op">=</span> <span class="dv">0.1</span> <span class="co"># –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ temperature –∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ 1. –ó–∞–¥–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—É—é –º–∞—Å—Å—É —Ç–æ–∫–µ–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω–∞ —É—á–∏—Ç—ã–≤–∞—Ç—å –º–æ–¥–µ–ª—å. –¢–∞–∫, –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ 0.1, –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω—ã, —á—å—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–∞—è –º–∞—Å—Å–∞ –≤—Ö–æ–¥–∏—Ç –≤ –≤–µ—Ä—Ö–Ω–∏–µ 10%.</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>int64<span class="op">]</span><span class="va">$n</span> <span class="op">=</span> <span class="dv">1</span> <span class="co"># –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤ (1..4), –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—Ö–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>int64<span class="op">]</span><span class="va">$max_tokens</span> <span class="op">=</span> <span class="dv">512</span> <span class="co"># –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>boolean<span class="op">]</span><span class="va">$stream</span> <span class="op">=</span> <span class="va">$false</span> <span class="co"># –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ —á–∞—Å—Ç—è–º –≤ –ø–æ—Ç–æ–∫–µ</span></span></code></pre></div>
<h3 id="—Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ-–∑–∞–ø—Ä–æ—Å–æ–≤">6. –°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤:</h3>
<div class="sourceCode" id="cb193"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="va">$url</span> <span class="op">=</span> <span class="st">&quot;https://gigachat.devices.sberbank.ru/api/v1/chat/completions&quot;</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Authorization&quot;</span> <span class="op">=</span> <span class="st">&quot;Bearer </span><span class="va">$GIGA_TOKEN</span><span class="st">&quot;</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Content-Type&quot;</span> <span class="op">=</span> <span class="st">&quot;application/json&quot;</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="op">$(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="st">&quot;https://gigachat.devices.sberbank.ru/api/v1/models&quot;</span> <span class="op">-</span>Headers <span class="va">$headers</span><span class="op">).</span><span class="fu">data</span> <span class="co"># —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</span></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a><span class="va">$body</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> <span class="st">&quot;GigaChat:latest&quot;</span></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a>    messages <span class="op">=</span> <span class="op">@(</span></span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a>        @<span class="op">{</span></span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a>            role <span class="op">=</span> <span class="va">$role</span></span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a>            content <span class="op">=</span> <span class="va">$content</span></span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a>    temperature <span class="op">=</span> <span class="va">$temperature</span></span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="va">$n</span></span>
<span id="cb193-19"><a href="#cb193-19" aria-hidden="true" tabindex="-1"></a>    max_tokens <span class="op">=</span> <span class="va">$max_tokens</span></span>
<span id="cb193-20"><a href="#cb193-20" aria-hidden="true" tabindex="-1"></a>    stream <span class="op">=</span> <span class="va">$stream</span></span>
<span id="cb193-21"><a href="#cb193-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span></span>
<span id="cb193-22"><a href="#cb193-22" aria-hidden="true" tabindex="-1"></a><span class="va">$Request</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method POST <span class="op">-</span>Uri <span class="va">$url</span> <span class="op">-</span>Headers <span class="va">$headers</span> <span class="op">-</span>Body <span class="va">$body</span></span>
<span id="cb193-23"><a href="#cb193-23" aria-hidden="true" tabindex="-1"></a><span class="va">$Request</span><span class="op">.</span><span class="fu">choices</span><span class="op">.</span><span class="fu">message</span><span class="op">.</span><span class="fu">content</span></span></code></pre></div>
<h2 id="curl">Curl</h2>
<h3 id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤-–≤-ubuntu">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤
Ubuntu:</h3>
<p><code>wget https://gu-st.ru/content/lending/russian_trusted_root_ca_pem.crt</code><br />
<code>wget https://gu-st.ru/content/lending/russian_trusted_sub_ca_pem.crt</code><br />
<code>mkdir /usr/local/share/ca-certificates/russian_trusted</code><br />
<code>cp russian_trusted_root_ca_pem.crt russian_trusted_sub_ca_pem.crt /usr/local/share/ca-certificates/russian_trusted</code><br />
<code>update-ca-certificates -v</code><br />
<code>wget -qS --spider --max-redirect=0 https://www.sberbank.ru</code></p>
<h3 id="–ø–æ–ª—É—á–µ–Ω–∏–µ-—Ç–æ–∫–µ–Ω–∞-1">–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:</h3>
<div class="sourceCode" id="cb194"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="va">Cred_Base64</span><span class="op">=</span><span class="st">&quot;N2U2ZDJmOWYtODI1ZS00OWI3LTk4ZjQtNjJmYmI3NTA2NDI3OmIyYzgwZmZmLTEzOGUtNDg1Mi05MjgwLWE2MGI4NTc0YTM2MQ==&quot;</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="va">UUID</span><span class="op">=</span><span class="va">$(</span><span class="fu">uuidgen</span><span class="va">)</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="va">GIGA_TOKEN</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">--location</span> <span class="at">--request</span> POST <span class="st">&quot;https://ngw.devices.sberbank.ru:9443/api/v2/oauth&quot;</span> <span class="dt">\</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>--header <span class="st">&quot;Authorization: Basic </span><span class="va">$Cred_Base64</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>--header <span class="st">&quot;RqUID: </span><span class="va">$UUID</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>--header <span class="st">&quot;Content-Type: application/x-www-form-urlencoded&quot;</span> <span class="dt">\</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>--data-urlencode <span class="st">&#39;scope=GIGACHAT_API_PERS&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> .access_token<span class="va">)</span></span></code></pre></div>
<p><code>curl -s --location "https://gigachat.devices.sberbank.ru/api/v1/models" --header "Authorization: Bearer $GIGA_TOKEN" | jq .</code>
–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</p>
<h3 id="—Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ-–∑–∞–ø—Ä–æ—Å–∞">–°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞:</h3>
<div class="sourceCode" id="cb195"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="va">request</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> https://gigachat.devices.sberbank.ru/api/v1/chat/completions <span class="dt">\</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Authorization: Bearer </span><span class="va">$GIGA_TOKEN</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-d</span> <span class="st">&#39;{</span></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;model&quot;: &quot;GigaChat:latest&quot;,</span></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;messages&quot;: [</span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a><span class="st">        {</span></span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;role&quot;: &quot;user&quot;,</span></span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;content&quot;: &quot;–ö–æ–≥–¥–∞ —É–∂–µ –ò–ò –∑–∞—Ö–≤–∞—Ç–∏—Ç —ç—Ç–æ—Ç –º–∏—Ä?&quot;</span></span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a><span class="st">    ],</span></span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;temperature&quot;: 0.7</span></span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span><span class="va">)</span></span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$request</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> .choices[].message.content</span></code></pre></div>
<h1 id="yandexgpt">YandexGPT</h1>
<h2 id="–ø–æ–ª—É—á–∏—Ç—å-oauth-token">–ü–æ–ª—É—á–∏—Ç—å OAuth-Token:</h2>
<p><a
href="https://cloud.yandex.ru/ru/docs/iam/operations/iam-token/create">Create
AIM Token</a> –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ IAM-—Ç–æ–∫–µ–Ω–∞ –Ω–µ –±–æ–ª—å—à–µ 12 —á–∞—Å–æ–≤<br />
<code>yandexPassportOauthToken="y0_AgAAAAAGaLFLAATuwQAAAAD3xtRLQE4hvlazQ5euKO43XXXXXXXXXXX"</code>
–¥–ª—è bash<br />
<code>$yandexPassportOauthToken = "y0_AgAAAAAGaLFLAATuwQAAAAD3xtRLQE4hvlazQ5euKO43XXXXXXXXXXX"</code>
–¥–ª—è PowerShell</p>
<h2 id="–æ–±–º–µ–Ω—è—Ç—å-oauth-token-–Ω–∞-iam-token">–û–±–º–µ–Ω—è—Ç—å OAuth-Token –Ω–∞
IAM-Token:</h2>
<p><code>IAM_TOKEN=$(curl -s -d "{\"yandexPassportOauthToken\":\"$yandexPassportOauthToken\"}" "https://iam.api.cloud.yandex.net/iam/v1/tokens" | jq -r .iamToken)</code><br />
<code>$IAM_TOKEN = $(Invoke-RestMethod -Method POST -Uri "https://iam.api.cloud.yandex.net/iam/v1/tokens" -Body $(@{yandexPassportOauthToken = "$yandexPassportOauthToken"} | ConvertTo-Json -Compress)).iamToken</code></p>
<h2 id="–ø–æ–ª—É—á–∏—Ç—å-folder_id">–ü–æ–ª—É—á–∏—Ç—å FOLDER_ID:</h2>
<div class="sourceCode" id="cb196"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="va">CLOUD_ID</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-H</span> <span class="st">&quot;Authorization: Bearer </span><span class="va">$IAM_TOKEN</span><span class="st">&quot;</span> https://resource-manager.api.cloud.yandex.net/resource-manager/v1/clouds <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> .clouds[].id<span class="va">)</span> <span class="co"># –ø–æ–ª—É—á–∏—Ç—å cloud id</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="at">--request</span> GET <span class="at">-H</span> <span class="st">&quot;Authorization: Bearer </span><span class="va">$IAM_TOKEN</span><span class="st">&quot;</span> https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders <span class="at">-d</span> <span class="st">&quot;{</span><span class="dt">\&quot;</span><span class="st">cloudId</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="va">$CLOUD_ID</span><span class="dt">\&quot;</span><span class="st">}&quot;</span> <span class="co"># –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –≤ –æ–±–ª–∞–∫–µ</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="at">--request</span> POST <span class="at">-H</span> <span class="st">&quot;Authorization: Bearer </span><span class="va">$IAM_TOKEN</span><span class="st">&quot;</span> https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders <span class="at">-d</span> <span class="st">&quot;{</span><span class="dt">\&quot;</span><span class="st">cloudId</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="va">$CLOUD_ID</span><span class="dt">\&quot;</span><span class="st">, </span><span class="dt">\&quot;</span><span class="st">name</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="st">test</span><span class="dt">\&quot;</span><span class="st">}&quot;</span> <span class="co"># —Å–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –æ–±–ª–∞–∫–µ</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="va">FOLDER_ID</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">--request</span> GET <span class="at">-H</span> <span class="st">&quot;Authorization: Bearer </span><span class="va">$IAM_TOKEN</span><span class="st">&quot;</span> https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders <span class="at">-d</span> <span class="st">&#39;{&quot;cloudId&quot;: &quot;b1gf9n6heihqj0pt5piu&quot;}&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> <span class="st">&#39;.folders[] | select(.name == &quot;test&quot;) | .id&#39;</span><span class="va">)</span> <span class="co"># –∑–∞–±—Ä–∞—Ç—å id –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏</span></span></code></pre></div>
<div class="sourceCode" id="cb197"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="va">$CLOUD_ID</span> <span class="op">=</span> <span class="op">$(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method Get <span class="op">-</span>Uri <span class="st">&quot;https://resource-manager.api.cloud.yandex.net/resource-manager/v1/clouds&quot;</span> <span class="op">-</span>Headers @<span class="op">{</span><span class="st">&quot;Authorization&quot;</span><span class="op">=</span><span class="st">&quot;Bearer </span><span class="va">$IAM_TOKEN</span><span class="st">&quot;</span><span class="op">;</span> <span class="st">&quot;Content-Type&quot;</span><span class="op">=</span><span class="st">&quot;application/json&quot;</span><span class="op">}).</span><span class="fu">clouds</span><span class="op">.</span><span class="fu">id</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="va">$FOLDER_ID</span> <span class="op">=</span> <span class="op">$(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method Get <span class="op">-</span>Uri <span class="st">&quot;https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders&quot;</span> <span class="op">-</span>Headers @<span class="op">{</span><span class="st">&quot;Authorization&quot;</span><span class="op">=</span><span class="st">&quot;Bearer </span><span class="va">$IAM_TOKEN</span><span class="st">&quot;</span><span class="op">;</span> <span class="st">&quot;Content-Type&quot;</span><span class="op">=</span><span class="st">&quot;application/json&quot;</span><span class="op">}</span> <span class="op">-</span>Body <span class="op">(</span>@<span class="op">{</span><span class="st">&quot;cloudId&quot;</span><span class="op">=</span> <span class="va">$CLOUD_ID</span><span class="op">}</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span><span class="op">)).</span><span class="fu">folders</span> <span class="op">|</span> <span class="fu">Where-Object</span> name <span class="op">-eq</span> test <span class="op">|</span> <span class="fu">Select-Object</span> <span class="op">-</span>ExpandProperty id</span></code></pre></div>
<h3 id="—Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ-–∑–∞–ø—Ä–æ—Å–∞-1">–°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞:</h3>
<div class="sourceCode" id="cb198"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="va">model</span><span class="op">=</span><span class="st">&quot;gpt://</span><span class="va">$FOLDER_ID</span><span class="st">/yandexgpt/latest&quot;</span> <span class="co"># https://cloud.yandex.ru/ru/docs/yandexgpt/concepts/models</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="va">body</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> <span class="op">&lt;&lt;EOF</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="st">{</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;modelUri&quot;: &quot;</span><span class="va">$model</span><span class="st">&quot;,</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;completionOptions&quot;: {</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;stream&quot;: false,</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;temperature&quot;: 0.6,</span></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;maxTokens&quot;: 2000</span></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a><span class="st">  },</span></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;messages&quot;: [</span></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a><span class="st">    {</span></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;role&quot;: &quot;user&quot;,</span></span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;text&quot;: &quot;–ü–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É 22+33&quot;</span></span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a><span class="st">  ]</span></span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a><span class="st">EOF)</span></span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a><span class="st">curl --request POST </span><span class="dt">\</span></span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a><span class="st">  -H &quot;Content-Type: application/json&quot; </span><span class="dt">\</span></span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a><span class="st">  -H &quot;Authorization: Bearer </span><span class="va">$IAM_TOKEN</span><span class="st">&quot; </span><span class="dt">\</span></span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a><span class="st">  -H &quot;x-folder-id: </span><span class="va">$FOLDER_ID</span><span class="st">&quot; </span><span class="dt">\</span></span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a><span class="st">  -d &quot;</span><span class="va">$body</span><span class="st">&quot; </span><span class="dt">\</span></span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;https://llm.api.cloud.yandex.net/foundationModels/v1/completion&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb199"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="va">$model</span> <span class="op">=</span> <span class="st">&quot;gpt://</span><span class="va">$FOLDER_ID</span><span class="st">/yandexgpt/latest&quot;</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="va">$body</span> <span class="op">=</span> <span class="vs">@&quot;</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="vs">{</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="vs">  &quot;modelUri&quot;: &quot;</span><span class="va">$model</span><span class="vs">&quot;,</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="vs">  &quot;completionOptions&quot;: {</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="vs">    &quot;stream&quot;: false,</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="vs">    &quot;temperature&quot;: 0.6,</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="vs">    &quot;maxTokens&quot;: 2000</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a><span class="vs">  },</span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a><span class="vs">  &quot;messages&quot;: [</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a><span class="vs">    {</span></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a><span class="vs">      &quot;role&quot;: &quot;user&quot;,</span></span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a><span class="vs">      &quot;text&quot;: &quot;–ü–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É 22+33&quot;</span></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a><span class="vs">    }</span></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a><span class="vs">  ]</span></span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a><span class="vs">&quot;@</span></span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method POST <span class="op">-</span>Uri <span class="st">&quot;https://llm.api.cloud.yandex.net/foundationModels/v1/completion&quot;</span> <span class="op">-</span>Headers @<span class="op">{</span><span class="st">&quot;Content-Type&quot;</span><span class="op">=</span><span class="st">&quot;application/json&quot;</span><span class="op">;</span> <span class="st">&quot;Authorization&quot;</span><span class="op">=</span><span class="st">&quot;Bearer </span><span class="va">$IAM_TOKEN</span><span class="st">&quot;</span><span class="op">;</span> <span class="st">&quot;x-folder-id&quot;</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$FOLDER_ID</span><span class="st">&quot;</span><span class="op">}</span> <span class="op">-</span>Body <span class="va">$body</span></span></code></pre></div>
<h1 id="superagi">SuperAGI</h1>
<p><a
href="https://github.com/TransformerOptimus/SuperAGI">Source</a><br />
<a href="https://models.superagi.com/playground/generate">Playground
generate</a><br />
<a href="https://documenter.getpostman.com/view/30119783/2s9YR3cFJG">API
Doc (exaples)</a></p>
<div class="sourceCode" id="cb200"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="va">SUPERAGI_API_KEY</span><span class="op">=</span><span class="st">&quot;31f72164129XXXXX&quot;</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="va">prompt</span><span class="op">=</span><span class="st">&quot;–ø–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É 22+33, –¥–∞–π —Ç–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ —Ç–µ–∫—Å—Ç–∞&quot;</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="va">request</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-X</span> POST <span class="st">&#39;https://api.superagi.com/v1/generate/65437cbf227a4018516ad1ce&#39;</span> <span class="dt">\</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>-H <span class="st">&#39;Content-Type: application/json&#39;</span> <span class="dt">\</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>-H <span class="st">&quot;Authorization: Bearer </span><span class="va">$SUPERAGI_API_KEY</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>-d <span class="st">&#39;{</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;prompt&quot;: [&quot;$prompt&quot;],</span></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;max_tokens&quot;: 500,</span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;temperature&quot;: 0.9,</span></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;top_p&quot;: 0.15,</span></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;repetition_penalty&quot;: 0,</span></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;best_of&quot;: 1.05,</span></span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;top_k&quot;: 50,</span></span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;stream&quot;: false</span></span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span><span class="va">)</span></span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$request</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/data: //&quot;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> .choices[].text</span></code></pre></div>
<div class="sourceCode" id="cb201"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="va">$SUPERAGI_API_KEY</span> <span class="op">=</span> <span class="st">&quot;31f72164129XXXXX&quot;</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="va">$prompt</span> <span class="op">=</span> <span class="st">&quot;–ø–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É 22+33, –¥–∞–π —Ç–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ —Ç–µ–∫—Å—Ç–∞&quot;</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="va">$request</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Method Post <span class="op">-</span>Uri <span class="st">&#39;https://api.superagi.com/v1/generate/65437cbf227a4018516ad1ce&#39;</span> <span class="op">-</span>Headers @<span class="op">{</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Content-Type&#39;</span> <span class="op">=</span> <span class="st">&#39;application/json&#39;</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Authorization&#39;</span> <span class="op">=</span> <span class="st">&quot;Bearer </span><span class="va">$SUPERAGI_API_KEY</span><span class="st">&quot;</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="op">-</span>Body <span class="op">(</span>@<span class="op">{</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>    prompt <span class="op">=</span> <span class="op">@(</span><span class="va">$prompt</span><span class="op">)</span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>    max_tokens <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>    temperature <span class="op">=</span> <span class="dv">0.9</span></span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>    top_p <span class="op">=</span> <span class="dv">0.15</span></span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>    repetition_penalty <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a>    best_of <span class="op">=</span> <span class="dv">1.05</span></span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a>    top_k <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true" tabindex="-1"></a>    stream <span class="op">=</span> <span class="va">$false</span></span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span><span class="op">)</span></span>
<span id="cb201-16"><a href="#cb201-16" aria-hidden="true" tabindex="-1"></a><span class="op">$(</span><span class="va">$request</span> <span class="op">-replace</span> <span class="st">&quot;^data: &quot;</span> <span class="op">|</span> <span class="fu">ConvertFrom-Json</span><span class="op">).</span><span class="fu">choices</span><span class="op">.</span><span class="fu">text</span></span></code></pre></div>
<h1 id="replicate">Replicate</h1>
<p><a
href="https://replicate.com/stability-ai/stable-diffusion/examples?input=http">API
curl examples</a></p>
<div class="sourceCode" id="cb202"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="va">REPLICATE_API_TOKEN</span><span class="op">=</span><span class="st">&quot;r8_STyeUNXiGonkLfxE1FSKaqll26lXXXXXXXXXX&quot;</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="va">prompt</span><span class="op">=</span><span class="st">&quot;–ñ–∏—Ä–∞—Ñ –≤ –ø–æ–ª–æ—Å–∫—É –∑–µ–±—Ä—ã&quot;</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="va">request</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-X</span> POST <span class="dt">\</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Authorization: Token </span><span class="va">$REPLICATE_API_TOKEN</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">-d</span> <span class="st">$&#39;{</span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;version&quot;: &quot;ac732df83cea7fff18b8472768c88ad041fa750ff7682a21affe81863cbe77e4&quot;,</span></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;input&quot;: {</span></span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;prompt&quot;: &quot;$prompt&quot;</span></span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a><span class="st">  }&#39;</span> <span class="dt">\</span></span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a>  https://api.replicate.com/v1/predictions<span class="va">)</span></span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a><span class="va">request_url</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$request</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> .urls.get<span class="va">)</span></span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a><span class="va">response_status</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-H</span> <span class="st">&quot;Authorization: Token </span><span class="va">$REPLICATE_API_TOKEN</span><span class="st">&quot;</span> <span class="va">$request_url</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> .status<span class="va">)</span></span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="kw">[[</span> <span class="va">$response_status</span> <span class="ot">!=</span> succeeded <span class="kw">]];</span> <span class="cf">do</span></span>
<span id="cb202-16"><a href="#cb202-16" aria-hidden="true" tabindex="-1"></a>    <span class="va">response_status</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-H</span> <span class="st">&quot;Authorization: Token </span><span class="va">$REPLICATE_API_TOKEN</span><span class="st">&quot;</span> <span class="va">$request_url</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> .status<span class="va">)</span></span>
<span id="cb202-17"><a href="#cb202-17" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb202-18"><a href="#cb202-18" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-H</span> <span class="st">&quot;Authorization: Token </span><span class="va">$REPLICATE_API_TOKEN</span><span class="st">&quot;</span> <span class="va">$request_url</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> .output[]</span></code></pre></div>
<div class="sourceCode" id="cb203"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="va">$REPLICATE_API_TOKEN</span> <span class="op">=</span> <span class="st">&quot;r8_STyeUNXiGonkLfxE1FSKaqll26lXXXXXXXXXX&quot;</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="va">$prompt</span> <span class="op">=</span> <span class="st">&quot;–ñ–∏—Ä–∞—Ñ –≤ –ø–æ–ª–æ—Å–∫—É –∑–µ–±—Ä—ã&quot;</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="va">$body</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>   version <span class="op">=</span> <span class="st">&quot;ac732df83cea7fff18b8472768c88ad041fa750ff7682a21affe81863cbe77e4&quot;</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>   input <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>       prompt <span class="op">=</span> <span class="va">$prompt</span></span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>   <span class="op">}</span></span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span></span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>   <span class="st">&quot;Authorization&quot;</span> <span class="op">=</span> <span class="st">&quot;Token </span><span class="va">$REPLICATE_API_TOKEN</span><span class="st">&quot;</span></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>   <span class="st">&quot;Content-Type&quot;</span> <span class="op">=</span> <span class="st">&quot;application/json&quot;</span></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a><span class="va">$request</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="st">&quot;https://api.replicate.com/v1/predictions&quot;</span> <span class="op">-</span>Method POST <span class="op">-</span>Body <span class="va">$body</span> <span class="op">-</span>Headers <span class="va">$headers</span></span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="op">$(</span><span class="va">$request</span><span class="op">.</span><span class="fu">urls</span><span class="op">.</span><span class="fu">get</span><span class="op">)</span> <span class="op">-</span>Headers @<span class="op">{</span><span class="st">&quot;Authorization&quot;</span> <span class="op">=</span> <span class="st">&quot;Token </span><span class="va">$REPLICATE_API_TOKEN</span><span class="st">&quot;</span><span class="op">}</span></span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span><span class="va">$response</span><span class="op">.</span><span class="fu">status</span> <span class="op">-ne</span> <span class="st">&quot;succeeded&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a>    <span class="va">$response</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="op">$(</span><span class="va">$request</span><span class="op">.</span><span class="fu">urls</span><span class="op">.</span><span class="fu">get</span><span class="op">)</span> <span class="op">-</span>Headers @<span class="op">{</span><span class="st">&quot;Authorization&quot;</span> <span class="op">=</span> <span class="st">&quot;Token </span><span class="va">$REPLICATE_API_TOKEN</span><span class="st">&quot;</span><span class="op">}</span></span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span><span class="op">.</span><span class="fu">output</span></span></code></pre></div>
<h1 id="google-filter">Google-Filter</h1>
<p><code>https://www.google.com/search?q=the+rookie+2018+imdb</code>
—Ñ–æ—Ä–º–∞—Ç url-–∑–∞–ø—Ä–æ—Å–∞ –ø–æ–∏—Å–∫–∞ —Å –ø—Ä–æ–±–µ–ª–∞–º–∏<br />
<code>https://www.google.com/search?q=the+rookie+2018+site:imdb.com</code>
–ø–æ–∏—Å–∫ –ø–æ —Å–∞–π—Ç—É<br />
<code>https://www.google.com/search?q=the+rookie+intitle:index.of+"last modified"+(mkv|avi)</code>
–∏—Å–∫–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö —É–∫–∞–∑–∞–Ω–æ ‚Äúlast modified‚Äù (–ø–æ—Å–ª–µ–¥–Ω–∏–µ
–∏–∑–º–µ–Ω–µ–Ω–∏—è), –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —á–µ—Ä–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ–∏—Å–∫–∞ (–≤—Å–µ
–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ –¥–æ–ª–∂–Ω—ã –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ) —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–æ
‚Äúindex.of‚Äù (—É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–µ, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç
—Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤) –∏ –∏—Å–∫–∞—Ç—å —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏ .mkv –∏–ª–∏ (|) .avi<br />
<code>https://www.google.com/search?q=the+rookie+2018+filetype:torrent</code><br />
<code>–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è gopro hero 11 filetype:pdf</code> –∏—Å–∫–∞—Ç—å —Å—Ä–∞–∑—É –¥–æ–∫—É–º–µ–Ω—Ç
(–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ .pdf –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞)<br />
<code>"–¥–µ–π—Å—Ç–≤–∏—è/–≥–ª–∞–≥–æ–ª—ã, —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–º–∞–Ω–¥–ª–µ—Ç–∞—Ö"</code>
–∏—Å–∫–∞—Ç—å –ø–æ —Ñ—Ä–∞–∑–µ —Ü–µ–ª–∏–∫–æ–º, –±–µ–∑ —Ä–∞–∑–±–∏–µ–Ω–∏—è –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞<br />
<code>"—è–≥—É–∞—Ä —Å–∫–æ—Ä–æ—Å—Ç—å -–∂–∏–≤–æ—Ç–Ω–æ–µ -xe -xj"</code> —É–∑–Ω–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –Ø–≥—É–∞—Ä–∞,
–∏—Å–∫–ª—é—á–∞–µ–º –∂–∏–≤–æ—Ç–Ω–æ–µ –∏ –º–æ–¥–µ–ª–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è<br />
<code>"intitle:–ª—É—á—à–∏–µ —Ñ–∏–ª—å–º—ã 2023"</code> –∑–∞–ø—Ä–æ—Å –∏—â–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã,
–∑–∞–≥–æ–ª–æ–≤–∫–∏ (title HTML –¥–æ–∫—É–º–µ–Ω—Ç–∞) –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–ª–æ–≤–∞ ‚Äú–ª—É—á—à–∏–µ‚Äù,
‚Äú—Ñ–∏–ª—å–º—ã‚Äù –∏ ‚Äú2023‚Äù (–≤—Å–µ —Å–ª–æ–≤–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ)<br />
<code>"allintitle:–ª—É—á—à–∏–µ —Ñ–∏–ª—å–º—ã 2023"</code> –∑–∞–ø—Ä–æ—Å –∏—â–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã,
–∑–∞–≥–æ–ª–æ–≤–∫–∏ (title HTML –¥–æ–∫—É–º–µ–Ω—Ç–∞) –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–ª–æ–≤–∞ ‚Äú–ª—É—á—à–∏–µ‚Äù,
‚Äú—Ñ–∏–ª—å–º—ã‚Äù –∏–ª–∏ ‚Äú2023‚Äù (–æ–¥–Ω–æ –∏–∑)<br />
<code>"intext:telegram –±–æ—Ç powershell"</code> –ø–æ–∏—Å–∫ —Å—Ç—Ä–∞–Ω–∏—Ü, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö
—É–∫–∞–∑–∞–Ω–Ω–æ–µ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –≤ —Ç–µ–∫—Å—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤
–∑–∞–≥–æ–ª–æ–≤–∫–µ)<br />
<code>"inurl:lifailon"</code> –ø–æ–∏—Å–∫ —Å—Ç—Ä–∞–Ω–∏—Ü, –≤ URL –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è
—É–∫–∞–∑–∞–Ω–Ω–æ–µ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ<br />
<code>intitle:index.of "game of thrones" mkv daterange:2010..2015</code>
—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –≤
—Ñ–æ—Ä–º–∞—Ç–µ YYYYMMDD..YYYYMMDD<br />
<code>intitle:index.of "game of thrones" mkv after:2015</code>
–æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤, –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö –¥–æ (before) –∏–ª–∏ –ø–æ—Å–ª–µ
(after) —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∞—Ç—ã<br />
<code>intitle:index.of "game of thrones" mkv from:2010 to:2015</code>
—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –¥–∞—Ç</p>
<h1 id="google-api">Google-API</h1>
<h3 id="google-translate">Google-Translate</h3>
<div class="sourceCode" id="cb204"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="va">$Key</span> <span class="op">=</span> <span class="st">&quot;&lt;TOKEN_API&gt;&quot;</span> <span class="co"># –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω: https://console.cloud.google.com/apis/credentials</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Text</span> <span class="op">=</span> <span class="st">&quot;You can see in the right corner how long each translation request takes (this does not depend on the amount of text being transferred).&quot;</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="va">$LanguageTarget</span> <span class="op">=</span> <span class="st">&quot;RU&quot;</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="va">$LanguageSource</span> <span class="op">=</span> <span class="st">&quot;EN&quot;</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="va">$url</span> <span class="op">=</span> <span class="st">&quot;https://translation.googleapis.com/language/translate/v2?key=</span><span class="va">$key</span><span class="st">&quot;</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a><span class="va">$Header</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Content-Type&quot;</span> <span class="op">=</span> <span class="st">&quot;application/json&quot;</span></span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="va">$Body</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;q&quot;</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$Text</span><span class="st">&quot;</span></span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;target&quot;</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$LanguageTarget</span><span class="st">&quot;</span></span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;source&quot;</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$LanguageSource</span><span class="st">&quot;</span></span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span></span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a><span class="va">$WebClient</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">WebClient</span></span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$key</span> <span class="kw">in</span> <span class="va">$Header</span><span class="op">.</span><span class="fu">Keys</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a>    <span class="va">$WebClient</span><span class="op">.</span><span class="fu">Headers</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="va">$key</span><span class="op">,</span> <span class="va">$Header</span><span class="op">[</span><span class="va">$key</span><span class="op">])</span></span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a><span class="va">$Response</span> <span class="op">=</span> <span class="va">$WebClient</span><span class="op">.</span><span class="fu">UploadString</span><span class="op">(</span><span class="va">$url</span><span class="op">,</span> <span class="st">&quot;POST&quot;</span><span class="op">,</span> <span class="va">$Body</span><span class="op">)</span> <span class="op">|</span> <span class="fu">ConvertFrom-Json</span></span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a><span class="va">$Response</span><span class="op">.</span><span class="fu">data</span><span class="op">.</span><span class="fu">translations</span><span class="op">.</span><span class="fu">translatedText</span></span></code></pre></div>
<h3 id="google-search">Google-Search</h3>
<div class="sourceCode" id="cb205"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="va">$Key</span> <span class="op">=</span> <span class="st">&quot;&lt;TOKEN_API&gt;&quot;</span> <span class="co"># –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω: https://developers.google.com/custom-search/v1/overview?hl=ru (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø–æ–∏—Å–∫ JSON API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç 100 –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ)</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="va">$cx</span> <span class="op">=</span> <span class="st">&quot;35c78340f49eb474a&quot;</span> <span class="co"># —Å–æ–∑–¥–∞—Ç—å –ø–æ–∏—Å–∫–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É https://programmablesearchengine.google.com/controlpanel/all</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Query</span> <span class="op">=</span> <span class="st">&quot;–∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ discord&quot;</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="va">$Lang</span> <span class="op">=</span> <span class="st">&quot;ru&quot;</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="va">$Num</span> <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a><span class="va">$Start</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="st">&quot;https://www.googleapis.com/customsearch/v1?q=</span><span class="va">$Query</span><span class="st">&amp;key=</span><span class="va">$Key</span><span class="st">&amp;cx=</span><span class="va">$cx</span><span class="st">&amp;lr=lang_</span><span class="va">$Lang</span><span class="st">&amp;num=</span><span class="va">$Num</span><span class="st">&amp;</span><span class="va">$start</span><span class="st">=</span><span class="va">$Start</span><span class="st">&quot;</span></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span><span class="op">.</span><span class="fu">items</span> <span class="op">|</span> <span class="fu">Select-Object</span> title<span class="op">,</span>snippet<span class="op">,</span>displayLink<span class="op">,</span>link <span class="op">|</span> <span class="fu">Format-List</span></span></code></pre></div>
<h1 id="rapidapi">RapidAPI</h1>
<p><a
href="https://rapidapi.com/ru/neoscrap-net/api/google-search72">Google-Search72</a></p>
<div class="sourceCode" id="cb206"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="va">$Key</span> <span class="op">=</span> <span class="st">&quot;&lt;TOKEN_API&gt;&quot;</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span><span class="op">=</span>@<span class="op">{}</span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="st">&quot;X-RapidAPI-Key&quot;</span><span class="op">,</span> <span class="st">&quot;</span><span class="va">$Key</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="st">&quot;X-RapidAPI-Host&quot;</span><span class="op">,</span> <span class="st">&quot;google-search72.p.rapidapi.com&quot;</span><span class="op">)</span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="va">$query</span> <span class="op">=</span> <span class="st">&quot;–∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ discord&quot;</span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="st">&quot;https://google-search72.p.rapidapi.com/search?q=</span><span class="va">$query</span><span class="st">%20gitgub&amp;gl=us&amp;lr=lang_ru&amp;num=20&amp;start=0&quot;</span> <span class="op">-</span>Method GET <span class="op">-</span>Headers <span class="va">$headers</span></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span><span class="op">.</span><span class="fu">items</span> <span class="op">|</span> <span class="fu">Select-Object</span> title<span class="op">,</span>snippet<span class="op">,</span>displayLink<span class="op">,</span>link <span class="op">|</span> <span class="fu">Format-List</span></span></code></pre></div>
<h3 id="imdb">IMDb</h3>
<p><a href="https://rapidapi.com/apidojo/api/imdb8">IMDb8</a></p>
<div class="sourceCode" id="cb207"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="va">$key</span> <span class="op">=</span> <span class="st">&quot;&lt;TOKEN_API&gt;&quot;</span> <span class="co"># 500 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–µ—Å—è—Ü</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="va">$query</span><span class="op">=</span><span class="st">&quot;Break&quot;</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span><span class="op">=</span>@<span class="op">{}</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="st">&quot;X-RapidAPI-Key&quot;</span><span class="op">,</span> <span class="st">&quot;</span><span class="va">$key</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="st">&quot;X-RapidAPI-Host&quot;</span><span class="op">,</span> <span class="st">&quot;imdb8.p.rapidapi.com&quot;</span><span class="op">)</span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="st">&quot;https://imdb8.p.rapidapi.com/title/find?q=</span><span class="va">$query</span><span class="st">&quot;</span> <span class="op">-</span>Method GET <span class="op">-</span>Headers <span class="va">$headers</span></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span><span class="op">.</span><span class="fu">results</span> <span class="op">|</span> <span class="fu">select</span> title<span class="op">,</span>titletype<span class="op">,</span>year<span class="op">,</span>runningTimeInMinutes<span class="op">,</span>id <span class="op">|</span> <span class="fu">Format-Table</span></span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;https://www.imdb.com</span><span class="op">$(</span><span class="va">$response</span><span class="op">.</span><span class="fu">results</span><span class="op">.</span><span class="fu">id</span><span class="op">[</span><span class="dv">0</span><span class="op">])</span><span class="st">&quot;</span></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span><span class="op">.</span><span class="fu">results</span><span class="op">.</span><span class="fu">principals</span> <span class="co"># –∞–∫—Ç–µ—Ä—ã</span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span><span class="op">.</span><span class="fu">results</span><span class="op">.</span><span class="fu">image</span></span></code></pre></div>
<h3 id="moviesdatabase">MoviesDatabase</h3>
<p><a
href="https://rapidapi.com/SAdrian/api/moviesdatabase">MoviesDatabase</a></p>
<div class="sourceCode" id="cb208"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="va">$key</span> <span class="op">=</span> <span class="st">&quot;&lt;TOKEN_API&gt;&quot;</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="va">$imdb_id</span> <span class="op">=</span> <span class="st">&quot;tt0455275&quot;</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span><span class="op">=</span>@<span class="op">{}</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="st">&quot;X-RapidAPI-Key&quot;</span><span class="op">,</span> <span class="st">&quot;</span><span class="va">$key</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span><span class="op">.</span><span class="fu">Add</span><span class="op">(</span><span class="st">&quot;X-RapidAPI-Host&quot;</span><span class="op">,</span> <span class="st">&quot;moviesdatabase.p.rapidapi.com&quot;</span><span class="op">)</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="st">&quot;https://moviesdatabase.p.rapidapi.com/titles/</span><span class="va">$imdb_id</span><span class="st">&quot;</span> <span class="op">-</span>Method GET <span class="op">-</span>Headers <span class="va">$headers</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span><span class="op">.</span><span class="fu">results</span></span></code></pre></div>
<h1 id="tmdb">TMDB</h1>
<p><a
href="https://developer.themoviedb.org/reference/intro/getting-started">Developer
TMDB</a></p>
<div class="sourceCode" id="cb209"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="va">$TOKEN</span> <span class="op">=</span> <span class="st">&quot;548e444e7812575caa0a7eXXXXXXXXXX&quot;</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="va">$Endpoint</span> <span class="op">=</span> <span class="st">&quot;search/tv&quot;</span> <span class="co"># –ø–æ–∏—Å–∫ —Å–µ—Ä–∏–∞–ª–∞ (tv) –∏ —Ñ–∏–ª—å–º–∞ (movie) –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="va">$Query</span> <span class="op">=</span> <span class="st">&quot;–∑–∏–º–æ—Ä–æ–¥–æ–∫&quot;</span></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="va">$url</span> <span class="op">=</span> <span class="op">$(</span><span class="st">&quot;https://api.themoviedb.org/3/</span><span class="va">$Endpoint</span><span class="st">&quot;</span><span class="op">+</span><span class="st">&quot;?api_key=</span><span class="va">$TOKEN</span><span class="st">&amp;query=</span><span class="va">$Query</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="op">$(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="va">$url</span> <span class="op">-</span>Method Get<span class="op">).</span><span class="fu">results</span></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="va">$id</span> <span class="op">=</span> <span class="op">$(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="va">$url</span> <span class="op">-</span>Method Get<span class="op">).</span><span class="fu">results</span><span class="op">.</span><span class="fu">id</span> <span class="co"># –∑–∞–±—Ä–∞—Ç—å id —Å–µ—Ä–∏–∞–ª–∞ (210865) https://www.themoviedb.org/tv/210865</span></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a><span class="va">$Endpoint</span> <span class="op">=</span> <span class="st">&quot;tv/</span><span class="va">$id</span><span class="st">&quot;</span> <span class="co"># –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä–∏–∞–ª–µ –ø–æ –µ–≥–æ ID</span></span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a><span class="va">$url</span> <span class="op">=</span> <span class="op">$(</span><span class="st">&quot;https://api.themoviedb.org/3/</span><span class="va">$Endpoint</span><span class="st">&quot;</span><span class="op">+</span><span class="st">&quot;?api_key=</span><span class="va">$TOKEN</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a><span class="op">$(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="va">$url</span> <span class="op">-</span>Method Get<span class="op">)</span> <span class="co"># —Å–ø–∏—Å–æ–∫ —Å–µ–∑–æ–Ω–æ–≤ (.seasons), –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–∏–∑–æ–¥–æ–≤ (.seasons.episode_count)</span></span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="st">&quot;https://api.themoviedb.org/3/tv/</span><span class="va">$id</span><span class="st">/season/2?api_key=</span><span class="va">$Token</span><span class="st">&quot;</span> <span class="op">-</span>Method Get<span class="op">).</span><span class="fu">episodes</span> <span class="co"># –≤—ã–≤–µ—Å—Ç–∏ 2 —Å–µ–∑–æ–Ω</span></span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="st">&quot;https://api.themoviedb.org/3/tv/</span><span class="va">$id</span><span class="st">/season/2/episode/8?api_key=</span><span class="va">$Token</span><span class="st">&quot;</span> <span class="op">-</span>Method Get <span class="co"># –≤—ã–≤–µ—Å—Ç–∏ 8 —ç–ø–∏–∑–æ–¥</span></span></code></pre></div>
<h1 id="omdb">OMDb</h1>
<p>–ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–∞ –ø–æ <a
href="https://www.omdbapi.com">email</a></p>
<p><code>$API_KEY = "XXXXXXXX"</code><br />
<code>$IMDb_ID = "tt7587890"</code><br />
<code>curl -s "https://omdbapi.com/?apikey=$($API_KEY)&amp;i=$($IMDb_ID)" | jq .</code><br />
<code>curl -s "https://omdbapi.com/?apikey=$($API_KEY)&amp;i=$($IMDb_ID)" | ConvertFrom-Json</code><br />
<code>Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&amp;s=The Rookie"</code><br />
<code>Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&amp;t=The Rookie"</code>
–ø–æ–∏—Å–∫ –ø–æ Title<br />
<code>Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&amp;t=The Rookie&amp;y=1990"</code>
–ø–æ–∏—Å–∫ –ø–æ Title –∏ –≥–æ–¥—É –≤—ã—Ö–æ–¥–∞<br />
<code>Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&amp;t=The Rookie&amp;type=movie"</code>
–ø–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ —Ñ–∏–ª—å–º–∞ (movie) –∏–ª–∏ —Å–µ—Ä–∏–∞–ª–∞ (series)<br />
<code>$(Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&amp;s=The Rookie").Search</code>
–ø–æ–∏—Å–∫ –≤—Å–µ—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π (—Ñ–∏–ª—å–º—ã –∏ —Å–µ—Ä–∏–∞–ª—ã)</p>
<h1 id="ivi">ivi</h1>
<p><a
href="https://ask.ivi.ru/knowledge-bases/10/articles/51697-dokumentatsiya-dlya-api-ivi">ivi
api doc</a></p>
<p><code>Invoke-RestMethod https://api.ivi.ru/mobileapi/categories</code>
—Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –∂–∞–Ω—Ä–æ–≤ (genres/meta_genres)<br />
<code>Invoke-RestMethod https://api.ivi.ru/mobileapi/collections</code>
–ø–æ–¥–±–æ—Ä–∫–∏</p>
<p><code>(Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.seasons.number</code>
–∫–æ–ª-–≤–æ —Å–µ–∑–æ–Ω–æ–≤<br />
<code>(Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.seasons[1].episode_count</code>
–∫–æ–ª-–≤–æ —Å–µ—Ä–∏–π –≤–æ –≤—Ç–æ—Ä–æ–º —Å–µ–∑–æ–Ω–µ<br />
<code>(Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.seasons[1].ivi_release_info.date_interval_min</code>
–¥–∞—Ç–∞ –≤—ã—Ö–æ–¥–∞ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ—Ä–∏–∏<br />
<code>(Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.kp_rating</code>
—Ä–µ–π—Ç–∏–Ω–≥ –≤ –ö–∏–Ω–æ–ø–æ–∏—Å–∫ (8.04)</p>
<p><code>$id = (Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.kp_id</code>
–ø–æ–ª—É—á–∏—Ç—å id –≤ –ö–∏–Ω–æ–ø–æ–∏—Å–∫ (5106881)<br />
<code>id=$(curl -s https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok | jq .result[].kp_id)</code>
–ø–æ–ª—É—á–∏—Ç—å id –≤ –ö–∏–Ω–æ–ø–æ–∏—Å–∫</p>
<h1 id="kinopoisk">Kinopoisk</h1>
<div class="sourceCode" id="cb210"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>5106881</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="va">get</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> https://www.kinopoisk.ru/film/<span class="va">$id</span>/episodes/<span class="va">)</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="bu">printf</span> <span class="st">&quot;%s\n&quot;</span> <span class="st">&quot;</span><span class="va">${get</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-A</span> 1 <span class="st">&quot;–°–µ–∑–æ–Ω 2&quot;</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&quot;—ç–ø–∏–∑–æ–¥–æ–≤&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-r</span> <span class="st">&quot;s/^.+\: //&quot;</span> <span class="co"># –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–∏–∑–¥–æ–≤–æ–¥ –≤–æ –≤—Ç–æ—Ä–æ–º —Å–µ–∑–æ–Ω–µ</span></span></code></pre></div>
<h3 id="kinopoisk.dev">kinopoisk.dev</h3>
<p><a href="https://t.me/kinopoiskdev_bot">–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω</a><br />
<a href="https://kinopoisk.dev/documentation">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ API –≤
—Ñ–æ—Ä–º–∞—Ç–µ OpenAPI</a></p>
<p><code>GET /v1.4/movie/{id}</code> –ø–æ–∏—Å–∫ –ø–æ id</p>
<div class="sourceCode" id="cb211"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="va">$id</span> <span class="op">=</span> <span class="dv">5106881</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="va">$API_KEY</span> <span class="op">=</span> <span class="st">&quot;ZYMNJJA-0J8MNPN-PB4N7R7-XXXXXXX&quot;</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="va">$Header</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;accept&quot;</span> <span class="op">=</span> <span class="st">&quot;application/json&quot;</span></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;X-API-KEY&quot;</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$API_KEY</span><span class="st">&quot;</span></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a><span class="va">$irm</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="st">&quot;https://api.kinopoisk.dev/v1.4/movie/</span><span class="va">$id</span><span class="st">&quot;</span> <span class="op">-</span>Method GET <span class="op">-</span>Headers <span class="va">$Header</span></span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a><span class="va">$irm</span><span class="op">.</span><span class="fu">rating</span><span class="op">.</span><span class="fu">kp</span> <span class="co"># —Ä–µ–π—Ç–∏–Ω–≥ –≤ –ö–∏–Ω–æ–ø–æ–∏—Å–∫ (8,079)</span></span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a><span class="va">$irm</span><span class="op">.</span><span class="fu">seasonsInfo</span> <span class="co"># –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–∑–æ–Ω–æ–≤ –∏ —ç–ø–∏–∑–æ–¥–æ–≤ –≤ –Ω–∏—Ö</span></span></code></pre></div>
<div class="sourceCode" id="cb212"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="va">id</span><span class="op">=</span>5106881</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="va">API_KEY</span><span class="op">=</span><span class="st">&quot;ZYMNJJA-0J8MNPN-PB4N7R7-XXXXXXX&quot;</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="va">get</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-X</span> GET <span class="dt">\</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;https://api.kinopoisk.dev/v1.4/movie/</span><span class="va">$id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;accept: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;X-API-KEY: </span><span class="va">$API_KEY</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$get</span> <span class="kw">|</span> <span class="ex">jq</span> .rating.kp <span class="co"># —Ä–µ–π—Ç–∏–Ω–≥ –≤ –ö–∏–Ω–æ–ø–æ–∏—Å–∫ (8,079)</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$get</span> <span class="kw">|</span> <span class="ex">jq</span> .seasonsInfo<span class="pp">[</span><span class="ss">1</span><span class="pp">]</span>.episodesCount <span class="co"># –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–∏–∑–æ–¥–æ–≤ –≤–æ –≤—Ç–æ—Ä–æ–º [1] —Å–µ–∑–æ–Ω–µ (6)</span></span></code></pre></div>
<p><code>GET /v1.4/movie/search</code></p>
<div class="sourceCode" id="cb213"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="va">query</span><span class="op">=</span><span class="st">&quot;zimorodok&quot;</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="va">page</span><span class="op">=</span>1 <span class="co"># –∫–æ–ª-–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –≤—ã–±–æ—Ä–∫–∏</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="va">limit</span><span class="op">=</span>1 <span class="co"># –∫–æ–ª-–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-X</span> GET <span class="dt">\</span></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;https://api.kinopoisk.dev/v1.4/movie/search?page=</span><span class="va">$page</span><span class="st">&amp;limit=</span><span class="va">$limit</span><span class="st">&amp;query=</span><span class="va">$query</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;accept: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;X-API-KEY: </span><span class="va">$API_KEY</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="ex">jq</span> .</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a><span class="va">limit</span><span class="op">=</span>5</span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a><span class="va">request</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-X</span> GET <span class="dt">\</span></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;https://api.kinopoisk.dev/v1.4/movie/search?page=</span><span class="va">$page</span><span class="st">&amp;limit=</span><span class="va">$limit</span><span class="st">&amp;query=%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA&quot;</span> <span class="dt">\</span></span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;accept: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;X-API-KEY: </span><span class="va">$API_KEY</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="ex">jq</span> .<span class="va">)</span></span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$request</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.docs[] | select(.year == 2022)&#39;</span> <span class="co"># –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ –≥–æ–¥—É –≤—ã—Ö–æ–¥–∞</span></span></code></pre></div>
<div class="sourceCode" id="cb214"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="va">$API_KEY</span> <span class="op">=</span> <span class="st">&quot;ZYMNJJA-0J8MNPN-PB4N7R7-XXXXXXX&quot;</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="va">$page</span> <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="va">$limit</span> <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a><span class="va">$query</span> <span class="op">=</span> <span class="st">&quot;%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA&quot;</span></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a><span class="va">$request</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="st">&quot;https://api.kinopoisk.dev/v1.4/movie/search?page=</span><span class="va">$page</span><span class="st">&amp;limit=</span><span class="va">$limit</span><span class="st">&amp;query=</span><span class="va">$query</span><span class="st">&quot;</span> <span class="op">-</span>Headers @<span class="op">{</span><span class="st">&quot;accept&quot;</span><span class="op">=</span><span class="st">&quot;application/json&quot;</span><span class="op">;</span> <span class="st">&quot;X-API-KEY&quot;</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$API_KEY</span><span class="st">&quot;</span><span class="op">}</span></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a><span class="va">$request</span><span class="op">.</span><span class="fu">docs</span> <span class="op">|</span> <span class="fu">Where-Object</span> year <span class="op">-eq</span> <span class="dv">2022</span></span></code></pre></div>
<h3 id="urlcode">UrlCode</h3>
<div class="sourceCode" id="cb215"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get-PercentEncode <span class="op">(</span><span class="va">$str</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>   <span class="va">$bytes</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Text</span><span class="op">.</span><span class="fu">Encoding</span><span class="op">]::</span>UTF8<span class="op">.</span><span class="fu">GetBytes</span><span class="op">(</span><span class="va">$str</span><span class="op">)</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>   <span class="op">(</span><span class="va">$bytes</span> <span class="op">|</span> <span class="fu">ForEach-Object</span> <span class="op">{</span> <span class="st">&quot;{0:X2}&quot;</span> <span class="op">-</span>f <span class="va">$_</span> <span class="op">})</span> <span class="op">-join</span> <span class="st">&#39;%&#39;</span> <span class="op">-replace</span> <span class="st">&quot;^&quot;</span><span class="op">,</span><span class="st">&quot;%&quot;</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>Get-PercentEncode <span class="st">&quot;–∑–∏–º–æ—Ä–æ–¥–æ–∫&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb216"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get-UrlEncode<span class="op">(</span><span class="va">$str</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>   <span class="op">[</span>System<span class="op">.</span><span class="fu">Web</span><span class="op">.</span><span class="fu">HttpUtility</span><span class="op">]::</span>UrlEncode<span class="op">(</span><span class="va">$str</span><span class="op">)</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>UrlEncode <span class="st">&quot;–∑–∏–º–æ—Ä–æ–¥–æ–∫&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb217"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">percent-encode()</span> <span class="kw">{</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">str</span><span class="op">=</span><span class="va">$1</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="at">-n</span> <span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">iconv</span> <span class="at">-t</span> utf8 <span class="kw">|</span> <span class="fu">od</span> <span class="at">-An</span> <span class="at">-tx1</span> <span class="kw">|</span> <span class="fu">tr</span> <span class="st">&#39; &#39;</span> % <span class="kw">|</span> <span class="fu">tr</span> <span class="at">-d</span> <span class="st">&#39;\n&#39;</span></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="ex">percent-encode</span> <span class="st">&quot;–∑–∏–º–æ—Ä–æ–¥–æ–∫&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb218"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get-UrlDecode<span class="op">(</span><span class="va">$encoded</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>System<span class="op">.</span><span class="fu">Uri</span><span class="op">]::</span>UnescapeDataString<span class="op">(</span><span class="va">$encoded</span><span class="op">)</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>Get-UrlDecode <span class="st">&quot;%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb219"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">percent-decode()</span> <span class="kw">{</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">encoded</span><span class="op">=</span><span class="va">$1</span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">url_encoded</span><span class="op">=</span><span class="st">&quot;</span><span class="va">${1</span><span class="op">//</span><span class="ss">+</span><span class="op">/</span> <span class="va">}</span><span class="st">&quot;</span></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">printf</span> <span class="st">&#39;%b&#39;</span> <span class="st">&quot;</span><span class="va">${url_encoded</span><span class="op">//</span><span class="ss">%</span><span class="op">/</span><span class="dt">\\</span>x<span class="va">}</span><span class="st">&quot;</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a><span class="ex">percent-decode</span> <span class="st">&quot;%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA&quot;</span></span></code></pre></div>
<h3 id="kinopoiskapiunofficial">KinopoiskApiUnofficial</h3>
<p>–ë–µ—Å–ø–ª–∞—Ç–Ω–æ 500 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å—É—Ç–∫–∏. <a
href="https://kinopoiskapiunofficial.tech/documentation/api">Swagger
documentation</a></p>
<div class="sourceCode" id="cb220"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>API_KEY<span class="op">=</span><span class="st">&quot;828ec96a-f45d-4e3d-84b1-XXXXXXXXXXXX&quot;</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="va">$headers</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;accept&quot;</span> <span class="op">=</span> <span class="st">&quot;application/json&quot;</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;X-API-KEY&quot;</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$API_KEY</span><span class="st">&quot;</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="st">&#39;https://kinopoiskapiunofficial.tech/api/v2.2/films/1142153&#39;</span> <span class="op">-</span>Headers <span class="va">$headers</span></span></code></pre></div>
<p><code>curl -s "https://kinopoiskapiunofficial.tech/api/v2.2/films/1142153" -H "accept: application/json" -H "X-API-KEY: $API_KEY" | jq .</code></p>
<h3 id="kinobox">Kinobox</h3>
<p><code>$url = "https://www.kinopoisk.ru/film/694051"</code><br />
<code>$kp_id = $url -replace ".+/"</code><br />
<code>https://kinomix.web.app/#694051</code><br />
<code>curl -s -X GET "https://kinobox.tv/api/players/main?kinopoisk=$kp_id" -H "accept: application/json"</code>
–ø–æ–∏—Å–∫ –ø–æ id –ö–∏–Ω–æ–ø–æ–∏—Å–∫<br />
<code>curl -s -X GET "https://kinobox.tv/api/players/main?imdb=tt2293640" -H "accept: application/json"</code>
–ø–æ–∏—Å–∫ –ø–æ id IMDb<br />
<code>curl -s -X GET "https://kinobox.tv/api/players/main?title=minions" -H "accept: application/json"</code>
–ø–æ–∏—Å–∫ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–ª–µ–µ—Ä–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é<br />
<code>curl -s -X GET "https://kinobox.tv/api/players/all?title=minions" -H "accept: application/json"</code>
–ø–æ–∏—Å–∫ –≤—Å–µ—Ö –ø–ª–µ–µ—Ä–æ–≤<br />
<code>curl -s -X GET "https://kinobox.tv/api/popular/films" -H "accept: application/json"</code>
–ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–ª—å–º—ã<br />
<code>curl -s -X GET "https://kinobox.tv/api/popular/series" -H "accept: application/json"</code>
–ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å–µ—Ä–∏–∞–ª—ã</p>
<h1 id="videocdn">VideoCDN</h1>
<p><a href="https://github.com/notssh/videocdn-api">API</a><br />
<a href="https://github.com/API-Movies/videocdn">Source</a><br />
<a href="https://api-movies.github.io/videocdn/index.json">API
JSON</a></p>
<div class="sourceCode" id="cb221"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="va">$kp_id</span> <span class="op">=</span> <span class="dv">5106881</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="va">$token</span> <span class="op">=</span> <span class="st">&quot;YfTWH2p3Mai7ziqDoGjS3yXXXXXXXXXX&quot;</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="va">$ep</span> <span class="op">=</span> <span class="st">&quot;tv-series&quot;</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="op">$(</span><span class="fu">Invoke-RestMethod</span> <span class="op">$(</span><span class="st">&quot;https://videocdn.tv/api/</span><span class="va">$ep</span><span class="st">&quot;</span><span class="op">+</span><span class="st">&quot;?api_token=</span><span class="va">$token</span><span class="st">&amp;field=kinopoisk_id&amp;query=</span><span class="va">$kp_id</span><span class="st">&quot;</span><span class="op">)).</span><span class="fu">data</span><span class="op">.</span><span class="fu">episodes</span> <span class="op">|</span> <span class="fu">Where-Object</span> season_num <span class="op">-eq</span> <span class="dv">2</span> <span class="op">|</span> <span class="fu">Select-Object</span> @<span class="op">{</span>Name<span class="op">=</span><span class="st">&quot;Episode&quot;</span><span class="op">;</span> Expression<span class="op">={</span><span class="va">$_</span><span class="op">.</span><span class="fu">num</span><span class="op">}},</span> @<span class="op">{</span>Name<span class="op">=</span><span class="st">&quot;Voice&quot;</span><span class="op">;</span> Expression<span class="op">={</span><span class="va">$_</span><span class="op">.</span><span class="fu">media</span><span class="op">.</span><span class="fu">translation</span><span class="op">.</span><span class="fu">title</span><span class="op">}}</span> <span class="co"># –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–∏–∏ –ø–æ –≤—Ç–æ—Ä–æ–º—É —Å–µ–∑–æ–Ω—É –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –æ–∑–≤—É—á–∫–∏ –∫ —Å–µ—Ä–∏—è–º</span></span></code></pre></div>
<div class="sourceCode" id="cb222"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="va">kp_id</span><span class="op">=</span>5106881</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="va">token</span><span class="op">=</span><span class="st">&quot;YfTWH2p3Mai7ziqDoGjS3yXXXXXXXXXX&quot;</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="va">ep</span><span class="op">=</span><span class="st">&quot;tv-series&quot;</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="st">&quot;https://videocdn.tv/api/</span><span class="va">$ep</span><span class="st">?api_token=</span><span class="va">$token</span><span class="st">&amp;field=kinopoisk_id&amp;query=</span><span class="va">$kp_id</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&quot;.data[].episodes | length&quot;</span> <span class="co"># –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä–∏–π</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="st">&quot;https://videocdn.tv/api/</span><span class="va">$ep</span><span class="st">?api_token=</span><span class="va">$token</span><span class="st">&amp;field=kinopoisk_id&amp;query=</span><span class="va">$kp_id</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&quot;.data[].episodes[] | select(.season_num == 2) | {episode: .ru_title, voice: .media[].translation.title}&quot;</span> <span class="co"># –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã–≤–æ–¥–∞</span></span></code></pre></div>
<h1 id="telegram">Telegram</h1>
<p><span class="citation" data-cites="BotFather">@BotFather</span>
(https://t.me/BotFather) /newbot</p>
<p>Format:
<code>https://api.telegram.org/bot&lt;token&gt;/&lt;endpoint&gt;</code></p>
<p><a
href="https://core.telegram.org/bots/api#getupdates">getupdates</a></p>
<div class="sourceCode" id="cb223"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get-FromTelegram <span class="op">{</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span> <span class="op">(</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Token</span> <span class="op">=</span> <span class="st">&quot;687...:AAF...&quot;</span><span class="op">,</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="dt">switch</span><span class="op">]</span><span class="va">$Date</span><span class="op">,</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="dt">switch</span><span class="op">]</span><span class="va">$Last</span><span class="op">,</span></span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="dt">switch</span><span class="op">]</span><span class="va">$ChatID</span></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>    <span class="va">$endpoint</span> <span class="op">=</span> <span class="st">&quot;getUpdates&quot;</span></span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">$url</span>      <span class="op">=</span> <span class="st">&quot;https://api.telegram.org/bot</span><span class="va">$Token</span><span class="st">/</span><span class="va">$endpoint</span><span class="st">&quot;</span></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>    <span class="va">$result</span>   <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="va">$url</span></span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="va">$Date</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Collections</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Collections</span><span class="op">.</span><span class="fu">Generic</span><span class="op">.</span><span class="fu">List</span><span class="op">[</span>System<span class="op">.</span><span class="fu">Object</span><span class="op">]</span></span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">foreach</span> <span class="op">(</span><span class="va">$r</span> <span class="kw">in</span> <span class="op">$(</span><span class="va">$result</span><span class="op">.</span><span class="fu">result</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">$EpochTime</span> <span class="op">=</span> <span class="op">[</span>DateTime<span class="op">]</span><span class="st">&quot;1/1/1970&quot;</span></span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a>            <span class="va">$TimeZone</span> <span class="op">=</span> Get-TimeZone</span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">$UTCTime</span> <span class="op">=</span> <span class="va">$EpochTime</span><span class="op">.</span><span class="fu">AddSeconds</span><span class="op">(</span><span class="va">$r</span><span class="op">.</span><span class="fu">message</span><span class="op">.</span><span class="fu">date</span><span class="op">)</span></span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>            <span class="va">$d</span> <span class="op">=</span> <span class="va">$UTCTime</span><span class="op">.</span><span class="fu">AddMinutes</span><span class="op">(</span><span class="va">$TimeZone</span><span class="op">.</span><span class="fu">BaseUtcOffset</span><span class="op">.</span><span class="fu">TotalMinutes</span><span class="op">)</span></span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a>            <span class="va">$Collections</span><span class="op">.</span><span class="fu">Add</span><span class="op">([</span>PSCustomObject<span class="op">]</span>@<span class="op">{</span></span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a>                Message <span class="op">=</span> <span class="va">$r</span><span class="op">.</span><span class="fu">message</span><span class="op">.</span><span class="fu">text</span><span class="op">;</span></span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a>                Date    <span class="op">=</span> <span class="va">$d</span></span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a>            <span class="op">})</span></span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Collections</span></span>
<span id="cb223-24"><a href="#cb223-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb223-25"><a href="#cb223-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb223-26"><a href="#cb223-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="va">$Last</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb223-27"><a href="#cb223-27" aria-hidden="true" tabindex="-1"></a>            <span class="va">$result</span><span class="op">.</span><span class="fu">result</span><span class="op">.</span><span class="fu">message</span><span class="op">.</span><span class="fu">text</span><span class="op">[</span>-1<span class="op">]</span></span>
<span id="cb223-28"><a href="#cb223-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb223-29"><a href="#cb223-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elseif</span> <span class="op">(</span><span class="va">$ChatID</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb223-30"><a href="#cb223-30" aria-hidden="true" tabindex="-1"></a>            <span class="va">$Collections</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Collections</span><span class="op">.</span><span class="fu">Generic</span><span class="op">.</span><span class="fu">List</span><span class="op">[</span>System<span class="op">.</span><span class="fu">Object</span><span class="op">]</span></span>
<span id="cb223-31"><a href="#cb223-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">foreach</span> <span class="op">(</span><span class="va">$r</span> <span class="kw">in</span> <span class="op">$(</span><span class="va">$result</span><span class="op">.</span><span class="fu">result</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb223-32"><a href="#cb223-32" aria-hidden="true" tabindex="-1"></a>                <span class="va">$Collections</span><span class="op">.</span><span class="fu">Add</span><span class="op">([</span>PSCustomObject<span class="op">]</span>@<span class="op">{</span></span>
<span id="cb223-33"><a href="#cb223-33" aria-hidden="true" tabindex="-1"></a>                    Message <span class="op">=</span> <span class="va">$r</span><span class="op">.</span><span class="fu">message</span><span class="op">.</span><span class="fu">text</span><span class="op">;</span></span>
<span id="cb223-34"><a href="#cb223-34" aria-hidden="true" tabindex="-1"></a>                    UserName <span class="op">=</span> <span class="va">$r</span><span class="op">.</span><span class="fu">message</span><span class="op">.</span><span class="fu">chat</span><span class="op">.</span><span class="fu">username</span><span class="op">;</span></span>
<span id="cb223-35"><a href="#cb223-35" aria-hidden="true" tabindex="-1"></a>                    ChatID <span class="op">=</span> <span class="va">$r</span><span class="op">.</span><span class="fu">message</span><span class="op">.</span><span class="fu">chat</span><span class="op">.</span><span class="fu">id</span><span class="op">;</span></span>
<span id="cb223-36"><a href="#cb223-36" aria-hidden="true" tabindex="-1"></a>                    ChatType <span class="op">=</span> <span class="va">$r</span><span class="op">.</span><span class="fu">message</span><span class="op">.</span><span class="fu">chat</span><span class="op">.</span><span class="fu">type</span></span>
<span id="cb223-37"><a href="#cb223-37" aria-hidden="true" tabindex="-1"></a>                <span class="op">})</span></span>
<span id="cb223-38"><a href="#cb223-38" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb223-39"><a href="#cb223-39" aria-hidden="true" tabindex="-1"></a>            <span class="va">$Collections</span></span>
<span id="cb223-40"><a href="#cb223-40" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb223-41"><a href="#cb223-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb223-42"><a href="#cb223-42" aria-hidden="true" tabindex="-1"></a>            <span class="va">$result</span><span class="op">.</span><span class="fu">result</span><span class="op">.</span><span class="fu">message</span><span class="op">.</span><span class="fu">text</span></span>
<span id="cb223-43"><a href="#cb223-43" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb223-44"><a href="#cb223-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb223-45"><a href="#cb223-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Get-FromTelegram</code><br />
<code>Get-FromTelegram -Last</code><br />
<code>Get-FromTelegram -Date</code><br />
<code>Get-FromTelegram -ChatID</code></p>
<p><a
href="https://core.telegram.org/bots/api#sendmessage">sendmessage</a></p>
<div class="sourceCode" id="cb224"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Send-ToTelegram <span class="op">{</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="kw">param</span> <span class="op">(</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>Parameter<span class="op">(</span>Mandatory <span class="op">=</span> <span class="va">$True</span><span class="op">)]</span><span class="va">$Text</span><span class="op">,</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">$Token</span>    <span class="op">=</span> <span class="st">&quot;687...:AAF...&quot;</span><span class="op">,</span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">$Chat</span>     <span class="op">=</span> <span class="st">&quot;125468108&quot;</span><span class="op">,</span></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">$Keyboard</span></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>    <span class="va">$endpoint</span> <span class="op">=</span> <span class="st">&quot;sendMessage&quot;</span></span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">$url</span>      <span class="op">=</span> <span class="st">&quot;https://api.telegram.org/bot</span><span class="va">$Token</span><span class="st">/</span><span class="va">$endpoint</span><span class="st">&quot;</span></span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>    <span class="va">$Body</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>        chat_id <span class="op">=</span> <span class="va">$Chat</span></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>        text    <span class="op">=</span> <span class="va">$Text</span></span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="va">$keyboard</span> <span class="op">-ne</span> <span class="va">$null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Body</span> <span class="op">+=</span> @<span class="op">{</span>reply_markup <span class="op">=</span> <span class="va">$keyboard</span><span class="op">}</span></span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="va">$url</span> <span class="op">-</span>Body <span class="va">$Body</span></span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>Send-ToTelegram -Text "Send test from powershell"</code></p>
<div class="sourceCode" id="cb225"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="va">$LastDate</span> <span class="op">=</span> <span class="op">(</span>Get-FromTelegram <span class="op">-</span>date<span class="op">)[</span>-1<span class="op">].</span><span class="fu">Date</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span><span class="va">$true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">$LastMessage</span>  <span class="op">=</span> <span class="op">(</span>Get-FromTelegram <span class="op">-</span>date<span class="op">)[</span>-1<span class="op">]</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Start-Sleep</span> <span class="dv">1</span></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">$LastDateTest</span> <span class="op">=</span> <span class="va">$LastMessage</span><span class="op">.</span><span class="fu">Date</span></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">((</span><span class="va">$LastMessage</span><span class="op">.</span><span class="fu">Message</span> <span class="op">-match</span> <span class="st">&quot;/Service&quot;</span><span class="op">)</span> <span class="op">-and</span> <span class="op">(</span><span class="va">$LastDate</span> <span class="op">-ne</span> <span class="va">$LastDateTest</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">$ServiceName</span> <span class="op">=</span> <span class="op">$(</span><span class="va">$LastMessage</span><span class="op">.</span><span class="fu">Message</span> <span class="op">-split</span> <span class="st">&quot; &quot;</span><span class="op">)[</span>-1<span class="op">]</span></span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Result</span> <span class="op">=</span> <span class="op">$(</span><span class="fu">Get-Service</span> <span class="va">$ServiceName</span> <span class="op">-</span>ErrorAction Ignore<span class="op">).</span><span class="fu">Status</span></span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="va">$Result</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>            Send-ToTelegram <span class="op">-</span>Text <span class="va">$Result</span></span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a>            Send-ToTelegram <span class="op">-</span>Text <span class="st">&quot;Service not found&quot;</span></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">$LastDate</span> <span class="op">=</span> <span class="va">$LastDateTest</span></span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>/Service vpnagent</code><br />
<code>/Service WinRM</code><br />
<code>/Service test</code></p>
<h3 id="button">Button</h3>
<div class="sourceCode" id="cb226"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="va">$keyboard</span> <span class="op">=</span> <span class="st">&#39;{</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;inline_keyboard&quot;:[[</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="st">        {&quot;text&quot;:&quot;Uptime&quot;,&quot;callback_data&quot;:&quot;/Uptime&quot;},</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="st">        {&quot;text&quot;:&quot;Test&quot;,&quot;callback_data&quot;:&quot;/Test&quot;}</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="st">    ]]</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>Send-ToTelegram <span class="op">-</span>Text <span class="st">&quot;Test buttons&quot;</span> <span class="op">-</span>Keyboard <span class="va">$keyboard</span></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="va">$request</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Invoke-RestMethod</span> <span class="op">-</span>Uri <span class="st">&quot;https://api.telegram.org/bot</span><span class="va">$Token</span><span class="st">/getUpdates&quot;</span><span class="op">).</span><span class="fu">result</span><span class="op">.</span><span class="fu">callback_query</span></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="va">$request</span><span class="op">.</span><span class="fu">data</span> <span class="co"># –ø—Ä–æ—á–∏—Ç–∞—Ç—å callback_data –Ω–∞–∂–∞—Ç–æ–π –∫–Ω–æ–ø–∫–∏</span></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a><span class="va">$request</span><span class="op">.</span><span class="fu">message</span><span class="op">.</span><span class="fu">date</span></span></code></pre></div>
<h1 id="discord">Discord</h1>
<p><a
href="https://discord.com/developers/applications">Developers</a></p>
<p>–°–æ–∑–¥–∞–µ–º Applications (General Information). –í Bot –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫
Application –∏ –∫–æ–ø–∏—Ä—É–µ–º —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –í OAuth2 - URL Generator
–≤—ã–±–∏—Ä–∞–µ–º bot –∏ –ø—Ä–∞–≤–∞ Administrator –∏ –∫–æ–ø–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–π URL –¥–ª—è
–¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –∫–∞–Ω–∞–ª. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ url –∏ –¥–æ–±–∞–≤–ª—è–µ–º –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.
–ü–æ–ª—É—á–∞–µ–º ID –∫–∞–Ω–∞–ª–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (—Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∫–∞–Ω–∞–ª—ã, –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏
–∫–æ–ø–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É –∏ –∑–∞–±–∏—Ä–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π id –≤ url).</p>
<h3 id="send-to-discord">Send to Discord</h3>
<div class="sourceCode" id="cb227"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="va">DISCORD_TOKEN</span><span class="op">=</span><span class="st">&quot;MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX&quot;</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="va">DISCORD_CHANNEL_ID</span><span class="op">=</span><span class="st">&quot;119403124XXXXXXXXXX&quot;</span></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="va">TEXT</span><span class="op">=</span><span class="st">&quot;test from bash&quot;</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="va">URL</span><span class="op">=</span><span class="st">&quot;https://discordapp.com/api/channels/</span><span class="va">$DISCORD_CHANNEL_ID</span><span class="st">/messages&quot;</span></span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-X</span> POST <span class="va">$URL</span> <span class="dt">\</span></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Authorization: Bot </span><span class="va">$DISCORD_TOKEN</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">-d</span> <span class="st">&quot;{</span><span class="dt">\&quot;</span><span class="st">content</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="va">$TEXT</span><span class="dt">\&quot;</span><span class="st">}&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb228"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="va">$DISCORD_TOKEN</span> <span class="op">=</span> <span class="st">&quot;MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX&quot;</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="va">$DISCORD_CHANNEL_ID</span> <span class="op">=</span> <span class="st">&quot;119403124XXXXXXXXXX&quot;</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="va">$TEXT</span> <span class="op">=</span> <span class="st">&quot;test from PowerShell&quot;</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="va">$URL</span> <span class="op">=</span> <span class="st">&quot;https://discordapp.com/api/channels/</span><span class="va">$DISCORD_CHANNEL_ID</span><span class="st">/messages&quot;</span></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="va">$Body</span> <span class="op">=</span> @<span class="op">{</span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>    content <span class="op">=</span> <span class="va">$TEXT</span></span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="op">|</span> <span class="fu">ConvertTo-Json</span></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curl</span> <span class="op">-</span>s <span class="va">$URL</span> <span class="op">-</span>X POST <span class="op">-</span>H <span class="st">&quot;Authorization: Bot </span><span class="va">$DISCORD_TOKEN</span><span class="st">&quot;</span> <span class="op">-</span>H <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="op">-</span>d <span class="va">$Body</span></span></code></pre></div>
<h3 id="read-from-discord">Read from Discord</h3>
<div class="sourceCode" id="cb229"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-X</span> GET <span class="va">$URL</span> <span class="dt">\</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Authorization: Bot </span><span class="va">$DISCORD_TOKEN</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> .<span class="pp">[</span><span class="ss">0</span><span class="pp">]</span>.content</span></code></pre></div>
<div class="sourceCode" id="cb230"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="va">$messages</span> <span class="op">=</span> <span class="op">(</span><span class="fu">curl</span> <span class="op">-</span>s <span class="op">-</span>X GET <span class="va">$URL</span> <span class="op">-</span>H <span class="st">&quot;Authorization: Bot </span><span class="va">$DISCORD_TOKEN</span><span class="st">&quot;</span> <span class="op">-</span>H <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="op">|</span> <span class="fu">ConvertFrom-Json</span><span class="op">)</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="va">$messages</span> <span class="op">|</span> <span class="fu">Select-Object</span> content<span class="op">,</span>timestamp<span class="op">,{</span><span class="va">$_</span><span class="op">.</span><span class="fu">author</span><span class="op">.</span><span class="fu">username</span><span class="op">}</span></span></code></pre></div>
<h3 id="httpclient">HttpClient</h3>
<div class="sourceCode" id="cb231"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="va">$DISCORD_TOKEN</span> <span class="op">=</span> <span class="st">&quot;MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX&quot;</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="va">$DISCORD_CHANNEL_ID</span> <span class="op">=</span> <span class="st">&quot;119403124XXXXXXXXXX&quot;</span></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="va">$URL</span> <span class="op">=</span> <span class="st">&quot;https://discordapp.com/api/channels/</span><span class="va">$DISCORD_CHANNEL_ID</span><span class="st">/messages&quot;</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="va">$HttpClient</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Net</span><span class="op">.</span><span class="fu">Http</span><span class="op">.</span><span class="fu">HttpClient</span></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="va">$HttpClient</span><span class="op">.</span><span class="fu">DefaultRequestHeaders</span><span class="op">.</span><span class="fu">Authorization</span> <span class="op">=</span> <span class="st">&quot;Bot </span><span class="va">$DISCORD_TOKEN</span><span class="st">&quot;</span></span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a><span class="va">$response</span> <span class="op">=</span> <span class="va">$HttpClient</span><span class="op">.</span><span class="fu">GetAsync</span><span class="op">(</span><span class="va">$URL</span><span class="op">).</span><span class="fu">Result</span></span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a><span class="va">$messages</span> <span class="op">=</span> <span class="va">$response</span><span class="op">.</span><span class="fu">Content</span><span class="op">.</span><span class="fu">ReadAsStringAsync</span><span class="op">().</span><span class="fu">Result</span></span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="va">$messages</span> <span class="op">|</span> <span class="fu">ConvertFrom-Json</span><span class="op">).</span><span class="fu">content</span></span></code></pre></div>
<h3 id="button-1">Button</h3>
<div class="sourceCode" id="cb232"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> POST <span class="va">$URL</span> <span class="dt">\</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Authorization: Bot </span><span class="va">$DISCORD_TOKEN</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-d</span> <span class="st">&#39;</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="st">  {</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;content&quot;: &quot;Test text for button&quot;,</span></span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;components&quot;: [</span></span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a><span class="st">      {</span></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;type&quot;: 1,</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;components&quot;: [</span></span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a><span class="st">          {</span></span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;type&quot;: 2,</span></span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;label&quot;: &quot;Button&quot;,</span></span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;style&quot;: 1,</span></span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;custom_id&quot;: &quot;button_click&quot;</span></span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a><span class="st">          }</span></span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a><span class="st">        ]</span></span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb232-19"><a href="#cb232-19" aria-hidden="true" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb232-20"><a href="#cb232-20" aria-hidden="true" tabindex="-1"></a><span class="st">  }&#39;</span></span></code></pre></div>
<h3 id="discord.net.webhook">Discord.Net.Webhook</h3>
<div class="sourceCode" id="cb233"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Add-Type</span> <span class="op">-</span>Path <span class="op">$(</span><span class="fu">ls</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Documents\Discord.NET\*.dll&quot;</span><span class="op">).</span><span class="fu">FullName</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://discordapp.com/api/webhooks/&lt;webhook_id&gt;/&lt;webhook_token&gt; (–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–∞–Ω–∞–ª - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)</span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="va">$webhookId</span> <span class="op">=</span> <span class="dv">1197577280000000000</span></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a><span class="va">$webhookToken</span> <span class="op">=</span> <span class="st">&quot;rs8AA-XXXXXXXXXXX_Vk5RUI4A6HuSGhpCCTepq25duwCwLXasfv6u23a7XXXXXXXXXX&quot;</span></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="va">$messageContent</span> <span class="op">=</span> <span class="st">&quot;Test dotNET&quot;</span></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a><span class="va">$client</span> <span class="op">=</span> <span class="fu">New-Object</span> Discord<span class="op">.</span><span class="fu">Webhook</span><span class="op">.</span><span class="fu">DiscordWebhookClient</span><span class="op">(</span><span class="va">$webhookId</span><span class="op">,</span> <span class="va">$webhookToken</span><span class="op">)</span></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a><span class="va">$client</span><span class="op">.</span><span class="fu">SendMessageAsync</span><span class="op">(</span><span class="va">$messageContent</span><span class="op">).</span><span class="fu">Wait</span><span class="op">()</span></span></code></pre></div>
<h3 id="discord.net.websocket">Discord.Net.WebSocket</h3>
<div class="sourceCode" id="cb234"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="va">$DiscordAssemblies</span> <span class="op">=</span> <span class="op">$(</span><span class="fu">ls</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Documents\Discord.NET\*.dll&quot;</span><span class="op">).</span><span class="fu">FullName</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> <span class="op">(</span><span class="va">$assembly</span> <span class="kw">in</span> <span class="va">$DiscordAssemblies</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Add-Type</span> <span class="op">-</span>Path <span class="va">$assembly</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a><span class="va">$DISCORD_TOKEN</span> <span class="op">=</span> <span class="st">&quot;MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX&quot;</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a><span class="va">$Client</span> <span class="op">=</span> <span class="fu">New-Object</span> Discord<span class="op">.</span><span class="fu">WebSocket</span><span class="op">.</span><span class="fu">DiscordSocketClient</span></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a><span class="va">$Client</span><span class="op">.</span><span class="fu">Add_MessageReceived</span><span class="op">({</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span><span class="op">(</span><span class="va">$message</span><span class="op">)</span></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="va">$message</span><span class="op">.</span><span class="fu">Author</span><span class="op">.</span><span class="fu">Id</span> <span class="op">-ne</span> <span class="va">$Client</span><span class="op">.</span><span class="fu">CurrentUser</span><span class="op">.</span><span class="fu">Id</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Write-Host</span> <span class="op">(</span><span class="st">&quot;Received message from &quot;</span> <span class="op">+</span> <span class="va">$message</span><span class="op">.</span><span class="fu">Author</span><span class="op">.</span><span class="fu">Username</span> <span class="op">+</span> <span class="st">&quot;: &quot;</span> <span class="op">+</span> <span class="va">$message</span><span class="op">.</span><span class="fu">Content</span><span class="op">)</span></span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span><span class="va">$message</span><span class="op">.</span><span class="fu">Content</span><span class="op">.</span><span class="fu">Contains</span><span class="op">(</span><span class="st">&quot;ping&quot;</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>            <span class="va">$message</span><span class="op">.</span><span class="fu">Channel</span><span class="op">.</span><span class="fu">SendMessageAsync</span><span class="op">(</span><span class="st">&quot;pong&quot;</span><span class="op">).</span><span class="fu">GetAwaiter</span><span class="op">().</span><span class="fu">GetResult</span><span class="op">()</span></span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a><span class="op">})</span></span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a><span class="va">$Client</span><span class="op">.</span><span class="fu">LoginAsync</span><span class="op">([</span>Discord<span class="op">.</span><span class="fu">TokenType</span><span class="op">]::</span>Bot<span class="op">,</span> <span class="va">$DISCORD_TOKEN</span><span class="op">).</span><span class="fu">GetAwaiter</span><span class="op">().</span><span class="fu">GetResult</span><span class="op">()</span></span>
<span id="cb234-17"><a href="#cb234-17" aria-hidden="true" tabindex="-1"></a><span class="co">#$Client.StartAsync().Wait()</span></span>
<span id="cb234-18"><a href="#cb234-18" aria-hidden="true" tabindex="-1"></a><span class="va">$Client</span><span class="op">.</span><span class="fu">StartAsync</span><span class="op">().</span><span class="fu">GetAwaiter</span><span class="op">().</span><span class="fu">GetResult</span><span class="op">()</span></span>
<span id="cb234-19"><a href="#cb234-19" aria-hidden="true" tabindex="-1"></a><span class="va">$Client</span><span class="op">.</span><span class="fu">ConnectionState</span></span>
<span id="cb234-20"><a href="#cb234-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-21"><a href="#cb234-21" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>console<span class="op">]::</span>ReadKey<span class="op">(</span><span class="va">$true</span><span class="op">)</span></span>
<span id="cb234-22"><a href="#cb234-22" aria-hidden="true" tabindex="-1"></a><span class="va">$Client</span><span class="op">.</span><span class="fu">LogoutAsync</span><span class="op">().</span><span class="fu">GetAwaiter</span><span class="op">().</span><span class="fu">GetResult</span><span class="op">()</span></span>
<span id="cb234-23"><a href="#cb234-23" aria-hidden="true" tabindex="-1"></a><span class="va">$Client</span><span class="op">.</span><span class="fu">Dispose</span><span class="op">()</span></span></code></pre></div>
<h1 id="oh-my-posh">oh-my-posh</h1>
<p><a
href="https://ohmyposh.dev/docs/installation/windows">Install</a></p>
<p><code>winget install JanDeDobbeleer.OhMyPosh -s winget</code><br />
<code>choco install oh-my-posh -y</code><br />
<code>scoop install https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/oh-my-posh.json</code><br />
<code>Set-ExecutionPolicy Bypass -Scope Process -Force; Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://ohmyposh.dev/install.ps1'))</code></p>
<p><a href="https://ohmyposh.dev/docs/themes">Themes</a></p>
<p><code>Get-PoshThemes</code><br />
<code>oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/di4am0nd.omp.json" | Invoke-Expression</code><br />
<code>oh-my-posh init pwsh --config "https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/cert.omp.json" | Invoke-Expression</code></p>
<p><code>New-Item -Path $PROFILE -Type File -Force</code><br />
<code>notepad $PROFILE</code><br />
<code>oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/di4am0nd.omp.json" | Invoke-Expression</code></p>
<h3 id="themes-performance">themes-performance</h3>
<div class="sourceCode" id="cb235"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>Install-Module themes-performance <span class="op">-</span>Repository NuGet</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Import-Module</span> themes-performance</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>Set-PoshTheme <span class="op">-</span>Theme System-Sensors <span class="co"># -Save</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>Set-PoshTheme <span class="op">-</span>Theme System-Performance <span class="co"># -Save</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>Set-PoshTheme <span class="op">-</span>Theme Pwsh-Process-Performance <span class="co"># -Save</span></span></code></pre></div>
<h3 id="terminal-icons">Terminal-Icons</h3>
<p><code>Install-Module -Name Terminal-Icons -Repository PSGallery</code><br />
<code>scoop bucket add extras</code><br />
<code>scoop install terminal-icons</code></p>
<p><code>notepad $PROFILE</code><br />
<code>Import-Module -Name Terminal-Icons</code></p>
<p>–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —à—Ä–∏—Ñ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤
–ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –ø—Ä–æ—Ñ–∏–ª—è PowerShell: <a
href="https://github.com/ryanoasis/nerd-fonts">Nerd Fonts</a><br />
<a href="https://www.nerdfonts.com/font-downloads">–°–ø–∏—Å–æ–∫
—à—Ä–∏—Ñ—Ç–æ–≤</a><br />
–°–∫–∞—á–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —à—Ä–∏—Ñ—Ç –ø–æ—Ö–æ–∂–∏–π –Ω–∞ Cascadia Code - <a
href="https://github.com/ryanoasis/nerd-fonts/releases/download/v3.1.1/CascadiaCode.zip">CaskaydiaCove</a></p>
<h1 id="pester">Pester</h1>
<p><a href="https://github.com/pester/Pester">Source</a></p>
<p><code>Install-Module -Name Pester -Repository PSGallery -Force -AllowClobber</code><br />
<code>Import-Module Pester</code><br />
<code>$(Get-Module Pester -ListAvailable).Version</code></p>
<p><code>.Tests.ps1</code></p>
<div class="sourceCode" id="cb236"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Add-Numbers <span class="op">{</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span> <span class="op">(</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="dt">int</span><span class="op">]</span><span class="va">$a</span><span class="op">,</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="dt">int</span><span class="op">]</span><span class="va">$b</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">$a</span> <span class="op">+</span> <span class="va">$b</span></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>Describe <span class="st">&quot;Add-Numbers&quot;</span> <span class="op">{</span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>    Context <span class="st">&quot;–ü—Ä–∏ —Å–ª–æ–∂–µ–Ω–∏–∏ –¥–≤—É—Ö —á–∏—Å–µ–ª&quot;</span> <span class="op">{</span></span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>        It <span class="st">&quot;–î–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—É–º–º–∞&quot;</span> <span class="op">{</span></span>
<span id="cb236-11"><a href="#cb236-11" aria-hidden="true" tabindex="-1"></a>            <span class="va">$result</span> <span class="op">=</span> Add-Numbers <span class="op">-</span>a <span class="dv">3</span> <span class="op">-</span>b <span class="dv">4</span></span>
<span id="cb236-12"><a href="#cb236-12" aria-hidden="true" tabindex="-1"></a>            <span class="va">$result</span> <span class="op">|</span> Should <span class="op">-</span>Be <span class="dv">7</span></span>
<span id="cb236-13"><a href="#cb236-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb236-14"><a href="#cb236-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb236-15"><a href="#cb236-15" aria-hidden="true" tabindex="-1"></a>    Context <span class="st">&quot;–ü—Ä–∏ —Å–ª–æ–∂–µ–Ω–∏–∏ –¥–≤—É—Ö —á–∏—Å–µ–ª&quot;</span> <span class="op">{</span></span>
<span id="cb236-16"><a href="#cb236-16" aria-hidden="true" tabindex="-1"></a>        It <span class="st">&quot;–î–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å—Å—è –æ—à–∏–±–∫–∞ (5+0 -ne 4)&quot;</span> <span class="op">{</span></span>
<span id="cb236-17"><a href="#cb236-17" aria-hidden="true" tabindex="-1"></a>            <span class="va">$result</span> <span class="op">=</span> Add-Numbers <span class="op">-</span>a <span class="dv">5</span> <span class="op">-</span>b <span class="dv">0</span></span>
<span id="cb236-18"><a href="#cb236-18" aria-hidden="true" tabindex="-1"></a>            <span class="va">$result</span> <span class="op">|</span> Should <span class="op">-</span>Be <span class="dv">4</span></span>
<span id="cb236-19"><a href="#cb236-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb236-20"><a href="#cb236-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb236-21"><a href="#cb236-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb236-22"><a href="#cb236-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-23"><a href="#cb236-23" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get-RunningProcess <span class="op">{</span></span>
<span id="cb236-24"><a href="#cb236-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">Get-Process</span> <span class="op">|</span> <span class="fu">Select-Object</span> <span class="op">-</span>ExpandProperty Name</span>
<span id="cb236-25"><a href="#cb236-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb236-26"><a href="#cb236-26" aria-hidden="true" tabindex="-1"></a>Describe <span class="st">&quot;Get-RunningProcess&quot;</span> <span class="op">{</span></span>
<span id="cb236-27"><a href="#cb236-27" aria-hidden="true" tabindex="-1"></a>    Context <span class="st">&quot;–ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤&quot;</span> <span class="op">{</span></span>
<span id="cb236-28"><a href="#cb236-28" aria-hidden="true" tabindex="-1"></a>        It <span class="st">&quot;–î–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å–æ–≤&quot;</span> <span class="op">{</span></span>
<span id="cb236-29"><a href="#cb236-29" aria-hidden="true" tabindex="-1"></a>            <span class="va">$result</span> <span class="op">=</span> Get-RunningProcess</span>
<span id="cb236-30"><a href="#cb236-30" aria-hidden="true" tabindex="-1"></a>            <span class="va">$result</span> <span class="op">|</span> Should <span class="op">-</span>Contain <span class="st">&quot;svchost&quot;</span></span>
<span id="cb236-31"><a href="#cb236-31" aria-hidden="true" tabindex="-1"></a>            <span class="va">$result</span> <span class="op">|</span> Should <span class="op">-</span>Contain <span class="st">&quot;explorer&quot;</span></span>
<span id="cb236-32"><a href="#cb236-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb236-33"><a href="#cb236-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb236-34"><a href="#cb236-34" aria-hidden="true" tabindex="-1"></a>    Context <span class="st">&quot;–ö–æ–≥–¥–∞ –Ω–µ—Ç –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤&quot;</span> <span class="op">{</span></span>
<span id="cb236-35"><a href="#cb236-35" aria-hidden="true" tabindex="-1"></a>        It <span class="st">&quot;–î–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫&quot;</span> <span class="op">{</span></span>
<span id="cb236-36"><a href="#cb236-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># –ó–∞–º–æ–∫–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é Get-Process, —á—Ç–æ–±—ã –æ–Ω–∞ –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</span></span>
<span id="cb236-37"><a href="#cb236-37" aria-hidden="true" tabindex="-1"></a>            Mock <span class="fu">Get-Process</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">@()</span> <span class="op">}</span></span>
<span id="cb236-38"><a href="#cb236-38" aria-hidden="true" tabindex="-1"></a>            <span class="va">$result</span> <span class="op">=</span> Get-RunningProcess</span>
<span id="cb236-39"><a href="#cb236-39" aria-hidden="true" tabindex="-1"></a>            <span class="va">$result</span> <span class="op">|</span> Should <span class="op">-</span>BeEmpty</span>
<span id="cb236-40"><a href="#cb236-40" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb236-41"><a href="#cb236-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb236-42"><a href="#cb236-42" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="pandoc">Pandoc</h1>
<div class="sourceCode" id="cb237"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="va">$release_latest</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="st">&quot;https://api.github.com/repos/jgm/pandoc/releases/latest&quot;</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="va">$url</span> <span class="op">=</span> <span class="op">$(</span><span class="va">$release_latest</span><span class="op">.</span><span class="fu">assets</span> <span class="op">|</span> <span class="fu">Where-Object</span> name <span class="op">-match</span> <span class="st">&quot;windows-x86_64.zip&quot;</span><span class="op">).</span><span class="fu">browser_download_url</span></span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Invoke-RestMethod</span> <span class="va">$url</span> <span class="op">-</span>OutFile <span class="va">$home</span>\Downloads\pandoc<span class="op">.</span><span class="fu">zip</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>Expand-Archive <span class="op">-</span>Path <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\pandoc.zip&quot;</span> <span class="op">-</span>DestinationPath <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\&quot;</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="va">$path</span> <span class="op">=</span> <span class="op">$(</span><span class="fu">Get-ChildItem</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\pandoc-*\*.exe&quot;</span><span class="op">).</span><span class="fu">FullName</span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Copy-Item</span> <span class="op">-</span>Path <span class="va">$path</span> <span class="op">-</span>Destination <span class="st">&quot;C:\Windows\System32\pandoc.exe&quot;</span></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\pandoc*&quot;</span> <span class="op">-</span>Force <span class="op">-</span>Recurse</span></code></pre></div>
<p><code>pandoc -s README.md -o index.html</code> –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑
Markdown –≤ HTML<br />
<code>pandoc README.md -o index.html --css=styles.css</code> –ø—Ä–∏–º–µ–Ω–∏—Ç—å
—Å—Ç–∏–ª–∏ –∏–∑ css<br />
<code>pandoc -s index.html -o README.md</code> –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ HTML –≤
Markdown<br />
<code>pandoc -s README.md -o README.docx</code> –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Word<br />
<code>pandoc -s README.md -o README.epub</code> –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –æ—Ç–∫—Ä—ã—Ç—ã–π
—Ñ–æ—Ä–º–∞—Ç —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –≤–µ—Ä—Å–∏–π –∫–Ω–∏–≥<br />
<code>pandoc -s README.md -o README.pdf</code> –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ PDF
(—Ç—Ä–µ–±—É–µ—Ç—Å—è rsvg-convert)</p>
<div class="sourceCode" id="cb238"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Import-Module</span> ImportExcel</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>Import-Excel <span class="op">-</span>Path srv<span class="op">.</span><span class="fu">xlsx</span> <span class="op">|</span> <span class="fu">Export-Csv</span> <span class="op">-</span>Path <span class="va">$csvFilePath</span> <span class="op">-</span>NoTypeInformation <span class="op">-</span>Encoding UTF8 <span class="co"># –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Excel –≤ csv</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>pandoc <span class="op">-</span>s <span class="op">-</span>f csv <span class="op">-</span>t markdown input<span class="op">.</span><span class="fu">csv</span> <span class="op">-</span>o output<span class="op">.</span><span class="fu">md</span> <span class="co"># –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—É csv –≤ markdown</span></span></code></pre></div>
<h1 id="ffmpeg">FFmpeg</h1>
<div class="sourceCode" id="cb239"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="va">$release_latest</span> <span class="op">=</span> <span class="fu">Invoke-RestMethod</span> <span class="st">&quot;https://api.github.com/repos/BtbN/FFmpeg-Builds/releases/latest&quot;</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="va">$url</span> <span class="op">=</span> <span class="op">$(</span><span class="va">$release_latest</span><span class="op">.</span><span class="fu">assets</span> <span class="op">|</span> <span class="fu">Where-Object</span> name <span class="op">-match</span> <span class="st">&quot;ffmpeg-master-latest-win64-gpl.zip&quot;</span><span class="op">).</span><span class="fu">browser_download_url</span></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Invoke-RestMethod</span> <span class="va">$url</span> <span class="op">-</span>OutFile <span class="va">$home</span>\Downloads\ffmpeg-master-latest-win64-gpl<span class="op">.</span><span class="fu">zip</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>Expand-Archive <span class="op">-</span>Path <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\ffmpeg-master-latest-win64-gpl.zip&quot;</span> <span class="op">-</span>DestinationPath <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\&quot;</span></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Copy-Item</span> <span class="op">-</span>Path <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\ffmpeg-master-latest-win64-gpl\bin\ffmpeg.exe&quot;</span> <span class="op">-</span>Destination <span class="st">&quot;C:\Windows\System32\ffmpeg.exe&quot;</span></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="st">&quot;</span><span class="va">$home</span><span class="st">\Downloads\ffmpeg-*&quot;</span> <span class="op">-</span>Force <span class="op">-</span>Recurse</span></code></pre></div>
<p><code>ffmpeg -i input.mp4 output.gif</code> –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å mp4 –≤
gif<br />
<code>ffmpeg -i input.mp4 -filter_complex "scale=1440:-1:flags=lanczos" output.gif</code>
–∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –≤—ã—Ö–æ–¥–µ<br />
<code>ffmpeg -i input.mp4 -filter_complex "scale=1440:-1:flags=lanczos" -r 10 output.gif</code>
–∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–¥—Ä–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É –Ω–∞ –≤—ã—Ö–æ–¥–µ<br />
<code>ffmpeg -i input.mp4 -filter_complex "fps=5,scale=960:-1:flags=lanczos,split[s0][s1];[s0]palettegen=max_colors=32[p];[s1][p]paletteuse=dither=bayer" output.gif</code>
—Å–∂–∞—Ç–∏–µ –∑–∞ —Å—á–µ—Ç —Ü–≤–µ—Ç–æ–≤–æ–π –ø–æ–ª–∏—Ç—Ä—ã<br />
<code>ffmpeg -i input.mp4 -ss 00:00:10 -frames:v 1 -q:v 1 output.jpg</code>
–≤—ã—Ç–∞—â–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç –∏–∑ –≤–∏–¥–µ–æ –Ω–∞ 10 —Å–µ–∫—É–Ω–¥–µ<br />
<code>ffmpeg -i input.mp4 -ss 00:00:05 -to 00:00:10 -c copy output.mp4</code>
–≤—ã—Ç–∞—â–∏—Ç—å –∫—É—Å–æ–∫ –≤–∏–¥–µ–æ<br />
<code>ffmpeg -i "%d.jpeg" -framerate 2 -c:v libx264 -r 30 -pix_fmt yuv420p output.mp4</code>
—Å–æ–∑–¥–∞—Ç—å –≤–∏–¥–µ–æ –∏–∑ —Ñ–æ—Ç–æ (1.jpeg, 2.jpeg –∏ —Ç.–¥.) —Å framerate (—á–∞—Å—Ç–æ—Ç–æ–π
–∫–∞–¥—Ä–æ–≤) –≤ —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–º –≤–∏–¥–µ–æ 2 –∫–∞–¥—Ä–∞ –≤ —Å–µ–∫—É–Ω–¥—É<br />
<code>ffmpeg -i "rtsp://admin:password@192.168.3.201:554" -rtsp_transport tcp -c:v copy -c:a aac -strict experimental output.mp4</code>
–∑–∞–ø–∏—Å—å –±–µ–∑ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (copy) RTSP-–ø–æ—Ç–æ–∫–∞ —Å –∫–∞–º–µ—Ä—ã –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è
(+ –∞—É–¥–∏–æ –≤ –∫–æ–¥–µ–∫–µ AAC) –≤ —Ñ–∞–π–ª<br />
<code>ffmpeg -i "rtsp://admin:password@192.168.3.201:554" -rtsp_transport tcp -c:v copy -c:a aac -strict experimental -movflags +faststart+frag_keyframe+empty_moov output.mp4</code>
–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—á–∞—Ç—å
–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–µ –¥–æ –µ–≥–æ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏<br />
<code>ffmpeg -i "rtsp://admin:password@192.168.3.201:554" -rtsp_transport tcp -frames:v 1 -c:v mjpeg output.jpg</code>
—Å–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç</p>
<h1 id="imagemagick">ImageMagick</h1>
<p>Source: <a
href="https://sourceforge.net/projects/imagemagick">ImageMagick</a></p>
<p><code>magick identify -verbose PowerShell-Commands.png</code> –∏–∑–≤–ª–µ—á—å
–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è<br />
<code>magick PowerShell-Commands.png output.jpg</code> –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
—Ñ–æ—Ä–º–∞—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è<br />
<code>magick PowerShell-Commands.png -resize 800x600 output.jpg</code>
–∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä (—É–≤–µ–ª–∏—á–∏—Ç—å –∏–ª–∏ —É–º–µ–Ω—å—à–∏—Ç—å)<br />
<code>magick PowerShell-Commands.png -crop 400x300+100+50 output.jpg</code>
–æ–±—Ä–µ–∑–∞—Ç—å<br />
<code>magick PowerShell-Commands.png -rotate 90 output.jpg</code>
–ø–æ–≤–µ—Ä–Ω—É—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ<br />
<code>magick PowerShell-Commands.png -fill white -pointsize 24 -gravity center -annotate +0+0 "PowerShell" output.jpg</code>
–Ω–∞–ª–æ–∂–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ<br />
<code>magick PowerShell-Commands.png -brightness-contrast +20x+10 output.jpg</code>
–∏–∑–º–µ–Ω–∏—Ç—å —è—Ä–∫–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å<br />
<code>magick convert -delay 100 1.png 2.png 3.png output.gif</code>
—Å–æ–∑–¥–∞—Ç—å gif –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π<br />
<code>magick convert image1.jpg image2.jpg -append output.jpg</code>
–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</p>
<center><a href="https://github.com/Lifailon/PS-Commands">GitHub</a> ¬© 2022-2024</center>
</body>
</html>
