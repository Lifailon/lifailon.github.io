<!doctype html><html data-theme=dark lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation), Linux commands and RuDocs for Node.js" name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ff7800 name=theme-color><meta content=#ffa348 media=(prefers-color-scheme:dark) name=theme-color><meta content="default-src 'none';font-src 'self';img-src 'self' https: data:;media-src 'self' https:;style-src 'self' 'unsafe-inline';frame-src https://player.vimeo.com https://www.youtube-nocookie.com https://toot.community;frame-ancestors 'none';base-uri 'none';form-action 'none';connect-src 'self' https://toot.community;script-src 'self' 'self'" http-equiv=content-security-policy><title>Jenkins - PowerShell Commands</title><link href=https://lifailon.github.io/jenkins/ rel=canonical><link href=https://lifailon.github.io/favicon.png rel=icon type=image/png><link href=https://lifailon.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link title="PowerShell Commands - RSS Feed" href=https://lifailon.github.io/rss.xml rel=alternate type=application/rss+xml><link title="PowerShell Commands - Atom Feed" href=https://lifailon.github.io/atom.xml rel=alternate type=application/atom+xml><style>:root{--accent-color:#ff7800}[data-theme=dark]{--accent-color:#ffa348}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--accent-color:#ffa348}}</style><link href=https://lifailon.github.io/style.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=https://lifailon.github.io/syntax-theme-light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://lifailon.github.io/syntax-theme-dark.css rel=stylesheet><script defer src=https://lifailon.github.io/closable.js></script><script defer src=https://lifailon.github.io/copy-button.js></script><script defer src=https://lifailon.github.io/fuse.js></script><script defer src=https://lifailon.github.io/search-fuse.js></script><script defer src=https://lifailon.github.io/theme-switcher.js></script><meta content="PowerShell Commands" property=og:site_name><meta content="Jenkins - PowerShell Commands" property=og:title><meta content=https://lifailon.github.io/jenkins/ property=og:url><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation), Linux commands and RuDocs for Node.js" property=og:description><meta content=https://lifailon.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><div id=handle></div><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://lifailon.github.io> <i class=icon></i>PowerShell Commands</a><li class=divider><li><a href=https://lifailon.github.io/powershell/>PowerShell</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/golang/>GoLang</a><li><a href=https://lifailon.github.io/node-js/>Node.js</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/windowsserver/>Windows Server</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/api/>API</a><li><a class=active href=https://lifailon.github.io/jenkins/>Jenkins</a><li><a href=https://lifailon.github.io/devops/>DevOps</a><li id=search><button class=circle id=search-toggle title=Search><i class=icon></i></button><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details><li id=repo><a class=circle href=https://github.com/Lifailon/PS-Commands title=Repository> <i class=icon></i> </a></ul></nav><div id=search-container><label class=visually-hidden for=search-bar>Search</label><input placeholder="Search for…" autocomplete=off disabled id=search-bar type=search><div id=search-results-container><div id=search-results></div></div></div></header><div id=sidebar><div><h2>Table of Contents</h2><ul><li><a href=https://lifailon.github.io/jenkins/#api>API</a><li><a href=https://lifailon.github.io/jenkins/#ssh-steps-and-artifacts>SSH Steps and Artifacts</a><li><a href=https://lifailon.github.io/jenkins/#update-ssh-authorized-keys>Update SSH authorized_keys</a><li><a href=https://lifailon.github.io/jenkins/#upload-file-parameter>Upload File Parameter</a><li><a href=https://lifailon.github.io/jenkins/#input-text-and-file>Input Text and File</a><li><a href=https://lifailon.github.io/jenkins/#httpurlconnection>HttpURLConnection</a><li><a href=https://lifailon.github.io/jenkins/#active-choices-parameter>Active Choices Parameter</a><li><a href=https://lifailon.github.io/jenkins/#vault>Vault</a><li><a href=https://lifailon.github.io/jenkins/#email-extension>Email Extension</a><li><a href=https://lifailon.github.io/jenkins/#parallel>Parallel</a><li><a href=https://lifailon.github.io/jenkins/#groovy>Groovy</a></ul></div></div><main id=main-content><h1>Jenkins</h1><p>Примеры <code>Pipeline</code> и базовый синтаксис <code>Groovy</code>.<hr><p><code>docker run -d --name=jenkins -p 8080:8080 --restart=always -v jenkins_home:/var/jenkins_home jenkins/jenkins:latest</code> <br> <code>ls /var/lib/docker/volumes/jenkins_home/_data/jobs</code> директория хранящая историю сборок в хостовой системе <br> <code>docker exec -u root -it jenkins /bin/bash</code> подключиться к контейнеру под root <br> <code>cat /var/jenkins_home/secrets/initialAdminPassword</code> получить токен инициализации <br> <code>apt-get update && apt-get install -y iputils-ping netcat-openbsd</code> установить ping и nc на машину сборщика (master slave)<p><code>wget http://127.0.0.1:8080/jnlpJars/jenkins-cli.jar -P $HOME/</code> скачать jenkins-cli (http://127.0.0.1:8080/manage/cli) <br> <code>apt install openjdk-17-jre-headless</code> установить java runtime <br> <code>java -jar jenkins-cli.jar -auth lifailon:password -s http://127.0.0.1:8080 -webSocket help</code> получить список команд <br> <code>java -jar jenkins-cli.jar -auth lifailon:password -s http://127.0.0.1:8080 groovysh</code> запустить консоль Groovy <br> <code>java -jar jenkins-cli.jar -auth lifailon:password -s http://127.0.0.1:8080 install-plugin ssh-steps -deploy</code> устанавливаем плагин SSH Pipeline Steps<h2 id=api><a aria-label="Anchor link for: api" class=zola-anchor href=#api><i class=icon></i></a> API</h2><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>username</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Lifailon<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>password</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>password<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>base64AuthInfo</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Convert</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ToBase64String<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ASCII.GetBytes<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0}:{1}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>username</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>password</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Authorization</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Basic {0}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>base64AuthInfo</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://192.168.3.101:8080/rssAll<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> RSS лента всех сборок и их статус в title<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://192.168.3.101:8080/rssFailed<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> RSS лента всех неудачных сборок<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>jobs</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://192.168.3.101:8080/api/json/job<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>jobs<span class="z-variable z-other z-member z-powershell">.jobs.name</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> список всех проектов<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>jobName</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Update SSH authorized_keys<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>job</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://192.168.3.101:8080/job/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-braces z-begin">{</span>jobName<span class="z-punctuation z-section z-braces z-end">}</span></span>/api/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>job<span class="z-variable z-other z-member z-powershell">.builds</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> список всех сборок<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>buildNumber</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>job<span class="z-variable z-other z-member z-powershell">.lastUnsuccessfulBuild.number</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> последняя неуспешная сборка<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://192.168.3.101:8080/job/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-braces z-begin">{</span>jobName<span class="z-punctuation z-section z-braces z-end">}</span></span>/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-braces z-begin">{</span>buildNumber<span class="z-punctuation z-section z-braces z-end">}</span></span>/consoleText<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> вывести лог указанной сборки<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>lastCompletedBuild</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>job<span class="z-variable z-other z-member z-powershell">.lastCompletedBuild.number</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> последняя успешная сборка<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>crumb</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://192.168.3.101:8080/crumbIssuer/api/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.crumb <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> получаем временный токен доступа (crumb)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Jenkins-Crumb<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>crumb</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> добавляем crumb в заголовки<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.crumb<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>crumb</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> добавляем crumb в тело запроса<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://192.168.3.101:8080/job/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-braces z-begin">{</span>jobName<span class="z-punctuation z-section z-braces z-end">}</span></span>/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-braces z-begin">{</span>lastCompletedBuild<span class="z-punctuation z-section z-braces z-end">}</span></span>/rebuild<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> перезапустить сборку<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h2 id=ssh-steps-and-artifacts><a aria-label="Anchor link for: ssh-steps-and-artifacts" class=zola-anchor href=#ssh-steps-and-artifacts><i class=icon></i></a> SSH Steps and Artifacts</h2><p>Устанавливаем плагин <a href=https://plugins.jenkins.io/ssh-steps>SSH Pipeline Steps</a><p>Добавляем логин и <code>Private Key</code> для авторизации по ssh: <code>Manage (Settings)</code> => <code>Credentials</code> => <code>Global</code> => <code>Add credentials</code> => Kind: <code>SSH Username with private key</code><p>Сценарий проверяет доступность удаленной машины, подключается к ней по ssh, выполняет скрипт <a href=https://github.com/Lifailon/hwstat>hwstat</a> для сбора метрик и выгружает json отчет в артефакты:<pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Глобальный массив для хранения данных подключения по ssh 
</span></span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> remote <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>:<span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span><span class="z-source z-groovy">
</span><span class="z-source z-groovy">pipeline <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    agent any
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    parameters <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>address<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>192.168.3.101<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Адрес удаленного сервера<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> choice(name: "addresses", choices: ["192.168.3.101","192.168.3.102"], description: "Выберите сервер из выпадающего списка")
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>port<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>22<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Порт ssh<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>credentials<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>d5da50fc-5a98-44c4-8c55-d009081a861a<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Идентификатор учетных данных из Jenkins<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">booleanParam</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>root<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-constant z-language z-groovy">false</span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Запуск с повышенными привилегиями<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">booleanParam</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>report<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-constant z-language z-groovy">true</span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Выгружать отчет в формате json<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    triggers <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">cron</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>H */6 * * 1-5<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> выполнять запуск каждын 6 часов с понедельника по пятницу
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    options <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">timeout</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">time</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-constant z-numeric z-groovy">5</span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">unit</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>MINUTES<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> период ожидания, после которого нужно прервать Pipeline
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">retry</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-numeric z-groovy">2</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> в случае неудачи повторить весь Pipeline указанное количество раз
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    environment <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Переменная окружения для хранения пути временного файла с содержимым приватного ключа
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-constant z-other z-groovy">SSH_KEY_FILE</span> <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>/tmp/ssh_key_<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-constant z-other z-groovy">UUID</span><span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">randomUUID</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">toString</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    stages <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Проверка доступности хоста (icmp и tcp)<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> check <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">sh</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy">                        <span class="z-constant z-other z-key z-groovy">script</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-block z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"""</span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                            ping -c 1 <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>address<span class="z-punctuation z-section z-embedded z-groovy">}</span></span> > /dev/null || exit 1
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                            nc -z <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>address<span class="z-punctuation z-section z-embedded z-groovy">}</span></span> <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>port<span class="z-punctuation z-section z-embedded z-groovy">}</span></span> || exit 2
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                        <span class="z-punctuation z-definition z-string z-end z-groovy">"""</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy">                        <span class="z-constant z-other z-key z-groovy">returnStatus</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-constant z-language z-groovy">true</span> <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> исключить завершение Pipeline с ошибкой
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy">                    <span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-keyword z-control z-groovy">if</span> (check <span class="z-keyword z-operator z-comparison z-groovy">==</span> <span class="z-constant z-numeric z-groovy">1</span>) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">error</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Сервер <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>address<span class="z-punctuation z-section z-embedded z-groovy">}</span></span> недоступен (icmp ping)<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span> <span class="z-keyword z-control z-groovy">else</span> <span class="z-keyword z-control z-groovy">if</span> (check <span class="z-keyword z-operator z-comparison z-groovy">==</span> <span class="z-constant z-numeric z-groovy">2</span>) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">error</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Порт <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>address<span class="z-punctuation z-section z-embedded z-groovy">}</span></span> закрыт (tcp check)<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span> <span class="z-keyword z-control z-groovy">else</span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Сервер <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>address<span class="z-punctuation z-section z-embedded z-groovy">}</span></span> доступен и порт <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>port<span class="z-punctuation z-section z-embedded z-groovy">}</span></span> открыт<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Извлечение данных для авторизации по ключу<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">withCredentials</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">sshUserPrivateKey</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">credentialsId</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>credentials<span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">usernameVariable</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>SSH_USER<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">keyFileVariable</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>SSH_KEY<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">passphraseVariable</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span><span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Записываем содержимое приватного ключа во временный файл
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">writeFile</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">file</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-storage z-type z-class z-groovy">env.SSH_KEY_FILE</span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">text</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">readFile</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-groovy">SSH_KEY</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        sh <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>chmod 600 <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">env.SSH_KEY_FILE</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        remote<span class="z-punctuation z-accessor z-dot z-groovy">.</span>name <span class="z-keyword z-operator z-assignment z-groovy">=</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>address
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        remote<span class="z-punctuation z-accessor z-dot z-groovy">.</span>host <span class="z-keyword z-operator z-assignment z-groovy">=</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>address
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        remote<span class="z-punctuation z-accessor z-dot z-groovy">.</span>port <span class="z-keyword z-operator z-assignment z-groovy">=</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>port<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">toInteger</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        remote<span class="z-punctuation z-accessor z-dot z-groovy">.</span>user <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-constant z-other z-groovy">SSH_USER</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        remote<span class="z-punctuation z-accessor z-dot z-groovy">.</span>identityFile <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-storage z-type z-class z-groovy">env.SSH_KEY_FILE</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        remote<span class="z-punctuation z-accessor z-dot z-groovy">.</span>allowAnyHosts <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-constant z-language z-groovy">true</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Запуск скрипта через через ssh<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> runCommand
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-keyword z-control z-groovy">if</span> (params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>root) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        runCommand <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-block z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"""</span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                            curl -sS https://raw.githubusercontent.com/Lifailon/hwstat/rsa/hwstat.sh | sudo bash -s -- "json" > "hwstat-report.json"
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                        <span class="z-punctuation z-definition z-string z-end z-groovy">"""</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span> <span class="z-keyword z-control z-groovy">else</span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        runCommand <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-block z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"""</span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                            curl -sS https://raw.githubusercontent.com/Lifailon/hwstat/rsa/hwstat.sh | bash -s -- "json" > "hwstat-report.json"
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                        <span class="z-punctuation z-definition z-string z-end z-groovy">"""</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> jsonOutput <span class="z-keyword z-operator z-assignment z-groovy">=</span> sshCommand <span class="z-constant z-other z-key z-groovy">remote</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> remote, <span class="z-constant z-other z-key z-groovy">command</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> runCommand
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-keyword z-control z-groovy">if</span> (params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>report) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Записать содержимое переменной в файл
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> writeFile file: 'hwstat-report.json', text: jsonOutput
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Загрузить файл из удаленной машины
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        sshGet <span class="z-constant z-other z-key z-groovy">remote</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> remote, <span class="z-constant z-other z-key z-groovy">from</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>hwstat-report.json<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>, <span class="z-constant z-other z-key z-groovy">into</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">env.WORKSPACE</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span>/hwstat-report.json<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>, <span class="z-constant z-other z-key z-groovy">override</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-constant z-language z-groovy">true</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    sshCommand <span class="z-constant z-other z-key z-groovy">remote</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> remote, <span class="z-constant z-other z-key z-groovy">command</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>rm hwstat-report.json<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Загрузка json отчета в Jenkins<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Проверка условия перед выполнением шага (пропуск если false)
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            when <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                expression <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>report <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                archiveArtifacts <span class="z-constant z-other z-key z-groovy">artifacts</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>hwstat-report.json<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>, <span class="z-constant z-other z-key z-groovy">allowEmptyArchive</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-constant z-language z-groovy">true</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    post <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Выполнять независимо от успеха или ошибки
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        always <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                sh <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>rm -f <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">env.SSH_KEY_FILE</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        success   <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Сборка завершена успешно<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span> <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        failure   <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Сборка завершилась с ошибкой<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span> <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        unstable  <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Сборка завершилась с предупреждениями<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span> <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        changed   <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Текущий статус завершения изменился по сравнению с предыдущим запуском<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span> <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        fixed     <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Сборка завершена успешно по сравнению с предыдущим запуском<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span> <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        aborted   <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Запуск был прерван<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span> <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></code></pre><h2 id=update-ssh-authorized-keys><a aria-label="Anchor link for: update-ssh-authorized-keys" class=zola-anchor href=#update-ssh-authorized-keys><i class=icon></i></a> Update SSH authorized_keys</h2><p>Добавляем логин и пароль для авторизации по ssh: <code>Manage (Settings)</code> => <code>Credentials</code> => <code>Global</code> => <code>Add credentials</code> => Kind: <code>Username with password</code><p>Сценарий обновляет параметр со списком текущих пользователей на машине и добавляет или заменяет ssh ключ для выбранного пользователя:<pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> remote <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>:<span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span><span class="z-source z-groovy">
</span><span class="z-source z-groovy">pipeline <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    agent any
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    parameters <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>address<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>192.168.3.101<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Адрес удаленного сервера<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>port<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>22<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Порт ssh<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>credentials<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>15d05be6-682a-472b-9c1d-cf5080e98170<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Идентификатор учетных данных из Jenkins<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">booleanParam</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>getUsers<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-constant z-language z-groovy">true</span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Получить список текущих пользователей системы<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>sshKey<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span><span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Открытый ssh ключ для добавления в authorized_keys<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">booleanParam</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>rewriteKey<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-constant z-language z-groovy">false</span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Перезаписать текущие ключи в файле authorized_keys<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    stages <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Извлекаем параметры для авторизации по ssh<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">withCredentials</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">usernamePassword</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">credentialsId</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>credentials<span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">usernameVariable</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>SSH_USER<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">passwordVariable</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>SSH_PASS<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        remote<span class="z-punctuation z-accessor z-dot z-groovy">.</span>name <span class="z-keyword z-operator z-assignment z-groovy">=</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>address
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        remote<span class="z-punctuation z-accessor z-dot z-groovy">.</span>host <span class="z-keyword z-operator z-assignment z-groovy">=</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>address
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        remote<span class="z-punctuation z-accessor z-dot z-groovy">.</span>port <span class="z-keyword z-operator z-assignment z-groovy">=</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>port<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">toInteger</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        remote<span class="z-punctuation z-accessor z-dot z-groovy">.</span>user <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-storage z-type z-class z-groovy">env.SSH_USER</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        remote<span class="z-punctuation z-accessor z-dot z-groovy">.</span>password <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-storage z-type z-class z-groovy">env.SSH_PASS</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        remote<span class="z-punctuation z-accessor z-dot z-groovy">.</span>allowAnyHosts <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-constant z-language z-groovy">true</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Обновить список пользователей<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            when <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                expression <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>getUsers <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> mainCommand <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>echo <span class="z-constant z-character z-escape z-groovy">\$</span>(ls /home)<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> users <span class="z-keyword z-operator z-assignment z-groovy">=</span> sshCommand <span class="z-constant z-other z-key z-groovy">remote</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> remote, <span class="z-constant z-other z-key z-groovy">command</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> mainCommand
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> usersList <span class="z-keyword z-operator z-assignment z-groovy">=</span> users<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">trim</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">split</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-constant z-character z-escape z-groovy">\\</span>s<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    usersList <span class="z-keyword z-operator z-arithmetic z-groovy">+</span><span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>root<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> usersListChoice <span class="z-keyword z-operator z-assignment z-groovy">=</span> usersList<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">toList</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    writeFile <span class="z-constant z-other z-key z-groovy">file</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>user_list.txt<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>, <span class="z-constant z-other z-key z-groovy">text</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> usersList<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">join</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-constant z-character z-escape z-groovy">\\</span>s<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">properties</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy">                        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">parameters</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>
</span></span></span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy">                            <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>address<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>address<span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Адрес удаленного сервера<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy">                            <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>port<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>port<span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Порт ssh<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy">                            <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>credentials<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>credentials<span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Идентификатор учетных данных из Jenkins<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy">                            <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">booleanParam</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>getUsers<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>getUsers<span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Получить список текущих пользователей системы<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy">                            <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>sshKey<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span><span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Открытый ssh ключ для добавления в authorized_keys<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy">                            <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">booleanParam</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>rewriteKey<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-constant z-language z-groovy">false</span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Перезаписать текущие ключи в файле authorized_keys<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span></span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy">                            <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">choice</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span>
</span></span></span></span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy">                                <span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>userList<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span>
</span></span></span></span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy">                                <span class="z-constant z-other z-key z-groovy">choices</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> usersListChoice<span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span>
</span></span></span></span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy">                                <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Выбрать пользователя<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>
</span></span></span></span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy">                            <span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy">                        <span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-structure z-groovy">                    <span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Добавить новый SSH ключ<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            when <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                expression <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> <span class="z-keyword z-operator z-logical z-groovy">!</span>params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>getUsers <span class="z-keyword z-operator z-logical z-groovy">&&</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>sshKey <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> selectedUser <span class="z-keyword z-operator z-assignment z-groovy">=</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>userList
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> sshKey <span class="z-keyword z-operator z-assignment z-groovy">=</span> params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>sshKey
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-keyword z-control z-groovy">if</span> (selectedUser <span class="z-keyword z-operator z-comparison z-groovy">==</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>root<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        path <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>/root/.ssh/authorized_keys<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span> <span class="z-keyword z-control z-groovy">else</span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        path<span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>/home/<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>selectedUser<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>/.ssh/authorized_keys<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-keyword z-control z-groovy">if</span> (params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>rewriteKey) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Обновляем все SSH ключи для пользователя: <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>selectedUser<span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        teeCommand <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>tee<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span> <span class="z-keyword z-control z-groovy">else</span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Добавляем новый SSH ключ для пользователя: <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>selectedUser<span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        teeCommand <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>tee -a<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> mainCommand <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-block z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"""</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                        checkFile=<span class="z-constant z-character z-escape z-groovy">\$</span>(ls <span class="z-variable z-other z-interpolated z-groovy">$path</span> 2> /dev/null || echo false)
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                        if [ <span class="z-constant z-character z-escape z-groovy">\$</span>checkFile == "false" ]; then
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                            mkdir -p <span class="z-constant z-character z-escape z-groovy">\$</span>(dirname <span class="z-variable z-other z-interpolated z-groovy">$path</span>) && touch <span class="z-variable z-other z-interpolated z-groovy">$path</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                        fi
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                        echo <span class="z-variable z-other z-interpolated z-groovy">$sshKey</span> | <span class="z-variable z-other z-interpolated z-groovy">$teeCommand</span> <span class="z-variable z-other z-interpolated z-groovy">$path</span> > /dev/null
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                    <span class="z-punctuation z-definition z-string z-end z-groovy">"""</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    sshCommand <span class="z-constant z-other z-key z-groovy">remote</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> remote, <span class="z-constant z-other z-key z-groovy">command</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> mainCommand
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></code></pre><h2 id=upload-file-parameter><a aria-label="Anchor link for: upload-file-parameter" class=zola-anchor href=#upload-file-parameter><i class=icon></i></a> Upload File Parameter</h2><p>Установить плагин <a href=https://plugins.jenkins.io/file-parameters>File Parameter</a><p>Передача файла через параметр и чтение его содержимого:<pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy">pipeline <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    agent any
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    parameters <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        base64File <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>UPLOAD_FILE<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    stages <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Читаем содержимое файла<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Переменная хранит содержимое файла в формате base64
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> echo UPLOAD_FILE
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Декодируем base64
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">withFileParameter</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>UPLOAD_FILE<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    sh <span class="z-string z-quoted z-double z-block z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"""</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                        echo <span class="z-variable z-other z-interpolated z-groovy">$UPLOAD_FILE</span> # создается временный файл: /var/jenkins_home/workspace/UploadFile@tmp/UPLOAD_FILE16070415400310343819.tmp
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                        ls -lah "<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-constant z-other z-groovy">WORKSPACE</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span>" # загружается два файла: large и myFile.txt
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                        cat "<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-constant z-other z-groovy">WORKSPACE</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span>/large" # аналогично: cat <span class="z-variable z-other z-interpolated z-groovy">$UPLOAD_FILE</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                    <span class="z-punctuation z-definition z-string z-end z-groovy">"""</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></code></pre><h2 id=input-text-and-file><a aria-label="Anchor link for: input-text-and-file" class=zola-anchor href=#input-text-and-file><i class=icon></i></a> Input Text and File</h2><p>Останавливает выполнение <code>Pipeline</code> и заставляет пользователя передать текстовый параметр и файл:<pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy">pipeline <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    agent any
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    stages <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Input text<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            input <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                message <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Что бы продолжить, передайте текст в поле ввода<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                ok <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Передать<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                parameters <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>TEXT<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>test<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Введите текст<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Переданный текст в параметре input: <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-constant z-other z-groovy">TEXT</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Input file<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> fileBase64 <span class="z-keyword z-operator z-assignment z-groovy">=</span> input <span class="z-constant z-other z-key z-groovy">message</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Передайте файл<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>, <span class="z-constant z-other z-key z-groovy">parameters</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">base64File</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>file<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    sh <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>echo <span class="z-variable z-other z-interpolated z-groovy">$fileBase64</span> | base64 -d<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></code></pre><h2 id=httpurlconnection><a aria-label="Anchor link for: httpurlconnection" class=zola-anchor href=#httpurlconnection><i class=icon></i></a> HttpURLConnection</h2><p>Любой код Groovy возможно запустить и проверить через <code>Script Console</code> (http://127.0.0.1:8080/manage/script)<p>Пример <code>API</code> запроса к репозиторию PowerShell на GitHub для получения последней версии и всех доступных версий:<pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy"><span class="z-meta z-import z-groovy"><span class="z-keyword z-other z-import z-groovy">import</span> <span class="z-storage z-type z-import z-groovy">groovy.json.JsonSlurper
</span></span></span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> url <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-constant z-other z-groovy">URL</span>(<span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>https://api.github.com/repos/PowerShell/PowerShell/tags<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>)
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> connection <span class="z-keyword z-operator z-assignment z-groovy">=</span> url<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">openConnection</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy">connection<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">setRequestMethod</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>GET<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy">connection<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">setRequestProperty</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Accept<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> responseCode <span class="z-keyword z-operator z-assignment z-groovy">=</span> connection<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">getResponseCode</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy"><span class="z-keyword z-control z-groovy">if</span> (responseCode <span class="z-keyword z-operator z-comparison z-groovy">==</span> <span class="z-constant z-numeric z-groovy">200</span>) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Получаем данные ответа
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-storage z-type z-def z-groovy">def</span> response <span class="z-keyword z-operator z-assignment z-groovy">=</span> connection<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">getInputStream</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">getText</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Парсим JSON ответ
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-storage z-type z-def z-groovy">def</span> jsonSlurper <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-storage z-type z-class z-groovy">JsonSlurper</span>()
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-storage z-type z-def z-groovy">def</span> tags <span class="z-keyword z-operator z-assignment z-groovy">=</span> jsonSlurper<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">parseText</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span>response<span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Проверяем количество элементов в массиве
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-keyword z-control z-groovy">if</span> (tags<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">size</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-keyword z-operator z-comparison z-groovy">></span> <span class="z-constant z-numeric z-groovy">0</span>) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Забираем последний тег из списка
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-storage z-type z-def z-groovy">def</span> latestTag <span class="z-keyword z-operator z-assignment z-groovy">=</span> tags<span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-constant z-numeric z-groovy">0</span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span>name
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-support z-function z-print z-groovy">println</span>(<span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Latest version: <span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span> <span class="z-keyword z-operator z-arithmetic z-groovy">+</span> latestTag)
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-support z-function z-print z-groovy">println</span>()
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Проходимся по всем тегам
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-support z-function z-print z-groovy">println</span>(<span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>List of all versions:<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>)
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-keyword z-control z-groovy">for</span> (tag in tags) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-support z-function z-print z-groovy">println</span>(tag<span class="z-punctuation z-accessor z-dot z-groovy">.</span>name)
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span> <span class="z-keyword z-control z-groovy">else</span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">error</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>No tags found in the response<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span> <span class="z-keyword z-control z-groovy">else</span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">error</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Failed to call API, response code: <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>responseCode<span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy">connection<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">disconnect</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></code></pre><h2 id=active-choices-parameter><a aria-label="Anchor link for: active-choices-parameter" class=zola-anchor href=#active-choices-parameter><i class=icon></i></a> Active Choices Parameter</h2><p>Плагин <a href=https://plugins.jenkins.io/uno-choice>Active Choices</a> позволяет динамически обновлять содержимое параметров.<p>Пример выбора репозитория, получения списка доступных версий и содержимого файлов выбранного релиза.<ul><li><ol><li>Active Choices Parameter</ol></ul><p>Name: <code>Repos</code><p>Groovy Script:<pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy"><span class="z-keyword z-control z-groovy">return</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-structure z-groovy">    <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Lifailon/lazyjournal<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-structure z-groovy">    <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>jesseduffield/lazydocker<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span></code></pre><ul><li><ol start=2><li>Active Choices Reactive Parameter</ol></ul><p>Name: <code>Versions</code><p>Groovy Script:<pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy"><span class="z-meta z-import z-groovy"><span class="z-keyword z-other z-import z-groovy">import</span> <span class="z-storage z-type z-import z-groovy">groovy.json.JsonSlurper
</span></span></span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> selectedRepo <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-storage z-type z-class z-groovy">Repos</span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> apiUrl <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>https://api.github.com/repos/<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>selectedRepo<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>/tags<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> conn <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-constant z-other z-groovy">URL</span>(apiUrl)<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">openConnection</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy">conn<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">setRequestProperty</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>User-Agent<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Jenkins<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> response <span class="z-keyword z-operator z-assignment z-groovy">=</span> conn<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">getInputStream</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">getText</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> json <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-storage z-type z-class z-groovy">JsonSlurper</span>()<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">parseText</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span>response<span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> versionsCount <span class="z-keyword z-operator z-assignment z-groovy">=</span> json<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">size</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> data <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span><span class="z-source z-groovy"><span class="z-keyword z-control z-groovy">for</span> (<span class="z-storage z-type z-primitive z-groovy">int</span> i <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-constant z-numeric z-groovy">0</span>; i <span class="z-keyword z-operator z-comparison z-groovy"><</span> versionsCount; i<span class="z-keyword z-operator z-increment-decrement z-groovy">++</span>) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    data <span class="z-keyword z-operator z-arithmetic z-groovy">+</span><span class="z-keyword z-operator z-assignment z-groovy">=</span> json<span class="z-punctuation z-accessor z-dot z-groovy">.</span>name<span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>i<span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy"><span class="z-keyword z-control z-groovy">return</span> data
</span></code></pre><p>Настройки параметров: Choice Type: <code>Single Select</code> Привязать параметр <code>Repos</code> из <code>Active Choices</code> в <code>Reactive Parameter</code> через <code>Referenced parameters</code> Включить фильтрацию через <code>Enable filters</code><ul><li><ol start=3><li>Active Choices Reactive Parameter</ol></ul><p>Name: <code>Files</code><p>Groovy Script:<pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy"><span class="z-meta z-import z-groovy"><span class="z-keyword z-other z-import z-groovy">import</span> <span class="z-storage z-type z-import z-groovy">groovy.json.JsonSlurper
</span></span></span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> selectedRepo <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-storage z-type z-class z-groovy">Repos</span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> selectedVer <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-storage z-type z-class z-groovy">Versions</span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> apiUrl <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>https://api.github.com/repos/<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>selectedRepo<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>/releases/tags/<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>selectedVer<span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> conn <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-constant z-other z-groovy">URL</span>(apiUrl)<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">openConnection</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy">conn<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">setRequestProperty</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>User-Agent<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Jenkins<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> response <span class="z-keyword z-operator z-assignment z-groovy">=</span> conn<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">getInputStream</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">getText</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> json <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-storage z-type z-class z-groovy">JsonSlurper</span>()<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">parseText</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span>response<span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> data <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span><span class="z-source z-groovy"><span class="z-keyword z-control z-groovy">for</span> (file in json<span class="z-punctuation z-accessor z-dot z-groovy">.</span>assets) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    data <span class="z-keyword z-operator z-arithmetic z-groovy">+</span><span class="z-keyword z-operator z-assignment z-groovy">=</span> file<span class="z-punctuation z-accessor z-dot z-groovy">.</span>name
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy"><span class="z-keyword z-control z-groovy">return</span> data
</span></code></pre><p>Referenced parameters: <code>Repos,Versions</code><p>Pipeline script:<pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy">pipeline <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    agent any
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    stages <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Selected parameters<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Selected repository: https://github.com/<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">params.Repos</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Selected version: <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">params.Versions</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Selected file: <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">params.Files</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Url for download: https://github.com/<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">params.Repos</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span>/releases/download/<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">params.Versions</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span>/<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">params.Files</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></code></pre><h2 id=vault><a aria-label="Anchor link for: vault" class=zola-anchor href=#vault><i class=icon></i></a> Vault</h2><p>Интеграция <a href=https://github.com/hashicorp/vault>HashiCorp Vault</a> в Jenkins Pipeline для получения содержимого секретов и использовая в последующих стадиях/этапах сборки:<pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy"><span class="z-meta z-definition z-method z-groovy"><span class="z-storage z-type z-return-type z-def z-groovy">def</span> <span class="z-entity z-name z-function z-groovy">getVaultSecrets</span><span class="z-punctuation z-definition z-parameters z-begin z-groovy">(</span><span class="z-meta z-definition z-method z-parameters z-groovy">
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-definition z-method z-groovy"><span class="z-meta z-definition z-method z-parameters z-groovy"><span class="z-meta z-definition z-method z-parameter z-groovy">    <span class="z-storage z-type z-parameter z-groovy">String</span> <span class="z-variable z-parameter z-groovy">address</span></span><span class="z-punctuation z-definition z-parameters z-separator z-groovy">,</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-definition z-method z-groovy"><span class="z-meta z-definition z-method z-parameters z-groovy"><span class="z-meta z-definition z-method z-parameter z-groovy">    <span class="z-storage z-type z-parameter z-groovy">String</span> <span class="z-variable z-parameter z-groovy">path</span></span><span class="z-punctuation z-definition z-parameters z-separator z-groovy">,</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-definition z-method z-groovy"><span class="z-meta z-definition z-method z-parameters z-groovy"><span class="z-meta z-definition z-method z-parameter z-groovy">    <span class="z-storage z-type z-parameter z-groovy">String</span> <span class="z-variable z-parameter z-groovy">token</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-definition z-method z-groovy"><span class="z-meta z-definition z-method z-parameters z-groovy"></span><span class="z-punctuation z-definition z-parameters z-end z-groovy">)</span> {</span>
</span><span class="z-source z-groovy">    <span class="z-storage z-type z-def z-groovy">def</span> url <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-constant z-other z-groovy">URL</span>(<span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>address<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>/<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>path<span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>)
</span><span class="z-source z-groovy">    
</span><span class="z-source z-groovy">    <span class="z-storage z-type z-def z-groovy">def</span> connection <span class="z-keyword z-operator z-assignment z-groovy">=</span> url<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">openConnection</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy">    connection<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">setRequestMethod</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>GET<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy">    connection<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">setRequestProperty</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>X-Vault-Token<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> token<span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy">    connection<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">setRequestProperty</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Accept<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy">    
</span><span class="z-source z-groovy">    <span class="z-storage z-type z-def z-groovy">def</span> response <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-storage z-type z-class z-groovy">groovy.json.JsonSlurper</span>()<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">parse</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span>connection<span class="z-punctuation z-accessor z-dot z-groovy">.</span>inputStream<span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span><span class="z-source z-groovy">    <span class="z-storage z-type z-def z-groovy">def</span> user <span class="z-keyword z-operator z-assignment z-groovy">=</span> response<span class="z-punctuation z-accessor z-dot z-groovy">.</span>data<span class="z-punctuation z-accessor z-dot z-groovy">.</span>data<span class="z-punctuation z-accessor z-dot z-groovy">.</span>user
</span><span class="z-source z-groovy">    <span class="z-storage z-type z-def z-groovy">def</span> password <span class="z-keyword z-operator z-assignment z-groovy">=</span> response<span class="z-punctuation z-accessor z-dot z-groovy">.</span>data<span class="z-punctuation z-accessor z-dot z-groovy">.</span>data<span class="z-punctuation z-accessor z-dot z-groovy">.</span>password
</span><span class="z-source z-groovy">    <span class="z-keyword z-control z-groovy">return</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-structure z-groovy">        <span class="z-constant z-other z-key z-groovy">user</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> user<span class="z-punctuation z-definition z-separator z-groovy">,</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-structure z-groovy">        <span class="z-constant z-other z-key z-groovy">password</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> password
</span></span><span class="z-source z-groovy"><span class="z-meta z-structure z-groovy">    <span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span><span class="z-source z-groovy">}
</span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> <span class="z-constant z-other z-groovy">USER_NAME</span>
</span><span class="z-source z-groovy"><span class="z-storage z-type z-def z-groovy">def</span> <span class="z-constant z-other z-groovy">USER_PASS</span>
</span><span class="z-source z-groovy">
</span><span class="z-source z-groovy">pipeline <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    agent any
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    parameters <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>url<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>http://192.168.3.100:8200<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Url адресс хранилища секретов<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>path<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>v1/kv/data/ssh-auth<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Путь для извлечения секретов<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">password</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>token<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>hvs.tsIHLCcDEZ1lM1KiTdhqA0N3<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Токен доступа к API HashiCorp Vault<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    stages <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Get vault secrets<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> secrets <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">getVaultSecrets</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy">                        <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>url<span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy">                        <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>path<span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy">                        <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>token<span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-method-call z-groovy">                    <span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-constant z-other z-groovy">USER_NAME</span> <span class="z-keyword z-operator z-assignment z-groovy">=</span> secrets<span class="z-punctuation z-accessor z-dot z-groovy">.</span>user
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-constant z-other z-groovy">USER_PASS</span> <span class="z-keyword z-operator z-assignment z-groovy">=</span> secrets<span class="z-punctuation z-accessor z-dot z-groovy">.</span>password
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Use secrets<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>User: <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-constant z-other z-groovy">USER_NAME</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>Password: <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-constant z-other z-groovy">USER_PASS</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></code></pre><h2 id=email-extension><a aria-label="Anchor link for: email-extension" class=zola-anchor href=#email-extension><i class=icon></i></a> Email Extension</h2><p>Установить расширение <a href=https://plugins.jenkins.io/email-ext>Email Extension</a> для отправки на почту и настроить SMTP сервер в настройках Jenkins (<code>System</code> => <code>Extended E-mail Notification</code>)<p>SMTP server: <code>smtp.yandex.ru</code> SMTP port: <code>587</code> Credentials: <code>Username with password</code> (<code>username@yandex.ru</code> и <code>app-password</code>) <code>Use TLS</code> Default Content Type: <code>HTML (text/html)</code><p>Настройка логирования в System Log: <code>emailDebug</code> + фильтр <code>hudson.plugins.emailext</code> и уровень <code>ALL</code><pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy">pipeline <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    agent any
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    parameters <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">string</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">name</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>emailTo<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">defaultValue</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>test@yandex.ru<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">description</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Почтовый адрес назначения<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    stages <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Вывод всех переменных окружения<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    env<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">getEnvironment</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span><span class="z-punctuation z-accessor z-dot z-groovy">.</span>each <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> key, value <span class="z-keyword z-operator z-arrow z-groovy">-></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>key<span class="z-punctuation z-section z-embedded z-groovy">}</span></span> = <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>value<span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Отправка на почту<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            options <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">timeout</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-other z-key z-groovy">time</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-constant z-numeric z-groovy">1</span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">unit</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>MINUTES<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    emailext (
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-constant z-other z-key z-groovy">to</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span>	<span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>params<span class="z-punctuation z-accessor z-dot z-groovy">.</span>emailTo<span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>,
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-constant z-other z-key z-groovy">subject</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">env.JOB_NAME</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span> - <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-constant z-other z-groovy">BUILD_NUMBER</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>,
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-constant z-other z-key z-groovy">mimeType</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>text/html<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>,
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-constant z-other z-key z-groovy">body</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-string z-quoted z-double z-block z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"""</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                            &LThtml>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                                &LTbody>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                                    &LTdiv style="padding-left: 30px; padding-bottom: 15px;" color="blue">
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                                    &LTfont name="Arial" color="#906090" size="3" font-weight="normal">
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                                        &LTb> <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">env.JOB_NAME</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span> - <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">env.BUILD_NUMBER</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span> &LT/b>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                                    &LT/font>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                                    &LTbr>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                                    &LTdiv style="padding-left: 30px; padding-bottom: 15px;" color="black">
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                                    &LTbr>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                                    &LTfont name="Arial" color="black" size="2" font-weight="normal"> 
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                                        &LTpre> Build url: <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-storage z-type z-class z-groovy">env.BUILD_URL</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span> &LT/pre>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                                    &LT/font>	
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                                &LT/body>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                            &LT/html>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">                        <span class="z-punctuation z-definition z-string z-end z-groovy">"""</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    )
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></code></pre><h2 id=parallel><a aria-label="Anchor link for: parallel" class=zola-anchor href=#parallel><i class=icon></i></a> Parallel</h2><pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy">pipeline <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    agent any
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    stages <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Parallel sleeps<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            parallel <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Task 1<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            <span class="z-storage z-type z-def z-groovy">def</span> currentTime <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-storage z-type z-class z-groovy">Date</span>()<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">format</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>yyyy-MM-dd HH:mm:ss<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>[<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>currentTime<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>] Начало задачи 1<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            sh <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>sleep 10<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            currentTime <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-storage z-type z-class z-groovy">Date</span>()<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">format</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>yyyy-MM-dd HH:mm:ss<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>[<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>currentTime<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>] Завершение задачи 1<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Task 2<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            <span class="z-storage z-type z-def z-groovy">def</span> currentTime <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-storage z-type z-class z-groovy">Date</span>()<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">format</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>yyyy-MM-dd HH:mm:ss<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>[<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>currentTime<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>] Начало задачи 2<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            sh <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>sleep 5<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            currentTime <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-storage z-type z-class z-groovy">Date</span>()<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">format</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>yyyy-MM-dd HH:mm:ss<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>[<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>currentTime<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>] Завершение задачи 2<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">stage</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Parallel tasks via loop<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            steps <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                script <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Массив, где ключи содержит имя задачи, а значение содержит блоки кода для выполнения
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> tasks <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>:<span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-storage z-type z-def z-groovy">def</span> taskNames <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Task 1<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Task 2<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-separator z-groovy">,</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Task 3<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    taskNames<span class="z-punctuation z-accessor z-dot z-groovy">.</span>each <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> taskName <span class="z-keyword z-operator z-arrow z-groovy">-></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        tasks<span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>taskName<span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span> <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            <span class="z-storage z-type z-def z-groovy">def</span> currentTime <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-storage z-type z-class z-groovy">Date</span>()<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">format</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>yyyy-MM-dd HH:mm:ss<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>[<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>currentTime<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>] Начало задачи: <span class="z-variable z-other z-interpolated z-groovy">$taskName</span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            sh <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>sleep <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>taskName <span class="z-keyword z-operator z-comparison z-groovy">==</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Task 1<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span> <span class="z-meta z-evaluation z-ternary z-groovy"><span class="z-keyword z-operator z-ternary z-groovy">?</span> <span class="z-constant z-numeric z-groovy">10</span> <span class="z-keyword z-operator z-ternary z-expression-separator z-groovy">:</span> taskName <span class="z-keyword z-operator z-comparison z-groovy">==</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>Task 2<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span> <span class="z-meta z-evaluation z-ternary z-groovy"><span class="z-keyword z-operator z-ternary z-groovy">?</span> <span class="z-constant z-numeric z-groovy">5</span> <span class="z-keyword z-operator z-ternary z-expression-separator z-groovy">:</span> <span class="z-constant z-numeric z-groovy">3</span></span></span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            currentTime <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-keyword z-other z-new z-groovy">new</span> <span class="z-storage z-type z-class z-groovy">Date</span>()<span class="z-punctuation z-accessor z-dot z-groovy">.</span><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">format</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>yyyy-MM-dd HH:mm:ss<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                            echo <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>[<span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>currentTime<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>] Завершение задачи: <span class="z-variable z-other z-interpolated z-groovy">$taskName</span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                    parallel tasks
</span></span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">                <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">            <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span></code></pre><h2 id=groovy><a aria-label="Anchor link for: groovy" class=zola-anchor href=#groovy><i class=icon></i></a> Groovy</h2><p>Базовый синтаксис языка <code>Groovy</code><pre class="language-Groovy z-code" data-lang=Groovy><code class=language-Groovy data-lang=Groovy><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Переменные
</span></span><span class="z-source z-groovy">javaString <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>java<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span>
</span><span class="z-source z-groovy">javaString
</span><span class="z-source z-groovy"><span class="z-support z-function z-print z-groovy">println</span> javaString
</span><span class="z-source z-groovy">javaString<span class="z-punctuation z-accessor z-dot z-groovy">.</span>class    <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> class java.lang.String
</span></span><span class="z-source z-groovy"><span class="z-support z-function z-print z-groovy">println</span> <span class="z-constant z-numeric z-groovy">100.</span>class   <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> class java.lang.Integer
</span></span><span class="z-source z-groovy">j <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-single z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">'</span>${javaString}<span class="z-punctuation z-definition z-string z-end z-groovy">'</span></span> <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> не принимает переменные в одинарных кавычках
</span></span><span class="z-source z-groovy">groovyString <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>javaString<span class="z-punctuation z-section z-embedded z-groovy">}</span></span><span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span><span class="z-source z-groovy">bigGroovyString <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-block z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"""</span>
</span></span><span class="z-source z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">    <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>javaString<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">    <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>j<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">    <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>groovyString<span class="z-punctuation z-section z-embedded z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-string z-quoted z-double z-block z-groovy">    <span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span><span class="z-constant z-numeric z-groovy">2</span> <span class="z-keyword z-operator z-arithmetic z-groovy">+</span> <span class="z-constant z-numeric z-groovy">2</span><span class="z-punctuation z-section z-embedded z-groovy">}</span></span>
</span></span><span class="z-source z-groovy"><span class="z-string z-quoted z-double z-block z-groovy"><span class="z-punctuation z-definition z-string z-end z-groovy">"""</span></span>
</span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> java
</span></span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> ${javaString}
</span></span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> java
</span></span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> 4
</span></span><span class="z-source z-groovy">
</span><span class="z-source z-groovy">a <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>a<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>   <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> a
</span></span><span class="z-source z-groovy">a <span class="z-keyword z-operator z-arithmetic z-groovy">+</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>123<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span> <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> a123
</span></span><span class="z-source z-groovy">a <span class="z-keyword z-operator z-arithmetic z-groovy">*</span> <span class="z-constant z-numeric z-groovy">5</span>     <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> aaaaa
</span></span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Массивы и списки
</span></span><span class="z-source z-groovy">list <span class="z-keyword z-operator z-assignment z-groovy">=</span><span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-constant z-numeric z-groovy">1</span><span class="z-punctuation z-definition z-separator z-groovy">,</span><span class="z-constant z-numeric z-groovy">2</span><span class="z-punctuation z-definition z-separator z-groovy">,</span><span class="z-constant z-numeric z-groovy">3</span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span><span class="z-source z-groovy">list<span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-constant z-numeric z-groovy">0</span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>    <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> 1
</span></span><span class="z-source z-groovy">list<span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-constant z-numeric z-groovy">0</span><span class="z-keyword z-operator z-range z-groovy">..</span><span class="z-constant z-numeric z-groovy">1</span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span> <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> [1, 2]
</span></span><span class="z-source z-groovy">range <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>0123456789<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span><span class="z-source z-groovy">range<span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-constant z-numeric z-groovy">1</span><span class="z-keyword z-operator z-range z-groovy">..</span><span class="z-constant z-numeric z-groovy">5</span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span> <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> 12345
</span></span><span class="z-source z-groovy">map <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-constant z-other z-key z-groovy">key1</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-constant z-language z-groovy">true</span><span class="z-punctuation z-definition z-separator z-groovy">,</span> <span class="z-constant z-other z-key z-groovy">key2</span><span class="z-punctuation z-definition z-separator z-key-value z-groovy">:</span> <span class="z-constant z-language z-groovy">false</span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span><span class="z-source z-groovy">map<span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span><span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>key1<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span><span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span> <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> true
</span></span><span class="z-source z-groovy">server <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-meta z-structure z-groovy"><span class="z-punctuation z-definition z-structure z-begin z-groovy">[</span>:<span class="z-punctuation z-definition z-structure z-end z-groovy">]</span></span>
</span><span class="z-source z-groovy">server<span class="z-punctuation z-accessor z-dot z-groovy">.</span>ip <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span>192.168.3.1<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>
</span><span class="z-source z-groovy">server<span class="z-punctuation z-accessor z-dot z-groovy">.</span>port <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-constant z-numeric z-groovy">22</span>
</span><span class="z-source z-groovy"><span class="z-support z-function z-print z-groovy">println</span>(server) <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> [ip:192.168.3.1, port:22]
</span></span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Функции
</span></span><span class="z-source z-groovy"><span class="z-meta z-definition z-method z-groovy"><span class="z-storage z-type z-return-type z-def z-groovy">def</span> <span class="z-entity z-name z-function z-groovy">sum</span><span class="z-punctuation z-definition z-parameters z-begin z-groovy">(</span><span class="z-meta z-definition z-method z-parameters z-groovy"><span class="z-meta z-definition z-method z-parameter z-groovy"><span class="z-variable z-parameter z-groovy">a</span></span><span class="z-punctuation z-definition z-parameters z-separator z-groovy">,</span><span class="z-meta z-definition z-method z-parameter z-groovy"><span class="z-variable z-parameter z-groovy">b</span></span></span><span class="z-punctuation z-definition z-parameters z-end z-groovy">)</span> {</span>
</span><span class="z-source z-groovy">    <span class="z-support z-function z-print z-groovy">println</span> a<span class="z-keyword z-operator z-arithmetic z-groovy">+</span>b
</span><span class="z-source z-groovy">}
</span><span class="z-source z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">sum</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-numeric z-groovy">2</span><span class="z-punctuation z-definition z-separator z-parameter z-groovy">,</span><span class="z-constant z-numeric z-groovy">2</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> 4
</span></span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Условия
</span></span><span class="z-source z-groovy"><span class="z-meta z-definition z-method z-groovy"><span class="z-storage z-type z-return-type z-def z-groovy">def</span> <span class="z-entity z-name z-function z-groovy">diff</span><span class="z-punctuation z-definition z-parameters z-begin z-groovy">(</span><span class="z-meta z-definition z-method z-parameters z-groovy"><span class="z-meta z-definition z-method z-parameter z-groovy"><span class="z-variable z-parameter z-groovy">x</span></span></span><span class="z-punctuation z-definition z-parameters z-end z-groovy">)</span> {</span>
</span><span class="z-source z-groovy">    <span class="z-keyword z-control z-groovy">if</span> (x <span class="z-keyword z-operator z-comparison z-groovy"><</span> <span class="z-constant z-numeric z-groovy">10</span>) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-support z-function z-print z-groovy">println</span>(<span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>x<span class="z-punctuation z-section z-embedded z-groovy">}</span></span> < 10<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>)
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span> <span class="z-keyword z-control z-groovy">else</span> <span class="z-keyword z-control z-groovy">if</span> (x <span class="z-keyword z-operator z-comparison z-groovy">==</span> <span class="z-constant z-numeric z-groovy">10</span>) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-support z-function z-print z-groovy">println</span>(<span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>x<span class="z-punctuation z-section z-embedded z-groovy">}</span></span> = 10<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>)
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span> <span class="z-keyword z-control z-groovy">else</span> <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">        <span class="z-support z-function z-print z-groovy">println</span>(<span class="z-string z-quoted z-double z-groovy"><span class="z-punctuation z-definition z-string z-begin z-groovy">"</span><span class="z-source z-groovy z-embedded z-source"><span class="z-punctuation z-section z-embedded z-groovy">${</span>x<span class="z-punctuation z-section z-embedded z-groovy">}</span></span> > 10<span class="z-punctuation z-definition z-string z-end z-groovy">"</span></span>)
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy">}
</span><span class="z-source z-groovy"><span class="z-meta z-method-call z-groovy"><span class="z-meta z-method z-groovy">diff</span><span class="z-punctuation z-definition z-method-parameters z-begin z-groovy">(</span><span class="z-constant z-numeric z-groovy">11</span><span class="z-punctuation z-definition z-method-parameters z-end z-groovy">)</span></span> <span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> 11 > 10
</span></span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> Циклы
</span></span><span class="z-source z-groovy">list<span class="z-punctuation z-accessor z-dot z-groovy">.</span>each <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> l <span class="z-keyword z-operator z-arrow z-groovy">-></span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-support z-function z-print z-groovy">print</span> l
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> 123
</span></span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-keyword z-control z-groovy">for</span> (i in <span class="z-constant z-numeric z-groovy">0</span><span class="z-keyword z-operator z-range z-groovy">..</span><span class="z-constant z-numeric z-groovy">5</span>) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span> 
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-support z-function z-print z-groovy">print</span> i
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> 012345
</span></span><span class="z-source z-groovy">
</span><span class="z-source z-groovy"><span class="z-keyword z-control z-groovy">for</span> (<span class="z-storage z-type z-primitive z-groovy">int</span> i <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-constant z-numeric z-groovy">0</span>; i <span class="z-keyword z-operator z-comparison z-groovy"><</span> <span class="z-constant z-numeric z-groovy">10</span>; i<span class="z-keyword z-operator z-increment-decrement z-groovy">++</span>) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-support z-function z-print z-groovy">print</span> i
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> 0123456789
</span></span><span class="z-source z-groovy">
</span><span class="z-source z-groovy">i <span class="z-keyword z-operator z-assignment z-groovy">=</span> <span class="z-constant z-numeric z-groovy">0</span>
</span><span class="z-source z-groovy"><span class="z-keyword z-control z-groovy">while</span> (i <span class="z-keyword z-operator z-comparison z-groovy"><</span> <span class="z-constant z-numeric z-groovy">3</span>) <span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-begin z-groovy">{</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    <span class="z-support z-function z-print z-groovy">println</span>(i)
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy">    i<span class="z-keyword z-operator z-increment-decrement z-groovy">++</span>
</span></span><span class="z-source z-groovy"><span class="z-meta z-block z-groovy"><span class="z-punctuation z-section z-block z-end z-groovy">}</span></span>
</span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> 0
</span></span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> 1
</span></span><span class="z-source z-groovy"><span class="z-comment z-line z-double-slash z-groovy"><span class="z-punctuation z-definition z-comment z-groovy">//</span> 2
</span></span></code></pre><span class=hidden id=copy-code-text>Copy Code</span><span class=hidden id=search-index>https://lifailon.github.io/search_index.en.json</span><span class=hidden id=more-matches-text>$MATCHES more matches</span></main><footer id=site-footer><nav><ul><li><a href=https://lifailon.github.io/powershell/>PowerShell</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/golang/>GoLang</a><li><a href=https://lifailon.github.io/node-js/>Node.js</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/windowsserver/>Windows Server</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/api/>API</a><li><a class=active href=https://lifailon.github.io/jenkins/>Jenkins</a><li><a href=https://lifailon.github.io/devops/>DevOps</a></ul></nav><p>© <strong>2023-2025</strong> <code>Lifailon</code><p><a class=external href=https://github.com/Lifailon/PS-Commands>Website source</a><p><small>Powered by <a class="link external" href=https://www.getzola.org>Zola</a> and <a class="link external" href=https://duckquill.daudix.one>Duckquill</a> </small><ul id=socials><li><a rel=" me" href=https://github.com/lifailon/PS-Commands title=GitHub> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34)" class=icon></i> <span>GitHub</span> </a><li><a rel=" me" href=https://www.nuget.org/profiles/Lifailon title=NuGet> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ENUGet%3C/title%3E%3Cpath d='M1.57 0A1.57 1.57 0 000 1.57v20.86A1.57 1.57 0 001.57 24h20.86A1.57 1.57 0 0024 22.43V1.57A1.57 1.57 0 0022.43 0zM7.5 1.5A2.5 2.5 0 0110 4a2.5 2.5 0 01-2.5 2.5A2.5 2.5 0 015 4a2.5 2.5 0 012.5-2.5zM12 6h9v12h-1.5a3.76 3.76 0 00-2.81-1.25A3.76 3.76 0 0012.5 20a3.76 3.76 0 002.19 3.25A3.76 3.76 0 0018.5 24H21V6z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>NuGet</span> </a><li><a rel=" me" href=https://www.npmjs.com/~lifailon title=NPM> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ENPM%3C/title%3E%3Cpath d='M0 0v24h24V0zm14.74 14.74h-3.66v-5.5h-1.83v5.5H5.5V5.5h9.24z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>NPM</span> </a><li><a rel=" me" title="Docker Hub" href=https://hub.docker.com/u/lifailon> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EDocker%3C/title%3E%3Cpath d='M22.149 10.74c-.111-.086-1.15-.86-3.3-.86-.26.002-.52.017-.78.045-.24-1.35-1.32-1.8-1.35-1.81l-.45-.17-.3.42c-.17.24-.65.88-.65 1.76.001.29.04.58.12.86-.66.19-1.3.35-1.95.48a9.72 9.72 0 0 1-1.95.22H.75c-.41 0-.75.34-.75.75 0 4.42 2.4 5.98 4.41 6.68.9.28 1.91.42 3.01.42 1.08 0 2.11-.14 3.01-.42 1.98-.61 3.51-2.01 4.14-4.01.34.04.68.07 1.02.07 1.35 0 2.61-.35 3.72-1.04 1.64-1.01 1.87-2.23 1.87-2.92.01-.96-.34-1.68-.35-1.7zM6.75 8.22h2.25c.14 0 .25-.11.25-.25V6.47c0-.14-.11-.25-.25-.25H6.75c-.14 0-.25.11-.25.25v1.5c0 .14.11.25.25.25zM12 8.22h2.25c.14 0 .25-.11.25-.25V6.47c0-.14-.11-.25-.25-.25H12c-.14 0-.25.11-.25.25v1.5c0 .14.11.25.25.25zM9.375 6.72h-2.25c-.14 0-.25.11-.25.25v1.5c0 .14.11.25.25.25h2.25c.14 0 .25-.11.25-.25v-1.5c0-.14-.11-.25-.25-.25zM12 5.47h-2.25c-.14 0-.25.11-.25.25v1.5c0 .14.11.25.25.25H12c.14 0 .25-.11.25-.25v-1.5c0-.14-.11-.25-.25-.25z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>Docker Hub</span> </a></ul></footer>