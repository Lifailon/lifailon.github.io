<!DOCTYPE html>
<html lang="en-us">
    <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="generator" content="Hugo 0.123.8">

    

    

    
        
            <meta
                name="description"
                content="Large base of PowerShell notes in Russian language" />
        

        
            <meta
                name="keywords"
                content="PowerShell" />
        

        
            <meta name="author" content="Lifailon" />
        

    


    <title>
        
            Component Object Model |
            Lifailon.GitHub.io
        
    </title>

    


    
    

    
    


    
    


    
    


    
    

    


    
    

    

    

        
        


        
        


        <link
            rel="stylesheet"
            href="/css/index_d751713.min.912d03bce61461ecbc3ca083479e1ed814bba94df76d0bdc6aa88fdca33621b9bb410dc2c81af31e8101fec62decfa5f6e48901ad673bc5056d2f1d1f2368a34.css"
            integrity="sha512-kS0DvOYUYey8PKCDR54e2BS7qU33bQvcaqiP3KM2Ibm7QQ3CyBrzHoEB/sYt7PpfbkiQGtZzvFBW0vHR8jaKNA==" />
    


    
    

    

    

    

    
</head>



    <body>
        <header class="header">
    <div class="header_left">
        
    </div>

    <div class="header_middle">
        
            Component Object Model -
            Lifailon.GitHub.io
        
    </div>
</header>



        <main>
            <aside class="sidebar">
    



    
    

    
    


    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/powershell/" title="./powershell/">
                        PowerShell
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/dotnet/" title="./dotnet/">
                        .NET
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/activedirectory/" title="./activedirectory/">
                        Active Directory
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/ansible/" title="./ansible/">
                        Ansible
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/apps/" title="./apps/">
                        Apps
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/com/" title="./com/">
                        Component Object Model
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/git/" title="./git/">
                        Git
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/html/" title="./html/">
                        HTML
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/influxdb/" title="./influxdb/">
                        InfluxDB
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/exchange/" title="./exchange/">
                        MS Exchange
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/mssql/" title="./mssql/">
                        MS SQL
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/mysql/" title="./mysql/">
                        MySQL
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/network/" title="./network/">
                        Network
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/api/" title="./api/">
                        REST API
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/virtualization/" title="./virtualization/">
                        Virtualization
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/wmi/" title="./wmi/">
                        WMI
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/zabbix/" title="./zabbix/">
                        Zabbix
                    </a>
                </li>
            
        
    </ul>


</aside>
<aside class="exapandable"></aside>


            
    <article class="main">
        <button
    class="sidebar-toggle-btn"
    type="menu"
    aria-expanded="false"
    aria-haspopup="true">
    <i class="bi bi-list"></i>
</button>



        <div class="title">
            <h1 class="title-header">
                Component Object Model
            </h1>

            <div class="author-date-readtime">
                

                    
                        <div class="author" title="Author">
                            <i class="bi bi-person"></i>
                            <a
                                href="/author/lifailon/"
                                class="cat-btn">
                                Lifailon
                            </a>
                        </div>
                    

                

                
                    <div class="date" title="Date">
                        <i class="bi bi-calendar3"></i>
                        <time
                            datetime="Mar 14 2024"
                            >Mar 14 2024
                        </time>
                    </div>
                

                
                    <div
                        class="readtime"
                        title="Time to Read">
                        <i class="bi bi-clock"></i>
                        3 mins to read
                    </div>
                
            </div>
        </div>

        <div class="article-meta">
            

            

            
                <div class="breadcumb">
                    <i class="bi bi-folder"></i>
                    
    




<a href="https://lifailon.github.io/" class="bread-btn">
    
        <i class="bi bi-house-fill"></i>
    

    
        Home
    
</a>




    /



<a href="https://lifailon.github.io/com/" class="bread-btn">
    

    
        Component Object Model
    
</a>

                </div>
            

            
        </div>

        
            <nav id="TableOfContents">
  <ul>
    <li><a href="#ie">IE</a></li>
    <li><a href="#shell">Shell</a></li>
    <li><a href="#sendkeys">SendKeys</a></li>
    <li><a href="#popup">Popup</a></li>
    <li><a href="#network">Network</a></li>
    <li><a href="#application">Application</a></li>
    <li><a href="#outlook">Outlook</a></li>
    <li><a href="#update">Update</a></li>
    <li><a href="#excel">Excel</a>
      <ul>
        <li><a href="#excelapplicationopen">Excel.Application.Open</a></li>
        <li><a href="#importexcel">ImportExcel</a></li>
      </ul>
    </li>
  </ul>
</nav>
        


        <div class="content">
            
                <h2 id="ie">IE</h2>
<p><code>$ie.document.IHTMLDocument3_getElementsByTagName(&quot;input&quot;)  | select name</code> получить имена всех Input Box <br>
<code>$ie.document.IHTMLDocument3_getElementsByTagName(&quot;button&quot;) | select innerText</code> получить имена всех Button <br>
<code>$ie.Document.documentElement.innerHTML</code> прочитать сырой Web Content (&lt;input name=&ldquo;login&rdquo; tabindex=&ldquo;100&rdquo; class=&ldquo;input__control input__input&rdquo; id=&ldquo;uniq32005644019429136&rdquo; spellcheck=&ldquo;false&rdquo; placeholder=&ldquo;Логин&rdquo;) <br>
<code>$All_Elements = $ie.document.IHTMLDocument3_getElementsByTagName(&quot;*&quot;)</code> забрать все элементы <br>
<code>$Go_Button = $All_Elements | ? innerText -like &quot;go&quot;</code> поиск элемента по имени <br>
<code>$Go_Button | select ie9_tagName</code> получить TagName (SPAN) для быстрого дальнейшего поиска <br>
<code>$SPAN_Elements = $ie.document.IHTMLDocument3_getElementsByTagName(&quot;SPAN&quot;)</code></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$ie = New-Object -ComObject InternetExplorer.Application
</span></span><span style="display:flex;"><span>$ie.navigate(<span style="color:#e6db74">&#34;https://yandex.ru&#34;</span>)
</span></span><span style="display:flex;"><span>$ie.visible = $true
</span></span><span style="display:flex;"><span>$ie.document.IHTMLDocument3_getElementByID(<span style="color:#e6db74">&#34;login&#34;</span>).value = <span style="color:#e6db74">&#34;Login&#34;</span>
</span></span><span style="display:flex;"><span>$ie.document.IHTMLDocument3_getElementByID(<span style="color:#e6db74">&#34;passwd&#34;</span>).value = <span style="color:#e6db74">&#34;Password&#34;</span>
</span></span><span style="display:flex;"><span>$Button_Auth = ($ie.document.IHTMLDocument3_getElementsByTagName(<span style="color:#e6db74">&#34;button&#34;</span>)) | ? innerText <span style="color:#f92672">-match</span> <span style="color:#e6db74">&#34;Войти&#34;</span>
</span></span><span style="display:flex;"><span>$Button_Auth.Click()
</span></span><span style="display:flex;"><span>$Result = $ie.Document.documentElement.innerHTML
</span></span><span style="display:flex;"><span>$ie.Quit()</span></span></code></pre></div>
    
</div>
<h2 id="shell">Shell</h2>
<p><code>$wshell = New-Object -ComObject Wscript.Shell</code> <br>
<code>$wshell | Get-Member</code> <br>
<code>$link = $wshell.CreateShortcut(&quot;$Home\Desktop\Yandex.lnk&quot;)</code> создать ярлык <br>
<code>$link | Get-Member</code> <br>
<code>$link.TargetPath = &quot;https://yandex.ru&quot;</code> куда ссылается (метод TargetPath объекта $link где хранится объект CreateShortcut) <br>
<code>$link.Save()</code> сохранить</p>
<p><code>Set-WinUserLanguageList -LanguageList en-us,ru -Force</code> изменить языковую раскладку клавиатуры</p>
<h2 id="sendkeys">SendKeys</h2>
<p><code>(New-Object -ComObject Wscript.shell).SendKeys([char]173)</code> включить/выключить звук <br>
<code>$wshell.Exec(&quot;notepad.exe&quot;)</code> запустить приложение <br>
<code>$wshell.AppActivate(&quot;Блокнот&quot;)</code> развернуть запущенное приложение</p>
<p><code>$wshell.SendKeys(&quot;Login&quot;)</code> текст <br>
<code>$wshell.SendKeys(&quot;{A 5}&quot;)</code> напечатать букву 5 раз подряд <br>
<code>$wshell.SendKeys(&quot;%{TAB}&quot;)</code> ALT+TAB <br>
<code>$wshell.SendKeys(&quot;^&quot;)</code> CTRL <br>
<code>$wshell.SendKeys(&quot;%&quot;)</code> ALT <br>
<code>$wshell.SendKeys(&quot;+&quot;)</code> SHIFT <br>
<code>$wshell.SendKeys(&quot;{DOWN}&quot;)</code> вниз <br>
<code>$wshell.SendKeys(&quot;{UP}&quot;)</code> вверх <br>
<code>$wshell.SendKeys(&quot;{LEFT}&quot;)</code> влево <br>
<code>$wshell.SendKeys(&quot;{RIGHT}&quot;)</code> вправо <br>
<code>$wshell.SendKeys(&quot;{PGUP}&quot;)</code> PAGE UP <br>
<code>$wshell.SendKeys(&quot;{PGDN}&quot;)</code> PAGE DOWN <br>
<code>$wshell.SendKeys(&quot;{BACKSPACE}&quot;)</code> BACKSPACE/BKSP/BS <br>
<code>$wshell.SendKeys(&quot;{DEL}&quot;)</code> DEL/DELETE <br>
<code>$wshell.SendKeys(&quot;{INS}&quot;)</code> INS/INSERT <br>
<code>$wshell.SendKeys(&quot;{PRTSC}&quot;)</code> PRINT SCREEN <br>
<code>$wshell.SendKeys(&quot;{ENTER}&quot;)</code> <br>
<code>$wshell.SendKeys(&quot;{ESC}&quot;)</code> <br>
<code>$wshell.SendKeys(&quot;{TAB}&quot;)</code> <br>
<code>$wshell.SendKeys(&quot;{END}&quot;)</code> <br>
<code>$wshell.SendKeys(&quot;{HOME}&quot;)</code> <br>
<code>$wshell.SendKeys(&quot;{BREAK}&quot;)</code> <br>
<code>$wshell.SendKeys(&quot;{SCROLLLOCK}&quot;)</code> <br>
<code>$wshell.SendKeys(&quot;{CAPSLOCK}&quot;)</code> <br>
<code>$wshell.SendKeys(&quot;{NUMLOCK}&quot;)</code> <br>
<code>$wshell.SendKeys(&quot;{F1}&quot;)</code> <br>
<code>$wshell.SendKeys(&quot;{F12}&quot;)</code> <br>
<code>$wshell.SendKeys(&quot;{+}{^}{%}{~}{(}{)}{[}{]}{{}{}}&quot;)</code></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="function%20Get-AltTab%20%7b%0d%0a%28New-Object%20-ComObject%20wscript.shell%29.SendKeys%28%22%25%7bTab%7d%22%29%0d%0aStart-Sleep%20$%28Get-Random%20-Minimum%2030%20-Maximum%20180%29%0d%0aGet-AltTab%0d%0a%7d%0d%0aGet-AltTab">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Get-AltTab {
</span></span><span style="display:flex;"><span>(New-Object -ComObject wscript.shell).SendKeys(<span style="color:#e6db74">&#34;%{Tab}&#34;</span>)
</span></span><span style="display:flex;"><span>Start-Sleep $(Get-Random -Minimum <span style="color:#ae81ff">30</span> -Maximum <span style="color:#ae81ff">180</span>)
</span></span><span style="display:flex;"><span>Get-AltTab
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>Get-AltTab</span></span></code></pre></div>
    
</div>
<h2 id="popup">Popup</h2>
<p><code>$wshell = New-Object -ComObject Wscript.Shell</code> <br>
<code>$output = $wshell.Popup(&quot;Выберите действие?&quot;,0,&quot;Заголовок&quot;,4)</code> <br>
<code>if ($output -eq 6) {&quot;yes&quot;} elseif ($output -eq 7) {&quot;no&quot;} else {&quot;no good&quot;}</code></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <pre><code>Type:
0 ОК
1 ОК и Отмена
2 Стоп, Повтор, Пропустить
3 Да, Нет, Отмена
4 Да и Нет
5 Повтор и Отмена
16 Stop
32 Question
48 Exclamation
64 Information

Output:
-1 Timeout
1 ОК
2 Отмена
3 Стоп
4 Повтор
5 Пропустить
6 Да
7 Нет</code></pre>
    
</div>
<h2 id="network">Network</h2>
<p><code>$wshell = New-Object -ComObject WScript.Network</code> <br>
<code>$wshell | Get-Member</code> <br>
<code>$wshell.UserName</code> <br>
<code>$wshell.ComputerName</code> <br>
<code>$wshell.UserDomain</code></p>
<h2 id="application">Application</h2>
<p><code>$wshell = New-Object -ComObject Shell.Application</code> <br>
<code>$wshell | Get-Member</code> <br>
<code>$wshell.Explore(&quot;C:\&quot;)</code> <br>
<code>$wshell.Windows() | Get-Member</code> получить доступ к открытым в проводнике или браузере Internet Explorer окон</p>
<p><code>$shell = New-Object -Com Shell.Application</code> <br>
<code>$RecycleBin = $shell.Namespace(10)</code> <br>
<code>$RecycleBin.Items()</code></p>
<h2 id="outlook">Outlook</h2>
<p><code>$Outlook = New-Object -ComObject Outlook.Application</code> <br>
<code>$Outlook | Get-Member</code> <br>
<code>$Outlook.Version</code></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$Outlook%20=%20New-Object%20-ComObject%20Outlook.Application%0d%0a$Namespace%20=%20$Outlook.GetNamespace%28%22MAPI%22%29%0d%0a$Folder%20=%20$namespace.GetDefaultFolder%284%29%60%20%d0%b8%d1%81%d1%85%d0%be%d0%b4%d1%8f%d1%89%d0%b8%d0%b5%0d%0a$Folder%20=%20$namespace.GetDefaultFolder%286%29%60%20%d0%b2%d1%85%d0%be%d0%b4%d1%8f%d1%89%d0%b8%d0%b5%0d%0a$Explorer%20=%20$Folder.GetExplorer%28%29%0d%0a$Explorer.Display%28%29%09%0d%0a$Outlook.Quit%28%29">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$Outlook = New-Object -ComObject Outlook.Application
</span></span><span style="display:flex;"><span>$Namespace = $Outlook.GetNamespace(<span style="color:#e6db74">&#34;MAPI&#34;</span>)
</span></span><span style="display:flex;"><span>$Folder = $namespace.GetDefaultFolder(<span style="color:#ae81ff">4</span>)` исходящие
</span></span><span style="display:flex;"><span>$Folder = $namespace.GetDefaultFolder(<span style="color:#ae81ff">6</span>)` входящие
</span></span><span style="display:flex;"><span>$Explorer = $Folder.GetExplorer()
</span></span><span style="display:flex;"><span>$Explorer.Display()	
</span></span><span style="display:flex;"><span>$Outlook.Quit()</span></span></code></pre></div>
    
</div>
<h2 id="update">Update</h2>
<p><code>(New-Object -com 'Microsoft.Update.AutoUpdate').Settings</code> <br>
<code>(New-Object -com 'Microsoft.Update.AutoUpdate').Results</code> <br>
<code>(New-Timespan -Start ((New-Object -com 'Microsoft.Update.AutoUpdate').Results|Select -ExpandProperty LastInstallationSuccessDate) -End (Get-Date)).hours</code> кол-во часов, прошедших с последней даты установки обновления безопасности в Windows.</p>
<h2 id="excel">Excel</h2>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$path = <span style="color:#e6db74">&#34;</span>$home<span style="color:#e6db74">\Desktop\Services-to-Excel.xlsx&#34;</span>
</span></span><span style="display:flex;"><span>$Excel = New-Object -ComObject Excel.Application
</span></span><span style="display:flex;"><span>$Excel.Visible = $false` отключить открытие GUI
</span></span><span style="display:flex;"><span>$ExcelWorkBook = $Excel.Workbooks.Add()` Создать книгу
</span></span><span style="display:flex;"><span>$ExcelWorkSheet = $ExcelWorkBook.Worksheets.Item(<span style="color:#ae81ff">1</span>)` Создать лист
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Name = <span style="color:#e6db74">&#34;Services&#34;</span>` задать имя листа
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Cells.Item(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>) = <span style="color:#e6db74">&#34;Name service&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Задать имена столбцов:</span>
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Cells.Item(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>) = <span style="color:#e6db74">&#34;Description&#34;</span>
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Cells.Item(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>) = <span style="color:#e6db74">&#34;Status&#34;</span>
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Cells.Item(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">4</span>) = <span style="color:#e6db74">&#34;Startup type&#34;</span>
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Rows.Item(<span style="color:#ae81ff">1</span>).Font.Bold = $true` выделить жирным шрифтом
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Rows.Item(<span style="color:#ae81ff">1</span>).Font.size=<span style="color:#ae81ff">14</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Задать ширину колонок:</span>
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Columns.Item(<span style="color:#ae81ff">1</span>).ColumnWidth=<span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Columns.Item(<span style="color:#ae81ff">2</span>).ColumnWidth=<span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Columns.Item(<span style="color:#ae81ff">3</span>).ColumnWidth=<span style="color:#ae81ff">15</span>
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Columns.Item(<span style="color:#ae81ff">4</span>).ColumnWidth=<span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span>$services =  Get-Service
</span></span><span style="display:flex;"><span>$counter = <span style="color:#ae81ff">2</span>` задать начальный номер строки для записи
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span> ($service <span style="color:#66d9ef">in</span> $services) {
</span></span><span style="display:flex;"><span>$status = $service.Status
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($status <span style="color:#f92672">-eq</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>$status_type = <span style="color:#e6db74">&#34;Stopped&#34;</span>
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">elseif</span> ($status <span style="color:#f92672">-eq</span> <span style="color:#ae81ff">4</span>) {
</span></span><span style="display:flex;"><span>$status_type = <span style="color:#e6db74">&#34;Running&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$Start = $service.StartType
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($Start <span style="color:#f92672">-eq</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>$start_type = <span style="color:#e6db74">&#34;Delayed start&#34;</span>
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">elseif</span> ($Start <span style="color:#f92672">-eq</span> <span style="color:#ae81ff">2</span>) {
</span></span><span style="display:flex;"><span>$start_type = <span style="color:#e6db74">&#34;Automatic&#34;</span>
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">elseif</span> ($Start <span style="color:#f92672">-eq</span> <span style="color:#ae81ff">3</span>) {
</span></span><span style="display:flex;"><span>$start_type = <span style="color:#e6db74">&#34;Manually&#34;</span>
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">elseif</span> ($Start <span style="color:#f92672">-eq</span> <span style="color:#ae81ff">4</span>) {
</span></span><span style="display:flex;"><span>$start_type = <span style="color:#e6db74">&#34;Disabled&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Columns.Item(<span style="color:#ae81ff">1</span>).Rows.Item($counter) = $service.Name
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Columns.Item(<span style="color:#ae81ff">2</span>).Rows.Item($counter) = $service.DisplayName
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Columns.Item(<span style="color:#ae81ff">3</span>).Rows.Item($counter) = $status_type
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Columns.Item(<span style="color:#ae81ff">4</span>).Rows.Item($counter) = $start_type
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($status_type <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;Running&#34;</span>) {
</span></span><span style="display:flex;"><span>$ExcelWorkSheet.Columns.Item(<span style="color:#ae81ff">3</span>).Rows.Item($counter).Font.Bold = $true
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$counter++` <span style="color:#ae81ff">+1</span> увеличить для счетчика строки Rows
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$ExcelWorkBook.SaveAs($path)
</span></span><span style="display:flex;"><span>$ExcelWorkBook.close($true)
</span></span><span style="display:flex;"><span>$Excel.Quit()</span></span></code></pre></div>
    
</div>
<h3 id="excelapplicationopen">Excel.Application.Open</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$path%20=%20%22$home%5cDesktop%5cServices-to-Excel.xlsx%22%0d%0a$Excel%20=%20New-Object%20-ComObject%20Excel.Application%0d%0a$Excel.Visible%20=%20$false%0d%0a$ExcelWorkBook%20=%20$excel.Workbooks.Open%28$path%29%60%20%d0%be%d1%82%d0%ba%d1%80%d1%8b%d1%82%d1%8c%20xlsx-%d1%84%d0%b0%d0%b9%d0%bb%0d%0a$ExcelWorkBook.Sheets%20%7c%20select%20Name,Index%60%20%d0%be%d1%82%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%b8%d1%82%d1%8c%20%d0%bb%d0%b8%d1%81%d1%82%d1%8b%0d%0a$ExcelWorkSheet%20=%20$ExcelWorkBook.Sheets.Item%281%29%60%20%d0%be%d1%82%d0%ba%d1%80%d1%8b%d1%82%d1%8c%20%d0%bb%d0%b8%d1%81%d1%82%20%d0%bf%d0%be%20%d0%bd%d0%be%d0%bc%d0%b5%d1%80%d1%83%20Index%0d%0a1..100%20%7c%20%25%7b$ExcelWorkSheet.Range%28%22A$_%22%29.Text%7d%60%20%d0%bf%d1%80%d0%be%d1%87%d0%b8%d1%82%d0%b0%d1%82%d1%8c%20%d0%b7%d0%bd%d0%b0%d1%87%d0%b5%d0%bd%d0%b8%d0%b5%20%d0%b8%d0%b7%20%d1%81%d1%82%d0%be%d0%bb%d0%b1%d1%86%d0%b0%20%d0%90%20%d1%81%d1%82%d1%80%d0%be%d0%ba%d0%b8%20c%201%20%d0%bf%d0%be%20100%0d%0a$Excel.Quit%28%29">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$path = <span style="color:#e6db74">&#34;</span>$home<span style="color:#e6db74">\Desktop\Services-to-Excel.xlsx&#34;</span>
</span></span><span style="display:flex;"><span>$Excel = New-Object -ComObject Excel.Application
</span></span><span style="display:flex;"><span>$Excel.Visible = $false
</span></span><span style="display:flex;"><span>$ExcelWorkBook = $excel.Workbooks.Open($path)` открыть xlsx-файл
</span></span><span style="display:flex;"><span>$ExcelWorkBook.Sheets | select Name,Index` отобразить листы
</span></span><span style="display:flex;"><span>$ExcelWorkSheet = $ExcelWorkBook.Sheets.Item(<span style="color:#ae81ff">1</span>)` открыть лист по номеру Index
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>.<span style="color:#ae81ff">.100</span> | %{$ExcelWorkSheet.Range(<span style="color:#e6db74">&#34;A</span>$_<span style="color:#e6db74">&#34;</span>).Text}` прочитать значение из столбца А строки c <span style="color:#ae81ff">1</span> по <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>$Excel.Quit()</span></span></code></pre></div>
    
</div>
<h3 id="importexcel">ImportExcel</h3>
<p><code>Install-Module -Name ImportExcel</code> <br>
<code>$data | Export-Excel .\Data.xlsx</code> <br>
<code>$data = Import-Excel .\Data.xlsx</code></p>
<p><code>$data = ps</code> <br>
<code>$Chart = New-ExcelChartDefinition -XRange CPU -YRange WS -Title &quot;Process&quot; -NoLegend</code> <br>
<code>$data | Export-Excel .\ps.xlsx -AutoNameRange -ExcelChartDefinition $Chart -Show</code></p>

            
        </div>
    </article>

        </main>

        <footer class="footer">
    <div class="footer-left">
        <ul class="social">
            
                <li>GitHub</li>
            

            
                <li>Lifailon</li>
            

            
                
            
                
            
                
                    <li>
                        
                            <a href="https://github.com/Lifailon" target="_blank">
                                <i class="bi-github"></i>
                            </a>
                        

                    </li>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </ul>
    </div>

    <div class="footer-right">
        <ul class="control status clearfix">
            

            
            

            

            
                <li>
                    <a href="https://gohugo.io" class="btn" target="_blank"
                        >Hugo: 0.123.8</a
                    >
                </li>
            

            
                <li>
                    <a
                        href="https://github.com/JingWangTW/dark-theme-editor"
                        class="btn"
                        target="_blank"
                        >Theme: dark-theme-editor</a
                    >
                </li>
            

            
                <li>
                    
                        Last modified: &nbsp;
                        <time>
                            Mar 14 2024
                        </time>
                    
                </li>
            

            
        </ul>
    </div>
</footer>

    </body>

    























    
    


    
    


    <script
        type="text/javascript"
        src="/js/index_d751713.min.5eeb120f16ea146352725c420364f87befead45f678142b8f0ffbef024646931fbc06bff07a7bd6cb57fa2f8cd8a21ba6a4ee5a278ec32303a378bc1cd17f246.js"
        integrity="sha512-XusSDxbqFGNSclxCA2T4e&#43;/q1F9ngUK48P&#43;&#43;8CRkaTH7wGv/B6e9bLV/ovjNiiG6ak7lonjsMjA6N4vBzRfyRg=="></script>














<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />




</html>
