
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Lifailon">
      
      
        <link rel="canonical" href="https://lifailon.github.io/Syntax/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../FileSystem/">
      
      
      <link rel="icon" href="../Logo/PS-Commands-logo-x256.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.20">
    
    
      
        <title>Syntax - PowerShell Commands</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CInter:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Inter"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/obsidian.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cheat-sheet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PowerShell Commands" class="md-header__button md-logo" aria-label="PowerShell Commands" data-md-component="logo">
      
  <img src="../Logo/PS-Commands-logo-x256.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PowerShell Commands
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Syntax
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Lifailon/PS-Commands" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PowerShell Commands" class="md-nav__button md-logo" aria-label="PowerShell Commands" data-md-component="logo">
      
  <img src="../Logo/PS-Commands-logo-x256.png" alt="logo">

    </a>
    PowerShell Commands
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Lifailon/PS-Commands" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Syntax
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Syntax
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cheat-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Cheat Sheet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#help" class="md-nav__link">
    <span class="md-ellipsis">
      Help
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#object" class="md-nav__link">
    <span class="md-ellipsis">
      Object
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Object">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#variable" class="md-nav__link">
    <span class="md-ellipsis">
      Variable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#env" class="md-nav__link">
    <span class="md-ellipsis">
      ENV
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#history" class="md-nav__link">
    <span class="md-ellipsis">
      History
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clipboard" class="md-nav__link">
    <span class="md-ellipsis">
      Clipboard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-host" class="md-nav__link">
    <span class="md-ellipsis">
      Write-Host
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-progress" class="md-nav__link">
    <span class="md-ellipsis">
      Write-Progress
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for" class="md-nav__link">
    <span class="md-ellipsis">
      for
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array" class="md-nav__link">
    <span class="md-ellipsis">
      Array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    <span class="md-ellipsis">
      Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashtable" class="md-nav__link">
    <span class="md-ellipsis">
      HashTable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collectionslist" class="md-nav__link">
    <span class="md-ellipsis">
      Collections/List
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pscustomobject" class="md-nav__link">
    <span class="md-ellipsis">
      PSCustomObject
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-and-remove-property" class="md-nav__link">
    <span class="md-ellipsis">
      Add and Remove Property
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-method" class="md-nav__link">
    <span class="md-ellipsis">
      Add Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class" class="md-nav__link">
    <span class="md-ellipsis">
      Class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Pipeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-object" class="md-nav__link">
    <span class="md-ellipsis">
      Select-Object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expression" class="md-nav__link">
    <span class="md-ellipsis">
      Expression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-string" class="md-nav__link">
    <span class="md-ellipsis">
      Select-String
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format-listformat-table" class="md-nav__link">
    <span class="md-ellipsis">
      Format-List/Format-Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measure-object" class="md-nav__link">
    <span class="md-ellipsis">
      Measure-Object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare-object" class="md-nav__link">
    <span class="md-ellipsis">
      Compare-Object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-object" class="md-nav__link">
    <span class="md-ellipsis">
      Where-Object (?)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sort-object" class="md-nav__link">
    <span class="md-ellipsis">
      Sort-Object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lastfirst" class="md-nav__link">
    <span class="md-ellipsis">
      Last/First
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-object" class="md-nav__link">
    <span class="md-ellipsis">
      Group-Object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#property" class="md-nav__link">
    <span class="md-ellipsis">
      Property
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method" class="md-nav__link">
    <span class="md-ellipsis">
      Method
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error" class="md-nav__link">
    <span class="md-ellipsis">
      Error
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executionstatus" class="md-nav__link">
    <span class="md-ellipsis">
      ExecutionStatus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measure-command" class="md-nav__link">
    <span class="md-ellipsis">
      Measure-Command
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datetime" class="md-nav__link">
    <span class="md-ellipsis">
      DateTime
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timespan" class="md-nav__link">
    <span class="md-ellipsis">
      TimeSpan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimeSpan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#format" class="md-nav__link">
    <span class="md-ellipsis">
      Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timer" class="md-nav__link">
    <span class="md-ellipsis">
      Timer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regex" class="md-nav__link">
    <span class="md-ellipsis">
      Regex
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Regex">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      Якори
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      Группы захвата
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matches" class="md-nav__link">
    <span class="md-ellipsis">
      Matches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#net-method-format" class="md-nav__link">
    <span class="md-ellipsis">
      Форматирование (.NET method format)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      Условный оператор
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      Логические операторы сравнения
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Pipeline Operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#invocation-operator" class="md-nav__link">
    <span class="md-ellipsis">
      Invocation Operator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datatype" class="md-nav__link">
    <span class="md-ellipsis">
      DataType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DataType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#math" class="md-nav__link">
    <span class="md-ellipsis">
      Math
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#round" class="md-nav__link">
    <span class="md-ellipsis">
      Round
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tostring" class="md-nav__link">
    <span class="md-ellipsis">
      ToString
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#char" class="md-nav__link">
    <span class="md-ellipsis">
      Char
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switch-function" class="md-nav__link">
    <span class="md-ellipsis">
      Switch function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switch-param" class="md-nav__link">
    <span class="md-ellipsis">
      Switch param
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bit" class="md-nav__link">
    <span class="md-ellipsis">
      Bit
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bit-convertor" class="md-nav__link">
    <span class="md-ellipsis">
      Bit Convertor
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cycle" class="md-nav__link">
    <span class="md-ellipsis">
      Cycle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#foreach" class="md-nav__link">
    <span class="md-ellipsis">
      Foreach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#foreach-object" class="md-nav__link">
    <span class="md-ellipsis">
      ForEach-Object (%)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#while" class="md-nav__link">
    <span class="md-ellipsis">
      While
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#try-catch-finally" class="md-nav__link">
    <span class="md-ellipsis">
      Try-Catch-Finally
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#out-gridview" class="md-nav__link">
    <span class="md-ellipsis">
      Out-Gridview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#out-file" class="md-nav__link">
    <span class="md-ellipsis">
      Out-File
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-content-gccattype" class="md-nav__link">
    <span class="md-ellipsis">
      Get-Content (gc/cat/type)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aes-key" class="md-nav__link">
    <span class="md-ellipsis">
      AES Key
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../FileSystem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File System
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Threads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threads
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dotNET/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    .NET
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../COM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    COM
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ServerManager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Manager
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ActiveDirectory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active Directory
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exchange/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microsoft Exchange
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Virtualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtualization
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ansible/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ansible
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Zabbix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zabbix
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../DevOps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DevOps
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cheat-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Cheat Sheet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#help" class="md-nav__link">
    <span class="md-ellipsis">
      Help
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#object" class="md-nav__link">
    <span class="md-ellipsis">
      Object
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Object">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#variable" class="md-nav__link">
    <span class="md-ellipsis">
      Variable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#env" class="md-nav__link">
    <span class="md-ellipsis">
      ENV
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#history" class="md-nav__link">
    <span class="md-ellipsis">
      History
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clipboard" class="md-nav__link">
    <span class="md-ellipsis">
      Clipboard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-host" class="md-nav__link">
    <span class="md-ellipsis">
      Write-Host
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-progress" class="md-nav__link">
    <span class="md-ellipsis">
      Write-Progress
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for" class="md-nav__link">
    <span class="md-ellipsis">
      for
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array" class="md-nav__link">
    <span class="md-ellipsis">
      Array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    <span class="md-ellipsis">
      Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashtable" class="md-nav__link">
    <span class="md-ellipsis">
      HashTable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collectionslist" class="md-nav__link">
    <span class="md-ellipsis">
      Collections/List
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pscustomobject" class="md-nav__link">
    <span class="md-ellipsis">
      PSCustomObject
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-and-remove-property" class="md-nav__link">
    <span class="md-ellipsis">
      Add and Remove Property
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-method" class="md-nav__link">
    <span class="md-ellipsis">
      Add Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class" class="md-nav__link">
    <span class="md-ellipsis">
      Class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Pipeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-object" class="md-nav__link">
    <span class="md-ellipsis">
      Select-Object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expression" class="md-nav__link">
    <span class="md-ellipsis">
      Expression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-string" class="md-nav__link">
    <span class="md-ellipsis">
      Select-String
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format-listformat-table" class="md-nav__link">
    <span class="md-ellipsis">
      Format-List/Format-Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measure-object" class="md-nav__link">
    <span class="md-ellipsis">
      Measure-Object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare-object" class="md-nav__link">
    <span class="md-ellipsis">
      Compare-Object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-object" class="md-nav__link">
    <span class="md-ellipsis">
      Where-Object (?)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sort-object" class="md-nav__link">
    <span class="md-ellipsis">
      Sort-Object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lastfirst" class="md-nav__link">
    <span class="md-ellipsis">
      Last/First
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-object" class="md-nav__link">
    <span class="md-ellipsis">
      Group-Object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#property" class="md-nav__link">
    <span class="md-ellipsis">
      Property
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method" class="md-nav__link">
    <span class="md-ellipsis">
      Method
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error" class="md-nav__link">
    <span class="md-ellipsis">
      Error
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executionstatus" class="md-nav__link">
    <span class="md-ellipsis">
      ExecutionStatus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measure-command" class="md-nav__link">
    <span class="md-ellipsis">
      Measure-Command
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datetime" class="md-nav__link">
    <span class="md-ellipsis">
      DateTime
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timespan" class="md-nav__link">
    <span class="md-ellipsis">
      TimeSpan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimeSpan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#format" class="md-nav__link">
    <span class="md-ellipsis">
      Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timer" class="md-nav__link">
    <span class="md-ellipsis">
      Timer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regex" class="md-nav__link">
    <span class="md-ellipsis">
      Regex
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Regex">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      Якори
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      Группы захвата
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matches" class="md-nav__link">
    <span class="md-ellipsis">
      Matches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#net-method-format" class="md-nav__link">
    <span class="md-ellipsis">
      Форматирование (.NET method format)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      Условный оператор
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      Логические операторы сравнения
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Pipeline Operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#invocation-operator" class="md-nav__link">
    <span class="md-ellipsis">
      Invocation Operator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datatype" class="md-nav__link">
    <span class="md-ellipsis">
      DataType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DataType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#math" class="md-nav__link">
    <span class="md-ellipsis">
      Math
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#round" class="md-nav__link">
    <span class="md-ellipsis">
      Round
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tostring" class="md-nav__link">
    <span class="md-ellipsis">
      ToString
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#char" class="md-nav__link">
    <span class="md-ellipsis">
      Char
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switch-function" class="md-nav__link">
    <span class="md-ellipsis">
      Switch function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switch-param" class="md-nav__link">
    <span class="md-ellipsis">
      Switch param
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bit" class="md-nav__link">
    <span class="md-ellipsis">
      Bit
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bit-convertor" class="md-nav__link">
    <span class="md-ellipsis">
      Bit Convertor
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cycle" class="md-nav__link">
    <span class="md-ellipsis">
      Cycle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#foreach" class="md-nav__link">
    <span class="md-ellipsis">
      Foreach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#foreach-object" class="md-nav__link">
    <span class="md-ellipsis">
      ForEach-Object (%)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#while" class="md-nav__link">
    <span class="md-ellipsis">
      While
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#try-catch-finally" class="md-nav__link">
    <span class="md-ellipsis">
      Try-Catch-Finally
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#out-gridview" class="md-nav__link">
    <span class="md-ellipsis">
      Out-Gridview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#out-file" class="md-nav__link">
    <span class="md-ellipsis">
      Out-File
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-content-gccattype" class="md-nav__link">
    <span class="md-ellipsis">
      Get-Content (gc/cat/type)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aes-key" class="md-nav__link">
    <span class="md-ellipsis">
      AES Key
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h2 id="cheat-sheet">Cheat Sheet</h2>
<p align="center">
<a href="https://github.com/Lifailon/PS-Commands"><img title="PowerShell Cheat Sheet RU"src="PowerShell-Cheat-Sheet-RU.jpg"></a>
</p>

<h2 id="help">Help</h2>
<p><code>Get-Verb</code> действия/глаголы, утвержденные для использования в командлетах <br />
<code>Get-Command *Language*</code> поиск команды по имени <br />
<code>(Get-Command Get-Language).Module</code> узнать к какому модулю принадлежит команда <br />
<code>Get-Command Get-Content | fl Module,DLL</code> узнать принадлежность команды к модулю и dll <br />
<code>Get-Command -Module LanguagePackManagement</code> отобразить список команд указанного модуля <br />
<code>(Get-Module LanguagePackManagement).ExportedCommands.Values</code> отобразить список команд указанного модуля <br />
<code>Get-Language | Get-Member</code> отобразить список методов команды (действия), объекты вывода и Event (события объектов: Click) <br />
<code>(Get-Help Get-Service).Aliases</code> узнать псевдонимом команды <br />
<code>Get-Alias gsv</code> узнать имя команды по псевдониму <br />
<code>Get-Help Get-Service</code> синтаксис <br />
<code>Get-Help Get-Service -Parameter *</code> описание всех параметров <br />
<code>Get-Help Get-Service -Online</code> <br />
<code>Get-Help Get-Service -ShowWindow</code> описание параметров в GUI с фильтрацией <br />
<code>Show-Command</code> вывести список команд в GUI <br />
<code>Show-Command Get-Service</code> список параметров команды в GUI <br />
<code>Invoke-Expression</code> iex принимает текст для выполнения в консоли как команды <br />
<code>$PSVersionTable</code> текущая версия PowerShell <br />
<code>Set-ExecutionPolicy Unrestricted</code> <br />
<code>Get-ExecutionPolicy</code> <br />
<code>$Metadata = New-Object System.Management.Automation.CommandMetaData (Get-Command Get-Service)</code> получить информацию о командлете <br />
<code>[System.Management.Automation.ProxyCommand]::Create($Metadata)</code> исходный код функции</p>
<h1 id="object">Object</h1>
<h2 id="variable">Variable</h2>
<p><code>$var = Read-Host "Enter"</code> ручной ввод <br />
<code>$pass = Read-Host "Enter Password" -AsSecureString</code> скрывать набор <br />
<code>$global:path = "\\path"</code> задать глобальную переменную, например в функции <br />
<code>$using:srv</code> использовать переменную текущей сесси в Invoke-сессии <br />
<code>Get-Variable</code> отобразить все переменные <br />
<code>ls variable:/</code> отобразить все переменные <br />
<code>Get-Variable *srv*</code> найти переменную по имени <br />
<code>Get-Variable -Scope Global</code> отобразить все глобальные переменные <br />
<code>Get-Variable Error</code> последняя команда с ошибкой <br />
<code>Remove-Variable -Name *</code> очистить все переменные <br />
<code>$LASTEXITCODE</code> содержит код вывода последней запущенной программы, например ping. Если код возврата положительный (True), то $LastExitCode = 0</p>
<h2 id="env">ENV</h2>
<p><code>Get-ChildItem Env:</code> отобразить все переменные окружения <br />
<code>$env:PSModulePath</code> директории импорта модулей <br />
<code>$env:userprofile</code> <br />
<code>$env:computername</code> <br />
<code>$env:username</code> <br />
<code>$env:userdnsdomain</code> <br />
<code>$env:logonserver</code> <br />
<code>([DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()).Name</code> <br />
<code>[Environment]::GetFolderPath('ApplicationData')</code></p>
<h2 id="history">History</h2>
<p><code>Get-History</code> история команд текущей сессии <br />
<code>(Get-History)[-1].Duration.TotalSeconds</code> время выполнения последней команды <br />
<code>(Get-PSReadLineOption).HistorySavePath</code> путь к сохраненному файлу с 4096 последних команд (из модуля PSReadLine) <br />
<code>Get-Content (Get-PSReadlineOption).HistorySavePath | Select-String Get</code> поиск по содержимому файла (GREP) <br />
<code>Set-PSReadlineOption -MaximumHistoryCount 10000</code> изменить количество сохраняемых команд в файл <br />
<code>Get-PSReadLineOption | select MaximumHistoryCount</code> <br />
<code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code> отключить ведение журнала <br />
<code>F2</code> переключиться с InlineView на ListView</p>
<h2 id="clipboard">Clipboard</h2>
<p><code>Set-Clipboard $srv</code> скопировать в буфер обмена <br />
<code>Get-Clipboard</code> вставить</p>
<h2 id="write-host">Write-Host</h2>
<pre><code class="language-PowerShell">Write-Host -BackgroundColor Green &quot;Test:&quot; -NoNewline # изменить цвет фона и запретить перенос строки
Write-Host &quot; True&quot; -ForegroundColor Green # данная строка будет печататься продолжая предыдущую с новыми параметрами цвета (фон по умолчанию, изменяем цвет текста)
</code></pre>
<p><code>Write-Error "False"</code> <br />
<code>Write-Warning "False"</code></p>
<h2 id="write-progress">Write-Progress</h2>
<pre><code class="language-PowerShell">foreach ($n in 1..100) {
    Write-Progress -Activity &quot;Test Progress&quot; -PercentComplete $n
    Start-Sleep -Milliseconds 100
}
</code></pre>
<h2 id="for">for</h2>
<pre><code class="language-PowerShell">for ($i = 0; $i -le 100; $i+=10) {
    Write-Progress -Activity &quot;Test Progress&quot; -PercentComplete $i
    Start-Sleep -Seconds 1
}
</code></pre>
<h2 id="array">Array</h2>
<p><code>$srv = @("server-01", "server-02")</code>  создать массив <br />
<code>$srv += @("server-03")</code> добавить в массив новый элемент <br />
<code>$srv.Count</code> отобразить кол-во элементов в массиве <br />
<code>Out-String</code> построчный вывод</p>
<h2 id="index">Index</h2>
<p><code>$srv[0]</code> вывести первое значение элемента массива <br />
<code>$srv[0] = Name</code> замена элемента в массиве <br />
<code>$srv[0].Length</code> узнать кол-во символов первого значения в массиве <br />
<code>$srv[10..100]</code> срез</p>
<pre><code class="language-PowerShell">$array = &quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;
$num = 0
foreach ($a in $array) {
    $num += 1
    $index = [array]::IndexOf($array, $a) # узнать номер индекса по зачению
    $array[$index] = $num # пересобрать исходный массив
}
</code></pre>
<h2 id="hashtable">HashTable</h2>
<pre><code class="language-PowerShell">$hashtable = @{ # Создать (инициализировать)
    &quot;User&quot; = $env:USERNAME; 
    &quot;Server&quot; = $env:COMPUTERNAME
}

$hashtable += @{ # Добавить ключи
    &quot;Profile&quot; = $PROFILE;
    &quot;PowerShell_Home_Dir&quot; = $PSHOME
}
</code></pre>
<p><code>$hashtable.Keys</code> список всех ключей <br />
<code>$hashtable["User"]</code> получить значение (Values) по ключу <br />
<code>$hashtable["User"] = "Test"</code> изменить <br />
<code>$hashtable.Remove("User")</code> удалить ключ</p>
<h2 id="collectionslist">Collections/List</h2>
<pre><code class="language-PowerShell">$Collections = New-Object System.Collections.Generic.List[System.Object]
$Collections.Add([PSCustomObject]@{
    User = $env:username;
    Server = $env:computername
})
</code></pre>
<h2 id="pscustomobject">PSCustomObject</h2>
<pre><code class="language-PowerShell">$CustomObject = [PSCustomObject][ordered]@{
    User = $env:username;
    Server = $env:computername
}
</code></pre>
<h2 id="add-and-remove-property">Add and Remove Property</h2>
<p><code>$CustomObject | Add-Member –MemberType NoteProperty –Name Arr –Value @(1,2,3)</code> добавить свойство/стобец <br />
<code>$CustomObject.Arr = @(1,3,5)</code> изменить содержимое <br />
<code>$CustomObject.PsObject.Properties.Remove('User')</code> удалить Property</p>
<h2 id="add-method">Add Method</h2>
<pre><code class="language-PowerShell">$ScriptBlock = {Get-Service}
$CustomObject | Add-Member -Name &quot;TestMethod&quot; -MemberType ScriptMethod -Value $ScriptBlock
$CustomObject | Get-Member
$CustomObject.TestMethod()
</code></pre>
<h2 id="class">Class</h2>
<pre><code class="language-PowerShell">Class CustomClass {
    [string]$User
    [string]$Server
    Start([bool]$Param1) {
        If ($Param1) {
        Write-Host &quot;Start Function&quot;
        }
    }
}
</code></pre>
<p><code>$Class = New-Object -TypeName CustomClass</code> <br />
<code>$Class.User = $env:username</code> <br />
<code>$Class.Server = $env:computername</code> <br />
<code>$Class.Start(1)</code></p>
<h2 id="pipeline">Pipeline</h2>
<p><code>$CustomObject | Add-Member -MemberType NoteProperty -Name "Type" -Value "user" -Force</code> добавление объкта вывода NoteProperty <br />
<code>$CustomObject | Add-Member -MemberType NoteProperty -Name "User" -Value "admin" -Force</code> изменеие содержимого для сущности объекта User <br />
<code>ping $srv | Out-Null</code> перенаправить результат вывода в Out-Null</p>
<h2 id="select-object">Select-Object</h2>
<p><code>Get-Process | Select-Object -Property *</code> отобразить все доступные объекты вывода <br />
<code>Get-Process | select -Unique "Name"</code> удалить повторяющиеся значения в массиве <br />
<code>Get-Process | select -ExpandProperty ProcessName</code> преобразовать из объекта-коллекции в массив (вывести содержимое без наименовая столбца) <br />
<code>(Get-Process | ? Name -match iperf).Modules</code> список используемых модулей процессом</p>
<h2 id="expression">Expression</h2>
<pre><code class="language-PowerShell">Get-Process | Sort-Object -Descending CPU | select -first 10 ProcessName, # сортировка по CPU, вывести первых 10 значений (-first)
@{Name=&quot;ProcessorTime&quot;;
    Expression={$_.TotalProcessorTime -replace &quot;\.\d+$&quot;} # затрачено процессорного времени в минутах
},
@{Name=&quot;Memory&quot;; 
    Expression={[string]([int]($_.WS / 1024kb))+&quot;MB&quot;} # делим байты на КБ (1mb)
},
@{Label=&quot;RunTime&quot;; 
    Expression={((Get-Date) - $_.StartTime) -replace &quot;\.\d+$&quot;} # вычесть из текущего времени - время запуска, и удалить milisec
}
</code></pre>
<h2 id="select-string">Select-String</h2>
<p><code>$(ipconfig | Select-String IPv4) -replace ".+: " | Where-Object {$_ -match "^172."}</code> узнать только IP <br />
<code>$Current_IP = Get-Content $RDCMan_RDG_PATH | Select-String $RDCMan_Display_Name -Context 0,1</code> получить две строки <br />
<code>$Current_IP = $Current_IP.Context.DisplayPostContext[0] -replace ".+&lt;name&gt;|&lt;\/name&gt;"</code> забрать только вторую строку и удалить тэги</p>
<h2 id="format-listformat-table">Format-List/Format-Table</h2>
<p><code>Get-Process | fl ProcessName, StartTime</code> <br />
<code>Get-Process | ft ProcessName, StartTime -Autosize</code> автоматическая группировка размера столбцов</p>
<h2 id="measure-object">Measure-Object</h2>
<p><code>Get-Process | Measure | select Count</code> кол-во объектов <br />
<code>Get-Process | Measure -Line -Word -Character</code> кол-во строк, слов и Char объектов <br />
<code>Get-Process | Measure-Object PM -sum | Select-Object Count,@{Name="MEM_MB"; Expression={[int]($_.Sum/1mb)}}</code> кол-во процессов и общий объем занятой памяти в МБайт</p>
<h2 id="compare-object">Compare-Object</h2>
<p><code>Compare-Object -ReferenceObject (Get-Content -Path .\file1.txt) -DifferenceObject (Get-Content -Path .\file2.txt)</code> сравнение двух файлов <br />
<code>$group1 = Get-ADGroupMember -Identity "Domain Admins"</code> <br />
<code>$group2 = Get-ADGroupMember -Identity "Enterprise Admins"</code> <br />
<code>Compare-Object -ReferenceObject $group1 -DifferenceObject $group2 -IncludeEqual</code> сравнение друх объектов<br />
<code>==</code> нет изменений <br />
<code>&lt;=</code> есть изменения в $group1 <br />
<code>=&gt;</code> есть изменения в $group2</p>
<h2 id="where-object">Where-Object (?)</h2>
<p><code>Get-Process | Where-Object {$_.ProcessName -match "zabbix"}</code> фильтрация/поиск процессов по имени свойства объекта <br />
<code>Get-Process | where CPU -gt 10 | Sort-Object -Descending CPU</code> вывести объекты, где значения CPU больше 10 <br />
<code>Get-Process | where WS -gt 200MB</code> отобразить процессы где WS выше 200МБ <br />
<code>Get-Service | where Name -match "zabbix"</code> поиск службы <br />
<code>Get-Service -ComputerName $srv | Where {$_.Name -match "WinRM"} | Restart-Service</code> перезапустить службу на удаленном компьютере <br />
<code>(Get-Service).DisplayName</code> вывести значения свойства массива <br />
<code>netstat -an | where {$_ -match 443}</code> <br />
<code>netstat -an | ?{$_ -match 443}</code> <br />
<code>(netstat -an) -match 443</code></p>
<h2 id="sort-object">Sort-Object</h2>
<p><code>Get-Process | Sort-Object -Descending CPU | ft</code> обратная (-Descending) сортировка по CPU <br />
<code>Get-Process | Sort-Object -Descending cpu,ws</code> сортировка по двум свойствам <br />
<code>$path[-1..-10]</code> обратная сборка массива без сортировки <br />
<code>$arr = @(1..20); $arr[$($arr.Count - 1)..0]</code> пересобрать массив с конца</p>
<h2 id="lastfirst">Last/First</h2>
<p><code>Get-Process | Sort-Object -Descending CPU | select -First 10</code> вывести первых 10 объектов <br />
<code>Get-Process | Sort-Object -Descending CPU | select -Last 10</code> вывести последних 10 объектов</p>
<h2 id="group-object">Group-Object</h2>
<pre><code class="language-PowerShell">$Groups = Get-CimInstance -Class Win32_PnPSignedDriver |
Select-Object DriverProviderName, FriendlyName, Description, DriverVersion, DriverDate |
Group-Object DriverProviderName, FriendlyName, Description, DriverVersion, DriverDate
$(foreach ($Group in $Groups) {
    $Group.Group[0]
}) | Format-Table
</code></pre>
<h2 id="property">Property</h2>
<p><code>$srv.Count</code> кол-во элементов в массиве <br />
<code>$srv.Length</code> содержит количество символом строки переменной [string] или количество значений (строк) объекта <br />
<code>$srv.Chars(2)</code> отобразить 3-й символ в строке <br />
<code>$srv[2]</code> отобразить 3-ю строку в массиве</p>
<h2 id="method">Method</h2>
<p><code>$srv = "127.0.0.1"</code> <br />
<code>$srv.Insert(0,"https://")</code> добавить значение перед первым символом <br />
<code>$srv.Substring(4)</code> удалить (из всего массива) первые 4 символа <br />
<code>$srv.Remove(3)</code> удалить из всего массива все после 3 символа <br />
<code>$string = "123"</code> создать строку <br />
<code>$int = [convert]::ToInt32($string)</code> преобразовать строку в тип данных число <br />
<code>[string]::Concat($text,$num)</code> объеденить переменные в одну строку <br />
<code>[string]::Join(":",$text,$num)</code> объеденить используя разделитель <br />
<code>[string]::Compare($text,$num,$true)</code> выдает 0 при совпадении или 1/-1 при несовпадении, $true (без учета регистра) или $false (с учетом регистра) <br />
<code>[string]::Equals($text,$num)</code> производит сравнение двух строк и выдает $true при их совпадении или $false при несовпадении <br />
<code>[string]::IsNullOrEmpty($text)</code> проверяет наличие строки, если строка пуста $true, если нет $false <br />
<code>[string]::IsNullOrWhiteSpace($text2)</code> проверяет на наличие только символов пробел, табуляция или символ новой строки</p>
<h1 id="error">Error</h1>
<p><code>$Error</code> выводит все ошибки текущего сеанса <br />
<code>$Error[0].InvocationInfo</code> развернутый отчет об ошибке <br />
<code>$Error.clear()</code> <br />
<code>$LASTEXITCODE</code> результат выполнения последней команды (0 - успех) <br />
<code>exit 1</code> код завершения, который возвращается $LASTEXITCODE</p>
<h2 id="executionstatus">ExecutionStatus</h2>
<pre><code class="language-PowerShell">$(Get-History)[-1] | Select-Object @{
    Name=&quot;RunTime&quot;; Expression={$_.EndExecutionTime - $_.StartExecutionTime}
},ExecutionStatus,CommandLine # посчитать время работы последней [-1] (или Select-Object -Last 1) выполненной команды и ее узнать статус
</code></pre>
<h2 id="measure-command">Measure-Command</h2>
<p><code>$(Measure-Command {ping ya.ru}).TotalSeconds</code> получить время выполнения в секундах</p>
<h1 id="datetime">DateTime</h1>
<p><code>[DateTime]::UtcNow</code> время в формате UTC 0 <br />
<code>$(Get-Date).AddHours(-3)</code> вычесть три часа из текущего времени <br />
<code>$Date = $(Get-Date -Format "dd/MM/yyyy HH:mm:ss")</code> изменить формат отображения времени <br />
<code>$Date = Get-Date -f "dd/MM/yyyy"</code> получаем тип данных [string] $($Date.GetType().Name) <br />
<code>$Date = "19.05.2024"</code> <br />
<code>[DateTime]$Date = Get-Date "$Date"</code> преобразовать строку подходящую под формат даты в тип данных [DateTime] <br />
<code>$BeforeDate = Get-Date "12.05.2024"</code> <br />
<code>[int32]$days=$($Date - $BeforeDate).Days</code> посчитать разницу в днях <br />
<code>"5/7/07" -as [DateTime]</code> преобразовать входные данные в тип данных [DateTime]</p>
<h1 id="timespan">TimeSpan</h1>
<p><code>New-TimeSpan -Start $(Get-Date) -End $($(Get-Date).AddMinutes(+1))</code> получить разницу во времени <br />
<code>$TimeZone = (Get-TimeZone).BaseUtcOffset.TotalMinutes</code> получить разницу в минутах от текущего часового пояса относительно UTC 0 <br />
<code>$UnixTime  = (New-TimeSpan -Start (Get-Date "01/01/1970") -End ((Get-Date).AddMinutes(-$tz))).TotalSeconds</code> вычесть минуты для получения UTC 0 <br />
<code>$TimeStamp = ([string]$UnixTime -replace "\..+") + "000000000"</code> получить текущий TimeStamp</p>
<h2 id="format">Format</h2>
<pre><code>HH   # Часы в 24-часовом формате (00 до 23)
hh   # Часы в 12-часовом формате (01 до 12)
mm   # Минуты (00 до 59)
ss   # Секунды (00 до 59)
tt   # Десигнатор (AM/PM)
fff  # Миллисекунды (000 до 999)
d    # День месяца без ведущего нуля (1-31)
dd   # День месяца с ведущим нулём (01-31)
ddd  # Сокращённое название дня недели (например, &quot;Пн&quot;)
dddd # Полное название дня недели (например, &quot;Понедельник&quot;)
M    # Номер месяца без ведущего нуля (1-12)
MM   # Номер месяца с ведущим нулём (01-12)
MMM  # Сокращённое название месяца (например, &quot;Янв&quot;)
MMMM # Полное название месяца (например, &quot;Январь&quot;)
y    # Год без века (0-99)
yy   # Год без века с ведущим нулём (00-99)
yyyy # Год с веком (например, 2024)
g    # Период или эра (например, &quot;н.э.&quot;)
</code></pre>
<h2 id="timer">Timer</h2>
<p><code>$start_time = Get-Date</code> зафиксировать время до выполнения команды <br />
<code>$end_time = Get-Date</code> зафиксировать время по завершению <br />
<code>$time = $end_time - $start_time</code> высчитать время работы скрипта <br />
<code>$min = $time.minutes</code> <br />
<code>$sec = $time.seconds</code> <br />
<code>Write-Host "$min минут $sec секунд"</code></p>
<p><code>$timer = [System.Diagnostics.Stopwatch]::StartNew()</code> запустить таймер <br />
<code>$timer.IsRunning</code> статус работы таймера <br />
<code>$timer.Elapsed.TotalSeconds</code> отобразить время с момента запуска (в секундах) <br />
<code>$timer.Stop()</code> остановить таймер</p>
<h1 id="regex">Regex</h1>
<pre><code>.       # Обозначает любой символ, кроме новой строки
\       # Экранирует любой специальный символ (метасимвол). Используется, если нужно указать конкретный символ, вместо специального ({ } [ ] / \ + * . $ ^ | ?)
\A (^)  # Начало строки
\Z ($)  # Конец строки
\n      # Новая строка
\s      # Пробел (эквивалент &quot; &quot;), табуляция, перенос строки
\S      # Не пробел
\d      # Число от 0 до 9 (20-07-2022 эквивалент: &quot;\d\d-\d\d-\d\d\d\d&quot;)
\D      # Обозначает любой символ, кроме числа (цифры). Удаления всех символов, кроме цифр: [int]$(&quot;123 test&quot; -replace &quot;\D&quot;)
\w      # Любая буква латиницы, цифра, или знак подчёркивания (от &quot;a&quot; до &quot;z&quot; и от &quot;A&quot; до &quot;Z&quot; или число от 0 до 9)
\W      # Не латиница, не цифра, не подчёркивание
\b      # Граница слова. Применяется когда нужно выделить, что искомые символы являются словом, а не частью другого слова
\B      # Не граница слова
\A      # Начало текста
\Z      # Конец текста
+       # Повторяется 1 и более раз (\s+)
|       # Или. Соединяет несколько вариантов
()      # В круглые скобки заключаются все комбинации с &quot;или&quot; и поиск начала и конца строк
[]      # поиск совпадения любой буквы, например, [A-z0-9] от A до z и цифры от 0 до 9 (&quot;192.168.1.1&quot; -match &quot;192.1[6-7][0-9]&quot;)
[^ ]    # Исключает из поиска символы указанные в квадратных скобках
{ }     # Квантификатор в фигурных скобках, указывает количество повторений символа слева на право (от 1 до 25 раз)
\d{2}   # Найти две цифры
\d{2,4} # Найти две или четыре
{4,}    # Найти четыре и более
</code></pre>
<h2 id="_1">Якори</h2>
<p><code>^</code> или <code>\A</code> определяет начало строки. $url -replace '^','https:'<code>добавить в начало;</code>$<code>или</code>\Z<code>обозначают конец строки. $ip -replace "\d{1,3}$","0"</code>(?=text)<code>поиск слова слева. Пишем слева на право от искомого (ищет только целые словосочетания) "Server:\s(.{1,30})\s(?=$username)"</code>(?&lt;=text)<code>поиск слова справа. $in_time -replace ".+(?&lt;=Last)"</code> удалить все до слова Last <br />
<code>(?!text)</code> не совпадает со словом слева <br />
<code>(?&lt;!text)</code> не совпадает со словом справа</p>
<p><code>$test = "string"</code> <br />
<code>$test -replace ".{1}$"</code> удалить любое кол-во символов в конце строки <br />
<code>$test -replace "^.{1}"</code> удалить любое кол-во символов в начале строки </p>
<h2 id="_2">Группы захвата</h2>
<p><code>$date = '12.31.2021'</code> <br />
<code>$date -replace '^(\d{2}).(\d{2})','$2.$1'</code> поменять местами <br />
<code>$1</code> содержимое первой группы в скобках <br />
<code>$2</code> содержимое второй группы</p>
<p><code>-replace "1","2"</code> замена элементов в индексах массива (везде где присутствует 1, заменить на 2), для удаления используется только первое значение <br />
<code>-split " "</code> преобразовать строку в массив, разделителем указан пробел, которой удаляется ($url.Split("/")[-1]) <br />
<code>-join " "</code> преобразовать массив (коллекцию) в единую строку (string), добавить разделителем пробел</p>
<p><code>@(1,2,3) -contains 3</code> проверить, что элемент справа содержится в массиве слева <br />
<code>@(1,2) -notcontains 3</code> проверить, что элемент справа не содержится в массиве слева</p>
<p><code>-like *txt*</code> поиск по маскам wildcard, выводит значение на экран <br />
<code>-match txt</code> поиска по шаблонам, проверка на соответствие содержимого текста <br />
<code>-match "zabbix|rpc"</code> условия, для поиска по нескольким словам <br />
<code>-NotMatch</code> проверка на отсутствие вхождения </p>
<h2 id="matches">Matches</h2>
<p><code>"num: 777" -match "num: ([0-9]+)" | Out-Null</code> <br />
<code>$Matches[1]</code> выводим только номер</p>
<p><code>$ip = "192.168.10.1"</code> <br />
<code>$ip -match "(\.\d{1,3})\.\d{1,2}"</code> True <br />
<code>$Matches</code> отобразить все подходящие переменные последнего поиска, которые входят и не входят в группы ()</p>
<p><code>$String = "09/14/2017 12:00:27 - mtbill_post_201709141058.txt 7577_Delivered: OK"</code> <br />
<code>$String -Match ".*(?=\.txt)" | Out-Null</code> <br />
<code>$Matches[0][-4..-1] -Join ""</code></p>
<p><code>$string.Substring($string.IndexOf(".txt")-4, 4)</code> 2-й вариант (IndexOf)</p>
<h2 id="net-method-format">Форматирование (.NET method format)</h2>
<p><code>[string]::Format("{1} {0}","Index0","Index1")</code> <br />
<code>"{1} {0}" -f "Index0","Index1"</code> <br />
<code>"{0:##-##-##}" -f 1234567</code> записать число в другом формате (#) <br />
<code>"{0:0000}" -f 123</code> вывести число в формате не меньше 4 знаков (0123) <br />
<code>"{0:P0}" -f (220/1000)</code> посчитать в процентах (P) <br />
<code>"{0:P}" -f (512MB/1GB)</code> сколько % составляет 512Мб от 1Гб <br />
<code>"{0:0.0%}" -f 0.123</code> умножить на 100%</p>
<pre><code class="language-PowerShell">$gp = Get-Process | sort cpu -Descending | select -First 10
foreach ($p in $gp) {
    &quot;{0} - {1:N2}&quot; -f $p.processname, $p.cpu # округлить
}
</code></pre>
<h2 id="_3">Условный оператор</h2>
<pre><code class="language-PowerShell">$rh = Read-Host
if ($rh -eq 1) {
    ipconfig
} elseif (
    $rh -eq 2
) {
    getmac
} else {
    hostname
}
</code></pre>
<p>Если условие if () является истенным ($True), выполнить действие в {} <br />
Если условие if () является ложным ($False), выполнить действие не обязательного оператора else <br />
Условие Elseif идёт после условия if для проверки дополнительных условий перед выполнение оператора else. Оператор, который первый вернет $True, отменит выполнение следующих дополнительных условий <br />
Если передать переменную в условие без оператора, то будет проверяться наличие значения у переменной на $True/$False </p>
<pre><code class="language-PowerShell">if ($(Test-NetConnection $srv -Port 80).TcpTestSucceeded) {
    &quot;Opened port&quot;
} else {
    &quot;Closed port&quot;
}
</code></pre>
<h2 id="_4">Логические операторы сравнения</h2>
<p><code>-eq</code> равно (equal) <br />
<code>-ceq</code> учитывать регистр <br />
<code>-ne</code> не равно (not equal) <br />
<code>-cne</code> не равно учитывая регистр <br />
<code>-gt</code> больше (greater) <br />
<code>-ge</code> больше или равно <br />
<code>-lt</code> меньше (less) <br />
<code>-le</code> меньше или равно <br />
<code>-in</code> проверить на наличие (5 -in @(1,2,3,4,5)) <br />
<code>-NOT</code> логическое НЕТ !(Test-Path $path) <br />
<code>-and</code> логическое И <br />
<code>-or</code> логическое ИЛИ </p>
<pre><code class="language-PowerShell">if ((($1 -eq 1) -and ($2 -eq 2)) -or ($1 -ne 3)) {
    $true
} else {
    $false
} # два условия: (если $1 = 1 И $2 = 2) ИЛИ $1 не равно 3 вернуть $true
</code></pre>
<h2 id="pipeline-operators">Pipeline Operators</h2>
<p><code>Write-Output "First" &amp;&amp; Write-Output "Second"</code> две успешные команды выполняются <br />
<code>Write-Error "Bad" &amp;&amp; Write-Output "Second"</code> первая команда завершается ошибкой, из-за чего вторая команда не выполняется <br />
<code>Write-Error "Bad" || Write-Output "Second"</code> первая команда завершается ошибкой, поэтому выполняется вторая команда <br />
<code>Write-Output "First" || Write-Output "Second"</code> первая команда выполнена успешно, поэтому вторая команда не выполняется</p>
<h2 id="invocation-operator">Invocation Operator</h2>
<p><code>$addr = "8.8.8.8"</code> <br />
<code>$ping = "ping"</code> <br />
<code>&amp; $ping $addr</code> запускает текст как команду</p>
<p><code>&amp; $ping $addr &amp;</code> запустить команду в фоне <br />
<code>(Get-Job)[-1] | Receive-Job -Keep</code></p>
<h1 id="datatype">DataType</h1>
<p><code>$srv.GetType()</code> узнать тип данных <br />
<code>$srv -is [string]</code> проверка на соответствие типа данных <br />
<code>$srv -isnot [System.Object]</code> проверка на несоответствие <br />
<code>[Object]</code> массив (BaseType:System.Array) <br />
<code>[DateTime]</code> формат времени (BaseType:System.ValueType) <br />
<code>[Bool]/[Boolean]</code> логическое значение ($True/$False) или 1/0 (1 бит) наличие/отсуствие напряжения <br />
<code>[Byte]</code> 8-битное (1 байт) целое число без знака (0..255) <br />
<code>[Int16]</code> 16-битное знаковое целое число от -32767 до 32767 (тип данных WORD 0..65535) <br />
<code>[Int]</code> 32-битное (4 байта) знаковое целое число от –2147483648 до 2147483647 (DWORD) <br />
<code>[Int64]</code> 64-битное от -9223372036854775808 до 9223372036854775808 (LWORD) <br />
<code>[Decimal]</code> 128-битное десятичное значение от –79228162514264337593543950335 до 79228162514264337593543950335 <br />
<code>[Single]</code> число с плавающей запятой (32-разрядное) <br />
<code>[Double]</code> число с плавающей запятой с двойной точностью (64-разрядное) <br />
<code>[String]</code> неизменяемая строка символов Юникода фиксированной длины (BaseType:System.Object)</p>
<h2 id="math">Math</h2>
<p><code>[math] | Get-Member -Static</code> <br />
<code>[math]::Pow(2,4)</code> 2 в 4 степени <br />
<code>[math]::Truncate(1.8)</code> грубое округление, удаляет дробную часть <br />
<code>[math]::Ceiling(1.8)</code> округляет число в большую сторону до ближайшего целого значения <br />
<code>[math]::Floor(-1.8)</code> округляет число в меньшую сторону <br />
<code>[math]::Min(33,22)</code> возвращает наименьшее значение двух значений <br />
<code>[math]::Max(33,22)</code> возвращает наибольшее значение двух значений</p>
<h2 id="round">Round</h2>
<p><code>[double]::Round(87.5, 0)</code> 88 (нечетное), в .NET по умолчанию используется округление в средней точке ToEven, где *.5 значения округляются до ближайшего четного целого числа <br />
<code>[double]::Round(88.5, 0)</code> 88 (четное) <br />
<code>[double]::Round(88.5, 0, 1)</code> 89 (округлять в большую сторону) <br />
<code>[double]::Round(1234.56789, 2)</code> округлить до 2 символов после запятой</p>
<h2 id="tostring">ToString</h2>
<p><code>(4164539/1MB).ToString("0.00")</code> разделить на дважды на 1024/1024 и округлить до 3,97</p>
<h2 id="char">Char</h2>
<p><code>[Char]</code> cимвол Юникода (16-разрядный) <br />
<code>$char = $srv.ToCharArray()</code> разбить строку [string] на массив [System.Array] из букв</p>
<h2 id="switch-function">Switch function</h2>
<pre><code class="language-PowerShell">$MMM = Get-Date -UFormat &quot;%m&quot;
switch($MMM) {
    &quot;01&quot; {$Month = 'Jan'}
    &quot;02&quot; {$Month = 'Feb'}
    &quot;03&quot; {$Month = 'Mar'}
    &quot;04&quot; {$Month = 'Apr'}
    &quot;05&quot; {$Month = 'May'}
    &quot;06&quot; {$Month = 'Jun'}
    &quot;07&quot; {$Month = 'Jul'}
    &quot;08&quot; {$Month = 'Aug'}
    &quot;09&quot; {$Month = 'Sep'}
    &quot;10&quot; {$Month = 'Oct'}
    &quot;11&quot; {$Month = 'Nov'}
    &quot;12&quot; {$Month = 'Dec'}
}
</code></pre>
<h2 id="switch-param">Switch param</h2>
<pre><code class="language-PowerShell">Function fun-switch (
    [switch]$param
) {
    If ($param) {&quot;yes&quot;} else {&quot;no&quot;}
}
</code></pre>
<p><code>fun-switch -param</code></p>
<h1 id="bit">Bit</h1>
<pre><code>Двоичное    Десятичное
1           1
10          2
11          3
100         4
101         5
110         6
111         7
1000        8
1001        9
1010        10
1011        11
1100        12
1101        13
1110        14
1111        15
1 0000      16

Двоичное    Десятичное  Номер разряда
1           1           0
10          2           1
100         4           2
1000        8           3
1 0000      16          4
10 0000     32          5
100 0000    64          6
1000 0000   128         7
1 0000 0000 256         8

Из двоичного =&gt; десятичное (1-й вариант по таблице)
1001 0011 = 1000 0000 + 1 0000 + 10 + 1 = 128 + 16 + 2 + 1 = 147

2-й вариант
7654 3210 (разряды двоичного выражения) = (1*2^7)+(0*2^6)+(0*2^5)+(1*2^4)+(0*2^3)+(0*2^2)+(1*2^1)+(1*2^0) = 147
[math]::Pow(2,7) + [math]::Pow(2,4) + [math]::Pow(2,1) + [math]::Pow(2,0) = 147` исключить 0 и сложить степень

Из десятичного =&gt; двоичное (1-й вариант по таблице)
347 вычесть ближайшие 256 = 91 (+ 1 0000 0000 забрать двоичный остаток)
91  - 64  = 27 ближайшее 16 (+ 100 0000)
27  - 16  = 11 ближайшее 8 (+ 1 0000)
11  - 8   = 3  ближайшее 2 (+ 1000)
3   - 2   = 1 (+ 10)
1   - 1   = 0 (+ 1)
1 0101 1011

2-й вариант
Последовательное деления числа на 2, предворительно забирая остаток для получения четного числа в меньшую сторону
347 - 346 = остаток 1, (347-1)/2 = 173
173 - 172 = остаток 1, (172-1)/2 = 86
86  - 86  = остаток 0, 86/2 = 43
43  - 42  = остаток 1, (43-1)/2 = 21
21  - 20  = остаток 1, (21-1)/2 = 10
10  - 10  = остаток 0, 10/2 = 5
5   - 4   = остаток 1, (5-1)/2 = 2
2   - 2   = остаток 0, 2/2 = 1
1   - 2   = остаток 1, (1-1)/2 = 0
Результат деления записывается снизу вверх
</code></pre>
<h2 id="bit-convertor">Bit Convertor</h2>
<pre><code class="language-PowerShell">function ConvertTo-Bit {
    param (
        [Int]$int
    )
    [array]$bits = @()
    $test = $true
    while ($test -eq $true) {
        if (($int/2).GetType() -match [double]) {
            $int = ($int-1)/2
            [array]$bits += 1
        }
        elseif (($int/2).GetType() -match [int]) {
            $int = $int/2
            [array]$bits += 0
        }
        if ($int -eq 0) {
            $test = $false
        }
    }
    $bits =  $bits[-1..-999]
    ([string]($bits)) -replace &quot;\s&quot;
}
</code></pre>
<p><code>ConvertTo-Bit 347</code></p>
<pre><code class="language-PowerShell">function ConvertFrom-Bit {
    param (
        $bit
    )
    [int]$int = 0
    $bits = $bit.ToString().ToCharArray()
    $index = ($bits.Count)-1
    foreach ($b in $bits) {
        if ($b -notlike 0) {
            $int += [math]::Pow(2,$index)
        }
    $index -= 1
    }
    $int
}
</code></pre>
<p><code>ConvertFrom-Bit 10010011</code></p>
<p><code>Get-Process pwsh | fl ProcessorAffinity</code> привязка процесса к ядрам, представляет из себя битовую маску (bitmask), где каждому биту соответствует ядро процессора. Если для ядра отмечено сходство (affinity), то бит выставляется в 1, если нет — то в 0. Например, если выбраны все 16 ядер, то это 1111 1111 1111 1111 или 65535. <br />
<code>$(Get-Process pwsh).ProcessorAffinity = 15</code> 0000000000001111 присвоить 4 первых ядра <br />
<code>$(Get-Process pwsh).ProcessorAffinity = 61440</code> 1111000000000000 присвоить 4 последних ядра <br />
<code>$(Get-Process pwsh).ProcessorAffinity = (ConvertFrom-Bit 1111000000000000)</code></p>
<h1 id="cycle">Cycle</h1>
<h2 id="foreach">Foreach</h2>
<p><code>$list = 100..110</code> создать массив из цифр от 100 до 110 <br />
<code>foreach ($srv in $list) {ping 192.168.3.$srv -n 1 -w 50}</code> $srv хранит текущий элемент из $list и повторяет команду до последнего элемента в массиве <br />
<code>$foreach.Current</code> текущий элемент в цикле <br />
<code>$foreach.Reset()</code> обнуляет итерацию, перебор начнется заново, что приводит к бесконечному циклу <br />
<code>$foreach.MoveNext()</code> переход к следующему элементу в цикле</p>
<h2 id="foreach-object">ForEach-Object (%)</h2>
<pre><code class="language-PowerShell">100..110 | %{
    ping -n 1 -w 50 192.168.3.$_ &gt; $null
    if ($LastExitCode -eq 0) {
        Write-Host &quot;192.168.3.$_&quot; -ForegroundColor green
    } else {
    Write-Host &quot;192.168.3.$_&quot;-ForegroundColor Red
    }
}
</code></pre>
<p><code>%</code> передать цикл через конвеер (ForEach-Object) <br />
<code>$_</code> переменная цикла и конвеера ($PSItem) <br />
<code>gwmi Win32_QuickFixEngineering | where {$_.InstalledOn.ToString() -match "2022"} | %{($_.HotFixID.Substring(2))}</code> gwmi создает массив, вывод команды передается where для поиска подходящих под критерии объектов. По конвееру передается в цикл для удаления первых (2) символов методом Substring из всех объектов HotFixID.</p>
<h2 id="while">While</h2>
<pre><code class="language-PowerShell">$srv = &quot;yandex.ru&quot;
$out2 = &quot;Есть пинг&quot;
$out3 = &quot;Нет пинга&quot;
$out = $false # предварительно сбросить переменную, While проверяет условие до запуска цикла
While ($out -eq $false) { # пока условие является $true, цикл будет повторяться
    $out = ping -n 1 -w 50 $srv
    if ($out -match &quot;ttl&quot;) {$out = $true; $out2} else {$out = $false; $out3; sleep 1}
}

while ($True) { # запустить бесконечный цикл
    $result = ping yandex.ru -n 1 -w 50
    if ($result -match &quot;TTL&quot;) { # условие, при котором будет выполнен break
        Write-Host &quot;Сайт доступен&quot;
        break # остановит цикл
    } else {
        Write-Host &quot;Сайт недоступен&quot;; sleep 1
    }
}
</code></pre>
<h2 id="try-catch-finally">Try-Catch-Finally</h2>
<pre><code class="language-PowerShell">Try {$out = pping 192.168.3.1}
Catch {Write-Warning &quot;$($error[0])&quot;} # выводит в случае ошибки (вместо ошибки)
finally {$out = &quot;End&quot;} # выполняется в конце в любом случае
</code></pre>
<h2 id="out-gridview">Out-Gridview</h2>
<p><code>Get-Service -cn $srv | Out-GridView -Title "Service $srv" -OutputMode Single –PassThru | Restart-Service</code> перезапустить выбранную службу</p>
<h2 id="out-file">Out-File</h2>
<p><code>Read-Host –AsSecureString | ConvertFrom-SecureString | Out-File "$env:userprofile\desktop\password.txt"</code> писать в файл. Преобразовать пароль в формат SecureString с использованием шифрования Windows Data Protection API (DPAPI)</p>
<h2 id="get-content-gccattype">Get-Content (gc/cat/type)</h2>
<p><code>$password = gc "$env:userprofile\desktop\password.txt" | ConvertTo-SecureString</code> читать хэш пароля из файла с помощью ключей, хранящихся в профиле текущего пользователя, который невозможно прочитать на другом копьютере</p>
<h2 id="aes-key">AES Key</h2>
<p><code>$AESKey = New-Object Byte[] 32</code> <br />
<code>[Security.Cryptography.RNGCryptoServiceProvider]::Create().GetBytes($AESKey)</code> <br />
<code>$AESKey | Out-File "C:\password.key"</code> <br />
<code>$Cred.Password | ConvertFrom-SecureString -Key (Get-Content "C:\password.key") | Set-Content "C:\password.txt"</code> сохранить пароль в файл используя внешний ключ <br />
<code>$pass = Get-Content "C:\password.txt" | ConvertTo-SecureString -Key (Get-Content "\\Server\Share\password.key")</code> расшифровать пароль на втором компьютере</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2023-2024 Alex Kup (Lifailon)
    </div>
  
  
  PowerShell Commands on
  <a href="https://github.com/Lifailon/PS-Commands" target="_blank" rel="noopener">
    GitHub
  </a>
  | Theme
  <a href="https://github.com/squidfunk/mkdocs-material" target="_blank" rel="noopener">
    Material
  </a>
  for
  <a href="https://github.com/mkdocs/mkdocs" target="_blank" rel="noopener">
    MkDocs
  </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/Lifailon/PS-Commands" target="_blank" rel="noopener" title="PS-Commands on Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dd8806f2.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/powershell.min.js"></script>
      
        <script src="../_highlight/init.js"></script>
      
    
  </body>
</html>