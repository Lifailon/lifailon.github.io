<!DOCTYPE html>
<html lang="en-us">
    <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="generator" content="Hugo 0.123.8">

    

    

    
        
            <meta
                name="description"
                content="Large base of PowerShell notes in Russian language" />
        

        
            <meta
                name="keywords"
                content="PowerShell" />
        

        
            <meta name="author" content="Lifailon" />
        

    


    <title>
        
            .NET |
            Lifailon.GitHub.io
        
    </title>

    


    
    

    
    


    
    


    
    


    
    

    


    
    

    

    

        
        


        
        


        <link
            rel="stylesheet"
            href="/css/index_d751713.min.912d03bce61461ecbc3ca083479e1ed814bba94df76d0bdc6aa88fdca33621b9bb410dc2c81af31e8101fec62decfa5f6e48901ad673bc5056d2f1d1f2368a34.css"
            integrity="sha512-kS0DvOYUYey8PKCDR54e2BS7qU33bQvcaqiP3KM2Ibm7QQ3CyBrzHoEB/sYt7PpfbkiQGtZzvFBW0vHR8jaKNA==" />
    


    
    

    

    

    

    
</head>



    <body>
        <header class="header">
    <div class="header_left">
        
    </div>

    <div class="header_middle">
        
            .NET -
            Lifailon.GitHub.io
        
    </div>
</header>



        <main>
            <aside class="sidebar">
    



    
    

    
    


    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/github/" title="./github/">
                        GitHub
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/powershell/" title="./powershell/">
                        PowerShell
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/dotnet/" title="./dotnet/">
                        .NET
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/activedirectory/" title="./activedirectory/">
                        Active Directory
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/ansible/" title="./ansible/">
                        Ansible
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/api/" title="./api/">
                        API
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/apps/" title="./apps/">
                        Apps
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/com/" title="./com/">
                        Component Object Model
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/git/" title="./git/">
                        Git
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/html/" title="./html/">
                        HTML
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/influxdb/" title="./influxdb/">
                        InfluxDB
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/exchange/" title="./exchange/">
                        MS Exchange
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/mssql/" title="./mssql/">
                        MS SQL
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/mysql/" title="./mysql/">
                        MySQL
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/network/" title="./network/">
                        Network
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/virtualization/" title="./virtualization/">
                        Virtualization
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/wmi/" title="./wmi/">
                        WMI
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://lifailon.github.io/zabbix/" title="./zabbix/">
                        Zabbix
                    </a>
                </li>
            
        
    </ul>


</aside>
<aside class="exapandable"></aside>


            
    <article class="main">
        <button
    class="sidebar-toggle-btn"
    type="menu"
    aria-expanded="false"
    aria-haspopup="true">
    <i class="bi bi-list"></i>
</button>



        <div class="title">
            <h1 class="title-header">
                .NET
            </h1>

            <div class="author-date-readtime">
                

                    
                        <div class="author" title="Author">
                            <i class="bi bi-person"></i>
                            <a
                                href="/author/lifailon/"
                                class="cat-btn">
                                Lifailon
                            </a>
                        </div>
                    

                

                
                    <div class="date" title="Date">
                        <i class="bi bi-calendar3"></i>
                        <time
                            datetime="Mar 14 2024"
                            >Mar 14 2024
                        </time>
                    </div>
                

                
                    <div
                        class="readtime"
                        title="Time to Read">
                        <i class="bi bi-clock"></i>
                        13 mins to read
                    </div>
                
            </div>
        </div>

        <div class="article-meta">
            

            

            
                <div class="breadcumb">
                    <i class="bi bi-folder"></i>
                    
    




<a href="https://lifailon.github.io/" class="bread-btn">
    
        <i class="bi bi-house-fill"></i>
    

    
        Home
    
</a>




    /



<a href="https://lifailon.github.io/dotnet/" class="bread-btn">
    

    
        .NET
    
</a>

                </div>
            

            
        </div>

        
            <nav id="TableOfContents">
  <ul>
    <li><a href="#object-and-method">Object and Method</a>
      <ul>
        <li><a href="#eventlog">EventLog</a></li>
        <li><a href="#iopath">IO.Path</a></li>
        <li><a href="#match">Match</a></li>
        <li><a href="#generatepassword">GeneratePassword</a></li>
        <li><a href="#soundplayer">SoundPlayer</a></li>
        <li><a href="#static-class">Static Class</a></li>
      </ul>
    </li>
    <li><a href="#function">Function</a>
      <ul>
        <li><a href="#clicker">[Clicker]</a></li>
        <li><a href="#audio">[Audio]</a></li>
        <li><a href="#netsessionenum">NetSessionEnum</a></li>
        <li><a href="#copyfile">CopyFile</a></li>
        <li><a href="#showwindowasync">ShowWindowAsync</a></li>
        <li><a href="#getasynckeystate">GetAsyncKeyState</a></li>
      </ul>
    </li>
    <li><a href="#objectevent">ObjectEvent</a></li>
    <li><a href="#console-api">Console API</a></li>
    <li><a href="#drawing">Drawing</a></li>
  </ul>

  <ul>
    <li><a href="#sockets">Sockets</a>
      <ul>
        <li><a href="#udp-socket">UDP Socket</a></li>
        <li><a href="#test-netudpconnection">Test-NetUDPConnection</a></li>
        <li><a href="#tcp-socket">TCP Socket</a></li>
        <li><a href="#wakeonlan">WakeOnLan</a></li>
        <li><a href="#encoding">Encoding</a></li>
        <li><a href="#base64">Base64</a></li>
        <li><a href="#http-listener">HTTP Listener</a></li>
        <li><a href="#webclient">WebClient</a></li>
        <li><a href="#certificate">Certificate</a></li>
      </ul>
    </li>
    <li><a href="#csv">CSV</a>
      <ul>
        <li><a href="#convertfrom-string">ConvertFrom-String</a></li>
        <li><a href="#convertfrom-stringdata">ConvertFrom-StringData</a></li>
      </ul>
    </li>
    <li><a href="#xml">XML</a>
      <ul>
        <li><a href="#get-credtoxml">Get-CredToXML</a></li>
        <li><a href="#xmlwriter-extensible-markup-language">XmlWriter (Extensible Markup Language)</a></li>
        <li><a href="#createelement">CreateElement</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#yaml">YAML</a></li>
    <li><a href="#sqlite">SQLite</a>
      <ul>
        <li><a href="#database-password">Database password</a></li>
      </ul>
    </li>
    <li><a href="#elasticsearch">Elasticsearch</a></li>
    <li><a href="#cdata">CData</a>
      <ul>
        <li><a href="#adonet-assembly">ADO.NET Assembly</a></li>
        <li><a href="#update">UPDATE</a></li>
        <li><a href="#insert">INSERT</a></li>
        <li><a href="#delete">DELETE</a></li>
      </ul>
    </li>
    <li><a href="#odbc-open-database-connectivity">ODBC (Open Database Connectivity)</a></li>
    <li><a href="#postgresql">PostgreSQL</a></li>
  </ul>
</nav>
        


        <div class="content">
            
                <h2 id="object-and-method">Object and Method</h2>
<h3 id="eventlog">EventLog</h3>
<p><code>[System.Diagnostics.EventLog] | select Assembly,Module</code> <br>
<code>$EventLog = [System.Diagnostics.EventLog]::new(&quot;Application&quot;)</code> <br>
<code>$EventLog = New-Object -TypeName System.Diagnostics.EventLog -ArgumentList Application,192.168.3.100</code> <br>
<code>$EventLog | Get-Member -MemberType Method</code> <br>
<code>$EventLog.MaximumKilobytes</code> максимальный размер журнала <br>
<code>$EventLog.Entries</code> просмотреть журнал <br>
<code>$EventLog.Clear()</code> очистить журнал</p>
<h3 id="iopath">IO.Path</h3>
<p><code>Join-Path C: Install Test</code> <br>
<code>[System.IO.Path]::Combine(&quot;C:&quot;, &quot;Install&quot;, &quot;Test&quot;)</code></p>
<h3 id="match">Match</h3>
<p><code>[System.Math] | Get-Member -Static -MemberType Methods</code> <br>
<code>[System.Math]::Max(2,7)</code> <br>
<code>[System.Math]::Min(2,7)</code> <br>
<code>[System.Math]::Floor(3.9)</code> <br>
<code>[System.Math]::Truncate(3.9)</code></p>
<h3 id="generatepassword">GeneratePassword</h3>
<p><code>Add-Type -AssemblyName System.Web</code> <br>
<code>[System.Web.Security.Membership]::GeneratePassword(10,2)</code></p>
<h3 id="soundplayer">SoundPlayer</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$CriticalSound = New-Object System.Media.SoundPlayer
</span></span><span style="display:flex;"><span>$CriticalSound.SoundLocation = <span style="color:#e6db74">&#34;C:\WINDOWS\Media\Windows Critical Stop.wav&#34;</span>
</span></span><span style="display:flex;"><span>$CriticalSound.Play()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$GoodSound = New-Object System.Media.SoundPlayer
</span></span><span style="display:flex;"><span>$GoodSound.SoundLocation = <span style="color:#e6db74">&#34;C:\WINDOWS\Media\tada.wav&#34;</span>
</span></span><span style="display:flex;"><span>$GoodSound.Play()</span></span></code></pre></div>
    
</div>
<h3 id="static-class">Static Class</h3>
<p><code>[System.Environment] | Get-Member -Static</code> <br>
<code>[System.Environment]::OSVersion</code> <br>
<code>[System.Environment]::Version</code> <br>
<code>[System.Environment]::MachineName</code> <br>
<code>[System.Environment]::UserName</code></p>
<p><code>[System.Diagnostics.Process] | Get-Member -Static</code> <br>
<code>[System.Diagnostics.Process]::Start('notepad.exe')</code></p>
<h2 id="function">Function</h2>
<h3 id="clicker">[Clicker]</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$cSource%20=%20@%27%0d%0ausing%20System;%0d%0ausing%20System.Drawing;%0d%0ausing%20System.Runtime.InteropServices;%0d%0ausing%20System.Windows.Forms;%0d%0apublic%20class%20Clicker%0d%0a%7b%0d%0a//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646270%28v=vs.85%29.aspx%0d%0a[StructLayout%28LayoutKind.Sequential%29]%0d%0astruct%20INPUT%0d%0a%7b%20%0d%0a%20%20%20%20public%20int%20%20%20%20%20%20%20%20type;%20//%200%20=%20INPUT_MOUSE,%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%201%20=%20INPUT_KEYBOARD%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%202%20=%20INPUT_HARDWARE%0d%0a%20%20%20%20public%20MOUSEINPUT%20mi;%0d%0a%7d%0d%0a//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646273%28v=vs.85%29.aspx%0d%0a[StructLayout%28LayoutKind.Sequential%29]%0d%0astruct%20MOUSEINPUT%0d%0a%7b%0d%0a%20%20%20%20public%20int%20%20%20%20dx%20;%0d%0a%20%20%20%20public%20int%20%20%20%20dy%20;%0d%0a%20%20%20%20public%20int%20%20%20%20mouseData%20;%0d%0a%20%20%20%20public%20int%20%20%20%20dwFlags;%0d%0a%20%20%20%20public%20int%20%20%20%20time;%0d%0a%20%20%20%20public%20IntPtr%20dwExtraInfo;%0d%0a%7d%0d%0a//This%20covers%20most%20use%20cases%20although%20complex%20mice%20may%20have%20additional%20buttons%0d%0a//There%20are%20additional%20constants%20you%20can%20use%20for%20those%20cases,%20see%20the%20msdn%20page%0d%0aconst%20int%20MOUSEEVENTF_MOVED%20%20%20%20%20%20=%200x0001%20;%0d%0aconst%20int%20MOUSEEVENTF_LEFTDOWN%20%20%20=%200x0002%20;%0d%0aconst%20int%20MOUSEEVENTF_LEFTUP%20%20%20%20%20=%200x0004%20;%0d%0aconst%20int%20MOUSEEVENTF_RIGHTDOWN%20%20=%200x0008%20;%0d%0aconst%20int%20MOUSEEVENTF_RIGHTUP%20%20%20%20=%200x0010%20;%0d%0aconst%20int%20MOUSEEVENTF_MIDDLEDOWN%20=%200x0020%20;%0d%0aconst%20int%20MOUSEEVENTF_MIDDLEUP%20%20%20=%200x0040%20;%0d%0aconst%20int%20MOUSEEVENTF_WHEEL%20%20%20%20%20%20=%200x0080%20;%0d%0aconst%20int%20MOUSEEVENTF_XDOWN%20%20%20%20%20%20=%200x0100%20;%0d%0aconst%20int%20MOUSEEVENTF_XUP%20%20%20%20%20%20%20%20=%200x0200%20;%0d%0aconst%20int%20MOUSEEVENTF_ABSOLUTE%20%20%20=%200x8000%20;%0d%0aconst%20int%20screen_length%20%20%20%20%20%20%20%20%20%20=%200x10000%20;%0d%0a//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646310%28v=vs.85%29.aspx%0d%0a[System.Runtime.InteropServices.DllImport%28%22user32.dll%22%29]%0d%0aextern%20static%20uint%20SendInput%28uint%20nInputs,%20INPUT[]%20pInputs,%20int%20cbSize%29;%0d%0apublic%20static%20void%20LeftClickAtPoint%28int%20x,%20int%20y%29%0d%0a%7b%0d%0a%20%20%20%20//Move%20the%20mouse%0d%0a%20%20%20%20INPUT[]%20input%20=%20new%20INPUT[3];%0d%0a%20%20%20%20input[0].mi.dx%20=%20x*%2865535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width%29;%0d%0a%20%20%20%20input[0].mi.dy%20=%20y*%2865535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height%29;%0d%0a%20%20%20%20input[0].mi.dwFlags%20=%20MOUSEEVENTF_MOVED%20%7c%20MOUSEEVENTF_ABSOLUTE;%0d%0a%20%20%20%20//Left%20mouse%20button%20down%0d%0a%20%20%20%20input[1].mi.dwFlags%20=%20MOUSEEVENTF_LEFTDOWN;%0d%0a%20%20%20%20//Left%20mouse%20button%20up%0d%0a%20%20%20%20input[2].mi.dwFlags%20=%20MOUSEEVENTF_LEFTUP;%0d%0a%20%20%20%20SendInput%283,%20input,%20Marshal.SizeOf%28input[0]%29%29;%0d%0a%7d%0d%0a%7d%0d%0a%27@">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$cSource = <span style="color:#e6db74">@&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">using System;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">using System.Drawing;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">using System.Runtime.InteropServices;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">using System.Windows.Forms;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">public class Clicker
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646270(v=vs.85).aspx
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[StructLayout(LayoutKind.Sequential)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">struct INPUT
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{ 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public int        type; // 0 = INPUT_MOUSE,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            // 1 = INPUT_KEYBOARD
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                            // 2 = INPUT_HARDWARE
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public MOUSEINPUT mi;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646273(v=vs.85).aspx
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[StructLayout(LayoutKind.Sequential)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">struct MOUSEINPUT
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public int    dx ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public int    dy ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public int    mouseData ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public int    dwFlags;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public int    time;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public IntPtr dwExtraInfo;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">//This covers most use cases although complex mice may have additional buttons
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">//There are additional constants you can use for those cases, see the msdn page
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">const int MOUSEEVENTF_MOVED      = 0x0001 ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">const int MOUSEEVENTF_LEFTDOWN   = 0x0002 ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">const int MOUSEEVENTF_LEFTUP     = 0x0004 ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">const int MOUSEEVENTF_RIGHTDOWN  = 0x0008 ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">const int MOUSEEVENTF_RIGHTUP    = 0x0010 ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">const int MOUSEEVENTF_MIDDLEDOWN = 0x0020 ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">const int MOUSEEVENTF_MIDDLEUP   = 0x0040 ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">const int MOUSEEVENTF_WHEEL      = 0x0080 ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">const int MOUSEEVENTF_XDOWN      = 0x0100 ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">const int MOUSEEVENTF_XUP        = 0x0200 ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">const int MOUSEEVENTF_ABSOLUTE   = 0x8000 ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">const int screen_length          = 0x10000 ;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646310(v=vs.85).aspx
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[System.Runtime.InteropServices.DllImport(&#34;user32.dll&#34;)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">extern static uint SendInput(uint nInputs, INPUT[] pInputs, int cbSize);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">public static void LeftClickAtPoint(int x, int y)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    //Move the mouse
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    INPUT[] input = new INPUT[3];
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    input[0].mi.dx = x*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    input[0].mi.dy = y*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    input[0].mi.dwFlags = MOUSEEVENTF_MOVED | MOUSEEVENTF_ABSOLUTE;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    //Left mouse button down
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    input[1].mi.dwFlags = MOUSEEVENTF_LEFTDOWN;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    //Left mouse button up
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    input[2].mi.dwFlags = MOUSEEVENTF_LEFTUP;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SendInput(3, input, Marshal.SizeOf(input[0]));
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;@</span></span></span></code></pre></div>
    
</div>
<p><code>Add-Type -TypeDefinition $cSource -ReferencedAssemblies System.Windows.Forms,System.Drawing</code> <br>
<code>[Clicker]::LeftClickAtPoint(1900,1070)</code></p>
<h3 id="audio">[Audio]</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="Add-Type%20-Language%20CsharpVersion3%20-TypeDefinition%20@%22%0d%0ausing%20System.Runtime.InteropServices;%0d%0a[Guid%28%225CDF2C82-841E-4546-9722-0CF74078229A%22%29,%20InterfaceType%28ComInterfaceType.InterfaceIsIUnknown%29]%0d%0ainterface%20IAudioEndpointVolume%20%7b%0d%0a//%20f%28%29,%20g%28%29,%20...%20are%20unused%20COM%20method%20slots.%20Define%20these%20if%20you%20care%0d%0aint%20f%28%29;%20int%20g%28%29;%20int%20h%28%29;%20int%20i%28%29;%0d%0aint%20SetMasterVolumeLevelScalar%28float%20fLevel,%20System.Guid%20pguidEventContext%29;%0d%0aint%20j%28%29;%0d%0aint%20GetMasterVolumeLevelScalar%28out%20float%20pfLevel%29;%0d%0aint%20k%28%29;%20int%20l%28%29;%20int%20m%28%29;%20int%20n%28%29;%0d%0aint%20SetMute%28[MarshalAs%28UnmanagedType.Bool%29]%20bool%20bMute,%20System.Guid%20pguidEventContext%29;%0d%0aint%20GetMute%28out%20bool%20pbMute%29;%0d%0a%7d%0d%0a[Guid%28%22D666063F-1587-4E43-81F1-B948E807363F%22%29,%20InterfaceType%28ComInterfaceType.InterfaceIsIUnknown%29]%0d%0ainterface%20IMMDevice%20%7b%0d%0aint%20Activate%28ref%20System.Guid%20id,%20int%20clsCtx,%20int%20activationParams,%20out%20IAudioEndpointVolume%20aev%29;%0d%0a%7d%0d%0a[Guid%28%22A95664D2-9614-4F35-A746-DE8DB63617E6%22%29,%20InterfaceType%28ComInterfaceType.InterfaceIsIUnknown%29]%0d%0ainterface%20IMMDeviceEnumerator%20%7b%0d%0aint%20f%28%29;%20//%20Unused%0d%0aint%20GetDefaultAudioEndpoint%28int%20dataFlow,%20int%20role,%20out%20IMMDevice%20endpoint%29;%0d%0a%7d%0d%0a[ComImport,%20Guid%28%22BCDE0395-E52F-467C-8E3D-C4579291692E%22%29]%20class%20MMDeviceEnumeratorComObject%20%7b%20%7d%0d%0apublic%20class%20Audio%20%7b%0d%0astatic%20IAudioEndpointVolume%20Vol%28%29%20%7b%0d%0avar%20enumerator%20=%20new%20MMDeviceEnumeratorComObject%28%29%20as%20IMMDeviceEnumerator;%0d%0aIMMDevice%20dev%20=%20null;%0d%0aMarshal.ThrowExceptionForHR%28enumerator.GetDefaultAudioEndpoint%28/*eRender*/%200,%20/*eMultimedia*/%201,%20out%20dev%29%29;%0d%0aIAudioEndpointVolume%20epv%20=%20null;%0d%0avar%20epvid%20=%20typeof%28IAudioEndpointVolume%29.GUID;%0d%0aMarshal.ThrowExceptionForHR%28dev.Activate%28ref%20epvid,%20/*CLSCTX_ALL*/%2023,%200,%20out%20epv%29%29;%0d%0areturn%20epv;%0d%0a%7d%0d%0apublic%20static%20float%20Volume%20%7b%0d%0aget%20%7bfloat%20v%20=%20-1;%20Marshal.ThrowExceptionForHR%28Vol%28%29.GetMasterVolumeLevelScalar%28out%20v%29%29;%20return%20v;%7d%0d%0aset%20%7bMarshal.ThrowExceptionForHR%28Vol%28%29.SetMasterVolumeLevelScalar%28value,%20System.Guid.Empty%29%29;%7d%0d%0a%7d%0d%0apublic%20static%20bool%20Mute%20%7b%0d%0aget%20%7b%20bool%20mute;%20Marshal.ThrowExceptionForHR%28Vol%28%29.GetMute%28out%20mute%29%29;%20return%20mute;%20%7d%0d%0aset%20%7b%20Marshal.ThrowExceptionForHR%28Vol%28%29.SetMute%28value,%20System.Guid.Empty%29%29;%20%7d%0d%0a%7d%0d%0a%7d%0d%0a%22@">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>Add-Type -Language CsharpVersion3 -TypeDefinition <span style="color:#e6db74">@&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">using System.Runtime.InteropServices;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Guid(&#34;5CDF2C82-841E-4546-9722-0CF74078229A&#34;), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">interface IAudioEndpointVolume {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">// f(), g(), ... are unused COM method slots. Define these if you care
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int f(); int g(); int h(); int i();
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int SetMasterVolumeLevelScalar(float fLevel, System.Guid pguidEventContext);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int j();
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int GetMasterVolumeLevelScalar(out float pfLevel);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int k(); int l(); int m(); int n();
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int SetMute([MarshalAs(UnmanagedType.Bool)] bool bMute, System.Guid pguidEventContext);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int GetMute(out bool pbMute);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Guid(&#34;D666063F-1587-4E43-81F1-B948E807363F&#34;), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">interface IMMDevice {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int Activate(ref System.Guid id, int clsCtx, int activationParams, out IAudioEndpointVolume aev);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Guid(&#34;A95664D2-9614-4F35-A746-DE8DB63617E6&#34;), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">interface IMMDeviceEnumerator {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int f(); // Unused
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int GetDefaultAudioEndpoint(int dataFlow, int role, out IMMDevice endpoint);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[ComImport, Guid(&#34;BCDE0395-E52F-467C-8E3D-C4579291692E&#34;)] class MMDeviceEnumeratorComObject { }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">public class Audio {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">static IAudioEndpointVolume Vol() {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">var enumerator = new MMDeviceEnumeratorComObject() as IMMDeviceEnumerator;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">IMMDevice dev = null;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Marshal.ThrowExceptionForHR(enumerator.GetDefaultAudioEndpoint(/*eRender*/ 0, /*eMultimedia*/ 1, out dev));
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">IAudioEndpointVolume epv = null;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">var epvid = typeof(IAudioEndpointVolume).GUID;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Marshal.ThrowExceptionForHR(dev.Activate(ref epvid, /*CLSCTX_ALL*/ 23, 0, out epv));
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">return epv;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">public static float Volume {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">get {float v = -1; Marshal.ThrowExceptionForHR(Vol().GetMasterVolumeLevelScalar(out v)); return v;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set {Marshal.ThrowExceptionForHR(Vol().SetMasterVolumeLevelScalar(value, System.Guid.Empty));}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">public static bool Mute {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">get { bool mute; Marshal.ThrowExceptionForHR(Vol().GetMute(out mute)); return mute; }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">set { Marshal.ThrowExceptionForHR(Vol().SetMute(value, System.Guid.Empty)); }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;@</span></span></span></code></pre></div>
    
</div>
<p><code>[Audio]::Volume = 0.50</code> <br>
<code>[Audio]::Mute = $true</code></p>
<h3 id="netsessionenum">NetSessionEnum</h3>
<p><a href="https://learn.microsoft.com/ru-ru/windows/win32/api/lmshare/nf-lmshare-netsessionenum?redirectedfrom=MSDN">Function</a> <br>
<a href="https://fuzzysecurity.com/tutorials/24.html">Source</a></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Invoke-NetSessionEnum {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> (
</span></span><span style="display:flex;"><span>[Parameter(<span style="color:#a6e22e">Mandatory</span> = $True)][<span style="color:#66d9ef">string</span>]$HostName
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>Add-Type -TypeDefinition <span style="color:#e6db74">@&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">using System;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">using System.Diagnostics;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">using System.Runtime.InteropServices;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[StructLayout(LayoutKind.Sequential)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">public struct SESSION_INFO_10
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    [MarshalAs(UnmanagedType.LPWStr)]public string OriginatingHost;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    [MarshalAs(UnmanagedType.LPWStr)]public string DomainUser;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public uint SessionTime;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public uint IdleTime;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">public static class Netapi32
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[DllImport(&#34;Netapi32.dll&#34;, SetLastError=true)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public static extern int NetSessionEnum(
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        [In,MarshalAs(UnmanagedType.LPWStr)] string ServerName,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        [In,MarshalAs(UnmanagedType.LPWStr)] string UncClientName,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        [In,MarshalAs(UnmanagedType.LPWStr)] string UserName,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        Int32 Level,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        out IntPtr bufptr,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        int prefmaxlen,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        ref Int32 entriesread,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        ref Int32 totalentries,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        ref Int32 resume_handle);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[DllImport(&#34;Netapi32.dll&#34;, SetLastError=true)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public static extern int NetApiBufferFree(
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        IntPtr Buffer);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;@</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create SessionInfo10 Struct</span>
</span></span><span style="display:flex;"><span>$SessionInfo10 = New-Object SESSION_INFO_10
</span></span><span style="display:flex;"><span>$SessionInfo10StructSize = [<span style="color:#66d9ef">System.Runtime.InteropServices.Marshal</span>]::SizeOf($SessionInfo10)` Grab size to loop bufptr
</span></span><span style="display:flex;"><span>$SessionInfo10 = $SessionInfo10.GetType()` Hacky, but we need this ;))
</span></span><span style="display:flex;"><span><span style="color:#75715e"># NetSessionEnum params</span>
</span></span><span style="display:flex;"><span>$OutBuffPtr = [<span style="color:#66d9ef">IntPtr</span>]::Zero` Struct output buffer
</span></span><span style="display:flex;"><span>$EntriesRead = $TotalEntries = $ResumeHandle = <span style="color:#ae81ff">0</span>` Counters &amp; ResumeHandle
</span></span><span style="display:flex;"><span>$CallResult = [<span style="color:#66d9ef">Netapi32</span>]::NetSessionEnum($HostName, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#ae81ff">10</span>, [<span style="color:#66d9ef">ref</span>]$OutBuffPtr, <span style="color:#ae81ff">-1</span>, [<span style="color:#66d9ef">ref</span>]$EntriesRead, [<span style="color:#66d9ef">ref</span>]$TotalEntries, [<span style="color:#66d9ef">ref</span>]$ResumeHandle)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($CallResult <span style="color:#f92672">-ne</span> <span style="color:#ae81ff">0</span>){
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Mmm something went wrong!</span><span style="color:#ae81ff">`n</span><span style="color:#e6db74">Error Code: </span>$CallResult<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ([<span style="color:#66d9ef">System.IntPtr</span>]::Size <span style="color:#f92672">-eq</span> <span style="color:#ae81ff">4</span>) {
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">`n</span><span style="color:#e6db74">Netapi32::NetSessionEnum Buffer Offset  --&gt; 0x</span>$(<span style="color:#e6db74">&#34;{0:X8}&#34;</span> <span style="color:#f92672">-f</span> $OutBuffPtr.ToInt32())<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">`n</span><span style="color:#e6db74">Netapi32::NetSessionEnum Buffer Offset  --&gt; 0x</span>$(<span style="color:#e6db74">&#34;{0:X16}&#34;</span> <span style="color:#f92672">-f</span> $OutBuffPtr.ToInt64())<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Result-set contains </span>$EntriesRead<span style="color:#e6db74"> session(s)!&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Change buffer offset to int</span>
</span></span><span style="display:flex;"><span>$BufferOffset = $OutBuffPtr.ToInt64()
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Loop buffer entries and cast pointers as SessionInfo10</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> ($Count = <span style="color:#ae81ff">0</span>; ($Count <span style="color:#f92672">-lt</span> $EntriesRead); $Count++){
</span></span><span style="display:flex;"><span>$NewIntPtr = New-Object System.Intptr -ArgumentList $BufferOffset
</span></span><span style="display:flex;"><span>$Info = [<span style="color:#66d9ef">system.runtime.interopservices.marshal</span>]::PtrToStructure($NewIntPtr,[<span style="color:#66d9ef">type</span>]$SessionInfo10)
</span></span><span style="display:flex;"><span>$Info
</span></span><span style="display:flex;"><span>$BufferOffset = $BufferOffset + $SessionInfo10StructSize
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">`n</span><span style="color:#e6db74">Calling NetApiBufferFree, no memleaks here!&#34;</span>
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">Netapi32</span>]::NetApiBufferFree($OutBuffPtr) |Out-Null
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
    
</div>
<p><code>Invoke-NetSessionEnum localhost</code></p>
<h3 id="copyfile">CopyFile</h3>
<p><a href="https://learn.microsoft.com/ru-ru/windows/win32/api/winbase/nf-winbase-copyfile">Function</a> <br>
<a href="https://devblogs.microsoft.com/scripting/use-powershell-to-interact-with-the-windows-api-part-1/">Source</a></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$MethodDefinition = <span style="color:#e6db74">@&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[DllImport(&#34;kernel32.dll&#34;, CharSet = CharSet.Unicode)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">public static extern bool CopyFile(string lpExistingFileName, string lpNewFileName, bool bFailIfExists);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;@</span>
</span></span><span style="display:flex;"><span>$Kernel32 = Add-Type -MemberDefinition $MethodDefinition -Name <span style="color:#e6db74">&#34;Kernel32&#34;</span> -Namespace <span style="color:#e6db74">&#34;Win32&#34;</span> -PassThru
</span></span><span style="display:flex;"><span>$Kernel32::CopyFile(<span style="color:#e6db74">&#34;</span>$($Env:SystemRoot)<span style="color:#e6db74">\System32\calc.exe&#34;</span>, <span style="color:#e6db74">&#34;</span>$($Env:USERPROFILE)<span style="color:#e6db74">\Desktop\calc.exe&#34;</span>, $False) </span></span></code></pre></div>
    
</div>
<h3 id="showwindowasync">ShowWindowAsync</h3>
<p><a href="https://learn.microsoft.com/ru-ru/windows/win32/api/winuser/nf-winuser-showwindowasync">Function</a></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$Signature = <span style="color:#e6db74">@&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[DllImport(&#34;user32.dll&#34;)]public static extern bool ShowWindowAsync(IntPtr hWnd, int nCmdShow);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;@</span>
</span></span><span style="display:flex;"><span>$ShowWindowAsync = Add-Type -MemberDefinition $Signature -Name <span style="color:#e6db74">&#34;Win32ShowWindowAsync&#34;</span> -Namespace Win32Functions -PassThru
</span></span><span style="display:flex;"><span>$ShowWindowAsync | Get-Member -Static
</span></span><span style="display:flex;"><span>$ShowWindowAsync::ShowWindowAsync((Get-Process -Id $pid).MainWindowHandle, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>$ShowWindowAsync::ShowWindowAsync((Get-Process -Id $Pid).MainWindowHandle, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>$ShowWindowAsync::ShowWindowAsync((Get-Process -Id $Pid).MainWindowHandle, <span style="color:#ae81ff">4</span>)</span></span></code></pre></div>
    
</div>
<h3 id="getasynckeystate">GetAsyncKeyState</h3>
<p><a href="https://learn.microsoft.com/ru-ru/windows/win32/api/winuser/nf-winuser-getasynckeystate">Function</a></p>
<p><code>Add-Type -AssemblyName System.Windows.Forms</code> <br>
<code>[int][System.Windows.Forms.Keys]::F1</code> определить номер [Int] клавиши по ее названию <br>
<code>65..90 | % {&quot;{0} = {1}&quot; -f $_, [System.Windows.Forms.Keys]$_}</code> порядковый номер букв (A..Z)</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Get-ControlKey {
</span></span><span style="display:flex;"><span>$key = <span style="color:#ae81ff">112</span>
</span></span><span style="display:flex;"><span>$Signature = <span style="color:#e6db74">@&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[DllImport(&#34;user32.dll&#34;, CharSet=CharSet.Auto, ExactSpelling=true)] 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">public static extern short GetAsyncKeyState(int virtualKeyCode); 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;@</span>
</span></span><span style="display:flex;"><span>Add-Type -MemberDefinition $Signature -Name Keyboard -Namespace PsOneApi
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">bool</span>]([<span style="color:#66d9ef">PsOneApi.Keyboard</span>]::GetAsyncKeyState($key) <span style="color:#f92672">-eq</span> <span style="color:#ae81ff">-32767</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Write-Warning <span style="color:#e6db74">&#39;Press F1 to exit&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> ($true) {
</span></span><span style="display:flex;"><span>Write-Host <span style="color:#e6db74">&#39;.&#39;</span> -NoNewline
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (Get-ControlKey) {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>Start-Sleep -Seconds <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
    
</div>
<h2 id="objectevent">ObjectEvent</h2>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$Timer%20=%20New-Object%20System.Timers.Timer%0d%0a$Timer.Interval%20=%201000%0d%0aRegister-ObjectEvent%20-InputObject%20$Timer%20-EventName%20Elapsed%20-SourceIdentifier%20Timer.Output%20-Action%20%7b%0d%0a$Random%20=%20Get-Random%20-Min%200%20-Max%20100%0d%0aWrite-Host%20$Random%20%0d%0a%7d%0d%0a$Timer.Enabled%20=%20$True">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$Timer = New-Object System.Timers.Timer
</span></span><span style="display:flex;"><span>$Timer.Interval = <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>Register-ObjectEvent -InputObject $Timer -EventName Elapsed -SourceIdentifier Timer.Output -Action {
</span></span><span style="display:flex;"><span>$Random = Get-Random -Min <span style="color:#ae81ff">0</span> -Max <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>Write-Host $Random 
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$Timer.Enabled = $True</span></span></code></pre></div>
    
</div>
<p><code>$Timer.Enabled = $False</code> остановить <br>
<code>$Timer | Get-Member -MemberType Event</code> отобразить список всех событий объекта <br>
<code>Get-EventSubscriber</code> список зарегистрированных подписок на события в текущей сессии <br>
<code>Unregister-Event -SourceIdentifier Timer.Output</code> удаляет регистрацию подписки на событие по имени события (EventName) или все * <br>
<code>-Forward</code> перенаправляет события из удаленного сеанса (New-PSSession) в локальный сеанс <br>
<code>-SupportEvent</code> не выводит результат регистрации события на экран (и Get-EventSubscriber и Get-Job)</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <pre><code>Register-EngineEvent -SourceIdentifier PowerShell.Exiting -Action {
$date = Get-Date -f hh:mm:ss
(New-Object -ComObject Wscript.Shell).Popup(&#34;PowerShell Exit: $date&#34;,0,&#34;Action&#34;,64)
}</code></pre>
    
</div>
<h2 id="console-api">Console API</h2>
<p><a href="https://powershell.one/tricks/input-devices/detect-key-press">Source</a></p>
<p><code>[Console] | Get-Member -Static</code> <br>
<code>[Console]::BackgroundColor = &quot;Blue&quot;</code> <br>
<code>[Console]::OutputEncoding</code> используемая кодировка в текущей сессии <br>
<code>[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding(&quot;utf-8&quot;)</code> изменить кодировку для отображения кириллицы <br>
<code>[Console]::outputEncoding = [System.Text.Encoding]::GetEncoding(&quot;cp866&quot;)</code> для ISE <br>
<code>[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding(&quot;windows-1251&quot;)</code> для ps2exe <br>
<code>Get-Service | Out-File $home\Desktop\Service.txt -Encoding oem</code> &gt; <br>
<code>Get-Service | Out-File $home\Desktop\Service.txt -Append</code> &raquo;</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ([<span style="color:#66d9ef">Console</span>]::KeyAvailable) {
</span></span><span style="display:flex;"><span>$keyInfo = [<span style="color:#66d9ef">Console</span>]::ReadKey($true)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>Write-Host <span style="color:#e6db74">&#34;.&#34;</span> -NoNewline
</span></span><span style="display:flex;"><span>sleep <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">while</span> ($true)
</span></span><span style="display:flex;"><span>Write-Host
</span></span><span style="display:flex;"><span>$keyInfo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Get-KeyPress {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> (
</span></span><span style="display:flex;"><span>[Parameter(<span style="color:#a6e22e">Mandatory</span>)][<span style="color:#66d9ef">ConsoleKey</span>]$Key,
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">System.ConsoleModifiers</span>]$ModifierKey = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ([<span style="color:#66d9ef">Console</span>]::KeyAvailable) {
</span></span><span style="display:flex;"><span>$pressedKey = [<span style="color:#66d9ef">Console</span>]::ReadKey($true)
</span></span><span style="display:flex;"><span>$isPressedKey = $key <span style="color:#f92672">-eq</span> $pressedKey.Key
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($isPressedKey) {
</span></span><span style="display:flex;"><span>$pressedKey.Modifiers <span style="color:#f92672">-eq</span> $ModifierKey
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">Console</span>]::Beep(<span style="color:#ae81ff">1800</span>, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>$false
</span></span><span style="display:flex;"><span>}}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Write-Warning <span style="color:#e6db74">&#39;Press Ctrl+Shift+Q to exit&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>Write-Host <span style="color:#e6db74">&#34;.&#34;</span> -NoNewline
</span></span><span style="display:flex;"><span>$pressed = Get-KeyPress -Key Q -ModifierKey <span style="color:#e6db74">&#39;Control,Shift&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($pressed) {<span style="color:#66d9ef">break</span>}
</span></span><span style="display:flex;"><span>sleep <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">while</span> ($true)</span></span></code></pre></div>
    
</div>
<h2 id="drawing">Drawing</h2>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.drawing?view=net-7.0&amp;redirectedfrom=MSDN">API</a></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>Add-Type -AssemblyName System.Drawing
</span></span><span style="display:flex;"><span>$Width = <span style="color:#ae81ff">800</span>
</span></span><span style="display:flex;"><span>$Height = <span style="color:#ae81ff">400</span>
</span></span><span style="display:flex;"><span>$image = New-Object System.Drawing.Bitmap($Width,$Height)
</span></span><span style="display:flex;"><span>$graphic = [<span style="color:#66d9ef">System.Drawing.Graphics</span>]::FromImage($image)
</span></span><span style="display:flex;"><span>$background_color = [<span style="color:#66d9ef">System.Drawing.Brushes</span>]::Blue <span style="color:#75715e"># задать цвет фона (синий)</span>
</span></span><span style="display:flex;"><span>$graphic.FillRectangle($background_color, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, $image.Width, $image.Height)
</span></span><span style="display:flex;"><span>$text_color = [<span style="color:#66d9ef">System.Drawing.Brushes</span>]::White <span style="color:#75715e"># задать цвет текста (белый)</span>
</span></span><span style="display:flex;"><span>$font = New-Object System.Drawing.Font(<span style="color:#e6db74">&#34;Arial&#34;</span>, <span style="color:#ae81ff">20</span>, [<span style="color:#66d9ef">System.Drawing.FontStyle</span>]::Bold) <span style="color:#75715e"># задать шрифт</span>
</span></span><span style="display:flex;"><span>$text = <span style="color:#e6db74">&#34;PowerShell&#34;</span> <span style="color:#75715e"># указать текст</span>
</span></span><span style="display:flex;"><span>$text_position = New-Object System.Drawing.RectangleF(<span style="color:#ae81ff">320</span>, <span style="color:#ae81ff">180</span>, <span style="color:#ae81ff">300</span>, <span style="color:#ae81ff">100</span>)  <span style="color:#75715e"># задать положение текста (x, y, width, height)</span>
</span></span><span style="display:flex;"><span>$graphic.DrawString($text, $font, $text_color, $text_position) <span style="color:#75715e"># нанести текст на изображение</span>
</span></span><span style="display:flex;"><span>$image.Save(<span style="color:#e6db74">&#34;</span>$home<span style="color:#e6db74">\desktop\powershell_image.bmp&#34;</span>, [<span style="color:#66d9ef">System.Drawing.Imaging.ImageFormat</span>]::Bmp) <span style="color:#75715e"># сохранить изображение</span>
</span></span><span style="display:flex;"><span>$image.Dispose() <span style="color:#75715e"># освобождение ресурсов</span></span></span></code></pre></div>
    
</div>
<p><code>$path = &quot;$home\desktop\powershell_image.bmp&quot;</code> <br>
<code>Invoke-Item $path</code></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$src_image = [<span style="color:#66d9ef">System.Drawing.Image</span>]::FromFile($path)
</span></span><span style="display:flex;"><span>$Width = <span style="color:#ae81ff">400</span>
</span></span><span style="display:flex;"><span>$Height = <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>$dst_image = New-Object System.Drawing.Bitmap -ArgumentList $src_image, $Width, $Height <span style="color:#75715e"># изменить размер изображения</span>
</span></span><span style="display:flex;"><span>$dst_image.Save(<span style="color:#e6db74">&#34;</span>$home<span style="color:#e6db74">\desktop\powershell_image_resize.bmp&#34;</span>, [<span style="color:#66d9ef">System.Drawing.Imaging.ImageFormat</span>]::Bmp)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$rotated_image = $src_image.Clone() <span style="color:#75715e"># создать копию исходного изображения</span>
</span></span><span style="display:flex;"><span>$rotated_image.RotateFlip([<span style="color:#66d9ef">System.Drawing.RotateFlipType</span>]::Rotate180FlipNone) <span style="color:#75715e"># перевернуть изображение на 180 градусов</span>
</span></span><span style="display:flex;"><span>$rotated_image.Save(<span style="color:#e6db74">&#34;</span>$home<span style="color:#e6db74">\desktop\powershell_image_rotated.bmp&#34;</span>, [<span style="color:#66d9ef">System.Drawing.Imaging.ImageFormat</span>]::Bmp)
</span></span><span style="display:flex;"><span>$src_image.Dispose() <span style="color:#75715e"># закрыть (отпустить) исходный файл</span></span></span></code></pre></div>
    
</div>
<h1 id="objectevent-1">ObjectEvent</h1>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$Timer%20=%20New-Object%20System.Timers.Timer%0d%0a$Timer.Interval%20=%201000%0d%0aRegister-ObjectEvent%20-InputObject%20$Timer%20-EventName%20Elapsed%20-SourceIdentifier%20Timer.Output%20-Action%20%7b%0d%0a$Random%20=%20Get-Random%20-Min%200%20-Max%20100%0d%0aWrite-Host%20$Random%20%0d%0a%7d%0d%0a$Timer.Enabled%20=%20$True">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$Timer = New-Object System.Timers.Timer
</span></span><span style="display:flex;"><span>$Timer.Interval = <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>Register-ObjectEvent -InputObject $Timer -EventName Elapsed -SourceIdentifier Timer.Output -Action {
</span></span><span style="display:flex;"><span>$Random = Get-Random -Min <span style="color:#ae81ff">0</span> -Max <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>Write-Host $Random 
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$Timer.Enabled = $True</span></span></code></pre></div>
    
</div>
<p><code>$Timer.Enabled = $False</code> остановить <br>
<code>$Timer | Get-Member -MemberType Event</code> отобразить список всех событий объекта <br>
<code>Get-EventSubscriber</code> список зарегистрированных подписок на события в текущей сессии <br>
<code>Unregister-Event -SourceIdentifier Timer.Output</code> удаляет регистрацию подписки на событие по имени события (EventName) или все * <br>
<code>-Forward</code> перенаправляет события из удаленного сеанса (New-PSSession) в локальный сеанс <br>
<code>-SupportEvent</code> не выводит результат регистрации события на экран (и Get-EventSubscriber и Get-Job)</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <pre><code>Register-EngineEvent -SourceIdentifier PowerShell.Exiting -Action {
$date = Get-Date -f hh:mm:ss
(New-Object -ComObject Wscript.Shell).Popup(&#34;PowerShell Exit: $date&#34;,0,&#34;Action&#34;,64)
}</code></pre>
    
</div>
<h2 id="sockets">Sockets</h2>
<h3 id="udp-socket">UDP Socket</h3>
<p><a href="https://cloudbrothers.info/en/test-udp-connection-powershell/">Source</a></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Start-UDPServer {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span>(
</span></span><span style="display:flex;"><span>$Port = <span style="color:#ae81ff">5201</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>$RemoteComputer = New-Object System.Net.IPEndPoint([<span style="color:#66d9ef">System.Net.IPAddress</span>]::Any, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>$UdpObject = New-Object System.Net.Sockets.UdpClient($Port)
</span></span><span style="display:flex;"><span>$ReceiveBytes = $UdpObject.Receive([<span style="color:#66d9ef">ref</span>]$RemoteComputer)
</span></span><span style="display:flex;"><span>$UdpObject.Close()
</span></span><span style="display:flex;"><span>$ASCIIEncoding = New-Object System.Text.ASCIIEncoding
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">string</span>]$ReturnString = $ASCIIEncoding.GetString($ReceiveBytes)
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">PSCustomObject</span>]@{
</span></span><span style="display:flex;"><span>LocalDateTime = $(Get-Date -UFormat <span style="color:#e6db74">&#34;%Y-%m-%d %T&#34;</span>)
</span></span><span style="display:flex;"><span>ClientIP      = $RemoteComputer.address.ToString()
</span></span><span style="display:flex;"><span>ClientPort    = $RemoteComputer.Port.ToString()
</span></span><span style="display:flex;"><span>Message       = $ReturnString
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">while</span> (<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
    
</div>
<p><code>Start-UDPServer -Port 5201</code></p>
<h3 id="test-netudpconnection">Test-NetUDPConnection</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="function%20Test-NetUDPConnection%20%7b%0d%0aparam%28%0d%0a[string]$ComputerName%20=%20%22127.0.0.1%22,%0d%0a[int32]$PortServer%20%20%20%20=%205201,%0d%0a[int32]$PortClient%20%20%20%20=%205211,%0d%0a$Message%0d%0a%29%0d%0abegin%20%7b%0d%0a$UdpObject%20=%20New-Object%20system.Net.Sockets.Udpclient%28$PortClient%29%0d%0a$UdpObject.Connect%28$ComputerName,%20$PortServer%29%0d%0a%7d%0d%0aprocess%20%7b%0d%0a$ASCIIEncoding%20=%20New-Object%20System.Text.ASCIIEncoding%0d%0aif%20%28!$Message%29%20%7b$Message%20=%20Get-Date%20-UFormat%20%22%25Y-%25m-%25d%20%25T%22%7d%0d%0a$Bytes%20=%20$ASCIIEncoding.GetBytes%28$Message%29%0d%0a[void]$UdpObject.Send%28$Bytes,%20$Bytes.length%29%0d%0a%7d%0d%0aend%20%7b%0d%0a$UdpObject.Close%28%29%0d%0a%7d%0d%0a%7d">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Test-NetUDPConnection {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span>(
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">string</span>]$ComputerName = <span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">int32</span>]$PortServer    = <span style="color:#ae81ff">5201</span>,
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">int32</span>]$PortClient    = <span style="color:#ae81ff">5211</span>,
</span></span><span style="display:flex;"><span>$Message
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">begin</span> {
</span></span><span style="display:flex;"><span>$UdpObject = New-Object system.Net.Sockets.Udpclient($PortClient)
</span></span><span style="display:flex;"><span>$UdpObject.Connect($ComputerName, $PortServer)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">process</span> {
</span></span><span style="display:flex;"><span>$ASCIIEncoding = New-Object System.Text.ASCIIEncoding
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (!$Message) {$Message = Get-Date -UFormat <span style="color:#e6db74">&#34;%Y-%m-%d %T&#34;</span>}
</span></span><span style="display:flex;"><span>$Bytes = $ASCIIEncoding.GetBytes($Message)
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">void</span>]$UdpObject.Send($Bytes, $Bytes.length)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span> {
</span></span><span style="display:flex;"><span>$UdpObject.Close()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
    
</div>
<p><code>Test-NetUDPConnection -ComputerName 127.0.0.1 -PortServer 5201</code> <br>
<code>Test-NetUDPConnection -ComputerName 127.0.0.1 -PortServer 514 -Message &quot;&lt;30&gt;May 31 00:00:00 HostName multipathd[784]: Test message&quot;</code></p>
<h3 id="tcp-socket">TCP Socket</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="function%20Start-TCPServer%20%7b%0d%0aparam%28%0d%0a$Port%20=%205201%0d%0a%29%0d%0ado%20%7b%0d%0a$TcpObject%20=%20New-Object%20System.Net.Sockets.TcpListener%28$port%29%0d%0a$ReceiveBytes%20=%20$TcpObject.Start%28%29%0d%0a$ReceiveBytes%20=%20$TcpObject.AcceptTcpClient%28%29%0d%0a$TcpObject.Stop%28%29%0d%0a$ReceiveBytes.Client.RemoteEndPoint%20%7c%20select%20Address,Port%0d%0a%7d%20while%20%281%29%0d%0a%7d">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Start-TCPServer {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span>(
</span></span><span style="display:flex;"><span>$Port = <span style="color:#ae81ff">5201</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>$TcpObject = New-Object System.Net.Sockets.TcpListener($port)
</span></span><span style="display:flex;"><span>$ReceiveBytes = $TcpObject.Start()
</span></span><span style="display:flex;"><span>$ReceiveBytes = $TcpObject.AcceptTcpClient()
</span></span><span style="display:flex;"><span>$TcpObject.Stop()
</span></span><span style="display:flex;"><span>$ReceiveBytes.Client.RemoteEndPoint | select Address,Port
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">while</span> (<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
    
</div>
<p><code>Start-TCPServer -Port 5201</code> <br>
<code>Test-NetConnection -ComputerName 127.0.0.1 -Port 5201</code></p>
<h3 id="wakeonlan">WakeOnLan</h3>
<p>Broadcast package consisting of 6 byte filled &ldquo;0xFF&rdquo; and then 96 byte where the mac address is repeated 16 times</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Send-WOL {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">param</span> (
</span></span><span style="display:flex;"><span>[Parameter(<span style="color:#a6e22e">Mandatory</span> = $True)]$Mac,
</span></span><span style="display:flex;"><span>$IP,
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">int</span>]$Port = <span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>$Mac = $Mac.replace(<span style="color:#e6db74">&#34;:&#34;</span>, <span style="color:#e6db74">&#34;-&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (!$IP) {$IP = [<span style="color:#66d9ef">System.Net.IPAddress</span>]::Broadcast}
</span></span><span style="display:flex;"><span>$SynchronizationChain = [<span style="color:#66d9ef">byte[]</span>](,0xFF * <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>$ByteMac = $Mac.Split(<span style="color:#e6db74">&#34;-&#34;</span>) | %{[<span style="color:#66d9ef">byte</span>](<span style="color:#e6db74">&#34;0x&#34;</span> + $_)}
</span></span><span style="display:flex;"><span>$Package = $SynchronizationChain + ($ByteMac * <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>$UdpClient = New-Object System.Net.Sockets.UdpClient
</span></span><span style="display:flex;"><span>$UdpClient.Connect($IP, $port)
</span></span><span style="display:flex;"><span>$UdpClient.Send($Package, $Package.Length)
</span></span><span style="display:flex;"><span>$UdpClient.Close()
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
    
</div>
<p><code>Send-WOL -Mac &quot;D8-BB-C1-70-A3-4E&quot;</code> <br>
<code>Send-WOL -Mac &quot;D8-BB-C1-70-A3-4E&quot; -IP 192.168.3.100</code></p>
<h3 id="encoding">Encoding</h3>
<p><code>$ByteText = [System.Text.Encoding]::UTF8.GetBytes(&quot;password&quot;)</code> <br>
<code>$Text = [System.Text.Encoding]::UTF8.GetString($ByteText)</code></p>
<h3 id="base64">Base64</h3>
<p><code>$text = &quot;password&quot;</code> <br>
<code>$byte = [System.Text.Encoding]::Unicode.GetBytes($text)</code> <br>
<code>$base64 = [System.Convert]::ToBase64String($byte)</code> <br>
<code>$decode_base64 = [System.Convert]::FromBase64String($base64)</code> <br>
<code>$decode_string = [System.Text.Encoding]::Unicode.GetString($decode_base64)</code></p>
<p><code>$path_image = &quot;$home\Documents\1200x800.jpg&quot;</code> <br>
<code>$BBase64 = [System.Convert]::ToBase64String((Get-Content $path_image -Encoding Byte))</code> <br>
<code>Add-Type -assembly System.Drawing</code> <br>
<code>$Image = [System.Drawing.Bitmap]::FromStream([IO.MemoryStream][Convert]::FromBase64String($BBase64))</code> <br>
<code>$Image.Save(&quot;$home\Desktop\1200x800.jpg&quot;)</code></p>
<h3 id="http-listener">HTTP Listener</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$httpListener = New-Object System.Net.HttpListener
</span></span><span style="display:flex;"><span>$httpListener.Prefixes.Add(<span style="color:#e6db74">&#34;http://+:8888/&#34;</span>)
</span></span><span style="display:flex;"><span>$httpListener.Start()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> (!([<span style="color:#66d9ef">console</span>]::KeyAvailable)) {
</span></span><span style="display:flex;"><span>$info = Get-Service | select name,status | ConvertTo-HTML
</span></span><span style="display:flex;"><span>$context = $httpListener.GetContext()
</span></span><span style="display:flex;"><span>$context.Response.StatusCode = <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>$context.Response.ContentType = <span style="color:#e6db74">&#39;text/HTML&#39;</span>
</span></span><span style="display:flex;"><span>$WebContent = $info
</span></span><span style="display:flex;"><span>$EncodingWebContent = [<span style="color:#66d9ef">Text.Encoding</span>]::UTF8.GetBytes($WebContent)
</span></span><span style="display:flex;"><span>$context.Response.OutputStream.Write($EncodingWebContent , <span style="color:#ae81ff">0</span>, $EncodingWebContent.Length)
</span></span><span style="display:flex;"><span>$context.Response.Close()
</span></span><span style="display:flex;"><span>Get-NetTcpConnection -LocalPort <span style="color:#ae81ff">8888</span>
</span></span><span style="display:flex;"><span>(Get-Date).datetime
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$httpListener.Close()</span></span></code></pre></div>
    
</div>
<h3 id="webclient">WebClient</h3>
<p><code>[System.Net.WebClient] | Get-Member</code> <br>
<code>(New-Object Net.WebClient).DownloadString(&quot;https://raw.githubusercontent.com/Lifailon/PowerShell-Commands/rsa/README.md&quot;)</code></p>
<h3 id="certificate">Certificate</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Get-WebCertificate ($srv) {
</span></span><span style="display:flex;"><span>$iwr = iwr $srv
</span></span><span style="display:flex;"><span>$status_code = $iwr.StatusCode
</span></span><span style="display:flex;"><span>$status = $iwr.BaseResponse.StatusCode
</span></span><span style="display:flex;"><span>$info = $iwr.BaseResponse.Server
</span></span><span style="display:flex;"><span>$spm = [<span style="color:#66d9ef">System.Net.ServicePointManager</span>]::FindServicePoint($srv)
</span></span><span style="display:flex;"><span>$date_end = $spm.Certificate.GetExpirationDateString()
</span></span><span style="display:flex;"><span>$cert_name = ($spm.Certificate.Subject) <span style="color:#f92672">-replace</span> <span style="color:#e6db74">&#34;CN=&#34;</span>
</span></span><span style="display:flex;"><span>$cert_owner = ((($spm.Certificate.Issuer) -split <span style="color:#e6db74">&#34;, &#34;</span>) | where {$_ <span style="color:#f92672">-match</span> <span style="color:#e6db74">&#34;O=&#34;</span>}) <span style="color:#f92672">-replace</span> <span style="color:#e6db74">&#34;O=&#34;</span>
</span></span><span style="display:flex;"><span>$Collections = New-Object System.Collections.Generic.List[<span style="color:#66d9ef">System.Object</span>]
</span></span><span style="display:flex;"><span>$Collections.Add([<span style="color:#66d9ef">PSCustomObject</span>]@{
</span></span><span style="display:flex;"><span>Host = $srv;
</span></span><span style="display:flex;"><span>Server = $info;
</span></span><span style="display:flex;"><span>Status =  $status;
</span></span><span style="display:flex;"><span>StatusCode = $status_code;
</span></span><span style="display:flex;"><span>Certificate = $cert_name;
</span></span><span style="display:flex;"><span>Issued = $cert_owner;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">End</span> = $date_end
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>$Collections
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
    
</div>
<p><code>Get-WebCertificate https://google.com</code></p>
<h2 id="csv">CSV</h2>
<p><code>Get-Service | Select Name,DisplayName,Status,StartType | Export-Csv -path &quot;$home\Desktop\Get-Service.csv&quot; -Append -Encoding Default</code> экспортировать в csv (-Encoding UTF8) <br>
<code>Import-Csv &quot;$home\Desktop\Get-Service.csv&quot; -Delimiter &quot;,&quot;</code> импортировать массив</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$data%20=%20ConvertFrom-Csv%20@%22%0d%0aRegion,State,Units,Price%0d%0aWest,Texas,927,923.71%0d%0a$null,Tennessee,466,770.67%0d%0a%22@">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$data = ConvertFrom-Csv <span style="color:#e6db74">@&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Region,State,Units,Price
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">West,Texas,927,923.71
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"></span>$null<span style="color:#e6db74">,Tennessee,466,770.67
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;@</span></span></span></code></pre></div>
    
</div>
<p><code>$systeminfo = systeminfo /FO csv | ConvertFrom-Csv</code> вывод работы программы в CSV и конвертация в объект <br>
<code>$systeminfo.&quot;Полный объем физической памяти&quot;</code> <br>
<code>$systeminfo.&quot;Доступная физическая память&quot;</code></p>
<h3 id="convertfrom-string">ConvertFrom-String</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="%27%0d%0alog%20=%20%0d%0a%7b%0d%0a%20%20%20level%20=%204;%0d%0a%7d;%0d%0a%27%20%7c%20ConvertFrom-String%60%20%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%b5%d1%82%20PSCustomObject%20%28%d1%80%d0%b0%d0%b7%d0%b1%d0%b8%d0%b2%d0%b0%d0%b5%d1%82%20%d0%bf%d0%be%20%d0%bf%d1%80%d0%be%d0%b1%d0%b5%d0%bb%d0%b0%d0%bc,%20%d1%83%d0%b4%d0%b0%d0%bb%d1%8f%d0%b5%d1%82%20%d0%b2%d1%81%d0%b5%20%d0%bf%d1%80%d0%be%d0%b1%d0%b5%d0%bb%d1%8b%20%d0%b8%20%d0%bf%d1%83%d1%81%d1%82%d1%8b%d0%b5%20%d1%81%d1%82%d1%80%d0%be%d0%ba%d0%b8%29">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">log = 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   level = 4;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">};
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;</span> | ConvertFrom-String` создает PSCustomObject (разбивает по пробелам, удаляет все пробелы и пустые строки)</span></span></code></pre></div>
    
</div>
<h3 id="convertfrom-stringdata">ConvertFrom-StringData</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="%22%0d%0akey1%20=%20value1%0d%0akey2%20=%20value2%0d%0a%22%20%7c%20ConvertFrom-StringData%20#%20%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%b5%d1%82%20Hashtable">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">key1 = value1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">key2 = value2
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span> | ConvertFrom-StringData <span style="color:#75715e"># создает Hashtable</span></span></span></code></pre></div>
    
</div>
<h2 id="xml">XML</h2>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$xml%20=%20[xml]%28Get-Content%20$home%5cdesktop%5ctest.rdg%29%60%20%d0%bf%d1%80%d0%be%d1%87%d0%b8%d1%82%d0%b0%d1%82%d1%8c%20%d1%81%d0%be%d0%b4%d0%b5%d1%80%d0%b6%d0%b8%d0%bc%d0%be%d0%b5%20XML-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0%0d%0a$xml.load%28%22$home%5cdesktop%5ctest.rdg%22%29%60%20%d0%be%d1%82%d0%ba%d1%80%d1%8b%d1%82%d1%8c%20%d1%84%d0%b0%d0%b9%d0%bb%0d%0a$xml.RDCMan.file.group.properties.name%60%20%d0%b8%d0%bc%d0%b5%d0%bd%d0%b0%20%d0%b3%d1%80%d1%83%d0%bf%d0%bf%0d%0a$xml.RDCMan.file.group.server.properties%60%20%d0%b8%d0%bc%d0%b5%d0%bd%d0%b0%20%d0%b2%d1%81%d0%b5%d1%85%20%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%be%d0%b2%0d%0a$xml.RDCMan.file.group[3].server.properties%60%20%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba%20%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%be%d0%b2%20%d0%b2%204-%d0%b9%20%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d0%b5%0d%0a%28$xml.RDCMan.file.group[3].server.properties%20%7c%20?%20name%20-like%20ADIRK%29.Name%20=%20%22New-Name%22%60%20%d0%b8%d0%b7%d0%bc%d0%b5%d0%bd%d0%b8%d1%82%d1%8c%20%d0%b7%d0%bd%d0%b0%d1%87%d0%b5%d0%bd%d0%b8%d0%b5%0d%0a$xml.RDCMan.file.group[3].server[0].properties.displayName%20=%20%22New-displayName%22%20%0d%0a$xml.RDCMan.file.group[3].server[1].RemoveAll%28%29%60%20%d1%83%d0%b4%d0%b0%d0%bb%d0%b8%d1%82%d1%8c%20%d0%be%d0%b1%d1%8a%d0%b5%d0%ba%d1%82%20%282-%d0%b9%20%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%20%d0%b2%20%d1%81%d0%bf%d0%b8%d1%81%d0%ba%d0%b5%29%0d%0a$xml.Save%28$file%29%60%20%d1%81%d0%be%d1%85%d1%80%d0%b0%d0%bd%d0%b8%d1%82%d1%8c%20%d1%81%d0%be%d0%b4%d0%b5%d1%80%d0%b6%d0%b8%d0%bc%d0%be%d0%b5%20%d0%be%d0%b1%d1%8a%d0%b5%d0%ba%d1%82%d0%b0%20%d0%b2%20%d1%84%d0%b0%d0%b9%d0%bb%d0%b0">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$xml = [<span style="color:#66d9ef">xml</span>](Get-Content $home\desktop\test.rdg)` прочитать содержимое XML-файла
</span></span><span style="display:flex;"><span>$xml.load(<span style="color:#e6db74">&#34;</span>$home<span style="color:#e6db74">\desktop\test.rdg&#34;</span>)` открыть файл
</span></span><span style="display:flex;"><span>$xml.RDCMan.file.group.properties.name` имена групп
</span></span><span style="display:flex;"><span>$xml.RDCMan.file.group.server.properties` имена всех серверов
</span></span><span style="display:flex;"><span>$xml.RDCMan.file.group[<span style="color:#ae81ff">3</span>].server.properties` список серверов в <span style="color:#ae81ff">4</span>-й группе
</span></span><span style="display:flex;"><span>($xml.RDCMan.file.group[<span style="color:#ae81ff">3</span>].server.properties | ? name <span style="color:#f92672">-like</span> ADIRK).Name = <span style="color:#e6db74">&#34;New-Name&#34;</span>` изменить значение
</span></span><span style="display:flex;"><span>$xml.RDCMan.file.group[<span style="color:#ae81ff">3</span>].server[<span style="color:#ae81ff">0</span>].properties.displayName = <span style="color:#e6db74">&#34;New-displayName&#34;</span> 
</span></span><span style="display:flex;"><span>$xml.RDCMan.file.group[<span style="color:#ae81ff">3</span>].server[<span style="color:#ae81ff">1</span>].RemoveAll()` удалить объект (<span style="color:#ae81ff">2</span>-й сервер в списке)
</span></span><span style="display:flex;"><span>$xml.Save($file)` сохранить содержимое объекта в файла</span></span></code></pre></div>
    
</div>
<p><code>Get-Service | Export-Clixml -path $home\desktop\test.xml</code> экспортировать объект PowerShell в XML <br>
<code>Import-Clixml -Path $home\desktop\test.xml</code> импортировать объект XML в PowerShell <br>
<code>ConvertTo-Xml (Get-Service)</code></p>
<h3 id="get-credtoxml">Get-CredToXML</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="function%20Get-CredToXML%20%7b%0d%0a%20%20%20%20param%20%28%0d%0a%20%20%20%20%20%20%20%20$CredFile%20=%20%22$home%5cDocuments%5ccred.xml%22%0d%0a%20%20%20%20%29%0d%0a%20%20%20%20if%20%28Test-Path%20$CredFile%29%20%7b%0d%0a%20%20%20%20%20%20%20%20Import-Clixml%20-path%20$CredFile%0d%0a%20%20%20%20%7d%0d%0a%20%20%20%20elseif%20%28!%28Test-Path%20$CredFile%29%29%20%7b%0d%0a%20%20%20%20%20%20%20%20$Cred%20=%20Get-Credential%20-Message%20%22Enter%20credential%22%0d%0a%20%20%20%20%20%20%20%20if%20%28$Cred%20-ne%20$null%29%20%7b%0d%0a%20%20%20%20%20%20%20%20$Cred%20%7c%20Export-CliXml%20-Path%20$CredFile%0d%0a%20%20%20%20%20%20%20%20$Cred%0d%0a%20%20%20%20%7d%0d%0a%20%20%20%20else%20%7b%0d%0a%20%20%20%20%20%20%20%20return%0d%0a%20%20%20%20%7d%0d%0a%20%20%20%20%7d%0d%0a%7d">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Get-CredToXML {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">param</span> (
</span></span><span style="display:flex;"><span>        $CredFile = <span style="color:#e6db74">&#34;</span>$home<span style="color:#e6db74">\Documents\cred.xml&#34;</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (Test-Path $CredFile) {
</span></span><span style="display:flex;"><span>        Import-Clixml -path $CredFile
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elseif</span> (!(Test-Path $CredFile)) {
</span></span><span style="display:flex;"><span>        $Cred = Get-Credential -Message <span style="color:#e6db74">&#34;Enter credential&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($Cred <span style="color:#f92672">-ne</span> $null) {
</span></span><span style="display:flex;"><span>        $Cred | Export-CliXml -Path $CredFile
</span></span><span style="display:flex;"><span>        $Cred
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
    
</div>
<p><code>$Cred = Get-CredToXML</code> <br>
<code>$Login = $Cred.UserName</code> <br>
<code>$PasswordText = $Cred.GetNetworkCredential().password</code> получить пароль в текстовом виде</p>
<h3 id="xmlwriter-extensible-markup-language">XmlWriter (Extensible Markup Language)</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$XmlWriterSettings = New-Object System.Xml.XmlWriterSettings
</span></span><span style="display:flex;"><span>$XmlWriterSettings.Indent = $true` включить отступы
</span></span><span style="display:flex;"><span>$XmlWriterSettings.IndentChars = <span style="color:#e6db74">&#34;    &#34;</span>` задать отступ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$XmlFilePath = <span style="color:#e6db74">&#34;</span>$home<span style="color:#e6db74">\desktop\test.xml&#34;</span>
</span></span><span style="display:flex;"><span>$XmlObjectWriter = [<span style="color:#66d9ef">System.XML.XmlWriter</span>]::Create($XmlFilePath, $XmlWriterSettings)` создать документ
</span></span><span style="display:flex;"><span>$XmlObjectWriter.WriteStartDocument()` начать запись в документ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$XmlObjectWriter.WriteComment(<span style="color:#e6db74">&#34;Comment&#34;</span>)
</span></span><span style="display:flex;"><span>$XmlObjectWriter.WriteStartElement(<span style="color:#e6db74">&#34;Root&#34;</span>)` создать стартовый элемент, который содержит дочерние объекты
</span></span><span style="display:flex;"><span>    $XmlObjectWriter.WriteStartElement(<span style="color:#e6db74">&#34;Configuration&#34;</span>)` создать первый дочерний элемент для BaseSettings
</span></span><span style="display:flex;"><span>        $XmlObjectWriter.WriteElementString(<span style="color:#e6db74">&#34;Language&#34;</span>,<span style="color:#e6db74">&#34;RU&#34;</span>)
</span></span><span style="display:flex;"><span>        $XmlObjectWriter.WriteStartElement(<span style="color:#e6db74">&#34;Fonts&#34;</span>)   		<span style="color:#75715e"># &lt;Fonts&gt;</span>
</span></span><span style="display:flex;"><span>            $XmlObjectWriter.WriteElementString(<span style="color:#e6db74">&#34;Name&#34;</span>,<span style="color:#e6db74">&#34;Arial&#34;</span>)
</span></span><span style="display:flex;"><span>            $XmlObjectWriter.WriteElementString(<span style="color:#e6db74">&#34;Size&#34;</span>,<span style="color:#e6db74">&#34;12&#34;</span>)
</span></span><span style="display:flex;"><span>        $XmlObjectWriter.WriteEndElement()               	<span style="color:#75715e"># &lt;/Fonts&gt;</span>
</span></span><span style="display:flex;"><span>    $XmlObjectWriter.WriteEndElement()` конечный элемент &lt;/Configuration&gt;
</span></span><span style="display:flex;"><span>$XmlObjectWriter.WriteEndElement()` конечный элемент &lt;/Root&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$XmlObjectWriter.WriteEndDocument()` завершить запись в документ
</span></span><span style="display:flex;"><span>$XmlObjectWriter.Flush()
</span></span><span style="display:flex;"><span>$XmlObjectWriter.Close()</span></span></code></pre></div>
    
</div>
<h3 id="createelement">CreateElement</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$xml%20=%20[xml]%28gc%20$home%5cdesktop%5ctest.xml%29%0d%0a$xml.Root.Configuration.Fonts%0d%0a$NewElement%20=%20$xml.CreateElement%28%22Fonts%22%29%60%20%d0%b2%d1%8b%d0%b1%d1%80%d0%b0%d1%82%d1%8c%20%d1%8d%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d1%82%20%d0%ba%d1%83%d0%b4%d0%b0%20%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%b8%d1%82%d1%8c%0d%0a$NewElement.set_InnerXML%28%22%3cName%3eTimes%20New%20Roman%3c/Name%3e%3cSize%3e14%3c/Size%3e%22%29%60%20%d0%97%d0%b0%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d1%8c%20%d0%b7%d0%bd%d0%b0%d1%87%d0%b5%d0%bd%d0%b8%d1%8f%d0%bc%d0%b8%20%d0%b4%d0%be%d1%87%d0%b5%d1%80%d0%bd%d0%b8%d0%b5%20%d1%8d%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d1%82%d1%8b%20Fonts%0d%0a$xml.Root.Configuration.AppendChild%28$NewElement%29%60%20%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%b8%d1%82%d1%8c%20%d1%8d%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d1%82%20%d0%bd%d0%be%d0%b2%d0%be%d0%b9%20%d1%81%d1%82%d1%80%d0%be%d0%ba%d0%be%d0%b9%20%d0%b2%20Configuration%20%28%d1%80%d0%be%d0%b4%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%20Fonts%29%0d%0a$xml.Save%28%22$home%5cdesktop%5ctest.xml%22%29">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$xml = [<span style="color:#66d9ef">xml</span>](gc $home\desktop\test.xml)
</span></span><span style="display:flex;"><span>$xml.Root.Configuration.Fonts
</span></span><span style="display:flex;"><span>$NewElement = $xml.CreateElement(<span style="color:#e6db74">&#34;Fonts&#34;</span>)` выбрать элемент куда добавить
</span></span><span style="display:flex;"><span>$NewElement.set_InnerXML(<span style="color:#e6db74">&#34;&lt;Name&gt;Times New Roman&lt;/Name&gt;&lt;Size&gt;14&lt;/Size&gt;&#34;</span>)` Заполнить значениями дочерние элементы Fonts
</span></span><span style="display:flex;"><span>$xml.Root.Configuration.AppendChild($NewElement)` добавить элемент новой строкой в Configuration (родитель Fonts)
</span></span><span style="display:flex;"><span>$xml.Save(<span style="color:#e6db74">&#34;</span>$home<span style="color:#e6db74">\desktop\test.xml&#34;</span>)</span></span></code></pre></div>
    
</div>
<h1 id="json">JSON</h1>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$log = <span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;log&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;level&#34;: 7
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;</span> | ConvertFrom-Json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Get-Service | ConvertTo-Json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$OOKLA  = <span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;result&#34; : 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;date&#34;:1683534970,&#34;id&#34;:&#34;14708271987&#34;,&#34;connection_icon&#34;:&#34;wireless&#34;,&#34;download&#34;:33418,&#34;upload&#34;:35442,&#34;latency&#34;:15,&#34;distance&#34;:50,&#34;country_code&#34;:&#34;RU&#34;,&#34;server_id&#34;:2707,&#34;server_name&#34;:&#34;Bryansk&#34;,&#34;sponsor_name&#34;:&#34;DOM.RU&#34;,&#34;sponsor_url&#34;:null,&#34;connection_mode&#34;:&#34;multi&#34;,&#34;isp_name&#34;:&#34;Resource Link&#34;,&#34;isp_rating&#34;:&#34;4.0&#34;,&#34;test_rank&#34;:63,&#34;test_grade&#34;:&#34;B-&#34;,&#34;test_rating&#34;:4,&#34;idle_latency&#34;:&#34;17&#34;,&#34;download_latency&#34;:&#34;116&#34;,&#34;upload_latency&#34;:&#34;75&#34;,&#34;additional_servers&#34;:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[{&#34;server_id&#34;:8191,&#34;server_name&#34;:&#34;Bryansk&#34;,&#34;sponsor_name&#34;:&#34;SectorTelecom.ru&#34;},{&#34;server_id&#34;:46278,&#34;server_name&#34;:&#34;Fokino&#34;,&#34;sponsor_name&#34;:&#34;Fokks - Promyshlennaya avtomatika Ltd.&#34;},{&#34;server_id&#34;:18218,&#34;server_name&#34;:&#34;Bryansk&#34;,&#34;sponsor_name&#34;:&#34;RIA-link Ltd.&#34;}],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;path&#34;:&#34;result\u002F14708271987&#34;,&#34;hasSecondary&#34;:true
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;</span> | ConvertFrom-Json
</span></span><span style="display:flex;"><span>$ookla.result</span></span></code></pre></div>
    
</div>
<h2 id="yaml">YAML</h2>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="Import-Module%20PSYaml%60%20%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d1%83%d0%b5%d1%82%d1%81%d1%8f%20%d0%b2%20Docker/Ansible%0d%0a$netplan%20=%20%22%0d%0anetwork:%60%20%d1%81%d0%bb%d0%be%d0%b2%d0%b0%d1%80%d1%8c%20%d0%bf%d0%be%20%d1%82%d0%b8%d0%bf%d1%83%20-%20%d0%ba%d0%bb%d1%8e%d1%87%20:%20%d0%b7%d0%bd%d0%b0%d1%87%d0%b5%d0%bd%d0%b8%d0%b5%20%d1%81%20%d0%b2%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%bd%d1%8b%d0%bc%d0%b8%20%d1%81%d0%bb%d0%be%d0%b2%d0%b0%d1%80%d1%8f%d0%bc%d0%b8%0d%0a%20%20ethernets:%0d%0a%20%20%20%20ens160:%0d%0a%20%20%20%20%20%20dhcp4:%20yes%0d%0a%20%20%20%20%20%20dhcp6:%20no%0d%0a%20%20%20%20%20%20nameservers:%0d%0a%20%20%20%20%20%20%20%20addresses:%60%20[8.8.8.8,%201.1.1.1]%60%20%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba%20%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d1%85%20%28%d1%81%d1%82%d1%80%d0%be%d0%ba%29%0d%0a%09%09%20%20-%208.8.8.8%0d%0a%09%09%20%20-%201.1.1.1%0d%0a%20%20version:%202%0d%0a%22%0d%0a$network%20=%20ConvertFrom-Yaml%20$netplan%0d%0a$network.Values.ethernets.ens160.nameservers%0d%0a%0d%0a$DataType%20=%20%22%0d%0aint:%20!!int%2010.1%0d%0aflo:%20!!float%2010.1%0d%0astr:%20!!str%20string%0d%0abool:%20!!bool%60%20boolean%0d%0a%22">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>Import-Module PSYaml` используется в Docker/Ansible
</span></span><span style="display:flex;"><span>$netplan = <span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">network:` словарь по типу - ключ : значение с вложенными словарями
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  ethernets:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ens160:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      dhcp4: yes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      dhcp6: no
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      nameservers:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        addresses:` [8.8.8.8, 1.1.1.1]` список данных (строк)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">		  - 8.8.8.8
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">		  - 1.1.1.1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  version: 2
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>$network = ConvertFrom-Yaml $netplan
</span></span><span style="display:flex;"><span>$network.Values.ethernets.ens160.nameservers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$DataType = <span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int: !!int 10.1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">flo: !!float 10.1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">str: !!str string
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">bool: !!bool` boolean
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span></span></span></code></pre></div>
    
</div>
<h2 id="sqlite">SQLite</h2>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$path%20=%20%22$home%5cDocuments%5cGet-Service.db%22%0d%0a$Module%20=%20Get-Module%20MySQLite%0d%0aif%20%28$Module%20-eq%20$null%29%20%7b%0d%0aInstall-Module%20MySQLite%20-Repository%20PSGallery%20-Scope%20CurrentUser%0d%0a%7d%0d%0aImport-Module%20MySQLite%0d%0aNew-MySQLiteDB%20-Path%20$path%20#%20%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%82%d1%8c%20%d0%91%d0%94%0d%0aInvoke-MySQLiteQuery%20-Path%20$path%20-Query%20%22CREATE%20TABLE%20Service%20%28Name%20TEXT%20NOT%20NULL,%20DisplayName%20TEXT%20NOT%20NULL,%20Status%20TEXT%20NOT%20NULL%29;%22%20#%20%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%82%d1%8c%20%d1%82%d0%b0%d0%b1%d0%bb%d0%b8%d1%86%d1%83%0d%0a%0d%0a$Service%20=%20Get-Service%20%7c%20select%20Name,DisplayName,Status%0d%0aforeach%20%28$S%20in%20$Service%29%20%7b%0d%0a$Name%20=%20$S.Name%0d%0a$DName%20=%20$S.DisplayName%0d%0a$Status%20=%20$S.Status%0d%0aInvoke-MySQLiteQuery%20-Path%20$path%20-Query%20%22INSERT%20INTO%20Service%20%28Name,%20DisplayName,%20Status%29%20VALUES%20%28%27$Name%27,%20%27$DName%27,%20%27$Status%27%29;%22%0d%0a%7d">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$path = <span style="color:#e6db74">&#34;</span>$home<span style="color:#e6db74">\Documents\Get-Service.db&#34;</span>
</span></span><span style="display:flex;"><span>$Module = Get-Module MySQLite
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($Module <span style="color:#f92672">-eq</span> $null) {
</span></span><span style="display:flex;"><span>Install-Module MySQLite -Repository PSGallery -Scope CurrentUser
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>Import-Module MySQLite
</span></span><span style="display:flex;"><span>New-MySQLiteDB -Path $path <span style="color:#75715e"># создать БД</span>
</span></span><span style="display:flex;"><span>Invoke-MySQLiteQuery -Path $path -Query <span style="color:#e6db74">&#34;CREATE TABLE Service (Name TEXT NOT NULL, DisplayName TEXT NOT NULL, Status TEXT NOT NULL);&#34;</span> <span style="color:#75715e"># создать таблицу</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$Service = Get-Service | select Name,DisplayName,Status
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span> ($S <span style="color:#66d9ef">in</span> $Service) {
</span></span><span style="display:flex;"><span>$Name = $S.Name
</span></span><span style="display:flex;"><span>$DName = $S.DisplayName
</span></span><span style="display:flex;"><span>$Status = $S.Status
</span></span><span style="display:flex;"><span>Invoke-MySQLiteQuery -Path $path -Query <span style="color:#e6db74">&#34;INSERT INTO Service (Name, DisplayName, Status) VALUES (&#39;</span>$Name<span style="color:#e6db74">&#39;, &#39;</span>$DName<span style="color:#e6db74">&#39;, &#39;</span>$Status<span style="color:#e6db74">&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
    
</div>
<p><code>(Get-MySQLiteDB $path).Tables</code> список таблиц в базе <br>
<code>Invoke-MySQLiteQuery -Path $path -Query &quot;SELECT name FROM sqlite_master WHERE type='table';&quot;</code> список таблиц в базе <br>
<code>Invoke-MySQLiteQuery -Path $path -Query &quot;DROP TABLE Service;&quot;</code> удалить таблицу</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$TableName%20=%20%22Service%22%0d%0aInvoke-MySQLiteQuery%20-Path%20$path%20-Query%20%22SELECT%20*%20FROM%20$TableName%22%20#%20%d0%bf%d1%80%d0%be%d1%87%d0%b8%d1%82%d0%b0%d1%82%d1%8c%20%d1%81%d0%be%d0%b4%d0%b5%d1%80%d0%b6%d0%b8%d0%bc%d0%be%d0%b5%20%d1%82%d0%b0%d0%b1%d0%bb%d0%b8%d1%86%d1%8b%20%28%d0%b2%20%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%82%d0%b5%20%d0%be%d0%b1%d1%8a%d0%b5%d0%ba%d1%82%d0%b0%29">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$TableName = <span style="color:#e6db74">&#34;Service&#34;</span>
</span></span><span style="display:flex;"><span>Invoke-MySQLiteQuery -Path $path -Query <span style="color:#e6db74">&#34;SELECT * FROM </span>$TableName<span style="color:#e6db74">&#34;</span> <span style="color:#75715e"># прочитать содержимое таблицы (в формате объекта)</span></span></span></code></pre></div>
    
</div>
<p><code>Get-Service | select  Name,DisplayName,Status | ConvertTo-MySQLiteDB -Path $path -TableName Service -force</code> конвертировать объект в таблицу</p>
<h3 id="database-password">Database password</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$Connection%20=%20New-SQLiteConnection%20-DataSource%20$path%0d%0a$Connection.ChangePassword%28%22password%22%29%0d%0a$Connection.Close%28%29%0d%0aInvoke-SqliteQuery%20-Query%20%22SELECT%20*%20FROM%20Service%22%20-DataSource%20%22$path;Password=password%22">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$Connection = New-SQLiteConnection -DataSource $path
</span></span><span style="display:flex;"><span>$Connection.ChangePassword(<span style="color:#e6db74">&#34;password&#34;</span>)
</span></span><span style="display:flex;"><span>$Connection.Close()
</span></span><span style="display:flex;"><span>Invoke-SqliteQuery -Query <span style="color:#e6db74">&#34;SELECT * FROM Service&#34;</span> -DataSource <span style="color:#e6db74">&#34;</span>$path<span style="color:#e6db74">;Password=password&#34;</span></span></span></code></pre></div>
    
</div>
<h2 id="elasticsearch">Elasticsearch</h2>
<p><code>Install-Module -Name Elastic.Console -AllowPrerelease</code> <a href="https://github.com/elastic/powershell/blob/master/Elastic.Console/README.md">github source</a> <br>
<code>Get-Command -Module Elastic.Console</code> <br>
<code>Get-ElasticsearchVersion</code> <br>
<code>Set-ElasticsearchVersion 7.3.0</code> <br>
<code>Invoke-Elasticsearch</code> REST API запросы</p>
<h2 id="cdata">CData</h2>
<p><a href="https://www.powershellgallery.com/profiles/CData">PowerShell Gallery CData</a> <br>
<a href="https://www.cdata.com/kb/tech/elasticsearch-ado-powershell.rst">Automate Elasticsearch Integration Tasks from PowerShell</a></p>
<p><code>Install-Module ElasticsearchCmdlets</code> <a href="https://www.powershellgallery.com/packages/ElasticsearchCmdlets/23.0.8565.1">пакет драйвера в psgallery</a> <br>
<code>Import-Module ElasticsearchCmdlets</code> <br>
<code>Get-Command -Module ElasticsearchCmdlets</code></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$elasticsearch%20=%20Connect-Elasticsearch%20%20-Server%20%22$Server%22%20-Port%20%22$Port%22%20-User%20%22$User%22%20-Password%20%22$Password%22%0d%0a$shipcity%20=%20%22New%20York%22%0d%0a$orders%20=%20Select-Elasticsearch%20-Connection%20$elasticsearch%20-Table%20%22Orders%22%20-Where%20%22ShipCity%20=%20%60%27$ShipCity%60%27%22%60%20%d0%bf%d0%be%d0%b8%d1%81%d0%ba%20%d0%b8%20%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d1%85%0d%0a$orders%20=%20Invoke-Elasticsearch%20-Connection%20$elasticsearch%20-Query%20%27SELECT%20*%20FROM%20Orders%20WHERE%20ShipCity%20=%20@ShipCity%27%20-Params%20@%7b%27@ShipCity%27=%27New%20York%27%7d%60%20SQL%20%d0%b7%d0%b0%d0%bf%d1%80%d0%be%d1%81%d1%8b">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$elasticsearch = Connect-Elasticsearch  -Server <span style="color:#e6db74">&#34;</span>$Server<span style="color:#e6db74">&#34;</span> -Port <span style="color:#e6db74">&#34;</span>$Port<span style="color:#e6db74">&#34;</span> -User <span style="color:#e6db74">&#34;</span>$User<span style="color:#e6db74">&#34;</span> -Password <span style="color:#e6db74">&#34;</span>$Password<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>$shipcity = <span style="color:#e6db74">&#34;New York&#34;</span>
</span></span><span style="display:flex;"><span>$orders = Select-Elasticsearch -Connection $elasticsearch -Table <span style="color:#e6db74">&#34;Orders&#34;</span> -Where <span style="color:#e6db74">&#34;ShipCity = </span><span style="color:#ae81ff">`&#39;</span>$ShipCity<span style="color:#ae81ff">`&#39;</span><span style="color:#e6db74">&#34;</span>` поиск и получение данных
</span></span><span style="display:flex;"><span>$orders = Invoke-Elasticsearch -Connection $elasticsearch -Query <span style="color:#e6db74">&#39;SELECT * FROM Orders WHERE ShipCity = @ShipCity&#39;</span> -Params @{<span style="color:#e6db74">&#39;@ShipCity&#39;</span>=<span style="color:#e6db74">&#39;New York&#39;</span>}` SQL запросы</span></span></code></pre></div>
    
</div>
<h3 id="adonet-assembly">ADO.NET Assembly</h3>
<p><code>Install-Package CData.Elasticsearch</code> <a href="https://www.nuget.org/packages/CData.Elasticsearch">пакет драйвера в nuget</a> <br>
<code>[Reflection.Assembly]::LoadFile(&quot;C:\Program Files\PackageManagement\NuGet\Packages\CData.Elasticsearch.23.0.8565\lib\net40\System.Data.CData.Elasticsearch.dll&quot;)</code></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$connect%20=%20New-Object%20System.Data.CData.Elasticsearch.ElasticsearchConnection%28%22Server=127.0.0.1;Port=9200;User=admin;Password=123456;%22%29%0d%0a$connect.Open%28%29%0d%0a$sql%20=%20%22SELECT%20OrderName,%20Freight%20from%20Orders%22%0d%0a$da%20=%20New-Object%20System.Data.CData.Elasticsearch.ElasticsearchDataAdapter%28$sql,%20$conn%29%0d%0a$dt%20=%20New-Object%20System.Data.DataTable%0d%0a$da.Fill%28$dt%29%0d%0a$dt.Rows%20%7c%20foreach%20%7b%0d%0aWrite-Host%20$_.ordername%20$_.freight%0d%0a%7d">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$connect = New-Object System.Data.CData.Elasticsearch.ElasticsearchConnection(<span style="color:#e6db74">&#34;Server=127.0.0.1;Port=9200;User=admin;Password=123456;&#34;</span>)
</span></span><span style="display:flex;"><span>$connect.Open()
</span></span><span style="display:flex;"><span>$sql = <span style="color:#e6db74">&#34;SELECT OrderName, Freight from Orders&#34;</span>
</span></span><span style="display:flex;"><span>$da = New-Object System.Data.CData.Elasticsearch.ElasticsearchDataAdapter($sql, $conn)
</span></span><span style="display:flex;"><span>$dt = New-Object System.Data.DataTable
</span></span><span style="display:flex;"><span>$da.Fill($dt)
</span></span><span style="display:flex;"><span>$dt.Rows | <span style="color:#66d9ef">foreach</span> {
</span></span><span style="display:flex;"><span>Write-Host $_.ordername $_.freight
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
    
</div>
<h3 id="update">UPDATE</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="Update-Elasticsearch%20-Connection%20$Elasticsearch%20-Columns%20@%28%27OrderName%27,%27Freight%27%29%20-Values%20@%28%27MyOrderName%27,%20%27MyFreight%27%29%20-Table%20Orders%20-Id%20%22MyId%22%0d%0a%0d%0a$cmd%20=%20%20New-Object%20System.Data.CData.Elasticsearch.ElasticsearchCommand%28%22UPDATE%20Orders%20SET%20ShipCity=%27New%20York%27%20WHERE%20Id%20=%20@myId%22,%20$conn%29%0d%0a$cmd.Parameters.Add%28new%20System.Data.CData.Elasticsearch.ElasticsearchParameter%28%22@myId%22,%2210456255-0015501366%22%29%29%0d%0a$cmd.ExecuteNonQuery%28%29">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>Update-Elasticsearch -Connection $Elasticsearch -Columns @(<span style="color:#e6db74">&#39;OrderName&#39;</span>,<span style="color:#e6db74">&#39;Freight&#39;</span>) -Values @(<span style="color:#e6db74">&#39;MyOrderName&#39;</span>, <span style="color:#e6db74">&#39;MyFreight&#39;</span>) -Table Orders -Id <span style="color:#e6db74">&#34;MyId&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$cmd =  New-Object System.Data.CData.Elasticsearch.ElasticsearchCommand(<span style="color:#e6db74">&#34;UPDATE Orders SET ShipCity=&#39;New York&#39; WHERE Id = @myId&#34;</span>, $conn)
</span></span><span style="display:flex;"><span>$cmd.Parameters.Add(new System.Data.CData.Elasticsearch.ElasticsearchParameter(<span style="color:#e6db74">&#34;@myId&#34;</span>,<span style="color:#e6db74">&#34;10456255-0015501366&#34;</span>))
</span></span><span style="display:flex;"><span>$cmd.ExecuteNonQuery()</span></span></code></pre></div>
    
</div>
<h3 id="insert">INSERT</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="Add-Elasticsearch%20-Connection%20$Elasticsearch%20-Table%20Orders%20-Columns%20@%28%22OrderName%22,%20%22Freight%22%29%20-Values%20@%28%22MyOrderName%22,%20%22MyFreight%22%29%0d%0a%0d%0a$cmd%20=%20%20New-Object%20System.Data.CData.Elasticsearch.ElasticsearchCommand%28%22INSERT%20INTO%20Orders%20%28ShipCity%29%20VALUES%20%28@myShipCity%29%22,%20$conn%29%0d%0a$cmd.Parameters.Add%28new%20System.Data.CData.Elasticsearch.ElasticsearchParameter%28%22@myShipCity%22,%22New%20York%22%29%29%0d%0a$cmd.ExecuteNonQuery%28%29">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>Add-Elasticsearch -Connection $Elasticsearch -Table Orders -Columns @(<span style="color:#e6db74">&#34;OrderName&#34;</span>, <span style="color:#e6db74">&#34;Freight&#34;</span>) -Values @(<span style="color:#e6db74">&#34;MyOrderName&#34;</span>, <span style="color:#e6db74">&#34;MyFreight&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$cmd =  New-Object System.Data.CData.Elasticsearch.ElasticsearchCommand(<span style="color:#e6db74">&#34;INSERT INTO Orders (ShipCity) VALUES (@myShipCity)&#34;</span>, $conn)
</span></span><span style="display:flex;"><span>$cmd.Parameters.Add(new System.Data.CData.Elasticsearch.ElasticsearchParameter(<span style="color:#e6db74">&#34;@myShipCity&#34;</span>,<span style="color:#e6db74">&#34;New York&#34;</span>))
</span></span><span style="display:flex;"><span>$cmd.ExecuteNonQuery()</span></span></code></pre></div>
    
</div>
<h3 id="delete">DELETE</h3>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="Remove-Elasticsearch%20-Connection%20$Elasticsearch%20-Table%20%22Orders%22%20-Id%20%22MyId%22%0d%0a%0d%0a$cmd%20=%20%20New-Object%20System.Data.CData.Elasticsearch.ElasticsearchCommand%28%22DELETE%20FROM%20Orders%20WHERE%20Id=@myId%22,%20$conn%29%0d%0a$cmd.Parameters.Add%28new%20System.Data.CData.Elasticsearch.ElasticsearchParameter%28%22@myId%22,%22001d000000YBRseAAH%22%29%29%0d%0a$cmd.ExecuteNonQuery%28%29">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>Remove-Elasticsearch -Connection $Elasticsearch -Table <span style="color:#e6db74">&#34;Orders&#34;</span> -Id <span style="color:#e6db74">&#34;MyId&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$cmd =  New-Object System.Data.CData.Elasticsearch.ElasticsearchCommand(<span style="color:#e6db74">&#34;DELETE FROM Orders WHERE Id=@myId&#34;</span>, $conn)
</span></span><span style="display:flex;"><span>$cmd.Parameters.Add(new System.Data.CData.Elasticsearch.ElasticsearchParameter(<span style="color:#e6db74">&#34;@myId&#34;</span>,<span style="color:#e6db74">&#34;001d000000YBRseAAH&#34;</span>))
</span></span><span style="display:flex;"><span>$cmd.ExecuteNonQuery()</span></span></code></pre></div>
    
</div>
<h2 id="odbc-open-database-connectivity">ODBC (Open Database Connectivity)</h2>
<p><code>Get-Command -Module Wdac</code> <br>
<code>Get-OdbcDriver | ft</code> список установленных драйверов</p>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/sql-client-apps-ps1.html">Elasticsearch ODBC драйвер для доступа к данным Elasticsearch из Microsoft PowerShell</a></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$connectstring%20=%20%22DSN=Local%20Elasticsearch;%22%0d%0a$sql%20=%20%22SELECT%20*%20FROM%20library%22%0d%0a$conn%20=%20New-Object%20System.Data.Odbc.OdbcConnection%28$connectstring%29%0d%0a$conn.open%28%29%0d%0a$cmd%20=%20New-Object%20system.Data.Odbc.OdbcCommand%28$sql,$conn%29%0d%0a$da%20=%20New-Object%20system.Data.Odbc.OdbcDataAdapter%28$cmd%29%0d%0a$dt%20=%20New-Object%20system.Data.datatable%0d%0a$null%20=%20$da.fill%28$dt%29%0d%0a$conn.close%28%29%0d%0a$dt">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$connectstring = <span style="color:#e6db74">&#34;DSN=Local Elasticsearch;&#34;</span>
</span></span><span style="display:flex;"><span>$sql = <span style="color:#e6db74">&#34;SELECT * FROM library&#34;</span>
</span></span><span style="display:flex;"><span>$conn = New-Object System.Data.Odbc.OdbcConnection($connectstring)
</span></span><span style="display:flex;"><span>$conn.open()
</span></span><span style="display:flex;"><span>$cmd = New-Object system.Data.Odbc.OdbcCommand($sql,$conn)
</span></span><span style="display:flex;"><span>$da = New-Object system.Data.Odbc.OdbcDataAdapter($cmd)
</span></span><span style="display:flex;"><span>$dt = New-Object system.Data.datatable
</span></span><span style="display:flex;"><span>$null = $da.fill($dt)
</span></span><span style="display:flex;"><span>$conn.close()
</span></span><span style="display:flex;"><span>$dt</span></span></code></pre></div>
    
</div>
<h2 id="postgresql">PostgreSQL</h2>
<p><a href="https://www.postgresql.org/ftp/odbc/versions/msi/">Скачать и установить драйвер</a></p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="$dbServer%20=%20%22192.168.3.101%22%0d%0a$port%20=%20%225432%22%0d%0a$dbName%20=%20%22test%22%0d%0a$dbUser%20=%20%22admin%22%0d%0a$dbPass%20=%20%22admin%22%0d%0a$szConnect%20=%20%22Driver=%7bPostgreSQL%20Unicode%28x64%29%7d;Server=$dbServer;Port=$port;Database=$dbName;Uid=$dbUser;Pwd=$dbPass;%22%20%0d%0a%0d%0a$cnDB%20=%20New-Object%20System.Data.Odbc.OdbcConnection%28$szConnect%29%0d%0a$dsDB%20=%20New-Object%20System.Data.DataSet%0d%0atry%20%7b%0d%0a%20%20%20%20$cnDB.Open%28%29%0d%0a%20%20%20%20$adDB%20=%20New-Object%20System.Data.Odbc.OdbcDataAdapter%0d%0a%20%20%20%20$adDB.SelectCommand%20=%20New-Object%20System.Data.Odbc.OdbcCommand%28%22SELECT%20id,%20name,%20age,%20login%20FROM%20public.users%22%20,%20$cnDB%29%0d%0a%20%20%20%20$adDB.Fill%28$dsDB%29%0d%0a%20%20%20%20$cnDB.Close%28%29%0d%0a%7d%0d%0acatch%20[System.Data.Odbc.OdbcException]%20%7b%0d%0a%20%20%20%20$_.Exception%0d%0a%20%20%20%20$_.Exception.Message%0d%0a%20%20%20%20$_.Exception.ItemName%0d%0a%7d%0d%0aforeach%20%28$row%20in%20$dsDB[0].Tables[0].Rows%29%20%7b%0d%0a%20%20%20%20$row.login%0d%0a%20%20%20%20$row.age%0d%0a%7d">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$dbServer = <span style="color:#e6db74">&#34;192.168.3.101&#34;</span>
</span></span><span style="display:flex;"><span>$port = <span style="color:#e6db74">&#34;5432&#34;</span>
</span></span><span style="display:flex;"><span>$dbName = <span style="color:#e6db74">&#34;test&#34;</span>
</span></span><span style="display:flex;"><span>$dbUser = <span style="color:#e6db74">&#34;admin&#34;</span>
</span></span><span style="display:flex;"><span>$dbPass = <span style="color:#e6db74">&#34;admin&#34;</span>
</span></span><span style="display:flex;"><span>$szConnect = <span style="color:#e6db74">&#34;Driver={PostgreSQL Unicode(x64)};Server=</span>$dbServer<span style="color:#e6db74">;Port=</span>$port<span style="color:#e6db74">;Database=</span>$dbName<span style="color:#e6db74">;Uid=</span>$dbUser<span style="color:#e6db74">;Pwd=</span>$dbPass<span style="color:#e6db74">;&#34;</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$cnDB = New-Object System.Data.Odbc.OdbcConnection($szConnect)
</span></span><span style="display:flex;"><span>$dsDB = New-Object System.Data.DataSet
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>    $cnDB.Open()
</span></span><span style="display:flex;"><span>    $adDB = New-Object System.Data.Odbc.OdbcDataAdapter
</span></span><span style="display:flex;"><span>    $adDB.SelectCommand = New-Object System.Data.Odbc.OdbcCommand(<span style="color:#e6db74">&#34;SELECT id, name, age, login FROM public.users&#34;</span> , $cnDB)
</span></span><span style="display:flex;"><span>    $adDB.Fill($dsDB)
</span></span><span style="display:flex;"><span>    $cnDB.Close()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">catch</span> [<span style="color:#66d9ef">System.Data.Odbc.OdbcException</span>] {
</span></span><span style="display:flex;"><span>    $_.Exception
</span></span><span style="display:flex;"><span>    $_.Exception.Message
</span></span><span style="display:flex;"><span>    $_.Exception.ItemName
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span> ($row <span style="color:#66d9ef">in</span> $dsDB[<span style="color:#ae81ff">0</span>].Tables[<span style="color:#ae81ff">0</span>].Rows) {
</span></span><span style="display:flex;"><span>    $row.login
</span></span><span style="display:flex;"><span>    $row.age
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
    
</div>

            
        </div>
    </article>

        </main>

        <footer class="footer">
    <div class="footer-left">
        <ul class="social">
            
                <li>GitHub</li>
            

            
                <li>Lifailon</li>
            

            
                
            
                
            
                
                    <li>
                        
                            <a href="https://github.com/Lifailon" target="_blank">
                                <i class="bi-github"></i>
                            </a>
                        

                    </li>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </ul>
    </div>

    <div class="footer-right">
        <ul class="control status clearfix">
            

            
            

            

            
                <li>
                    <a href="https://gohugo.io" class="btn" target="_blank"
                        >Hugo: 0.123.8</a
                    >
                </li>
            

            
                <li>
                    <a
                        href="https://github.com/JingWangTW/dark-theme-editor"
                        class="btn"
                        target="_blank"
                        >Theme: dark-theme-editor</a
                    >
                </li>
            

            
                <li>
                    
                        Last modified: &nbsp;
                        <time>
                            Mar 14 2024
                        </time>
                    
                </li>
            

            
        </ul>
    </div>
</footer>

    </body>

    























    
    


    
    


    <script
        type="text/javascript"
        src="/js/index_d751713.min.5eeb120f16ea146352725c420364f87befead45f678142b8f0ffbef024646931fbc06bff07a7bd6cb57fa2f8cd8a21ba6a4ee5a278ec32303a378bc1cd17f246.js"
        integrity="sha512-XusSDxbqFGNSclxCA2T4e&#43;/q1F9ngUK48P&#43;&#43;8CRkaTH7wGv/B6e9bLV/ovjNiiG6ak7lonjsMjA6N4vBzRfyRg=="></script>














<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />




</html>
