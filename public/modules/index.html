<!doctype html><html data-theme=light lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation) and RuDocs (node.js)" name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ff7800 name=theme-color><meta content=#ffa348 media=(prefers-color-scheme:dark) name=theme-color><meta content="default-src 'none';font-src 'self';img-src 'self' https: data:;media-src 'self' https:;style-src 'self' 'unsafe-inline';frame-src https://player.vimeo.com https://www.youtube-nocookie.com https://toot.community;frame-ancestors 'none';base-uri 'none';form-action 'none';connect-src 'self' https://toot.community;script-src 'self' 'self'" http-equiv=content-security-policy><title>Modules - PowerShell Commands / RuDocs</title><link href=https://lifailon.github.io/modules/ rel=canonical><link href=https://lifailon.github.io/favicon.png rel=icon type=image/png><link href=https://lifailon.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link title="PowerShell Commands / RuDocs - RSS Feed" href=https://lifailon.github.io/rss.xml rel=alternate type=application/rss+xml><link title="PowerShell Commands / RuDocs - Atom Feed" href=https://lifailon.github.io/atom.xml rel=alternate type=application/atom+xml><style>:root{--accent-color:#ff7800;--contrast-color:#000c}[data-theme=dark]{--accent-color:#ffa348}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--accent-color:#ffa348}}[data-theme=dark]{--contrast-color:#000c}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--contrast-color:#000c}}</style><link href=https://lifailon.github.io/style.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=https://lifailon.github.io/syntax-theme-light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://lifailon.github.io/syntax-theme-dark.css rel=stylesheet><script defer src=https://lifailon.github.io/closable.js></script><script defer src=https://lifailon.github.io/copy-button.js></script><script defer src=https://lifailon.github.io/elasticlunr.min.js></script><script defer src=https://lifailon.github.io/search-elasticlunr.js></script><script defer src=https://lifailon.github.io/theme-switcher.js></script><meta content="PowerShell Commands / RuDocs" property=og:site_name><meta content="Modules - PowerShell Commands / RuDocs" property=og:title><meta content=https://lifailon.github.io/modules/ property=og:url><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation) and RuDocs (node.js)" property=og:description><meta content=https://lifailon.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><div id=handle></div><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://lifailon.github.io> <i class=icon></i>PowerShell Commands / RuDocs</a><li class=divider><li><details class=closable><summary>PowerShell</summary> <ul><li><a href=https://lifailon.github.io/syntax/>PowerShell Syntax</a><li><a href=https://lifailon.github.io/filesystem/>File System</a><li><a href=https://lifailon.github.io/windows/>Operating System</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/threads/>Threads</a><li><a class=active href=https://lifailon.github.io/modules/>Modules</a><li><a href=https://lifailon.github.io/dotnet/>dotNET</a><li><a href=https://lifailon.github.io/com/>COM</a><li><a href=https://lifailon.github.io/servermanager/>Server Manager</a><li><a href=https://lifailon.github.io/activedirectory/>Active Directory</a><li><a href=https://lifailon.github.io/exchange/>Exchange</a><li><a href=https://lifailon.github.io/virtualization/>Virtualization</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/markuplanguages/>Markup Languages</a><li><a href=https://lifailon.github.io/api/>API</a><li><a href=https://lifailon.github.io/zabbix/>Zabbix</a><li><a href=https://lifailon.github.io/devops/>DevOps</a></ul></details><li><a href=https://lifailon.github.io/node-js/>Node.js</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li id=search><button class=circle id=search-toggle title=Search><i class=icon></i></button><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details><li id=repo><a class=circle href=https://github.com/Lifailon/PS-Commands title=Repository> <i class=icon></i> </a></ul></nav><div id=search-container><label class=visually-hidden for=search-bar>Search</label><input placeholder="Search for…" autocomplete=off disabled id=search-bar type=search><div id=search-results-container><div id=search-results></div></div></div></header><main id=main-content><h1>Modules</h1><h3 id=psm1><a aria-label="Anchor link for: psm1" class=zola-anchor href=#psm1><i class=icon></i></a> psm1</h3><p>Синтаксис модуля и его параметров<pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-Function</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-block z-powershell"><span class="z-punctuation z-definition z-comment z-block z-begin z-powershell"><#</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">SYNOPSIS</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    Описание
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">DESCRIPTION</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    Описание
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">LINK</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    https://github.com/Lifailon/PS-Commands
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    <span class="z-punctuation z-definition z-comment z-block z-end z-powershell">#></span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-parameter z-attribute z-powershell">ValueFromPipeline</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Text</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">ValidateSet</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test2<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Provider</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">ValidateRange</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Number</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-keyword z-control z-powershell">Param</span> Text: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Text</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-keyword z-control z-powershell">Param</span> Provider: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Provider</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-keyword z-control z-powershell">Param</span> Number: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Number</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Get-Function -Text Text1</code><br> <code>Get-Function -Text Text2 -Provider Test2 -Number 3</code><h3 id=psd1><a aria-label="Anchor link for: psd1" class=zola-anchor href=#psd1><i class=icon></i></a> psd1</h3><p>Описание модуля<pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">RootModule</span>        <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Get-Function.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ModuleVersion</span>     <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>0.1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Author</span>            <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Lifailon<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">CompanyName</span>       <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Open Source Community<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Copyright</span>         <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Apache-2.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Description</span>       <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Function example<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">PowerShellVersion</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>7.2<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">PrivateData</span>       <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">PSData</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Tags</span>         <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Function<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Example<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ProjectUri</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/Lifailon/PS-Commands<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">LicenseUri</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/Lifailon/Console-Translate/blob/rsa/LICENSE<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ReleaseNotes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Second release<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h2 id=packagemanagement><a aria-label="Anchor link for: packagemanagement" class=zola-anchor href=#packagemanagement><i class=icon></i></a> PackageManagement</h2><p><code>Import-Module PackageManagement</code> импортировать модуль<br> <code>Get-Module PackageManagement</code> информация о модуле<br> <code>Get-Command -Module PackageManagement</code> отобразить все командлеты модуля<br> <code>Get-Package</code> отобразить все установленные пакеты PowerShellGallery<br> <code>Get-Package -ProviderName msi,Programs</code> список установленных программ<br> <code>[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12</code> включить использование протокол TLS 1.2 (если не отключены протоколы TLS 1.0 и 1.1)<br> <code>Get-PackageSource</code> источники установки пакетов<br> <code>Get-PackageProvider</code> отобразить список провайдеров менеджеров пакетов<br> <code>Get-PackageProvider | Where-Object Name -Match nuget</code><br> <code>Find-PackageProvider</code> отображение всех доступных менеджеров пакетов<br> <code>Find-PackageProvider nuget</code><br> <code>Install-PackageProvider NuGet -Force</code> установить менеджер пакетов nuget<br> <code>Install-PackageProvider PSGallery -Force</code> установить источник<br> <code>Install-PackageProvider Chocolatey -Force</code><br> <code>Set-PackageSource nuget -Trusted</code> разрешить установку пакетов из указанного источника<br> <code>Register-PSRepository -Name "NuGet" -SourceLocation "https://www.nuget.org/api/v2" -InstallationPolicy Trusted</code> зарегестрировать менеджер пакетов используя url (работает для Power Shell Core)<br> <code>Set-PackageSource -Name NuGet -Trusted</code> изменить источник по умолчанию<br> <code>Find-Package PSEverything</code> поиск пакетов по имени во всех менеджерах<br> <code>Find-Package PSEverything -Provider NuGet</code> поиск пакета у выбранного провайдера<br> <code>Install-Module PSEverything -Scope CurrentUser</code> установить модуль для текущего пользователя<br> <code>Install-Package -Name VeeamLogParser -ProviderName PSGallery -scope CurrentUser</code><br> <code>Get-Command *Veeam*</code><br> <code>Import-Module -Name VeeamLogParser</code> загрузить модуль<br> <code>Get-Module VeeamLogParser | select -ExpandProperty ExportedCommands</code> отобразить список функций<h3 id=winget><a aria-label="Anchor link for: winget" class=zola-anchor href=#winget><i class=icon></i></a> winget</h3><p><a href=https://github.com/microsoft/winget-cli>Source</a><br> <a href=https://winget.run>Web</a><p><code>winget list</code> список установленных пакетов<br> <code>winget search VLC</code> найти пакет<br> <code>winget show VideoLAN.VLC</code> информация о пакете<br> <code>winget show VideoLAN.VLC --versions</code> список доступных версий в репозитории<br> <code>winget install VideoLAN.VLC</code> установить пакет<br> <code>winget uninstall VideoLAN.VLC</code> удалить пакет<br> <code>winget download jqlang.jq</code> загрузкить пакет (https://github.com/jqlang/jq/releases/download/jq-1.7/jq-windows-amd64.exe)<br> <code>winget install jqlang.jq</code> добавляет в переменную среду и псевдоним командной строки jq<br> <code>winget uninstall jqlang.jq</code><h3 id=jqlang><a aria-label="Anchor link for: jqlang" class=zola-anchor href=#jqlang><i class=icon></i></a> jqlang</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">uri</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>irm https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">api.github.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>repos<span class="z-keyword z-operator z-assignment z-powershell">/</span>jqlang<span class="z-keyword z-operator z-assignment z-powershell">/</span>jq<span class="z-keyword z-operator z-assignment z-powershell">/</span>releases<span class="z-keyword z-operator z-assignment z-powershell">/</span>latest<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.assets.browser_download_url <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>windows-amd64<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.ToString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> получить версию latest на GitHub<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">irm <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Windows\System32\jq.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> загрузить jq.exe<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h3 id=scoop><a aria-label="Anchor link for: scoop" class=zola-anchor href=#scoop><i class=icon></i></a> Scoop</h3><p><code>Set-ExecutionPolicy RemoteSigned -Scope CurrentUser</code><br> <code>irm get.scoop.sh | iex</code> установка<br> <code>scoop help</code><br> <code>scoop search jq</code><br> <code>scoop info jq</code><br> <code>(scoop info jq).version</code><br> <code>scoop cat jq</code><br> <code>scoop download jq</code> C:<code>\Users</code>{=tex}<code>\lifailon</code>{=tex}<code>\scoop</code>{=tex}<code>\cache </code>{=tex}<br> <code>scoop install jq</code> C:<code>\Users</code>{=tex}<code>\lifailon</code>{=tex}<code>\scoop</code>{=tex}<code>\apps</code>{=tex}<code>\jq</code>{=tex}\1.7<br> <code>scoop list</code><br> <code>(scoop list).version</code><br> <code>scoop uninstall jq</code><h3 id=chocolatey><a aria-label="Anchor link for: chocolatey" class=zola-anchor href=#chocolatey><i class=icon></i></a> Chocolatey</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Set-ExecutionPolicy</span> Bypass <span class="z-keyword z-operator z-assignment z-powershell">-</span>Scope <span class="z-keyword z-control z-powershell">Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force<span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.ServicePointManager</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::SecurityProtocol <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.ServicePointManager</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::SecurityProtocol <span class="z-keyword z-operator z-bitwise z-powershell">-bor</span> <span class="z-constant z-numeric z-integer z-powershell">3072</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> iex <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">New-Object</span> System.Net.WebClient</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.DownloadString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>https://community.chocolatey.org/install.ps1<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><p><code>choco -v</code><br> <code>choco -help</code><br> <code>choco list</code><br> <code>choco install adobereader</code><h3 id=nuget><a aria-label="Anchor link for: nuget" class=zola-anchor href=#nuget><i class=icon></i></a> NuGet</h3><p><code>Invoke-RestMethod https://dist.nuget.org/win-x86-commandline/latest/nuget.exe -OutFile "$home\Documents\nuget.exe"</code><br> <code>Invoke-Expression "$home\Documents\nuget.exe search Selenium.WebDriver"</code><br> <code>Invoke-Expression "$home\Documents\nuget.exe install Selenium.WebDriver"</code><br> <code>Get-Item $home\Documents\*Selenium*</code><p><code>& "$home\Documents\nuget.exe" list console-translate</code><br> <code>$nuget_api_key = "&LTAPI-KEY>"</code><br> <code>$source = "https://api.nuget.org/v3/index.json"</code><br> <code>$Name = "Console-Translate"</code><br> <code>$path = "$home\Documents\$Name"</code><br> <code>New-Item -Type Directory $path</code><br> <code>Copy-Item "$home\Documents\Git\$Name\$Name\0.2\*" "$path\"</code><br> <code>Copy-Item "$home\Documents\Git\$Name\LICENSE" "$path\"</code><br> <code>Copy-Item "$home\Documents\Git\$Name\README.md" "$path\"</code><pre class="language-xml z-code" data-lang=xml><code class=language-xml data-lang=xml><span class="z-text z-xml">'<span class="z-meta z-tag z-preprocessor z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT?</span><span class="z-entity z-name z-tag z-xml">xml</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">version</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>1.0<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">?></span></span>
</span><span class="z-text z-xml"><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">package</span> <span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">  <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">metadata</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">id</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>Console-Translate<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">id</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">version</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>0.2.2<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">version</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">authors</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>Lifailon<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">authors</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">owners</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>Lifailon<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">owners</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">description</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>Cross-platform client for translating text in the console, uses API Google (edded public free token), MyMemory and DeepLX (no token required)<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">description</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">tags</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>PowerShell, Module, Translate, api<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">tags</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">repository</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>git<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">url</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>https://github.com/Lifailon/Console-Translate<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">projectUrl</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>https://github.com/Lifailon/Console-Translate<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">projectUrl</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">licenseUrl</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>https://github.com/Lifailon/Console-Translate/blob/rsa/LICENSE<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">licenseUrl</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">contentFiles</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Console-Translate.psm1<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Console-Translate.psd1<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>lang-iso-639-1.csv<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>README.md<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>LICENSE<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">contentFiles</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">  <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">metadata</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml"><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">package</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>' > "$path\$Name.nuspec"
</span></code></pre><p><code>Set-Location $path</code><br> <code>& "$home\Documents\nuget.exe" pack "$path\$Name.nuspec"</code><br> <code>& "$home\Documents\nuget.exe" push "$path\$Name.0.2.2.nupkg" -ApiKey $nuget_api_key -Source $source</code><br> <code>& "$home\Documents\nuget.exe" push "$path\$Name.0.2.2.nupkg" -ApiKey $nuget_api_key -Source $source -SkipDuplicate</code><p><code>Install-Package Console-Translate -Source nuget.org</code><br> <code>Get-Package Console-Translate | select *</code><p><code>Register-PSRepository -Name "NuGet" -SourceLocation "https://www.nuget.org/api/v2" -InstallationPolicy Trusted</code><br> <code>Get-PSRepository</code><br> <code>Find-Module -Name Console-Translate</code><br> <code>Install-Module Console-Translate -Repository NuGet</code><p><code>& "$home\Documents\nuget.exe" delete Console-Translate 0.2.0 -Source https://api.nuget.org/v3/index.json -ApiKey $nuget_api_key -NoPrompt</code><h2 id=ps2exe><a aria-label="Anchor link for: ps2exe" class=zola-anchor href=#ps2exe><i class=icon></i></a> PS2EXE</h2><p><code>Install-Module ps2exe -Repository PSGallery</code><br> <code>Get-Module -ListAvailable</code> список всех модулей<br> <code>-noConsole</code> использовать GUI, без окна консоли powershell<br> <code>-noOutput</code> выполнение в фоне<br> <code>-noError</code> без вывода ошибок<br> <code>-requireAdmin</code> при запуске запросить права администратора<br> <code>-credentialGUI</code> вывод диалогового окна для ввода учетных данных<br> <code>Invoke-ps2exe -inputFile "$home\Desktop\WinEvent-Viewer-1.1.ps1" -outputFile "$home\Desktop\WEV-1.1.exe" -iconFile "$home\Desktop\log_48px.ico" -title "WinEvent-Viewer" -noConsole -noOutput -noError</code><h2 id=nssm><a aria-label="Anchor link for: nssm" class=zola-anchor href=#nssm><i class=icon></i></a> NSSM</h2><p><code>$powershell_Path = (Get-Command powershell).Source</code><br> <code>$NSSM_Path = (Get-Command "C:\WinPerf-Agent\NSSM-2.24.exe").Source</code><br> <code>$Script_Path = "C:\WinPerf-Agent\WinPerf-Agent-1.1.ps1"</code><br> <code>$Service_Name = "WinPerf-Agent"</code><br> <code>& $NSSM_Path install $Service_Name $powershell_Path -ExecutionPolicy Bypass -NoProfile -f $Script_Path</code> создать Service<br> <code>& $NSSM_Path start $Service_Name</code> запустить<br> <code>& $NSSM_Path status $Service_Name</code> статус<br> <code>$Service_Name | Restart-Service</code> перезапустить<br> <code>$Service_Name | Get-Service</code> статус<br> <code>$Service_Name | Stop-Service</code> остановить<br> <code>& $NSSM_Path set $Service_Name description "Check performance CPU and report email"</code> изменить описание<br> <code>& $NSSM_Path remove $Service_Name</code> удалить<h2 id=winapi><a aria-label="Anchor link for: winapi" class=zola-anchor href=#winapi><i class=icon></i></a> WinAPI</h2><p><code>Install-Module ps.win.api -Repository NuGet -AllowClobber</code><br> <code>Import-Module ps.win.api</code><br> <code>Get-Command -Module ps.win.api</code><br> <code>Start-WinAPI</code> запустить сервер<br> <code>Test-WinAPI</code> статус сервера<br> <code>Stop-WinAPI</code> остановить сервер<br> <code>Read-WinAPI</code> отобразить лог в реальном времени<br> <code>Get-Hardware</code> вывести сводную информацию о системе с использованием потоков (фоновых заданий)<br> <code>Get-DiskPhysical</code> отобразить список физических дисков, их размер, интерфейс и статус<br> <code>Get-DiskPhysical -ComputerName 192.168.3.100 -Port 8443 -User rest -Pass api</code> получить информацию с удаленного сервер, на котором запущен сервер WinAPI (доступно для всех функций модуля)<br> <code>Get-DiskLogical</code> список логических дисков (включая виртуальные диски), их файловая система, общий и используемый размер в гб и процентах<br> <code>Get-DiskPartition</code> список разделов физических дисков (отобразит скрытые разделы, загрузочный и порядок назначения байт)<br> <code>Get-Smart</code> статус работы всех дисков и текущая температура<br> <code>Get-IOps</code> количество операций ввода/вывода дисковой подсистемы<br> <code>Get-Files</code> подробная информация о файлах (добавляет дату создания, изменения, доступа, количество дочерних файлов и директорий)<br> <code>Find-Process</code> поиск пути к исполняемому файлу по имени остановленного (не запущенного) процесса в директориях<br> <code>Get-ProcessPerformance</code> информация о процессах (Get-Process) в человеко-читаемом формате<br> <code>Get-CPU</code> список все ядер и нагрузка на каждое ядро и на все сразу (суммарное процессорное время, привилегированное и пользовательское время процессора)<br> <code>Get-MemorySize</code> размер оперативной, виртуальной памяти, суммарное потребление памяти процессов и путь к файлу подкачки<br> <code>Get-MemorySlots</code> список всех слотов оперативной памяти<br> <code>Get-NetInterfaceStat</code> статистика активного сетевого интерфейса за время с момента загрузки системы (количество пакетов и ГБ)<br> <code>Get-NetInterfaceStat -Current</code> текущая статистика активного сетевого интерфейса (количество пакетов и МБ/c)<br> <code>Get-NetIpConfig</code> конфигурация всех сетевых интерфейсов (ip и mac-адрес, статус DHCP сервера, дата аренды)<br> <code>Get-NetStat</code> развернутая статистика сетевых интерфейсов (из Get-NetTCPConnection), добавляет имя процесса, имя удаленного хоста (через nslookup), время работы процесса (не процессорное время) и путь к исполняемому файлу<br> <code>Get-Performance</code> информация из счетчиков (Get-Counter) человеко-читаемом формате<br> <code>Get-VideoCard</code> информация о всех видео-картах (наименование, частота и объем видео-памяти)<br> <code>Get-Software</code> список установленного програмного обеспечения<br> <code>Get-WinUpdate</code> список обновлений Windows (дата установки и источник)<br> <code>Get-Driver</code> список установленных драйверов (имя, провайдер, версия и дата установки)<h2 id=get-query><a aria-label="Anchor link for: get-query" class=zola-anchor href=#get-query><i class=icon></i></a> Get-Query</h2><p><code>Install-Module Get-Query -Repository NuGet</code> установить модуль<br> <code>Get-Help Get-Query</code><br> <code>Get-Query localhost</code> отобразить всех авторизованных пользователей, их статус и время работы (по умолчанию localhost)<br> <code>Get-Query 192.168.1.1.1 -proc</code> список всех пользовательских процессов (по умолчанию -user *)<br> <code>Get-Query 192.168.1.1.1 -proc -user username</code> список процессов указанного пользователя<h2 id=console-translate><a aria-label="Anchor link for: console-translate" class=zola-anchor href=#console-translate><i class=icon></i></a> Console-Translate</h2><p><code>Install-Module Console-Translate -Repository NuGet</code><br> <code>Get-Translate "Module for text translation"</code><br> <code>Get-Translate "Модуль для перевода текста"</code><br> <code>Get-Translate "Привет world" -LanguageSelected</code> т.к. больше латинских символов (на 1), то перевод будет произведен на английский язык<br> <code>Get-Translate "Hello друг" -LanguageSelected</code> перевод на русский язык<br> <code>Get-Translate -Text "Модуль для перевода текста" -LanguageSource ru -LanguageTarget tr</code><br> <code>Get-Translate -Provider MyMemory -Text "Hello World" -Alternatives</code> выбрать провайдер перевода и добавить альтернативные варианты вывода<br> <code>Get-DeepLX "Get select" ru</code><br> <code>Start-DeepLX -Job</code> запустить сервер в режиме процесса<br> <code>Start-DeepLX -Status</code><br> <code>Get-DeepLX -Server 192.168.3.99 -Text "Module for text translation" ru</code><br> <code>Stop-DeepLX</code><br> <code>Get-LanguageCode</code> получение кодов языков по стандарту ISO-639-1<h2 id=hardwaremonitor><a aria-label="Anchor link for: hardwaremonitor" class=zola-anchor href=#hardwaremonitor><i class=icon></i></a> HardwareMonitor</h2><p><code>Install-Module HardwareMonitor -Repository NuGet -Scope AllUsers</code><br> <code>Install-LibreHardwareMonitor</code> установить и запустить LibreHardwareMonitor в систему (https://github.com/LibreHardwareMonitor/LibreHardwareMonitor)<br> <code>Install-OpenHardwareMonitor</code> установить OpenHardwareMonitor (https://github.com/openhardwaremonitor/openhardwaremonitor)<br> <code>Get-Sensor | Where-Object {($_.SensorName -match "Temperature") -or ($_.SensorType -match "Temperature")} | Format-Table</code> использовать LibreHardwareMonitor и WMI/CIM (по умолчанию) и отфильтровать вывод по наименованию датчикам или типу сенсора для вывода датчиков температуры<br> <code>Get-Sensor -Open</code> использовать OpenHardwareMonitor<br> <code>Get-Sensor -ComputerName 192.168.3.99 -Port 8086 | Format-Table</code> вывести датчики системы через REST API<br> <code>Get-Sensor -ComputerName 192.168.3.99 -Port 8085 -User hardware -Password monitor | Where-Object Value -notmatch "^0,0" | Format-Table</code> использовать авторизацию и отфильтровать вывод не пустых датчиков<br> <code>Get-Sensor -Library | Where-Object Value -ne 0 | Format-Table</code> использовать динамическую библиотеку (dll) через .NET<h2 id=crystaldisk-cli><a aria-label="Anchor link for: crystaldisk-cli" class=zola-anchor href=#crystaldisk-cli><i class=icon></i></a> CrystalDisk-Cli</h2><p><code>Install-Module CrystalDisk-Cli -Repository NuGet</code><br> <code>Get-DiskInfoSettings</code> отобразить настройки программы Crystal-DiskInfo (https://github.com/hiyohiyo/CrystalDiskInfo)<br> <code>Get-DiskInfoSettings -AutoRefresh 5</code> изминить время сканирования на 5 минут<br> <code>Get-DiskInfo -List</code> отобразить список дисков<br> <code>Get-DiskInfo</code> получить результаты последнего сканирования (статус, температура и т.п.)<br> <code>Get-DiskInfo -Report | Select-Object Name,Date,HealthStatus,Temperature</code> получить актуальный отчет (запустить сканирование и дождаться результатов)<h2 id=ps-pi-hole><a aria-label="Anchor link for: ps-pi-hole" class=zola-anchor href=#ps-pi-hole><i class=icon></i></a> PS-Pi-Hole</h2><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_psm</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>PSModulePath<span class="z-variable z-other z-member z-powershell">.Split</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\Invoke-Pi-Hole\Invoke-Pi-Hole.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-unary z-powershell">!</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_psm</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">New-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_psm</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType File <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">irm https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">raw.githubusercontent.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Lifailon<span class="z-keyword z-operator z-assignment z-powershell">/</span>PS<span class="z-keyword z-operator z-assignment z-powershell">-</span>Pi<span class="z-keyword z-operator z-assignment z-powershell">-</span>Hole<span class="z-keyword z-operator z-assignment z-powershell">/</span>rsa<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Invoke-Pi</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>Hole<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Invoke-Pi</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>Hole.psm1 <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_psm</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></code></pre><p><code>sudo cat /etc/pihole/setupVars.conf | grep WEBPASSWORD</code> получить токен доступа<br> <code>$Server = "192.168.1.253"</code><br> <code>$Token = "5af9bd44aebce0af6206fc8ad4c3750b6bf2dd38fa59bba84ea9570e16a05d0f"</code><br> <code>Invoke-Pi-Hole -Versions -Server $Server -Token $Token</code> получить текущую версию ядра (backend) и веб (frontend) на сервере а также последнюю доступную версию для обновления<br> <code>Invoke-Pi-Hole -Releases -Server $Server -Token $Token</code> узнать последнюю доступную версию в репозитории на GitHub<br> <code>Invoke-Pi-Hole -QueryLog -Server $Server -Token $Token</code> отобразить полный журнал запросов (клиент, домен назначения, тип записи, статус время запроса и адрес пересылки forward dns - куда ушел запрос)<br> <code>Invoke-Pi-Hole -AdList -Server $Server -Token $Token</code> получить списки блокировак используемых на сервере (дата обновления, количество доменов и url-источника)<br> <code>Invoke-Pi-Hole -Status -Server $Server -Token $Token</code> статус работы режима блокировки<br> <code>Invoke-Pi-Hole -Enable -Server $Server -Token $Token</code> включить блокировку<br> <code>Invoke-Pi-Hole -Disable -Server $Server -Token $Token</code> отключить блокировку<br> <code>Invoke-Pi-Hole -Stats -Server $Server -Token $Token</code> подключиться к серверу Pi-Hole для получения статистики (метрики: количество доменов для блокировки, количество запросов и блокировок за сегодня и т.д.)<br> <code>Invoke-Pi-Hole -QueryTypes -Server $Server -Token $Token</code> статистика запросов по типу записей относительно 100%<br> <code>Invoke-Pi-Hole -TopClient -Server $Server -Token $Token</code> список самых активных клиентов (ip/name и количество запросов проходящих через сервер)<br> <code>Invoke-Pi-Hole -TopPermittedDomains -Count 100 -Server $Server -Token $Token</code> список самых посещяемых доменов и количество запросов<br> <code>Invoke-Pi-Hole -LastBlockedDomain -Server $Server -Token $Token</code> адрес последнего заблокированного домена<br> <code>Invoke-Pi-Hole -ForwardServer -Server $Server -Token $Token</code> список серверов для пересылки, которым обычно выступает DNS-сервер стоящий за Pi-Hole в локальной сети, например AD<br> <code>Invoke-Pi-Hole -Data -Server $Server -Token $Token</code> количество запросов за каждые 10 минут в течение последних 24 часов</p><span class=hidden id=copy-code-text>Copy Code</span><span class=hidden id=search-index>https://lifailon.github.io/search_index.en.json</span><span class=hidden id=more-matches-text>$MATCHES more matches</span></main><footer id=site-footer><nav><ul><li><a href=https://lifailon.github.io/syntax/>PowerShell Syntax</a><li><a href=https://lifailon.github.io/filesystem/>File System</a><li><a href=https://lifailon.github.io/windows/>Operating System</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/threads/>Threads</a><li><a class=active href=https://lifailon.github.io/modules/>Modules</a><li><a href=https://lifailon.github.io/dotnet/>dotNET</a><li><a href=https://lifailon.github.io/com/>COM</a><li><a href=https://lifailon.github.io/servermanager/>Server Manager</a><li><a href=https://lifailon.github.io/activedirectory/>Active Directory</a><li><a href=https://lifailon.github.io/exchange/>Exchange</a><li><a href=https://lifailon.github.io/virtualization/>Virtualization</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/markuplanguages/>Markup Languages</a><li><a href=https://lifailon.github.io/api/>API</a><li><a href=https://lifailon.github.io/zabbix/>Zabbix</a><li><a href=https://lifailon.github.io/devops/>DevOps</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/node-js/>Node.js</a></ul></nav><p>© <strong>2023-2024</strong> <code>Lifailon</code><p><small>Powered by <a class="link external" href=https://www.getzola.org>Zola</a> and <a class="link external" href=https://duckquill.daudix.one>Duckquill</a> </small><ul id=socials><li><a rel=" me" href=https://github.com title=GitHub> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34)" class=icon></i> <span>GitHub</span> </a></ul></footer>