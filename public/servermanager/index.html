<!doctype html><html data-theme=light lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation) and RuDocs (node.js)" name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ff7800 name=theme-color><meta content=#ffa348 media=(prefers-color-scheme:dark) name=theme-color><meta content="default-src 'none';font-src 'self';img-src 'self' https: data:;media-src 'self' https:;style-src 'self' 'unsafe-inline';frame-src https://player.vimeo.com https://www.youtube-nocookie.com https://toot.community;frame-ancestors 'none';base-uri 'none';form-action 'none';connect-src 'self' https://toot.community;script-src 'self' 'self'" http-equiv=content-security-policy><title>Server Manager - PowerShell Commands / RuDocs</title><link href=https://lifailon.github.io/servermanager/ rel=canonical><link href=https://lifailon.github.io/favicon.png rel=icon type=image/png><link href=https://lifailon.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link title="PowerShell Commands / RuDocs - RSS Feed" href=https://lifailon.github.io/rss.xml rel=alternate type=application/rss+xml><link title="PowerShell Commands / RuDocs - Atom Feed" href=https://lifailon.github.io/atom.xml rel=alternate type=application/atom+xml><style>:root{--accent-color:#ff7800;--contrast-color:#000c}[data-theme=dark]{--accent-color:#ffa348}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--accent-color:#ffa348}}[data-theme=dark]{--contrast-color:#000c}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--contrast-color:#000c}}</style><link href=https://lifailon.github.io/style.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=https://lifailon.github.io/syntax-theme-light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://lifailon.github.io/syntax-theme-dark.css rel=stylesheet><script defer src=https://lifailon.github.io/closable.js></script><script defer src=https://lifailon.github.io/copy-button.js></script><script defer src=https://lifailon.github.io/elasticlunr.min.js></script><script defer src=https://lifailon.github.io/search-elasticlunr.js></script><script defer src=https://lifailon.github.io/theme-switcher.js></script><meta content="PowerShell Commands / RuDocs" property=og:site_name><meta content="Server Manager - PowerShell Commands / RuDocs" property=og:title><meta content=https://lifailon.github.io/servermanager/ property=og:url><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation) and RuDocs (node.js)" property=og:description><meta content=https://lifailon.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><div id=handle></div><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://lifailon.github.io> <i class=icon></i>PowerShell Commands / RuDocs</a><li class=divider><li><details class=closable><summary>PowerShell</summary> <ul><li><a href=https://lifailon.github.io/syntax/>PowerShell Syntax</a><li><a href=https://lifailon.github.io/filesystem/>File System</a><li><a href=https://lifailon.github.io/windows/>Operating System</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/threads/>Threads</a><li><a href=https://lifailon.github.io/modules/>Modules</a><li><a href=https://lifailon.github.io/dotnet/>dotNET</a><li><a href=https://lifailon.github.io/com/>COM</a><li><a class=active href=https://lifailon.github.io/servermanager/>Server Manager</a><li><a href=https://lifailon.github.io/activedirectory/>Active Directory</a><li><a href=https://lifailon.github.io/exchange/>Exchange</a><li><a href=https://lifailon.github.io/virtualization/>Virtualization</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/markuplanguages/>Markup Languages</a><li><a href=https://lifailon.github.io/api/>API</a><li><a href=https://lifailon.github.io/zabbix/>Zabbix</a><li><a href=https://lifailon.github.io/devops/>DevOps</a></ul></details><li><a href=https://lifailon.github.io/node-js/>Node.js</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li id=search><button class=circle id=search-toggle title=Search><i class=icon></i></button><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details><li id=repo><a class=circle href=https://github.com/Lifailon/PS-Commands title=Repository> <i class=icon></i> </a></ul></nav><div id=search-container><label class=visually-hidden for=search-bar>Search</label><input placeholder="Search for…" autocomplete=off disabled id=search-bar type=search><div id=search-results-container><div id=search-results></div></div></div></header><main id=main-content><h1>Server Manager</h1><h3 id=module><a aria-label="Anchor link for: module" class=zola-anchor href=#module><i class=icon></i></a> Module</h3><p><code>Get-Command *WindowsFeature*</code> source module ServerManager<br> <code>Get-WindowsFeature -ComputerName "localhost"</code><br> <code>Get-WindowsFeature | where Installed -eq $True</code> список установленных ролей и компонентов<br> <code>Get-WindowsFeature | where FeatureType -eq "Role"</code> отсортировать по списку ролей<br> <code>Install-WindowsFeature -Name DNS</code> установить роль<br> <code>Get-Command *DNS*</code><br> <code>Get-DnsServerSetting -ALL</code><br> <code>Uninstall-WindowsFeature -Name DNS</code> удалить роль<h3 id=pswa><a aria-label="Anchor link for: pswa" class=zola-anchor href=#pswa><i class=icon></i></a> PSWA</h3><p><code>Install-WindowsFeature -Name WindowsPowerShellWebAccess -IncludeManagementTools</code><br> <code>Install-PswaWebApplication -UseTestCertificate</code> Создать веб-приложение /pswa<br> <code>Add-PswaAuthorizationRule -UserGroupName "$domain\Domain Admins" -ComputerName * -ConfigurationName * -RuleName "For Admins"</code> добавить права авторизации<h3 id=wsb-windows-server-backup><a aria-label="Anchor link for: wsb-windows-server-backup" class=zola-anchor href=#wsb-windows-server-backup><i class=icon></i></a> WSB (Windows Server Backup)</h3><p>При создании backup DC через WSB, создается копия состояния системы (System State), куда попадает база AD (NTDS.DIT), объекты групповых политик, содержимое каталога SYSVOL, реестр, метаданные IIS, база AD CS, и другие системные файлы и ресурсы. Резервная копия создается через службу теневого копирования VSS.<br> <code>Get-WindowsFeature Windows-Server-Backup</code> проверить установлена ли роль<br> <code>Add-Windowsfeature Windows-Server-Backup –Includeallsubfeature</code> установить роль<pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span>\bak-dc\dc-03\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TargetUNC</span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">get-date</span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>yyyy-MM-dd<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TargetUNC</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType directory<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> если путь доступен, создать новую директорию по дате<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WBadmin_cmd</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>wbadmin.exe START BACKUP -backupTarget:<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TargetUNC</span> -systemState -noverify -vssCopy -quiet<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> $WBadmin_cmd = "wbadmin start backup -backuptarget:$path -include:C:\Windows\NTDS\ntds.dit -quiet" # Backup DB NTDS<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-Expression</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WBadmin_cmd</span>
</span></code></pre><h3 id=rds><a aria-label="Anchor link for: rds" class=zola-anchor href=#rds><i class=icon></i></a> RDS</h3><p><code>Get-Command -Module RemoteDesktop</code><br> <code>Get-RDServer -ConnectionBroker $broker</code> список всех серверов в фермеы, указывается полное доменное имя при обращение к серверу с ролью RDCB<br> <code>Get-RDRemoteDesktop -ConnectionBroker $broker</code> список коллекций<br> <code>(Get-RDLicenseConfiguration -ConnectionBroker $broker | select *).LicenseServer</code> список серверов с ролью RDL<br> <code>Get-RDUserSession -ConnectionBroker $broker</code> список всех активных пользователей<br> <code>Disconnect-RDUser -HostServer $srv -UnifiedSessionID $id -Force</code> отключить сессию пользователя<br> <code>Get-RDAvailableApp -ConnectionBroker $broker -CollectionName C03</code> список установленного ПО на серверах в коллекции<br> <code>(Get-RDSessionCollectionConfiguration -ConnectionBroker $broker -CollectionName C03 | select *).CustomRdpProperty</code> use redirection server name:i:1<br> <code>Get-RDConnectionBrokerHighAvailability</code><h2 id=dnsserver><a aria-label="Anchor link for: dnsserver" class=zola-anchor href=#dnsserver><i class=icon></i></a> DNSServer</h2><p><code>Get-Command -Module DnsServer</code><br> <code>Show-DnsServerCache</code> отобразить весь кэш DNS-сервера<br> <code>Show-DnsServerCache | where HostName -match ru</code><br> <code>Clear-DnsServerCache</code><br> <code>Get-DnsServerCache</code><br> <code>Get-DnsServerDiagnostics</code><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zone</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> icm <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Get-DnsServerZone</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> select ZoneName<span class="z-keyword z-operator z-other z-powershell">,</span>ZoneType<span class="z-keyword z-operator z-other z-powershell">,</span>DynamicUpdate<span class="z-keyword z-operator z-other z-powershell">,</span>ReplicationScope<span class="z-keyword z-operator z-other z-powershell">,</span>SecureSecondaries<span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell">DirectoryPartitionName <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-GridView</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Title <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>DNS Server: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> –PassThru
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zone_name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zone<span class="z-variable z-other z-member z-powershell">.ZoneName</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zone_name</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    icm <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Get-DnsServerResourceRecord</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ZoneName <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:zone_name</span> <span class="z-keyword z-operator z-other z-powershell">|</span> sort RecordType <span class="z-keyword z-operator z-other z-powershell">|</span> select RecordType<span class="z-keyword z-operator z-other z-powershell">,</span>HostName<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Label</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>IPAddress<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.RecordData.IPv4Address.IPAddressToString</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>TimeToLive<span class="z-keyword z-operator z-other z-powershell">,</span>Timestamp
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> select RecordType<span class="z-keyword z-operator z-other z-powershell">,</span>HostName<span class="z-keyword z-operator z-other z-powershell">,</span>IPAddress<span class="z-keyword z-operator z-other z-powershell">,</span>TimeToLive<span class="z-keyword z-operator z-other z-powershell">,</span>Timestamp <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-GridView</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Title <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>DNS Server: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Sync-DnsServerZone –passthru</code> синхронизировать зоны с другими DC в домене<br> <code>Remove-DnsServerZone -Name domain.local</code> удалить зону<br> <code>Get-DnsServerResourceRecord -ZoneName domain.local -RRType A</code> вывести все А-записи в указанной зоне<br> <code>Add-DnsServerResourceRecordA -Name new-host-name -IPv4Address 192.168.1.100 -ZoneName domain.local -TimeToLive 01:00:00 -CreatePtr</code> создать А-запись и PTR для нее<br> <code>Remove-DnsServerResourceRecord -ZoneName domain.local -RRType A -Name new-host-name –Force</code> удалить А-запись<pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSServer</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>DC-01<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSFZone</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>domain.com<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataFile</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Scripts\DNS-Create-A-Records-from-File.csv<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> cat $DataFile<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> "HostName;IP"<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> "server-01;192.168.1.10"<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSRR</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">WmiClass</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSServer</span>\root\MicrosoftDNS:MicrosoftDNS_ResourceRecord<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ConvFile</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataFile</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>_unicode<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-Content</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataFile</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Set-Content</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ConvFile</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Encoding Unicode
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-CSV</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ConvFile</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Delimiter <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FQDN</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.HostName</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSFZone</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IP</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.HostIP</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TextA</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FQDN</span> IN A <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IP</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Void</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSRR<span class="z-variable z-other z-member z-powershell">.CreateInstanceFromTextRepresentation</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSServer</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSFZone</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TextA</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h2 id=dhcpserver><a aria-label="Anchor link for: dhcpserver" class=zola-anchor href=#dhcpserver><i class=icon></i></a> DHCPServer</h2><p><code>Get-Command -Module DhcpServer</code><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> icm <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ScriptBlock <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Get-DhcpServerv4Scope</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-DhcpServerv4Lease</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> select AddressState<span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell">HostName<span class="z-keyword z-operator z-other z-powershell">,</span>IPAddress<span class="z-keyword z-operator z-other z-powershell">,</span>ClientId<span class="z-keyword z-operator z-other z-powershell">,</span>DnsRegistration<span class="z-keyword z-operator z-other z-powershell">,</span>DnsRR<span class="z-keyword z-operator z-other z-powershell">,</span>ScopeId<span class="z-keyword z-operator z-other z-powershell">,</span>ServerIP <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-GridView</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Title <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>HDCP Server: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> –PassThru
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject Wscript.Shell</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Popup<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac<span class="z-variable z-other z-member z-powershell">.ClientId</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac<span class="z-variable z-other z-member z-powershell">.HostName</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">64</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><p><code>Add-DhcpServerv4Reservation -ScopeId 192.168.1.0 -IPAddress 192.168.1.10 -ClientId 00-50-56-C0-00-08 -Description "new reservation"</code><h2 id=dfs><a aria-label="Anchor link for: dfs" class=zola-anchor href=#dfs><i class=icon></i></a> DFS</h2><p><code>dfsutil /root:\\domain.sys\public /export:C:\export-dfs.txt</code> экспорт конфигурации namespace root<br> <code>dfsutil /AddFtRoot /Server:\\$srv /Share:public</code> на новой машине предварительно создать корень на основе домена<br> <code>dfsutil /root:\\domain.sys\public /import:C:\export-dfs.txt /&LTverify /set</code> Import (перед импортом данных в существующий корень DFS, утилита создает резервную копию конфигурации корня в текущем каталоге, из которого запускается утилита dfsutil)<br> <code>/verify</code> выводит изменения, которые будут внесены в процессе импорта, без применения<br> <code>/set</code> меняет целевое пространство имен путем полной перезаписи и замены на конфигурацию пространства имен из импортируемого файла<br> <code>/merge</code> импортирует конфигурацию пространства имен в дополнение к существующей конфигурации для слияния, параметры из файла конфигурации будут иметь больший приоритет, чем существующие параметры пространства имен<p><code>Export-DfsrClone</code> экспортирует клонированную базу данных репликации DFS и параметры конфигурации тома<br> <code>Get-DfsrCloneState</code> получает состояние операции клонирования базы данных<br> <code>Import-DfsrClone</code> импортирует клонированную базу данных репликации DFS и параметры конфигурации тома<p><code>net use x: \\$srv1\public\*</code> примонтировать диск<br> <code>Get-DfsrFileHash x:\* | Out-File C:\$srv1.txt</code> забрать hash всех файлов диска в файл (файлы с одинаковыми хешами всегда являются точными копиями друг друга)<br> <code>net use x: /d</code> отмонтировать<br> <code>net use x: \\$srv2\public\*</code><br> <code>Get-DfsrFileHash x:\* | Out-File C:\$srv2.txt</code><br> <code>net use x: /d</code><br> <code>Compare-Object -ReferenceObject (Get-Content C:\$srv1.txt) -DifferenceObject (Get-Content C:\$srv2.txt) -IncludeEqual</code> сравнить содержимое файлов<p><code>Get-DfsrBacklog -DestinationComputerName "fs-06" -SourceComputerName "fs-05" -GroupName "folder-rep" -FolderName "folder" -Verbose</code> получает список ожидающих обновлений файлов между двумя партнерами репликации DFS<br> <code>Get-DfsrConnection</code> отображает группы репликации, участников и статус<br> <code>Get-DfsReplicatedFolder</code> отображает имя и полный путь к папкам реликации в системе DFS<br> <code>Get-DfsrState -ComputerName fs-06 -Verbose</code> состояние репликации DFS для члена группы<br> <code>Get-DfsReplicationGroup</code> отображает группы репликации и их статус<br> <code>Add-DfsrConnection</code> создает соединение между членами группы репликации<br> <code>Add-DfsrMember</code> добавляет компьютеры в группу репликации<br> <code>ConvertFrom-DfsrGuid</code> преобразует идентификаторы GUID в понятные имена в заданной группы репликации<br> <code>Get-DfsrConnectionSchedule</code> получает расписание соединений между членами группы репликации<br> <code>Get-DfsrGroupSchedule</code> извлекает расписание группы репликации<br> <code>Get-DfsrIdRecord</code> получает записи ID для реплицированных файлов или папок из базы данных репликации DFS<br> <code>Get-DfsrMember</code> получает компьютеры в группе репликации<br> <code>Get-DfsrMembership</code> получает параметры членства для членов групп репликации<br> <code>Get-DfsrPreservedFiles</code> получает список файлов и папок, ранее сохраненных репликацией DFS<br> <code>Get-DfsrServiceConfiguration</code> получает параметры службы репликации DFS для членов группы<br> <code>Grant-DfsrDelegation</code> предоставляет разрешения участникам безопасности для группы репликации<br> <code>Revoke-DfsrDelegation</code> отменяет разрешения участников безопасности для группы репликации<br> <code>New-DfsReplicationGroup</code> создает группу репликации<br> <code>New-DfsReplicatedFolder</code> создает реплицированную папку в группе репликации<br> <code>Remove-DfsrConnection</code> удаляет соединение между членами группы репликации<br> <code>Remove-DfsReplicatedFolder</code> удаляет реплицированную папку из группы репликации<br> <code>Remove-DfsReplicationGroup</code> удаляет группу репликации<br> <code>Remove-DfsrMember</code> удаляет компьютеры из группы репликации<br> <code>Restore-DfsrPreservedFiles</code> восстанавливает файлы и папки, ранее сохраненные репликацией DFS<br> <code>Set-DfsrConnection</code> изменяет параметры соединения между членами группы репликации<br> <code>Set-DfsrConnectionSchedule</code> изменяет параметры расписания соединений между членами группы репликации<br> <code>Set-DfsReplicatedFolder</code> изменяет настройки реплицированной папки<br> <code>Set-DfsReplicationGroup</code> изменяет группу репликации<br> <code>Set-DfsrGroupSchedule</code> изменяет расписание группы репликации<br> <code>Set-DfsrMember</code> изменяет информацию о компьютере-участнике в группе репликации<br> <code>Set-DfsrMembership</code> настраивает параметры членства для членов группы репликации<br> <code>Set-DfsrServiceConfiguration</code> изменяет параметры службы репликации DFS<br> <code>Sync-DfsReplicationGroup</code> синхронизирует репликацию между компьютерами независимо от расписания<br> <code>Suspend-DfsReplicationGroup</code> приостанавливает репликацию между компьютерами независимо от расписания<br> <code>Update-DfsrConfigurationFromAD</code> инициирует обновление службы репликации DFS<br> <code>Write-DfsrHealthReport</code> создает отчет о работоспособности репликации DFS<br> <code>Write-DfsrPropagationReport</code> создает отчеты для тестовых файлов распространения в группе репликации<br> <code>Start-DfsrPropagationTest</code> создает тестовый файл распространения в реплицированной папке<h2 id=storagereplica><a aria-label="Anchor link for: storagereplica" class=zola-anchor href=#storagereplica><i class=icon></i></a> StorageReplica</h2><p><code>Install-WindowsFeature Storage-Replica –IncludeManagementTools -Restart</code><br> <code>Get-Command -Module StorageReplica</code><br> <code>Test-SRTopology</code> проверить соответствует ли сервер и канал связи технологии Storage Replica<br> <code>New-SRPartnership -SourceComputerName srv-01 -SourceRGName srv-01-rep-group-01 -SourceVolumeName D: -SourceLogVolumeName L: -DestinationComputerName srv-02 -DestinationRGName srv-02-rep-group-01 -DestinationVolumeName D: -DestinationLogVolumeName L: -LogSizeInBytes 1GB</code><br> <code>Get-Counter -Counter "\Storage Replica Statistics(*)"</code><br> <code>Get-WinEvent -ProviderName Microsoft-Windows-StorageReplica -max 10</code><br> <code>Set-SRPartnership -ReplicationMode Asynchronous</code> переключить режим репликации на асинхронный<br> <code>Set-SRPartnership -NewSourceComputerName srv-02 -SourceRGName srv-02-rep-group-01 -DestinationComputerName srv-01 -DestinationRGName srv-01-rep-group-01</code> изменить вручную направление репликации данных, переведя вторичную копию в онлайн режим (при выходе из строя основного сервера)<br> <code>Get-SRGroup</code> информация о состояние группы реплизации<br> <code>Get-SRPartnerShip</code> информация о направлении репликации<br> <code>(Get-SRGroup).Replicas | Select-Object numofbytesremaining</code> проверить длину очереди копирования<br> <code>Get-SRPartnership | Remove-SRPartnership</code> удалить реплизацию на основном сервере<br> <code>Get-SRGroup | Remove-SRGroup</code> удалить реплизацию на обоих серверах<h2 id=wsus><a aria-label="Anchor link for: wsus" class=zola-anchor href=#wsus><i class=icon></i></a> WSUS</h2><p><code>Get-Hotfix | Sort-Object -Descending  InstalledOn</code> список установленных обновлений (информация из cimv2)<br> <code>Get-Hotfix -Description "Security update"</code><br> <code>Get-CimInstance Win32_QuickFixEngineering</code><br> <code>Get-Service uhssvc</code> служба Microsoft Health Update Tools, которая отвечает за предоставление обновлений<h3 id=windowsupdate><a aria-label="Anchor link for: windowsupdate" class=zola-anchor href=#windowsupdate><i class=icon></i></a> WindowsUpdate</h3><p><code>Get-Command -Module WindowsUpdate</code><br> <code>Get-WindowsUpdateLog</code> формирует отчет в $home<code>\AppData</code>{=tex}<code>\Local</code>{=tex}<code>\Temp</code>{=tex}<code>\WindowsUpdateLog </code>{=tex}в формате csv<h3 id=pswindowsupdate><a aria-label="Anchor link for: pswindowsupdate" class=zola-anchor href=#pswindowsupdate><i class=icon></i></a> PSWindowsUpdate</h3><p><code>Install-Module -Name PSWindowsUpdate -Scope CurrentUser</code><br> <code>Import-Module PSWindowsUpdate</code><br> <code>Get-Command -Module PSWindowsUpdate</code><br> <code>Get-WindowsUpdate</code> список обновлений для скачать и установить с сервера WSUS или Microsoft Update<br> <code>Get-WindowsUpdate -Download</code> загрузить все обновления<br> <code>Get-WindowsUpdate –Install</code> установить все обновления<br> <code>Install-WindowsUpdate -MicrosoftUpdate -AcceptAll -IgnoreReboot</code> установить все обновления без перезагрузки<br> <code>Get-WindowsUpdate -KBArticleID KB2267602, KB4533002 -Install</code><br> <code>Get-WindowsUpdate -KBArticleID KB2538243 -Hide</code> скрыть обновления, что бы они никогда не устанавливались<br> <code>Get-WindowsUpdate –IsHidden</code> отобразить скрытые обновления (Hide-WindowsUpdate)<br> <code>Remove-WindowsUpdate -KBArticleID KB4011634 -NoRestart</code> удалить обновление<br> <code>Uninstall-WindowsUpdate</code> удалить обновление<br> <code>Add-WUServiceManager</code> регистрация сервера обновления (Windows Update Service Manager)<br> <code>Enable-WURemoting</code> включить правила Windows Defender, разрешающие удаленное использование командлета PSWindowsUpdate<br> <code>Get-WUApiVersion</code> версия Windows Update Agent<br> <code>Get-WUHistory</code> список всех установленных обновлений (история обновлений)<br> <code>Get-WUHistory | Where-Object {$_.Title -match "KB4517389"}</code> поиск обновления<br> <code>Get-WULastResults</code> даты последнего поиска и установки обновлений<br> <code>Get-WURebootStatus</code> проверить, нужна ли перезагрузка для применения конкретного обновления<br> <code>Get-WUServiceManager</code> выводит источники обновлений<br> <code>Get-WUInstallerStatus</code> статус службы Windows Installer<br> <code>Remove-WUServiceManager</code> отключить Windows Update Service Manager<h3 id=updateservices><a aria-label="Anchor link for: updateservices" class=zola-anchor href=#updateservices><i class=icon></i></a> UpdateServices</h3><p><code>Install-WindowsFeature -Name UpdateServices-RSAT</code> установить роль UpdateServices<br> <code>$UpdateScope = New-Object Microsoft.UpdateServices.Administration.UpdateScope</code><br> <code>[enum]::GetValues([Microsoft.UpdateServices.Administration.ApprovedStates])</code> список утвержденных состояний<br> <code>[enum]::GetValues([Microsoft.UpdateServices.Administration.UpdateInstallationStates])</code> статус установки (неизвестный, непригодный, не установлен, скачено, установлен, неуспешный, установлен и ожидает перезагрузки, все)<br> <code>$UpdateScope.ApprovedStates = [Microsoft.UpdateServices.Administration.ApprovedStates]"NotApproved"</code> выставляем статус не утвержденных обновлений на сервере WSUS<br> <code>$UpdateScope.IncludedInstallationStates = [Microsoft.UpdateServices.Administration.UpdateInstallationStates]"NotInstalled"</code> выставляем статус не установленных обновлений<br> <code>$UpdateScope.IncludedInstallationStates = [Microsoft.UpdateServices.Administration.UpdateInstallationStates]"NotInstalled,Downloaded"</code> обновления загружены, но не установлены<h3 id=poshwsus><a aria-label="Anchor link for: poshwsus" class=zola-anchor href=#poshwsus><i class=icon></i></a> PoshWSUS</h3><p><code>Install-Module -Name PoshWSUS</code><br> <code>Get-Command -Module PoshWSUS</code> нужны права администратора<br> <code>Add-PSWSUSClientToGroup</code> добавление клиента в группу<br> <code>Approve-PSWSUSUpdate</code> утверждение обновления<br> <code>Connect-PSWSUSDatabaseServer</code> подключение к серверу базы данных WSUS<br> <code>Connect-PSWSUSServer</code> подключение к серверу WSUS<br> <code>Deny-PSWSUSUpdate</code> отклонение обновления<br> <code>Disconnect-PSWSUSServer</code> отключение от сервера WSUS<br> <code>Export-PSWSUSMetaData</code> экспорт метаданных WSUS<br> <code>Get-PoshWSUSSyncUpdateCategories</code> получение категорий обновлений для синхронизации<br> <code>Get-PoshWSUSSyncUpdateClassifications</code> получение классификаций обновлений для синхронизации<br> <code>Get-PSWSUSCategory</code> получение категории WSUS<br> <code>Get-PSWSUSChildServer</code> получение дочернего сервера WSUS<br> <code>Get-PSWSUSClassification</code> получение классификации WSUS<br> <code>Get-PSWSUSClient</code> получение информации о клиенте<br> <code>Get-PSWSUSClientGroupMembership</code> получение групповой принадлежности клиента<br> <code>Get-PSWSUSClientPerUpdate</code> получение информации о клиентах по обновлениям<br> <code>Get-PSWSUSClientsInGroup</code> получение клиентов в группе<br> <code>Get-PSWSUSCommand</code> получение информации о командах WSUS<br> <code>Get-PSWSUSConfig</code> получение конфигурации WSUS<br> <code>Get-PSWSUSConfigEnabledUpdateLanguages</code> получение включенных языков обновлений<br> <code>Get-PSWSUSConfigProxyServer</code> получение конфигурации прокси-сервера<br> <code>Get-PSWSUSConfigSupportedUpdateLanguages</code> получение поддерживаемых языков обновлений<br> <code>Get-PSWSUSConfigSyncSchedule</code> получение расписания синхронизации<br> <code>Get-PSWSUSConfigSyncUpdateCategories</code> получение категорий обновлений для синхронизации<br> <code>Get-PSWSUSConfigSyncUpdateClassifications</code> получение классификаций обновлений для синхронизации<br> <code>Get-PSWSUSConfigUpdateFiles</code> получение конфигурации файлов обновлений<br> <code>Get-PSWSUSConfigUpdateSource</code> получение источника обновлений<br> <code>Get-PSWSUSConfiguration</code> получение полной конфигурации WSUS<br> <code>Get-PSWSUSContentDownloadProgress</code> получение прогресса загрузки контента<br> <code>Get-PSWSUSCurrentUserRole</code> получение роли текущего пользователя<br> <code>Get-PSWSUSDatabaseConfig</code> получение конфигурации базы данных<br> <code>Get-PSWSUSDownstreamServer</code> получение конфигурации нижестоящего сервера<br> <code>Get-PSWSUSEmailConfig</code> получение конфигурации электронной почты<br> <code>Get-PSWSUSEnabledUpdateLanguages</code> получение включенных языков обновлений<br> <code>Get-PSWSUSEvent</code> получение событий WSUS<br> <code>Get-PSWSUSGroup</code> получение информации о группе<br> <code>Get-PSWSUSInstallableItem</code> получение информации об установленных элементах<br> <code>Get-PSWSUSInstallApprovalRule</code> получение правил утверждения установки<br> <code>Get-PSWSUSProxyServer</code> получение информации о прокси-сервере<br> <code>Get-PSWSUSServer</code> получение информации о сервере WSUS<br> <code>Get-PSWSUSStatus</code> получение статуса WSUS<br> <code>Get-PSWSUSSubscription</code> получение подписки WSUS<br> <code>Get-PSWSUSSupportedUpdateLanguages</code> получение поддерживаемых языков обновлений<br> <code>Get-PSWSUSSyncEvent</code> получение событий синхронизации<br> <code>Get-PSWSUSSyncHistory</code> получение истории синхронизаций<br> <code>Get-PSWSUSSyncProgress</code> получение прогресса синхронизации<br> <code>Get-PSWSUSSyncSchedule</code> получение расписания синхронизации<br> <code>Get-PSWSUSUpdate</code> получение информации об обновлении<br> <code>Get-PSWSUSUpdateApproval</code> получение информации об утверждении обновлений<br> <code>Get-PSWSUSUpdateCategory</code> получение категории обновлений<br> <code>Get-PSWSUSUpdateClassification</code> получение классификации обновлений<br> <code>Get-PSWSUSUpdateFile</code> получение файлов обновлений<br> <code>Get-PSWSUSUpdateFiles</code> получение списка файлов обновлений<br> <code>Get-PSWSUSUpdatePerClient</code> получение информации об обновлениях по клиентам<br> <code>Get-PSWSUSUpdateSource</code> получение источника обновлений<br> <code>Get-PSWSUSUpdateSummary</code> получение сводки по обновлениям<br> <code>Get-PSWSUSUpdateSummaryPerClient</code> получение сводки по обновлениям для каждого клиента<br> <code>Get-PSWSUSUpdateSummaryPerGroup</code> получение сводки по обновлениям для каждой группы<br> <code>Import-PSWSUSMetaData</code> импорт метаданных WSUS<br> <code>New-PSWSUSComputerScope</code> создание области охвата компьютеров<br> <code>New-PSWSUSGroup</code> создание новой группы<br> <code>New-PSWSUSInstallApprovalRule</code> создание правила утверждения установки<br> <code>New-PSWSUSUpdateScope</code> создание области охвата обновлений<br> <code>Remove-PSWSUSClient</code> удаление клиента<br> <code>Remove-PSWSUSClientFromGroup</code> удаление клиента из группы<br> <code>Remove-PSWSUSGroup</code> удаление группы<br> <code>Remove-PSWSUSInstallApprovalRule</code> удаление правила утверждения установки<br> <code>Remove-PSWSUSUpdate</code> удаление обновления<br> <code>Reset-PSWSUSContent</code> сброс контента WSUS<br> <code>Resume-PSWSUSDownload</code> возобновление загрузки<br> <code>Resume-PSWSUSUpdateDownload</code> возобновление загрузки обновлений<br> <code>Set-PoshWsusClassification</code> установка классификации WSUS<br> <code>Set-PoshWSUSProduct</code> установка продукта WSUS<br> <code>Set-PSWSUSConfigEnabledUpdateLanguages</code> установка включенных языков обновлений<br> <code>Set-PSWSUSConfigProduct</code> установка продукта конфигурации WSUS<br> <code>Set-PSWsusConfigProxyServer</code> установка прокси-сервера конфигурации WSUS<br> <code>Set-PSWSUSConfigSyncSchedule</code> установка расписания синхронизации<br> <code>Set-PSWSUSConfigTargetingMode</code> установка режима таргетирования<br> <code>Set-PSWSUSConfigUpdateClassification</code> установка классификации обновлений<br> <code>Set-PSWSUSConfigUpdateFiles</code> установка файлов обновлений<br> <code>Set-PSWSUSConfigUpdateSource</code> установка источника обновлений<br> <code>Set-PSWSUSEmailConfig</code> установка конфигурации электронной почты<br> <code>Set-PSWSUSEnabledUpdateLanguages</code> установка включенных языков обновлений<br> <code>Set-PSWSUSInstallApprovalRule</code> установка правила утверждения установки<br> <code>Set-PSWSUSProxyServer</code> установка прокси-сервера<br> <code>Set-PSWSUSSyncSchedule</code> установка расписания синхронизации<br> <code>Set-PSWSUSTargetingMode</code> установка режима таргетирования<br> <code>Set-PSWSUSUpdateFiles</code> установка файлов обновлений<br> <code>Set-PSWSUSUpdateSource</code> установка источника обновлений<br> <code>Start-PSWSUSCleanup</code> запуск очистки WSUS<br> <code>Start-PSWSUSInstallApprovalRule</code> запуск правила утверждения установки<br> <code>Start-PSWSUSSync</code> запуск синхронизации<br> <code>Stop-PSWSUSDownload</code> остановка загрузки<br> <code>Stop-PSWSUSSync</code> остановка синхронизации<br> <code>Stop-PSWSUSUpdateDownload</code> остановка загрузки обновлений<br> <code>Test-PSWSUSDatabaseServerConnection</code> тестирование подключения к серверу базы данных</p><span class=hidden id=copy-code-text>Copy Code</span><span class=hidden id=search-index>https://lifailon.github.io/search_index.en.json</span><span class=hidden id=more-matches-text>$MATCHES more matches</span></main><footer id=site-footer><nav><ul><li><a href=https://lifailon.github.io/syntax/>PowerShell Syntax</a><li><a href=https://lifailon.github.io/filesystem/>File System</a><li><a href=https://lifailon.github.io/windows/>Operating System</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/threads/>Threads</a><li><a href=https://lifailon.github.io/modules/>Modules</a><li><a href=https://lifailon.github.io/dotnet/>dotNET</a><li><a href=https://lifailon.github.io/com/>COM</a><li><a class=active href=https://lifailon.github.io/servermanager/>Server Manager</a><li><a href=https://lifailon.github.io/activedirectory/>Active Directory</a><li><a href=https://lifailon.github.io/exchange/>Exchange</a><li><a href=https://lifailon.github.io/virtualization/>Virtualization</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/markuplanguages/>Markup Languages</a><li><a href=https://lifailon.github.io/api/>API</a><li><a href=https://lifailon.github.io/zabbix/>Zabbix</a><li><a href=https://lifailon.github.io/devops/>DevOps</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/node-js/>Node.js</a></ul></nav><p>© <strong>2023-2024</strong> <code>Lifailon</code><p><small>Powered by <a class="link external" href=https://www.getzola.org>Zola</a> and <a class="link external" href=https://duckquill.daudix.one>Duckquill</a> </small><ul id=socials><li><a rel=" me" href=https://github.com title=GitHub> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34)" class=icon></i> <span>GitHub</span> </a></ul></footer>