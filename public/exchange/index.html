<!doctype html><html data-theme=light lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation) and RuDocs (node.js)" name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ff7800 name=theme-color><meta content=#ffa348 media=(prefers-color-scheme:dark) name=theme-color><meta content="default-src 'none';font-src 'self';img-src 'self' https: data:;media-src 'self' https:;style-src 'self' 'unsafe-inline';frame-src https://player.vimeo.com https://www.youtube-nocookie.com https://toot.community;frame-ancestors 'none';base-uri 'none';form-action 'none';connect-src 'self' https://toot.community;script-src 'self' 'self'" http-equiv=content-security-policy><title>Microsoft Exchange - PowerShell Commands / RuDocs</title><link href=https://lifailon.github.io/exchange/ rel=canonical><link href=https://lifailon.github.io/favicon.png rel=icon type=image/png><link href=https://lifailon.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link title="PowerShell Commands / RuDocs - RSS Feed" href=https://lifailon.github.io/rss.xml rel=alternate type=application/rss+xml><link title="PowerShell Commands / RuDocs - Atom Feed" href=https://lifailon.github.io/atom.xml rel=alternate type=application/atom+xml><style>:root{--accent-color:#ff7800;--contrast-color:#000c}[data-theme=dark]{--accent-color:#ffa348}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--accent-color:#ffa348}}[data-theme=dark]{--contrast-color:#000c}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--contrast-color:#000c}}</style><link href=https://lifailon.github.io/style.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=https://lifailon.github.io/syntax-theme-light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://lifailon.github.io/syntax-theme-dark.css rel=stylesheet><script defer src=https://lifailon.github.io/closable.js></script><script defer src=https://lifailon.github.io/copy-button.js></script><script defer src=https://lifailon.github.io/elasticlunr.min.js></script><script defer src=https://lifailon.github.io/search-elasticlunr.js></script><script defer src=https://lifailon.github.io/theme-switcher.js></script><meta content="PowerShell Commands / RuDocs" property=og:site_name><meta content="Microsoft Exchange - PowerShell Commands / RuDocs" property=og:title><meta content=https://lifailon.github.io/exchange/ property=og:url><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation) and RuDocs (node.js)" property=og:description><meta content=https://lifailon.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><div id=handle></div><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://lifailon.github.io> <i class=icon></i>PowerShell Commands / RuDocs</a><li class=divider><li><details class=closable><summary>PowerShell</summary> <ul><li><a href=https://lifailon.github.io/syntax/>PowerShell Syntax</a><li><a href=https://lifailon.github.io/filesystem/>File System</a><li><a href=https://lifailon.github.io/windows/>Operating System</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/threads/>Threads</a><li><a href=https://lifailon.github.io/modules/>Modules</a><li><a href=https://lifailon.github.io/dotnet/>dotNET</a><li><a href=https://lifailon.github.io/com/>COM</a><li><a href=https://lifailon.github.io/servermanager/>Server Manager</a><li><a href=https://lifailon.github.io/activedirectory/>Active Directory</a><li><a class=active href=https://lifailon.github.io/exchange/>Exchange</a><li><a href=https://lifailon.github.io/virtualization/>Virtualization</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/markuplanguages/>Markup Languages</a><li><a href=https://lifailon.github.io/api/>API</a><li><a href=https://lifailon.github.io/zabbix/>Zabbix</a><li><a href=https://lifailon.github.io/devops/>DevOps</a></ul></details><li><a href=https://lifailon.github.io/node-js/>Node.js</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li id=search><button class=circle id=search-toggle title=Search><i class=icon></i></button><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details><li id=repo><a class=circle href=https://github.com/Lifailon/PS-Commands title=Repository> <i class=icon></i> </a></ul></nav><div id=search-container><label class=visually-hidden for=search-bar>Search</label><input placeholder="Search for…" autocomplete=off disabled id=search-bar type=search><div id=search-results-container><div id=search-results></div></div></div></header><main id=main-content><h1>Microsoft Exchange</h1><h2 id=connect><a aria-label="Anchor link for: connect" class=zola-anchor href=#connect><i class=icon></i></a> Connect</h2><p><code>$srv_cas = "exchange-cas"</code><br> <code>$session_exchange = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://$srv_cas/PowerShell/</code> -Credential $Cred -Authentication Kerberos<br> <code>Get-PSSession</code><br> <code>Import-PSSession $session_exchange -DisableNameChecking</code> импортировать в текущую сессию<h2 id=settings><a aria-label="Anchor link for: settings" class=zola-anchor href=#settings><i class=icon></i></a> Settings</h2><p><code>Get-ExchangeServer | select name,serverrole,admindisplayversion,Edition,OriginatingServer,WhenCreated,WhenChanged,DataPath | ft</code> список всех серверов<br> <code>Get-ImapSettings</code> настройки IMAP<br> <code>Get-ExchangeCertificate</code> список сертификатов<br> <code>Get-ExchangeCertificate -Thumbprint "5CEC8544D4743BC279E5FEA1679F79F5BD0C2B3A" | Enable-ExchangeCertificate -Services  IMAP, POP, IIS, SMTP</code><br> <code>iisreset</code><br> <code>Get-ClientAccessService | fl identity, *uri*</code> настройки службы автообнаружения в Exchange 2016<br> <code>Get-ClientAccessService -Identity $srv | Set-ClientAccessService -AutoDiscoverServiceInternalUri https://mail.domain.ru/Autodiscover/Autodiscover.xml</code> изменить на внешний адрес<br> <code>Get-OutlookAnywhere</code> OA позволяет клиентам Outlook подключаться к своим почтовым ящикам за пределами локальной сети (без использования VPN)<br> <code>Get-WebServicesVirtualDirectory</code><br> <code>Get-OwaVirtualDirectory</code><br> <code>Get-ActiveSyncVirtualDirectory</code><br> <code>Get-OabVirtualDirectory</code> виртуальная директория автономной адресной книги<br> <code>Get-OabVirtualDirectory -Server $srv | Set-OabVirtualDirectory -InternalUrl "https://mail.domain.ru/OAB" -ExternalUrl "https://mail.domain.ru/OAB"</code><h2 id=roles><a aria-label="Anchor link for: roles" class=zola-anchor href=#roles><i class=icon></i></a> Roles</h2><p>MS (Mailbox) - сервер с БД почтовых ящиков и общих папок, отвечает только за их размещение и не выполняет маршрутизацию никаких сообщений.<br> CAS (Client Access Server) - обработка клиентских подключений к почтовым ящикам, которые создаются клиентами Outlook Web Access (HTTP для Outlook Web App), Outlook Anywhere, ActiveSync (для мобильных устройств), интернет протоколы POP3 и IMAP4, MAPI для клиентов Microsoft Outlook.<br> Hub Transort - ответвечает за маршрутизацию сообщений интернета и инфраструктурой Exchange, а также между серверами Exchange. Сообщения всегда маршрутизируются с помощью роли транспортного сервера-концентратора, даже если почтовые ящики источника и назначения находятся в одной базе данных почтовых ящиков.<br> Relay - роль пограничного транспортного сервера (шлюз SMTP в периметре сети).<p>SCP (Service Connection Point) - запись прописывается в AD, при создание сервера CAS. Outlook запрашивает SCP, выбирает те, которые находятся в одном сайте с ним и по параметру WhenCreated – по дате создания, выбирая самый старый.<br> Autodiscover. Outlook выбирает в качестве сервера Client Access тот, который прописан в атрибуте RPCClientAccessServer базы данных пользователя. Сведения о базе данных и сервере mailbox, на котором она лежит, берутся из AD.<h2 id=messagetrackinglog><a aria-label="Anchor link for: messagetrackinglog" class=zola-anchor href=#messagetrackinglog><i class=icon></i></a> MessageTrackingLog</h2><p><code>Get-MessageTrackingLog -ResultSize Unlimited | select Timestamp,Sender,Recipients,RecipientCount,MessageSubject,Source,EventID,ClientHostname,ServerHostname,ConnectorId, @{Name="MessageSize"; Expression={[string]([int]($_.TotalBytes / 1024))+" KB"}},@{Name="MessageLatency"; Expression={$_.MessageLatency -replace "\.\d+$"}}</code><br> <code>Get-MessageTrackingLog -Start (Get-Date).AddHours(-24) -ResultSize Unlimited | where {[string]$_.recipients -like "*@yandex.ru"}</code> вывести сообщения за последние 24 часа, где получателем был указанный домен<br> -Start “04/01/2023 09:00:00” -End “04/01/2023 18:00:00” - поиск по указанному промежутку времени<br> -MessageSubject “Тест” - поиск по теме письма<br> -Recipients “support4@domain.ru” - поиск по получателю<br> -Sender - поиск по отправителю<br> -EventID – поиск по коду события сервера (RECEIVE, SEND, FAIL, DSN, DELIVER, BADMAIL, RESOLVE, EXPAND, REDIRECT, TRANSFER, SUBMIT, POISONMESSAGE, DEFER)<br> -Server – поиск на определенном транспортном сервере<br> -messageID – трекинг письма по его ID<h2 id=mailbox><a aria-label="Anchor link for: mailbox" class=zola-anchor href=#mailbox><i class=icon></i></a> Mailbox</h2><p><code>Get-Mailbox -Database "it2"</code> список почтовых серверов в базе данных<br> <code>Get-Mailbox -resultsize unlimited | ? Emailaddresses -like "support4" | format-list name,emailaddresses,database,servername</code> какую БД, сервер и smtp-адреса использует почтовый ящик<br> <code>Get-Mailbox -Database $db_name -Archive</code> отобразить архивные почтовые ящики<p><code>Get-MailboxFolderStatistics -Identity "support4" -FolderScope All | select Name,ItemsInFolder,FolderSize</code> отобразить кол-во писем и размер в каждой папке<br> <code>Get-MailboxStatistics "support4" | select DisplayName,LastLoggedOnUserAccount,LastLogonTime,LastLogoffTime,ItemCount,TotalItemSize,DeletedItemCount,TotalDeletedItemSize,Database,ServerName</code> общее кол-во писем, их размер, время последнего входа и выхода, имя сервера и БД<br> <code>Get-Mailbox -Server s2 | Get-MailboxStatistics | where {$_.Lastlogontime -lt (get-date).AddDays(-30)} | Sort Lastlogontime -desc | ft displayname,Lastlogontime,totalitemsize</code> ящики, которые не использовались 30 и более дней<p><code>Enable-Mailbox -Identity support9 -Database test_base</code> создать почтовый ящик для существующего пользователя в AD<br> <code>New-Mailbox -Name $login -UserPrincipalName "$login@$domain" -Database $select_db -OrganizationalUnit $path -Password (ConvertTo-SecureString -String "$password" -AsPlainText -Force)</code> создать новый почтовый ящик без привязки к пользователю AD<br> <code>Get-MailboxDatabase -Database $db_name | Remove-MailboxDatabase</code> удалить БД<p><code>Set-MailBox "support4" -PrimarySmtpAddress support24@domain.ru -EmailAddressPolicyEnabled $false</code> добавить и изменить основной SMTP-адрес электронной почты для пользователя<br> <code>Set-Mailbox -Identity "support4" -DeliverToMailboxAndForward $true -ForwardingSMTPAddress "username@outlook.com"</code> включить переадресацию почты (электронная почта попадает в почтовый ящик пользователя support4 и одновременно пересылается по адресу username@outlook.com)<h2 id=moverequest><a aria-label="Anchor link for: moverequest" class=zola-anchor href=#moverequest><i class=icon></i></a> MoveRequest</h2><p><code>Get-Mailbox -Database $db_in | New-MoveRequest -TargetDatabase $db_out</code> переместить все почтовые ящики из одной БД в другую<br> <code>New-MoveRequest -Identity $db_in -TargetDatabase $db_out</code> переместить один почтовый ящик<br> <code>Get-MoveRequest | Suspend-MoveRequest</code> остановить запросы перемещения<br> <code>Get-MoveRequest | Remove-MoveRequest</code> удалить запросы на перемещение<br> <code>Get-MoveRequest | Get-MoveRequestStatistics</code> статус перемещения<p>Status:<br> Cleanup - нужно подождать<br> Queued - в очереди<br> InProgress - в процессе<br> Percent Complete - процент выполнения<br> CompletionInProgress - завершение процесса<br> Completed - завершено<p><code>Remove-MoveRequest -Identity $db_name</code> завершить процесс перемещения (убрать статус перемещения с почтового ящика и очистить список перемещений)<br> <code>Get-MailboxDatabase | Select Name, MailboxRetention</code> после перемещения ящиков, размер базы не изменится, полное удаление из базы произойдет, как пройдет количество дней, выставленное в параметре MailboxRetention<br> <code>Set-MailboxDatabase -MailboxRetention '0.00:00:00' -Identity $db_name</code> изменить значение<h2 id=archive><a aria-label="Anchor link for: archive" class=zola-anchor href=#archive><i class=icon></i></a> Archive</h2><p><code>Enable-Mailbox -Identity $name -Archive</code> включить архив для пользователя<br> <code>Get-Mailbox $name | New-MoveReques –ArchiveOnly –ArchiveTargetDatabase DBArch</code> переместить архивный почтовый ящик в другую БД<br> <code>Get-Mailbox $name | fl Name,Database,ArchiveDatabase</code> место расположения БД пользователя и БД его архива<br> <code>Disable-Mailbox -Identity $name -Archive</code> отключить архив<br> <code>Connect-Mailbox -Identity "8734c04e-981e-4ccf-a547-1c1ac7ebf3e2" -Archive -User $name -Database it2</code> подключение архива пользователя к указанному почтовому ящику<br> <code>Get-Mailbox $name | Set-Mailbox -ArchiveQuota 20GB -ArchiveWarningQuota 19GB</code> настроить квоты хранения архива<h2 id=quota><a aria-label="Anchor link for: quota" class=zola-anchor href=#quota><i class=icon></i></a> Quota</h2><p><code>Get-Mailbox -Identity $mailbox | fl IssueWarningQuota, ProhibitSendQuota, ProhibitSendReceiveQuota, UseDatabaseQuotaDefaults</code> отобразить квоты почтового ящика<br> IssueWarningQuota — квота, при достижении которой Exchange отправит уведомление<br> ProhibitSendQuota — при достижении будет запрещена отправка<br> ProhibitSendReceiveQuota — при достижении будет запрещена отправка и получение<br> UseDatabaseQuotaDefaults — используется ли квота БД или false - индвидиуальные<br> <code>Set-Mailbox -Identity $mailbox -UseDatabaseQuotaDefaults $false -IssueWarningQuota "3 GB" -ProhibitSendQuota "4 GB" -ProhibitSendReceiveQuota "5 GB"</code> задать квоту для пользователя<p><code>Get-MailboxDatabase $db_name | fl Name, *Quota</code> отобразить квоты наложенные на БД<br> <code>Set-MailboxDatabase $db -ProhibitSendReceiveQuota "5 GB" -ProhibitSendQuota "4 GB" -IssueWarningQuota "3 GB"</code> настроить квоты на БД<h2 id=database><a aria-label="Anchor link for: database" class=zola-anchor href=#database><i class=icon></i></a> Database</h2><p><code>Get-MailboxDatabase -Status | select ServerName,Name,DatabaseSize</code> список и размер всех БД на всех MX-серверах<br> <code>New-MailboxDatabase -Name it_2022 -EdbFilePath E:\Bases\it_2022\it_2022.edb -LogFolderPath G:\Logs\it_2022 -OfflineAddressBook "Default Offline Address List" -server exch-mx-01</code> создать БД<br> <code>Restart-Service MSExchangeIS</code><br> <code>Get-Service | Where {$_ -match "exchange"} | Restart-Service</code><br> <code>Get-MailboxDatabase -Server exch-01</code> список баз данных на MX-сервере<br> <code>New-MoveRequest -Identity "support4" -TargetDatabase it_2022</code> переместить почтовый ящик в новую БД<br> <code>Move-Databasepath $db_name –EdbFilepath "F:\DB\$db_name\$db_name.edb" –LogFolderpath "E:\DB\$db_name\logs\"</code> переместить БД и транзакционные логи на другой диск<br> <code>Set-MailboxDatabase -CircularLoggingEnabled $true -Identity $db_name</code> включить циклическое ведение журнала (Circular Logging), где последовательно пишутся 4 файла логов по 5 МБ, после чего первый лог-файл перезаписывается<br> <code>Set-MailboxDatabase -CircularLoggingEnabled $false -Identity $db_name</code> отключить циклическое ведение журнала<br> <code>Get-MailboxDatabase -Server "exch-mx-01" -Status | select EdbFilePath,LogFolderPath,LogFilePrefix</code> путь к БД, логам, имя текущего актуального лог-файла<h2 id=mailboxrepairrequest><a aria-label="Anchor link for: mailboxrepairrequest" class=zola-anchor href=#mailboxrepairrequest><i class=icon></i></a> MailboxRepairRequest</h2><p><code>New-MailboxRepairRequest -Database it2 -CorruptionType ProvisionedFolder, SearchFolder, AggregateCounts, Folderview</code> запустить последовательный тест (в конкретный момент времени не доступен один почтовый ящик) и исправление ошибок на прикладном уровне<br> <code>Get-MailboxRepairRequest -Database it2</code> прогресс выполнения<br> Позволяет исправить:<br> ProvisionedFolder – нарушения логической структуры папок<br> SearchFolder – ошибки в папках поиска<br> AggregateCounts – проверка и исправление информации о количестве элементов в папках и их размере<br> FolderView – неверное содержимое, отображаемое представлениями папок<h2 id=eseutil><a aria-label="Anchor link for: eseutil" class=zola-anchor href=#eseutil><i class=icon></i></a> eseutil</h2><p>При отправке/получении любого письма Exchange сначала вносит информацию в транзакционный лог, и только потом сохраняет элемент непосредственно в базу данных. Размер одного лог файла - 1 Мб. Есть три способа урезания логов: DAG, Backup на базе Volume Shadow Copy, Circular Logging.<p>Ручное удаление журналов транзакций:<br> <code>cd E:\MS_Exchange_2010\MailBox\Reg_v1_MailBoxes\</code> перейти в каталог с логами<br> <code>ls E*.chk</code> узнать имя файла, в котором находится информация из контрольной точки фиксации журналов<br> <code>eseutil /mk .\E18.chk</code> узнать последний файл журнала, действия из которого были занесены в БД Exchange<br> <code>Checkpoint: (0x561299,8,16)</code> 561299 имя файла, который был последним зафиксирован (его информация уже в базе данных)<br> Находим в проводнике файл E0500561299.txt, можно удалять все файлы журналов, которые старше найденного файла<p>Восстановление БД (если две копии БД с ошибкой):<br> <code>Get-MailboxDatabaseCopyStatus -Identity db_name\* | Format-List Name,Status,ContentIndexState</code><br> Status : FailedAndSuspended<br> ContentIndexState : Failed<br> Status : Dismounted<br> ContentIndexState : Failed<p><code>Get-MailboxDatabase -Server exch-mx-01 -Status | fl Name,EdbFilePath,LogFolderPath</code> проверить расположение базы и транзакционных логов<br> LogFolderPath - директория логов<br> E18 - имя транкзакционного лога (из него читаются остальные логи)<br> <code>dismount-Database db_name</code> отмантировать БД<br> <code>eseutil /mh D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> проверить базу<br> State: Dirty Shutdown - несогласованное состояние, означает, что часть транзакций не перенесена в базу, например, после того, как была осуществлена аварийная перезагрузка сервера.<br> <code>eseutil /ml E:\MS_Exchange_2010\MailBox\db_name\E18</code> проверка целостности транзакционных логи, если есть логи транзакций и они не испорчены, то можно восстановить из них, из файла E18 считываются все логи, должен быть статус - ОК<p>Soft Recovery (мягкое восстановление) - необходимо перевести базу в состояние корректного отключения (Clear shutdown) путем записи недостающих файлов журналов транзакций в БД.<br> <code>eseutil /R E18 /l E:\MS_Exchange_2010\MailBox\db_name\ /d D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code><br> <code>eseutil /R E18 /a /i /l E:\MS_Exchange_2010\MailBox\db_name\ /d D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> если с логами что-то не так, можно попробовать восстановить базу игнорируя ошибку в логах<br> <code>eseutil /mk D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> cостоянии файла контрольных точек<br> <code>eseutil /g D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> проверка целостности БД<br> <code>eseutil /k D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> проверка контрольных сумм базы (CRC)<p>Hard Recovery - если логи содержат ошибки и база не восстанавливается, то восстанавливаем базу без логов.<br> <code>eseutil /p D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code><br> /p - удалит поврежденные страницы, эта информация будет удалена из БД и восстановит целостность<br> <code>esetuil /d D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> выполнить дефрагментацию (если был потерян большой объем данных, то может сильно снизиться производительность)<br> После выполнения команд необходимо вручную удалить все файлы с расширением log в папке MDBDATA, перед попыткой смонтировать базу данных.<br> <code>isinteg -s "db_name.edb" -test alltests</code> проверьте целостность базы данных<br> <code>isinteg -s "server_name" -fix -test -alltests</code> если проверка будет провалена. Выполнять команду до тех пор, пока у всех ошибок не станет статус 0 или статус не перестанет меняться, иногда необходимо 3 прохода для достижения результата.<br> <code>eseutil /mh D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb | Select-String -Pattern "State:","Log Required:"</code> проверить статус<br> State: Clear shutdown - успешный статус<br> <code>Log Required</code> требуются ли файлы журналов, необходимые базе, чтобы перейти в согласованное состояние. Если база размонтирована корректно, то это значение будет равняться 0.<br> <code>mount-Database -force db_name</code> примонтировать БД<br> <code>Get-MailboxDatabase –Status db_name | fl Mounted</code> статус БД<br> <code>New-MailboxRepairRequest -Database db_name -CorruptionType SearchFolder,AggregateCounts,ProvisionedFolder,FolderView</code> восстановление логической целостности данных<br> После этого восстановить Index.<br> Если индексы не восстанавливаются, но БД монтируется, то перенести почтовые ящики в новую БД.<p>Восстановление БД из Backup:<p>1-й вариант:\<ol><li>Отмантировать текущую БД и удалить или переименовать директорию с файлами текущей БД.\<li>Восстановить в ту же директорию из Backup базу с логами.\<li>Запустить мягкое восстановление БД (Soft Recovery).\<li>Примониторвать.</ol><p>2-й вариант:\<ol><li>Отмантировать и удалить текущую БД.\<li>Восстановить БД с логами из Backup в любое место.\<li>Запустить мягкое восстановление БД (Soft Recovery).\<li>Создать новую БД.\<li>Создать Recovery Database и смонтировать в нее восстановленную из бэкапа БД, скопировать из неё почтовые ящики в новую БД и переключить на них пользователей.\<li>Если использовать Dial Tone Recovery, то так же перенести из временной БД промежуточные данные почтовых ящиков.</ol><p>3-й вариант:\<ol><li>Восстановить целостность Soft Repair или Hard Recovery.\<li>Создать новую БД. Указывать в свойствах: «база может быть перезаписана при восстановлении».\<li>Если база была только что оздана и еще не была подмонтирована, то эта папка будет пуста, туда перемещаем базу из Backup, которая была обработана ESEUTIL вместе со всеми файлами. Указать имя .edb такое же, которое было при создании новой базы.\<li>Монтируем базу.\<li>Перенацеливаем ящики со старой (Mailbox_DB_02), неисправной базы, на новую базу (Mailbox_DB_02_02):<br> <code>Get-Mailbox -Database Mailbox_DB_02 | where {$_.ObjectClass -NotMatch '(SystemAttendantMailbox|ExOleDbSystemMailbox)'} | Set-Mailbox -Database Mailbox_DB_02_02</code>\<li>Восстановление логической целостности данных:<br> <code>New-MailboxRepairRequest -Database "Mailbox_DB_02_02" -CorruptionType ProvisionedFolder, SearchFolder, AggregateCounts, Folderview</code></ol><h2 id=dial-tone-recovery><a aria-label="Anchor link for: dial-tone-recovery" class=zola-anchor href=#dial-tone-recovery><i class=icon></i></a> Dial Tone Recovery</h2><p><code>Get-Mailbox -Database "MailboxDB" | Set-Mailbox -Database "TempDB"</code> перенацелить ящики с одной БД (нерабочей) на другую (пустую)<br> <code>Get-Mailbox -Database TempDB</code> отобразить почтовые ящики в БД TempDB<br> <code>Restart-Service MSExchangeIS</code> перезапустить службу Mailbox Information Store (банка данных), иначе пользователи будут по-прежнему пытаться подключиться к старой БД<br> <code>iisreset</code><br> <code>Get-Mailbox -Database "TempDB" | Set-Mailbox -Database "MailboxDB"</code> после восстановления старой БД, нужно переключить пользователей с временной БД обратно<br> После этого сделать слияние с временной БД с помощью Recovery.<h2 id=recovery-database-rdb><a aria-label="Anchor link for: recovery-database-rdb" class=zola-anchor href=#recovery-database-rdb><i class=icon></i></a> Recovery database (RDB)</h2><p><code>New-MailboxDatabase –Recovery –Name RecoveryDB –Server $exch_mx –EdbFilePath "D:\TempDB\TempDB.edb" -LogFolderPath "D:\TempDB"</code> для переноса новых писем из временной БД в основную необходим только сам файл TempDB.edb со статусом Clean Shutdown, из нее необходимо создать служебную БД (ключ -Recovery)<br> <code>Mount-Database "D:\TempDB\TempDB.edb"</code> примонтировать БД<br> <code>Get-MailboxStatistics -Database RecoveryDB</code><br> <code>New-MailboxRestoreRequest –SourceDatabase RecoveryDB –SourceStoreMailbox support –TargetMailbox support</code> скопировать данные почтового ящика с DisplayName: support из RecoveryDB в почтовый ящик с псевдонимом support существующей базы. По умолчанию ищет в почтовой базе совпадающие LegacyExchangeDN либо проверяет совпадение адреса X500, если нужно восстановить данные в другой ящик, нужно указывать ключ -AllowLegacyDNMisMatch<br> <code>New-MailboxRestoreRequest –SourceDatabase RecoveryDB –SourceStoreMailbox support –TargetMailbox support –TargetRootFolder "Restore"</code> скопировать письма в отдельную папку в ящике назначения (создается автоматически), возможно восстановить содержимое конкретной папки -IncludeFolders “##Inbox##”<br> <code>Get-MailboxRestoreRequest | Get-MailboxRestoreRequestStatistics</code> статус запроса восстановления<br> <code>Get-MailboxRestoreRequestStatistics -Identity support</code><br> <code>Get-MailboxRestoreRequest -Status Completed | Remove-MailboxRestoreRequest</code> удалить все успешные запросы<h2 id=transport><a aria-label="Anchor link for: transport" class=zola-anchor href=#transport><i class=icon></i></a> Transport</h2><p><code>Get-TransportServer $srv_cas | select MaxConcurrentMailboxDeliveries,MaxConcurrentMailboxSubmissions,MaxConnectionRatePerMinute,MaxOutboundConnections,MaxPerDomainOutboundConnections,PickupDirectoryMaxMessagesPerMinute</code> настройки пропускной способности транспортного сервера<br> MaxConcurrentMailboxDeliveries — максимальное количество одновременных потоков, которое может открыть сервер для отправки писем.<br> MaxConcurrentMailboxSubmissions — максимальное количество одновременных потоков, которое может открыть сервер для получения писем.<br> MaxConnectionRatePerMinute — максимальное возможная скорость открытия входящих соединений в минуту.<br> MaxOutboundConnections — максимальное возможное количество соединений, которое может открыть Exchange для отправки.<br> MaxPerDomainOutboundConnections — максимальное возможное количество исходящих соединений, которое может открыть Exchange для одного удаленного домена.<br> PickupDirectoryMaxMessagesPerMinute — скорость внутренней обработки сообщений в минуту (распределение писем по папкам).<br> <code>Set-TransportServer exchange-cas -MaxConcurrentMailboxDeliveries 21 -MaxConcurrentMailboxSubmissions 21 -MaxConnectionRatePerMinute 1201 -MaxOutboundConnections 1001 -MaxPerDomainOutboundConnections 21 -PickupDirectoryMaxMessagesPerMinute 101</code> изменить значения<p><code>Get-TransportConfig | select MaxSendSize, MaxReceiveSize</code> ограничение размера сообщения на уровне траспорта (наименьший приоритет, после коннектора и почтового ящика).<br> <code>New-TransportRule -Name AttachmentLimit -AttachmentSizeOver 15MB -RejectMessageReasonText "Sorry, messages with attachments over 15 MB are not accepted"</code> создать транспортное правило для проверки размера вложения<h2 id=connector><a aria-label="Anchor link for: connector" class=zola-anchor href=#connector><i class=icon></i></a> Connector</h2><p><code>Get-ReceiveConnector | select Name,MaxMessageSize,RemoteIPRanges,WhenChanged</code> ограничения размера сообщения на уровне коннектора (приоритет ниже, чем у почтового ящика)<br> <code>Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MaxMessageSize 30Mb</code> изменить размер у последнего коннектора в списке (приоритет выше, чем у траспорта)<br> <code>Get-Mailbox "support4" | select MaxSendSize, MaxReceiveSize</code> наивысший приоритет<br> <code>Set-Mailbox "support4" -MaxSendSize 30MB -MaxReceiveSize 30MB</code> изменить размер<p><code>Set-SendConnector -Identity "ConnectorName" -Port 26</code> изменить порт коннектора отправки<br> <code>Get-SendConnector "proxmox" | select port</code><p><code>Get-ReceiveConnector | select Name,MaxRecipientsPerMessage</code> по умолчанию Exchange принимает ограниченное количество адресатов в одном письме (200)<br> <code>Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MaxRecipientsPerMessage 50</code> изменить значение<br> <code>Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MessageRateLimit 1000</code> задать лимит обработки сообщений в минуту для коннектора<p><code>Get-OfflineAddressbook | Update-OfflineAddressbook</code> обновить OAB<br> <code>Get-ClientAccessServer | Update-FileDistributionService</code><h2 id=pst><a aria-label="Anchor link for: pst" class=zola-anchor href=#pst><i class=icon></i></a> PST</h2><p><code>New-MailboxExportRequest -Mailbox $name -filepath "\\$srv\pst\$name.PST" ## -ContentFilter {(Received -lt "01/01/2021")} -Priority Highest/Lower ## -IsArchive</code> выполнить экспорт из архива пользователя<br> <code>New-MailboxExportRequest -Mailbox $name -IncludeFolders "##Inbox##" -FilePath "\\$srv\pst\$name.PST"</code> только папку входящие<br> <code>New-MailboxImportRequest -Mailbox $name "\\$srv\pst\$name.PST"</code> импорт из PST<br> <code>Get-MailboxExportRequest</code> статус запросов<br> <code>Get-MailboxExportRequest -Status Completed | Remove-MailboxExportRequest</code> удалить успешно завершенные запросы<br> <code>Remove-MailboxExportRequest -RequestQueue MBXDB01 -RequestGuid 25e0eaf2-6cc2-4353-b83e-5cb7b72d441f</code> отменить экспорт<h2 id=distributiongroup><a aria-label="Anchor link for: distributiongroup" class=zola-anchor href=#distributiongroup><i class=icon></i></a> DistributionGroup</h2><p><code>Get-DistributionGroup</code> список групп рассылки<br> <code>Get-DistributionGroupMember "!_Офис"</code> список пользователей в группе<br> <code>Add-DistributionGroupMember -Identity "!_Офис" -Member "$name@$domain"</code> добавить в группу рассылки<br> <code>Remove-DistributionGroupMember -Identity "!_Офис" -Member "$name@$domain"</code><br> <code>New-DistributionGroup -Name "!_Тест" -Members "$name@$domain"</code> создать группу<br> <code>Set-DistributionGroup -Identity "support4" -HiddenFromAddressListsEnabled $true (или Set-Mailbox)</code> скрыть из списка адресов Exchange<h2 id=search><a aria-label="Anchor link for: search" class=zola-anchor href=#search><i class=icon></i></a> Search</h2><p><code>Search-Mailbox -Identity "support4" -SearchQuery 'Тема:"Mikrotik DOWN"'</code> поиск писем по теме<br> <code>Search-Mailbox -Identity "support4" -SearchQuery 'Subject:"Mikrotik DOWN"'</code><br> <code>Search-Mailbox -Identity "support4" -SearchQuery 'attachment -like:"*.rar"'</code><br> <code>Search-Mailbox -Identity "support4" -SearchQuery "отправлено: < 01/01/2020" -DeleteContent -Force</code> удаление писем по дате<p>Формат даты в зависимости от региональных настроек сервера:<br> <code>20/07/2018</code><br> <code>07/20/2018</code><br> <code>20-Jul-2018</code><br> <code>20/July/2018</code><h2 id=auditlog><a aria-label="Anchor link for: auditlog" class=zola-anchor href=#auditlog><i class=icon></i></a> AuditLog</h2><p><code>Get-AdminAuditLogConfig</code> настройки аудита<br> <code>Set-Mailbox -Identity "support4" -AuditOwner HardDelete</code> добавить логирование HardDelete писем<br> <code>Set-mailbox -identity "support4" -AuditlogAgelimit 120</code> указать время хранения<br> <code>Get-mailbox -identity "support4" | Format-list Audit*</code> данные аудита<br> <code>Search-MailboxAuditLog -Identity "support4" -LogonTypes Delegate -ShowDetails -Start "2022-02-22 18:00" -End "2022-03-22 18:00"</code> просмотр логов<br> <code>Search-AdminAuditLog -StartDate "02/20/2022" | ft CmdLetName,Caller,RunDate,ObjectModified -Autosize</code> поиск событий истории выполненых команд в журнале аудита Exchange<h2 id=test><a aria-label="Anchor link for: test" class=zola-anchor href=#test><i class=icon></i></a> Test</h2><p><code>Test-ServiceHealth</code> проверить доступность ролей сервера: почтовых ящиков, клиентского доступа, единой системы обмена сообщениями, траспортного сервера<br> <code>$mx_srv_list | %{Test-MapiConnectivity -Server $_}</code> проверка подключения MX-серверов к БД<br> <code>Test-MAPIConnectivity -Database $db</code> проверка возможности логина в базу<br> <code>Test-MAPIConnectivity –Identity $user@$domain</code> проверка возможности логина в почтовый ящик<br> <code>Test-ComputerSecureChannel</code> проверка работы службы AD<br> <code>Test-MailFlow</code> результат тестового потока почты<h2 id=queue><a aria-label="Anchor link for: queue" class=zola-anchor href=#queue><i class=icon></i></a> Queue</h2><p><code>Get-TransportServer | %{Get-Queue -Server $_.Name}</code> отобразить очереди на всех транспортных серверах<br> <code>Get-Queue -Identity EXCHANGE-CAS\155530 | Format-List</code> подробная информация об очереди<br> <code>Get-Queue -Identity EXCHANGE-CAS\155530 | Get-Message -ResultSize Unlimited | Select FromAddress,Recipients</code> отобразить список отправителей (FromAddress) и список получателей в очереди (Recipients)<br> <code>Get-Message -Queue EXCHANGE-CAS\155530</code> отобразить индентификатор сообщений в конкретной очереди (сервер<code>\очередь</code>{=tex}<code>\идентификатор </code>{=tex}письма)<br> <code>Resume-Message EXCHANGE-CAS\155530\444010</code> повторить отправку письма из очереди<br> <code>Retry-Queue -Filter {Status -eq "Retry"}</code> принудительно повторить отправку всех сообщений c статусом “Повторить”<br> <code>Get-Queue -Identity EXCHANGE-CAS\155530 | Get-Message -ResultSize unlimited | Remove-Message -WithNDR $False</code> очистить очередь<br> <code>Get-transportserver EXCHANGE-CAS | Select MessageExpirationTimeout</code> отобразить время жизни сообщений в очереди (по умолчанию, 2 дня)<p>Error Exchange 452 4.3.1 Insufficient system resources - окончание свободного места на диске, на котором находятся очереди службы Exchange Hub Transport, за мониторинг отвечает компонент доступных ресурсов Back Pressure, который в том числе отслеживает свободное место на диске<br> Порог Medium (90%) — перестать принимать по SMTP почту от внешних отправителей (почта от MAPI клиентов при этом обрабатывается)<br> Порог High (99%) — обработка потока почты полностью прекращается<br> Решение: очистить, например логи IIS (C:<code>\inetpub</code>{=tex}<code>\logs</code>{=tex}<code>\LogFiles</code>{=tex}<code>\W</code>{=tex}3SVC1), увеличить размер диска, отключить мониторинг Back Pressure (плохой вариант) или перенести транспортные очередь на другой диск достаточного объёма.<p><code>Get-Service | ? name -like "MSExchangeTransport" | Stop-Service</code> остановить служу очереди<br> <code>Rename-Item "C:\Program Files\Microsoft\Exchange Server\V15\TransportRoles\data\Queue" "C:\Program Files\Microsoft\Exchange Server\V15\TransportRoles\data\Queue_old"</code> очистить базу очереди<br> <code>C:\Program Files\Microsoft\Exchange Server\V15\Bin\EdgeTransport.exe.config</code> конфигурационный файл, который содержит путь к бд с очередью (блок <code>&LTappSettings></code>{=html} ключи <code>&LTadd key="QueueDatabasePath" value="$new_path" /></code>{=html} и QueueDatabaseLoggingPath)<br> Для переноса БД, необходимо переместить существующие файлы базы данных Mail.que и Trn.chk (контрольные точки для отслеживания записи в логах) из исходного местоположения в новое. Переместите существующие файлы журнала транзакций Trn.log, Trntmp.log, Trn nnnn.log , Trnres00001.jrs, Trnres00002.jrs и Temp.edb из старого расположения в новое. tmp.edb — временный файл для проверки схемы самой базы, перености не нужно.<br> После запуска службы транспорта удалить старую базу данных очереди и файлы журнала транзакций из старого расположения.<h2 id=defrag><a aria-label="Anchor link for: defrag" class=zola-anchor href=#defrag><i class=icon></i></a> Defrag</h2><p><code>Get-MailboxDatabase -Status | ft Name, DatabaseSize, AvailableNewMailboxSpace</code><br> DatabaseSize - текущий размер базы<br> AvailableNewMailboxSpace - объём пустых страниц, пространство, которое можно освободить при дефрагментации<br> (DatabaseSize — AvailableNewMailboxSpace) x 1,1 - необходимо дополнительно иметь свободного места не менее 110% от текущего размера базы (без учета пустых страниц)<br> <code>cd $path</code><br> <code>Dismount-Database "$path\$db_name"</code> отмонтировать БД<br> <code>eseutil /d "$path\$db_name.edb"</code><br> <code>Mount-Database "$path\$db"</code> примонтировать БД<h2 id=dag-database-availability-group><a aria-label="Anchor link for: dag-database-availability-group" class=zola-anchor href=#dag-database-availability-group><i class=icon></i></a> DAG (Database Availability Group)</h2><p><code>Install-WindowsFeature -Name Failover-Clustering -ComputerName EXCH-MX-01</code> основывается на технологии Windows Server Failover Cluster<br> <code>New-DatabaseAvailabilityGroup -Name dag-01 -WitnessServer fs-05 -WitnessDirectory C:\witness_exchange1</code> создать группу с указанием файлового свидетеля для кворума<br> Quorum - это процесс голосования, в котором для принятия решения нужно иметь большинство голосов, что бы сделать текущую копию базы данных активной.<br> WitnessDirectory — используется для хранения данных файлового ресурса-свидетеля.<br> <code>Set-DatabaseAvailabilityGroup dag-01 –DatabaseAvailabilityGroupIPAdress $ip</code> изменить ip-адрес группы<br> <code>Get-DatabaseAvailabilityGroup</code> список всех групп<br> <code>Get-DatabaseAvailabilityGroup -Identity dag-01</code><br> <code>Add-DatabaseAvailabilityGroupServer -Identity dag-01 -MailboxServer EXCH-MX-01</code> добавить первый сервер (все БД на серверах в DAG должны храниться по одинаковому пути)<br> <code>Add-MailboxDatabaseCopy -Identity db_name -MailboxServer EXCH-MX-04</code> добавить копию БД<br> <code>Get-MailboxDatabaseCopyStatus -Identity db_name\* | select Name,Status,LastInspectedLogTime</code> статус и время последнего копирования журнала транзакий<p>Status:<br> Mounted - рабочая база<br> Suspended - приостановлено копирование<br> Healthy - рабочая пассивная копия<br> ServiceDown - недоступна (выключен сервер)<br> Dismounted - отмонтирована<br> FailedAndSuspended - ошибка и приостановка копирования<br> Resynchronizing - процесс синхронизация, где будет постепенно уменьшаться длина очереди<br> CopyQueue Length - длина репликационной очереди копирования (0 - значит все изменения из активной базы реплицированы в пассивную копию)<p><code>Resume-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04</code> возобновить (Resume) или запустить копирование бд на EXCH-MX-04 (из статуса Suspended в Healthy)<br> <code>Suspend-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04</code> остановить копирование (в статус Suspended)<br> <code>Update-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04 -DeleteExistingFiles</code> обновить копию БД (сделать Full Backup)<br> <code>Set-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04 -ActivationPreference 1</code> изменить приоритет для активации копий БД (какую использовать, 1 – самое высокое значение)<br> <code>Move-ActiveMailboxDatabase db_name -ActivateOnServer EXCH-MX-04 -MountDialOverride:None -Confirm:$false</code> включить копию БД в DAG (переключиться на активную копию)<br> <code>Remove-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04 -Confirm:$False</code> удалить копии пассивной базы в DAG-группе (у БД должно быть отключено ведение циклического журнала)<br> <code>Remove-DatabaseAvailabilityGroupServer -Identity dag-01 -MailboxServer EXCH-MX-04 -ConfigurationOnly</code> удалить MX сервер из группы DAG<br> <code>Import-Module FailoverClusters</code><br> <code>Get-ClusterNode EXCH-MX-04 | Remove-ClusterNode -Force</code> удалить отказавший узел из Windows Failover Cluster<p><code>Get-DatabaseAvailabilityGroup | Get-DatabaseAvailabilityGroupHealth</code> мониторинг<h2 id=index><a aria-label="Anchor link for: index" class=zola-anchor href=#index><i class=icon></i></a> Index</h2><p><code>Get-MailboxDatabaseCopyStatus * | select name,status,ContentIndexState,ContentIndexErrorMessage,ActiveDatabaseCopy,LatestCopyBackupTime,CopyQueueLength</code> узнать состояние работы индксов БД и текст ошибки, на каком сервере активная копия БД, дата последней копии и текущая очередь<br> <code>Get-MailboxDatabaseCopyStatus -Identity $db_name\* | Format-List Name,ContentIndexState</code> отобразить список всех копий конкретной БД на всех серверах, и статус их индексов, если у второго сервера статус Healthy, можно восстановить из него<br> <code>Get-MailboxDatabaseCopyStatus -Identity $db_name\EXCH-MX-04 | Update-MailboxDatabaseCopy -SourceServer EXCH-MX-01 -CatalogOnly</code> восстановить БД из копии<br> <code>cd %PROGRAMFILES%\Microsoft\Exchange Server\V14\Scripts</code> или v15 для Exchange 2016<br> <code>.\ResetSearchIndex.ps1 $db_name</code> скрипт восстановления индекса<p><code>Get-MailboxDatabaseCopyStatus * | where {$_.ContentIndexState -eq "Failed" -or $_.ContentIndexState -eq "FailedAndSuspended"}</code> отобразить у какой БД произошел сбой работы (FailedAndSuspended) или индекса (ContentIndexState)</p><span class=hidden id=copy-code-text>Copy Code</span><span class=hidden id=search-index>https://lifailon.github.io/search_index.en.json</span><span class=hidden id=more-matches-text>$MATCHES more matches</span></main><footer id=site-footer><nav><ul><li><a href=https://lifailon.github.io/syntax/>PowerShell Syntax</a><li><a href=https://lifailon.github.io/filesystem/>File System</a><li><a href=https://lifailon.github.io/windows/>Operating System</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/threads/>Threads</a><li><a href=https://lifailon.github.io/modules/>Modules</a><li><a href=https://lifailon.github.io/dotnet/>dotNET</a><li><a href=https://lifailon.github.io/com/>COM</a><li><a href=https://lifailon.github.io/servermanager/>Server Manager</a><li><a href=https://lifailon.github.io/activedirectory/>Active Directory</a><li><a class=active href=https://lifailon.github.io/exchange/>Exchange</a><li><a href=https://lifailon.github.io/virtualization/>Virtualization</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/markuplanguages/>Markup Languages</a><li><a href=https://lifailon.github.io/api/>API</a><li><a href=https://lifailon.github.io/zabbix/>Zabbix</a><li><a href=https://lifailon.github.io/devops/>DevOps</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/node-js/>Node.js</a></ul></nav><p>© <strong>2023-2024</strong> <code>Lifailon</code><p><small>Powered by <a class="link external" href=https://www.getzola.org>Zola</a> and <a class="link external" href=https://duckquill.daudix.one>Duckquill</a> </small><ul id=socials><li><a rel=" me" href=https://github.com title=GitHub> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34)" class=icon></i> <span>GitHub</span> </a></ul></footer>