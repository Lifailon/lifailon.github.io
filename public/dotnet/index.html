<!doctype html><html data-theme=light lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation) and RuDocs (node.js)" name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ff7800 name=theme-color><meta content=#ffa348 media=(prefers-color-scheme:dark) name=theme-color><meta content="default-src 'none';font-src 'self';img-src 'self' https: data:;media-src 'self' https:;style-src 'self' 'unsafe-inline';frame-src https://player.vimeo.com https://www.youtube-nocookie.com https://toot.community;frame-ancestors 'none';base-uri 'none';form-action 'none';connect-src 'self' https://toot.community;script-src 'self' 'self'" http-equiv=content-security-policy><title>.NET - PowerShell Commands / RuDocs</title><link href=https://lifailon.github.io/dotnet/ rel=canonical><link href=https://lifailon.github.io/favicon.png rel=icon type=image/png><link href=https://lifailon.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link title="PowerShell Commands / RuDocs - RSS Feed" href=https://lifailon.github.io/rss.xml rel=alternate type=application/rss+xml><link title="PowerShell Commands / RuDocs - Atom Feed" href=https://lifailon.github.io/atom.xml rel=alternate type=application/atom+xml><style>:root{--accent-color:#ff7800;--contrast-color:#000c}[data-theme=dark]{--accent-color:#ffa348}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--accent-color:#ffa348}}[data-theme=dark]{--contrast-color:#000c}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--contrast-color:#000c}}</style><link href=https://lifailon.github.io/style.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=https://lifailon.github.io/syntax-theme-light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://lifailon.github.io/syntax-theme-dark.css rel=stylesheet><script defer src=https://lifailon.github.io/closable.js></script><script defer src=https://lifailon.github.io/copy-button.js></script><script defer src=https://lifailon.github.io/elasticlunr.min.js></script><script defer src=https://lifailon.github.io/search-elasticlunr.js></script><script defer src=https://lifailon.github.io/theme-switcher.js></script><meta content="PowerShell Commands / RuDocs" property=og:site_name><meta content=".NET - PowerShell Commands / RuDocs" property=og:title><meta content=https://lifailon.github.io/dotnet/ property=og:url><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation) and RuDocs (node.js)" property=og:description><meta content=https://lifailon.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><div id=handle></div><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://lifailon.github.io> <i class=icon></i>PowerShell Commands / RuDocs</a><li class=divider><li><details class=closable><summary>PowerShell</summary> <ul><li><a href=https://lifailon.github.io/syntax/>PowerShell Syntax</a><li><a href=https://lifailon.github.io/filesystem/>File System</a><li><a href=https://lifailon.github.io/windows/>Operating System</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/threads/>Threads</a><li><a href=https://lifailon.github.io/modules/>Modules</a><li><a class=active href=https://lifailon.github.io/dotnet/>dotNET</a><li><a href=https://lifailon.github.io/com/>COM</a><li><a href=https://lifailon.github.io/servermanager/>Server Manager</a><li><a href=https://lifailon.github.io/activedirectory/>Active Directory</a><li><a href=https://lifailon.github.io/exchange/>Exchange</a><li><a href=https://lifailon.github.io/virtualization/>Virtualization</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/markuplanguages/>Markup Languages</a><li><a href=https://lifailon.github.io/api/>API</a><li><a href=https://lifailon.github.io/zabbix/>Zabbix</a><li><a href=https://lifailon.github.io/devops/>DevOps</a></ul></details><li><a href=https://lifailon.github.io/node-js/>Node.js</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li id=search><button class=circle id=search-toggle title=Search><i class=icon></i></button><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details><li id=repo><a class=circle href=https://github.com/Lifailon/PS-Commands title=Repository> <i class=icon></i> </a></ul></nav><div id=search-container><label class=visually-hidden for=search-bar>Search</label><input placeholder="Search for…" autocomplete=off disabled id=search-bar type=search><div id=search-results-container><div id=search-results></div></div></div></header><main id=main-content><h1>.NET</h1><h3 id=console-api><a aria-label="Anchor link for: console-api" class=zola-anchor href=#console-api><i class=icon></i></a> Console API</h3><p><a href=https://powershell.one/tricks/input-devices/detect-key-press>Source</a><p><code>[Console] | Get-Member -Static</code><br> <code>[Console]::BackgroundColor = "Blue"</code><br> <code>[Console]::OutputEncoding</code> используемая кодировка в текущей сессии<br> <code>[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding("utf-8")</code> изменить кодировку для отображения кириллицы<br> <code>[Console]::outputEncoding = [System.Text.Encoding]::GetEncoding("cp866")</code> для ISE<br> <code>[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding("windows-1251")</code> для ps2exe<br> <code>Get-Service | Out-File $home\Desktop\Service.txt -Encoding oem</code> ><br> <code>Get-Service | Out-File $home\Desktop\Service.txt -Append</code> >><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">do</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::KeyAvailable</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyInfo</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ReadKey<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">break</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoNewline
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Host</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyInfo</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-KeyPress</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ConsoleKey</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Key</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.ConsoleModifiers</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ModifierKey</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::KeyAvailable</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressedKey</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ReadKey<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>isPressedKey</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressedKey<span class="z-variable z-other z-member z-powershell">.Key</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>isPressedKey</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressedKey<span class="z-variable z-other z-member z-powershell">.Modifiers</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ModifierKey</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Beep<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1800</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">200</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Warning</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Press Ctrl+Shift+Q to exit<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">do</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoNewline
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressed</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-KeyPress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Key Q <span class="z-keyword z-operator z-assignment z-powershell">-</span>ModifierKey <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Control,Shift<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressed</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-keyword z-control z-powershell">break</span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=drawing><a aria-label="Anchor link for: drawing" class=zola-anchor href=#drawing><i class=icon></i></a> Drawing</h3><p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.drawing?view=net-7.0&redirectedfrom=MSDN">API</a><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>AssemblyName System.Drawing
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Width</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">800</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Height</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">400</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Drawing.Bitmap<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Width</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Height</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>graphic</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Graphics</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromImage<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>background_color</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Brushes</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Blue <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать цвет фона (синий)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>graphic<span class="z-variable z-other z-member z-powershell">.FillRectangle</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>background_color</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image<span class="z-variable z-other z-member z-powershell">.Width</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image<span class="z-variable z-other z-member z-powershell">.Height</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text_color</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Brushes</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::White <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать цвет текста (белый)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>font</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Drawing.Font<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Arial<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.FontStyle</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bold</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать шрифт<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>PowerShell<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> указать текст<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text_position</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Drawing.RectangleF<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">320</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">180</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">300</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">100</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>  <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать положение текста (x, y, width, height)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>graphic<span class="z-variable z-other z-member z-powershell">.DrawString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>font</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text_color</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text_position</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> нанести текст на изображение<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\powershell_image.bmp<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Imaging.ImageFormat</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bmp</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> сохранить изображение<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> освобождение ресурсов<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><p><code>$path = "$home\desktop\powershell_image.bmp"</code><br> <code>Invoke-Item $path</code><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>src_image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Image</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromFile<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Width</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">400</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Height</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">200</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dst_image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Drawing.Bitmap <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>src_image</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Width</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Height</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> изменить размер изображения<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dst_image<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\powershell_image_resize.bmp<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Imaging.ImageFormat</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bmp</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rotated_image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>src_image<span class="z-variable z-other z-member z-powershell">.Clone</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> создать копию исходного изображения<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rotated_image<span class="z-variable z-other z-member z-powershell">.RotateFlip</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.RotateFlipType</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Rotate180FlipNone</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> перевернуть изображение на 180 градусов<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rotated_image<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\powershell_image_rotated.bmp<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Imaging.ImageFormat</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bmp</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>src_image<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> закрыть (отпустить) исходный файл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h3 id=selenium><a aria-label="Anchor link for: selenium" class=zola-anchor href=#selenium><i class=icon></i></a> Selenium</h3><p><code>Invoke-Expression(New-Object Net.WebClient).DownloadString("https://raw.githubusercontent.com/Lifailon/Deploy-Selenium/rsa/Deploy-Selenium-Drivers.ps1")</code> установка всех драйверов и Chromium соответствующий версии для драйвера<pre class=z-code><code><span class="z-text z-plain">$path = "$home\Documents\Selenium\"
</span><span class="z-text z-plain">$log = "$path\ChromeDriver.log"
</span><span class="z-text z-plain">$ChromeDriver = "$path\ChromeDriver.exe"
</span><span class="z-text z-plain">$WebDriver = "$path\WebDriver.dll"
</span><span class="z-text z-plain">$SupportDriver = "$path\WebDriver.Support.dll"
</span><span class="z-text z-plain">$Chromium = (Get-ChildItem $path -Recurse | Where-Object Name -like chrome.exe).FullName
</span><span class="z-text z-plain">Add-Type -Path $WebDriver
</span><span class="z-text z-plain">Add-Type -Path $SupportDriver
</span><span class="z-text z-plain">try {
</span><span class="z-text z-plain">    $ChromeOptions = New-Object OpenQA.Selenium.Chrome.ChromeOptions # создаем объект с настройками запуска браузера
</span><span class="z-text z-plain">    $ChromeOptions.BinaryLocation = $Chromium # передаем путь до исполняемого файла, который отвечает за запуск браузера
</span><span class="z-text z-plain">    $ChromeOptions.AddArgument("start-maximized") # добавляем аргумент, который позволяет запустить браузер на весь экран
</span><span class="z-text z-plain">    #$ChromeOptions.AddArgument("start-minimized") # запускаем браузер в окне
</span><span class="z-text z-plain">    #$ChromeOptions.AddArgument("window-size=400,800") # запускаем браузер с заданными размерам окна в пикселях
</span><span class="z-text z-plain">    $ChromeOptions.AcceptInsecureCertificates = $True # игнорировать предупреждение на сайтах с не валидным сертификатом
</span><span class="z-text z-plain">    #$ChromeOptions.AddArgument("headless") # скрывать окно браузера при запуске
</span><span class="z-text z-plain">    $ChromeDriverService = [OpenQA.Selenium.Chrome.ChromeDriverService]::CreateDefaultService($ChromeDriver) # создаем объект настроек службы драйвера
</span><span class="z-text z-plain">    $ChromeDriverService.HideCommandPromptWindow = $True # отключаем весь вывод логирования драйвера в консоль (этот вывод нельзя перенаправить)
</span><span class="z-text z-plain">    $ChromeDriverService.LogPath = $log # указать путь до файла с журналом
</span><span class="z-text z-plain">    $ChromeDriverService.EnableAppendLog = $True # не перезаписывать журнал при каждом новом запуске
</span><span class="z-text z-plain">    #$ChromeDriverService.EnableVerboseLogging = $True # кроме INFO и ошибок, записывать DEBUG сообщения
</span><span class="z-text z-plain">    $Selenium = New-Object OpenQA.Selenium.Chrome.ChromeDriver($ChromeDriverService, $ChromeOptions) # инициализируем запуск с указанными настройками
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    $Selenium.Navigate().GoToUrl("https://google.com") # переходим по указанной ссылке в браузере
</span><span class="z-text z-plain">    #$Selenium.Manage().Window.Minimize() # свернуть окно браузера после запуска и перехода по нужному url (что бы считать страницу корректно)
</span><span class="z-text z-plain">    # Ищем поле для ввода текста:
</span><span class="z-text z-plain">    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::Id('APjFqb'))
</span><span class="z-text z-plain">    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::XPath('//*[@id="APjFqb"]'))
</span><span class="z-text z-plain">    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::Name('q'))
</span><span class="z-text z-plain">    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::XPath('//*[@name="q"]'))
</span><span class="z-text z-plain">    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::ClassName('gLFyf'))
</span><span class="z-text z-plain">    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::CssSelector('[jsname="yZiJbe"]'))
</span><span class="z-text z-plain">    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::TagName('textarea')) | Where-Object ComputedAccessibleRole -eq combobox
</span><span class="z-text z-plain">    $Search.SendKeys("calculator online") # передаем текст выбранному элементу
</span><span class="z-text z-plain">    $Search.SendKeys([OpenQA.Selenium.Keys]::Enter) # нажимаем Enter для вызова функции поиска
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    Start-Sleep 1
</span><span class="z-text z-plain">    $div = $Selenium.FindElements([OpenQA.Selenium.By]::TagName("div"))
</span><span class="z-text z-plain">    $2 = $div | Where-Object {($_.ComputedAccessibleRole -eq "button") -and ($_.ComputedAccessibleLabel -eq "2")}
</span><span class="z-text z-plain">    $2.Click()
</span><span class="z-text z-plain">    $2.Click()
</span><span class="z-text z-plain">    $plus = $div | Where-Object {($_.ComputedAccessibleRole -eq "button") -and ($_.Text -eq "+")}
</span><span class="z-text z-plain">    $plus.Click()
</span><span class="z-text z-plain">    $3 = $Selenium.FindElement([OpenQA.Selenium.By]::CssSelector('[jsname="KN1kY"]'))
</span><span class="z-text z-plain">    $3.Click()
</span><span class="z-text z-plain">    $3.Click()
</span><span class="z-text z-plain">    $sum = $Selenium.FindElement([OpenQA.Selenium.By]::CssSelector('[jsname="Pt8tGc"]'))
</span><span class="z-text z-plain">    $sum.Click()
</span><span class="z-text z-plain">    $result = $Selenium.FindElement([OpenQA.Selenium.By]::CssSelector('[jsname="VssY5c"]')).Text
</span><span class="z-text z-plain">    Write-Host "Result: $result" -ForegroundColor Green
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">finally {
</span><span class="z-text z-plain">    $Selenium.Close()
</span><span class="z-text z-plain">    $Selenium.Quit()
</span><span class="z-text z-plain">}
</span></code></pre><h3 id=selenium-modules><a aria-label="Anchor link for: selenium-modules" class=zola-anchor href=#selenium-modules><i class=icon></i></a> Selenium modules</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">raw.githubusercontent.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Lifailon<span class="z-keyword z-operator z-assignment z-powershell">/</span>Selenium<span class="z-keyword z-operator z-assignment z-powershell">-</span>Modules<span class="z-keyword z-operator z-assignment z-powershell">/</span>rsa<span class="z-keyword z-operator z-assignment z-powershell">/</span>Modules<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Get-GPT</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Get-GPT</span>.psm1 <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">Env:</span>PSModulePath</span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Get-GPT<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType Directory <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Get-GPT.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></code></pre><p><code>Get-GPT "Исполняй роль калькулятора. Посчитай сумму чисел: 22+33"</code><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">raw.githubusercontent.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Lifailon<span class="z-keyword z-operator z-assignment z-powershell">/</span>Selenium<span class="z-keyword z-operator z-assignment z-powershell">-</span>Modules<span class="z-keyword z-operator z-assignment z-powershell">/</span>rsa<span class="z-keyword z-operator z-assignment z-powershell">/</span>Modules<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Get-Translation</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Get-Translation</span>.psm1 <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">Env:</span>PSModulePath</span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Get-Translation<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType Directory <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Get-Translation.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></code></pre><p><code>Get-Translation -Provider DeepL -Text "I translating the text"</code><br> <code>Get-Translation -Provider DeepL -Text "Я перевожу текст"</code><br> <code>Get-Translation -Provider Google -Text "I translating the text"</code><br> <code>Get-Translation -Provider Google -Text "Я перевожу текст" -Language en</code><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">raw.githubusercontent.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Lifailon<span class="z-keyword z-operator z-assignment z-powershell">/</span>Selenium<span class="z-keyword z-operator z-assignment z-powershell">-</span>Modules<span class="z-keyword z-operator z-assignment z-powershell">/</span>rsa<span class="z-keyword z-operator z-assignment z-powershell">/</span>Modules<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Get-SpeedTest</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Get-SpeedTest</span>.psm1 <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">Env:</span>PSModulePath</span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Get-SpeedTest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType Directory <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Get-SpeedTest.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></code></pre><p><code>Get-SpeedTest -Provider Libre</code><br> <code>Get-SpeedTest -Provider Open</code><br> <code>Get-SpeedTest -Provider Ookla</code><h3 id=object-event><a aria-label="Anchor link for: object-event" class=zola-anchor href=#object-event><i class=icon></i></a> Object Event</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timer</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Timers.Timer
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timer<span class="z-variable z-other z-member z-powershell">.Interval</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">1000</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Register-ObjectEvent</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>InputObject <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timer</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>EventName Elapsed <span class="z-keyword z-operator z-assignment z-powershell">-</span>SourceIdentifier Timer.Output <span class="z-keyword z-operator z-assignment z-powershell">-</span>Action <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Random</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Random</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Min <span class="z-constant z-numeric z-integer z-powershell">0</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Max <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Random</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timer<span class="z-variable z-other z-member z-powershell">.Enabled</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span>
</span></code></pre><p><code>$Timer.Enabled = $False</code> остановить<br> <code>$Timer | Get-Member -MemberType Event</code> отобразить список всех событий объекта<br> <code>Get-EventSubscriber</code> список зарегистрированных подписок на события в текущей сессии<br> <code>Unregister-Event -SourceIdentifier Timer.Output</code> удаляет регистрацию подписки на событие по имени события (EventName) или все *<br> <code>-Forward</code> перенаправляет события из удаленного сеанса (New-PSSession) в локальный сеанс<br> <code>-SupportEvent</code> не выводит результат регистрации события на экран (и Get-EventSubscriber и Get-Job)<pre class=z-code><code><span class="z-text z-plain">Register-EngineEvent -SourceIdentifier PowerShell.Exiting -Action {
</span><span class="z-text z-plain">$date = Get-Date -f hh:mm:ss
</span><span class="z-text z-plain">(New-Object -ComObject Wscript.Shell).Popup("PowerShell Exit: $date",0,"Action",64)
</span><span class="z-text z-plain">}
</span></code></pre><h2 id=methods><a aria-label="Anchor link for: methods" class=zola-anchor href=#methods><i class=icon></i></a> Methods</h2><h3 id=eventlog><a aria-label="Anchor link for: eventlog" class=zola-anchor href=#eventlog><i class=icon></i></a> EventLog</h3><p><code>[System.Diagnostics.EventLog] | select Assembly,Module</code><br> <code>$EventLog = [System.Diagnostics.EventLog]::new("Application")</code><br> <code>$EventLog = New-Object -TypeName System.Diagnostics.EventLog -ArgumentList Application,192.168.3.100</code><br> <code>$EventLog | Get-Member -MemberType Method</code><br> <code>$EventLog.MaximumKilobytes</code> максимальный размер журнала<br> <code>$EventLog.Entries</code> просмотреть журнал<br> <code>$EventLog.Clear()</code> очистить журнал<p><code>Join-Path C: Install Test</code><br> <code>[System.IO.Path]::Combine("C:", "Install", "Test")</code><h3 id=match><a aria-label="Anchor link for: match" class=zola-anchor href=#match><i class=icon></i></a> Match</h3><p><code>[System.Math] | Get-Member -Static -MemberType Methods</code><br> <code>[System.Math]::Max(2,7)</code><br> <code>[System.Math]::Min(2,7)</code><br> <code>[System.Math]::Floor(3.9)</code><br> <code>[System.Math]::Truncate(3.9)</code><h3 id=generatepassword><a aria-label="Anchor link for: generatepassword" class=zola-anchor href=#generatepassword><i class=icon></i></a> GeneratePassword</h3><p><code>Add-Type -AssemblyName System.Web</code><br> <code>[System.Web.Security.Membership]::GeneratePassword(10,2)</code><h3 id=soundplayer><a aria-label="Anchor link for: soundplayer" class=zola-anchor href=#soundplayer><i class=icon></i></a> SoundPlayer</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CriticalSound</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Media.SoundPlayer
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CriticalSound<span class="z-variable z-other z-member z-powershell">.SoundLocation</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\WINDOWS\Media\Windows Critical Stop.wav<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CriticalSound<span class="z-variable z-other z-member z-powershell">.Play</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>GoodSound</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Media.SoundPlayer
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>GoodSound<span class="z-variable z-other z-member z-powershell">.SoundLocation</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\WINDOWS\Media\tada.wav<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>GoodSound<span class="z-variable z-other z-member z-powershell">.Play</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=static-class><a aria-label="Anchor link for: static-class" class=zola-anchor href=#static-class><i class=icon></i></a> Static Class</h3><p><code>[System.Environment] | Get-Member -Static</code><br> <code>[System.Environment]::OSVersion</code><br> <code>[System.Environment]::Version</code><br> <code>[System.Environment]::MachineName</code><br> <code>[System.Environment]::UserName</code><p><code>[System.Diagnostics.Process] | Get-Member -Static</code><br> <code>[System.Diagnostics.Process]::Start('notepad.exe')</code><h3 id=clicker><a aria-label="Anchor link for: clicker" class=zola-anchor href=#clicker><i class=icon></i></a> Clicker</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cSource</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-heredoc z-powershell">@'
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">using System;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">using System.Drawing;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">using System.Runtime.InteropServices;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">using System.Windows.Forms;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">public class Clicker
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646270(v=vs.85).aspx
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">[StructLayout(LayoutKind.Sequential)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">struct INPUT
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">{ 
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int        type; // 0 = INPUT_MOUSE,
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">                            // 1 = INPUT_KEYBOARD
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">                            // 2 = INPUT_HARDWARE
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public MOUSEINPUT mi;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646273(v=vs.85).aspx
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">[StructLayout(LayoutKind.Sequential)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">struct MOUSEINPUT
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    dx ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    dy ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    mouseData ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    dwFlags;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    time;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public IntPtr dwExtraInfo;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//This covers most use cases although complex mice may have additional buttons
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//There are additional constants you can use for those cases, see the msdn page
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_MOVED      = 0x0001 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_LEFTDOWN   = 0x0002 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_LEFTUP     = 0x0004 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_RIGHTDOWN  = 0x0008 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_RIGHTUP    = 0x0010 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_MIDDLEDOWN = 0x0020 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_MIDDLEUP   = 0x0040 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_WHEEL      = 0x0080 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_XDOWN      = 0x0100 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_XUP        = 0x0200 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_ABSOLUTE   = 0x8000 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int screen_length          = 0x10000 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646310(v=vs.85).aspx
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">[System.Runtime.InteropServices.DllImport("user32.dll")]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">extern static uint SendInput(uint nInputs, INPUT[] pInputs, int cbSize);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">public static void LeftClickAtPoint(int x, int y)
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    //Move the mouse
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    INPUT[] input = new INPUT[3];
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[0].mi.dx = x*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[0].mi.dy = y*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[0].mi.dwFlags = MOUSEEVENTF_MOVED | MOUSEEVENTF_ABSOLUTE;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    //Left mouse button down
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[1].mi.dwFlags = MOUSEEVENTF_LEFTDOWN;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    //Left mouse button up
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[2].mi.dwFlags = MOUSEEVENTF_LEFTUP;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    SendInput(3, input, Marshal.SizeOf(input[0]));
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">'@</span>
</span></code></pre><p><code>Add-Type -TypeDefinition $cSource -ReferencedAssemblies System.Windows.Forms,System.Drawing</code><br> <code>[Clicker]::LeftClickAtPoint(1900,1070)</code><h3 id=audio><a aria-label="Anchor link for: audio" class=zola-anchor href=#audio><i class=icon></i></a> Audio</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Language CsharpVersion3 <span class="z-keyword z-operator z-assignment z-powershell">-</span>TypeDefinition <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">using System.Runtime.InteropServices;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[Guid("5CDF2C82-841E-4546-9722-0CF74078229A"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">interface IAudioEndpointVolume {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">// f(), g(), ... are unused COM method slots. Define these if you care
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int f(); int g(); int h(); int i();
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int SetMasterVolumeLevelScalar(float fLevel, System.Guid pguidEventContext);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int j();
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int GetMasterVolumeLevelScalar(out float pfLevel);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int k(); int l(); int m(); int n();
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int SetMute([MarshalAs(UnmanagedType.Bool)] bool bMute, System.Guid pguidEventContext);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int GetMute(out bool pbMute);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[Guid("D666063F-1587-4E43-81F1-B948E807363F"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">interface IMMDevice {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int Activate(ref System.Guid id, int clsCtx, int activationParams, out IAudioEndpointVolume aev);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[Guid("A95664D2-9614-4F35-A746-DE8DB63617E6"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">interface IMMDeviceEnumerator {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int f(); // Unused
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int GetDefaultAudioEndpoint(int dataFlow, int role, out IMMDevice endpoint);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[ComImport, Guid("BCDE0395-E52F-467C-8E3D-C4579291692E")] class MMDeviceEnumeratorComObject { }
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public class Audio {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">static IAudioEndpointVolume Vol() {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">var enumerator = new MMDeviceEnumeratorComObject() as IMMDeviceEnumerator;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">IMMDevice dev = null;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">Marshal.ThrowExceptionForHR(enumerator.GetDefaultAudioEndpoint(/*eRender*/ 0, /*eMultimedia*/ 1, out dev));
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">IAudioEndpointVolume epv = null;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">var epvid = typeof(IAudioEndpointVolume).GUID;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">Marshal.ThrowExceptionForHR(dev.Activate(ref epvid, /*CLSCTX_ALL*/ 23, 0, out epv));
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">return epv;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public static float Volume {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">get {float v = -1; Marshal.ThrowExceptionForHR(Vol().GetMasterVolumeLevelScalar(out v)); return v;}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">set {Marshal.ThrowExceptionForHR(Vol().SetMasterVolumeLevelScalar(value, System.Guid.Empty));}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public static bool Mute {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">get { bool mute; Marshal.ThrowExceptionForHR(Vol().GetMute(out mute)); return mute; }
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">set { Marshal.ThrowExceptionForHR(Vol().SetMute(value, System.Guid.Empty)); }
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span></code></pre><p><code>[Audio]::Volume = 0.50</code><br> <code>[Audio]::Mute = $true</code><h3 id=netsessionenum><a aria-label="Anchor link for: netsessionenum" class=zola-anchor href=#netsessionenum><i class=icon></i></a> NetSessionEnum</h3><p><a href="https://learn.microsoft.com/ru-ru/windows/win32/api/lmshare/nf-lmshare-netsessionenum?redirectedfrom=MSDN">Function</a><br> <a href=https://fuzzysecurity.com/tutorials/24.html>Source</a><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Invoke-NetSessionEnum</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HostName</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>TypeDefinition <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">using System;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">using System.Diagnostics;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">using System.Runtime.InteropServices;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[StructLayout(LayoutKind.Sequential)]
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public struct SESSION_INFO_10
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">{
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    [MarshalAs(UnmanagedType.LPWStr)]public string OriginatingHost;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    [MarshalAs(UnmanagedType.LPWStr)]public string DomainUser;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    public uint SessionTime;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    public uint IdleTime;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public static class Netapi32
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">{
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[DllImport("Netapi32.dll", SetLastError=true)]
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    public static extern int NetSessionEnum(
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        [In,MarshalAs(UnmanagedType.LPWStr)] string ServerName,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        [In,MarshalAs(UnmanagedType.LPWStr)] string UncClientName,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        [In,MarshalAs(UnmanagedType.LPWStr)] string UserName,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        Int32 Level,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        out IntPtr bufptr,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        int prefmaxlen,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        ref Int32 entriesread,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        ref Int32 totalentries,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        ref Int32 resume_handle);
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">         
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[DllImport("Netapi32.dll", SetLastError=true)]
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    public static extern int NetApiBufferFree(
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        IntPtr Buffer);
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Create SessionInfo10 Struct<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> SESSION_INFO_10
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10StructSize</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Runtime.InteropServices.Marshal</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::SizeOf<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Grab size to loop bufptr
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10<span class="z-variable z-other z-member z-powershell">.GetType</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Hacky<span class="z-keyword z-operator z-other z-powershell">,</span> but we need this <span class="z-punctuation z-terminator z-statement z-powershell">;</span>))
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> NetSessionEnum params<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">IntPtr</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Zero<span class="z-keyword z-operator z-other z-powershell">`</span> Struct output buffer
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EntriesRead</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TotalEntries</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ResumeHandle</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">`</span> Counters <span class="z-keyword z-operator z-other z-powershell">&</span> ResumeHandle
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CallResult</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Netapi32</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::NetSessionEnum<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HostName</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">10</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EntriesRead</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TotalEntries</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ResumeHandle</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CallResult</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Mmm something went wrong!<span class="z-constant z-character z-escape z-powershell">`n</span>Error Code: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CallResult</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IntPtr</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Size <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-constant z-character z-escape z-powershell">`n</span>Netapi32::NetSessionEnum Buffer Offset  --> 0x<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0:X8}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr<span class="z-variable z-other z-member z-powershell">.ToInt32</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-constant z-character z-escape z-powershell">`n</span>Netapi32::NetSessionEnum Buffer Offset  --> 0x<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0:X16}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr<span class="z-variable z-other z-member z-powershell">.ToInt64</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Result-set contains <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EntriesRead</span> session(s)!<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Change buffer offset to int<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BufferOffset</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr<span class="z-variable z-other z-member z-powershell">.ToInt64</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Loop buffer entries and cast pointers as SessionInfo10<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">for</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Count</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Count</span> <span class="z-keyword z-operator z-comparison z-powershell">-lt</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EntriesRead</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Count</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-keyword z-operator z-assignment z-powershell">+</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NewIntPtr</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Intptr <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BufferOffset</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Info</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">system.runtime.interopservices.marshal</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::PtrToStructure<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NewIntPtr</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">type</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Info</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BufferOffset</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BufferOffset</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10StructSize</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-constant z-character z-escape z-powershell">`n</span>Calling NetApiBufferFree, no memleaks here!<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Netapi32</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::NetApiBufferFree<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span><span class="z-support z-function z-powershell">Out-Null</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Invoke-NetSessionEnum localhost</code><h3 id=copyfile><a aria-label="Anchor link for: copyfile" class=zola-anchor href=#copyfile><i class=icon></i></a> CopyFile</h3><p><a href=https://learn.microsoft.com/ru-ru/windows/win32/api/winbase/nf-winbase-copyfile>Function</a><br> <a href=https://devblogs.microsoft.com/scripting/use-powershell-to-interact-with-the-windows-api-part-1/>Source</a><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MethodDefinition</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[DllImport("kernel32.dll", CharSet = CharSet.Unicode)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public static extern bool CopyFile(string lpExistingFileName, string lpNewFileName, bool bFailIfExists);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Kernel32</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>MemberDefinition <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MethodDefinition</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Kernel32<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Namespace <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Win32<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PassThru
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Kernel32</span>::CopyFile<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">Env:</span>SystemRoot</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\System32\calc.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">Env:</span>USERPROFILE</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Desktop\calc.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>False</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> 
</span></code></pre><h3 id=showwindowasync><a aria-label="Anchor link for: showwindowasync" class=zola-anchor href=#showwindowasync><i class=icon></i></a> ShowWindowAsync</h3><p><a href=https://learn.microsoft.com/ru-ru/windows/win32/api/winuser/nf-winuser-showwindowasync>Function</a><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Signature</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[DllImport("user32.dll")]public static extern bool ShowWindowAsync(IntPtr hWnd, int nCmdShow);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>MemberDefinition <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Signature</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Win32ShowWindowAsync<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Namespace Win32Functions <span class="z-keyword z-operator z-assignment z-powershell">-</span>PassThru
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-Member</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-storage z-modifier z-powershell">Static</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span>::ShowWindowAsync<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Id <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pid</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.MainWindowHandle<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span>::ShowWindowAsync<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Id <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Pid</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.MainWindowHandle<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span>::ShowWindowAsync<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Id <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Pid</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.MainWindowHandle<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=getasynckeystate><a aria-label="Anchor link for: getasynckeystate" class=zola-anchor href=#getasynckeystate><i class=icon></i></a> GetAsyncKeyState</h3><p><a href=https://learn.microsoft.com/ru-ru/windows/win32/api/winuser/nf-winuser-getasynckeystate>Function</a><p><code>Add-Type -AssemblyName System.Windows.Forms</code><br> <code>[int][System.Windows.Forms.Keys]::F1</code> определить номер [Int] клавиши по ее названию<br> <code>65..90 | % {"{0} = {1}" -f $_, [System.Windows.Forms.Keys]$_}</code> порядковый номер букв (A..Z)<pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-ControlKey</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">112</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Signature</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-heredoc z-powershell">@'
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">[DllImport("user32.dll", CharSet=CharSet.Auto, ExactSpelling=true)] 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">public static extern short GetAsyncKeyState(int virtualKeyCode); 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">'@</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>MemberDefinition <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Signature</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name Keyboard <span class="z-keyword z-operator z-assignment z-powershell">-</span>Namespace PsOneApi
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">bool</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PsOneApi.Keyboard</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetAsyncKeyState<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">-32767</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Warning</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Press F1 to exit<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoNewline
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-ControlKey</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">break</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Seconds <span class="z-constant z-numeric z-integer z-powershell">0.5</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><span class=hidden id=copy-code-text>Copy Code</span><span class=hidden id=search-index>https://lifailon.github.io/search_index.en.json</span><span class=hidden id=more-matches-text>$MATCHES more matches</span></main><footer id=site-footer><nav><ul><li><a href=https://lifailon.github.io/syntax/>PowerShell Syntax</a><li><a href=https://lifailon.github.io/filesystem/>File System</a><li><a href=https://lifailon.github.io/windows/>Operating System</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/threads/>Threads</a><li><a href=https://lifailon.github.io/modules/>Modules</a><li><a class=active href=https://lifailon.github.io/dotnet/>dotNET</a><li><a href=https://lifailon.github.io/com/>COM</a><li><a href=https://lifailon.github.io/servermanager/>Server Manager</a><li><a href=https://lifailon.github.io/activedirectory/>Active Directory</a><li><a href=https://lifailon.github.io/exchange/>Exchange</a><li><a href=https://lifailon.github.io/virtualization/>Virtualization</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/markuplanguages/>Markup Languages</a><li><a href=https://lifailon.github.io/api/>API</a><li><a href=https://lifailon.github.io/zabbix/>Zabbix</a><li><a href=https://lifailon.github.io/devops/>DevOps</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/node-js/>Node.js</a></ul></nav><p>© <strong>2023-2024</strong> <code>Lifailon</code><p><small>Powered by <a class="link external" href=https://www.getzola.org>Zola</a> and <a class="link external" href=https://duckquill.daudix.one>Duckquill</a> </small><ul id=socials><li><a rel=" me" href=https://github.com title=GitHub> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34)" class=icon></i> <span>GitHub</span> </a></ul></footer>