<!doctype html><html data-theme=light lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation) and RuDocs (node.js)" name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ff7800 name=theme-color><meta content=#ffa348 media=(prefers-color-scheme:dark) name=theme-color><meta content="default-src 'none';font-src 'self';img-src 'self' https: data:;media-src 'self' https:;style-src 'self' 'unsafe-inline';frame-src https://player.vimeo.com https://www.youtube-nocookie.com https://toot.community;frame-ancestors 'none';base-uri 'none';form-action 'none';connect-src 'self' https://toot.community;script-src 'self' 'self'" http-equiv=content-security-policy><title>PowerShell Commands / RuDocs</title><link href=https://lifailon.github.io/syntax/ rel=canonical><link href=https://lifailon.github.io/favicon.png rel=icon type=image/png><link href=https://lifailon.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link title="PowerShell Commands / RuDocs - RSS Feed" href=https://lifailon.github.io/rss.xml rel=alternate type=application/rss+xml><link title="PowerShell Commands / RuDocs - Atom Feed" href=https://lifailon.github.io/atom.xml rel=alternate type=application/atom+xml><style>:root{--accent-color:#ff7800;--contrast-color:#000c}[data-theme=dark]{--accent-color:#ffa348}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--accent-color:#ffa348}}[data-theme=dark]{--contrast-color:#000c}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--contrast-color:#000c}}</style><link href=https://lifailon.github.io/style.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=https://lifailon.github.io/syntax-theme-light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://lifailon.github.io/syntax-theme-dark.css rel=stylesheet><script defer src=https://lifailon.github.io/closable.js></script><script defer src=https://lifailon.github.io/copy-button.js></script><script defer src=https://lifailon.github.io/elasticlunr.min.js></script><script defer src=https://lifailon.github.io/search-elasticlunr.js></script><script defer src=https://lifailon.github.io/theme-switcher.js></script><meta content="PowerShell Commands / RuDocs" property=og:site_name><meta content="PowerShell Commands / RuDocs" property=og:title><meta content=https://lifailon.github.io/syntax/ property=og:url><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation) and RuDocs (node.js)" property=og:description><meta content=https://lifailon.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><div id=handle></div><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://lifailon.github.io> <i class=icon></i>PowerShell Commands / RuDocs</a><li class=divider><li><details class=closable><summary>PowerShell</summary> <ul><li><a class=active href=https://lifailon.github.io/syntax/>PowerShell Syntax</a><li><a href=https://lifailon.github.io/filesystem/>File System</a><li><a href=https://lifailon.github.io/windows/>Operating System</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/threads/>Threads</a><li><a href=https://lifailon.github.io/modules/>Modules</a><li><a href=https://lifailon.github.io/dotnet/>dotNET</a><li><a href=https://lifailon.github.io/com/>COM</a><li><a href=https://lifailon.github.io/servermanager/>Server Manager</a><li><a href=https://lifailon.github.io/activedirectory/>Active Directory</a><li><a href=https://lifailon.github.io/exchange/>Exchange</a><li><a href=https://lifailon.github.io/virtualization/>Virtualization</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/markuplanguages/>Markup Languages</a><li><a href=https://lifailon.github.io/api/>API</a><li><a href=https://lifailon.github.io/zabbix/>Zabbix</a><li><a href=https://lifailon.github.io/devops/>DevOps</a></ul></details><li><a href=https://lifailon.github.io/node-js/>Node.js</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li id=search><button class=circle id=search-toggle title=Search><i class=icon></i></button><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details><li id=repo><a class=circle href=https://github.com/Lifailon/PS-Commands title=Repository> <i class=icon></i> </a></ul></nav><div id=search-container><label class=visually-hidden for=search-bar>Search</label><input placeholder="Search for…" autocomplete=off disabled id=search-bar type=search><div id=search-results-container><div id=search-results></div></div></div></header><main id=main-content><h1></h1><p align=center><a href=https://github.com/Lifailon/PS-Commands><img title="PS-Commands Logo" src=PS-Commands-Logo.png></a><p align=center><a href=https://github.com/Lifailon/PS-Commands><img title="PowerShell Cheat Sheet RU" src=PowerShell-Cheat-Sheet-RU.jpg></a><h3 id=help><a aria-label="Anchor link for: help" class=zola-anchor href=#help><i class=icon></i></a> Help</h3><p><code>Get-Verb</code> действия/глаголы, утвержденные для использования в командлетах<br> <code>Get-Command *Language*</code> поиск команды по имени<br> <code>(Get-Command Get-Language).Module</code> узнать к какому модулю принадлежит команда<br> <code>Get-Command Get-Content | fl Module,DLL</code> узнать принадлежность команды к модулю и dll<br> <code>Get-Command -Module LanguagePackManagement</code> отобразить список команд указанного модуля<br> <code>(Get-Module LanguagePackManagement).ExportedCommands.Values</code> отобразить список команд указанного модуля<br> <code>Get-Language | Get-Member</code> отобразить список методов команды (действия), объекты вывода и Event (события объектов: Click)<br> <code>(Get-Help Get-Service).Aliases</code> узнать псевдонимом команды<br> <code>Get-Alias gsv</code> узнать имя команды по псевдониму<br> <code>Get-Help Get-Service</code> синтаксис<br> <code>Get-Help Get-Service -Parameter *</code> описание всех параметров<br> <code>Get-Help Get-Service -Online</code><br> <code>Get-Help Get-Service -ShowWindow</code> описание параметров в GUI с фильтрацией<br> <code>Show-Command</code> вывести список команд в GUI<br> <code>Show-Command Get-Service</code> список параметров команды в GUI<br> <code>Invoke-Expression</code> iex принимает текст для выполнения в консоли как команды<br> <code>$PSVersionTable</code> текущая версия PowerShell<br> <code>Set-ExecutionPolicy Unrestricted</code><br> <code>Get-ExecutionPolicy</code><br> <code>$Metadata = New-Object System.Management.Automation.CommandMetaData (Get-Command Get-Service)</code> получить информацию о командлете<br> <code>[System.Management.Automation.ProxyCommand]::Create($Metadata)</code> исходный код функции<h2 id=object><a aria-label="Anchor link for: object" class=zola-anchor href=#object><i class=icon></i></a> Object</h2><h3 id=variable><a aria-label="Anchor link for: variable" class=zola-anchor href=#variable><i class=icon></i></a> Variable</h3><p><code>$var = Read-Host "Enter"</code> ручной ввод<br> <code>$pass = Read-Host "Enter Password" -AsSecureString</code> скрывать набор<br> <code>$global:path = "\\path"</code> задать глобальную переменную, например в функции<br> <code>$using:srv</code> использовать переменную текущей сесси в Invoke-сессии<br> <code>Get-Variable</code> отобразить все переменные<br> <code>ls variable:/</code> отобразить все переменные<br> <code>Get-Variable *srv*</code> найти переменную по имени<br> <code>Get-Variable -Scope Global</code> отобразить все глобальные переменные<br> <code>Get-Variable Error</code> последняя команда с ошибкой<br> <code>Remove-Variable -Name *</code> очистить все переменные<br> <code>$LASTEXITCODE</code> содержит код вывода последней запущенной программы, например ping. Если код возврата положительный (True), то $LastExitCode = 0<h3 id=env><a aria-label="Anchor link for: env" class=zola-anchor href=#env><i class=icon></i></a> ENV</h3><p><code>Get-ChildItem Env:</code> отобразить все переменные окружения<br> <code>$env:PSModulePath</code> директории импорта модулей<br> <code>$env:userprofile</code><br> <code>$env:computername</code><br> <code>$env:username</code><br> <code>$env:userdnsdomain</code><br> <code>$env:logonserver</code><br> <code>([DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()).Name</code><br> <code>[Environment]::GetFolderPath('ApplicationData')</code><h3 id=history><a aria-label="Anchor link for: history" class=zola-anchor href=#history><i class=icon></i></a> History</h3><p><code>Get-History</code> история команд текущей сессии<br> <code>(Get-History)[-1].Duration.TotalSeconds</code> время выполнения последней команды<br> <code>(Get-PSReadLineOption).HistorySavePath</code> путь к сохраненному файлу с 4096 последних команд (из модуля PSReadLine)<br> <code>Get-Content (Get-PSReadlineOption).HistorySavePath | Select-String Get</code> поиск по содержимому файла (GREP)<br> <code>Set-PSReadlineOption -MaximumHistoryCount 10000</code> изменить количество сохраняемых команд в файл<br> <code>Get-PSReadLineOption | select MaximumHistoryCount</code><br> <code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code> отключить ведение журнала<br> <code>F2</code> переключиться с InlineView на ListView<h3 id=clipboard><a aria-label="Anchor link for: clipboard" class=zola-anchor href=#clipboard><i class=icon></i></a> Clipboard</h3><p><code>Set-Clipboard $srv</code> скопировать в буфер обмена<br> <code>Get-Clipboard</code> вставить<h3 id=write-host><a aria-label="Anchor link for: write-host" class=zola-anchor href=#write-host><i class=icon></i></a> Write-Host</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>BackgroundColor Green <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test:<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoNewline <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> изменить цвет фона и запретить перенос строки<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span> True<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ForegroundColor Green <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> данная строка будет печататься продолжая предыдущую с новыми параметрами цвета (фон по умолчанию, изменяем цвет текста)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><p><code>Write-Error "False"</code><br> <code>Write-Warning "False"</code><h3 id=write-progress><a aria-label="Anchor link for: write-progress" class=zola-anchor href=#write-progress><i class=icon></i></a> Write-Progress</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">100</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Progress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Activity <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test Progress<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PercentComplete <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Milliseconds <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=for><a aria-label="Anchor link for: for" class=zola-anchor href=#for><i class=icon></i></a> for</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">for</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>i</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>i</span> <span class="z-keyword z-operator z-comparison z-powershell">-le</span> <span class="z-constant z-numeric z-integer z-powershell">100</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>i</span><span class="z-keyword z-operator z-assignment z-powershell">+=</span><span class="z-constant z-numeric z-integer z-powershell">10</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Progress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Activity <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test Progress<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PercentComplete <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>i</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Seconds <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=array><a aria-label="Anchor link for: array" class=zola-anchor href=#array><i class=icon></i></a> Array</h3><p><code>$srv = @("server-01", "server-02")</code> создать массив<br> <code>$srv += @("server-03")</code> добавить в массив новый элемент<br> <code>$srv.Count</code> отобразить кол-во элементов в массиве<br> <code>Out-String</code> построчный вывод<h3 id=index><a aria-label="Anchor link for: index" class=zola-anchor href=#index><i class=icon></i></a> Index</h3><p><code>$srv[0]</code> вывести первое значение элемента массива<br> <code>$srv[0] = Name</code> замена элемента в массиве<br> <code>$srv[0].Length</code> узнать кол-во символов первого значения в массиве<br> <code>$srv[10..100]</code> срез<pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>a<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>b<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>c<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>d<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>num</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>a</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>num</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">array</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::IndexOf<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>a</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> узнать номер индекса по зачению<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>num</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> пересобрать исходный массив<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=hashtable><a aria-label="Anchor link for: hashtable" class=zola-anchor href=#hashtable><i class=icon></i></a> HashTable</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>hashtable</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создать (инициализировать)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>User<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>USERNAME</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Server<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>COMPUTERNAME</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>hashtable</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Добавить ключи<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Profile<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PROFILE</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>PowerShell_Home_Dir<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PSHOME</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>$hashtable.Keys</code> список всех ключей<br> <code>$hashtable["User"]</code> получить значение (Values) по ключу<br> <code>$hashtable["User"] = "Test"</code> изменить<br> <code>$hashtable.Remove("User")</code> удалить ключ<h3 id=collections-list><a aria-label="Anchor link for: collections-list" class=zola-anchor href=#collections-list><i class=icon></i></a> Collections/List</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Object</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">User</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>username</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Server</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>computername</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=pscustomobject><a aria-label="Anchor link for: pscustomobject" class=zola-anchor href=#pscustomobject><i class=icon></i></a> PSCustomObject</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CustomObject</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ordered</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">User</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>username</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Server</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>computername</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=add-and-remove-property><a aria-label="Anchor link for: add-and-remove-property" class=zola-anchor href=#add-and-remove-property><i class=icon></i></a> Add and Remove Property</h3><p><code>$CustomObject | Add-Member –MemberType NoteProperty –Name Arr –Value @(1,2,3)</code> добавить свойство/стобец<br> <code>$CustomObject.Arr = @(1,3,5)</code> изменить содержимое<br> <code>$CustomObject.PsObject.Properties.Remove('User')</code> удалить Property<h3 id=add-method><a aria-label="Anchor link for: add-method" class=zola-anchor href=#add-method><i class=icon></i></a> Add Method</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ScriptBlock</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Get-Service</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CustomObject</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Add-Member</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>TestMethod<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>MemberType ScriptMethod <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ScriptBlock</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CustomObject</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-Member</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CustomObject<span class="z-variable z-other z-member z-powershell">.TestMethod</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=class><a aria-label="Anchor link for: class" class=zola-anchor href=#class><i class=icon></i></a> Class</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-storage z-type z-powershell">Class</span> <span class="z-entity z-name z-function">CustomClass</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>User</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Server</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Start<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">bool</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Param1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">If</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Param1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Start Function<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>$Class = New-Object -TypeName CustomClass</code><br> <code>$Class.User = $env:username</code><br> <code>$Class.Server = $env:computername</code><br> <code>$Class.Start(1)</code><h3 id=pipeline><a aria-label="Anchor link for: pipeline" class=zola-anchor href=#pipeline><i class=icon></i></a> Pipeline</h3><p><code>$CustomObject | Add-Member -MemberType NoteProperty -Name "Type" -Value "user" -Force</code> добавление объкта вывода NoteProperty<br> <code>$CustomObject | Add-Member -MemberType NoteProperty -Name "User" -Value "admin" -Force</code> изменеие содержимого для сущности объекта User<br> <code>ping $srv | Out-Null</code> перенаправить результат вывода в Out-Null<h3 id=select-object><a aria-label="Anchor link for: select-object" class=zola-anchor href=#select-object><i class=icon></i></a> Select-Object</h3><p><code>Get-Process | Select-Object -Property *</code> отобразить все доступные объекты вывода<br> <code>Get-Process | select -Unique "Name"</code> удалить повторяющиеся значения в массиве<br> <code>Get-Process | select -ExpandProperty ProcessName</code> преобразовать из объекта-коллекции в массив (вывести содержимое без наименовая столбца)<br> <code>(Get-Process | ? Name -match iperf).Modules</code> список используемых модулей процессом<h3 id=expression><a aria-label="Anchor link for: expression" class=zola-anchor href=#expression><i class=icon></i></a> Expression</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Sort-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Descending CPU <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>first <span class="z-constant z-numeric z-integer z-powershell">10</span> ProcessName<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> сортировка по CPU, вывести первых 10 значений (-first)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ProcessorTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.TotalProcessorTime</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d+$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> затрачено процессорного времени в минутах<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Memory<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.WS</span></span> <span class="z-keyword z-operator z-assignment z-powershell">/</span> <span class="z-constant z-numeric z-integer z-powershell">1024</span><span class="z-keyword z-other z-powershell">kb</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MB<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> делим байты на КБ (1mb)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Label</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>RunTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.StartTime</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d+$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> вычесть из текущего времени - время запуска, и удалить milisec<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=select-string><a aria-label="Anchor link for: select-string" class=zola-anchor href=#select-string><i class=icon></i></a> Select-String</h3><p><code>$(ipconfig | Select-String IPv4) -replace ".+: " | Where-Object {$_ -match "^172."}</code> узнать только IP<br> <code>$Current_IP = Get-Content $RDCMan_RDG_PATH | Select-String $RDCMan_Display_Name -Context 0,1</code> получить две строки<br> <code>$Current_IP = $Current_IP.Context.DisplayPostContext[0] -replace ".+&LTname>|<\/name>"</code> забрать только вторую строку и удалить тэги<h3 id=format-list-format-table><a aria-label="Anchor link for: format-list-format-table" class=zola-anchor href=#format-list-format-table><i class=icon></i></a> Format-List/Format-Table</h3><p><code>Get-Process | fl ProcessName, StartTime</code><br> <code>Get-Process | ft ProcessName, StartTime -Autosize</code> автоматическая группировка размера столбцов<h3 id=measure-object><a aria-label="Anchor link for: measure-object" class=zola-anchor href=#measure-object><i class=icon></i></a> Measure-Object</h3><p><code>Get-Process | Measure | select Count</code> кол-во объектов<br> <code>Get-Process | Measure -Line -Word -Character</code> кол-во строк, слов и Char объектов<br> <code>Get-Process | Measure-Object PM -sum | Select-Object Count,@{Name="MEM_MB"; Expression={[int]($_.Sum/1mb)}}</code> кол-во процессов и общий объем занятой памяти в МБайт<h3 id=compare-object><a aria-label="Anchor link for: compare-object" class=zola-anchor href=#compare-object><i class=icon></i></a> Compare-Object</h3><p><code>Compare-Object -ReferenceObject (Get-Content -Path .\file1.txt) -DifferenceObject (Get-Content -Path .\file2.txt)</code> сравнение двух файлов<br> <code>$group1 = Get-ADGroupMember -Identity "Domain Admins"</code><br> <code>$group2 = Get-ADGroupMember -Identity "Enterprise Admins"</code><br> <code>Compare-Object -ReferenceObject $group1 -DifferenceObject $group2 -IncludeEqual</code> сравнение друх объектов<br> <code>==</code> нет изменений<br> <code><=</code> есть изменения в $group1<br> <code>=></code> есть изменения в $group2<h3 id=where-object><a aria-label="Anchor link for: where-object" class=zola-anchor href=#where-object><i class=icon></i></a> Where-Object (?)</h3><p><code>Get-Process | Where-Object {$_.ProcessName -match "zabbix"}</code> фильтрация/поиск процессов по имени свойства объекта<br> <code>Get-Process | where CPU -gt 10 | Sort-Object -Descending CPU</code> вывести объекты, где значения CPU больше 10<br> <code>Get-Process | where WS -gt 200MB</code> отобразить процессы где WS выше 200МБ<br> <code>Get-Service | where Name -match "zabbix"</code> поиск службы<br> <code>Get-Service -ComputerName $srv | Where {$_.Name -match "WinRM"} | Restart-Service</code> перезапустить службу на удаленном компьютере<br> <code>(Get-Service).DisplayName</code> вывести значения свойства массива<br> <code>netstat -an | where {$_ -match 443}</code><br> <code>netstat -an | ?{$_ -match 443}</code><br> <code>(netstat -an) -match 443</code><h3 id=sort-object><a aria-label="Anchor link for: sort-object" class=zola-anchor href=#sort-object><i class=icon></i></a> Sort-Object</h3><p><code>Get-Process | Sort-Object -Descending CPU | ft</code> обратная (-Descending) сортировка по CPU<br> <code>Get-Process | Sort-Object -Descending cpu,ws</code> сортировка по двум свойствам<br> <code>$path[-1..-10]</code> обратная сборка массива без сортировки<br> <code>$arr = @(1..20); $arr[$($arr.Count - 1)..0]</code> пересобрать массив с конца<h3 id=last-first><a aria-label="Anchor link for: last-first" class=zola-anchor href=#last-first><i class=icon></i></a> Last/First</h3><p><code>Get-Process | Sort-Object -Descending CPU | select -First 10</code> вывести первых 10 объектов<br> <code>Get-Process | Sort-Object -Descending CPU | select -Last 10</code> вывести последних 10 объектов<h3 id=group-object><a aria-label="Anchor link for: group-object" class=zola-anchor href=#group-object><i class=icon></i></a> Group-Object</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Groups</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-CimInstance</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Class Win32_PnPSignedDriver <span class="z-keyword z-operator z-other z-powershell">|</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Select-Object</span> DriverProviderName<span class="z-keyword z-operator z-other z-powershell">,</span> FriendlyName<span class="z-keyword z-operator z-other z-powershell">,</span> Description<span class="z-keyword z-operator z-other z-powershell">,</span> DriverVersion<span class="z-keyword z-operator z-other z-powershell">,</span> DriverDate <span class="z-keyword z-operator z-other z-powershell">|</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Group-Object</span> DriverProviderName<span class="z-keyword z-operator z-other z-powershell">,</span> FriendlyName<span class="z-keyword z-operator z-other z-powershell">,</span> Description<span class="z-keyword z-operator z-other z-powershell">,</span> DriverVersion<span class="z-keyword z-operator z-other z-powershell">,</span> DriverDate
</span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Group</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Groups</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Group<span class="z-variable z-other z-member z-powershell">.Group</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Format-Table</span>
</span></code></pre><h3 id=property><a aria-label="Anchor link for: property" class=zola-anchor href=#property><i class=icon></i></a> Property</h3><p><code>$srv.Count</code> кол-во элементов в массиве<br> <code>$srv.Length</code> содержит количество символом строки переменной [string] или количество значений (строк) объекта<br> <code>$srv.Chars(2)</code> отобразить 3-й символ в строке<br> <code>$srv[2]</code> отобразить 3-ю строку в массиве<h3 id=method><a aria-label="Anchor link for: method" class=zola-anchor href=#method><i class=icon></i></a> Method</h3><p><code>$srv = "127.0.0.1"</code><br> <code>$srv.Insert(0,"https://")</code> добавить значение перед первым символом<br> <code>$srv.Substring(4)</code> удалить (из всего массива) первые 4 символа<br> <code>$srv.Remove(3)</code> удалить из всего массива все после 3 символа<br> <code>$string = "123"</code> создать строку<br> <code>$int = [convert]::ToInt32($string)</code> преобразовать строку в тип данных число<br> <code>[string]::Concat($text,$num)</code> объеденить переменные в одну строку<br> <code>[string]::Join(":",$text,$num)</code> объеденить используя разделитель<br> <code>[string]::Compare($text,$num,$true)</code> выдает 0 при совпадении или 1/-1 при несовпадении, $true (без учета регистра) или $false (с учетом регистра) <code>[string]::Equals($text,\$num)</code>производит сравнение двух строк и выдает $true при их совпадении или $false при несовпадении<code>\[string\]::IsNullOrEmpty(\$text)</code>проверяет наличие строки, если строка пуста $true, если нет $false<code>\[string\]::IsNullOrWhiteSpace(\$text2)\</code> проверяет на наличие только символов пробел, табуляция или символ новой строки<h2 id=error><a aria-label="Anchor link for: error" class=zola-anchor href=#error><i class=icon></i></a> Error</h2><p><code>$Error</code> выводит все ошибки текущего сеанса<br> <code>$Error[0].InvocationInfo</code> развернутый отчет об ошибке<br> <code>$Error.clear()</code><br> <code>$LASTEXITCODE</code> результат выполнения последней команды (0 - успех)<br> <code>exit 1</code> код завершения, который возвращается $LASTEXITCODE<h3 id=executionstatus><a aria-label="Anchor link for: executionstatus" class=zola-anchor href=#executionstatus><i class=icon></i></a> ExecutionStatus</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-History</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>RunTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.EndExecutionTime</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.StartExecutionTime</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>ExecutionStatus<span class="z-keyword z-operator z-other z-powershell">,</span>CommandLine <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> посчитать время работы последней [-1] (или Select-Object -Last 1) выполненной команды и ее узнать статус<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h3 id=measure-command><a aria-label="Anchor link for: measure-command" class=zola-anchor href=#measure-command><i class=icon></i></a> Measure-Command</h3><p><code>$(Measure-Command {ping ya.ru}).TotalSeconds</code> получить время выполнения в секундах<h2 id=datetime><a aria-label="Anchor link for: datetime" class=zola-anchor href=#datetime><i class=icon></i></a> DateTime</h2><p><code>[DateTime]::UtcNow</code> время в формате UTC 0<br> <code>$(Get-Date).AddHours(-3)</code> вычесть три часа из текущего времени<br> <code>$Date = $(Get-Date -Format "dd/MM/yyyy HH:mm:ss")</code> изменить формат отображения времени<br> <code>$Date = Get-Date -f "dd/MM/yyyy"</code> получаем тип данных [string] $($Date.GetType().Name)<br> <code>$Date = "19.05.2024"</code><br> <code>[DateTime]$Date = Get-Date "$Date"</code> преобразовать строку подходящую под формат даты в тип данных <a href=https://lifailon.github.io/syntax/#datetime>DateTime</a><br> <code>$BeforeDate = Get-Date "12.05.2024"</code><br> <code>[int32]$days=$($Date - $BeforeDate).Days</code> посчитать разницу в днях<br> <code>"5/7/07" -as [DateTime]</code> преобразовать входные данные в тип данных <a href=https://lifailon.github.io/syntax/#datetime>DateTime</a><h2 id=timespan><a aria-label="Anchor link for: timespan" class=zola-anchor href=#timespan><i class=icon></i></a> TimeSpan</h2><p><code>New-TimeSpan -Start $(Get-Date) -End $($(Get-Date).AddMinutes(+1))</code> получить разницу во времени<br> <code>$TimeZone = (Get-TimeZone).BaseUtcOffset.TotalMinutes</code> получить разницу в минутах от текущего часового пояса относительно UTC 0<br> <code>$UnixTime  = (New-TimeSpan -Start (Get-Date "01/01/1970") -End ((Get-Date).AddMinutes(-$tz))).TotalSeconds</code> вычесть минуты для получения UTC 0<br> <code>$TimeStamp = ([string]$UnixTime -replace "\..+") + "000000000"</code> получить текущий TimeStamp<h3 id=format><a aria-label="Anchor link for: format" class=zola-anchor href=#format><i class=icon></i></a> Format</h3><pre class=z-code><code><span class="z-text z-plain">HH   # Часы в 24-часовом формате (00 до 23)
</span><span class="z-text z-plain">hh   # Часы в 12-часовом формате (01 до 12)
</span><span class="z-text z-plain">mm   # Минуты (00 до 59)
</span><span class="z-text z-plain">ss   # Секунды (00 до 59)
</span><span class="z-text z-plain">tt   # Десигнатор (AM/PM)
</span><span class="z-text z-plain">fff  # Миллисекунды (000 до 999)
</span><span class="z-text z-plain">d    # День месяца без ведущего нуля (1-31)
</span><span class="z-text z-plain">dd   # День месяца с ведущим нулём (01-31)
</span><span class="z-text z-plain">ddd  # Сокращённое название дня недели (например, "Пн")
</span><span class="z-text z-plain">dddd # Полное название дня недели (например, "Понедельник")
</span><span class="z-text z-plain">M    # Номер месяца без ведущего нуля (1-12)
</span><span class="z-text z-plain">MM   # Номер месяца с ведущим нулём (01-12)
</span><span class="z-text z-plain">MMM  # Сокращённое название месяца (например, "Янв")
</span><span class="z-text z-plain">MMMM # Полное название месяца (например, "Январь")
</span><span class="z-text z-plain">y    # Год без века (0-99)
</span><span class="z-text z-plain">yy   # Год без века с ведущим нулём (00-99)
</span><span class="z-text z-plain">yyyy # Год с веком (например, 2024)
</span><span class="z-text z-plain">g    # Период или эра (например, "н.э.")
</span></code></pre><h3 id=timer><a aria-label="Anchor link for: timer" class=zola-anchor href=#timer><i class=icon></i></a> Timer</h3><p><code>$start_time = Get-Date</code> зафиксировать время до выполнения команды<br> <code>$end_time = Get-Date</code> зафиксировать время по завершению<br> <code>$time = $end_time - $start_time</code> высчитать время работы скрипта<br> <code>$min = $time.minutes</code><br> <code>$sec = $time.seconds</code><br> <code>Write-Host "$min минут $sec секунд"</code><p><code>$timer = [System.Diagnostics.Stopwatch]::StartNew()</code> запустить таймер<br> <code>$timer.IsRunning</code> статус работы таймера<br> <code>$timer.Elapsed.TotalSeconds</code> отобразить время с момента запуска (в секундах)<br> <code>$timer.Stop()</code> остановить таймер<h2 id=regex><a aria-label="Anchor link for: regex" class=zola-anchor href=#regex><i class=icon></i></a> Regex</h2><pre class=z-code><code><span class="z-text z-plain">.       # Обозначает любой символ, кроме новой строки
</span><span class="z-text z-plain">\       # Экранирует любой специальный символ (метасимвол). Используется, если нужно указать конкретный символ, вместо специального ({ } [ ] / \ + * . $ ^ | ?)
</span><span class="z-text z-plain">\A (^)  # Начало строки
</span><span class="z-text z-plain">\Z ($)  # Конец строки
</span><span class="z-text z-plain">\n      # Новая строка
</span><span class="z-text z-plain">\s      # Пробел (эквивалент " "), табуляция, перенос строки
</span><span class="z-text z-plain">\S      # Не пробел
</span><span class="z-text z-plain">\d      # Число от 0 до 9 (20-07-2022 эквивалент: "\d\d-\d\d-\d\d\d\d")
</span><span class="z-text z-plain">\D      # Обозначает любой символ, кроме числа (цифры). Удаления всех символов, кроме цифр: [int]$("123 test" -replace "\D")
</span><span class="z-text z-plain">\w      # Любая буква латиницы, цифра, или знак подчёркивания (от "a" до "z" и от "A" до "Z" или число от 0 до 9)
</span><span class="z-text z-plain">\W      # Не латиница, не цифра, не подчёркивание
</span><span class="z-text z-plain">\b      # Граница слова. Применяется когда нужно выделить, что искомые символы являются словом, а не частью другого слова
</span><span class="z-text z-plain">\B      # Не граница слова
</span><span class="z-text z-plain">\A      # Начало текста
</span><span class="z-text z-plain">\Z      # Конец текста
</span><span class="z-text z-plain">+       # Повторяется 1 и более раз (\s+)
</span><span class="z-text z-plain">|       # Или. Соединяет несколько вариантов
</span><span class="z-text z-plain">()      # В круглые скобки заключаются все комбинации с "или" и поиск начала и конца строк
</span><span class="z-text z-plain">[]      # поиск совпадения любой буквы, например, [A-z0-9] от A до z и цифры от 0 до 9 ("192.168.1.1" -match "192.1[6-7][0-9]")
</span><span class="z-text z-plain">[^ ]    # Исключает из поиска символы указанные в квадратных скобках
</span><span class="z-text z-plain">{ }     # Квантификатор в фигурных скобках, указывает количество повторений символа слева на право (от 1 до 25 раз)
</span><span class="z-text z-plain">\d{2}   # Найти две цифры
</span><span class="z-text z-plain">\d{2,4} # Найти две или четыре
</span><span class="z-text z-plain">{4,}    # Найти четыре и более
</span></code></pre><h3 id=iakori><a aria-label="Anchor link for: iakori" class=zola-anchor href=#iakori><i class=icon></i></a> Якори</h3><p><code>^</code> или <code>\A</code> определяет начало строки. $url -replace ‘^’,‘https:’<code>добавить в начало; </code>$<code>или``\Z</code>{=tex}<code>обозначают конец строки. $ip -replace "\d{1,3}$","0"</code>(?=text)<code>поиск слова слева. Пишем слева на право от искомого (ищет только целые словосочетания) "Server:\s(.{1,30})\s(?=$username)"</code>(?<=text)<code>поиск слова справа. $in_time -replace ".+(?<=Last)"</code> удалить все до слова Last<br> <code>(?!text)</code> не совпадает со словом слева<br> <code>(?&LT!text)</code> не совпадает со словом справа<p><code>$test = "string"</code><br> <code>$test -replace ".{1}$"</code> удалить любое кол-во символов в конце строки<br> <code>$test -replace "^.{1}"</code> удалить любое кол-во символов в начале строки<h3 id=gruppy-zakhvata><a aria-label="Anchor link for: gruppy-zakhvata" class=zola-anchor href=#gruppy-zakhvata><i class=icon></i></a> Группы захвата</h3><p><code>$date = '12.31.2021'</code><br> <code>$date -replace '^(\d{2}).(\d{2})','$2.$1'</code> поменять местами<br> <code>$1</code> содержимое первой группы в скобках<br> <code>$2</code> содержимое второй группы<p><code>-replace "1","2"</code> замена элементов в индексах массива (везде где присутствует 1, заменить на 2), для удаления используется только первое значение<br> <code>-split " "</code> преобразовать строку в массив, разделителем указан пробел, которой удаляется ($url.Split(“/”)[-1])<br> <code>-join " "</code> преобразовать массив (коллекцию) в единую строку (string), добавить разделителем пробел<p><code>@(1,2,3) -contains 3</code> проверить, что элемент справа содержится в массиве слева<br> <code>@(1,2) -notcontains 3</code> проверить, что элемент справа не содержится в массиве слева<p><code>-like *txt*</code> поиск по маскам wildcard, выводит значение на экран<br> <code>-match txt</code> поиска по шаблонам, проверка на соответствие содержимого текста<br> <code>-match "zabbix|rpc"</code> условия, для поиска по нескольким словам<br> <code>-NotMatch</code> проверка на отсутствие вхождения<h3 id=matches><a aria-label="Anchor link for: matches" class=zola-anchor href=#matches><i class=icon></i></a> Matches</h3><p><code>"num: 777" -match "num: ([0-9]+)" | Out-Null</code><br> <code>$Matches[1]</code> выводим только номер<p><code>$ip = "192.168.10.1"</code><br> <code>$ip -match "(\.\d{1,3})\.\d{1,2}"</code> True<br> <code>$Matches</code> отобразить все подходящие переменные последнего поиска, которые входят и не входят в группы ()<p><code>$String = "09/14/2017 12:00:27 - mtbill_post_201709141058.txt 7577_Delivered: OK"</code><br> <code>$String -Match ".*(?=\.txt)" | Out-Null</code><br> <code>$Matches[0][-4..-1] -Join ""</code><p><code>$string.Substring($string.IndexOf(".txt")-4, 4)</code> 2-й вариант (IndexOf)<h3 id=formatirovanie-net-method-format><a aria-label="Anchor link for: formatirovanie-net-method-format" class=zola-anchor href=#formatirovanie-net-method-format><i class=icon></i></a> Форматирование (.NET method format)</h3><p><code>[string]::Format("{1} {0}","Index0","Index1")</code><br> <code>"{1} {0}" -f "Index0","Index1"</code><br> <code>"{0:###-###-###}" -f 1234567</code> записать число в другом формате (#)<br> <code>"{0:0000}" -f 123</code> вывести число в формате не меньше 4 знаков (0123)<br> <code>"{0:P0}" -f (220/1000)</code> посчитать в процентах (P)<br> <code>"{0:P}" -f (512MB/1GB)</code> сколько % составляет 512Мб от 1Гб<br> <code>"{0:0.0%}" -f 0.123</code> умножить на 100%<pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>gp</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-other z-powershell">|</span> sort cpu <span class="z-keyword z-operator z-assignment z-powershell">-</span>Descending <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>First <span class="z-constant z-numeric z-integer z-powershell">10</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>p</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>gp</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0} - {1:N2}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>p<span class="z-variable z-other z-member z-powershell">.processname</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>p<span class="z-variable z-other z-member z-powershell">.cpu</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> округлить<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=uslovnyi-operator><a aria-label="Anchor link for: uslovnyi-operator" class=zola-anchor href=#uslovnyi-operator><i class=icon></i></a> Условный оператор</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rh</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Read-Host</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rh</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    ipconfig
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rh</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    getmac
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    hostname
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p>Если условие if () является истенным ($True), выполнить действие в {} Если условие if () является ложным ($False), выполнить действие не обязательного оператора else<br> Условие Elseif идёт после условия if для проверки дополнительных условий перед выполнение оператора else. Оператор, который первый вернет $True, отменит выполнение следующих дополнительных условий<br> Если передать переменную в условие без оператора, то будет проверяться наличие значения у переменной на $True/$False<pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Test-NetConnection</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Port <span class="z-constant z-numeric z-integer z-powershell">80</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.TcpTestSucceeded</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Opened port<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Closed port<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=logicheskie-operatory-sravneniia><a aria-label="Anchor link for: logicheskie-operatory-sravneniia" class=zola-anchor href=#logicheskie-operatory-sravneniia><i class=icon></i></a> Логические операторы сравнения</h3><p><code>-eq</code> равно (equal)<br> <code>-ceq</code> учитывать регистр<br> <code>-ne</code> не равно (not equal)<br> <code>-cne</code> не равно учитывая регистр<br> <code>-gt</code> больше (greater)<br> <code>-ge</code> больше или равно<br> <code>-lt</code> меньше (less)<br> <code>-le</code> меньше или равно<br> <code>-in</code> проверить на наличие (5 -in @(1,2,3,4,5))<br> <code>-NOT</code> логическое НЕТ !(Test-Path $path)<br> <code>-and</code> логическое И<br> <code>-or</code> логическое ИЛИ<pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>1</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-logical z-powershell">-and</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>2</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-logical z-powershell">-or</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>1</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> два условия: (если $1 = 1 И $2 = 2) ИЛИ $1 не равно 3 вернуть $true<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h3 id=pipeline-operators><a aria-label="Anchor link for: pipeline-operators" class=zola-anchor href=#pipeline-operators><i class=icon></i></a> Pipeline Operators</h3><p><code>Write-Output "First" && Write-Output "Second"</code> две успешные команды выполняются<br> <code>Write-Error "Bad" && Write-Output "Second"</code> первая команда завершается ошибкой, из-за чего вторая команда не выполняется<br> <code>Write-Error "Bad" || Write-Output "Second"</code> первая команда завершается ошибкой, поэтому выполняется вторая команда<br> <code>Write-Output "First" || Write-Output "Second"</code> первая команда выполнена успешно, поэтому вторая команда не выполняется<h3 id=invocation-operator><a aria-label="Anchor link for: invocation-operator" class=zola-anchor href=#invocation-operator><i class=icon></i></a> Invocation Operator</h3><p><code>$addr = "8.8.8.8"</code><br> <code>$ping = "ping"</code><br> <code>& $ping $addr</code> запускает текст как команду<p><code>& $ping $addr &</code> запустить команду в фоне<br> <code>(Get-Job)[-1] | Receive-Job -Keep</code><h2 id=datatype><a aria-label="Anchor link for: datatype" class=zola-anchor href=#datatype><i class=icon></i></a> DataType</h2><p><code>$srv.GetType()</code> узнать тип данных<br> <code>$srv -is [string]</code> проверка на соответствие типа данных<br> <code>$srv -isnot [System.Object]</code> проверка на несоответствие<br> <code>[Object]</code> массив (BaseType:System.Array)<br> <code>[DateTime]</code> формат времени (BaseType:System.ValueType)<br> <code>[Bool]/[Boolean]</code> логическое значение ($True/$False) или 1/0 (1 бит) наличие/отсуствие напряжения<br> <code>[Byte]</code> 8-битное (1 байт) целое число без знака (0..255)<br> <code>[Int16]</code> 16-битное знаковое целое число от -32767 до 32767 (тип данных WORD 0..65535)<br> <code>[Int]</code> 32-битное (4 байта) знаковое целое число от –2147483648 до 2147483647 (DWORD)<br> <code>[Int64]</code> 64-битное от -9223372036854775808 до 9223372036854775808 (LWORD)<br> <code>[Decimal]</code> 128-битное десятичное значение от –79228162514264337593543950335 до 79228162514264337593543950335<br> <code>[Single]</code> число с плавающей запятой (32-разрядное)<br> <code>[Double]</code> число с плавающей запятой с двойной точностью (64-разрядное)<br> <code>[String]</code> неизменяемая строка символов Юникода фиксированной длины (BaseType:System.Object)<h3 id=math><a aria-label="Anchor link for: math" class=zola-anchor href=#math><i class=icon></i></a> Math</h3><p><code>[math] | Get-Member -Static</code><br> <code>[math]::Pow(2,4)</code> 2 в 4 степени<br> <code>[math]::Truncate(1.8)</code> грубое округление, удаляет дробную часть<br> <code>[math]::Ceiling(1.8)</code> округляет число в большую сторону до ближайшего целого значения<br> <code>[math]::Floor(-1.8)</code> округляет число в меньшую сторону<br> <code>[math]::Min(33,22)</code> возвращает наименьшее значение двух значений<br> <code>[math]::Max(33,22)</code> возвращает наибольшее значение двух значений<h3 id=round><a aria-label="Anchor link for: round" class=zola-anchor href=#round><i class=icon></i></a> Round</h3><p><code>[double]::Round(87.5, 0)</code> 88 (нечетное), в .NET по умолчанию используется округление в средней точке ToEven, где *.5 значения округляются до ближайшего четного целого числа<br> <code>[double]::Round(88.5, 0)</code> 88 (четное)<br> <code>[double]::Round(88.5, 0, 1)</code> 89 (округлять в большую сторону)<br> <code>[double]::Round(1234.56789, 2)</code> округлить до 2 символов после запятой<h3 id=tostring><a aria-label="Anchor link for: tostring" class=zola-anchor href=#tostring><i class=icon></i></a> ToString</h3><p><code>(4164539/1MB).ToString("0.00")</code> разделить на дважды на 1024/1024 и округлить до 3,97<h3 id=char><a aria-label="Anchor link for: char" class=zola-anchor href=#char><i class=icon></i></a> Char</h3><p><code>[Char]</code> cимвол Юникода (16-разрядный)<br> <code>$char = $srv.ToCharArray()</code> разбить строку [string] на массив [System.Array] из букв<h3 id=switch-function><a aria-label="Anchor link for: switch-function" class=zola-anchor href=#switch-function><i class=icon></i></a> Switch function</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MMM</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Date</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>UFormat <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>%m<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">switch</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MMM</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>01<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Jan<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>02<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Feb<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>03<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Mar<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>04<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Apr<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>05<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>May<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>06<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Jun<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>07<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Jul<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>08<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Aug<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>09<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Sep<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>10<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Oct<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>11<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Nov<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>12<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Dec<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=switch-param><a aria-label="Anchor link for: switch-param" class=zola-anchor href=#switch-param><i class=icon></i></a> Switch param</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">Function</span> <span class="z-entity z-name z-function z-powershell">fun-switch</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>param</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">If</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>param</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>yes<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>no<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>fun-switch -param</code><h2 id=bit><a aria-label="Anchor link for: bit" class=zola-anchor href=#bit><i class=icon></i></a> Bit</h2><pre class=z-code><code><span class="z-text z-plain">Двоичное    Десятичное
</span><span class="z-text z-plain">1           1
</span><span class="z-text z-plain">10          2
</span><span class="z-text z-plain">11          3
</span><span class="z-text z-plain">100         4
</span><span class="z-text z-plain">101         5
</span><span class="z-text z-plain">110         6
</span><span class="z-text z-plain">111         7
</span><span class="z-text z-plain">1000        8
</span><span class="z-text z-plain">1001        9
</span><span class="z-text z-plain">1010        10
</span><span class="z-text z-plain">1011        11
</span><span class="z-text z-plain">1100        12
</span><span class="z-text z-plain">1101        13
</span><span class="z-text z-plain">1110        14
</span><span class="z-text z-plain">1111        15
</span><span class="z-text z-plain">1 0000      16
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Двоичное    Десятичное  Номер разряда
</span><span class="z-text z-plain">1           1           0
</span><span class="z-text z-plain">10          2           1
</span><span class="z-text z-plain">100         4           2
</span><span class="z-text z-plain">1000        8           3
</span><span class="z-text z-plain">1 0000      16          4
</span><span class="z-text z-plain">10 0000     32          5
</span><span class="z-text z-plain">100 0000    64          6
</span><span class="z-text z-plain">1000 0000   128         7
</span><span class="z-text z-plain">1 0000 0000 256         8
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Из двоичного => десятичное (1-й вариант по таблице)
</span><span class="z-text z-plain">1001 0011 = 1000 0000 + 1 0000 + 10 + 1 = 128 + 16 + 2 + 1 = 147
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">2-й вариант
</span><span class="z-text z-plain">7654 3210 (разряды двоичного выражения) = (1*2^7)+(0*2^6)+(0*2^5)+(1*2^4)+(0*2^3)+(0*2^2)+(1*2^1)+(1*2^0) = 147
</span><span class="z-text z-plain">[math]::Pow(2,7) + [math]::Pow(2,4) + [math]::Pow(2,1) + [math]::Pow(2,0) = 147` исключить 0 и сложить степень
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Из десятичного => двоичное (1-й вариант по таблице)
</span><span class="z-text z-plain">347 вычесть ближайшие 256 = 91 (+ 1 0000 0000 забрать двоичный остаток)
</span><span class="z-text z-plain">91  - 64  = 27 ближайшее 16 (+ 100 0000)
</span><span class="z-text z-plain">27  - 16  = 11 ближайшее 8 (+ 1 0000)
</span><span class="z-text z-plain">11  - 8   = 3  ближайшее 2 (+ 1000)
</span><span class="z-text z-plain">3   - 2   = 1 (+ 10)
</span><span class="z-text z-plain">1   - 1   = 0 (+ 1)
</span><span class="z-text z-plain">1 0101 1011
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">2-й вариант
</span><span class="z-text z-plain">Последовательное деления числа на 2, предворительно забирая остаток для получения четного числа в меньшую сторону
</span><span class="z-text z-plain">347 - 346 = остаток 1, (347-1)/2 = 173
</span><span class="z-text z-plain">173 - 172 = остаток 1, (172-1)/2 = 86
</span><span class="z-text z-plain">86  - 86  = остаток 0, 86/2 = 43
</span><span class="z-text z-plain">43  - 42  = остаток 1, (43-1)/2 = 21
</span><span class="z-text z-plain">21  - 20  = остаток 1, (21-1)/2 = 10
</span><span class="z-text z-plain">10  - 10  = остаток 0, 10/2 = 5
</span><span class="z-text z-plain">5   - 4   = остаток 1, (5-1)/2 = 2
</span><span class="z-text z-plain">2   - 2   = остаток 0, 2/2 = 1
</span><span class="z-text z-plain">1   - 2   = остаток 1, (1-1)/2 = 0
</span><span class="z-text z-plain">Результат деления записывается снизу вверх
</span></code></pre><h3 id=bit-convertor><a aria-label="Anchor link for: bit-convertor" class=zola-anchor href=#bit-convertor><i class=icon></i></a> Bit Convertor</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertTo-Bit</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">array</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetType<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">double</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">array</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetType<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">array</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span>  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">-999</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\s<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>ConvertTo-Bit 347</code><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertFrom-Bit</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bit</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bit<span class="z-variable z-other z-member z-powershell">.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ToCharArray<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits<span class="z-variable z-other z-member z-powershell">.Count</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-constant z-numeric z-integer z-powershell">-1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>b</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>b</span> <span class="z-keyword z-operator z-comparison z-powershell">-notlike</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">math</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Pow<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span> <span class="z-keyword z-operator z-assignment z-powershell">-=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>ConvertFrom-Bit 10010011</code><p><code>Get-Process pwsh | fl ProcessorAffinity</code> привязка процесса к ядрам, представляет из себя битовую маску (bitmask), где каждому биту соответствует ядро процессора. Если для ядра отмечено сходство (affinity), то бит выставляется в 1, если нет — то в 0. Например, если выбраны все 16 ядер, то это 1111 1111 1111 1111 или 65535.<br> <code>$(Get-Process pwsh).ProcessorAffinity = 15</code> 0000000000001111 присвоить 4 первых ядра<br> <code>$(Get-Process pwsh).ProcessorAffinity = 61440</code> 1111000000000000 присвоить 4 последних ядра<br> <code>$(Get-Process pwsh).ProcessorAffinity = (ConvertFrom-Bit 1111000000000000)</code><h2 id=cycle><a aria-label="Anchor link for: cycle" class=zola-anchor href=#cycle><i class=icon></i></a> Cycle</h2><h3 id=foreach><a aria-label="Anchor link for: foreach" class=zola-anchor href=#foreach><i class=icon></i></a> Foreach</h3><p><code>$list = 100..110</code> создать массив из цифр от 100 до 110<br> <code>foreach ($srv in $list) {ping 192.168.3.$srv -n 1 -w 50}</code> $srv хранит текущий элемент из $list и повторяет команду до последнего элемента в массиве <code>$foreach.Current</code>текущий элемент в цикле<code>$foreach.Reset()</code> обнуляет итерацию, перебор начнется заново, что приводит к бесконечному циклу <code>$foreach.MoveNext()\</code> переход к следующему элементу в цикле<h3 id=foreach-object><a aria-label="Anchor link for: foreach-object" class=zola-anchor href=#foreach-object><i class=icon></i></a> ForEach-Object (%)</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">100</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">110</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">%</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-constant z-numeric z-integer z-powershell">192.168</span>.<span class="z-constant z-numeric z-integer z-powershell">3</span>.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-redirection z-powershell">></span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastExitCode</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ForegroundColor green
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">-</span>ForegroundColor Red
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>%</code> передать цикл через конвеер (ForEach-Object)<br> <code>$_</code> переменная цикла и конвеера ($PSItem) <code>gwmi Win32_QuickFixEngineering | where {$*.InstalledOn.ToString()  -match "2022"} \| %{(\$*.HotFixID.Substring(2))}\</code> gwmi создает массив, вывод команды передается where для поиска подходящих под критерии объектов. По конвееру передается в цикл для удаления первых (2) символов методом Substring из всех объектов HotFixID.<h3 id=while><a aria-label="Anchor link for: while" class=zola-anchor href=#while><i class=icon></i></a> While</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>yandex.ru<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out2</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Есть пинг<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out3</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Нет пинга<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> предварительно сбросить переменную, While проверяет условие до запуска цикла<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">While</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> пока условие является $true, цикл будет повторяться<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ttl<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out2</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out3</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> sleep <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> запустить бесконечный цикл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> ping yandex.ru <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>TTL<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> условие, при котором будет выполнен break<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Сайт доступен<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">break</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> остановит цикл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Сайт недоступен<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> sleep <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=try-catch-finally><a aria-label="Anchor link for: try-catch-finally" class=zola-anchor href=#try-catch-finally><i class=icon></i></a> Try-Catch-Finally</h3><pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">Try</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> pping <span class="z-constant z-numeric z-integer z-powershell">192.168</span>.<span class="z-constant z-numeric z-integer z-powershell">3.1</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">Catch</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Write-Warning</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>error</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> выводит в случае ошибки (вместо ошибки)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">finally</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>End<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> выполняется в конце в любом случае<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h3 id=out-gridview><a aria-label="Anchor link for: out-gridview" class=zola-anchor href=#out-gridview><i class=icon></i></a> Out-Gridview</h3><p><code>Get-Service -cn $srv | Out-GridView -Title "Service $srv" -OutputMode Single –PassThru | Restart-Service</code> перезапустить выбранную службу<h3 id=out-file><a aria-label="Anchor link for: out-file" class=zola-anchor href=#out-file><i class=icon></i></a> Out-File</h3><p><code>Read-Host –AsSecureString | ConvertFrom-SecureString | Out-File "$env:userprofile\desktop\password.txt"</code> писать в файл. Преобразовать пароль в формат SecureString с использованием шифрования Windows Data Protection API (DPAPI)<h3 id=get-content-gc-cat-type><a aria-label="Anchor link for: get-content-gc-cat-type" class=zola-anchor href=#get-content-gc-cat-type><i class=icon></i></a> Get-Content (gc/cat/type)</h3><p><code>$password = gc "$env:userprofile\desktop\password.txt" | ConvertTo-SecureString</code> читать хэш пароля из файла с помощью ключей, хранящихся в профиле текущего пользователя, который невозможно прочитать на другом копьютере<h3 id=aes-key><a aria-label="Anchor link for: aes-key" class=zola-anchor href=#aes-key><i class=icon></i></a> AES Key</h3><p><code>$AESKey = New-Object Byte[] 32</code><br> <code>[Security.Cryptography.RNGCryptoServiceProvider]::Create().GetBytes($AESKey)</code><br> <code>$AESKey | Out-File "C:\password.key"</code><br> <code>$Cred.Password | ConvertFrom-SecureString -Key (Get-Content "C:\password.key") | Set-Content "C:\password.txt"</code> сохранить пароль в файл используя внешний ключ<br> <code>$pass = Get-Content "C:\password.txt" | ConvertTo-SecureString -Key (Get-Content "\\Server\Share\password.key")</code> расшифровать пароль на втором компьютере</p><span class=hidden id=copy-code-text>Copy Code</span><span class=hidden id=search-index>https://lifailon.github.io/search_index.en.json</span><span class=hidden id=more-matches-text>$MATCHES more matches</span></main><footer id=site-footer><nav><ul><li><a class=active href=https://lifailon.github.io/syntax/>PowerShell Syntax</a><li><a href=https://lifailon.github.io/filesystem/>File System</a><li><a href=https://lifailon.github.io/windows/>Operating System</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/threads/>Threads</a><li><a href=https://lifailon.github.io/modules/>Modules</a><li><a href=https://lifailon.github.io/dotnet/>dotNET</a><li><a href=https://lifailon.github.io/com/>COM</a><li><a href=https://lifailon.github.io/servermanager/>Server Manager</a><li><a href=https://lifailon.github.io/activedirectory/>Active Directory</a><li><a href=https://lifailon.github.io/exchange/>Exchange</a><li><a href=https://lifailon.github.io/virtualization/>Virtualization</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/markuplanguages/>Markup Languages</a><li><a href=https://lifailon.github.io/api/>API</a><li><a href=https://lifailon.github.io/zabbix/>Zabbix</a><li><a href=https://lifailon.github.io/devops/>DevOps</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/node-js/>Node.js</a></ul></nav><p>© <strong>2023-2024</strong> <code>Lifailon</code><p><small>Powered by <a class="link external" href=https://www.getzola.org>Zola</a> and <a class="link external" href=https://duckquill.daudix.one>Duckquill</a> </small><ul id=socials><li><a rel=" me" href=https://github.com title=GitHub> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34)" class=icon></i> <span>GitHub</span> </a></ul></footer>