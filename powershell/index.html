<!doctype html><html data-theme=dark lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation), Linux commands and RuDocs for Node.js" name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ff7800 name=theme-color><meta content=#ffa348 media=(prefers-color-scheme:dark) name=theme-color><meta content="default-src 'none';font-src 'self';img-src 'self' https: data:;media-src 'self' https:;style-src 'self' 'unsafe-inline';frame-src https://player.vimeo.com https://www.youtube-nocookie.com https://toot.community;frame-ancestors 'none';base-uri 'none';form-action 'none';connect-src 'self' https://toot.community;script-src 'self' 'self'" http-equiv=content-security-policy><title>PowerShell - PowerShell Commands</title><link href=https://lifailon.github.io/powershell/ rel=canonical><link href=https://lifailon.github.io/favicon.png rel=icon type=image/png><link href=https://lifailon.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link title="PowerShell Commands - RSS Feed" href=https://lifailon.github.io/rss.xml rel=alternate type=application/rss+xml><link title="PowerShell Commands - Atom Feed" href=https://lifailon.github.io/atom.xml rel=alternate type=application/atom+xml><style>:root{--accent-color:#ff7800}[data-theme=dark]{--accent-color:#ffa348}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--accent-color:#ffa348}}</style><link href=https://lifailon.github.io/style.css rel=stylesheet><link href=https://lifailon.github.io/icons.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=https://lifailon.github.io/syntax-theme-light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://lifailon.github.io/syntax-theme-dark.css rel=stylesheet><script defer src=https://lifailon.github.io/closable.js></script><script defer src=https://lifailon.github.io/copy-button.js></script><script defer src=https://lifailon.github.io/fuse.js></script><script defer src=https://lifailon.github.io/search-fuse.js></script><script defer src=https://lifailon.github.io/theme-switcher.js></script><meta content="PowerShell Commands" property=og:site_name><meta content="PowerShell - PowerShell Commands" property=og:title><meta content=https://lifailon.github.io/powershell/ property=og:url><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation), Linux commands and RuDocs for Node.js" property=og:description><meta content=https://lifailon.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><div id=handle></div><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://lifailon.github.io> <i class=icon></i>PowerShell Commands</a><li class=divider><li><a class=active href=https://lifailon.github.io/powershell/>PowerShell</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/devops/>DevOps</a><li><a href=https://lifailon.github.io/golang/>GoLang</a><li><a href=https://lifailon.github.io/node-js/>Node.js</a><li id=search><button class=circle id=search-toggle title=Search><i class=icon></i></button><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details><li id=repo><a class=circle href=https://github.com/Lifailon/PS-Commands title=Repository> <i class=icon></i> </a></ul></nav><div id=search-container><label class=visually-hidden for=search-bar>Search</label><input placeholder="Search for…" autocomplete=off disabled id=search-bar type=search><div id=search-results-container><div id=search-results></div></div></div></header><div id=sidebar><div><h2>Table of Contents</h2><ul><li><a href=https://lifailon.github.io/powershell/#cheat-sheet>Cheat-Sheet</a><li><a href=https://lifailon.github.io/powershell/#help>Help</a><li><a href=https://lifailon.github.io/powershell/#object>Object</a><ul><li><a href=https://lifailon.github.io/powershell/#variable>Variable</a><li><a href=https://lifailon.github.io/powershell/#env>ENV</a><li><a href=https://lifailon.github.io/powershell/#history>History</a><li><a href=https://lifailon.github.io/powershell/#clipboard>Clipboard</a><li><a href=https://lifailon.github.io/powershell/#write-host>Write-Host</a><li><a href=https://lifailon.github.io/powershell/#write-progress>Write-Progress</a><li><a href=https://lifailon.github.io/powershell/#for>for</a><li><a href=https://lifailon.github.io/powershell/#array>Array</a><li><a href=https://lifailon.github.io/powershell/#index>Index</a><li><a href=https://lifailon.github.io/powershell/#hashtable>HashTable</a><li><a href=https://lifailon.github.io/powershell/#collections-list>Collections/List</a><li><a href=https://lifailon.github.io/powershell/#pscustomobject>PSCustomObject</a><li><a href=https://lifailon.github.io/powershell/#add-and-remove-property>Add and Remove Property</a><li><a href=https://lifailon.github.io/powershell/#add-method>Add Method</a><li><a href=https://lifailon.github.io/powershell/#class>Class</a><li><a href=https://lifailon.github.io/powershell/#pipeline>Pipeline</a><li><a href=https://lifailon.github.io/powershell/#select-object>Select-Object</a><li><a href=https://lifailon.github.io/powershell/#expression>Expression</a><li><a href=https://lifailon.github.io/powershell/#select-string>Select-String</a><li><a href=https://lifailon.github.io/powershell/#format-list-format-table>Format-List/Format-Table</a><li><a href=https://lifailon.github.io/powershell/#measure-object>Measure-Object</a><li><a href=https://lifailon.github.io/powershell/#compare-object>Compare-Object</a><li><a href=https://lifailon.github.io/powershell/#where-object>Where-Object (?)</a><li><a href=https://lifailon.github.io/powershell/#sort-object>Sort-Object</a><li><a href=https://lifailon.github.io/powershell/#last-first>Last/First</a><li><a href=https://lifailon.github.io/powershell/#group-object>Group-Object</a><li><a href=https://lifailon.github.io/powershell/#property>Property</a><li><a href=https://lifailon.github.io/powershell/#method>Method</a></ul><li><a href=https://lifailon.github.io/powershell/#error>Error</a><ul><li><a href=https://lifailon.github.io/powershell/#executionstatus>ExecutionStatus</a><li><a href=https://lifailon.github.io/powershell/#measure-command>Measure-Command</a></ul><li><a href=https://lifailon.github.io/powershell/#datetime>DateTime</a><li><a href=https://lifailon.github.io/powershell/#timespan>TimeSpan</a><ul><li><a href=https://lifailon.github.io/powershell/#format>Format</a><li><a href=https://lifailon.github.io/powershell/#timer>Timer</a></ul><li><a href=https://lifailon.github.io/powershell/#regex>Regex</a><ul><li><a href=https://lifailon.github.io/powershell/#iakori>Якори</a><li><a href=https://lifailon.github.io/powershell/#gruppy-zakhvata>Группы захвата</a><li><a href=https://lifailon.github.io/powershell/#matches>Matches</a><li><a href=https://lifailon.github.io/powershell/#formatirovanie>Форматирование</a><li><a href=https://lifailon.github.io/powershell/#uslovnyi-operator>Условный оператор</a><li><a href=https://lifailon.github.io/powershell/#logicheskie-operatory-sravneniia>Логические операторы сравнения</a><li><a href=https://lifailon.github.io/powershell/#pipeline-operators>Pipeline Operators</a><li><a href=https://lifailon.github.io/powershell/#invocation-operator>Invocation Operator</a></ul><li><a href=https://lifailon.github.io/powershell/#datatype>DataType</a><ul><li><a href=https://lifailon.github.io/powershell/#math>Math</a><li><a href=https://lifailon.github.io/powershell/#round>Round</a><li><a href=https://lifailon.github.io/powershell/#tostring>ToString</a><li><a href=https://lifailon.github.io/powershell/#char>Char</a></ul><li><a href=https://lifailon.github.io/powershell/#function>Function</a><ul><li><a href=https://lifailon.github.io/powershell/#switch-function>Switch function</a><li><a href=https://lifailon.github.io/powershell/#switch-param>Switch param</a><li><a href=https://lifailon.github.io/powershell/#psm1-module-file-and-parameters>psm1 (module file and parameters)</a><li><a href=https://lifailon.github.io/powershell/#psd1-module-description-file>psd1 (module description file)</a></ul><li><a href=https://lifailon.github.io/powershell/#bit>Bit</a><ul><li><a href=https://lifailon.github.io/powershell/#bit-convertor>Bit Convertor</a></ul><li><a href=https://lifailon.github.io/powershell/#cycle>Cycle</a><ul><li><a href=https://lifailon.github.io/powershell/#foreach>Foreach</a><li><a href=https://lifailon.github.io/powershell/#foreach-object>ForEach-Object (%)</a><li><a href=https://lifailon.github.io/powershell/#while>While</a><li><a href=https://lifailon.github.io/powershell/#try-catch-finally>Try-Catch-Finally</a></ul><li><a href=https://lifailon.github.io/powershell/#files>Files</a><ul><li><a href=https://lifailon.github.io/powershell/#clear-env-temp-14-days>Clear-env-Temp-14-days</a><li><a href=https://lifailon.github.io/powershell/#system-io-file>System.IO.File</a><li><a href=https://lifailon.github.io/powershell/#read-write-bytes>Read/Write Bytes</a></ul><li><a href=https://lifailon.github.io/powershell/#archive>Archive</a><ul><li><a href=https://lifailon.github.io/powershell/#microsoft-powershell-archive>Microsoft.PowerShell.Archive</a><li><a href=https://lifailon.github.io/powershell/#system-io-compression-filesystem>System.IO.Compression.FileSystem</a><li><a href=https://lifailon.github.io/powershell/#winrar>WinRAR</a></ul><li><a href=https://lifailon.github.io/powershell/#file-descriptor>File descriptor</a><li><a href=https://lifailon.github.io/powershell/#console-menu>Console-Menu</a><li><a href=https://lifailon.github.io/powershell/#credential>Credential</a><ul><li><a href=https://lifailon.github.io/powershell/#out-gridview>Out-Gridview</a><li><a href=https://lifailon.github.io/powershell/#out-file>Out-File</a><li><a href=https://lifailon.github.io/powershell/#get-content-gc-cat-type>Get-Content (gc/cat/type)</a><li><a href=https://lifailon.github.io/powershell/#aes-key>AES Key</a></ul><li><a href=https://lifailon.github.io/powershell/#winevent>WinEvent</a><ul><li><a href=https://lifailon.github.io/powershell/#filter-xpath-hashtable>Filter XPath/Hashtable</a><li><a href=https://lifailon.github.io/powershell/#reboot>Reboot</a><li><a href=https://lifailon.github.io/powershell/#logon>Logon</a><li><a href=https://lifailon.github.io/powershell/#eventlog>EventLog</a></ul><li><a href=https://lifailon.github.io/powershell/#firewall>Firewall</a><ul><li><a href=https://lifailon.github.io/powershell/#firewall-manager>Firewall-Manager</a></ul><li><a href=https://lifailon.github.io/powershell/#defender>Defender</a><li><a href=https://lifailon.github.io/powershell/#dism>DISM</a><li><a href=https://lifailon.github.io/powershell/#scheduled>Scheduled</a><li><a href=https://lifailon.github.io/powershell/#network>Network</a><ul><li><a href=https://lifailon.github.io/powershell/#ping>ping</a><li><a href=https://lifailon.github.io/powershell/#dhcp>dhcp</a><li><a href=https://lifailon.github.io/powershell/#port>port</a><li><a href=https://lifailon.github.io/powershell/#netstat>netstat</a><li><a href=https://lifailon.github.io/powershell/#nslookup>nslookup</a><li><a href=https://lifailon.github.io/powershell/#ipconfig>ipconfig</a><li><a href=https://lifailon.github.io/powershell/#adapter>Adapter</a><li><a href=https://lifailon.github.io/powershell/#dnsclient>DNSClient</a><li><a href=https://lifailon.github.io/powershell/#dnscache>DNSCache</a><li><a href=https://lifailon.github.io/powershell/#binding>Binding</a><li><a href=https://lifailon.github.io/powershell/#tcpsetting>TCPSetting</a><li><a href=https://lifailon.github.io/powershell/#hostname>hostname</a><li><a href=https://lifailon.github.io/powershell/#arp>arp</a><li><a href=https://lifailon.github.io/powershell/#network-adapter-statistics>Network Adapter Statistics</a><li><a href=https://lifailon.github.io/powershell/#speedtest>SpeedTest</a></ul><li><a href=https://lifailon.github.io/powershell/#iperf>iPerf</a><ul><li><a href=https://lifailon.github.io/powershell/#install>Install</a><li><a href=https://lifailon.github.io/powershell/#env-update-exec-path>Env-Update-Exec-Path</a><li><a href=https://lifailon.github.io/powershell/#iperf-gui>iPerf-GUI</a><li><a href=https://lifailon.github.io/powershell/#iperf-docker>iPerf-Docker</a><li><a href=https://lifailon.github.io/powershell/#server>Server</a><li><a href=https://lifailon.github.io/powershell/#client>Client</a><li><a href=https://lifailon.github.io/powershell/#output>Output</a><li><a href=https://lifailon.github.io/powershell/#ps-iperf>PS-iPerf</a></ul><li><a href=https://lifailon.github.io/powershell/#rdp>RDP</a><ul><li><a href=https://lifailon.github.io/powershell/#ipban>IPBan</a></ul><li><a href=https://lifailon.github.io/powershell/#shutdown>shutdown</a><li><a href=https://lifailon.github.io/powershell/#localaccounts>LocalAccounts</a><li><a href=https://lifailon.github.io/powershell/#smb>SMB</a><ul><li><a href=https://lifailon.github.io/powershell/#get-acl>Get-Acl</a><li><a href=https://lifailon.github.io/powershell/#ntfssecurity>NTFSSecurity</a><li><a href=https://lifailon.github.io/powershell/#storage>Storage</a><li><a href=https://lifailon.github.io/powershell/#iscsi>iSCSI</a></ul><li><a href=https://lifailon.github.io/powershell/#wsus>WSUS</a><ul><li><a href=https://lifailon.github.io/powershell/#windowsupdate>WindowsUpdate</a><li><a href=https://lifailon.github.io/powershell/#pswindowsupdate>PSWindowsUpdate</a><li><a href=https://lifailon.github.io/powershell/#updateservices>UpdateServices</a><li><a href=https://lifailon.github.io/powershell/#poshwsus>PoshWSUS</a></ul><li><a href=https://lifailon.github.io/powershell/#activedirectory>ActiveDirectory</a><ul><li><a href=https://lifailon.github.io/powershell/#rsat>RSAT</a><li><a href=https://lifailon.github.io/powershell/#import-module-ad>Import-Module AD</a><li><a href=https://lifailon.github.io/powershell/#adsi>ADSI</a><li><a href=https://lifailon.github.io/powershell/#ldap>LDAP</a><li><a href=https://lifailon.github.io/powershell/#laps>LAPS</a><li><a href=https://lifailon.github.io/powershell/#recycle-bin>Recycle Bin</a><li><a href=https://lifailon.github.io/powershell/#thumbnailphoto>thumbnailPhoto</a><li><a href=https://lifailon.github.io/powershell/#addomaincontroller>ADDomainController</a><li><a href=https://lifailon.github.io/powershell/#adcomputer>ADComputer</a><li><a href=https://lifailon.github.io/powershell/#aduser>ADUser</a><li><a href=https://lifailon.github.io/powershell/#adgroupmember>ADGroupMember</a><li><a href=https://lifailon.github.io/powershell/#adreplication>ADReplication</a></ul><li><a href=https://lifailon.github.io/powershell/#repadmin>repadmin</a><li><a href=https://lifailon.github.io/powershell/#dcdiag>dcdiag</a><li><a href=https://lifailon.github.io/powershell/#ntdsutil>ntdsutil</a><li><a href=https://lifailon.github.io/powershell/#gpo>GPO</a><li><a href=https://lifailon.github.io/powershell/#servermanager>ServerManager</a><ul><li><a href=https://lifailon.github.io/powershell/#pswa>PSWA</a><li><a href=https://lifailon.github.io/powershell/#wsb-windows-server-backup>WSB (Windows Server Backup)</a><li><a href=https://lifailon.github.io/powershell/#rds>RDS</a></ul><li><a href=https://lifailon.github.io/powershell/#dnsserver>DNSServer</a><li><a href=https://lifailon.github.io/powershell/#dhcpserver>DHCPServer</a><li><a href=https://lifailon.github.io/powershell/#dfs>DFS</a><li><a href=https://lifailon.github.io/powershell/#storagereplica>StorageReplica</a><li><a href=https://lifailon.github.io/powershell/#ps2exe>PS2EXE</a><li><a href=https://lifailon.github.io/powershell/#nssm>NSSM</a><li><a href=https://lifailon.github.io/powershell/#jobs>Jobs</a><ul><li><a href=https://lifailon.github.io/powershell/#threadjob>ThreadJob</a><li><a href=https://lifailon.github.io/powershell/#poshrsjob>PoshRSJob</a><li><a href=https://lifailon.github.io/powershell/#invoke-parallel>Invoke-Parallel</a><li><a href=https://lifailon.github.io/powershell/#foreach-object-parallel>ForEach-Object-Parallel</a></ul><li><a href=https://lifailon.github.io/powershell/#smtp>SMTP</a><ul><li><a href=https://lifailon.github.io/powershell/#net-mail>Net.Mail</a><li><a href=https://lifailon.github.io/powershell/#smtp-over-openssl>SMTP over OpenSSL</a><li><a href=https://lifailon.github.io/powershell/#swaks>Swaks</a></ul><li><a href=https://lifailon.github.io/powershell/#vmware-powercli>VMWare/PowerCLI</a><li><a href=https://lifailon.github.io/powershell/#hyper-v>Hyper-V</a><ul><li><a href=https://lifailon.github.io/powershell/#vmconnect-via-rdcman>VMConnect via RDCMan</a></ul><li><a href=https://lifailon.github.io/powershell/#azure>Azure</a><ul><li><a href=https://lifailon.github.io/powershell/#manage-vm>Manage-VM</a><li><a href=https://lifailon.github.io/powershell/#manage-disk>Manage-Disk</a></ul><li><a href=https://lifailon.github.io/powershell/#exchange-emshell>Exchange/EMShell</a><ul><li><a href=https://lifailon.github.io/powershell/#roles>Roles</a><li><a href=https://lifailon.github.io/powershell/#messagetrackinglog>MessageTrackingLog</a><li><a href=https://lifailon.github.io/powershell/#mailbox>Mailbox</a><li><a href=https://lifailon.github.io/powershell/#moverequest>MoveRequest</a><li><a href=https://lifailon.github.io/powershell/#archive-1>Archive</a><li><a href=https://lifailon.github.io/powershell/#quota>Quota</a><li><a href=https://lifailon.github.io/powershell/#database>Database</a><li><a href=https://lifailon.github.io/powershell/#mailboxrepairrequest>MailboxRepairRequest</a><li><a href=https://lifailon.github.io/powershell/#eseutil>eseutil</a><li><a href=https://lifailon.github.io/powershell/#dial-tone-recovery>Dial Tone Recovery</a><li><a href=https://lifailon.github.io/powershell/#recovery-database-rdb>Recovery database (RDB)</a><li><a href=https://lifailon.github.io/powershell/#transport>Transport</a><li><a href=https://lifailon.github.io/powershell/#connector>Connector</a><li><a href=https://lifailon.github.io/powershell/#pst>PST</a><li><a href=https://lifailon.github.io/powershell/#distributiongroup>DistributionGroup</a><li><a href=https://lifailon.github.io/powershell/#search>Search</a><li><a href=https://lifailon.github.io/powershell/#auditlog>AuditLog</a><li><a href=https://lifailon.github.io/powershell/#test>Test</a><li><a href=https://lifailon.github.io/powershell/#queue>Queue</a><li><a href=https://lifailon.github.io/powershell/#defrag>Defrag</a><li><a href=https://lifailon.github.io/powershell/#dag>DAG</a><li><a href=https://lifailon.github.io/powershell/#index-1>Index</a></ul><li><a href=https://lifailon.github.io/powershell/#nas>NAS</a><ul><li><a href=https://lifailon.github.io/powershell/#truenas>TrueNAS</a><li><a href=https://lifailon.github.io/powershell/#synology>Synology</a></ul><li><a href=https://lifailon.github.io/powershell/#veeam>Veeam</a><ul><li><a href=https://lifailon.github.io/powershell/#get-vbrcommand>Get-VBRCommand</a><li><a href=https://lifailon.github.io/powershell/#veeam-restat>Veeam-REStat</a></ul><li><a href=https://lifailon.github.io/powershell/#rest-api>REST API</a><ul><li><a href=https://lifailon.github.io/powershell/#methods>Methods</a><li><a href=https://lifailon.github.io/powershell/#download-image>Download Image</a><li><a href=https://lifailon.github.io/powershell/#token>Token</a><li><a href=https://lifailon.github.io/powershell/#get>GET</a><li><a href=https://lifailon.github.io/powershell/#cookie>Cookie</a></ul><li><a href=https://lifailon.github.io/powershell/#pode>Pode</a><li><a href=https://lifailon.github.io/powershell/#selenium>Selenium</a><ul><li><a href=https://lifailon.github.io/powershell/#selenium-modules>Selenium modules</a></ul><li><a href=https://lifailon.github.io/powershell/#ie>IE</a><li><a href=https://lifailon.github.io/powershell/#com>COM</a><ul><li><a href=https://lifailon.github.io/powershell/#wscript-shell-sendkeys>Wscript.Shell.SendKeys</a><li><a href=https://lifailon.github.io/powershell/#wscript-shell-popup>Wscript.Shell.Popup</a><li><a href=https://lifailon.github.io/powershell/#wscript-network>WScript.Network</a><li><a href=https://lifailon.github.io/powershell/#shell-application>Shell.Application</a><li><a href=https://lifailon.github.io/powershell/#outlook>Outlook</a><li><a href=https://lifailon.github.io/powershell/#microsoft-update>Microsoft.Update</a></ul><li><a href=https://lifailon.github.io/powershell/#net>.NET</a><ul><li><a href=https://lifailon.github.io/powershell/#match>Match</a><li><a href=https://lifailon.github.io/powershell/#generatepassword>GeneratePassword</a><li><a href=https://lifailon.github.io/powershell/#soundplayer>SoundPlayer</a><li><a href=https://lifailon.github.io/powershell/#static-class>Static Class</a><li><a href=https://lifailon.github.io/powershell/#clicker>Clicker</a><li><a href=https://lifailon.github.io/powershell/#audio>Audio</a><li><a href=https://lifailon.github.io/powershell/#netsessionenum>NetSessionEnum</a><li><a href=https://lifailon.github.io/powershell/#copyfile>CopyFile</a><li><a href=https://lifailon.github.io/powershell/#showwindowasync>ShowWindowAsync</a><li><a href=https://lifailon.github.io/powershell/#getasynckeystate>GetAsyncKeyState</a></ul><li><a href=https://lifailon.github.io/powershell/#console-api>Console API</a><li><a href=https://lifailon.github.io/powershell/#drawing>Drawing</a><li><a href=https://lifailon.github.io/powershell/#objectevent>ObjectEvent</a><li><a href=https://lifailon.github.io/powershell/#sockets>Sockets</a><ul><li><a href=https://lifailon.github.io/powershell/#udp-socket>UDP-Socket</a><li><a href=https://lifailon.github.io/powershell/#test-netudpconnection>Test-NetUDPConnection</a><li><a href=https://lifailon.github.io/powershell/#tcp-socket>TCP-Socket</a><li><a href=https://lifailon.github.io/powershell/#wakeonlan>WakeOnLan</a><li><a href=https://lifailon.github.io/powershell/#httplistener>HTTPListener</a><li><a href=https://lifailon.github.io/powershell/#webclient>WebClient</a><li><a href=https://lifailon.github.io/powershell/#httpclient>HttpClient</a><li><a href=https://lifailon.github.io/powershell/#certificate>Certificate</a></ul><li><a href=https://lifailon.github.io/powershell/#base64>Base64</a><ul><li><a href=https://lifailon.github.io/powershell/#utf8>UTF8</a><li><a href=https://lifailon.github.io/powershell/#unicode>Unicode</a><li><a href=https://lifailon.github.io/powershell/#image>Image</a></ul><li><a href=https://lifailon.github.io/powershell/#excel>Excel</a><ul><li><a href=https://lifailon.github.io/powershell/#excel-application-open>Excel.Application.Open</a><li><a href=https://lifailon.github.io/powershell/#importexcel>ImportExcel</a></ul><li><a href=https://lifailon.github.io/powershell/#csv>CSV</a><ul><li><a href=https://lifailon.github.io/powershell/#convertfrom-string>ConvertFrom-String</a><li><a href=https://lifailon.github.io/powershell/#convertfrom-stringdata>ConvertFrom-StringData</a></ul><li><a href=https://lifailon.github.io/powershell/#xml>XML</a><ul><li><a href=https://lifailon.github.io/powershell/#get-credtoxml>Get-CredToXML</a><li><a href=https://lifailon.github.io/powershell/#xmlwriter>XmlWriter</a><li><a href=https://lifailon.github.io/powershell/#createelement>CreateElement</a></ul><li><a href=https://lifailon.github.io/powershell/#json>JSON</a><li><a href=https://lifailon.github.io/powershell/#yaml>YAML</a><li><a href=https://lifailon.github.io/powershell/#toml>TOML</a><li><a href=https://lifailon.github.io/powershell/#markdown>Markdown</a><ul><li><a href=https://lifailon.github.io/powershell/#convert-markdown-to-html>Convert Markdown to HTML</a><li><a href=https://lifailon.github.io/powershell/#psmarkdown>PSMarkdown</a><li><a href=https://lifailon.github.io/powershell/#convertfrom-markdownv2>ConvertFrom-MarkdownV2</a></ul><li><a href=https://lifailon.github.io/powershell/#convertto-markdown>ConvertTo-Markdown</a><li><a href=https://lifailon.github.io/powershell/#html>HTML</a><ul><li><a href=https://lifailon.github.io/powershell/#convertfrom-html>ConvertFrom-Html</a><li><a href=https://lifailon.github.io/powershell/#convertto-html>ConvertTo-Html</a><li><a href=https://lifailon.github.io/powershell/#pswritehtml>PSWriteHTML</a><li><a href=https://lifailon.github.io/powershell/#htmlreport>HtmlReport</a></ul><li><a href=https://lifailon.github.io/powershell/#htmlagilitypack>HtmlAgilityPack</a><li><a href=https://lifailon.github.io/powershell/#keepass>KeePass</a><li><a href=https://lifailon.github.io/powershell/#sqlite>SQLite</a><ul><li><a href=https://lifailon.github.io/powershell/#database-password>Database password</a></ul><li><a href=https://lifailon.github.io/powershell/#mysql>MySQL</a><ul><li><a href=https://lifailon.github.io/powershell/#data-type>DATA TYPE</a><li><a href=https://lifailon.github.io/powershell/#database-1>DATABASE</a><li><a href=https://lifailon.github.io/powershell/#user>USER</a><li><a href=https://lifailon.github.io/powershell/#table>TABLE</a><li><a href=https://lifailon.github.io/powershell/#column>COLUMN</a><li><a href=https://lifailon.github.io/powershell/#insert>INSERT</a><li><a href=https://lifailon.github.io/powershell/#select>SELECT</a><li><a href=https://lifailon.github.io/powershell/#where>WHERE</a><li><a href=https://lifailon.github.io/powershell/#delete>DELETE</a><li><a href=https://lifailon.github.io/powershell/#update>UPDATE</a><li><a href=https://lifailon.github.io/powershell/#check>CHECK</a><li><a href=https://lifailon.github.io/powershell/#dump>DUMP</a><li><a href=https://lifailon.github.io/powershell/#innodb-force-recovery>innodb_force_recovery</a><li><a href=https://lifailon.github.io/powershell/#mysql-connector-net>MySQL Connector NET</a><li><a href=https://lifailon.github.io/powershell/#add-aduser>Add-ADUser</a><li><a href=https://lifailon.github.io/powershell/#get-aduser>Get-ADUser</a></ul><li><a href=https://lifailon.github.io/powershell/#mssql>MSSQL</a><ul><li><a href=https://lifailon.github.io/powershell/#system-data-sqlclient>System.Data.SqlClient</a><li><a href=https://lifailon.github.io/powershell/#sqlclient-insert>SqlClient INSERT</a><li><a href=https://lifailon.github.io/powershell/#ssms-insert>SSMS INSERT</a><li><a href=https://lifailon.github.io/powershell/#t-sql>T-SQL</a><li><a href=https://lifailon.github.io/powershell/#tip-rezervnoi-kopii>Тип резервной копии</a><li><a href=https://lifailon.github.io/powershell/#modeli-vosstanovleniia>Модели восстановления</a><li><a href=https://lifailon.github.io/powershell/#sistemnye-bd>Системные БД</a><li><a href=https://lifailon.github.io/powershell/#reglamentnye-operatsii>Регламентные операции</a></ul><li><a href=https://lifailon.github.io/powershell/#influxdb>InfluxDB</a><ul><li><a href=https://lifailon.github.io/powershell/#install-windows>Install Windows</a><li><a href=https://lifailon.github.io/powershell/#install-ubuntu>Install Ubuntu</a><li><a href=https://lifailon.github.io/powershell/#api>API</a><li><a href=https://lifailon.github.io/powershell/#chronograf>Chronograf</a><li><a href=https://lifailon.github.io/powershell/#grafana>Grafana</a><li><a href=https://lifailon.github.io/powershell/#cli-client>CLI Client</a><li><a href=https://lifailon.github.io/powershell/#users>USERS</a><li><a href=https://lifailon.github.io/powershell/#database-2>DATABASE</a><li><a href=https://lifailon.github.io/powershell/#measurement>MEASUREMENT</a><li><a href=https://lifailon.github.io/powershell/#select-where>SELECT/WHERE</a><li><a href=https://lifailon.github.io/powershell/#regex-1>REGEX</a><li><a href=https://lifailon.github.io/powershell/#group-by-tag-key>GROUP BY tag_key</a><li><a href=https://lifailon.github.io/powershell/#functions-field-key>Functions(field_key)</a><li><a href=https://lifailon.github.io/powershell/#policy>POLICY</a></ul><li><a href=https://lifailon.github.io/powershell/#influxdb-api>InfluxDB-api</a><ul><li><a href=https://lifailon.github.io/powershell/#api-post>API POST</a><li><a href=https://lifailon.github.io/powershell/#api-get>API GET</a><li><a href=https://lifailon.github.io/powershell/#endpoints>Endpoints</a><li><a href=https://lifailon.github.io/powershell/#pingto-influxdb>PingTo-InfluxDB</a><li><a href=https://lifailon.github.io/powershell/#performanceto-influxdb>PerformanceTo-InfluxDB</a><li><a href=https://lifailon.github.io/powershell/#service>Service</a><li><a href=https://lifailon.github.io/powershell/#psinfluxdb>PSInfluxDB</a></ul><li><a href=https://lifailon.github.io/powershell/#telegraf>Telegraf</a><li><a href=https://lifailon.github.io/powershell/#elasticsearch>Elasticsearch</a><li><a href=https://lifailon.github.io/powershell/#cdata>CData</a><ul><li><a href=https://lifailon.github.io/powershell/#ado-net-assembly>ADO.NET Assembly</a><li><a href=https://lifailon.github.io/powershell/#update-1>UPDATE</a><li><a href=https://lifailon.github.io/powershell/#insert-1>INSERT</a><li><a href=https://lifailon.github.io/powershell/#delete-1>DELETE</a></ul><li><a href=https://lifailon.github.io/powershell/#odbc>ODBC</a><li><a href=https://lifailon.github.io/powershell/#postgresql>PostgreSQL</a><ul><li><a href=https://lifailon.github.io/powershell/#odbc-driver>ODBC Driver</a><li><a href=https://lifailon.github.io/powershell/#npgsql>npgsql</a></ul><li><a href=https://lifailon.github.io/powershell/#wmi>WMI</a><ul><li><a href=https://lifailon.github.io/powershell/#wmi-cim>WMI/CIM</a><li><a href=https://lifailon.github.io/powershell/#nla>NLA</a></ul><li><a href=https://lifailon.github.io/powershell/#regedit>Regedit</a><li><a href=https://lifailon.github.io/powershell/#performance>Performance</a><li><a href=https://lifailon.github.io/powershell/#snmp>SNMP</a><ul><li><a href=https://lifailon.github.io/powershell/#setup-snmp-service>Setup SNMP Service</a><li><a href=https://lifailon.github.io/powershell/#setting-snmp-service-via-regedit>Setting SNMP Service via Regedit</a><li><a href=https://lifailon.github.io/powershell/#snmpwalk>snmpwalk</a><li><a href=https://lifailon.github.io/powershell/#snmp-modules>SNMP Modules</a><li><a href=https://lifailon.github.io/powershell/#lextm-sharpsnmplib>Lextm.SharpSnmpLib</a><li><a href=https://lifailon.github.io/powershell/#walk>Walk</a></ul><li><a href=https://lifailon.github.io/powershell/#zabbix>Zabbix</a><ul><li><a href=https://lifailon.github.io/powershell/#zabbix-agent>Zabbix Agent</a><li><a href=https://lifailon.github.io/powershell/#zabbix-sender>Zabbix Sender</a><li><a href=https://lifailon.github.io/powershell/#zabbix-get>Zabbix Get</a><li><a href=https://lifailon.github.io/powershell/#userparameter>UserParameter</a><li><a href=https://lifailon.github.io/powershell/#include-plugins>Include Plugins</a><li><a href=https://lifailon.github.io/powershell/#zabbix-api>Zabbix API</a></ul><li><a href=https://lifailon.github.io/powershell/#pki>pki</a><li><a href=https://lifailon.github.io/powershell/#openssl>OpenSSL</a><li><a href=https://lifailon.github.io/powershell/#openvpn>OpenVPN</a><ul><li><a href=https://lifailon.github.io/powershell/#server-ovpn>server.ovpn</a><li><a href=https://lifailon.github.io/powershell/#client-ovpn>client.ovpn</a><li><a href=https://lifailon.github.io/powershell/#client-1>Client</a></ul><li><a href=https://lifailon.github.io/powershell/#route>Route</a><li><a href=https://lifailon.github.io/powershell/#nat>NAT</a><li><a href=https://lifailon.github.io/powershell/#wireguard>WireGuard</a><li><a href=https://lifailon.github.io/powershell/#vpnclient>VpnClient</a><li><a href=https://lifailon.github.io/powershell/#proxyclient>ProxyClient</a><li><a href=https://lifailon.github.io/powershell/#netsh>netsh</a><ul><li><a href=https://lifailon.github.io/powershell/#reverse-proxy>Reverse Proxy</a><li><a href=https://lifailon.github.io/powershell/#wlan>Wlan</a><li><a href=https://lifailon.github.io/powershell/#firewall-1>Firewall</a></ul><li><a href=https://lifailon.github.io/powershell/#openssh>OpenSSH</a><ul><li><a href=https://lifailon.github.io/powershell/#psremoting-over-ssh>PSRemoting over SSH</a></ul><li><a href=https://lifailon.github.io/powershell/#winrm>WinRM</a><ul><li><a href=https://lifailon.github.io/powershell/#winrm-configuration>WinRM Configuration</a><li><a href=https://lifailon.github.io/powershell/#kerberos>Kerberos</a></ul><li><a href=https://lifailon.github.io/powershell/#packagemanagement>PackageManagement</a><ul><li><a href=https://lifailon.github.io/powershell/#winget>winget</a><li><a href=https://lifailon.github.io/powershell/#jqlang>jqlang</a><li><a href=https://lifailon.github.io/powershell/#scoop>Scoop</a><li><a href=https://lifailon.github.io/powershell/#chocolatey>Chocolatey</a></ul><li><a href=https://lifailon.github.io/powershell/#nuget>NuGet</a><li><a href=https://lifailon.github.io/powershell/#modules>Modules</a><ul><li><a href=https://lifailon.github.io/powershell/#get-query>Get-Query</a><li><a href=https://lifailon.github.io/powershell/#console-translate>Console-Translate</a><li><a href=https://lifailon.github.io/powershell/#console-download>Console-Download</a><li><a href=https://lifailon.github.io/powershell/#pseverything>PSEverything</a><li><a href=https://lifailon.github.io/powershell/#hardwaremonitor>HardwareMonitor</a><li><a href=https://lifailon.github.io/powershell/#crystaldisk-cli>CrystalDisk-Cli</a><li><a href=https://lifailon.github.io/powershell/#ps-pi-hole>PS-Pi-Hole</a><li><a href=https://lifailon.github.io/powershell/#check-host>Check-Host</a><li><a href=https://lifailon.github.io/powershell/#psdomaintest>PSDomainTest</a><li><a href=https://lifailon.github.io/powershell/#winapi>WinAPI</a><li><a href=https://lifailon.github.io/powershell/#psyslog>pSyslog</a><li><a href=https://lifailon.github.io/powershell/#syslog-source-message>Syslog source message</a><li><a href=https://lifailon.github.io/powershell/#syslog-type-message>Syslog type message</a></ul><li><a href=https://lifailon.github.io/powershell/#atlassian>Atlassian</a><ul><li><a href=https://lifailon.github.io/powershell/#bitbucket>Bitbucket</a><li><a href=https://lifailon.github.io/powershell/#jira>Jira</a><li><a href=https://lifailon.github.io/powershell/#confluence>Confluence</a></ul><li><a href=https://lifailon.github.io/powershell/#pester>Pester</a><li><a href=https://lifailon.github.io/powershell/#dsc>DSC</a><li><a href=https://lifailon.github.io/powershell/#psappdeploytoolkit>PSAppDeployToolkit</a><ul><li><a href=https://lifailon.github.io/powershell/#install-deploytoolkit>Install-DeployToolkit</a><li><a href=https://lifailon.github.io/powershell/#deploy-notepad-plus-plus>Deploy-Notepad-Plus-Plus</a><li><a href=https://lifailon.github.io/powershell/#uninstall-notepad-plus-plus>Uninstall-Notepad-Plus-Plus</a><li><a href=https://lifailon.github.io/powershell/#deploy-winscp>Deploy-WinSCP</a></ul><li><a href=https://lifailon.github.io/powershell/#load-testing>Load Testing</a><ul><li><a href=https://lifailon.github.io/powershell/#apache-benchmark>Apache Benchmark</a><li><a href=https://lifailon.github.io/powershell/#locust>Locust</a></ul><li><a href=https://lifailon.github.io/powershell/#llm>LLM</a><li><a href=https://lifailon.github.io/powershell/#openai>OpenAI</a><li><a href=https://lifailon.github.io/powershell/#mock>Mock</a><li><a href=https://lifailon.github.io/powershell/#openrouter>OpenRouter</a><li><a href=https://lifailon.github.io/powershell/#lm-studio>LM Studio</a><li><a href=https://lifailon.github.io/powershell/#ollama>Ollama</a><li><a href=https://lifailon.github.io/powershell/#gigachat>GigaChat</a><ul><li><a href=https://lifailon.github.io/powershell/#windows>Windows</a><li><a href=https://lifailon.github.io/powershell/#linux>Linux</a></ul><li><a href=https://lifailon.github.io/powershell/#yandexgpt>YandexGPT</a><li><a href=https://lifailon.github.io/powershell/#superagi>SuperAGI</a><li><a href=https://lifailon.github.io/powershell/#replicate>Replicate</a><li><a href=https://lifailon.github.io/powershell/#google-api>Google API</a><ul><li><a href=https://lifailon.github.io/powershell/#google-translate>Google Translate</a><li><a href=https://lifailon.github.io/powershell/#google-search>Google Search</a><li><a href=https://lifailon.github.io/powershell/#google-search-via-rapidapi>Google Search via RapidAPI</a><li><a href=https://lifailon.github.io/powershell/#google-filter>Google Filter</a></ul><li><a href=https://lifailon.github.io/powershell/#media-api>Media API</a><li><a href=https://lifailon.github.io/powershell/#imdb>IMDb</a><li><a href=https://lifailon.github.io/powershell/#moviesdatabase>MoviesDatabase</a><li><a href=https://lifailon.github.io/powershell/#tmdb>TMDB</a><li><a href=https://lifailon.github.io/powershell/#omdb>OMDb</a><li><a href=https://lifailon.github.io/powershell/#ivi>ivi</a><li><a href=https://lifailon.github.io/powershell/#kinopoisk>Kinopoisk</a><ul><li><a href=https://lifailon.github.io/powershell/#kinopoisk-dev>kinopoisk.dev</a><li><a href=https://lifailon.github.io/powershell/#urlcode>UrlCode</a><li><a href=https://lifailon.github.io/powershell/#kinopoiskapiunofficial>KinopoiskApiUnofficial</a></ul><li><a href=https://lifailon.github.io/powershell/#kinobox>Kinobox</a><li><a href=https://lifailon.github.io/powershell/#videocdn>VideoCDN</a><li><a href=https://lifailon.github.io/powershell/#torrent>Torrent</a><ul><li><a href=https://lifailon.github.io/powershell/#jackett>Jackett</a><li><a href=https://lifailon.github.io/powershell/#torrent-api-py>Torrent-API-py</a><li><a href=https://lifailon.github.io/powershell/#plex>Plex</a><li><a href=https://lifailon.github.io/powershell/#jellyfin>Jellyfin</a></ul><li><a href=https://lifailon.github.io/powershell/#telegram>Telegram</a><ul><li><a href=https://lifailon.github.io/powershell/#button>Button</a><li><a href=https://lifailon.github.io/powershell/#send-totelegramfile>Send-ToTelegramFile</a></ul><li><a href=https://lifailon.github.io/powershell/#discord>Discord</a><ul><li><a href=https://lifailon.github.io/powershell/#send-to-discord>Send to Discord</a><li><a href=https://lifailon.github.io/powershell/#read-from-discord>Read from Discord</a><li><a href=https://lifailon.github.io/powershell/#httpclient-1>HttpClient</a><li><a href=https://lifailon.github.io/powershell/#button-1>Button</a><li><a href=https://lifailon.github.io/powershell/#discord-net-webhook>Discord.Net.Webhook</a><li><a href=https://lifailon.github.io/powershell/#discord-net-websocket>Discord.Net.WebSocket</a></ul><li><a href=https://lifailon.github.io/powershell/#oh-my-posh>oh-my-posh</a><ul><li><a href=https://lifailon.github.io/powershell/#themes-performance>themes-performance</a></ul><li><a href=https://lifailon.github.io/powershell/#windows-terminal>Windows-Terminal</a><ul><li><a href=https://lifailon.github.io/powershell/#terminal-icons>Terminal-Icons</a><li><a href=https://lifailon.github.io/powershell/#custom-actions>Custom Actions</a></ul><li><a href=https://lifailon.github.io/powershell/#pandoc>Pandoc</a><ul><li><a href=https://lifailon.github.io/powershell/#convert-excel-to-markdown>Convert Excel to Markdown</a></ul><li><a href=https://lifailon.github.io/powershell/#ffmpeg>FFmpeg</a><li><a href=https://lifailon.github.io/powershell/#handbrake>HandBrake</a><li><a href=https://lifailon.github.io/powershell/#imagemagick>ImageMagick</a><li><a href=https://lifailon.github.io/powershell/#youtube>YouTube</a></ul></div></div><main id=main-content><div id=buttons-container><a title="Go to Top" href=#top id=go-to-top><i class=icon></i></a></div><h1>PowerShell</h1><p align=center><a href=https://github.com/Lifailon/PS-Commands><img title="PS-Commands Logo" src=logo.png></a><p align=center>Большая база заметок <b>PowerShell</b> на русском языке.<hr><h2 id=cheat-sheet><a aria-label="Anchor link for: cheat-sheet" class=zola-anchor href=#cheat-sheet><i class=icon></i></a> Cheat-Sheet</h2><p><img alt="Image alt" src=https://lifailon.github.io/powershell/Cheat-Sheet/PowerShell-Cheat-Sheet-RU.jpg><h2 id=help><a aria-label="Anchor link for: help" class=zola-anchor href=#help><i class=icon></i></a> Help</h2><p><code>Get-Verb</code> действия/глаголы, утвержденные для использования в командлетах <br> <code>Get-Command *Language*</code> поиск команды по имени <br> <code>(Get-Command Get-Language).Module</code> узнать к какому модулю принадлежит команда <br> <code>Get-Command Get-Content | fl Module,DLL</code> узнать принадлежность команды к модулю и dll <br> <code>Get-Command -Module LanguagePackManagement</code> отобразить список команд указанного модуля <br> <code>(Get-Module LanguagePackManagement).ExportedCommands.Values</code> отобразить список команд указанного модуля <br> <code>Get-Language | Get-Member</code> отобразить список методов команды (действия), объекты вывода и Event (события объектов: Click) <br> <code>(Get-Help Get-Service).Aliases</code> узнать псевдонимом команды <br> <code>Get-Alias gsv</code> узнать имя команды по псевдониму <br> <code>Get-Help Get-Service</code> синтаксис <br> <code>Get-Help Get-Service -Parameter *</code> описание всех параметров <br> <code>Get-Help Get-Service -Online</code> <br> <code>Get-Help Get-Service -ShowWindow</code> описание параметров в GUI с фильтрацией <br> <code>Show-Command</code> вывести список команд в GUI <br> <code>Show-Command Get-Service</code> список параметров команды в GUI <br> <code>Invoke-Expression</code> iex принимает текст для выполнения в консоли как команды <br> <code>$PSVersionTable</code> текущая версия PowerShell <br> <code>Set-ExecutionPolicy Unrestricted</code> <br> <code>Get-ExecutionPolicy</code> <br> <code>$Metadata = New-Object System.Management.Automation.CommandMetaData (Get-Command Get-Service)</code> получить информацию о командлете <br> <code>[System.Management.Automation.ProxyCommand]::Create($Metadata)</code> исходный код функции<h2 id=object><a aria-label="Anchor link for: object" class=zola-anchor href=#object><i class=icon></i></a> Object</h2><h3 id=variable><a aria-label="Anchor link for: variable" class=zola-anchor href=#variable><i class=icon></i></a> Variable</h3><p><code>$var = Read-Host "Enter"</code> ручной ввод <br> <code>$pass = Read-Host "Enter Password" -AsSecureString</code> скрывать набор <br> <code>$global:path = "\\path"</code> задать глобальную переменную, например в функции <br> <code>$using:srv</code> использовать переменную текущей сесси в Invoke-сессии <br> <code>Get-Variable</code> отобразить все переменные <br> <code>ls variable:/</code> отобразить все переменные <br> <code>Get-Variable *srv*</code> найти переменную по имени <br> <code>Get-Variable -Scope Global</code> отобразить все глобальные переменные <br> <code>Get-Variable Error</code> последняя команда с ошибкой <br> <code>Remove-Variable -Name *</code> очистить все переменные <br> <code>$LASTEXITCODE</code> содержит код вывода последней запущенной программы, например ping. Если код возврата положительный (True), то $LastExitCode = 0<h3 id=env><a aria-label="Anchor link for: env" class=zola-anchor href=#env><i class=icon></i></a> ENV</h3><p><code>Get-ChildItem Env:</code> отобразить все переменные окружения <br> <code>$env:PSModulePath</code> директории импорта модулей <br> <code>$env:userprofile</code> <br> <code>$env:computername</code> <br> <code>$env:username</code> <br> <code>$env:userdnsdomain</code> <br> <code>$env:logonserver</code> <br> <code>([DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()).Name</code> <br> <code>[Environment]::GetFolderPath('ApplicationData')</code><h3 id=history><a aria-label="Anchor link for: history" class=zola-anchor href=#history><i class=icon></i></a> History</h3><p><code>Get-History</code> история команд текущей сессии <br> <code>(Get-History)[-1].Duration.TotalSeconds</code> время выполнения последней команды <br> <code>(Get-PSReadLineOption).HistorySavePath</code> путь к сохраненному файлу с 4096 последних команд (из модуля PSReadLine) <br> <code>Get-Content (Get-PSReadlineOption).HistorySavePath | Select-String Get</code> поиск по содержимому файла (GREP) <br> <code>Set-PSReadlineOption -MaximumHistoryCount 10000</code> изменить количество сохраняемых команд в файл <br> <code>Get-PSReadLineOption | select MaximumHistoryCount</code> <br> <code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code> отключить ведение журнала <br> <code>F2</code> переключиться с InlineView на ListView<h3 id=clipboard><a aria-label="Anchor link for: clipboard" class=zola-anchor href=#clipboard><i class=icon></i></a> Clipboard</h3><p><code>Set-Clipboard $srv</code> скопировать в буфер обмена <br> <code>Get-Clipboard</code> вставить<h3 id=write-host><a aria-label="Anchor link for: write-host" class=zola-anchor href=#write-host><i class=icon></i></a> Write-Host</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>BackgroundColor Green <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test:<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoNewline <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> изменить цвет фона и запретить перенос строки<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span> True<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ForegroundColor Green <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> данная строка будет печататься продолжая предыдущую с новыми параметрами цвета (фон по умолчанию, изменяем цвет текста)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><p><code>Write-Error "False"</code> <br> <code>Write-Warning "False"</code><h3 id=write-progress><a aria-label="Anchor link for: write-progress" class=zola-anchor href=#write-progress><i class=icon></i></a> Write-Progress</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">100</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Progress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Activity <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test Progress<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PercentComplete <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Milliseconds <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=for><a aria-label="Anchor link for: for" class=zola-anchor href=#for><i class=icon></i></a> for</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">for</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>i</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>i</span> <span class="z-keyword z-operator z-comparison z-powershell">-le</span> <span class="z-constant z-numeric z-integer z-powershell">100</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>i</span><span class="z-keyword z-operator z-assignment z-powershell">+=</span><span class="z-constant z-numeric z-integer z-powershell">10</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Progress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Activity <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test Progress<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PercentComplete <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>i</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Seconds <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=array><a aria-label="Anchor link for: array" class=zola-anchor href=#array><i class=icon></i></a> Array</h3><p><code>$srv = @("server-01", "server-02")</code> создать массив <br> <code>$srv += @("server-03")</code> добавить в массив новый элемент <br> <code>$srv.Count</code> отобразить кол-во элементов в массиве <br> <code>Out-String</code> построчный вывод<h3 id=index><a aria-label="Anchor link for: index" class=zola-anchor href=#index><i class=icon></i></a> Index</h3><p><code>$srv[0]</code> вывести первое значение элемента массива <br> <code>$srv[0] = Name</code> замена элемента в массиве <br> <code>$srv[0].Length</code> узнать кол-во символов первого значения в массиве <br> <code>$srv[10..100]</code> срез<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>a<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>b<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>c<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>d<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>num</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>a</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>num</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">array</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::IndexOf<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>a</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> узнать номер индекса по зачению<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>num</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> пересобрать исходный массив<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=hashtable><a aria-label="Anchor link for: hashtable" class=zola-anchor href=#hashtable><i class=icon></i></a> HashTable</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>hashtable</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создать (инициализировать)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>User<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>USERNAME</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Server<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>COMPUTERNAME</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>hashtable</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Добавить ключи<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Profile<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PROFILE</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>PowerShell_Home_Dir<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PSHOME</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>$hashtable.Keys</code> список всех ключей <br> <code>$hashtable["User"]</code> получить значение (Values) по ключу <br> <code>$hashtable["User"] = "Test"</code> изменить <br> <code>$hashtable.Remove("User")</code> удалить ключ<h3 id=collections-list><a aria-label="Anchor link for: collections-list" class=zola-anchor href=#collections-list><i class=icon></i></a> Collections/List</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Object</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">User</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>username</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Server</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>computername</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=pscustomobject><a aria-label="Anchor link for: pscustomobject" class=zola-anchor href=#pscustomobject><i class=icon></i></a> PSCustomObject</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CustomObject</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ordered</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">User</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>username</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Server</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>computername</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=add-and-remove-property><a aria-label="Anchor link for: add-and-remove-property" class=zola-anchor href=#add-and-remove-property><i class=icon></i></a> Add and Remove Property</h3><p><code>$CustomObject | Add-Member –MemberType NoteProperty –Name Arr –Value @(1,2,3)</code> добавить свойство/стобец <br> <code>$CustomObject.Arr = @(1,3,5)</code> изменить содержимое <br> <code>$CustomObject.PsObject.Properties.Remove('User')</code> удалить Property<h3 id=add-method><a aria-label="Anchor link for: add-method" class=zola-anchor href=#add-method><i class=icon></i></a> Add Method</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ScriptBlock</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Get-Service</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CustomObject</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Add-Member</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>TestMethod<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>MemberType ScriptMethod <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ScriptBlock</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CustomObject</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-Member</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CustomObject<span class="z-variable z-other z-member z-powershell">.TestMethod</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=class><a aria-label="Anchor link for: class" class=zola-anchor href=#class><i class=icon></i></a> Class</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-storage z-type z-powershell">Class</span> <span class="z-entity z-name z-function">CustomClass</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>User</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Server</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Start<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">bool</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Param1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">If</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Param1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Start Function<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>$Class = New-Object -TypeName CustomClass</code> <br> <code>$Class.User = $env:username</code> <br> <code>$Class.Server = $env:computername</code> <br> <code>$Class.Start(1)</code><h3 id=pipeline><a aria-label="Anchor link for: pipeline" class=zola-anchor href=#pipeline><i class=icon></i></a> Pipeline</h3><p><code>$CustomObject | Add-Member -MemberType NoteProperty -Name "Type" -Value "user" -Force</code> добавление объкта вывода NoteProperty <br> <code>$CustomObject | Add-Member -MemberType NoteProperty -Name "User" -Value "admin" -Force</code> изменеие содержимого для сущности объекта User <br> <code>ping $srv | Out-Null</code> перенаправить результат вывода в Out-Null<h3 id=select-object><a aria-label="Anchor link for: select-object" class=zola-anchor href=#select-object><i class=icon></i></a> Select-Object</h3><p><code>Get-Process | Select-Object -Property *</code> отобразить все доступные объекты вывода <br> <code>Get-Process | select -Unique "Name"</code> удалить повторяющиеся значения в массиве <br> <code>Get-Process | select -ExpandProperty ProcessName</code> преобразовать из объекта-коллекции в массив (вывести содержимое без наименовая столбца) <br> <code>(Get-Process | ? Name -match iperf).Modules</code> список используемых модулей процессом<h3 id=expression><a aria-label="Anchor link for: expression" class=zola-anchor href=#expression><i class=icon></i></a> Expression</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Sort-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Descending CPU <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>first <span class="z-constant z-numeric z-integer z-powershell">10</span> ProcessName<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> сортировка по CPU, вывести первых 10 значений (-first)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ProcessorTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.TotalProcessorTime</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d+$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> затрачено процессорного времени в минутах<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Memory<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.WS</span></span> <span class="z-keyword z-operator z-assignment z-powershell">/</span> <span class="z-constant z-numeric z-integer z-powershell">1024</span><span class="z-keyword z-other z-powershell">kb</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MB<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> делим байты на КБ (1mb)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Label</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>RunTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.StartTime</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d+$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> вычесть из текущего времени - время запуска, и удалить milisec<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=select-string><a aria-label="Anchor link for: select-string" class=zola-anchor href=#select-string><i class=icon></i></a> Select-String</h3><p><code>$(ipconfig | Select-String IPv4) -replace ".+: " | Where-Object {$_ -match "^172."}</code> узнать только IP <br> <code>$Current_IP = Get-Content $RDCMan_RDG_PATH | Select-String $RDCMan_Display_Name -Context 0,1</code> получить две строки <br> <code>$Current_IP = $Current_IP.Context.DisplayPostContext[0] -replace ".+&LTname>|<\/name>"</code> забрать только вторую строку и удалить тэги<h3 id=format-list-format-table><a aria-label="Anchor link for: format-list-format-table" class=zola-anchor href=#format-list-format-table><i class=icon></i></a> Format-List/Format-Table</h3><p><code>Get-Process | fl ProcessName, StartTime</code> <br> <code>Get-Process | ft ProcessName, StartTime -Autosize</code> автоматическая группировка размера столбцов<h3 id=measure-object><a aria-label="Anchor link for: measure-object" class=zola-anchor href=#measure-object><i class=icon></i></a> Measure-Object</h3><p><code>Get-Process | Measure | select Count</code> кол-во объектов <br> <code>Get-Process | Measure -Line -Word -Character</code> кол-во строк, слов и Char объектов <br> <code>Get-Process | Measure-Object PM -sum | Select-Object Count,@{Name="MEM_MB"; Expression={[int]($_.Sum/1mb)}}</code> кол-во процессов и общий объем занятой памяти в МБайт<h3 id=compare-object><a aria-label="Anchor link for: compare-object" class=zola-anchor href=#compare-object><i class=icon></i></a> Compare-Object</h3><p><code>Compare-Object -ReferenceObject (Get-Content -Path .\file1.txt) -DifferenceObject (Get-Content -Path .\file2.txt)</code> сравнение двух файлов <br> <code>$group1 = Get-ADGroupMember -Identity "Domain Admins"</code> <br> <code>$group2 = Get-ADGroupMember -Identity "Enterprise Admins"</code> <br> <code>Compare-Object -ReferenceObject $group1 -DifferenceObject $group2 -IncludeEqual</code> сравнение друх объектов <code>==</code> нет изменений <br> <code><=</code> есть изменения в $group1 <br> <code>=></code> есть изменения в $group2<h3 id=where-object><a aria-label="Anchor link for: where-object" class=zola-anchor href=#where-object><i class=icon></i></a> Where-Object (?)</h3><p><code>Get-Process | Where-Object {$_.ProcessName -match "zabbix"}</code> фильтрация/поиск процессов по имени свойства объекта <br> <code>Get-Process | where CPU -gt 10 | Sort-Object -Descending CPU</code> вывести объекты, где значения CPU больше 10 <br> <code>Get-Process | where WS -gt 200MB</code> отобразить процессы где WS выше 200МБ <br> <code>Get-Service | where Name -match "zabbix"</code> поиск службы <br> <code>Get-Service -ComputerName $srv | Where {$_.Name -match "WinRM"} | Restart-Service</code> перезапустить службу на удаленном компьютере <br> <code>(Get-Service).DisplayName</code> вывести значения свойства массива <br> <code>netstat -an | where {$_ -match 443}</code> <br> <code>netstat -an | ?{$_ -match 443}</code> <br> <code>(netstat -an) -match 443</code><h3 id=sort-object><a aria-label="Anchor link for: sort-object" class=zola-anchor href=#sort-object><i class=icon></i></a> Sort-Object</h3><p><code>Get-Process | Sort-Object -Descending CPU | ft</code> обратная (-Descending) сортировка по CPU <br> <code>Get-Process | Sort-Object -Descending cpu,ws</code> сортировка по двум свойствам <br> <code>$path[-1..-10]</code> обратная сборка массива без сортировки <br> <code>$arr = @(1..20); $arr[$($arr.Count - 1)..0]</code> пересобрать массив с конца<h3 id=last-first><a aria-label="Anchor link for: last-first" class=zola-anchor href=#last-first><i class=icon></i></a> Last/First</h3><p><code>Get-Process | Sort-Object -Descending CPU | select -First 10</code> вывести первых 10 объектов <br> <code>Get-Process | Sort-Object -Descending CPU | select -Last 10</code> вывести последних 10 объектов<h3 id=group-object><a aria-label="Anchor link for: group-object" class=zola-anchor href=#group-object><i class=icon></i></a> Group-Object</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Groups</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-CimInstance</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Class Win32_PnPSignedDriver <span class="z-keyword z-operator z-other z-powershell">|</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Select-Object</span> DriverProviderName<span class="z-keyword z-operator z-other z-powershell">,</span> FriendlyName<span class="z-keyword z-operator z-other z-powershell">,</span> Description<span class="z-keyword z-operator z-other z-powershell">,</span> DriverVersion<span class="z-keyword z-operator z-other z-powershell">,</span> DriverDate <span class="z-keyword z-operator z-other z-powershell">|</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Group-Object</span> DriverProviderName<span class="z-keyword z-operator z-other z-powershell">,</span> FriendlyName<span class="z-keyword z-operator z-other z-powershell">,</span> Description<span class="z-keyword z-operator z-other z-powershell">,</span> DriverVersion<span class="z-keyword z-operator z-other z-powershell">,</span> DriverDate
</span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Group</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Groups</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Group<span class="z-variable z-other z-member z-powershell">.Group</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Format-Table</span>
</span></code></pre><h3 id=property><a aria-label="Anchor link for: property" class=zola-anchor href=#property><i class=icon></i></a> Property</h3><p><code>$srv.Count</code> кол-во элементов в массиве <br> <code>$srv.Length</code> содержит количество символом строки переменной [string] или количество значений (строк) объекта <br> <code>$srv.Chars(2)</code> отобразить 3-й символ в строке <br> <code>$srv[2]</code> отобразить 3-ю строку в массиве<h3 id=method><a aria-label="Anchor link for: method" class=zola-anchor href=#method><i class=icon></i></a> Method</h3><p><code>$srv = "127.0.0.1"</code> <br> <code>$srv.Insert(0,"https://")</code> добавить значение перед первым символом <br> <code>$srv.Substring(4)</code> удалить (из всего массива) первые 4 символа <br> <code>$srv.Remove(3)</code> удалить из всего массива все после 3 символа <br> <code>$string = "123"</code> создать строку <br> <code>$int = [convert]::ToInt32($string)</code> преобразовать строку в тип данных число <br> <code>[string]::Concat($text,$num)</code> объеденить переменные в одну строку <br> <code>[string]::Join(":",$text,$num)</code> объеденить используя разделитель <br> <code>[string]::Compare($text,$num,$true)</code> выдает 0 при совпадении или 1/-1 при несовпадении, $true (без учета регистра) или $false (с учетом регистра) <br> <code>[string]::Equals($text,$num)</code> производит сравнение двух строк и выдает $true при их совпадении или $false при несовпадении <br> <code>[string]::IsNullOrEmpty($text)</code> проверяет наличие строки, если строка пуста $true, если нет $false <br> <code>[string]::IsNullOrWhiteSpace($text2)</code> проверяет на наличие только символов пробел, табуляция или символ новой строки<h2 id=error><a aria-label="Anchor link for: error" class=zola-anchor href=#error><i class=icon></i></a> Error</h2><p><code>$Error</code> выводит все ошибки текущего сеанса <br> <code>$Error[0].InvocationInfo</code> развернутый отчет об ошибке <br> <code>$Error.clear()</code> <br> <code>$LASTEXITCODE</code> результат выполнения последней команды (0 - успех) <br> <code>exit 1</code> код завершения, который возвращается $LASTEXITCODE<h3 id=executionstatus><a aria-label="Anchor link for: executionstatus" class=zola-anchor href=#executionstatus><i class=icon></i></a> ExecutionStatus</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-History</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>RunTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.EndExecutionTime</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.StartExecutionTime</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>ExecutionStatus<span class="z-keyword z-operator z-other z-powershell">,</span>CommandLine <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> посчитать время работы последней [-1] (или Select-Object -Last 1) выполненной команды и ее узнать статус<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h3 id=measure-command><a aria-label="Anchor link for: measure-command" class=zola-anchor href=#measure-command><i class=icon></i></a> Measure-Command</h3><p><code>$(Measure-Command {ping ya.ru}).TotalSeconds</code> получить время выполнения в секундах<h2 id=datetime><a aria-label="Anchor link for: datetime" class=zola-anchor href=#datetime><i class=icon></i></a> DateTime</h2><p><code>[DateTime]::UtcNow</code> время в формате UTC 0 <br> <code>$(Get-Date).AddHours(-3)</code> вычесть три часа из текущего времени <br> <code>$Date = $(Get-Date -Format "dd/MM/yyyy HH:mm:ss")</code> изменить формат отображения времени <br> <code>$Date = Get-Date -f "dd/MM/yyyy"</code> получаем тип данных [string] $($Date.GetType().Name) <br> <code>$Date = "19.05.2024"</code> <br> <code>[DateTime]$Date = Get-Date "$Date"</code> преобразовать строку подходящую под формат даты в тип данных [DateTime] <br> <code>$BeforeDate = Get-Date "12.05.2024"</code> <br> <code>[int32]$days=$($Date - $BeforeDate).Days</code> посчитать разницу в днях <br> <code>"5/7/07" -as [DateTime]</code> преобразовать входные данные в тип данных [DateTime]<h2 id=timespan><a aria-label="Anchor link for: timespan" class=zola-anchor href=#timespan><i class=icon></i></a> TimeSpan</h2><p><code>New-TimeSpan -Start $(Get-Date) -End $($(Get-Date).AddMinutes(+1))</code> получить разницу во времени <br> <code>$TimeZone = (Get-TimeZone).BaseUtcOffset.TotalMinutes</code> получить разницу в минутах от текущего часового пояса относительно UTC 0 <br> <code>$UnixTime  = (New-TimeSpan -Start (Get-Date "01/01/1970") -End ((Get-Date).AddMinutes(-$tz))).TotalSeconds</code> вычесть минуты для получения UTC 0 <br> <code>$TimeStamp = ([string]$UnixTime -replace "\..+") + "000000000"</code> получить текущий TimeStamp<h3 id=format><a aria-label="Anchor link for: format" class=zola-anchor href=#format><i class=icon></i></a> Format</h3><pre class=z-code><code><span class="z-text z-plain">HH   # Часы в 24-часовом формате (00 до 23)
</span><span class="z-text z-plain">hh   # Часы в 12-часовом формате (01 до 12)
</span><span class="z-text z-plain">mm   # Минуты (00 до 59)
</span><span class="z-text z-plain">ss   # Секунды (00 до 59)
</span><span class="z-text z-plain">tt   # Десигнатор (AM/PM)
</span><span class="z-text z-plain">fff  # Миллисекунды (000 до 999)
</span><span class="z-text z-plain">d    # День месяца без ведущего нуля (1-31)
</span><span class="z-text z-plain">dd   # День месяца с ведущим нулём (01-31)
</span><span class="z-text z-plain">ddd  # Сокращённое название дня недели (например, "Пн")
</span><span class="z-text z-plain">dddd # Полное название дня недели (например, "Понедельник")
</span><span class="z-text z-plain">M    # Номер месяца без ведущего нуля (1-12)
</span><span class="z-text z-plain">MM   # Номер месяца с ведущим нулём (01-12)
</span><span class="z-text z-plain">MMM  # Сокращённое название месяца (например, "Янв")
</span><span class="z-text z-plain">MMMM # Полное название месяца (например, "Январь")
</span><span class="z-text z-plain">y    # Год без века (0-99)
</span><span class="z-text z-plain">yy   # Год без века с ведущим нулём (00-99)
</span><span class="z-text z-plain">yyyy # Год с веком (например, 2024)
</span><span class="z-text z-plain">g    # Период или эра (например, "н.э.")
</span></code></pre><h3 id=timer><a aria-label="Anchor link for: timer" class=zola-anchor href=#timer><i class=icon></i></a> Timer</h3><p><code>$start_time = Get-Date</code> зафиксировать время до выполнения команды <br> <code>$end_time = Get-Date</code> зафиксировать время по завершению <br> <code>$time = $end_time - $start_time</code> высчитать время работы скрипта <br> <code>$min = $time.minutes</code> <br> <code>$sec = $time.seconds</code> <br> <code>Write-Host "$min минут $sec секунд"</code><p><code>$timer = [System.Diagnostics.Stopwatch]::StartNew()</code> запустить таймер <br> <code>$timer.IsRunning</code> статус работы таймера <br> <code>$timer.Elapsed.TotalSeconds</code> отобразить время с момента запуска (в секундах) <br> <code>$timer.Stop()</code> остановить таймер<h2 id=regex><a aria-label="Anchor link for: regex" class=zola-anchor href=#regex><i class=icon></i></a> Regex</h2><pre class=z-code><code><span class="z-text z-plain">.       # Обозначает любой символ, кроме новой строки
</span><span class="z-text z-plain">\       # Экранирует любой специальный символ (метасимвол). Используется, если нужно указать конкретный символ, вместо специального ({ } [ ] / \ + * . $ ^ | ?)
</span><span class="z-text z-plain">\A (^)  # Начало строки
</span><span class="z-text z-plain">\Z ($)  # Конец строки
</span><span class="z-text z-plain">\n      # Новая строка
</span><span class="z-text z-plain">\s      # Пробел (эквивалент " "), табуляция, перенос строки
</span><span class="z-text z-plain">\S      # Не пробел
</span><span class="z-text z-plain">\d      # Число от 0 до 9 (20-07-2022 эквивалент: "\d\d-\d\d-\d\d\d\d")
</span><span class="z-text z-plain">\D      # Обозначает любой символ, кроме числа (цифры). Удаления всех символов, кроме цифр: [int]$("123 test" -replace "\D")
</span><span class="z-text z-plain">\w      # Любая буква латиницы, цифра, или знак подчёркивания (от "a" до "z" и от "A" до "Z" или число от 0 до 9)
</span><span class="z-text z-plain">\W      # Не латиница, не цифра, не подчёркивание
</span><span class="z-text z-plain">\b      # Граница слова. Применяется когда нужно выделить, что искомые символы являются словом, а не частью другого слова
</span><span class="z-text z-plain">\B      # Не граница слова
</span><span class="z-text z-plain">\A      # Начало текста
</span><span class="z-text z-plain">\Z      # Конец текста
</span><span class="z-text z-plain">+       # Повторяется 1 и более раз (\s+)
</span><span class="z-text z-plain">|       # Или. Соединяет несколько вариантов
</span><span class="z-text z-plain">()      # В круглые скобки заключаются все комбинации с "или" и поиск начала и конца строк
</span><span class="z-text z-plain">[]      # поиск совпадения любой буквы, например, [A-z0-9] от A до z и цифры от 0 до 9 ("192.168.1.1" -match "192.1[6-7][0-9]")
</span><span class="z-text z-plain">[^ ]    # Исключает из поиска символы указанные в квадратных скобках
</span><span class="z-text z-plain">{ }     # Квантификатор в фигурных скобках, указывает количество повторений символа слева на право (от 1 до 25 раз)
</span><span class="z-text z-plain">\d{2}   # Найти две цифры
</span><span class="z-text z-plain">\d{2,4} # Найти две или четыре
</span><span class="z-text z-plain">{4,}    # Найти четыре и более
</span></code></pre><h3 id=iakori><a aria-label="Anchor link for: iakori" class=zola-anchor href=#iakori><i class=icon></i></a> Якори</h3><p><code>^</code> или <code>\A</code> определяет начало строки (<code>$url -replace '^','https:'</code> - добавить текст в начало строки) <br> <code>$</code> или <code>\Z</code> обозначают конец строки (<code>$ip -replace "\d{1,3}$","0"</code>) <br> <code>(?=text)</code> поиск слова слева. Пишем слева на право от искомого (ищет только целые словосочетания - <code>"Server:\s(.{1,30})\s(?=$username)"</code>) <br> <code>(?<=text)</code> поиск слова справа (<code>$in_time -replace ".+(?<=Last)"</code> - удалить все до <code>Last</code>) <br> <code>(?!text)</code> не совпадает со словом слева <br> <code>(?&LT!text)</code> не совпадает со словом справа<p><code>$test = "string"</code> <br> <code>$test -replace ".{1}$"</code> удалить любое кол-во символов в конце строки <br> <code>$test -replace "^.{1}"</code> удалить любое кол-во символов в начале строки<h3 id=gruppy-zakhvata><a aria-label="Anchor link for: gruppy-zakhvata" class=zola-anchor href=#gruppy-zakhvata><i class=icon></i></a> Группы захвата</h3><p><code>$date = '12.31.2021'</code> <br> <code>$date -replace '^(\d{2}).(\d{2})','$2.$1'</code> поменять местами <br> <code>$1</code> содержимое первой группы в скобках <br> <code>$2</code> содержимое второй группы<p><code>-replace "1","2"</code> замена элементов в индексах массива (везде где присутствует 1, заменить на 2), для удаления используется только первое значение <br> <code>-split " "</code> преобразовать строку в массив, разделителем указан пробел, которой удаляется ($url.Split(“/”)[-1]) <br> <code>-join " "</code> преобразовать массив (коллекцию) в единую строку (string), добавить разделителем пробел<p><code>@(1,2,3) -contains 3</code> проверить, что элемент справа содержится в массиве слева <br> <code>@(1,2) -notcontains 3</code> проверить, что элемент справа не содержится в массиве слева<p><code>-like *txt*</code> поиск по маскам wildcard, выводит значение на экран <br> <code>-match txt</code> поиска по шаблонам, проверка на соответствие содержимого текста <br> <code>-match "zabbix|rpc"</code> условия, для поиска по нескольким словам <br> <code>-NotMatch</code> проверка на отсутствие вхождения \<h3 id=matches><a aria-label="Anchor link for: matches" class=zola-anchor href=#matches><i class=icon></i></a> Matches</h3><p><code>"num: 777" -match "num: ([0-9]+)" | Out-Null</code> <br> <code>$Matches[1]</code> выводим только номер<p><code>$ip = "192.168.10.1"</code> <br> <code>$ip -match "(\.\d{1,3})\.\d{1,2}"</code> True <br> <code>$Matches</code> отобразить все подходящие переменные последнего поиска, которые входят и не входят в группы ()<p><code>$String = "09/14/2017 12:00:27 - mtbill_post_201709141058.txt 7577_Delivered: OK"</code> <br> <code>$String -Match ".*(?=\.txt)" | Out-Null</code> <br> <code>$Matches[0][-4..-1] -Join ""</code><p><code>$string.Substring($string.IndexOf(".txt")-4, 4)</code> 2-й вариант (IndexOf)<h3 id=formatirovanie><a aria-label="Anchor link for: formatirovanie" class=zola-anchor href=#formatirovanie><i class=icon></i></a> Форматирование</h3><p><code>[string]::Format("{1} {0}","Index0","Index1")</code> <br> <code>"{1} {0}" -f "Index0","Index1"</code> <br> <code>"{0:###-##-##}" -f 1234567</code> записать число в другом формате (#) <br> <code>"{0:0000}" -f 123</code> вывести число в формате не меньше 4 знаков (0123) <br> <code>"{0:P0}" -f (220/1000)</code> посчитать в процентах (P) <br> <code>"{0:P}" -f (512MB/1GB)</code> сколько % составляет 512Мб от 1Гб <br> <code>"{0:0.0%}" -f 0.123</code> умножить на 100%<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>gp</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-other z-powershell">|</span> sort cpu <span class="z-keyword z-operator z-assignment z-powershell">-</span>Descending <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>First <span class="z-constant z-numeric z-integer z-powershell">10</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>p</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>gp</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0} - {1:N2}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>p<span class="z-variable z-other z-member z-powershell">.processname</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>p<span class="z-variable z-other z-member z-powershell">.cpu</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> округлить<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=uslovnyi-operator><a aria-label="Anchor link for: uslovnyi-operator" class=zola-anchor href=#uslovnyi-operator><i class=icon></i></a> Условный оператор</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rh</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Read-Host</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rh</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    ipconfig
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rh</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    getmac
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    hostname
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p>Если условие if () является истенным ($True), выполнить действие в {} <br> Если условие if () является ложным ($False), выполнить действие не обязательного оператора else <br> Условие Elseif идёт после условия if для проверки дополнительных условий перед выполнение оператора else. Оператор, который первый вернет $True, отменит выполнение следующих дополнительных условий <br> Если передать переменную в условие без оператора, то будет проверяться наличие значения у переменной на $True/$False \<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Test-NetConnection</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Port <span class="z-constant z-numeric z-integer z-powershell">80</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.TcpTestSucceeded</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Opened port<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Closed port<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=logicheskie-operatory-sravneniia><a aria-label="Anchor link for: logicheskie-operatory-sravneniia" class=zola-anchor href=#logicheskie-operatory-sravneniia><i class=icon></i></a> Логические операторы сравнения</h3><p><code>-eq</code> равно (equal) <br> <code>-ceq</code> учитывать регистр <br> <code>-ne</code> не равно (not equal) <br> <code>-cne</code> не равно учитывая регистр <br> <code>-gt</code> больше (greater) <br> <code>-ge</code> больше или равно <br> <code>-lt</code> меньше (less) <br> <code>-le</code> меньше или равно <br> <code>-in</code> проверить на наличие (5 -in @(1,2,3,4,5)) <br> <code>-NOT</code> логическое НЕТ !(Test-Path $path) <br> <code>-and</code> логическое И <br> <code>-or</code> логическое ИЛИ \<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>1</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-logical z-powershell">-and</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>2</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-logical z-powershell">-or</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>1</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> два условия: (если $1 = 1 И $2 = 2) ИЛИ $1 не равно 3 вернуть $true<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h3 id=pipeline-operators><a aria-label="Anchor link for: pipeline-operators" class=zola-anchor href=#pipeline-operators><i class=icon></i></a> Pipeline Operators</h3><p><code>Write-Output "First" && Write-Output "Second"</code> две успешные команды выполняются <br> <code>Write-Error "Bad" && Write-Output "Second"</code> первая команда завершается ошибкой, из-за чего вторая команда не выполняется <br> <code>Write-Error "Bad" || Write-Output "Second"</code> первая команда завершается ошибкой, поэтому выполняется вторая команда <br> <code>Write-Output "First" || Write-Output "Second"</code> первая команда выполнена успешно, поэтому вторая команда не выполняется<h3 id=invocation-operator><a aria-label="Anchor link for: invocation-operator" class=zola-anchor href=#invocation-operator><i class=icon></i></a> Invocation Operator</h3><p><code>$addr = "8.8.8.8"</code> <br> <code>$ping = "ping"</code> <br> <code>& $ping $addr</code> запускает текст как команду<p><code>& $ping $addr &</code> запустить команду в фоне <br> <code>(Get-Job)[-1] | Receive-Job -Keep</code><h2 id=datatype><a aria-label="Anchor link for: datatype" class=zola-anchor href=#datatype><i class=icon></i></a> DataType</h2><p><code>$srv.GetType()</code> узнать тип данных <br> <code>$srv -is [string]</code> проверка на соответствие типа данных <br> <code>$srv -isnot [System.Object]</code> проверка на несоответствие <br> <code>[Object]</code> массив (BaseType:System.Array) <br> <code>[DateTime]</code> формат времени (BaseType:System.ValueType) <br> <code>[Bool]/[Boolean]</code> логическое значение ($True/$False) или 1/0 (1 бит) наличие/отсуствие напряжения <br> <code>[Byte]</code> 8-битное (1 байт) целое число без знака (0..255) <br> <code>[Int16]</code> 16-битное знаковое целое число от -32767 до 32767 (тип данных WORD 0..65535) <br> <code>[Int]</code> 32-битное (4 байта) знаковое целое число от –2147483648 до 2147483647 (DWORD) <br> <code>[Int64]</code> 64-битное от -9223372036854775808 до 9223372036854775808 (LWORD) <br> <code>[Decimal]</code> 128-битное десятичное значение от –79228162514264337593543950335 до 79228162514264337593543950335 <br> <code>[Single]</code> число с плавающей запятой (32-разрядное) <br> <code>[Double]</code> число с плавающей запятой с двойной точностью (64-разрядное) <br> <code>[String]</code> неизменяемая строка символов Юникода фиксированной длины (BaseType:System.Object)<h3 id=math><a aria-label="Anchor link for: math" class=zola-anchor href=#math><i class=icon></i></a> Math</h3><p><code>[math] | Get-Member -Static</code> <br> <code>[math]::Pow(2,4)</code> 2 в 4 степени <br> <code>[math]::Truncate(1.8)</code> грубое округление, удаляет дробную часть <br> <code>[math]::Ceiling(1.8)</code> округляет число в большую сторону до ближайшего целого значения <br> <code>[math]::Floor(-1.8)</code> округляет число в меньшую сторону <br> <code>[math]::Min(33,22)</code> возвращает наименьшее значение двух значений <br> <code>[math]::Max(33,22)</code> возвращает наибольшее значение двух значений<h3 id=round><a aria-label="Anchor link for: round" class=zola-anchor href=#round><i class=icon></i></a> Round</h3><p><code>[double]::Round(87.5, 0)</code> 88 (нечетное), в .NET по умолчанию используется округление в средней точке ToEven, где *.5 значения округляются до ближайшего четного целого числа <br> <code>[double]::Round(88.5, 0)</code> 88 (четное) <br> <code>[double]::Round(88.5, 0, 1)</code> 89 (округлять в большую сторону) <br> <code>[double]::Round(1234.56789, 2)</code> округлить до 2 символов после запятой<h3 id=tostring><a aria-label="Anchor link for: tostring" class=zola-anchor href=#tostring><i class=icon></i></a> ToString</h3><p><code>(4164539/1MB).ToString("0.00")</code> разделить на дважды на 1024/1024 и округлить до 3,97<h3 id=char><a aria-label="Anchor link for: char" class=zola-anchor href=#char><i class=icon></i></a> Char</h3><p><code>[Char]</code> cимвол Юникода (16-разрядный) <br> <code>$char = $srv.ToCharArray()</code> разбить строку [string] на массив [System.Array] из букв<h2 id=function><a aria-label="Anchor link for: function" class=zola-anchor href=#function><i class=icon></i></a> Function</h2><h3 id=switch-function><a aria-label="Anchor link for: switch-function" class=zola-anchor href=#switch-function><i class=icon></i></a> Switch function</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MMM</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Date</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>UFormat <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>%m<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">switch</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MMM</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>01<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Jan<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>02<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Feb<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>03<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Mar<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>04<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Apr<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>05<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>May<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>06<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Jun<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>07<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Jul<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>08<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Aug<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>09<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Sep<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>10<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Oct<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>11<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Nov<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>12<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Dec<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=switch-param><a aria-label="Anchor link for: switch-param" class=zola-anchor href=#switch-param><i class=icon></i></a> Switch param</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">Function</span> <span class="z-entity z-name z-function z-powershell">fun-switch</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>param</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">If</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>param</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>yes<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>no<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>fun-switch -param</code><h3 id=psm1-module-file-and-parameters><a aria-label="Anchor link for: psm1-module-file-and-parameters" class=zola-anchor href=#psm1-module-file-and-parameters><i class=icon></i></a> psm1 (module file and parameters)</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-Function</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-block z-powershell"><span class="z-punctuation z-definition z-comment z-block z-begin z-powershell"><#</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">SYNOPSIS</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    Описание
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">DESCRIPTION</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    Описание
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">LINK</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    https://github.com/Lifailon/PS-Commands
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    <span class="z-punctuation z-definition z-comment z-block z-end z-powershell">#></span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-parameter z-attribute z-powershell">ValueFromPipeline</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Text</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">ValidateSet</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test2<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Provider</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">ValidateRange</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Number</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-keyword z-control z-powershell">Param</span> Text: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Text</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-keyword z-control z-powershell">Param</span> Provider: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Provider</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-keyword z-control z-powershell">Param</span> Number: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Number</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Get-Function -Text Text1</code> <br> <code>Get-Function -Text Text2 -Provider Test2 -Number 3</code><h3 id=psd1-module-description-file><a aria-label="Anchor link for: psd1-module-description-file" class=zola-anchor href=#psd1-module-description-file><i class=icon></i></a> psd1 (module description file)</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">RootModule</span>        <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Get-Function.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ModuleVersion</span>     <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>0.1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Author</span>            <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Lifailon<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">CompanyName</span>       <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Open Source Community<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Copyright</span>         <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Apache-2.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Description</span>       <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Function example<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">PowerShellVersion</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>7.2<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">PrivateData</span>       <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">PSData</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Tags</span>         <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Function<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Example<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ProjectUri</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/Lifailon/PS-Commands<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">LicenseUri</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/Lifailon/Console-Translate/blob/rsa/LICENSE<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ReleaseNotes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Second release<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h2 id=bit><a aria-label="Anchor link for: bit" class=zola-anchor href=#bit><i class=icon></i></a> Bit</h2><pre class=z-code><code><span class="z-text z-plain">Двоичное    Десятичное
</span><span class="z-text z-plain">1           1
</span><span class="z-text z-plain">10          2
</span><span class="z-text z-plain">11          3
</span><span class="z-text z-plain">100         4
</span><span class="z-text z-plain">101         5
</span><span class="z-text z-plain">110         6
</span><span class="z-text z-plain">111         7
</span><span class="z-text z-plain">1000        8
</span><span class="z-text z-plain">1001        9
</span><span class="z-text z-plain">1010        10
</span><span class="z-text z-plain">1011        11
</span><span class="z-text z-plain">1100        12
</span><span class="z-text z-plain">1101        13
</span><span class="z-text z-plain">1110        14
</span><span class="z-text z-plain">1111        15
</span><span class="z-text z-plain">1 0000      16
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Двоичное    Десятичное  Номер разряда
</span><span class="z-text z-plain">1           1           0
</span><span class="z-text z-plain">10          2           1
</span><span class="z-text z-plain">100         4           2
</span><span class="z-text z-plain">1000        8           3
</span><span class="z-text z-plain">1 0000      16          4
</span><span class="z-text z-plain">10 0000     32          5
</span><span class="z-text z-plain">100 0000    64          6
</span><span class="z-text z-plain">1000 0000   128         7
</span><span class="z-text z-plain">1 0000 0000 256         8
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Из двоичного => десятичное (1-й вариант по таблице)
</span><span class="z-text z-plain">1001 0011 = 1000 0000 + 1 0000 + 10 + 1 = 128 + 16 + 2 + 1 = 147
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">2-й вариант
</span><span class="z-text z-plain">7654 3210 (разряды двоичного выражения) = (1*2^7)+(0*2^6)+(0*2^5)+(1*2^4)+(0*2^3)+(0*2^2)+(1*2^1)+(1*2^0) = 147
</span><span class="z-text z-plain">[math]::Pow(2,7) + [math]::Pow(2,4) + [math]::Pow(2,1) + [math]::Pow(2,0) = 147` исключить 0 и сложить степень
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Из десятичного => двоичное (1-й вариант по таблице)
</span><span class="z-text z-plain">347 вычесть ближайшие 256 = 91 (+ 1 0000 0000 забрать двоичный остаток)
</span><span class="z-text z-plain">91  - 64  = 27 ближайшее 16 (+ 100 0000)
</span><span class="z-text z-plain">27  - 16  = 11 ближайшее 8 (+ 1 0000)
</span><span class="z-text z-plain">11  - 8   = 3  ближайшее 2 (+ 1000)
</span><span class="z-text z-plain">3   - 2   = 1 (+ 10)
</span><span class="z-text z-plain">1   - 1   = 0 (+ 1)
</span><span class="z-text z-plain">1 0101 1011
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">2-й вариант
</span><span class="z-text z-plain">Последовательное деления числа на 2, предворительно забирая остаток для получения четного числа в меньшую сторону
</span><span class="z-text z-plain">347 - 346 = остаток 1, (347-1)/2 = 173
</span><span class="z-text z-plain">173 - 172 = остаток 1, (172-1)/2 = 86
</span><span class="z-text z-plain">86  - 86  = остаток 0, 86/2 = 43
</span><span class="z-text z-plain">43  - 42  = остаток 1, (43-1)/2 = 21
</span><span class="z-text z-plain">21  - 20  = остаток 1, (21-1)/2 = 10
</span><span class="z-text z-plain">10  - 10  = остаток 0, 10/2 = 5
</span><span class="z-text z-plain">5   - 4   = остаток 1, (5-1)/2 = 2
</span><span class="z-text z-plain">2   - 2   = остаток 0, 2/2 = 1
</span><span class="z-text z-plain">1   - 2   = остаток 1, (1-1)/2 = 0
</span><span class="z-text z-plain">Результат деления записывается снизу вверх
</span></code></pre><h3 id=bit-convertor><a aria-label="Anchor link for: bit-convertor" class=zola-anchor href=#bit-convertor><i class=icon></i></a> Bit Convertor</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertTo-Bit</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">array</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetType<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">double</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">array</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetType<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">array</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span>  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">-999</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\s<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>ConvertTo-Bit 347</code><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertFrom-Bit</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bit</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bit<span class="z-variable z-other z-member z-powershell">.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ToCharArray<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits<span class="z-variable z-other z-member z-powershell">.Count</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-constant z-numeric z-integer z-powershell">-1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>b</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>b</span> <span class="z-keyword z-operator z-comparison z-powershell">-notlike</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">math</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Pow<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span> <span class="z-keyword z-operator z-assignment z-powershell">-=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>ConvertFrom-Bit 10010011</code><p><code>Get-Process pwsh | fl ProcessorAffinity</code> привязка процесса к ядрам, представляет из себя битовую маску (bitmask), где каждому биту соответствует ядро процессора. Если для ядра отмечено сходство (affinity), то бит выставляется в 1, если нет — то в 0. Например, если выбраны все 16 ядер, то это 1111 1111 1111 1111 или 65535. <br> <code>$(Get-Process pwsh).ProcessorAffinity = 15</code> 0000000000001111 присвоить 4 первых ядра <br> <code>$(Get-Process pwsh).ProcessorAffinity = 61440</code> 1111000000000000 присвоить 4 последних ядра <br> <code>$(Get-Process pwsh).ProcessorAffinity = (ConvertFrom-Bit 1111000000000000)</code><h2 id=cycle><a aria-label="Anchor link for: cycle" class=zola-anchor href=#cycle><i class=icon></i></a> Cycle</h2><h3 id=foreach><a aria-label="Anchor link for: foreach" class=zola-anchor href=#foreach><i class=icon></i></a> Foreach</h3><p><code>$list = 100..110</code> создать массив из цифр от 100 до 110 <br> <code>foreach ($srv in $list) {ping 192.168.3.$srv -n 1 -w 50}</code> $srv хранит текущий элемент из $list и повторяет команду до последнего элемента в массиве <br> <code>$foreach.Current</code> текущий элемент в цикле <br> <code>$foreach.Reset()</code> обнуляет итерацию, перебор начнется заново, что приводит к бесконечному циклу <br> <code>$foreach.MoveNext()</code> переход к следующему элементу в цикле<h3 id=foreach-object><a aria-label="Anchor link for: foreach-object" class=zola-anchor href=#foreach-object><i class=icon></i></a> ForEach-Object (%)</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">100</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">110</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">%</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-constant z-numeric z-integer z-powershell">192.168</span>.<span class="z-constant z-numeric z-integer z-powershell">3</span>.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-redirection z-powershell">></span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastExitCode</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ForegroundColor green
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">-</span>ForegroundColor Red
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>% </code> передать цикл через конвеер (ForEach-Object) <br> <code>$_</code> переменная цикла и конвеера ($PSItem) <br> <code>gwmi Win32_QuickFixEngineering | where {$_.InstalledOn.ToString() -match "2022"} | %{($_.HotFixID.Substring(2))}</code> gwmi создает массив, вывод команды передается where для поиска подходящих под критерии объектов. По конвееру передается в цикл для удаления первых (2) символов методом Substring из всех объектов HotFixID.<h3 id=while><a aria-label="Anchor link for: while" class=zola-anchor href=#while><i class=icon></i></a> While</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>yandex.ru<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out2</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Есть пинг<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out3</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Нет пинга<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> предварительно сбросить переменную, While проверяет условие до запуска цикла<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">While</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> пока условие является $true, цикл будет повторяться<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ttl<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out2</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out3</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> sleep <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> запустить бесконечный цикл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> ping yandex.ru <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>TTL<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> условие, при котором будет выполнен break<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Сайт доступен<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">break</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> остановит цикл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Сайт недоступен<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> sleep <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=try-catch-finally><a aria-label="Anchor link for: try-catch-finally" class=zola-anchor href=#try-catch-finally><i class=icon></i></a> Try-Catch-Finally</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">Try</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> pping <span class="z-constant z-numeric z-integer z-powershell">192.168</span>.<span class="z-constant z-numeric z-integer z-powershell">3.1</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">Catch</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Write-Warning</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>error</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> выводит в случае ошибки (вместо ошибки)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">finally</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>End<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> выполняется в конце в любом случае<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h2 id=files><a aria-label="Anchor link for: files" class=zola-anchor href=#files><i class=icon></i></a> Files</h2><p><code>Get-Content $home/desktop\test.txt -Wait</code> аналог tail <br> <code>Test-Path $path</code> проверить доступность пути <br> <code>Get-FileHash -Algorithm SHA256 "$path"</code> узнать хэш файла по алгоритму sha256 <br> <code>Get-ChildItem $path -Filter *.txt -Recurse</code> отобразить содержимое каталога (Alias: ls/gci/dir) и дочерних каталогов (-Recurse) и отфильтровать вывод <br> <code>Get-Location</code> отобразить текущие месторасположение (Alias: pwd/gl) <br> <code>Set-Location $path</code> перемещение по каталогам (Alias: cd/sl) <br> <code>Invoke-Item $path</code> открыть файл (Alias: ii/start) <br> <code>Get-ItemProperty $env:userprofile\Documents\dns-list.txt | select FullName,Directory,Name,BaseName,Extension</code> свойтсва файла <br> <code>Get-ItemProperty -Path $path\* | select FullName,CreationTime,LastWriteTime</code> свойства файлов содержимого директории, дата их создания и последнего изменения <br> <code>New-Item -Path "C:\test\" -ItemType "Directory"</code> создать директорию (Alias: mkdir/md) <br> <code>New-Item -Path "C:\test\file.txt" -ItemType "File" -Value "Добавить текст в файл"</code> создать файл <br> <code>"test" > "C:\test\file.txt"</code> заменить содержимое <br> <code>"test" >> "C:\test\file.txt"</code> добавить строку в файл <br> <code>New-Item -Path "C:\test\test\file.txt" -Force</code> ключ используется для создания отсутствующих в пути директорий или перезаписи файла если он уже существует <br> <code>Move-Item</code> перемещение объектов (Alias: mv/move) <br> <code>Remove-Item "$path\" -Recurse</code> удаление всех файлов внутри каталога, без запроса подверждения (Alias: rm/del) <br> <code>Remove-Item $path -Recurse -Include "*.txt","*.temp" -Exclude "log.txt"</code> удалить все файлы с расширением txt и temp ([Array]), кроме log.txt <br> <code>Rename-Item "C:\test\*.*" "*.jpg"</code> переименовать файлы по маске (Alias: ren) <br> <code>Copy-Item</code> копирование файлов и каталогов (Alias: cp/copy) <br> <code>Copy-Item -Path "\\server-01\test" -Destination "C:\" -Recurse</code> копировать директорию с ее содержимым (-Recurse) <br> <code>Copy-Item -Path "C:\*.txt" -Destination "C:\test\"</code> знак ’' в конце Destination используется для переноса папки внутрь указанной, отсутствие, что это новое имя директории <br> <code>Copy-Item -Path "C:\*" -Destination "C:\test\" -Include '*.txt','*.jpg'</code> копировать объекты с указанным расширением (Include) <br> <code>Copy-Item -Path "C:\*" -Destination "C:\test\" -Exclude '*.jpeg'</code> копировать объекты, за исключением файлов с расширением (Exclude) <br> <code>$log = Copy-Item "C:\*.txt" "C:\test\" -PassThru</code> вывести результат копирования (логирование) в переменную, можно забирать строки с помощью индексов $log[0].FullName <br> <code>Unblock-File "script.ps1"</code> разблокирует файлы скриптов PowerShell скачанных из Интернета, чтобы их можно было запустить, даже если политика выполнения PowerShell в режиме RemoteSigned<h3 id=clear-env-temp-14-days><a aria-label="Anchor link for: clear-env-temp-14-days" class=zola-anchor href=#clear-env-temp-14-days><i class=icon></i></a> Clear-env-Temp-14-days</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ls</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>TEMP</span>\<span class="z-keyword z-operator z-assignment z-powershell">*</span>.tmp <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> считать все файлы с указанным расширением<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>date</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.AddDays<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">-14</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>l</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ls</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>l<span class="z-variable z-other z-member z-powershell">.LastWriteTime</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-le</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>l<span class="z-variable z-other z-member z-powershell">.FullName</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>l<span class="z-variable z-other z-member z-powershell">.FullName</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=system-io-file><a aria-label="Anchor link for: system-io-file" class=zola-anchor href=#system-io-file><i class=icon></i></a> System.IO.File</h3><p><code>$file = [System.IO.File]::Create("$home\desktop\test.txt")</code> создать файл <br> <code>$file.Close()</code> закрыть файл <br> <code>[System.IO.File]::ReadAllLines("$home\desktop\test.txt")</code> прочитать файл <br> <code>$file = New-Object System.IO.StreamReader("$home\desktop\test.txt")</code> файл будет занят процессом PowerShell <br> <code>$file | Get-Member</code> <br> <code>$file.ReadLine()</code> построчный вывод <br> <code>$file.ReadToEnd()</code> прочитать файл целиком<h3 id=read-write-bytes><a aria-label="Anchor link for: read-write-bytes" class=zola-anchor href=#read-write-bytes><i class=icon></i></a> Read/Write Bytes</h3><p><code>$file = [io.file]::ReadAllBytes("$home\desktop\powershell.jpg")</code> метод открывает двоичный файл, считывает его в массив байт и закрывает файл <br> <code>[io.file]::WriteAllBytes("$home\desktop\tloztotk-2.jpg",$file)</code> сохранить байты в файл (можно использовать для выгрузки двоичных файлов из БД)<h2 id=archive><a aria-label="Anchor link for: archive" class=zola-anchor href=#archive><i class=icon></i></a> Archive</h2><h3 id=microsoft-powershell-archive><a aria-label="Anchor link for: microsoft-powershell-archive" class=zola-anchor href=#microsoft-powershell-archive><i class=icon></i></a> Microsoft.PowerShell.Archive</h3><p><code>Compress-Archive -Path $srcPath -DestinationPath "$($srcPath).zip" -CompressionLevel Optimal</code> архивировать (по исходному пути и названию с добавлением расширения) <br> <code>Expand-Archive -Path $zip</code> разархивировать <br> <code>Expand-Archive -Path $zip -DestinationPath $dstPath</code> указать путь извлечения <br> <code>Expand-Archive -Path $zip -OutputPath $dstPath</code><h3 id=system-io-compression-filesystem><a aria-label="Anchor link for: system-io-compression-filesystem" class=zola-anchor href=#system-io-compression-filesystem><i class=icon></i></a> System.IO.Compression.FileSystem</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Expand-ArchiveFile</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Путь к архиву<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Path</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Путь, куда извлечь файл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DestinationPath</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Имя файла, который нужно извлечь<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FileName</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>AssemblyName System.IO.Compression.FileSystem
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">try</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Открыть архив для чтения<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipArchive</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.Compression.ZipFile</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::OpenRead<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Найти файл в архиве<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileEntry</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipArchive<span class="z-variable z-other z-member z-powershell">.Entries</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.FullName</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileName</span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileEntry</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создание потока для чтения содержимого файла<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stream</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileEntry<span class="z-variable z-other z-member z-powershell">.Open</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создание файла и запись в него данных из потока<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DestinationPathFileName</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DestinationPath</span>\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FileName</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileStream</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.File</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Create<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DestinationPathFileName</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stream<span class="z-variable z-other z-member z-powershell">.CopyTo</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileStream</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Закрытие потоков<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stream<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileStream<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-support z-function z-powershell">Write-Output</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Файл <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileName</span> не найден в архиве<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">catch</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Error</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Ошибка при извлечении файла из архива<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">finally</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Закрыть архив<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipArchive<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=winrar><a aria-label="Anchor link for: winrar" class=zola-anchor href=#winrar><i class=icon></i></a> WinRAR</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Expand-ArchivePassword</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Path</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Password</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>winrar</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span>  <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Program Files\WinRAR\WinRAR.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-operator z-other z-powershell">&</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>winrar</span> x <span class="z-keyword z-operator z-assignment z-powershell">-</span>p<span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Password</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Path</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>cd "$home\Downloads"</code> <br> <code>Expand-ArchivePassword archive.rar qwe123</code><h2 id=file-descriptor><a aria-label="Anchor link for: file-descriptor" class=zola-anchor href=#file-descriptor><i class=icon></i></a> File descriptor</h2><p><code>$url = "https://download.sysinternals.com/files/Handle.zip"</code> <br> <code>Invoke-RestMethod $url -OutFile "$env:TEMP\handle.zip"</code> <br> <code>Expand-ArchiveFile -Path "$env:TEMP\handle.zip" -DestinationPath "$home\Documents" -FileName "handle.exe"</code> извлекаем выбранный файл из архива <br> <code>Remove-Item "$env:TEMP\handle.zip"</code> <br> <code>$handle = "$home\Documents\handle.exe"</code> <br> <code>$test = New-Object System.IO.StreamReader("$home\desktop\test.txt")</code> занять файл текущим процессом pwsh ($pid) <br> <code>$SearchProcess = & $handle "C:\Users\Lifailon\Desktop\test.txt" -nobanner -u -v | ConvertFrom-Csv</code> вывести список дескрипторов по пути к файлу (имя процесса, его PID и пользователь который запустил) <br> <code>Stop-Process $SearchProcess.PID</code> завершить процесс, который удерживал файл<h2 id=console-menu><a aria-label="Anchor link for: console-menu" class=zola-anchor href=#console-menu><i class=icon></i></a> Console-Menu</h2><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Импортируем модуль PS-Menu в текущую сессию из репозитория GitHub<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>module</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://raw.githubusercontent.com/chrisseroka/ps-menu/master/ps-menu.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-Expression</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>module</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></code></pre><p>Пример навигации по директориям в системе используя меню:<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ls-menu</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">		<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">	</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	clear
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Проверяем, что мы не находимся в root директории (исключить возврат назад)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.Path</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetPathRoot<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">		<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> menu <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-array-expression z-powershell">			<span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-ChildItem</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.name<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-array-expression z-powershell">		<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">		<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> menu <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-array-expression z-powershell">			<span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>..<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-ChildItem</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.name<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-array-expression z-powershell">		<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Если выбрали возврат назад, то забираем только путь у стартовой директории<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>..<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">		<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>backPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.Path</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetDirectoryName<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">		ls<span class="z-keyword z-operator z-assignment z-powershell">-</span>menu <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>backPath</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">		<span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Проверяем, что выбрали директорию<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">		<span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span>\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PathType Container<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">			<span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Если выбрали директорию, к стартовому пути добавляем выбранное имя директории<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">			ls<span class="z-keyword z-operator z-assignment z-powershell">-</span>menu <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span>\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">		<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">		<span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">			ls<span class="z-keyword z-operator z-assignment z-powershell">-</span>menu <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">		<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>ls-menu</code> <br> <code>ls-menu $home</code> <br> <code>ls-menu "D:\"</code><h2 id=credential><a aria-label="Anchor link for: credential" class=zola-anchor href=#credential><i class=icon></i></a> Credential</h2><p><code>$Cred = Get-Credential</code> сохраняет креды в переменные <code>$Cred.Username</code> и <code>$Cred.Password</code> <br> <code>$Cred.GetNetworkCredential().password</code> извлечь пароль <br> <code>cmdkey /generic:"TERMSRV/$srv" /user:"$username" /pass:"$password"</code> добавить указанные креды аудентификации на на терминальный сервер для подключения без пароля <br> <code>mstsc /admin /v:$srv</code> авторизоваться <br> <code>cmdkey /delete:"TERMSRV/$srv"</code> удалить добавленные креды аудентификации из системы <br> <code>rundll32.exe keymgr.dll,KRShowKeyMgr</code> хранилище Stored User Names and Password <br> <code>Get-Service VaultSvc</code> служба для работы Credential Manager <br> <code>Install-Module CredentialManager</code> установить модуль управления Credential Manager к хранилищу PasswordVault из PowerShell <br> <code>[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]'Tls11,Tls12'</code> для устаноки модуля <br> <code>Get-StoredCredential</code> получить учетные данные из хранилища Windows Vault <br> <code>Get-StrongPassword</code> генератор пароля <br> <code>New-StoredCredential -UserName test -Password "123456"</code> добавить учетную запись <br> <code>Remove-StoredCredential</code> удалить учетную запись <br> <code>$Cred = Get-StoredCredential | where {$_.username -match "admin"}</code> <br> <code>$pass = $cred.password</code> <br> <code>$BSTR = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pass)</code> <br> <code>[System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)</code><h3 id=out-gridview><a aria-label="Anchor link for: out-gridview" class=zola-anchor href=#out-gridview><i class=icon></i></a> Out-Gridview</h3><p><code>Get-Service -cn $srv | Out-GridView -Title "Service $srv" -OutputMode Single –PassThru | Restart-Service</code> перезапустить выбранную службу<h3 id=out-file><a aria-label="Anchor link for: out-file" class=zola-anchor href=#out-file><i class=icon></i></a> Out-File</h3><p><code>Read-Host –AsSecureString | ConvertFrom-SecureString | Out-File "$env:userprofile\desktop\password.txt"</code> писать в файл. Преобразовать пароль в формат SecureString с использованием шифрования Windows Data Protection API (DPAPI)<h3 id=get-content-gc-cat-type><a aria-label="Anchor link for: get-content-gc-cat-type" class=zola-anchor href=#get-content-gc-cat-type><i class=icon></i></a> Get-Content (gc/cat/type)</h3><p><code>$password = gc "$env:userprofile\desktop\password.txt" | ConvertTo-SecureString</code> читать хэш пароля из файла с помощью ключей, хранящихся в профиле текущего пользователя, который невозможно прочитать на другом копьютере<h3 id=aes-key><a aria-label="Anchor link for: aes-key" class=zola-anchor href=#aes-key><i class=icon></i></a> AES Key</h3><p><code>$AESKey = New-Object Byte[] 32</code> <br> <code>[Security.Cryptography.RNGCryptoServiceProvider]::Create().GetBytes($AESKey)</code> <br> <code>$AESKey | Out-File "C:\password.key"</code> <br> <code>$Cred.Password | ConvertFrom-SecureString -Key (Get-Content "C:\password.key") | Set-Content "C:\password.txt"</code> сохранить пароль в файл используя внешний ключ <br> <code>$pass = Get-Content "C:\password.txt" | ConvertTo-SecureString -Key (Get-Content "\\Server\Share\password.key")</code> расшифровать пароль на втором компьютере<h2 id=winevent><a aria-label="Anchor link for: winevent" class=zola-anchor href=#winevent><i class=icon></i></a> WinEvent</h2><p><code>Get-WinEvent -ListLog *</code> отобразить все доступные журналы логов <br> <code>Get-WinEvent -ListLog * | where RecordCount -ne 0 | where RecordCount -ne $null | sort -Descending RecordCount</code> отобразить не пустые журналы с сортировкой по кол-ву записей <br> <code>Get-WinEvent -ListProvider * | ft</code> отобразить всех провайдеров приложений <br> <code>Get-WinEvent -ListProvider GroupPolicy</code> найти в какой журнал LogLinks {Application} пишутся логи приложения <br> <code>Get-WinEvent -ListProvider *smb*</code> <br> <code>Get-WinEvent -ListLog * | where logname -match SMB | sort -Descending RecordCount</code> найти все журналы по имени <br> <code>Get-WinEvent -LogName "Microsoft-Windows-SmbClient/Connectivity"</code> <br> <code>Get-WinEvent -ListProvider *firewall*</code><h3 id=filter-xpath-hashtable><a aria-label="Anchor link for: filter-xpath-hashtable" class=zola-anchor href=#filter-xpath-hashtable><i class=icon></i></a> Filter XPath/Hashtable</h3><p><code>Get-WinEvent -FilterHashtable @{LogName="Security";ID=4624}</code> найти логи по ID в журнале Security <br> <code>Get-WinEvent -FilterHashtable @{LogName="System";Level=2}</code> найти все записи ошибки (1 - критический, 3 - предупреждение, 4 - сведения) <br> <code>Get-WinEvent -FilterHashtable @{LogName="System";Level=2;ProviderName="Service Control Manager"}</code> отфильтровать по имени провайдера<p><code>([xml](Get-WinEvent -FilterHashtable @{LogName="Security";ID=4688} -MaxEvents 1).ToXml()).Event.EventData.Data</code> отобразить все свойства, хранимые в EventData (Message) <br> <code>Get-WinEvent -FilterHashtable @{logname="security";ID=4688} -MaxEvents 1 | select timecreated,{$_.Properties[5].value}</code> отфильтровать время события и имя запущенного процесса<pre class=z-code><code><span class="z-text z-plain">$query = '
</span><span class="z-text z-plain">&LTQueryList>
</span><span class="z-text z-plain">    &LTQuery Id="0" Path="Security">
</span><span class="z-text z-plain">        &LTSelect Path="Security">
</span><span class="z-text z-plain">		    *[System[EventID=4688]] and 
</span><span class="z-text z-plain">            *[EventData[Data[@Name="NewProcessName"]="C:\Windows\System32\autochk.exe" or Data[@Name="NewProcessName"]="C:\Windows\System32\services.exe"]]
</span><span class="z-text z-plain">        &LT/Select>
</span><span class="z-text z-plain">    &LT/Query>
</span><span class="z-text z-plain">&LT/QueryList>
</span><span class="z-text z-plain">'
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Get-WinEvent -LogName Security -FilterXPath $query
</span></code></pre><h3 id=reboot><a aria-label="Anchor link for: reboot" class=zola-anchor href=#reboot><i class=icon></i></a> Reboot</h3><pre class=z-code><code><span class="z-text z-plain">$query = '
</span><span class="z-text z-plain">&LTQueryList>
</span><span class="z-text z-plain">    &LTQuery Id="0" Path="System">
</span><span class="z-text z-plain">        &LTSelect Path="System">
</span><span class="z-text z-plain">		    *[
</span><span class="z-text z-plain">			System[
</span><span class="z-text z-plain">			EventID=41 or
</span><span class="z-text z-plain">			EventID=1074 or
</span><span class="z-text z-plain">			EventID=1076 or
</span><span class="z-text z-plain">			EventID=6005 or
</span><span class="z-text z-plain">			EventID=6006 or
</span><span class="z-text z-plain">			EventID=6008 or
</span><span class="z-text z-plain">			EventID=6009 or
</span><span class="z-text z-plain">			EventID=6013
</span><span class="z-text z-plain">			]
</span><span class="z-text z-plain">			]
</span><span class="z-text z-plain">        &LT/Select>
</span><span class="z-text z-plain">    &LT/Query>
</span><span class="z-text z-plain">&LT/QueryList>
</span><span class="z-text z-plain">'
</span><span class="z-text z-plain">Get-WinEvent -LogName System -FilterXPath $query
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">41  ` Система была перезагружена без корректного завершения работы.
</span><span class="z-text z-plain">1074` Система была корректного выключена пользователем или процессом.
</span><span class="z-text z-plain">1076` Следует за Event ID 6008 и означает, что первый пользователь (с правом выключения системы) подключившийся к серверу после неожиданной перезагрузки или выключения, указал причину этого события.
</span><span class="z-text z-plain">6005` Запуск "Журнала событий Windows" (Event Log). Указывает на включение системы.
</span><span class="z-text z-plain">6006` Остановка «Журнала событий Windows». Указывает на выключение системы.
</span><span class="z-text z-plain">6008` Предыдущее выключение системы было неожиданным.
</span><span class="z-text z-plain">6009` Версия операционной системы, зафиксированная при загрузке системы.
</span><span class="z-text z-plain">6013` Время работы системы (system uptime) в секундах.
</span></code></pre><h3 id=logon><a aria-label="Anchor link for: logon" class=zola-anchor href=#logon><i class=icon></i></a> Logon</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>localhost<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FilterXPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>&LTQueryList>&LTQuery Id="0">&LTSelect>*[System[EventID=21]]&LT/Select>&LT/Query>&LT/QueryList><span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RDPAuths</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-WinEvent</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComputerName <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>LogName <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft-Windows-TerminalServices-LocalSessionManager/Operational<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilterXPath <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FilterXPath</span>
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">xml</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RDPAuths</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">Foreach</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.ToXml</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EventData</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-keyword z-control z-powershell">Foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>event</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.Event</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">New-Object</span> PSObject <span class="z-keyword z-operator z-assignment z-powershell">-</span>Property <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Connection Time<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>event<span class="z-variable z-other z-member z-powershell">.System.TimeCreated.SystemTime</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Format <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>yyyy-MM-dd hh:mm K<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>User Name<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>event<span class="z-variable z-other z-member z-powershell">.UserData.EventXML.User</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>User ID<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>event<span class="z-variable z-other z-member z-powershell">.UserData.EventXML.SessionID</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>User Address<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>event<span class="z-variable z-other z-member z-powershell">.UserData.EventXML.Address</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Event ID<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>event<span class="z-variable z-other z-member z-powershell">.System.EventID</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EventData</span> <span class="z-keyword z-operator z-other z-powershell">|</span> ft
</span></code></pre><h3 id=eventlog><a aria-label="Anchor link for: eventlog" class=zola-anchor href=#eventlog><i class=icon></i></a> EventLog</h3><p><code>Get-EventLog -List</code> отобразить все корневые журналы логов и их размер <br> <code>Clear-EventLog Application</code> очистить логи указанного журнала <br> <code>Get-EventLog -LogName Security -InstanceId 4624</code> найти логи по ID в журнале Security<h2 id=firewall><a aria-label="Anchor link for: firewall" class=zola-anchor href=#firewall><i class=icon></i></a> Firewall</h2><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>days</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">5</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>obj</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fw</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-WinEvent</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft-Windows-Windows Firewall With Advanced Security/Firewall<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temp_fw</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fw</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temp_fw<span class="z-variable z-other z-member z-powershell">.id</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2097</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> 2004<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Added Rule<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temp_fw<span class="z-variable z-other z-member z-powershell">.id</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2006</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Deleted Rule<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temp_fw<span class="z-variable z-other z-member z-powershell">.Properties</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">7</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>ExpandProperty value
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temp_fw<span class="z-variable z-other z-member z-powershell">.Properties</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>ExpandProperty value
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>obj</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Time</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temp_fw<span class="z-variable z-other z-member z-powershell">.TimeCreated</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>type</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Port</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>name</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>obj</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> time <span class="z-keyword z-operator z-comparison z-powershell">-gt</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.AddDays<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>days</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><p><code>New-NetFirewallRule -Profile Any -DisplayName "Open Port 135 RPC" -Direction Inbound -Protocol TCP -LocalPort 135</code> открыть in-порт <br> <code>Get-NetFirewallRule | where DisplayName -match kms | select *</code> найти правило по имени <br> <code>Get-NetFirewallPortFilter | where LocalPort -like 80</code> найти действующие правило по номеру порта<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-NetFirewallRule</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Enabled True <span class="z-keyword z-operator z-assignment z-powershell">-</span>Direction Inbound <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>Property DisplayName<span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Protocol<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-NetFirewallPortFilter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Protocol<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>LocalPort<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-NetFirewallPortFilter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.LocalPort<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>RemotePort<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-NetFirewallPortFilter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.RemotePort<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>RemoteAddress<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-NetFirewallAddressFilter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.RemoteAddress<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell">Enabled<span class="z-keyword z-operator z-other z-powershell">,</span>Profile
</span></code></pre><h3 id=firewall-manager><a aria-label="Anchor link for: firewall-manager" class=zola-anchor href=#firewall-manager><i class=icon></i></a> Firewall-Manager</h3><p><code>Install-Module Firewall-Manager</code> <br> <code>Export-FirewallRules -Name * -CSVFile $home\documents\fw.csv</code> -Inbound -Outbound -Enabled -Disabled -Allow -Block (фильтр правил для экспорта) <br> <code>Import-FirewallRules -CSVFile $home\documents\fw.csv</code><h2 id=defender><a aria-label="Anchor link for: defender" class=zola-anchor href=#defender><i class=icon></i></a> Defender</h2><p><code>Import-Module Defender</code> <br> <code>Get-Command -Module Defender</code> <br> <code>Get-MpComputerStatus</code> <br> <code>(Get-MpComputerStatus).AntivirusEnabled</code> статус работы антивируса<p><code>$session = NewCimSession -ComputerName hostname</code> подключиться к удаленному компьютеру, используется WinRM <br> <code>Get-MpComputerStatus -CimSession $session | fl fullscan*</code> узнать дату последнего сканирования на удаленном компьютере<p><code>Get-MpPreference</code> настройки <br> <code>(Get-MpPreference).ScanPurgeItemsAfterDelay</code> время хранения записей журнала защитника в днях <br> <code>Set-MpPreference -ScanPurgeItemsAfterDelay 30</code> изменить время хранения <br> <code>ls "C:\ProgramData\Microsoft\Windows Defender\Scans\History"</code> <br> <code>Get-MpPreference | select disable*</code> отобразить статус всех видов проверок/сканирований <br> <code>Set-MpPreference -DisableRealtimeMonitoring $true</code> отключить защиту Defender в реальном времени (использовать только ручное сканирование) <br> <code>Set-MpPreference -DisableRemovableDriveScanning $false</code> включить сканирование USB накопителей <br> <code>Get-MpPreference | select excl*</code> отобразить список всех исключений <br> <code>(Get-MpPreference).ExclusionPath</code> <br> <code>Add-MpPreference -ExclusionPath C:\install</code> добавить директорию в исключение <br> <code>Remove-MpPreference -ExclusionPath C:\install</code> удалить из исключения <br> <code>New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force</code> полностью отключить Windows Defender<p><code>Set-MpPreference -SignatureDefinitionUpdateFileSharesSources \\FileShare1\Updates</code> для обновления из сетевой папки нужно предварительно скачать файлы с сигнатурами баз с сайта https://www.microsoft.com/security/portal/definitions/adl.aspx и поместить в сетевой каталог <code>Update-MpSignature -UpdateSource FileShares</code> изменить источник обновлений (MicrosoftUpdateServer – сервера обновлений MS в интернете, InternalDefinitionUpdateServer — внутренний WSUS сервер) <br> <code>Update-MpSignature</code> обновить сигнатуры<p><code>Start-MpScan -ScanType QuickScan</code> быстрая проверка или FullScan <br> <code>Start-MpScan -ScanType FullScan -AsJob</code> <br> <code>Set-MpPreference -RemediationScheduleDay 1-7</code> выбрать дни, начиная с воскресенья или 0 каждый день, 8 - сбросить <br> <code>Set-MpPreference -ScanScheduleQuickScanTime 14:00:00</code> <br> <code>Start-MpScan -ScanType CustomScan -ScanPath "C:\Program Files"</code> сканировать выбранную директорию<p><code>Get-MpThreat</code> история угроз и тип угрозы (ThreatName: HackTool/Trojan) <br> <code>Get-MpThreatCatalog</code> список известных видов угроз <br> <code>Get-MpThreatDetection</code> история защиты (активных и прошлые) и ID угрозы <br> <code>Get-MpThreat -ThreatID 2147760253</code><p><code>ls "C:\ProgramData\Microsoft\Windows Defender\Quarantine\"</code> директория хранения файлов в карантине <br> <code>cd "C:\Program Files\Windows Defender\"</code> <br> <code>.\MpCmdRun.exe -restore -name $ThreatName</code> восстановить файл из карантина <br> <code>.\MpCmdRun.exe -restore -filepath $path_file</code><h2 id=dism><a aria-label="Anchor link for: dism" class=zola-anchor href=#dism><i class=icon></i></a> DISM</h2><p><code>Get-Command -Module Dism -Name *Driver*</code> <br> <code>Export-WindowsDriver -Online -Destination C:\Users\Lifailon\Documents\Drivers\</code> извлечение драйверов из текущей системы (C:\Windows\System32\DriverStore\FileRepository), выгружает список файлов, которые необходимы для установки драйвера (dll,sys,exe) в соответствии со списком файлов, указанных в секции [CopyFiles] inf-файла драйвера. <br> <code>Export-WindowsDriver -Path C:\win_image -Destination C:\drivers</code> извлечь драйвера из офлайн образа Windows, смонтированного в каталог c:\win_image <br> <code>$BackupDrivers = Export-WindowsDriver -Online -Destination C:\Drivers</code> <br> <code>$BackupDrivers | ft Driver,ClassName,ProviderName,Date,Version,ClassDescription</code> список драйверов в объектном представлении <br> <code>$BackupDrivers | where classname -match printer</code> <br> <code>pnputil.exe /add-driver C:\drivers\*.inf /subdirs /install</code> установить все (параметр subdirs) драйвера из указанной папки (включая вложенные)<p><code>sfc /scannow</code> проверить целостность системных файлов с помощью утилиты SFC (System File Checker), в случае поиска ошибок, попробует восстановить их оригинальные копии из хранилища системных компонентов Windows (каталог C:\Windows\WinSxS). Вывод работы логируется в C:\Windows\Logs\CBS с тегом SR <br> <code>Get-ComputerInfo | select *</code> подробная информация о системе (WindowsVersion,WindowsEditionId,<em>Bios</em>) <br> <code>Get-WindowsImage -ImagePath E:\sources\install.wim</code> список доступных версий в образе <br> <code>Repair-WindowsImage -Online –ScanHealth</code> <br> <code>Repair-WindowsImage -Online -RestoreHealth</code> восстановление хранилища системных компонентов <br> <code>Repair-WindowsImage -Online -RestoreHealth -Source E:\sources\install.wim:3 –LimitAccess</code> восстановление в оффлайн режиме из образа по номеру индекса<h2 id=scheduled><a aria-label="Anchor link for: scheduled" class=zola-anchor href=#scheduled><i class=icon></i></a> Scheduled</h2><p><code>$Trigger = New-ScheduledTaskTrigger -At 01:00am -Daily</code> 1:00 ночи <br> <code>$Trigger = New-ScheduledTaskTrigger –AtLogon</code> запуск при входе пользователя в систему <br> <code>$Trigger = New-ScheduledTaskTrigger -AtStartup</code> при запуске системы <br> <code>$User = "NT AUTHORITY\SYSTEM"</code> <br> <code>$Action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "$home\Documents\DNS-Change-Tray-1.3.ps1"</code> <br> <code>$Action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "-NoProfile -NoLogo -NonInteractive -ExecutionPolicy Unrestricted -WindowStyle Hidden -File $home\Documents\DNS-Change-Tray-1.3.ps1"</code> <br> <code>Register-ScheduledTask -TaskName "DNS-Change-Tray-Startup" -Trigger $Trigger -User $User -Action $Action -RunLevel Highest –Force</code><p><code>Get-ScheduledTask | ? state -ne Disabled</code> список всех активных заданий <br> <code>Start-ScheduledTask DNS-Change-Tray-Startup</code> запустить задание немедленно <br> <code>Get-ScheduledTask DNS-Change-Tray-Startup | Disable-ScheduledTask</code> отключить задание <br> <code>Get-ScheduledTask DNS-Change-Tray-Startup | Enable-ScheduledTask</code> включить задание <br> <code>Unregister-ScheduledTask DNS-Change-Tray-Startup</code> удалить задание <br> <code>Export-ScheduledTask DNS-Change-Tray-Startup | Out-File $home\Desktop\Task-Export-Startup.xml</code> экспортировать задание в xml <br> <code>Register-ScheduledTask -Xml (Get-Content $home\Desktop\Task-Export-Startup.xml | Out-String) -TaskName "DNS-Change-Tray-Startup"</code><h2 id=network><a aria-label="Anchor link for: network" class=zola-anchor href=#network><i class=icon></i></a> Network</h2><h3 id=ping><a aria-label="Anchor link for: ping" class=zola-anchor href=#ping><i class=icon></i></a> ping</h3><p><code>Test-Connection -Count 1 $srv1, $srv2</code> отправить icmp-пакет двум хостам <br> <code>Test-Connection $srv -ErrorAction SilentlyContinue</code> не выводить ошибок, если хост не отвечает <br> <code>Test-Connection -Source $srv1 -ComputerName $srv2</code> пинг с удаленного компьютера<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Test-PingNetwork</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-parameter z-attribute z-powershell">ValueFromPipeline</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">ValidateRange</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-constant z-numeric z-integer z-powershell">100</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">10000</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timeout</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Net.NetworkInformation.Ping
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>0$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>net</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>r</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>net</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>network</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>r</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>net</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping<span class="z-variable z-other z-member z-powershell">.Send</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeout</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Address<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.+\.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> Status
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Test-PingNetwork -Network 192.168.3.0</code> <br> <code>Test-PingNetwork -Network 192.168.3.0 -Timeout 1000</code><p><code>Get-CimInstance -Class Win32_PingStatus -Filter "Address='127.0.0.1'"</code> <br> <code>Get-CimInstance -Class Win32_PingStatus -Filter "Address='127.0.0.1'" | Format-Table -Property Address,ResponseTime,StatusCode -Autosize</code> 0 - успех <br> <code>'127.0.0.1','8.8.8.8' | ForEach-Object -Process {Get-CimInstance -Class Win32_PingStatus -Filter ("Address='$_'") | Select-Object -Property Address,ResponseTime,StatusCode}</code> <br> <code>$ips = 1..254 | ForEach-Object -Process {'192.168.1.' + $_}</code> сформировать массив из ip-адресов подсети<h3 id=dhcp><a aria-label="Anchor link for: dhcp" class=zola-anchor href=#dhcp><i class=icon></i></a> dhcp</h3><p><code>Get-CimInstance -Class Win32_NetworkAdapterConfiguration -Filter "DHCPEnabled=$true"</code> отобразить адаптеры с включенным DHCP <br> <code>$wql = 'SELECT * from Win32_NetworkAdapterConfiguration WHERE IPEnabled=True and DHCPEnabled=False'</code> <br> <code>Invoke-CimMethod -MethodName ReleaseDHCPLease -Query $wql</code> включение DHCP на всех адаптерах <br> <code>Invoke-CimMethod -ClassName Win32_NetworkAdapterConfiguration -MethodName ReleaseDHCPLeaseAll</code> отменить аренду адресов DHCP на всех адаптерах <br> <code>Invoke-CimMethod -ClassName Win32_NetworkAdapterConfiguration -MethodName RenewDHCPLeaseAll</code> обновить аренду адресов DHCP на всех адаптерах<h3 id=port><a aria-label="Anchor link for: port" class=zola-anchor href=#port><i class=icon></i></a> port</h3><p><code>tnc $srv -p 5985</code> <br> <code>tnc $srv -CommonTCPPort WINRM</code> HTTP,RDP,SMB <br> <code>tnc ya.ru –TraceRoute -Hops 2</code> TTL=2 <br> <code>tnc ya.ru -DiagnoseRouting</code> маршрутизация до хоста, куда (DestinationPrefix: 0.0.0.0/0) через (NextHop: 192.168.1.254)<h3 id=netstat><a aria-label="Anchor link for: netstat" class=zola-anchor href=#netstat><i class=icon></i></a> netstat</h3><p><code>netstat -anop tcp</code> -n/-f/-b <br> <code>Get-NetTCPConnection -State Established,Listen | ? LocalPort -Match 3389</code> <br> <code>Get-NetTCPConnection -State Established,Listen | ? RemotePort -Match 22</code> <br> <code>Get-NetUDPEndpoint | ? LocalPort -Match 514</code> netstat -ap udp`<h3 id=nslookup><a aria-label="Anchor link for: nslookup" class=zola-anchor href=#nslookup><i class=icon></i></a> nslookup</h3><p><code>nslookup ya.ru 1.1.1.1</code> с указанием DNS сервера <br> <code>nslookup -type=any ya.ru</code> указать тип записи <br> <code>Resolve-DnsName ya.ru -Type MX</code> ALL,ANY,A,NS,SRV,CNAME,PTR,TXT(spf) <br> <code>[System.Net.Dns]::GetHostEntry("ya.ru")</code><h3 id=ipconfig><a aria-label="Anchor link for: ipconfig" class=zola-anchor href=#ipconfig><i class=icon></i></a> ipconfig</h3><p><code>Get-NetIPConfiguration</code> <br> <code>Get-NetIPConfiguration -InterfaceIndex 14 -Detailed</code><h3 id=adapter><a aria-label="Anchor link for: adapter" class=zola-anchor href=#adapter><i class=icon></i></a> Adapter</h3><p><code>Get-NetAdapter</code> <br> <code>Set-NetIPInterface -InterfaceIndex 14 -Dhcp Disabled</code> отключить DHCP <br> <code>Get-NetAdapter -InterfaceIndex 14 | New-NetIPAddress –IPAddress 192.168.3.99 -DefaultGateway 192.168.3.1 -PrefixLength 24</code> задать/добавить статический IP-адрес <br> <code>Set-NetIPAddress -InterfaceIndex 14 -IPAddress 192.168.3.98</code> изменить IP-адреас на адаптере <br> <code>Remove-NetIPAddress -InterfaceIndex 14 -IPAddress 192.168.3.99</code> удалить IP-адрес на адаптере <br> <code>Set-NetIPInterface -InterfaceIndex 14 -Dhcp Enabled</code> включить DHCP<h3 id=dnsclient><a aria-label="Anchor link for: dnsclient" class=zola-anchor href=#dnsclient><i class=icon></i></a> DNSClient</h3><p><code>Get-DNSClientServerAddress</code> список интерфейсов и настроенные на них адреса DNS сервера <br> <code>Set-DNSClientServerAddress -InterfaceIndex 14 -ServerAddresses 8.8.8.8</code> изменить адрес DNS сервера на указанного интерфейсе<h3 id=dnscache><a aria-label="Anchor link for: dnscache" class=zola-anchor href=#dnscache><i class=icon></i></a> DNSCache</h3><p><code>Get-DnsClientCache</code> отобразить кэшированные записи клиента DNS <br> <code>Clear-DnsClientCache</code> очистить кэш<h3 id=binding><a aria-label="Anchor link for: binding" class=zola-anchor href=#binding><i class=icon></i></a> Binding</h3><p><code>Get-NetAdapterBinding -Name Ethernet -IncludeHidden -AllBindings</code> <br> <code>Get-NetAdapterBinding -Name "Беспроводная сеть" -DisplayName "IP версии 6 (TCP/IPv6)" | Set-NetAdapterBinding -Enabled $false</code> отключить IPv6 на адаптере<h3 id=tcpsetting><a aria-label="Anchor link for: tcpsetting" class=zola-anchor href=#tcpsetting><i class=icon></i></a> TCPSetting</h3><p><code>Get-NetTCPSetting</code> <br> <code>Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -CongestionProvider DCTCP</code> настраивает провайдера управления перегрузкой (Congestion Control Provider) на DCTCP (Data Center TCP) для профилей TCP с именами DatacenterCustom и Datacenter <br> <code>Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -CwndRestart True</code> включает функцию перезапуска окна перегрузки (Congestion Window Restart, CwndRestart) для указанных профилей TCP. Это означает, что после периода идле (когда нет передачи данных) TCP окно перегрузки будет сбрасываться <br> <code>Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -ForceWS Disabled</code> отключает принудительное масштабирование окна (Forced Window Scaling) для указанных профилей TCP. Масштабирование окна — это механизм, который позволяет увеличивать размер окна перегрузки TCP, чтобы улучшить производительность передачи данных по сети с высокой пропускной способностью и большой задержкой<h3 id=hostname><a aria-label="Anchor link for: hostname" class=zola-anchor href=#hostname><i class=icon></i></a> hostname</h3><p><code>$env:computername</code> <br> <code>hostname.exe</code> <br> <code>(Get-CIMInstance CIM_ComputerSystem).Name</code> <br> <code>(New-Object -ComObject WScript.Network).ComputerName</code> <br> <code>[System.Environment]::MachineName</code> <br> <code>[System.Net.Dns]::GetHostName()</code><h3 id=arp><a aria-label="Anchor link for: arp" class=zola-anchor href=#arp><i class=icon></i></a> arp</h3><p><code>ipconfig /all | Select-String "физ"</code> grep <br> <code>Get-NetNeighbor -AddressFamily IPv4</code><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-ARP</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>proxy</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>search</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-unary z-powershell">!</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>proxy</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>arp</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> arp <span class="z-keyword z-operator z-assignment z-powershell">-</span>a
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>proxy</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>arp</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> icm <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>proxy</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> arp <span class="z-keyword z-operator z-assignment z-powershell">-</span>a <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>arp</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">260</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>^\s\s<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\s{1,50}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span> <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac_coll</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Object</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>m</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>smac</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>m</span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span> <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac_coll<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">IP</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>smac</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">MAC</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>smac</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>smac</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>search</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>search</span> <span class="z-keyword z-operator z-comparison z-powershell">-NotMatch</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>$ns = nslookup $search<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>$ns = $ns[-2]<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>$global:ns = $ns -replace "Address:\s{1,10}"<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rdns</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Resolve-DnsName</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>search</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ErrorAction Ignore
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ns</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rdns<span class="z-variable z-other z-member z-powershell">.IPAddress</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ns</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-keyword z-control z-powershell">return</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ns</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>search</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac_coll</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac_coll</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">?</span> ip <span class="z-keyword z-operator z-comparison z-powershell">-Match</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ns</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac_coll</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Get-ARP -search 192.168.3.100</code> <br> <code>Get-ARP -search 192.168.3.100 -proxy dc-01</code><h3 id=network-adapter-statistics><a aria-label="Anchor link for: network-adapter-statistics" class=zola-anchor href=#network-adapter-statistics><i class=icon></i></a> Network Adapter Statistics</h3><p><code>netstat -se</code> <br> <code>Get-NetAdapterStatistics</code><h3 id=speedtest><a aria-label="Anchor link for: speedtest" class=zola-anchor href=#speedtest><i class=icon></i></a> SpeedTest</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-SpeedTestOokla</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Server</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">3682</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>List</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>TEMP</span>\speedtest.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>testPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Test-Path</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>TEMP</span>\speedtest.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>testPath</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Invoke-RestMethod</span> https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>install.speedtest.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>app<span class="z-keyword z-operator z-assignment z-powershell">/</span>cli<span class="z-keyword z-operator z-assignment z-powershell">/</span>ookla<span class="z-keyword z-operator z-assignment z-powershell">-</span>speedtest<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1.2</span>.<span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>win64.zip <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>TEMP</span>\speedtest.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>TEMP</span>\speedtest.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>DestinationPath <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>TEMP</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>List</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-keyword z-operator z-other z-powershell">&</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>L <span class="z-keyword z-operator z-string-format z-powershell">-f</span> json <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.servers
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-keyword z-operator z-other z-powershell">&</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>s <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Server</span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> json
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Object</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">            <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Date</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.timestamp
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.result.url
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Download</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">double</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Round<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.download.bandwidth <span class="z-keyword z-operator z-assignment z-powershell">/</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-other z-powershell">mb</span> <span class="z-keyword z-operator z-assignment z-powershell">*</span> <span class="z-constant z-numeric z-integer z-powershell">8</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Upload</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">double</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Round<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.upload.bandwidth <span class="z-keyword z-operator z-assignment z-powershell">/</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-other z-powershell">mb</span> <span class="z-keyword z-operator z-assignment z-powershell">*</span> <span class="z-constant z-numeric z-integer z-powershell">8</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Ping</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.ping.latency
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Internal_IP</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.interface.internalIp
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">External_IP</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.interface.externalIp
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Server</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.server
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h2 id=iperf><a aria-label="Anchor link for: iperf" class=zola-anchor href=#iperf><i class=icon></i></a> iPerf</h2><h3 id=install><a aria-label="Anchor link for: install" class=zola-anchor href=#install><i class=icon></i></a> Install</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">api.github.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>repos<span class="z-keyword z-operator z-assignment z-powershell">/</span>ar51an<span class="z-keyword z-operator z-assignment z-powershell">/</span>iperf3<span class="z-keyword z-operator z-assignment z-powershell">-</span>win<span class="z-keyword z-operator z-assignment z-powershell">-</span>builds<span class="z-keyword z-operator z-assignment z-powershell">/</span>releases<span class="z-keyword z-operator z-assignment z-powershell">/</span>latest<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.assets <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> name <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>win64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.browser_download_url
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\iperf.zip
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\iperf3<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Type Directory <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-Null</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\iperf.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutputPath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\iperf3<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\iperf*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span></code></pre><p><code>& "$home\Documents\iperf3\iperf3.exe" -h</code><h3 id=env-update-exec-path><a aria-label="Anchor link for: env-update-exec-path" class=zola-anchor href=#env-update-exec-path><i class=icon></i></a> Env-Update-Exec-Path</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EnvPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Environment</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetEnvironmentVariable<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Path<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">EnvironmentVariableTarget</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Machine</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EnvPath</span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>iperfPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\iperf3\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EnvAddPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EnvPath</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>iperfPath</span>
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Environment</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::SetEnvironmentVariable<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Path<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EnvAddPath</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">EnvironmentVariableTarget</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Machine</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Environment</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetEnvironmentVariable<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Path<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">EnvironmentVariableTarget</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Machine</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre><p><code>iperf3 -h</code><h3 id=iperf-gui><a aria-label="Anchor link for: iperf-gui" class=zola-anchor href=#iperf-gui><i class=icon></i></a> iPerf-GUI</h3><p><code>Invoke-RestMethod "https://github.com/Lifailon/iPerf-GUI/raw/rsa/iPerf-GUI-Install.exe" -OutFile "$home\Downloads\iPerf-GUI-Install.exe"</code> скачать установочную версию собранную с помощью WinRAR <br> <code>Start-Process -FilePath "$home\Downloads\iPerf-GUI-Install.exe" -ArgumentList "/S" -NoNewWindow -Wait</code> установить в тихом режиме<h3 id=iperf-docker><a aria-label="Anchor link for: iperf-docker" class=zola-anchor href=#iperf-docker><i class=icon></i></a> iPerf-Docker</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell">echo <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">FROM alpine:latest
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">RUN apk update && apk add --no-cache iperf3
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">ENV PORT=5201
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">EXPOSE $PORT
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">CMD ["sh", "-c", "iperf3 -s -p $PORT"]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-redirection z-powershell">></span> Dockerfile
</span></code></pre><p><code>docker build -t iperf3-alpine-server .</code> <br> <code>docker run -d -p 5201:5201 --name iperf3-alpine-server iperf3-alpine-server</code><h3 id=server><a aria-label="Anchor link for: server" class=zola-anchor href=#server><i class=icon></i></a> Server</h3><p><code>iperf3 -s</code> запуск сервера <br> <code>iperf3 -s -D</code> запустить сервер в фоновом режиме как службу (–daemon) <br> <code>Get-NetTCPConnection -State Established,Listen | ? LocalPort -Match 5201</code> проверить, что порт сервера слушает <br> <code>Get-Process -Id $(Get-NetTCPConnection -State Established,Listen | ? LocalPort -Match 5201).OwningProcess</code> получить процесс по порту <br> <code>Get-Process iperf3 | Stop-Process</code> остановить процесс <br> <code>iperf3 -s -D --logfile "$home\Documents\iperf3\iperf3.log"</code> перенаправить вывод в лог файл <br> <code>iperf3 -s -p 5211</code> указать порт, на котором будет слушать сервер или отправлять запросы клиент <br> <code>iperf3 -s -p 5211 -f M</code> изменить формат выводимых данных (измерять в байтах а не в битах, доступные значения: K,M,G,T) <br> <code>iperf3 -s -p 5211 -f M -J</code> вывод в формате json <br> <code>iperf3 -s -p 5211 -f M -V</code> вывод подробной информации<h3 id=client><a aria-label="Anchor link for: client" class=zola-anchor href=#client><i class=icon></i></a> Client</h3><p><code>iperf3 -c 192.168.3.100 -p 5211</code> подключение к серверу (по умолчанию проверяется отдача на сервер с клиента) <br> <code>iperf3 -c 192.168.3.100 -p 5211 -R</code> обратный тест, проверка скачивания с сервера (–reverse, сервер отправляет данные клиенту) <br> <code>iperf3 -c 192.168.3.100 -p 5211 -R -P 2</code> количество одновременных потоков ([SUM] - суммарная скорость нескольки потоков) <br> <code>iperf3 -c 192.168.3.100 -p 5211 -R -4</code> использовать только IPv4 <br> <code>iperf3 -c 192.168.3.100 -p 5211 -R -u</code> использовать UDP вместо TCP <br> <code>iperf3 -c 192.168.3.100 -p 5211 -R -u -b 2mb</code> установить битрейт в 2.00 Mbits/sec для UDP (по умолчанию 1 Мбит/сек, для TCP не ограничено) <br> <code>iperf3 -c 192.168.3.100 -p 5211 -R -t 30</code> время одного теста в секундах (по умолчанию 10 секунд) <br> <code>iperf3 -c 192.168.3.100 -p 5211 -R -n 1gb</code> указать объем данных для проверки (применяется вместо времени -t) <br> <code>iperf3 -c 192.168.3.100 -p 5211 -R --get-server-output</code> вывести вывод сервера на клиенте<h3 id=output><a aria-label="Anchor link for: output" class=zola-anchor href=#output><i class=icon></i></a> Output</h3><p><code>sender</code> upload (скорость передачи на удаленный сервер) <br> <code>receiver</code> download (скорость скачивания с удаленного сервера) <br> <code>Interval</code> общее время сканирования <br> <code>Transfer</code> кол-во переданных и полученных МБайт <br> <code>Bandwidth</code> скорость передачи (измеряется в Мбит/c)<h3 id=ps-iperf><a aria-label="Anchor link for: ps-iperf" class=zola-anchor href=#ps-iperf><i class=icon></i></a> PS-iPerf</h3><p><code>Install-Module ps-iperf -Repository NuGet</code> <br> <code>Import-Module PS-iPerf</code> <br> <code>Start-iPerfServer -Port 5211</code> запустить сервер <br> <code>Get-iPerfServer</code> статус работы сервера <br> <code>Stop-iPerfServer</code> остановить сервер <br> <code>Connect-iPerfServer -Server 192.168.3.100 -Port 5211 -MBytes 500 -Download</code> подключиться к серверу и скачать 500 МБайт <br> <code>$SpeedTest = Connect-iPerfServer -Server 192.168.3.100 -Port 5211 -MBytes 500 -LogWrite</code> передать 500 МБайт на сервер (вести запись в лог-файл) <br> <code>$SpeedTest.Intervals</code> метрики измерений <br> <code>Get-iPerfLog</code> прочитать лог-файл<h2 id=rdp><a aria-label="Anchor link for: rdp" class=zola-anchor href=#rdp><i class=icon></i></a> RDP</h2><p><code>Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "PortNumber"</code> отобразить номер текущего RDP порта <br> <code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "PortNumber" -Value "3390"</code> изменить RDP-порт <br> <code>$(Get-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server\" -Name "fDenyTSConnections").fDenyTSConnections</code> если 0, то включен <br> <code>Set-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server\" -Name "fDenyTSConnections" -Value 0</code> включить RDP <br> <code>reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f</code> <br> <code>(gcim -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).SetAllowTSConnections(0)</code> включить RDP (для Windows Server) <br> <code>Get-Service TermService | Restart-Service -Force</code> перезапустить rdp-службу <br> <code>New-NetFirewallRule -Profile Any -DisplayName "RDP 3390" -Direction Inbound -Protocol TCP -LocalPort 3390</code> открыть RDP-порт<h3 id=ipban><a aria-label="Anchor link for: ipban" class=zola-anchor href=#ipban><i class=icon></i></a> IPBan</h3><p><code>auditpol /get /category:*</code> отобразить все политики аудита <br> <code>auditpol /get /category:Вход/выход</code> отобразить локальные политики аудита для Входа и Выхода из системы <br> <code>auditpol /set /subcategory:"Вход в систему" /success:enable /failure:enable</code> включить локальные политики - Аудит входа в систему <br> <code>auditpol /set /subcategory:"Выход из системы" /success:enable /failure:enable</code><p><code>$url = $($(Invoke-RestMethod https://api.github.com/repos/DigitalRuby/IPBan/releases/latest).assets | Where-Object name -match ".+win.+x64.+").browser_download_url</code> получить ссылку для загрузки последней версии <br> <code>$version = $(Invoke-RestMethod https://api.github.com/repos/DigitalRuby/IPBan/releases/latest).tag_name</code> получить номер последней версии <br> <code>$path = "$home\Documents\ipban-$version"</code> путь для установки <br> <code>Invoke-RestMethod $url -OutFile "$home\Downloads\IPBan-$version.zip"</code> скачать дистрибутив <br> <code>Expand-Archive "$home\Downloads\ipban-$version.zip" -DestinationPath $path</code> разархивировать в путь для установки <br> <code>Remove-Item "$home\Downloads\ipban-$version.zip"</code> удалить дистрибутив <br> <code>sc create IPBan type=own start=delayed-auto binPath="$path\DigitalRuby.IPBan.exe" DisplayName=IPBan</code> создать службу <br> <code>Get-Service IPBan</code> статус службы <br> <code>$conf = $(Get-Content "$path\ipban.config")</code> читаем конфигурацию <br> <code>$conf = $conf -replace '&LTadd key="Whitelist" value=""/>','&LTadd key="Whitelist" value="192.168.3.0/24"/>'</code> добавить в белый лист домашнюю сеть для исключения <br> <code>$conf = $conf -replace '&LTadd key="ProcessInternalIPAddresses" value="false"/>','&LTadd key="ProcessInternalIPAddresses" value="true"/>'</code> включить обработку локальных (внутренних) ip-адресов <br> <code>$conf = $conf -replace '&LTadd key="FailedLoginAttemptsBeforeBanUserNameWhitelist" value="20"/>','&LTadd key="FailedLoginAttemptsBeforeBanUserNameWhitelist" value="5"/>'</code> указать количество попыток подключения до блокировки <br> <code>$conf = $conf -replace '&LTadd key="ExpireTime" value="01:00:00:00"/>','&LTadd key="ExpireTime" value="00:01:00:00"/>'</code> задать время блокировки 1 час <br> <code>$conf > "$path\ipban.config"</code> обновить конфигурацию <br> <code>Get-Service IPBan | Start-Service</code> запустить службу<pre class=z-code><code><span class="z-text z-plain">Get-NetFirewallRule | Where-Object DisplayName -Match "IPBan" | ForEach-Object {
</span><span class="z-text z-plain">    $Name = $_.DisplayName
</span><span class="z-text z-plain">    Get-NetFirewallAddressFilter -AssociatedNetFirewallRule $_ | Select-Object @{Name="Name"; Expression={$Name}},LocalIP,RemoteIP
</span><span class="z-text z-plain">} # отобразить область применения правил Брандмауэра для IPBan
</span></code></pre><p><code>Get-Content -Wait "$path\logfile.txt"</code> читать лог <br> <code>Get-Service IPBan | Stop-Service</code> остановить службу <br> <code>sc delete IPBan</code> удалить службу<h2 id=shutdown><a aria-label="Anchor link for: shutdown" class=zola-anchor href=#shutdown><i class=icon></i></a> shutdown</h2><p><code>shutdown /r /o</code> перезагрузка в безопасный режим <br> <code>shutdown /s /t 600 /c "Power off after 10 minutes"</code> выключение <br> <code>shutdown /s /f</code> принудительное закрытие приложений <br> <code>shutdown /a</code> отмена <br> <code>shutdown /r /t 0 /m \\192.168.3.100</code> <br> <code>Restart-Computer -ComputerName 192.168.3.100 -Protocol WSMan</code> через WinRM <br> <code>Restart-Computer –ComputerName 192.168.3.100 –Force</code> через WMI <br> <code>Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\Start\HideShutDown" -Name "value" -Value 1</code> скрыть кнопку выключения <br> <code>Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\Start\HideRestart" -Name "value" -Value 1</code> скрыть кнопку перезагрузки<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-Shutdown</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-block z-powershell"><span class="z-punctuation z-definition z-comment z-block z-begin z-powershell"><#</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">SYNOPSIS</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    Module for shutdown and restart the computer at a specified time
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">DESCRIPTION</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    Example:
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    # Start-Shutdown -Time "18:00"
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    # Start-Shutdown -Restart -Time "18:00"
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    # Start-Shutdown -Cancel
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">LINK</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    https://github.com/Lifailon/PS-Commands
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    <span class="z-punctuation z-definition z-comment z-block z-end z-powershell">#></span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Time</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Restart</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cancel</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Time</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>currentDateTime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Date</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>shutdownTime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Date</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Time</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>shutdownTime</span> <span class="z-keyword z-operator z-comparison z-powershell">-lt</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>currentDateTime</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>shutdownTime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>shutdownTime<span class="z-variable z-other z-member z-powershell">.AddDays</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeUntilShutdown</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>shutdownTime</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>currentDateTime</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>secondsUntilShutdown</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">math</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Round<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeUntilShutdown<span class="z-variable z-other z-member z-powershell">.TotalSeconds</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cancel</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Start-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>shutdown.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/a<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Restart</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>The computer will restart after <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeUntilShutdown<span class="z-variable z-other z-member z-powershell">.Hours</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> hours and <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeUntilShutdown<span class="z-variable z-other z-member z-powershell">.Minutes</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> minutes.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Start-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>shutdown.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/r<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/f<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/t<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>secondsUntilShutdown</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>The computer will shutdown after <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeUntilShutdown<span class="z-variable z-other z-member z-powershell">.Hours</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> hours and <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeUntilShutdown<span class="z-variable z-other z-member z-powershell">.Minutes</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> minutes.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Start-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>shutdown.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/s<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/f<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/t<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>secondsUntilShutdown</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h2 id=localaccounts><a aria-label="Anchor link for: localaccounts" class=zola-anchor href=#localaccounts><i class=icon></i></a> LocalAccounts</h2><p><code>Get-Command -Module Microsoft.PowerShell.LocalAccounts</code> <br> <code>Get-LocalUser</code> список пользователей <br> <code>Get-LocalGroup</code> список групп <br> <code>New-LocalUser "1C" -Password $Password -FullName "1C Domain"</code> создать пользователя <br> <code>Set-LocalUser -Password $Password 1C</code> изменить пароль <br> <code>Add-LocalGroupMember -Group "Administrators" -Member "1C"</code> добавить в группу Администраторов <br> <code>Get-LocalGroupMember "Administrators"</code> члены группы<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>vproxy-01<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>vproxy-02<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>vproxy-03<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">%</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    icm <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Add-LocalGroupMember</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Group <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Administrators<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Member <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>support4<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    icm <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Get-LocalGroupMember</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Administrators<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h2 id=smb><a aria-label="Anchor link for: smb" class=zola-anchor href=#smb><i class=icon></i></a> SMB</h2><p><code>Get-SmbServerConfiguration</code> <br> <code>Set-SmbServerConfiguration -EnableSMB1Protocol $false -Force</code> отключить протокол SMB v1 <br> <code>Get-WindowsFeature | Where-Object {$_.name -eq "FS-SMB1"} | ft Name,Installstate</code> модуль ServerManager, проверить установлен ли компонент SMB1 <br> <code>Install-WindowsFeature FS-SMB1</code> установить SMB1 <br> <code>Uninstall-WindowsFeature –Name FS-SMB1 –Remove</code> удалить SMB1 клиента (понадобится перезагрузка) <br> <code>Get-WindowsOptionalFeature -Online</code> модуль DISM, для работы с компонентами Windows <br> <code>Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol -Remove</code> удалить SMB1 <br> <code>Set-SmbServerConfiguration –AuditSmb1Access $true</code> включить аудит SMB1 <br> <code>Get-SmbConnection</code> список активных сессий и используемая версия SMB (Dialect) <br> <code>Get-SmbOpenFile | select ClientUserName,ClientComputerName,Path,SessionID</code> список открытых файлов <br> <code>Get-SmbShare</code> список сетевых папок <br> <code>New-SmbShare -Name xl-share -Path E:\test</code> создать новую общую сетевую папку (расшарить) <br> <code>-EncryptData $True</code> включить шифрование SMB <br> <code>-Description</code> имя в сетевом окружении <br> <code>-ReadAccess "domain\username"</code> доступ на чтение <br> <code>-ChangeAccess</code> доступ на запись <br> <code>-FullAccess</code> полный доступ <br> <code>-NoAccess ALL</code> нет прав <br> <code>-FolderEnumerationMode [AccessBased | Unrestricted]</code> позволяет скрыть в сетевой папке объекты, на которых у пользователя нет доступа с помощью Access-Based Enumeration (ABE) <br> <code>Get-SmbShare xl-share | Set-SmbShare -FolderEnumerationMode AccessBased</code> ключить ABE для всех расшаренных папок <br> <code>Remove-SmbShare xl-share -force</code> удалить сетевой доступ (шару) <br> <code>Get-SmbShareAccess xl-share</code> вывести список доступов безопасности к шаре <br> <code>Revoke-SmbShareAccess xl-share -AccountName Everyone –Force</code> удалить группу из списка доступов <br> <code>Grant-SmbShareAccess -Name xl-share -AccountName "domain\XL-Share" -AccessRight Change –force</code> изменить/добавить разрешения на запись (Full,Read) <br> <code>Grant-SmbShareAccess -Name xl-share -AccountName "все" -AccessRight Change –force</code> <br> <code>Block-SmbShareAccess -Name xl-share -AccountName "domain\noAccess" -Force</code> принудительный запрет <br> <code>New-SmbMapping -LocalPath X: -RemotePath \\$srv\xl-share -UserName support4 -Password password –Persistent $true</code> подключить сетевой диск <br> <code>-Persistent</code> восстановление соединения после отключения компьютера или сети <br> <code>-SaveCredential</code> позволяет сохранить учетные данные пользователя для подключения в диспетчер учетных данных Windows Credential Manager <br> <code>Stop-Process -Name "explorer" | Start-Process -FilePath "C:\Windows\explorer.exe"</code> перезапустить процесс для отображения в проводнике <br> <code>Get-SmbMapping</code> список подключенных сетевых дисков <br> <code>Remove-SmbMapping X: -force</code> отмонтировать сетевой диск <br> <code>$CIMSession = New-CIMSession –Computername $srv</code> создать сеанс CIM (аудентификация на SMB) <br> <code>Get-SmbOpenFile -CIMSession $CIMSession | select ClientUserName,ClientComputerName,Path | Out-GridView -PassThru | Close-SmbOpenFile -CIMSession $CIMSession -Confirm:$false –Force</code> закрыть файлы (открыть к ним сетевой доступ)<h3 id=get-acl><a aria-label="Anchor link for: get-acl" class=zola-anchor href=#get-acl><i class=icon></i></a> Get-Acl</h3><p><code>(Get-Acl \\$srv\xl-share).access</code> доступ ACL на уровне NTFS <br> <code>Get-Acl C:\Drivers | Set-Acl C:\Distr</code> скопировать NTFS разрешения с одной папки и применить их на другую<h3 id=ntfssecurity><a aria-label="Anchor link for: ntfssecurity" class=zola-anchor href=#ntfssecurity><i class=icon></i></a> NTFSSecurity</h3><p><code>Install-Module -Name NTFSSecurity -force</code> <br> <code>Get-Item "\\$srv\xl-share" | Get-NTFSAccess</code> <br> <code>Add-NTFSAccess -Path "\\$srv\xl-share" -Account "domain\xl-share" -AccessRights Fullcontrol -PassThru</code> добавить <br> <code>Remove-NTFSAccess -Path "\\$srv\xl-share" -Account "domain\xl-share" -AccessRights FullControl -PassThru</code> удалить <br> <code>Get-ChildItem -Path "\\$srv\xl-share" -Recurse -Force | Clear-NTFSAccess</code> удалить все разрешения, без удаления унаследованных разрешений <br> <code>Get-ChildItem -Path "\\$srv\xl-share" -Recurse -Force | Enable-NTFSAccessInheritance</code> включить NTFS наследование для всех объектов в каталоге<h3 id=storage><a aria-label="Anchor link for: storage" class=zola-anchor href=#storage><i class=icon></i></a> Storage</h3><p><code>Get-Command -Module Storage</code> <br> <code>Get-Disk</code> список логических дисков <br> <code>Get-Partition</code> отобразить разделы на всех дисках <br> <code>Get-Volume</code> список логичких разделов <br> <code>Get-PhysicalDisk</code> список физических дисков <br> <code>Initialize-Disk 1 –PartitionStyle MBR</code> инициализировать диск <br> <code>New-Partition -DriveLetter D –DiskNumber 1 -Size 500gb</code> создать раздел (выделить все место -UseMaximumSize) <br> <code>Format-Volume -DriveLetter D -FileSystem NTFS -NewFileSystemLabel Disk-D</code> форматировать раздел <br> <code>Set-Partition -DriveLetter D -IsActive $True</code> сделать активным <br> <code>Remove-Partition -DriveLetter D –DiskNumber 1</code> удалить раздел <br> <code>Clear-Disk -Number 1 -RemoveData</code> очистить диск <br> <code>Repair-Volume –driveletter C –Scan</code> Check disk <br> <code>Repair-Volume –driveletter C –SpotFix</code> <br> <code>Repair-Volume –driverletter C -Scan –Cimsession $CIMSession</code><h3 id=iscsi><a aria-label="Anchor link for: iscsi" class=zola-anchor href=#iscsi><i class=icon></i></a> iSCSI</h3><p><code>New-IscsiVirtualDisk -Path D:\iSCSIVirtualDisks\iSCSI2.vhdx -Size 20GB</code> создать динамический vhdx-диск (для фиксированного размера -UseFixed) <br> <code>New-IscsiServerTarget -TargetName iscsi-target-2 -InitiatorIds "IQN:iqn.1991-05.com.microsoft:srv3.contoso.com"</code> создать Target <br> <code>Get-IscsiServerTarget | fl TargetName, LunMappings</code> <br> <code>Connect-IscsiTarget -NodeAddress "iqn.1995-05.com.microsoft:srv2-iscsi-target-2-target" -IsPersistent $true</code> подключиться инициатором к таргету <br> <code>Get-IscsiTarget | fl</code> <br> <code>Disconnect-IscsiTarget -NodeAddress "iqn.1995-05.com.microsoft:srv2-iscsi-target-2-target" -Confirm:$false</code> отключиться<h2 id=wsus><a aria-label="Anchor link for: wsus" class=zola-anchor href=#wsus><i class=icon></i></a> WSUS</h2><p><code>Get-Hotfix | Sort-Object -Descending  InstalledOn</code> список установленных обновлений (информация из cimv2) <br> <code>Get-Hotfix -Description "Security update"</code> <br> <code>Get-CimInstance Win32_QuickFixEngineering</code> <br> <code>Get-Service uhssvc</code> служба Microsoft Health Update Tools, которая отвечает за предоставление обновлений<h3 id=windowsupdate><a aria-label="Anchor link for: windowsupdate" class=zola-anchor href=#windowsupdate><i class=icon></i></a> WindowsUpdate</h3><p><code>Get-Command -Module WindowsUpdate</code> <br> <code>Get-WindowsUpdateLog</code> формирует отчет в $home\AppData\Local\Temp\WindowsUpdateLog в формате csv<h3 id=pswindowsupdate><a aria-label="Anchor link for: pswindowsupdate" class=zola-anchor href=#pswindowsupdate><i class=icon></i></a> PSWindowsUpdate</h3><p><code>Install-Module -Name PSWindowsUpdate -Scope CurrentUser</code> <br> <code>Import-Module PSWindowsUpdate</code> <br> <code>Get-Command -Module PSWindowsUpdate</code> <br> <code>Get-WindowsUpdate</code> список обновлений для скачать и установить с сервера WSUS или Microsoft Update <br> <code>Get-WindowsUpdate -Download</code> загрузить все обновления <br> <code>Get-WindowsUpdate –Install</code> установить все обновления <br> <code>Install-WindowsUpdate -MicrosoftUpdate -AcceptAll -IgnoreReboot</code> установить все обновления без перезагрузки <br> <code>Get-WindowsUpdate -KBArticleID KB2267602, KB4533002 -Install</code> <br> <code>Get-WindowsUpdate -KBArticleID KB2538243 -Hide</code> скрыть обновления, что бы они никогда не устанавливались <br> <code>Get-WindowsUpdate –IsHidden</code> отобразить скрытые обновления (Hide-WindowsUpdate) <br> <code>Remove-WindowsUpdate -KBArticleID KB4011634 -NoRestart</code> удалить обновление <br> <code>Uninstall-WindowsUpdate</code> удалить обновление <br> <code>Add-WUServiceManager</code> регистрация сервера обновления (Windows Update Service Manager) <br> <code>Enable-WURemoting</code> включить правила Windows Defender, разрешающие удаленное использование командлета PSWindowsUpdate <br> <code>Get-WUApiVersion</code> версия Windows Update Agent <br> <code>Get-WUHistory</code> список всех установленных обновлений (история обновлений) <br> <code>Get-WUHistory | Where-Object {$_.Title -match "KB4517389"}</code> поиск обновления <br> <code>Get-WULastResults</code> даты последнего поиска и установки обновлений <br> <code>Get-WURebootStatus</code> проверить, нужна ли перезагрузка для применения конкретного обновления <br> <code>Get-WUServiceManager</code> выводит источники обновлений <br> <code>Get-WUInstallerStatus</code> статус службы Windows Installer <br> <code>Remove-WUServiceManager</code> отключить Windows Update Service Manager<h3 id=updateservices><a aria-label="Anchor link for: updateservices" class=zola-anchor href=#updateservices><i class=icon></i></a> UpdateServices</h3><p><code>Install-WindowsFeature -Name UpdateServices-RSAT</code> установить роль UpdateServices <br> <code>$UpdateScope = New-Object Microsoft.UpdateServices.Administration.UpdateScope</code> <br> <code>[enum]::GetValues([Microsoft.UpdateServices.Administration.ApprovedStates])</code> список утвержденных состояний <br> <code>[enum]::GetValues([Microsoft.UpdateServices.Administration.UpdateInstallationStates])</code> статус установки (неизвестный, непригодный, не установлен, скачено, установлен, неуспешный, установлен и ожидает перезагрузки, все) <br> <code>$UpdateScope.ApprovedStates = [Microsoft.UpdateServices.Administration.ApprovedStates]"NotApproved"</code> выставляем статус не утвержденных обновлений на сервере WSUS <br> <code>$UpdateScope.IncludedInstallationStates = [Microsoft.UpdateServices.Administration.UpdateInstallationStates]"NotInstalled"</code> выставляем статус не установленных обновлений <br> <code>$UpdateScope.IncludedInstallationStates = [Microsoft.UpdateServices.Administration.UpdateInstallationStates]"NotInstalled,Downloaded"</code> обновления загружены, но не установлены<h3 id=poshwsus><a aria-label="Anchor link for: poshwsus" class=zola-anchor href=#poshwsus><i class=icon></i></a> PoshWSUS</h3><p><code>Install-Module -Name PoshWSUS</code> <br> <code>Get-Command -Module PoshWSUS</code> нужны права администратора <br> <code>Add-PSWSUSClientToGroup</code> добавление клиента в группу <br> <code>Approve-PSWSUSUpdate</code> утверждение обновления <br> <code>Connect-PSWSUSDatabaseServer</code> подключение к серверу базы данных WSUS <br> <code>Connect-PSWSUSServer</code> подключение к серверу WSUS <br> <code>Deny-PSWSUSUpdate</code> отклонение обновления <br> <code>Disconnect-PSWSUSServer</code> отключение от сервера WSUS <br> <code>Export-PSWSUSMetaData</code> экспорт метаданных WSUS <br> <code>Get-PoshWSUSSyncUpdateCategories</code> получение категорий обновлений для синхронизации <br> <code>Get-PoshWSUSSyncUpdateClassifications</code> получение классификаций обновлений для синхронизации <br> <code>Get-PSWSUSCategory</code> получение категории WSUS <br> <code>Get-PSWSUSChildServer</code> получение дочернего сервера WSUS <br> <code>Get-PSWSUSClassification</code> получение классификации WSUS <br> <code>Get-PSWSUSClient</code> получение информации о клиенте <br> <code>Get-PSWSUSClientGroupMembership</code> получение групповой принадлежности клиента <br> <code>Get-PSWSUSClientPerUpdate</code> получение информации о клиентах по обновлениям <br> <code>Get-PSWSUSClientsInGroup</code> получение клиентов в группе <br> <code>Get-PSWSUSCommand</code> получение информации о командах WSUS <br> <code>Get-PSWSUSConfig</code> получение конфигурации WSUS <br> <code>Get-PSWSUSConfigEnabledUpdateLanguages</code> получение включенных языков обновлений <br> <code>Get-PSWSUSConfigProxyServer</code> получение конфигурации прокси-сервера <br> <code>Get-PSWSUSConfigSupportedUpdateLanguages</code> получение поддерживаемых языков обновлений <br> <code>Get-PSWSUSConfigSyncSchedule</code> получение расписания синхронизации <br> <code>Get-PSWSUSConfigSyncUpdateCategories</code> получение категорий обновлений для синхронизации <br> <code>Get-PSWSUSConfigSyncUpdateClassifications</code> получение классификаций обновлений для синхронизации <br> <code>Get-PSWSUSConfigUpdateFiles</code> получение конфигурации файлов обновлений <br> <code>Get-PSWSUSConfigUpdateSource</code> получение источника обновлений <br> <code>Get-PSWSUSConfiguration</code> получение полной конфигурации WSUS <br> <code>Get-PSWSUSContentDownloadProgress</code> получение прогресса загрузки контента <br> <code>Get-PSWSUSCurrentUserRole</code> получение роли текущего пользователя <br> <code>Get-PSWSUSDatabaseConfig</code> получение конфигурации базы данных <br> <code>Get-PSWSUSDownstreamServer</code> получение конфигурации нижестоящего сервера <br> <code>Get-PSWSUSEmailConfig</code> получение конфигурации электронной почты <br> <code>Get-PSWSUSEnabledUpdateLanguages</code> получение включенных языков обновлений <br> <code>Get-PSWSUSEvent</code> получение событий WSUS <br> <code>Get-PSWSUSGroup</code> получение информации о группе <br> <code>Get-PSWSUSInstallableItem</code> получение информации об установленных элементах <br> <code>Get-PSWSUSInstallApprovalRule</code> получение правил утверждения установки <br> <code>Get-PSWSUSProxyServer</code> получение информации о прокси-сервере <br> <code>Get-PSWSUSServer</code> получение информации о сервере WSUS <br> <code>Get-PSWSUSStatus</code> получение статуса WSUS <br> <code>Get-PSWSUSSubscription</code> получение подписки WSUS <br> <code>Get-PSWSUSSupportedUpdateLanguages</code> получение поддерживаемых языков обновлений <br> <code>Get-PSWSUSSyncEvent</code> получение событий синхронизации <br> <code>Get-PSWSUSSyncHistory</code> получение истории синхронизаций <br> <code>Get-PSWSUSSyncProgress</code> получение прогресса синхронизации <br> <code>Get-PSWSUSSyncSchedule</code> получение расписания синхронизации <br> <code>Get-PSWSUSUpdate</code> получение информации об обновлении <br> <code>Get-PSWSUSUpdateApproval</code> получение информации об утверждении обновлений <br> <code>Get-PSWSUSUpdateCategory</code> получение категории обновлений <br> <code>Get-PSWSUSUpdateClassification</code> получение классификации обновлений <br> <code>Get-PSWSUSUpdateFile</code> получение файлов обновлений <br> <code>Get-PSWSUSUpdateFiles</code> получение списка файлов обновлений <br> <code>Get-PSWSUSUpdatePerClient</code> получение информации об обновлениях по клиентам <br> <code>Get-PSWSUSUpdateSource</code> получение источника обновлений <br> <code>Get-PSWSUSUpdateSummary</code> получение сводки по обновлениям <br> <code>Get-PSWSUSUpdateSummaryPerClient</code> получение сводки по обновлениям для каждого клиента <br> <code>Get-PSWSUSUpdateSummaryPerGroup</code> получение сводки по обновлениям для каждой группы <br> <code>Import-PSWSUSMetaData</code> импорт метаданных WSUS <br> <code>New-PSWSUSComputerScope</code> создание области охвата компьютеров <br> <code>New-PSWSUSGroup</code> создание новой группы <br> <code>New-PSWSUSInstallApprovalRule</code> создание правила утверждения установки <br> <code>New-PSWSUSUpdateScope</code> создание области охвата обновлений <br> <code>Remove-PSWSUSClient</code> удаление клиента <br> <code>Remove-PSWSUSClientFromGroup</code> удаление клиента из группы <br> <code>Remove-PSWSUSGroup</code> удаление группы <br> <code>Remove-PSWSUSInstallApprovalRule</code> удаление правила утверждения установки <br> <code>Remove-PSWSUSUpdate</code> удаление обновления <br> <code>Reset-PSWSUSContent</code> сброс контента WSUS <br> <code>Resume-PSWSUSDownload</code> возобновление загрузки <br> <code>Resume-PSWSUSUpdateDownload</code> возобновление загрузки обновлений <br> <code>Set-PoshWsusClassification</code> установка классификации WSUS <br> <code>Set-PoshWSUSProduct</code> установка продукта WSUS <br> <code>Set-PSWSUSConfigEnabledUpdateLanguages</code> установка включенных языков обновлений <br> <code>Set-PSWSUSConfigProduct</code> установка продукта конфигурации WSUS <br> <code>Set-PSWsusConfigProxyServer</code> установка прокси-сервера конфигурации WSUS <br> <code>Set-PSWSUSConfigSyncSchedule</code> установка расписания синхронизации <br> <code>Set-PSWSUSConfigTargetingMode</code> установка режима таргетирования <br> <code>Set-PSWSUSConfigUpdateClassification</code> установка классификации обновлений <br> <code>Set-PSWSUSConfigUpdateFiles</code> установка файлов обновлений <br> <code>Set-PSWSUSConfigUpdateSource</code> установка источника обновлений <br> <code>Set-PSWSUSEmailConfig</code> установка конфигурации электронной почты <br> <code>Set-PSWSUSEnabledUpdateLanguages</code> установка включенных языков обновлений <br> <code>Set-PSWSUSInstallApprovalRule</code> установка правила утверждения установки <br> <code>Set-PSWSUSProxyServer</code> установка прокси-сервера <br> <code>Set-PSWSUSSyncSchedule</code> установка расписания синхронизации <br> <code>Set-PSWSUSTargetingMode</code> установка режима таргетирования <br> <code>Set-PSWSUSUpdateFiles</code> установка файлов обновлений <br> <code>Set-PSWSUSUpdateSource</code> установка источника обновлений <br> <code>Start-PSWSUSCleanup</code> запуск очистки WSUS <br> <code>Start-PSWSUSInstallApprovalRule</code> запуск правила утверждения установки <br> <code>Start-PSWSUSSync</code> запуск синхронизации <br> <code>Stop-PSWSUSDownload</code> остановка загрузки <br> <code>Stop-PSWSUSSync</code> остановка синхронизации <br> <code>Stop-PSWSUSUpdateDownload</code> остановка загрузки обновлений <br> <code>Test-PSWSUSDatabaseServerConnection</code> тестирование подключения к серверу базы данных<h2 id=activedirectory><a aria-label="Anchor link for: activedirectory" class=zola-anchor href=#activedirectory><i class=icon></i></a> ActiveDirectory</h2><h3 id=rsat><a aria-label="Anchor link for: rsat" class=zola-anchor href=#rsat><i class=icon></i></a> RSAT</h3><blockquote><p>Remote Server Administration Tools</blockquote><p><code>DISM.exe /Online /add-capability /CapabilityName:Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0 /CapabilityName:Rsat.GroupPolicy.Management.Tools~~~~0.0.1.0</code> <br> <code>Add-WindowsCapability –online –Name Rsat.Dns.Tools~~~~0.0.1.0</code> <br> <code>Add-WindowsCapability -Online -Name Rsat.DHCP.Tools~~~~0.0.1.0</code> <br> <code>Add-WindowsCapability –online –Name Rsat.FileServices.Tools~~~~0.0.1.0</code> <br> <code>Add-WindowsCapability -Online -Name Rsat.WSUS.Tools~~~~0.0.1.0</code> <br> <code>Add-WindowsCapability -Online -Name Rsat.CertificateServices.Tools~~~~0.0.1.0</code> <br> <code>Add-WindowsCapability -Online -Name Rsat.RemoteDesktop.Services.Tools~~~~0.0.1.0</code> <br> <code>Get-WindowsCapability -Name RSAT* -Online | Select-Object -Property DisplayName, State</code> отобразить список установленных компанентов<h3 id=import-module-ad><a aria-label="Anchor link for: import-module-ad" class=zola-anchor href=#import-module-ad><i class=icon></i></a> Import-Module AD</h3><p><code>$Session = New-PSSession -ComputerName $srv</code> -Credential $cred <br> <code>Export-PSsession -Session $Session -Module ActiveDirectory -OutputModule ActiveDirectory</code> экспортировать модуль из удаленной сесси (например, с DC) <br> <code>Remove-PSSession -Session $Session</code> <br> <code>Import-Module ActiveDirectory</code> <br> <code>Get-Command -Module ActiveDirectory</code><h3 id=adsi><a aria-label="Anchor link for: adsi" class=zola-anchor href=#adsi><i class=icon></i></a> ADSI</h3><blockquote><p>Active Directory Service Interface</blockquote><p><code>$d0 = $env:userdnsdomain</code> <br> <code>$d0 = $d0 -split "\."</code> <br> <code>$d1 = $d0[0]</code> <br> <code>$d2 = $d0[1]</code> <br> <code>$group = [ADSI]"LDAP://OU=Domain Controllers,DC=$d1,DC=$d2"</code> <br> <code>$group | select *</code><p><code>$Local_User = [ADSI]"WinNT://./Администратор,user"</code> <br> <code>$Local_User | Get-Member</code> <br> <code>$Local_User.Description</code> <br> <code>$Local_User.LastLogin</code> время последней авторизации локального пользователя<h3 id=ldap><a aria-label="Anchor link for: ldap" class=zola-anchor href=#ldap><i class=icon></i></a> LDAP</h3><blockquote><p>Lightweight Directory Access Protocol</blockquote><p><code>$ldapsearcher = New-Object System.DirectoryServices.DirectorySearcher</code> <br> <code>$ldapsearcher.SearchRoot = "LDAP://OU=Domain Controllers,DC=$d1,DC=$d2"</code> <br> <code>$ldapsearcher.Filter = "(objectclass=computer)"</code> <br> <code>$dc = $ldapsearcher.FindAll().path</code><p><code>$usr = $env:username</code> cписок групп текущего пользователя <br> <code>$ldapsearcher = New-Object System.DirectoryServices.DirectorySearcher</code> <br> <code>$ldapsearcher.Filter = "(&(objectCategory=User)(samAccountName=$usr))"</code> <br> <code>$usrfind = $ldapsearcher.FindOne()</code> <br> <code>$groups = $usrfind.properties.memberof -replace "(,OU=.+)"</code> <br> <code>$groups = $groups -replace "(CN=)"</code><p>DC (Domain Component) - компонент доменного имени <br> OU (Organizational Unit) - организационные подразделения (type), используются для упорядочения объектов <br> Container - так же используется для упорядочения объектов, контейнеры в отличии от подраделений не могут быть переименованы, удалены, созданы или связаны с объектом групповой политики (Computers, Domain Controllers, Users) <br> DN (Distinguished Name) — уникальное имя объекта и местоположение в лесу AD. В DN описывается содержимое атрибутов в дереве (путь навигации), требуемое для доступа к конкретной записи или ее поиска <br> CN (Common Name) - общее имя<p><code>(Get-ADObject (Get-ADRootDSE).DefaultNamingContext -Properties wellKnownObjects).wellKnownObjects</code> отобразить отобразить контейнеры по умолчанию <br> <code>redircmp OU=Client Computers,DC=root,DC=domain,DC=local</code> изменить контейнер компьютеров по умолчанию <br> <code>redirusr</code> изменить контейнер пользователей по умолчанию<h3 id=laps><a aria-label="Anchor link for: laps" class=zola-anchor href=#laps><i class=icon></i></a> LAPS</h3><blockquote><p>Local Admin Password Management</blockquote><p><code>Import-module AdmPwd.ps</code> импортировать модуль <br> <code>Get-AdmPwdPassword -ComputerName NAME</code> посмотреть пароль <br> <code>Reset-AdmPwdPassword -ComputerName NAME</code> изменить пароль <br> <code>Get-ADComputer -Filter * -SearchBase "DC=$d1,DC=$d2" | Get-AdmPwdPassword -ComputerName {$_.Name} | select ComputerName,Password,ExpirationTimestamp | Out-GridView</code> <br> <code>Get-ADComputer -Identity $srv | Get-AdmPwdPassword -ComputerName {$_.Name} | select ComputerName,Password,ExpirationTimestamp</code><h3 id=recycle-bin><a aria-label="Anchor link for: recycle-bin" class=zola-anchor href=#recycle-bin><i class=icon></i></a> Recycle Bin</h3><p>Удаленные объекты хранятся в корзине AD в течении времени захоронения (определяется в атрибуте домена msDS-deletedObjectLifetime), заданном для леса. По умолчанию это 180 дней. Если данный срок прошел, объект все еще остается в контейнере Deleted Objects, но большинство его атрибутов и связей очищаются (Recycled Object). После истечения периода tombstoneLifetime (по умолчанию также 180 дней, но можно увеличить) объект полностью удаляется из AD автоматическим процессом очистки. <br> <code>Get-ADForest domain.local</code> отобразить уровень работы леса <br> <code>Set-ADForestMode -Identity domain.local -ForestMode Windows2008R2Forest -force</code> увеличить уровень работы леса <br> <code>Enable-ADOptionalFeature –Identity "CN=Recycle Bin Feature,CN=Optional Features,CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration,DC=domain,DC=local" –Scope ForestOrConfigurationSet –Target "domain.local"</code> включить корзину <br> <code>Get-ADOptionalFeature "Recycle Bin Feature" | select-object name,EnabledScopes</code> если значение EnabledScopes не пустое, значит в домене корзина Active Directory включена <br> <code>Get-ADObject -Filter 'Name -like "*tnas*"' -IncludeDeletedObjects</code> найти удаленную (Deleted: True) УЗ (ObjectClass: user) в AD <br> <code>Get-ADObject -Filter 'Name -like "*tnas*"' –IncludeDeletedObjects -Properties *| select-object Name, sAMAccountName, LastKnownParent, memberOf, IsDeleted | fl</code> проверить значение атрибута IsDeleted, контейнер, в котором находился пользователе перед удалением (LastKnownParent) и список групп, в которых он состоял <br> <code>Get-ADObject –filter {Deleted -eq $True -and ObjectClass -eq "user"} –includeDeletedObjects</code> вывести список удаленных пользователей <br> <code>Restore-ADObject -Identity "3dc33c7c-b912-4a19-b1b7-415c1395a34e"</code> восстановить по значению атрибута ObjectGUID <br> <code>Get-ADObject -Filter 'SAMAccountName -eq "tnas-01"' –IncludeDeletedObjects | Restore-ADObject</code> восстановить по SAMAccountName <br> <code>Get-ADObject -Filter {Deleted -eq $True -and ObjectClass -eq 'group' -and Name -like '*Allow*'} –IncludeDeletedObjects | Restore-ADObject –Verbose</code> восстановить группу или компьютер<h3 id=thumbnailphoto><a aria-label="Anchor link for: thumbnailphoto" class=zola-anchor href=#thumbnailphoto><i class=icon></i></a> thumbnailPhoto</h3><p><code>$photo = [byte[]](Get-Content C:\Install\adm.jpg -Encoding byte)</code> преобразовать файл картинки в массив байтов (jpeg/bmp файл, размером фото до 100 Кб и разрешением 96?96) <br> <code>Set-ADUser support4 -Replace @{thumbnailPhoto=$photo}</code> задать значение атрибута thumbnailPhoto<h3 id=addomaincontroller><a aria-label="Anchor link for: addomaincontroller" class=zola-anchor href=#addomaincontroller><i class=icon></i></a> ADDomainController</h3><p><code>Get-ADDomainController</code> выводит информацию о текущем контроллере домена (LogonServer), который используется данным компьютером для аутентификации (DC выбирается при загрузке в соответствии с топологией сайтов AD) <br> <code>Get-ADDomainController -Discover -Service PrimaryDC</code> найти контроллер с ролью PDC в домене <br> <code>Get-ADDomainController -Filter * | ft HostName,IPv4Address,Name,Site,OperatingSystem,IsGlobalCatalog</code> список все DC, принадлежность к сайту, версии ОС и GC<p>При загрузке ОС служба NetLogon делает DNS запрос со списком контроллеров домена (к SRV записи _ldap._tcp.dc.<em>msdcs.domain</em>), DNS возвращает список DC в домене с записью Service Location (SRV). Клиент делает LDAP запрос к DC для определения сайта AD по своему IP адресу. Клиент через DNS запрашивает список контроллеров домена в сайте (в разделе _tcp.sitename._sites…).<p>USN (Update Sequence Numbers) - счетчик номера последовательного обновления, который существует у каждого объекта AD. При репликации контроллеры обмениваются значениями USN, объект с более низким USN будет при репликации перезаписан объектом с более высоким USN. Находится в свойствах - Object (включить View - Advanced Features). Каждый контроллер домена содержит отдельный счетчик USN, который начинает отсчет в момент запуска процесса Dcpromo и продолжает увеличивать значения в течение всего времени существования контроллера домена. Значение счетчика USN увеличивается каждый раз, когда на контроллере домена происходит транзакция, это операции создания, обновления или удаления объекта.<p><code>Get-ADDomainController -Filter * | % {</code> отобразить USN объекта на всех DC в домене<code>\</code>Get-ADUser -Server $_.HostName -Identity support4 -Properties uSNChanged | select SamAccountName,uSNChanged<code>\</code>}`<p><code>dcpromo /forceremoval</code> принудительно выполнит понижение в роли контроллера домена до уровня рядового сервера. После понижения роли выполняется удаление всех ссылок в домене на этот контроллер. Далее производит включение сервера в состав домена, и выполнение обратного процесса, т.е. повышение сервера до уровня контроллера домена.<h3 id=adcomputer><a aria-label="Anchor link for: adcomputer" class=zola-anchor href=#adcomputer><i class=icon></i></a> ADComputer</h3><p><code>nltest /DSGETDC:$env:userdnsdomain</code> узнать на каком DC аудентифицирован хост (Logon Server) <br> <code>nltest /SC_RESET:$env:userdnsdomain\srv-dc2.$env:userdnsdomain</code> переключить компьютер на другой контроллер домена AD вручную (The command completed successfully) <br> <code>Get-ADComputer –Identity $env:computername -Properties PasswordLastSet</code> время последней смены пароля на сервере <br> <code>Test-ComputerSecureChannel –verbose</code> проверить доверительные отношения с доменом (соответствует ли локальный пароль компьютера паролю, хранящемуся в AD) <br> <code>Reset-ComputerMachinePassword -Credential domain\admin</code> принудительно обновить пароль <br> <code>Netdom ResetPWD /Server:dc-01 /UserD:domain\admin /PasswordD:*</code> сбросить хэш пароля компьютера в домене (перезагрузка не требуется) <br> <code>Search-ADAccount -AccountDisabled -ComputersOnly | select Name,LastLogonDate,Enabled</code> отобразить все отключенные компьютеры<p><code>Get-ADComputer -Filter * -Properties * | select name</code> список всех компьютеров в домене (Filter), вывести все свойства (Properties) <br> <code>Get-ADComputer -Identity $srv -Properties * | ft Name,LastLogonDate,PasswordLastSet,ms-Mcs-AdmPwd -Autosize</code> конкретного компьютера в AD (Identity) <br> <code>Get-ADComputer -SearchBase "OU=Domain Controllers,DC=$d1,DC=$d2" -Filter * -Properties * | ft Name, LastLogonDate, distinguishedName -Autosize</code> поиск в базе по DN (SearchBase)<p><code>(Get-ADComputer -Filter {enabled -eq "true"}).count</code> получить общее количество активных (незаблокированных) компьютеров <br> <code>(Get-ADComputer -Filter {enabled -eq "true" -and OperatingSystem -like "*Windows Server 2016*"}).count</code> кол-во активных копьютеров с ОС WS 2016<p><code>Get-ADComputer -Filter * -Properties * | select @{Label="Ping Status"; Expression={</code> <br> <code>$ping = ping -n 1 -w 50 $_.Name</code> <br> <code>if ($ping -match "TTL") {"Online"} else {"Offline"}</code> <br> <code>}},</code> <br> <code>@{Label="Status"; Expression={</code> <br> <code>if ($_.Enabled -eq "True") {$_.Enabled -replace "True","Active"} else {$_.Enabled -replace "False","Blocked"}</code> <br> <code>}}, Name, IPv4Address, OperatingSystem, @{Label="UserOwner"; Expression={$_.ManagedBy -replace "(CN=|,.+)"}</code> <br> <code>},Created | Out-GridView</code><h3 id=aduser><a aria-label="Anchor link for: aduser" class=zola-anchor href=#aduser><i class=icon></i></a> ADUser</h3><p><code>Get-ADUser -Identity support4 -Properties *</code> список всех атрибутов <br> <code>Get-ADUser -Identity support4 -Properties DistinguishedName, EmailAddress, Description</code> путь DN, email и описание <br> <code>Get-ADUser -Filter {(Enabled -eq "True") -and (mail -ne "null")} -Properties mail | ft Name,mail</code> список активных пользователей и есть почтовый ящик <br> <code>Get-ADUser -Filter {SamAccountName -like "*"} | Measure-Object</code> посчитать кол-во всех аккаунтов (Count) <br> <code>Get-ADUser -Filter * -Properties WhenCreated | sort WhenCreated | ft Name, whenCreated</code> дата создания <br> <code>Get-ADUser -Identity support4 -property LockedOut | select samaccountName,Name,Enabled,Lockedout</code> <br> <code>Enabled=True</code> учетная запись включена - да <br> <code>Lockedout=False</code> учетная запись заблокирована (например, политикой паролей) - нет <br> <code>Get-ADUser -Identity support4 | Unlock-ADAccount</code> разблокировать учетную запись <br> <code>Disable-ADAccount -Identity support4</code> отключить учетную запись <br> <code>Enable-ADAccount -Identity support4</code> включить учетную запись <br> <code>Search-ADAccount -LockedOut</code> найти все заблокированные учетные записи <br> <code>Search-ADAccount -AccountDisabled | select Name,LastLogonDate,Enabled</code> отобразить все отключенные учетные записи с временем последнего входа<p><code>Get-ADUser -Identity support4 -Properties PasswordLastSet,PasswordExpired,PasswordNeverExpires</code> <br> <code>PasswordLastSet</code> время последней смены пароля <br> <code>PasswordExpired=False</code> пароль истек - нет <br> <code>PasswordNeverExpires=True</code> срок действия пароля не истекает - да <br> <code>Set-ADAccountPassword support4 -Reset -NewPassword (ConvertTo-SecureString -AsPlainText "password" -Force -Verbose)</code> изменить пароль учетной записи <br> <code>Set-ADUser -Identity support4 -ChangePasswordAtLogon $True</code> смена пароля при следующем входе в систему<p><code>$day = (Get-Date).adddays(-90)</code> <br> <code>Get-ADUser -filter {(passwordlastset -le $day)} | ft</code> пользователи, которые не меняли свой пароль больше 90 дней<p><code>$day = (Get-Date).adddays(-30)</code> <br> <code>Get-ADUser -filter {(Created -ge $day)} -Property Created | select Name,Created</code> Новые пользователи за 30 дней<p><code>$day = (Get-Date).adddays(-360)</code> <br> <code>Get-ADUser -Filter {(LastLogonTimestamp -le $day)} -Property LastLogonTimestamp | select Name,SamAccountName,@{n='LastLogonTimestamp';e={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} | sort -Descending LastLogonTimestamp</code> пользователи, которые не логинились больше 360 дней. Репликация атрибута LastLogonTimestamp составляет от 9 до 14 дней. <br> <code>| Disable-ADAccount $_.SamAccountName</code> заблокировать <br> <code>-WhatIf</code> отобразить вывод без применения изменений<h3 id=adgroupmember><a aria-label="Anchor link for: adgroupmember" class=zola-anchor href=#adgroupmember><i class=icon></i></a> ADGroupMember</h3><p><code>(Get-ADUser -Identity support4 -Properties MemberOf).memberof</code> список групп в которых состоит пользователь <br> <code>Get-ADGroupMember -Identity "Domain Admins" | Select Name,SamAccountName</code> список пользователей в группе <br> <code>Add-ADGroupMember -Identity "Domain Admins" -Members support5</code> добавить в группу <br> <code>Remove-ADGroupMember -Identity "Domain Admins" -Members support5 -force</code> удалить из группы <br> <code>Get-ADGroup -filter * | where {!($_ | Get-ADGroupMember)} | Select Name</code> отобразить список пустых групп (-Not)<h3 id=adreplication><a aria-label="Anchor link for: adreplication" class=zola-anchor href=#adreplication><i class=icon></i></a> ADReplication</h3><p><code>Get-Command -Module ActiveDirectory -Name *Replication*</code> список всех командлетов модуля <br> <code>Get-ADReplicationFailure -Target dc-01</code> список ошибок репликации с партнерами <br> <code>Get-ADReplicationFailure -Target $env:userdnsdomain -Scope Domain</code> <br> <code>Get-ADReplicationPartnerMetadata -Target dc-01 | select Partner,LastReplicationAttempt,LastReplicationSuccess,LastReplicationResult,LastChangeUsn</code> время последней и время успешной репликации с партнерами <br> <code>Get-ADReplicationUpToDatenessVectorTable -Target dc-01</code> Update Sequence Number (USN) увеличивается каждый раз, когда на контроллере домена происходит транзакция (операции создания, обновления или удаления объекта), при репликации DC обмениваются значениями USN, объект с более низким USN при репликации будет перезаписан высоким USN.<h2 id=repadmin><a aria-label="Anchor link for: repadmin" class=zola-anchor href=#repadmin><i class=icon></i></a> repadmin</h2><p><code>repadmin /replsummary</code> отображает время последней репликации на всех DC по направлению (Source и Destination) и их состояние с учетом партнеров <br> <code>repadmin /showrepl $srv</code> отображает всех партнеров по реплкации и их статус для всех разделов Naming Contexts (DC=ForestDnsZones, DC=DomainDnsZones, CN=Schema, CN=Configuration) <br> <code>repadmin /replicate $srv2 $srv1 DC=domain,DC=local </code> выполнить репликацию с $srv1 на $srv2 только указанный раздела домена <br> <code>repadmin /SyncAll /AdeP</code> запустить межсайтовую исходящую репликацию всех разделов от текущего сервера со всеми партнерами по репликации <br> <code>/A</code> выполнить для всех разделов NC <br> <code>/d</code> в сообщениях идентифицировать серверы по DN (вместо GUID DNS - глобальным уникальным идентификаторам) <br> <code>/e</code> межсайтовая синхронизация (по умолчанию синхронизирует только с DC текущего сайта) <br> <code>/P</code> извещать об изменениях с этого сервера (по умолчанию: опрашивать об изменениях) <br> <code>repadmin /Queue $srv</code> отображает кол-во запросов входящей репликации (очередь), которое необходимо обработать (причиной может быть большое кол-во партнеров или формирование 1000 объектов скриптом) <br> <code>repadmin /showbackup *</code> узнать дату последнего Backup<p><code>Error: 1722</code> сервер rpc недоступен (ошибка отката репликации). Проверить имя домена в настройках сетевого адаптера, первым должен идти адрес DNS-сервера другого контроллера домена, вторым свой адрес. <br> <code>Get-Service -ComputerName $srv | select name,status | ? name -like "RpcSs"</code> <br> <code>Get-Service -ComputerName $srv -Name RpcSs -RequiredServices</code> зависимые службы <br> Зависимые службы RPC: <br> “Служба сведений о подключенных сетях” - должен быть включен отложенный запуск. Если служба срабатывает до “службы списка сетей”, может падать связь с доменом (netlogon) <br> “Центр распространения ключей Kerberos” <br> “DNS-сервер” <br> <code>nslookup $srv</code> <br> <code>tnc $srv -p 135</code> <br> <code>repadmin /retry</code> повторить попытку привязки к целевому DC, если была ошибка 1722 или 1753 (RPC недоступен)<p><code>repadmin /showrepl $srv</code> <br> <code>Last attempt @ 2022-07-15 10:46:01 завершена с ошибкой, результат 8456 (0x2108)</code> при проверки showrepl этого партнера, его ошибка: 8457 (0x2109) <br> <code>Last success @ 2022-07-11 02:29:46</code> последний успех <br> Когда репликация автоматически отключена, ОС записывает в DSA - not writable одно из четырех значений: <br> <code>Path: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\NTDS\Parameters</code> <br> <code>Dsa Not Writable</code> <br> <code>#define DSA_WRITABLE_GEN 1</code> версия леса несовместима с ОС <br> <code>#define DSA_WRITABLE_NO_SPACE 2</code> на диске, где размещена база данных Active Directory или файлы журналов (логи), недостаточно свободного места <br> <code>#define DSA_WRITABLE_USNROLLBCK 4</code> откат USN произошел из-за неправильного отката базы данных Active Directory во времени (восстановление из снапшота) <br> <code>#define DSA_WRITABLE_CORRUPT_UTDV 8</code> вектор актуальности поврежден на локальном контроллере домена<h2 id=dcdiag><a aria-label="Anchor link for: dcdiag" class=zola-anchor href=#dcdiag><i class=icon></i></a> dcdiag</h2><p><code>dcdiag /s:&LTDomainController> [/n:&LTNamingContext>] [[/u:&LTdomain\user>] [/p:&LTpassword>]] [{/a|/e}{/q|/v}] [/f:&LTLogFile>] [/ferr:&LTErrorLog>] [/test:&LTtest>] [/fix]</code> <br> <code>dcdiag /Test:replications /s:dc-01</code> отображает ошибки репликации <br> <code>dcdiag /Test:DNS /e /v /q</code> тест DNS <br> <code>/a</code> проверка всех серверов данного сайта <br> <code>/e</code> проверка всех серверов предприятия <br> <code>/q</code> выводить только сообщения об ошибках <br> <code>/v</code> выводить подробную информацию <br> <code>/fix</code> автоматически исправляет ошибки <br> <code>/test:</code> <br> <code>NetLogons</code> проверка наличие прав на выполнение репликации <br> <code>Connectivity</code> проверяет регистрацию DNS для каждого контроллера домена, отправляет тестовый эхо-пакет на каждый контроллер домена и проверяет подключение по протоколам LDAP и RPC к каждому контроллеру домена <br> <code>Services</code> проверяет работоспособность всех служб, необходимых для работы контроллера домена, на указанном контроллере домена <br> <code>Systemlog</code> проверяет наличие ошибок в журналах контроллера домена <br> <code>FRSEvent</code> проверяет ошибки репликации в работе службы репликации файлов, что может означать наличие проблем в репликации SYSVOL и, таким образом, целостности копий объектов групповых политик <br> <code>FSMOCheck</code> не проверяет роли хозяев операций, а вместо этого запрашивает сервер глобального каталога, первичный контроллер домена, предпочтительный сервер времени, сервер времени и центр распространения ключей (контроллер домена может подключиться к KDC, PDC, серверу глобального каталога) <br> <code>KnowsOfRoleHolders</code> пgроверяет возможность подключения контроллеров домена ко всем пяти хозяевам операций (ролями FSMO) <br> <code>MachineAccount</code> проверяет правильность регистрации учетной записи целевого компьютера и правильность объявлений служб этого компьютера (корректность доверительных отношения с доменом). Если обнаружена ошибка, ее можно исправить с помощью утилиты dcdiag, указав параметры /fixmachineaccount или /recreatemachineaccount <br> <code>Advertising</code> проверяет, правильно ли контроллер домена сообщает о себе и о своей роли хозяина операций. Этот тест завершиться неудачно, если служба NetLogon не запущена <br> <code>CheckSDRefDom</code> проверяет правильность доменов ссылок дескрипторов безопасности для каждого раздела каталогов программ <br> <code>CrossRefValidation</code> проверяет правильность перекрестных ссылок для доменов <br> <code>RRSSysvol</code> проверяет состояние готовности для FRS SYSVOL <br> <code>Intersite</code> проверяет наличие ошибок, которые могут помешать нормальной репликации между сайтами. Компания Microsoft предупреждает, что иногда результаты этого теста могут оказаться неточными <br> <code>KCCEvent</code> проверяет безошибочность создания объектов соединений для репликации между сайтами <br> <code>NCSecDesc</code> проверяет правильность разрешений для репликации в дескрипторах безопасности для заголовков контекста именования <br> <code>ObjectsReplicated</code> проверяет правильность репликации агента сервера каталогов и объектов учетных записей компьютеров <br> <code>OutboundSecureChannels</code> проверяется наличие безопасных каналов между всеми контроллерами домена в интересующем домене <br> <code>Replications</code> проверяет возможность репликации между контроллерами домена и сообщает обо всех ошибках при репликации <br> <code>RidManager</code> проверяет работоспособность и доступность хозяина относительных идентификаторов <br> <code>VerifyEnterpriseReferences</code> проверяет действительность системных ссылок службы репликации файлов для всех объектов на всех контроллерах домена в лесу <br> <code>VerifyReferences</code> проверяет действительность системных ссылок службы репликации файлов для всех объектов на указанном контроллере домена <br> <code>VerifyReplicas</code> проверяет действительность всех разделов каталога приложения на всех серверах, принимающих участие в репликации<h2 id=ntdsutil><a aria-label="Anchor link for: ntdsutil" class=zola-anchor href=#ntdsutil><i class=icon></i></a> ntdsutil</h2><p>Перенос БД AD (ntds.dit): <br> <code>Get-Acl C:\Windows\NTDS | Set-Acl D:\AD-DB</code> скопировать NTFS разрешения на новый каталог <br> <code>Stop-Service -ComputerName dc -name NTDS</code> остановить службу Active Directory Domain Services <br> <code>ntdsutil</code> запустить утилиту ntdsutil <br> <code>activate instance NTDS</code> выбрать активный экземпляр базы AD <br> <code>files</code> перейдем в контекст files, в котором возможно выполнение операция с файлами базы ntds.dit <br> <code>move DB to D:\AD-DB\</code> перенести базу AD в новый каталог (предварительно нужно его создать) <br> <code>info</code> проверить, что БД находится в новом каталоге <br> <code>move logs to D:\AD-DB\</code> переместим в тот же каталог файлы с журналами транзакций <br> <code>quit</code> <br> <code>Start-Service -ComputerName dc -name NTDS</code><p>Сброс пароля DSRM (режим восстановления служб каталогов): <br> <code>ntdsutil</code> <br> <code>set dsrm password</code> <br> <code>reset password on server NULL</code> <br> новый пароль <br> подтверждение пароля <br> <code>quit</code> <br> <code>quit</code><p>Синхронизировать с паролем УЗ в AD: <br> <code>ntdsutil</code> <br> <code>set dsrm password</code> <br> <code>sync from domain account dsrmadmin</code> <br> <code>quit</code> <br> <code>quit</code><p>Ошибка 0x00002e2 при загрузке ОС. <br> Загрузиться в режиме восстанавления WinRE (Windows Recovery Environment) - Startup Settings - Restart - DSRM (Directory Services Restore Mode) <br> <code>reagentc /boottore</code> shutdown /f /r /o /t 0 перезагрузка в режиме WinRE - ОС на базе WinPE (Windows Preinstallation Environment), образ winre.wim находится на скрытом разделе System Restore <br> На контроллере домена единственная локальная учетная запись — администратор DSRM. Пароль создается при установке роли контроллера домена ADDS на сервере (SafeModeAdministratorPassword). <br> <code>ntdsutil</code> <br> <code>activate instance ntds</code> <br> <code>Files</code> <br> <code>Info</code> <br> <code>integrity</code> проверить целостность БД <br> Ошибка: Failed to open DIT for AD DS/LDS instance NTDS. Error -2147418113 <br> <code>mkdir c:\ntds_bak</code> <br> <code>xcopy c:\Windows\NTDS\*.* c:\ntds_bak</code> backup содержимого каталога с БД <br> <code>esentutl /g c:\windows\ntds\ntds.dit</code> проверим целостность файла <br> Вывод: Integrity check completed. Database is CORRUPTED ошибка, база AD повреждена <br> <code>esentutl /p c:\windows\ntds\ntds.dit</code> исправить ошибки <br> Вывод: Operation completed successfully in xx seconds. нет ошибок <br> <code>esentutl /g c:\windows\ntds\ntds.dit</code> проверим целостность файла <br> Выполнить анализ семантики базы с помощью ntdsutil: <br> <code>ntdsutil</code> <br> <code>activate instance ntds</code> <br> <code>semantic database analysis</code> <br> <code>go</code> <br> <code>go fixup</code> исправить семантические ошибки <br> Сжать файл БД: <br> <code>activate instance ntds</code> <br> <code>files</code> <br> <code>compact to C:\Windows\NTDS\TEMP</code> <br> <code>copy C:\Windows\NTDS\TEMP\ntds.dit C:\Windows\NTDS\ntds.dit</code> заменить оригинальный файл ntds.dit <br> <code>Del C:\Windows\NTDS\*.log</code> удалить все лог файлы из каталога NTDS<h2 id=gpo><a aria-label="Anchor link for: gpo" class=zola-anchor href=#gpo><i class=icon></i></a> GPO</h2><p><code>Get-Command -Module GroupPolicy</code> <br> <code>Get-GPO -Domain domain.local -All | ft</code> <br> <code>Get-GPO -Name LAPS</code> <br> <code>[xml](Get-GPOReport LAPS -ReportType Xml)</code> <br> <code>Get-GPPermission -Name LAPS -All</code> <br> <code>Get-GPO LAPS | New-GPLink -Target "ou=servers,dc=domain,dc=local"</code> <br> <code>Set-GPLink -Name LAPS -Target "ou=servers,dc=domain,dc=local" -LinkEnabled No</code> <br> <code>Backup-GPO -Name LAPS -Path "$home\Desktop"</code> <br> <code>Backup-GPO -All -Path "$home\Desktop"</code> <br> <code>Restore-GPO -Name LAPS -Path C:\Backup\GPOs\</code><h2 id=servermanager><a aria-label="Anchor link for: servermanager" class=zola-anchor href=#servermanager><i class=icon></i></a> ServerManager</h2><p><code>Get-Command *WindowsFeature*</code> source module ServerManager <br> <code>Get-WindowsFeature -ComputerName "localhost"</code> <br> <code>Get-WindowsFeature | where Installed -eq $True</code> список установленных ролей и компонентов <br> <code>Get-WindowsFeature | where FeatureType -eq "Role"</code> отсортировать по списку ролей <br> <code>Install-WindowsFeature -Name DNS</code> установить роль <br> <code>Get-Command *DNS*</code> <br> <code>Get-DnsServerSetting -ALL</code> <br> <code>Uninstall-WindowsFeature -Name DNS</code> удалить роль<h3 id=pswa><a aria-label="Anchor link for: pswa" class=zola-anchor href=#pswa><i class=icon></i></a> PSWA</h3><p><code>Install-WindowsFeature -Name WindowsPowerShellWebAccess -IncludeManagementTools</code> <br> <code>Install-PswaWebApplication -UseTestCertificate</code> Создать веб-приложение /pswa <br> <code>Add-PswaAuthorizationRule -UserGroupName "$domain\Domain Admins" -ComputerName * -ConfigurationName * -RuleName "For Admins"</code> добавить права авторизации<h3 id=wsb-windows-server-backup><a aria-label="Anchor link for: wsb-windows-server-backup" class=zola-anchor href=#wsb-windows-server-backup><i class=icon></i></a> WSB (Windows Server Backup)</h3><p>При создании backup DC через WSB, создается копия состояния системы (System State), куда попадает база AD (NTDS.DIT), объекты групповых политик, содержимое каталога SYSVOL, реестр, метаданные IIS, база AD CS, и другие системные файлы и ресурсы. Резервная копия создается через службу теневого копирования VSS. <br> <code>Get-WindowsFeature Windows-Server-Backup</code> проверить установлена ли роль <br> <code>Add-Windowsfeature Windows-Server-Backup –Includeallsubfeature</code> установить роль<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span>\bak-dc\dc-03\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TargetUNC</span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">get-date</span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>yyyy-MM-dd<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TargetUNC</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType directory<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> если путь доступен, создать новую директорию по дате<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WBadmin_cmd</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>wbadmin.exe START BACKUP -backupTarget:<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TargetUNC</span> -systemState -noverify -vssCopy -quiet<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> $WBadmin_cmd = "wbadmin start backup -backuptarget:$path -include:C:\Windows\NTDS\ntds.dit -quiet" # Backup DB NTDS<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-Expression</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WBadmin_cmd</span>
</span></code></pre><h3 id=rds><a aria-label="Anchor link for: rds" class=zola-anchor href=#rds><i class=icon></i></a> RDS</h3><p><code>Get-Command -Module RemoteDesktop</code> <br> <code>Get-RDServer -ConnectionBroker $broker</code> список всех серверов в фермеы, указывается полное доменное имя при обращение к серверу с ролью RDCB <br> <code>Get-RDRemoteDesktop -ConnectionBroker $broker</code> список коллекций <br> <code>(Get-RDLicenseConfiguration -ConnectionBroker $broker | select *).LicenseServer</code> список серверов с ролью RDL <br> <code>Get-RDUserSession -ConnectionBroker $broker</code> список всех активных пользователей <br> <code>Disconnect-RDUser -HostServer $srv -UnifiedSessionID $id -Force</code> отключить сессию пользователя <br> <code>Get-RDAvailableApp -ConnectionBroker $broker -CollectionName C03</code> список установленного ПО на серверах в коллекции <br> <code>(Get-RDSessionCollectionConfiguration -ConnectionBroker $broker -CollectionName C03 | select *).CustomRdpProperty</code> use redirection server name:i:1 <br> <code>Get-RDConnectionBrokerHighAvailability</code><h2 id=dnsserver><a aria-label="Anchor link for: dnsserver" class=zola-anchor href=#dnsserver><i class=icon></i></a> DNSServer</h2><p><code>Get-Command -Module DnsServer</code> <br> <code>Show-DnsServerCache</code> отобразить весь кэш DNS-сервера <br> <code>Show-DnsServerCache | where HostName -match ru</code> <br> <code>Clear-DnsServerCache</code> <br> <code>Get-DnsServerCache</code> <br> <code>Get-DnsServerDiagnostics</code><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zone</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> icm <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Get-DnsServerZone</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> select ZoneName<span class="z-keyword z-operator z-other z-powershell">,</span>ZoneType<span class="z-keyword z-operator z-other z-powershell">,</span>DynamicUpdate<span class="z-keyword z-operator z-other z-powershell">,</span>ReplicationScope<span class="z-keyword z-operator z-other z-powershell">,</span>SecureSecondaries<span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell">DirectoryPartitionName <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-GridView</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Title <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>DNS Server: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> –PassThru
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zone_name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zone<span class="z-variable z-other z-member z-powershell">.ZoneName</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zone_name</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    icm <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Get-DnsServerResourceRecord</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ZoneName <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:zone_name</span> <span class="z-keyword z-operator z-other z-powershell">|</span> sort RecordType <span class="z-keyword z-operator z-other z-powershell">|</span> select RecordType<span class="z-keyword z-operator z-other z-powershell">,</span>HostName<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Label</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>IPAddress<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.RecordData.IPv4Address.IPAddressToString</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>TimeToLive<span class="z-keyword z-operator z-other z-powershell">,</span>Timestamp
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> select RecordType<span class="z-keyword z-operator z-other z-powershell">,</span>HostName<span class="z-keyword z-operator z-other z-powershell">,</span>IPAddress<span class="z-keyword z-operator z-other z-powershell">,</span>TimeToLive<span class="z-keyword z-operator z-other z-powershell">,</span>Timestamp <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-GridView</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Title <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>DNS Server: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Sync-DnsServerZone –passthru</code> синхронизировать зоны с другими DC в домене <br> <code>Remove-DnsServerZone -Name domain.local</code> удалить зону <br> <code>Get-DnsServerResourceRecord -ZoneName domain.local -RRType A</code> вывести все А-записи в указанной зоне <br> <code>Add-DnsServerResourceRecordA -Name new-host-name -IPv4Address 192.168.1.100 -ZoneName domain.local -TimeToLive 01:00:00 -CreatePtr</code> создать А-запись и PTR для нее <br> <code>Remove-DnsServerResourceRecord -ZoneName domain.local -RRType A -Name new-host-name –Force</code> удалить А-запись<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSServer</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>DC-01<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSFZone</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>domain.com<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataFile</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Scripts\DNS-Create-A-Records-from-File.csv<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> cat $DataFile<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> "HostName;IP"<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> "server-01;192.168.1.10"<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSRR</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">WmiClass</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSServer</span>\root\MicrosoftDNS:MicrosoftDNS_ResourceRecord<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ConvFile</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataFile</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>_unicode<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-Content</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataFile</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Set-Content</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ConvFile</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Encoding Unicode
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-CSV</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ConvFile</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Delimiter <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FQDN</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.HostName</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSFZone</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IP</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.HostIP</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TextA</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FQDN</span> IN A <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IP</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Void</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSRR<span class="z-variable z-other z-member z-powershell">.CreateInstanceFromTextRepresentation</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSServer</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DNSFZone</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TextA</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h2 id=dhcpserver><a aria-label="Anchor link for: dhcpserver" class=zola-anchor href=#dhcpserver><i class=icon></i></a> DHCPServer</h2><p><code>Get-Command -Module DhcpServer</code><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> icm <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ScriptBlock <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Get-DhcpServerv4Scope</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-DhcpServerv4Lease</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> select AddressState<span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell">HostName<span class="z-keyword z-operator z-other z-powershell">,</span>IPAddress<span class="z-keyword z-operator z-other z-powershell">,</span>ClientId<span class="z-keyword z-operator z-other z-powershell">,</span>DnsRegistration<span class="z-keyword z-operator z-other z-powershell">,</span>DnsRR<span class="z-keyword z-operator z-other z-powershell">,</span>ScopeId<span class="z-keyword z-operator z-other z-powershell">,</span>ServerIP <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-GridView</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Title <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>HDCP Server: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> –PassThru
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject Wscript.Shell</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Popup<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac<span class="z-variable z-other z-member z-powershell">.ClientId</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mac<span class="z-variable z-other z-member z-powershell">.HostName</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">64</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><p><code>Add-DhcpServerv4Reservation -ScopeId 192.168.1.0 -IPAddress 192.168.1.10 -ClientId 00-50-56-C0-00-08 -Description "new reservation"</code><h2 id=dfs><a aria-label="Anchor link for: dfs" class=zola-anchor href=#dfs><i class=icon></i></a> DFS</h2><p><code>dfsutil /root:\\domain.sys\public /export:C:\export-dfs.txt</code> экспорт конфигурации namespace root <br> <code>dfsutil /AddFtRoot /Server:\\$srv /Share:public</code> на новой машине предварительно создать корень на основе домена <br> <code>dfsutil /root:\\domain.sys\public /import:C:\export-dfs.txt /&LTverify /set</code> Import (перед импортом данных в существующий корень DFS, утилита создает резервную копию конфигурации корня в текущем каталоге, из которого запускается утилита dfsutil) <br> <code>/verify</code> выводит изменения, которые будут внесены в процессе импорта, без применения <br> <code>/set</code> меняет целевое пространство имен путем полной перезаписи и замены на конфигурацию пространства имен из импортируемого файла <br> <code>/merge</code> импортирует конфигурацию пространства имен в дополнение к существующей конфигурации для слияния, параметры из файла конфигурации будут иметь больший приоритет, чем существующие параметры пространства имен<p><code>Export-DfsrClone</code> экспортирует клонированную базу данных репликации DFS и параметры конфигурации тома <br> <code>Get-DfsrCloneState</code> получает состояние операции клонирования базы данных <br> <code>Import-DfsrClone</code> импортирует клонированную базу данных репликации DFS и параметры конфигурации тома<p><code>net use x: \\$srv1\public\*</code> примонтировать диск <br> <code>Get-DfsrFileHash x:\* | Out-File C:\$srv1.txt</code> забрать hash всех файлов диска в файл (файлы с одинаковыми хешами всегда являются точными копиями друг друга) <br> <code>net use x: /d</code> отмонтировать <br> <code>net use x: \\$srv2\public\*</code> <br> <code>Get-DfsrFileHash x:\* | Out-File C:\$srv2.txt</code> <br> <code>net use x: /d</code> <br> <code>Compare-Object -ReferenceObject (Get-Content C:\$srv1.txt) -DifferenceObject (Get-Content C:\$srv2.txt) -IncludeEqual</code> сравнить содержимое файлов<p><code>Get-DfsrBacklog -DestinationComputerName "fs-06" -SourceComputerName "fs-05" -GroupName "folder-rep" -FolderName "folder" -Verbose</code> получает список ожидающих обновлений файлов между двумя партнерами репликации DFS <br> <code>Get-DfsrConnection</code> отображает группы репликации, участников и статус <br> <code>Get-DfsReplicatedFolder</code> отображает имя и полный путь к папкам реликации в системе DFS <br> <code>Get-DfsrState -ComputerName fs-06 -Verbose</code> состояние репликации DFS для члена группы <br> <code>Get-DfsReplicationGroup</code> отображает группы репликации и их статус <br> <code>Add-DfsrConnection</code> создает соединение между членами группы репликации <br> <code>Add-DfsrMember</code> добавляет компьютеры в группу репликации <br> <code>ConvertFrom-DfsrGuid</code> преобразует идентификаторы GUID в понятные имена в заданной группы репликации <br> <code>Get-DfsrConnectionSchedule</code> получает расписание соединений между членами группы репликации <br> <code>Get-DfsrGroupSchedule</code> извлекает расписание группы репликации <br> <code>Get-DfsrIdRecord</code> получает записи ID для реплицированных файлов или папок из базы данных репликации DFS <br> <code>Get-DfsrMember</code> получает компьютеры в группе репликации <br> <code>Get-DfsrMembership</code> получает параметры членства для членов групп репликации <br> <code>Get-DfsrPreservedFiles</code> получает список файлов и папок, ранее сохраненных репликацией DFS <br> <code>Get-DfsrServiceConfiguration</code> получает параметры службы репликации DFS для членов группы <br> <code>Grant-DfsrDelegation</code> предоставляет разрешения участникам безопасности для группы репликации <br> <code>Revoke-DfsrDelegation</code> отменяет разрешения участников безопасности для группы репликации <br> <code>New-DfsReplicationGroup</code> создает группу репликации <br> <code>New-DfsReplicatedFolder</code> создает реплицированную папку в группе репликации <br> <code>Remove-DfsrConnection</code> удаляет соединение между членами группы репликации <br> <code>Remove-DfsReplicatedFolder</code> удаляет реплицированную папку из группы репликации <br> <code>Remove-DfsReplicationGroup</code> удаляет группу репликации <br> <code>Remove-DfsrMember</code> удаляет компьютеры из группы репликации <br> <code>Restore-DfsrPreservedFiles</code> восстанавливает файлы и папки, ранее сохраненные репликацией DFS <br> <code>Set-DfsrConnection</code> изменяет параметры соединения между членами группы репликации <br> <code>Set-DfsrConnectionSchedule</code> изменяет параметры расписания соединений между членами группы репликации <br> <code>Set-DfsReplicatedFolder</code> изменяет настройки реплицированной папки <br> <code>Set-DfsReplicationGroup</code> изменяет группу репликации <br> <code>Set-DfsrGroupSchedule</code> изменяет расписание группы репликации <br> <code>Set-DfsrMember</code> изменяет информацию о компьютере-участнике в группе репликации <br> <code>Set-DfsrMembership</code> настраивает параметры членства для членов группы репликации <br> <code>Set-DfsrServiceConfiguration</code> изменяет параметры службы репликации DFS <br> <code>Sync-DfsReplicationGroup</code> синхронизирует репликацию между компьютерами независимо от расписания <br> <code>Suspend-DfsReplicationGroup</code> приостанавливает репликацию между компьютерами независимо от расписания <br> <code>Update-DfsrConfigurationFromAD</code> инициирует обновление службы репликации DFS <br> <code>Write-DfsrHealthReport</code> создает отчет о работоспособности репликации DFS <br> <code>Write-DfsrPropagationReport</code> создает отчеты для тестовых файлов распространения в группе репликации <br> <code>Start-DfsrPropagationTest</code> создает тестовый файл распространения в реплицированной папке<h2 id=storagereplica><a aria-label="Anchor link for: storagereplica" class=zola-anchor href=#storagereplica><i class=icon></i></a> StorageReplica</h2><p><code>Install-WindowsFeature Storage-Replica –IncludeManagementTools -Restart</code> <br> <code>Get-Command -Module StorageReplica</code> <br> <code>Test-SRTopology</code> проверить соответствует ли сервер и канал связи технологии Storage Replica <br> <code>New-SRPartnership -SourceComputerName srv-01 -SourceRGName srv-01-rep-group-01 -SourceVolumeName D: -SourceLogVolumeName L: -DestinationComputerName srv-02 -DestinationRGName srv-02-rep-group-01 -DestinationVolumeName D: -DestinationLogVolumeName L: -LogSizeInBytes 1GB</code> <br> <code>Get-Counter -Counter "\Storage Replica Statistics(*)"</code> <br> <code>Get-WinEvent -ProviderName Microsoft-Windows-StorageReplica -max 10</code> <br> <code>Set-SRPartnership -ReplicationMode Asynchronous</code> переключить режим репликации на асинхронный <br> <code>Set-SRPartnership -NewSourceComputerName srv-02 -SourceRGName srv-02-rep-group-01 -DestinationComputerName srv-01 -DestinationRGName srv-01-rep-group-01</code> изменить вручную направление репликации данных, переведя вторичную копию в онлайн режим (при выходе из строя основного сервера) <br> <code>Get-SRGroup</code> информация о состояние группы реплизации <br> <code>Get-SRPartnerShip</code> информация о направлении репликации <br> <code>(Get-SRGroup).Replicas | Select-Object numofbytesremaining</code> проверить длину очереди копирования <br> <code>Get-SRPartnership | Remove-SRPartnership</code> удалить реплизацию на основном сервере <br> <code>Get-SRGroup | Remove-SRGroup</code> удалить реплизацию на обоих серверах<h2 id=ps2exe><a aria-label="Anchor link for: ps2exe" class=zola-anchor href=#ps2exe><i class=icon></i></a> PS2EXE</h2><p><code>Install-Module ps2exe -Repository PSGallery</code> <br> <code>Get-Module -ListAvailable</code> список всех модулей <br> <code>-noConsole</code> использовать GUI, без окна консоли powershell <br> <code>-noOutput</code> выполнение в фоне <br> <code>-noError</code> без вывода ошибок <br> <code>-requireAdmin</code> при запуске запросить права администратора <br> <code>-credentialGUI</code> вывод диалогового окна для ввода учетных данных <br> <code>Invoke-ps2exe -inputFile "$home\Desktop\WinEvent-Viewer-1.1.ps1" -outputFile "$home\Desktop\WEV-1.1.exe" -iconFile "$home\Desktop\log_48px.ico" -title "WinEvent-Viewer" -noConsole -noOutput -noError</code><h2 id=nssm><a aria-label="Anchor link for: nssm" class=zola-anchor href=#nssm><i class=icon></i></a> NSSM</h2><p><code>$powershell_Path = (Get-Command powershell).Source</code> <br> <code>$NSSM_Path = (Get-Command "C:\WinPerf-Agent\NSSM-2.24.exe").Source</code> <br> <code>$Script_Path = "C:\WinPerf-Agent\WinPerf-Agent-1.1.ps1"</code> <br> <code>$Service_Name = "WinPerf-Agent"</code> <br> <code>& $NSSM_Path install $Service_Name $powershell_Path -ExecutionPolicy Bypass -NoProfile -f $Script_Path</code> создать Service <br> <code>& $NSSM_Path start $Service_Name</code> запустить <br> <code>& $NSSM_Path status $Service_Name</code> статус <br> <code>$Service_Name | Restart-Service</code> перезапустить <br> <code>$Service_Name | Get-Service</code> статус <br> <code>$Service_Name | Stop-Service</code> остановить <br> <code>& $NSSM_Path set $Service_Name description "Check performance CPU and report email"</code> изменить описание <br> <code>& $NSSM_Path remove $Service_Name</code> удалить<h2 id=jobs><a aria-label="Anchor link for: jobs" class=zola-anchor href=#jobs><i class=icon></i></a> Jobs</h2><p><code>Get-Job</code> получение списка задач <br> <code>Start-Job</code> запуск процесса <br> <code>Stop-Job</code> остановка процесса <br> <code>Suspend-Job</code> приостановка работы процесса <br> <code>Resume-Job</code> восстановление работы процесса <br> <code>Wait-Job</code> ожидание вывода команды <br> <code>Receive-Job</code> получение результатов выполненного процесса <br> <code>Remove-Job</code> удалить задачу<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-PingJob</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d{1,3}$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>4</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>4</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создаем задания, забираем 3-ю строку вывода и добавляем к выводу ip-адрес<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Start-Job</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:ip</span> : <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:ip</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-Null</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-Job</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.State<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> забираем статус последнего задания (задания выполняются по очереди сверху вниз)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span> <span class="z-keyword z-operator z-comparison z-powershell">-like</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Completed<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> проверяем задание на выполнение<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping_out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Job</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Receive-Job</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> если выполнено, забираем вывод всех заданий<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-support z-function z-powershell">Get-Job</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Remove-Job</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> удаляем задания<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-keyword z-control z-powershell">break</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> завершаем цикл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping_out</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Start-PingJob -Network 192.168.3.0</code> <br> <code>$(Measure-Command {Start-PingJob -Network 192.168.3.0}).TotalSeconds</code> 60 Seconds<h3 id=threadjob><a aria-label="Anchor link for: threadjob" class=zola-anchor href=#threadjob><i class=icon></i></a> ThreadJob</h3><p><code>Install-Module -Name ThreadJob</code> <br> <code>Get-Module ThreadJob -list</code> <br> <code>Start-ThreadJob {ping ya.ru} | Out-Null</code> создать фоновую задачу <br> <code>Get-Job | Receive-Job -Keep</code> отобразить и не удалять вывод <br> <code>(Get-Job).HasMoreData</code> если False, то вывод команы удален <br> <code>(Get-Job)[-1].Output</code> отобразить вывод последней задачи<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-PingThreadJob</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d{1,3}$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>4</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>4</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Start-ThreadJob</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:ip</span> : <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:ip</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-Null</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-Job</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.State<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span> <span class="z-keyword z-operator z-comparison z-powershell">-like</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Completed<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping_out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Job</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Receive-Job</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-support z-function z-powershell">Get-Job</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Remove-Job</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-keyword z-control z-powershell">break</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping_out</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Start-PingThreadJob -Network 192.168.3.0</code> <br> <code>$(Measure-Command {Start-PingThread -Network 192.168.3.0}).TotalSeconds</code> 24 Seconds<h3 id=poshrsjob><a aria-label="Anchor link for: poshrsjob" class=zola-anchor href=#poshrsjob><i class=icon></i></a> PoshRSJob</h3><p>Install-Module -Name PoshRSJob<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-PingRSJob</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d{1,3}$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>4</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>4</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Start-RSJob</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:ip</span> : <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:ip</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-Null</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-RSJob</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.State <span class="z-keyword z-operator z-comparison z-powershell">-notcontains</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Running<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> проверяем, что массив не содержит активных заданий<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping_out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-RSJob</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Receive-RSJob</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-support z-function z-powershell">Get-RSJob</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Remove-RSJob</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-keyword z-control z-powershell">break</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping_out</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Start-PingRSJob -Network 192.168.3.0</code> <br> <code>$(Measure-Command {Start-PingRSJob -Network 192.168.3.0}).TotalSeconds</code> 10 Seconds<h3 id=invoke-parallel><a aria-label="Anchor link for: invoke-parallel" class=zola-anchor href=#invoke-parallel><i class=icon></i></a> Invoke-Parallel</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Import function from GitHub to current session<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>module</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://raw.githubusercontent.com/RamblingCookieMonster/Invoke-Parallel/master/Invoke-Parallel/Invoke-Parallel.ps1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-Expression</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>module</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></code></pre><p>Get-Help Invoke-Parallel -Full<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-PingInvokeParallel</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d{1,3}$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srvList</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Invoke-Parallel</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>InputObject <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srvList</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ScriptBlock <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> : <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Start-PingInvokeParallel -Network 192.168.3.0</code> <br> <code>$(Get-History)[-1].Duration.TotalSeconds</code> 7 seconds<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_main</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">10</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-Parallel</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>InputObject <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_main<span class="z-variable z-other z-member z-powershell">.Count</span></span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ScriptBlock <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">100</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Milliseconds <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Progress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Activity <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_main</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PercentComplete <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>id <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ImportVariables
</span></code></pre><h3 id=foreach-object-parallel><a aria-label="Anchor link for: foreach-object-parallel" class=zola-anchor href=#foreach-object-parallel><i class=icon></i></a> ForEach-Object-Parallel</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-PingParallel</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d{1,3}$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Parallel <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:RNetwork</span>.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> : <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:RNetwork</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ThrottleLimit <span class="z-constant z-numeric z-integer z-powershell">254</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Start-PingParallel -Network 192.168.3.0</code> <br> <code>$(Get-History)[-1].Duration.TotalSeconds</code> 2 seconds<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-TestConnectParallel</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Csv</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d{1,3}$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>csv</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Address,Status,Latency<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Parallel <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Test-Connection</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:RNetwork</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Count <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>TimeoutSeconds <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:csv</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:RNetwork</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span>,<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test<span class="z-variable z-other z-member z-powershell">.Status</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>,<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test<span class="z-variable z-other z-member z-powershell">.Latency</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ThrottleLimit <span class="z-constant z-numeric z-integer z-powershell">254</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Start-TestConnectParallel -Network 192.168.3.0 -Csv | ConvertFrom-Csv</code> <br> <code>$(Get-History)[-1].Duration.TotalSeconds</code> 3 seconds<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_main</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">10</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_main<span class="z-variable z-other z-member z-powershell">.Count</span></span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Parallel <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">100</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Milliseconds <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_temp</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:array_main</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Progress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Activity <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_temp</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PercentComplete <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>id <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ThrottleLimit <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_main<span class="z-variable z-other z-member z-powershell">.Count</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></code></pre><h2 id=smtp><a aria-label="Anchor link for: smtp" class=zola-anchor href=#smtp><i class=icon></i></a> SMTP</h2><h3 id=net-mail><a aria-label="Anchor link for: net-mail" class=zola-anchor href=#net-mail><i class=icon></i></a> Net.Mail</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Send-SMTP</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mess</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv_smtp</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>smtp.yandex.ru<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>587<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>from</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>login1@yandex.ru<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>to</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>login2@yandex.ru<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>login1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pass</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>password<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>subject</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>PowerShell<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Message</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Net.Mail.MailMessage
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Message<span class="z-variable z-other z-member z-powershell">.From</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>from</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Message<span class="z-variable z-other z-member z-powershell">.To.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>to</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Message<span class="z-variable z-other z-member z-powershell">.Subject</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>subject</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Message<span class="z-variable z-other z-member z-powershell">.IsBodyHTML</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Message<span class="z-variable z-other z-member z-powershell">.Body</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTh1> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mess</span> &LT/h1><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>smtp</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> Net.Mail.SmtpClient<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv_smtp</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>smtp<span class="z-variable z-other z-member z-powershell">.EnableSSL</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>smtp<span class="z-variable z-other z-member z-powershell">.Credentials</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Net.NetworkCredential<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pass</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>smtp<span class="z-variable z-other z-member z-powershell">.Send</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Message</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Send-SMTP "This is a test email from PowerShell"</code><h3 id=smtp-over-openssl><a aria-label="Anchor link for: smtp-over-openssl" class=zola-anchor href=#smtp-over-openssl><i class=icon></i></a> SMTP over OpenSSL</h3><pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Получить логин и пароль в формате Base64</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">-</span>n</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>fromUserName@yandex.ru<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">base64 <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> ZnJvbVVzZXJOYW1lQHlhbmRleC5ydQ==</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">-</span>n</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>app-password<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">base64 <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> YXBwLXBhc3N3b3Jk</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Подключаемся к серверу через OpenSSL и авторизуемся</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">openssl</span></span><span class="z-meta z-function-call z-arguments z-shell"> s_client<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>connect</span> smtp.yandex.ru:465<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>crlf</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>quiet</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> 220 Ok</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">EHLO</span></span><span class="z-meta z-function-call z-arguments z-shell"> hv-dev-101</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">AUTH</span></span><span class="z-meta z-function-call z-arguments z-shell"> LOGIN</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">ZnJvbVVzZXJOYW1lQHlhbmRleC5ydQ</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">=</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">YXBwLXBhc3N3b3Jk</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> 235 Authentication successful</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Отправляем письмо</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">MAIL</span></span><span class="z-meta z-function-call z-arguments z-shell"> FROM:<span class="z-keyword z-operator z-assignment z-redirection z-shell"><</span>fromUserName@yandex.ru<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">RCPT</span></span><span class="z-meta z-function-call z-arguments z-shell"> TO:<span class="z-keyword z-operator z-assignment z-redirection z-shell"><</span>toUserName@yandex.ru<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">DATA</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Subject:</span></span><span class="z-meta z-function-call z-arguments z-shell"> OpenSSL</span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Отделить тему от тела письма пустой строкой</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">This</span></span><span class="z-meta z-function-call z-arguments z-shell"> is a test email from OpenSSL</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-dot z-shell">.</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> 250 Ok</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></code></pre><h3 id=swaks><a aria-label="Anchor link for: swaks" class=zola-anchor href=#swaks><i class=icon></i></a> Swaks</h3><p><a href=https://github.com/jetmore/swaks>Swaks</a> - SMTP клиент на Perl<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">swaks</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>from</span> fromUserName@yandex.ru <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">    --</span>to</span> toUserName@yandex.ru <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">    --</span>server</span> smtp.yandex.ru <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">    --</span>port</span> 587 <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">    --</span>auth</span> LOGIN <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">    --</span>auth-user</span> fromUserName@yandex.ru <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">    --</span>auth-password</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>app-password<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">    --</span>tls</span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">    --</span>header</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Subject: Test Subject<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">    --</span>body</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>This is the body test from swaks<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span></code></pre><h2 id=vmware-powercli><a aria-label="Anchor link for: vmware-powercli" class=zola-anchor href=#vmware-powercli><i class=icon></i></a> VMWare/PowerCLI</h2><p><code>Install-Module -Name VMware.PowerCLI # -AllowClobber</code> установить модуль (PackageProvider: nuget) <br> <code>Get-Module -ListAvailable VMware* | Select Name,Version</code> <br> <code>Import-Module VMware.VimAutomation.Core</code> импортировать в сессию <br> <code>Get-PSProvider | format-list Name,PSSnapIn,ModuleName</code> список оснасток Windows PowerShell<p><code>Get-PowerCLIConfiguration</code> конфигурация подключения <br> <code>Set-PowerCLIConfiguration -Scope AllUsers -InvalidCertificateAction ignore -confirm:$false</code> eсли используется самоподписанный сертификат, изменить значение параметра InvalidCertificateAction с Unset на Ignore/Warn <br> <code>Set-PowerCLIConfiguration -Scope AllUsers -ParticipateInCeip $false</code> отключить уведомление сбора данных через VMware Customer Experience Improvement Program (CEIP)<p><code>Read-Host –AsSecureString | ConvertFrom-SecureString | Out-File "$home\Documents\vcsa_password.txt"</code> зашифровать пароль и сохранить в файл <br> <code>$esxi = "vcsa.domain.local"</code> <br> <code>$user = "administrator@vsphere.local"</code> <br> <code>$pass = Get-Content "$home\Documents\vcsa_password.txt" | ConvertTo-SecureString</code> прочитать пароль <br> <code>$pass = "password"</code> <br> <code>$Cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $user ,$pass</code> <br> <code>Connect-VIServer $esxi -User $Cred.Username -Password $Cred.GetNetworkCredential().password</code> подключиться, используя PSCredential ($Cred) <br> <code>Connect-VIServer $esxi -User $user -Password $pass</code> подключиться, используя логин и пароль<p><code>Get-Command –Module *vmware*</code> отобразить список команд модуля VMware <br> <code>Get-Command –Module *vmware* -name *get*iscsi*</code> найти команды модуля VMware, связанные с iSCSI <br> <code>Get-IScsiHbaTarget</code> получить цели iSCSI HBA (Host Bus Adapter) <br> <code>Get-Datacenter</code> получить список датацентров в инфраструктуре VMware <br> <code>Get-Cluster</code> список кластеров <br> <code>Get-VMHost</code> список хостов виртуальных машин (ESXi хостов) <br> <code>Get-VMHost | Select-Object Name,Model,ProcessorType,MaxEVCMode,NumCpu,CpuTotalMhz,CpuUsageMhz,MemoryTotalGB,MemoryUsageGB</code> получить информацию о хостах виртуальных машин, включая имя, модель, тип процессора и использование ресурсов <br> <code>Get-VMHostDisk | Select-Object VMHost,ScsiLun,TotalSectors</code> получить информацию о дисках хостов виртуальных машин, включая хост, SCSI LUN и общее количество секторов<p><code>Get-Datastore</code> список всех хранилищ данных <br> <code>Get-Datastore TNAS-vmfs-4tb-01</code> получить информацию о хранилище данных с именем TNAS-vmfs-4tb-01 <br> <code>Get-Datastore TNAS-vmfs-4tb-01 | get-vm</code> получить список виртуальных машин, которые используют хранилище данных <br> <code>Get-Datastore -RelatedObject vm-01</code> получить информацию о хранилищах данных, связанных с виртуальной машиной <br> <code>$(Get-Datastore TNAS-vmfs-4tb-01).ExtensionData.Info.GetType()</code> получить тип информации о хранилище данных <br> <code>$(Get-Datastore TNAS-vmfs-4tb-01).ExtensionData.Info.Vmfs.Extent</code> получить информацию о том, на каких дисках находится хранилище данных<p><code>Get-Command –Module *vmware* -name *disk*</code> найти команды модуля VMware, связанные с дисками <br> <code>Get-VM vm-01 | Get-Datastore</code> получить информацию о хранилищах данных, используемых виртуальной машиной <br> <code>Get-VM vm-01 | Get-HardDisk</code> получить информацию о подключенных дисках к виртуальной машины <br> <code>Get-VM | Get-HardDisk | select Parent,Name,CapacityGB,StorageFormat,FileName | ft</code> получить информацию о дисках всех виртуальных машин, включая родительскую ВМ, имя, емкость, формат и имя файла <br> <code>Copy-HardDisk</code> скопировать жесткий диск виртуальной машины <br> <code>Get-VM | Get-Snapshot</code> список всех снимков виртуальных машин <br> <code>Get-VM | where {$_.Powerstate -eq "PoweredOn"}</code> список всех включенных виртуальных машин <br> <code>Get-VMHost esxi-05 | Get-VM | where {$_.Powerstate -eq "PoweredOff"} | Move-VM –Destination (Get-VMHost esxi-06)</code> переместить все выключенные виртуальные машины с хоста esxi-05 на хост esxi-06<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-VM</span> <span class="z-keyword z-operator z-other z-powershell">|</span> select Name<span class="z-keyword z-operator z-other z-powershell">,</span>VMHost<span class="z-keyword z-operator z-other z-powershell">,</span>PowerState<span class="z-keyword z-operator z-other z-powershell">,</span>NumCpu<span class="z-keyword z-operator z-other z-powershell">,</span>MemoryGB<span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>UsedSpaceGB<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int32</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.UsedSpaceGB</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ProvisionedSpaceGB<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int32</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.ProvisionedSpaceGB</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell">CreateDate<span class="z-keyword z-operator z-other z-powershell">,</span>CpuHotAddEnabled<span class="z-keyword z-operator z-other z-powershell">,</span>MemoryHotAddEnabled<span class="z-keyword z-operator z-other z-powershell">,</span>CpuHotRemoveEnabled<span class="z-keyword z-operator z-other z-powershell">,</span>Notes
</span></code></pre><p><code>Get-VMGuest vm-01 | Update-Tools</code> обновить VMware Tools на виртуальной машине vm-01 <br> <code>Get-VMGuest vm-01 | select OSFullName,IPAddress,HostName,State,Disks,Nics,ToolsVersion</code> получить информацию о гостевой операционной системе виртуальной машины vm-01 (имя ОС, IP-адрес, имя хоста, состояние, диски, сетевые адаптеры и версию VMware Tools) <br> <code>Get-VMGuest * | select -ExpandProperty IPAddress</code> получить IP-адреса всех гостевых ОС виртуальных машин <br> <code>Restart-VMGuest -vm vm-01 -Confirm:$False</code> перезагрузить гостевую ОС виртуальной машины без запроса подтверждения <br> <code>Start-VM -vm vm-01 -Confirm:$False</code> включить виртуальную машину без запроса подтверждения <br> <code>Shutdown-VMGuest -vm vm-01 -Confirm:$false</code> выключить<p><code>New-VM –Name vm-01 -VMHost esxi-06 –ResourcePool Production –DiskGB 60 –DiskStorageFormat Thin –Datastore TNAS-vmfs-4tb-01</code> создать новую виртуальную машину vm-01 на хосте esxi-06 в пуле ресурсов Production с диском 60 ГБ в формате Thin и размещением на хранилище данных TNAS-vmfs-4tb-01<p><code>Get-VM vm-01 | Copy-VMGuestFile -Source "\\$srv\Install\Soft\Btest.exe" -Destination "C:\Install\" -LocalToGuest -GuestUser USER -GuestPassword PASS -force</code> Скопировать файл с хоста на гостевую ОС виртуальной машины vm-01 с принудительным выполнением<p><code>Get-VM -name vm-01 | Export-VApp -Destination C:\Install -Format OVF</code> экспортировать виртуальную машину vm-01 в шаблон OVF (.ovf, .vmdk, .mf) <br> <code>Get-VM -name vm-01 | Export-VApp -Destination C:\Install -Format OVA</code> экспортировать виртуальную машину vm-01 в шаблон OVA<p><code>Get-VMHostNetworkAdapter | select VMHost,Name,Mac,IP,@{Label="Port Group"; Expression={$_.ExtensionData.Portgroup}} | ft</code> получить информацию о сетевых адаптерах хостов виртуальных машин, включая хост, имя, MAC-адрес, IP-адрес и портовую группу <br> <code>Get-VM | Get-NetworkAdapter | select Parent,Name,Id,Type,MacAddress,ConnectionState,WakeOnLanEnabled | ft</code> получить информацию о сетевых адаптерах виртуальных машин, включая родительскую ВМ, имя, идентификатор, тип, MAC-адрес, состояние подключения и поддержку Wake-on-LAN<p><code>Get-Command –Module *vmware* -name *event*</code> <br> <code>Get-VIEvent -MaxSamples 1000 | where {($_.FullFormattedMessage -match "power")} | select username,CreatedTime,FullFormattedMessage</code> получить последние 1000 событий, связанных с питанием, включая имя пользователя, время создания и полное сообщение <br> <code>Get-logtype | select Key,SourceEntityId,Filename,Creator,Info</code> получить информацию о типах логов <br> <code>$(Get-Log vpxd:vpxd.log).Entries | select -Last 50</code> получить последние 50 записей из лога vpxd<p><code>Get-Command –Module *vmware* -name *syslog*</code> <br> <code>Set-VMHostSysLogServer -VMHost esxi-05 -SysLogServer "tcp://192.168.3.100" -SysLogServerPort 3515</code> установить сервер syslog сервер для хранения системных логов для хоста esxi-05 <br> <code>Get-VMHostSysLogServer -VMHost esxi-05</code><h2 id=hyper-v><a aria-label="Anchor link for: hyper-v" class=zola-anchor href=#hyper-v><i class=icon></i></a> Hyper-V</h2><p><code>Install-WindowsFeature -Name Hyper-V -IncludeManagementTools -Restart</code> установить роль на Windows Server <br> <code>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V –All</code> установить роль на Windows Desktop <br> <code>Get-Command -Module hyper-v</code> <br> <code>Get-VMHost</code><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-VMSwitch</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>name NAT <span class="z-keyword z-operator z-assignment z-powershell">-</span>SwitchType Internal <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> создать виртуальный коммутатор и адаптер для него<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-NetAdapter</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">where</span> InterfaceDescription <span class="z-keyword z-operator z-comparison z-powershell">-match</span> Hyper<span class="z-keyword z-operator z-assignment z-powershell">-</span>V <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> список сетевых адаптеров<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-NetNat</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name LocalNat <span class="z-keyword z-operator z-assignment z-powershell">-</span>InternalIPInterfaceAddressPrefix <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.0/24<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать сеть<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-NetAdapter</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>vEthernet (NAT)<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">New-NetIPAddress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>IPAddress <span class="z-constant z-numeric z-integer z-powershell">192.168</span>.<span class="z-constant z-numeric z-integer z-powershell">3.200</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>AddressFamily IPv4 <span class="z-keyword z-operator z-assignment z-powershell">-</span>PrefixLength <span class="z-constant z-numeric z-integer z-powershell">24</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> присвоить адрес, необходимо на ВМ указать шлюз 192.168.3.200, что бы находиться за NAT, или в настройка ВМ указать соответствующий адаптер<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-NetNatStaticMapping</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NatName LocalNat <span class="z-keyword z-operator z-assignment z-powershell">-</span>Protocol TCP <span class="z-keyword z-operator z-assignment z-powershell">-</span>ExternalIPAddress <span class="z-constant z-numeric z-integer z-powershell">0.0</span>.<span class="z-constant z-numeric z-integer z-powershell">0.0</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ExternalPort <span class="z-constant z-numeric z-integer z-powershell">2222</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>InternalIPAddress <span class="z-constant z-numeric z-integer z-powershell">192.168</span>.<span class="z-constant z-numeric z-integer z-powershell">3.103</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>InternalPort <span class="z-constant z-numeric z-integer z-powershell">2121</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> проброс, вест трафик который приходит на хост Hyper-V TCP/2222, будет перенаправляться на соответствующий порт виртуальной машины за NAT.<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-NetAdapter</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">where</span> Name <span class="z-keyword z-operator z-comparison z-powershell">-match</span> NAT</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Status
</span></code></pre><p><code>Get-NetNatStaticMapping</code> отобразить пробросы (NAT) <br> <code>Get-NetNat</code> список сетей <br> <code>Remove-NetNatStaticMapping -StaticMappingID 0</code> удалить проброс <br> <code>Remove-NetNat -Name LocalNat</code> удалить сеть<p><code>New-VMSwitch -Name Local -AllowManagementOS $True -NetAdapterName "Ethernet 4" -SwitchType External</code> создать вшений (External) виртуальный коммутатор<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>VMName</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>hv-dc-01<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>VM</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>VMName</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">MemoryStartupBytes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-constant z-numeric z-integer z-powershell">4</span><span class="z-keyword z-other z-powershell">Gb</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Generation</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">NewVHDPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>D:\VM\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>VMName</span>\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>VMName</span>.vhdx<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">NewVHDSizeBytes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-constant z-numeric z-integer z-powershell">50</span><span class="z-keyword z-other z-powershell">Gb</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">BootDevice</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>VHD<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>D:\VM\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>VMName</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">SwitchName</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>NAT<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>New-VM @VM</code> создать виртуальную машину с параметрами<p><code>Set-VMDvdDrive -VMName $VMName -Path "C:\Users\Lifailon\Documents\WS-2016.iso"</code> примонтировать образ <br> <code>New-VHD -Path "D:\VM\$VMName\disk_d.vhdx" -SizeBytes 10GB</code> создать VHDX диск <br> <code>Add-VMHardDiskDrive -VMName $VMName -Path "D:\VM\$VMName\disk_d.vhdx"</code> примонтировать диск <br> <code>Get-VM –VMname $VMName | Set-VM –AutomaticStartAction Start</code> автозапуск <br> <code>Get-VM -Name $VMName | Set-VMMemory -StartupBytes 8Gb</code> назначить стартовый размер оперативной памяти при запуске <br> <code>Set-VMProcessor $VMName -Count 2</code> количество виртуальных процессоров (vCPU: ядер/потоков) <br> <code>Set-VMProcessor $VMName -Count 2 -Maximum 4 -Reserve 50 -RelativeWeight 200</code> указать максимальное количество выделяемых процессоров, резервируется 50% ресурсов процессора хоста и установить относительный вес 200 для приоритизации распределения ресурсов процессора относительно других виртуальных машин <br> <code>Get-VM -Name $VMName | Checkpoint-VM -SnapshotName "Snapshot-1"</code> создать снапшот <br> <code>Restore-VMCheckpoint -Name "Snapshot-1" -VMName $VMName -Confirm:$false</code> восстановление из снапшота <br> <code>Get-VM | Select -ExpandProperty NetworkAdapters | Select VMName,IPAddresses,Status</code> получить IP адрес всех ВМ<h3 id=vmconnect-via-rdcman><a aria-label="Anchor link for: vmconnect-via-rdcman" class=zola-anchor href=#vmconnect-via-rdcman><i class=icon></i></a> VMConnect via RDCMan</h3><p><code>vmconnect.exe localhost $VMHost</code> подключиться к виртуальной машине через VMConnect (используется в диспетчере Hyper-V) <br> <code>Get-NetTCPConnection -State Established,Listen | Where-Object LocalPort -Match 2179</code> найти порт слушателя <br> <code>Get-Process -Id (Get-NetTCPConnection -State Established,Listen | Where-Object LocalPort -Match 2179).OwningProcess</code> найти процесс по ID (vmms/VMConnect) <br> <code>New-NetFirewallRule -Name "Hyper-V" -DisplayName "Hyper-V" -Group "Hyper-V" -Direction Inbound -Protocol TCP -LocalPort 2179 -Action Allow -Profile Public</code> открыть порт в локальном Firewall <br> <code>Get-LocalGroupMember -Group "Администраторы Hyper-V"</code> <br> <code>Get-LocalGroupMember -Group "Hyper-V Administrators"</code> <br> <code>Add-LocalGroupMember -Group "Администраторы Hyper-V" -Member "lifailon"</code> добавить пользователя в группу администраторов (для возможности подключения) <br> <code>Get-VM * | Select-Object Name,Id</code> добавить id в RDCMan для подключения <br> <code>Grant-VMConnectAccess -ComputerName plex-01 -VMName hv-devops-01 -UserName lifailon</code> дать доступ на подключение не администратору <br> <code>Get-VMConnectAccess</code> <br> <code>Revoke-VMConnectAccess -VMName hv-devops-01 -UserName lifailon</code> забрать доступ<p>Error: <code>Unknown disconnection reason 3848</code> - добавить ключи реестра на стороне клиента<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-ItemProperty</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowFreshCredentialsDomain <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name Hyper<span class="z-keyword z-operator z-assignment z-powershell">-</span>V <span class="z-keyword z-operator z-assignment z-powershell">-</span>PropertyType String <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft Virtual Console Service/*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-ItemProperty</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowDefaultCredentials <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name Hyper<span class="z-keyword z-operator z-assignment z-powershell">-</span>V <span class="z-keyword z-operator z-assignment z-powershell">-</span>PropertyType String <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft Virtual Console Service/*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-ItemProperty</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowFreshCredentialsWhenNTLMOnlyDomain <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name Hyper<span class="z-keyword z-operator z-assignment z-powershell">-</span>V <span class="z-keyword z-operator z-assignment z-powershell">-</span>PropertyType String <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft Virtual Console Service/*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span><span class="z-source z-powershell">ItemProperty <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowDefaultCredentialsDomain <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name Hyper<span class="z-keyword z-operator z-assignment z-powershell">-</span>V <span class="z-keyword z-operator z-assignment z-powershell">-</span>PropertyType String <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft Virtual Console Service/*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-ItemProperty</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowFreshCredentials <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name Hyper<span class="z-keyword z-operator z-assignment z-powershell">-</span>V <span class="z-keyword z-operator z-assignment z-powershell">-</span>PropertyType String <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft Virtual Console Service/*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-ItemProperty</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowFreshCredentialsWhenNTLMOnly <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name Hyper<span class="z-keyword z-operator z-assignment z-powershell">-</span>V <span class="z-keyword z-operator z-assignment z-powershell">-</span>PropertyType String <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft Virtual Console Service/*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-ItemProperty</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowSavedCredentialsWhenNTLMOnly <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name Hyper<span class="z-keyword z-operator z-assignment z-powershell">-</span>V <span class="z-keyword z-operator z-assignment z-powershell">-</span>PropertyType String <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft Virtual Console Service/*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-ItemProperty</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowSavedCredentials <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name Hyper<span class="z-keyword z-operator z-assignment z-powershell">-</span>V <span class="z-keyword z-operator z-assignment z-powershell">-</span>PropertyType String <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft Virtual Console Service/*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-ItemProperty</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowSavedCredentialsDomain <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name Hyper<span class="z-keyword z-operator z-assignment z-powershell">-</span>V <span class="z-keyword z-operator z-assignment z-powershell">-</span>PropertyType String <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft Virtual Console Service/*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></code></pre><h2 id=azure><a aria-label="Anchor link for: azure" class=zola-anchor href=#azure><i class=icon></i></a> Azure</h2><p><code>Install-Module -Name Az -Scope CurrentUser -Repository PSGallery -Force</code> установить все модули для работы с Azure <br> <code>Get-Module *Az.*</code> список всех модулей<p><code>Get-Command -Module Az.Accounts</code> отобразить список команд модуля Az.Accounts <br> <code>Connect-AzAccount</code> подключиться у учетной записи Azure <br> <code>Get-AzContext</code> получить текущий статус подключения к Azure <br> <code>Get-AzSubscription</code> получить список подписок Azure, доступных для текущего пользователя <br> <code>Set-AzContext</code> установить контекст Azure для конкретной подписки и/или учетной записи <br> <code>Disconnect-AzAccount</code> отключиться от учетной записи Azure<p><code>Get-Command -Module Az.Compute</code> <br> <code>Get-AzVM</code> получить список виртуальных машин в текущей подписке или группе ресурсов <br> <code>Get-AzVMSize</code> получить список доступных размеров виртуальных машин в определенном регионе <br> <code>Get-AzVMImage</code> получить список доступных образов виртуальных машин <br> <code>New-AzVM</code> создать новую виртуальную машину <br> <code>Remove-AzVM</code> удалить виртуальную машину <br> <code>Start-AzVM</code> запустить виртуальную машину <br> <code>Stop-AzVM</code> остановить виртуальную машину <br> <code>Restart-AzVM</code> перезагрузить виртуальную машину<p><code>Get-Command -Module Az.Network</code> <br> <code>Get-AzVirtualNetwork</code> получить список виртуальных сетей в текущей подписке или группе ресурсов <br> <code>New-AzVirtualNetwork</code> создать новую виртуальную сеть <br> <code>Remove-AzVirtualNetwork</code> удалить виртуальную сеть <br> <code>Get-AzNetworkInterface</code> получить список сетевых интерфейсов <br> <code>New-AzNetworkInterface</code> создать новый сетевой интерфейс <br> <code>Remove-AzNetworkInterface</code> удалить сетевой интерфейс<p><code>Get-Command -Module Az.Storage</code> <br> <code>Get-AzStorageAccount</code> получить список учетных записей хранилища <br> <code>New-AzStorageAccount</code> создать новую учетную запись хранилища <br> <code>Remove-AzStorageAccount</code> удалить учетную запись хранилища <br> <code>Get-AzStorageContainer</code> список контейнеров в учетной записи хранилища <br> <code>New-AzStorageContainer</code> создать новый контейнер в учетной записи хранилища <br> <code>Remove-AzStorageContainer</code> удалить контейнер<p><code>Get-Command -Module Az.ResourceManager</code> <br> <code>Get-AzResourceGroup</code> получить список групп ресурсов в текущей подписке <br> <code>New-AzResourceGroup</code> создать новую группу ресурсов <br> <code>Remove-AzResourceGroup</code> удалить группу ресурсов <br> <code>Get-AzResource</code> получить список ресурсов <br> <code>New-AzResource</code> создать новый ресурс <br> <code>Remove-AzResource</code> удалить ресурс<p><code>Get-Command -Module Az.KeyVault</code> <br> <code>Get-AzKeyVault</code> список хранилищ ключей <br> <code>New-AzKeyVault</code> создать новое хранилище ключей в Azure <br> <code>Remove-AzKeyVault</code> удалить хранилище ключей в Azure<p><code>Get-Command -Module Az.Identity</code> <br> <code>Get-AzADUser</code> получить информацию о пользователях Azure Active Directory <br> <code>New-AzADUser</code> создать нового пользователя <br> <code>Remove-AzADUser</code> удалить пользователя <br> <code>Get-AzADGroup</code> получить информацию о группах <br> <code>New-AzADGroup</code> создать новую группу <br> <code>Remove-AzADGroup</code> удалить группу<h3 id=manage-vm><a aria-label="Anchor link for: manage-vm" class=zola-anchor href=#manage-vm><i class=icon></i></a> Manage-VM</h3><p>Source: https://learn.microsoft.com/ru-ru/azure/virtual-machines/windows/tutorial-manage-vm<p><code>New-AzResourceGroup -Name "Resource-Group-01" -Location "EastUS"</code> создать группу ресурсов (логический контейнер, в котором происходит развертывание ресурсов Azure) <br> <code>Get-AzVMImageOffer -Location "EastUS" -PublisherName "MicrosoftWindowsServer"</code> список доступных образов Windows Server для установки <br> <code>$cred = Get-Credential</code> <br> <code>New-AzVm -ResourceGroupName "Resource-Group-01" -Name "vm-01" -Location 'EastUS' -Image "MicrosoftWindowsServer:WindowsServer:2022-datacenter-azure-edition:latest" -Size "Standard_D2s_v3" -OpenPorts 80,3389 --Credential $cred</code> создать виртуальную машину <br> <code>Get-AzVM -ResourceGroupName "Resource-Group-01" -Name "vm-01" -Status | Select @{n="Status"; e={$_.Statuses[1].Code}}</code> статус виртуальной машины <br> <code>Start-AzVM -ResourceGroupName "Resource-Group-01" -Name "vm-01"</code> запустить виртуальную машину <br> <code>Stop-AzVM -ResourceGroupName "Resource-Group-01" -Name "vm-01" -Force</code> остановить виртуальную машину <br> <code>Invoke-AzVMRunCommand -ResourceGroupName "Resource-Group-01" -VMName "vm-01" -CommandId "RunPowerShellScript" -ScriptString "Install-WindowsFeature -Name Web-Server -IncludeManagementTools"</code> установить роль веб-сервера IIS<h3 id=manage-disk><a aria-label="Anchor link for: manage-disk" class=zola-anchor href=#manage-disk><i class=icon></i></a> Manage-Disk</h3><p>Source: https://learn.microsoft.com/ru-ru/azure/virtual-machines/windows/tutorial-manage-data-disk<p><code>$diskConfig = New-AzDiskConfig -Location "EastUS" -CreateOption Empty -DiskSizeGB 512 -SkuName "Standard_LRS"</code> создать диск на 512 Гб <br> <code>$dataDisk = New-AzDisk -ResourceGroupName "Resource-Group-01" -DiskName "disk-512" -Disk $diskConfig</code> создание объекта диска для подготовки диска данных к работе <br> <code>Get-AzDisk -ResourceGroupName "Resource-Group-01" -DiskName "disk-512"</code> список дисков <br> <code>$vm = Get-AzVM -ResourceGroupName "Resource-Group-01" -Name "vm-01"</code> <br> <code>Add-AzVMDataDisk -VM $vm -Name "Resource-Group-01" -CreateOption Attach -ManagedDiskId $dataDisk.Id -Lun 1</code> подключить диск к виртуальной машине <br> <code>Update-AzVM -ResourceGroupName "Resource-Group-01" -VM $vm</code> обновить конфигурацию виртуальной машины <br> <code>Get-Disk | Where PartitionStyle -eq 'raw' | Initialize-Disk -PartitionStyle MBR -PassThru | New-Partition -AssignDriveLetter -UseMaximumSize | Format-Volume -FileSystem NTFS -NewFileSystemLabel "disk-512" -Confirm:$false</code> инициализировать диск в ОС (необходимо подключиться к виртуальной машине) с таблицей MBR, создать раздел и назначить все пространство и форматировать в файловую систему NTFS<h2 id=exchange-emshell><a aria-label="Anchor link for: exchange-emshell" class=zola-anchor href=#exchange-emshell><i class=icon></i></a> Exchange/EMShell</h2><p><code>$srv_cas = "exchange-cas"</code> <br> <code>$session_exchange = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://$srv_cas/PowerShell/</code> -Credential $Cred -Authentication Kerberos <br> <code>Get-PSSession</code> <br> <code>Import-PSSession $session_exchange -DisableNameChecking</code> импортировать в текущую сессию<p><code>Get-ExchangeServer | select name,serverrole,admindisplayversion,Edition,OriginatingServer,WhenCreated,WhenChanged,DataPath | ft</code> список всех серверов<p><code>Get-ImapSettings</code> настройки IMAP <br> <code>Get-ExchangeCertificate</code> список сертификатов <br> <code>Get-ExchangeCertificate -Thumbprint "5CEC8544D4743BC279E5FEA1679F79F5BD0C2B3A" | Enable-ExchangeCertificate -Services  IMAP, POP, IIS, SMTP</code> <br> <code>iisreset</code> <br> <code>Get-ClientAccessService | fl identity, *uri*</code> настройки службы автообнаружения в Exchange 2016 <br> <code>Get-ClientAccessService -Identity $srv | Set-ClientAccessService -AutoDiscoverServiceInternalUri https://mail.domain.ru/Autodiscover/Autodiscover.xml</code> изменить на внешний адрес <br> <code>Get-OutlookAnywhere</code> OA позволяет клиентам Outlook подключаться к своим почтовым ящикам за пределами локальной сети (без использования VPN) <br> <code>Get-WebServicesVirtualDirectory</code> <br> <code>Get-OwaVirtualDirectory</code> <br> <code>Get-ActiveSyncVirtualDirectory</code> <br> <code>Get-OabVirtualDirectory</code> виртуальная директория автономной адресной книги <br> <code>Get-OabVirtualDirectory -Server $srv | Set-OabVirtualDirectory -InternalUrl "https://mail.domain.ru/OAB" -ExternalUrl "https://mail.domain.ru/OAB"</code><h3 id=roles><a aria-label="Anchor link for: roles" class=zola-anchor href=#roles><i class=icon></i></a> Roles</h3><p>MS (Mailbox) - сервер с БД почтовых ящиков и общих папок, отвечает только за их размещение и не выполняет маршрутизацию никаких сообщений. <br> CAS (Client Access Server) - обработка клиентских подключений к почтовым ящикам, которые создаются клиентами Outlook Web Access (HTTP для Outlook Web App), Outlook Anywhere, ActiveSync (для мобильных устройств), интернет протоколы POP3 и IMAP4, MAPI для клиентов Microsoft Outlook. <br> Hub Transort - ответвечает за маршрутизацию сообщений интернета и инфраструктурой Exchange, а также между серверами Exchange. Сообщения всегда маршрутизируются с помощью роли транспортного сервера-концентратора, даже если почтовые ящики источника и назначения находятся в одной базе данных почтовых ящиков. <br> Relay - роль пограничного транспортного сервера (шлюз SMTP в периметре сети).<p>SCP (Service Connection Point) - запись прописывается в AD, при создание сервера CAS. Outlook запрашивает SCP, выбирает те, которые находятся в одном сайте с ним и по параметру WhenCreated – по дате создания, выбирая самый старый. <br> Autodiscover. Outlook выбирает в качестве сервера Client Access тот, который прописан в атрибуте RPCClientAccessServer базы данных пользователя. Сведения о базе данных и сервере mailbox, на котором она лежит, берутся из AD.<h3 id=messagetrackinglog><a aria-label="Anchor link for: messagetrackinglog" class=zola-anchor href=#messagetrackinglog><i class=icon></i></a> MessageTrackingLog</h3><p><code>Get-MessageTrackingLog -ResultSize Unlimited | select Timestamp,Sender,Recipients,RecipientCount,MessageSubject,Source,EventID,ClientHostname,ServerHostname,ConnectorId, @{Name="MessageSize"; Expression={[string]([int]($_.TotalBytes / 1024))+" KB"}},@{Name="MessageLatency"; Expression={$_.MessageLatency -replace "\.\d+$"}}</code> <br> <code>Get-MessageTrackingLog -Start (Get-Date).AddHours(-24) -ResultSize Unlimited | where {[string]$_.recipients -like "*@yandex.ru"}</code> вывести сообщения за последние 24 часа, где получателем был указанный домен <br> -Start “04/01/2023 09:00:00” -End “04/01/2023 18:00:00” - поиск по указанному промежутку времени <br> -MessageSubject “Тест” - поиск по теме письма <br> -Recipients “support4@domain.ru” - поиск по получателю <br> -Sender - поиск по отправителю <br> -EventID – поиск по коду события сервера (RECEIVE, SEND, FAIL, DSN, DELIVER, BADMAIL, RESOLVE, EXPAND, REDIRECT, TRANSFER, SUBMIT, POISONMESSAGE, DEFER) <br> -Server – поиск на определенном транспортном сервере <br> -messageID – трекинг письма по его ID<h3 id=mailbox><a aria-label="Anchor link for: mailbox" class=zola-anchor href=#mailbox><i class=icon></i></a> Mailbox</h3><p><code>Get-Mailbox -Database "it2"</code> список почтовых серверов в базе данных <br> <code>Get-Mailbox -resultsize unlimited | ? Emailaddresses -like "support4" | format-list name,emailaddresses,database,servername</code> какую БД, сервер и smtp-адреса использует почтовый ящик <br> <code>Get-Mailbox -Database $db_name -Archive</code> отобразить архивные почтовые ящики<p><code>Get-MailboxFolderStatistics -Identity "support4" -FolderScope All | select Name,ItemsInFolder,FolderSize</code> отобразить кол-во писем и размер в каждой папке <br> <code>Get-MailboxStatistics "support4" | select DisplayName,LastLoggedOnUserAccount,LastLogonTime,LastLogoffTime,ItemCount,TotalItemSize,DeletedItemCount,TotalDeletedItemSize,Database,ServerName</code> общее кол-во писем, их размер, время последнего входа и выхода, имя сервера и БД <br> <code>Get-Mailbox -Server s2 | Get-MailboxStatistics | where {$_.Lastlogontime -lt (get-date).AddDays(-30)} | Sort Lastlogontime -desc | ft displayname,Lastlogontime,totalitemsize</code> ящики, которые не использовались 30 и более дней<p><code>Enable-Mailbox -Identity support9 -Database test_base</code> создать почтовый ящик для существующего пользователя в AD <br> <code>New-Mailbox -Name $login -UserPrincipalName "$login@$domain" -Database $select_db -OrganizationalUnit $path -Password (ConvertTo-SecureString -String "$password" -AsPlainText -Force)</code> создать новый почтовый ящик без привязки к пользователю AD <br> <code>Get-MailboxDatabase -Database $db_name | Remove-MailboxDatabase</code> удалить БД<p><code>Set-MailBox "support4" -PrimarySmtpAddress support24@domain.ru -EmailAddressPolicyEnabled $false</code> добавить и изменить основной SMTP-адрес электронной почты для пользователя <br> <code>Set-Mailbox -Identity "support4" -DeliverToMailboxAndForward $true -ForwardingSMTPAddress "username@outlook.com"</code> включить переадресацию почты (электронная почта попадает в почтовый ящик пользователя support4 и одновременно пересылается по адресу username@outlook.com)<h3 id=moverequest><a aria-label="Anchor link for: moverequest" class=zola-anchor href=#moverequest><i class=icon></i></a> MoveRequest</h3><p><code>Get-Mailbox -Database $db_in | New-MoveRequest -TargetDatabase $db_out</code> переместить все почтовые ящики из одной БД в другую <br> <code>New-MoveRequest -Identity $db_in -TargetDatabase $db_out</code> переместить один почтовый ящик <br> <code>Get-MoveRequest | Suspend-MoveRequest</code> остановить запросы перемещения <br> <code>Get-MoveRequest | Remove-MoveRequest</code> удалить запросы на перемещение <br> <code>Get-MoveRequest | Get-MoveRequestStatistics</code> статус перемещения<p>Status: <br> Cleanup - нужно подождать <br> Queued - в очереди <br> InProgress - в процессе <br> Percent Complete - процент выполнения <br> CompletionInProgress - завершение процесса <br> Completed - завершено<p><code>Remove-MoveRequest -Identity $db_name</code> завершить процесс перемещения (убрать статус перемещения с почтового ящика и очистить список перемещений) <br> <code>Get-MailboxDatabase | Select Name, MailboxRetention</code> после перемещения ящиков, размер базы не изменится, полное удаление из базы произойдет, как пройдет количество дней, выставленное в параметре MailboxRetention <br> <code>Set-MailboxDatabase -MailboxRetention '0.00:00:00' -Identity $db_name</code> изменить значение<h3 id=archive-1><a aria-label="Anchor link for: archive-1" class=zola-anchor href=#archive-1><i class=icon></i></a> Archive</h3><p><code>Enable-Mailbox -Identity $name -Archive</code> включить архив для пользователя <br> <code>Get-Mailbox $name | New-MoveReques –ArchiveOnly –ArchiveTargetDatabase DBArch</code> переместить архивный почтовый ящик в другую БД <br> <code>Get-Mailbox $name | fl Name,Database,ArchiveDatabase</code> место расположения БД пользователя и БД его архива <br> <code>Disable-Mailbox -Identity $name -Archive</code> отключить архив <br> <code>Connect-Mailbox -Identity "8734c04e-981e-4ccf-a547-1c1ac7ebf3e2" -Archive -User $name -Database it2</code> подключение архива пользователя к указанному почтовому ящику <br> <code>Get-Mailbox $name | Set-Mailbox -ArchiveQuota 20GB -ArchiveWarningQuota 19GB</code> настроить квоты хранения архива<h3 id=quota><a aria-label="Anchor link for: quota" class=zola-anchor href=#quota><i class=icon></i></a> Quota</h3><p><code>Get-Mailbox -Identity $mailbox | fl IssueWarningQuota, ProhibitSendQuota, ProhibitSendReceiveQuota, UseDatabaseQuotaDefaults</code> отобразить квоты почтового ящика <br> IssueWarningQuota — квота, при достижении которой Exchange отправит уведомление <br> ProhibitSendQuota — при достижении будет запрещена отправка <br> ProhibitSendReceiveQuota — при достижении будет запрещена отправка и получение <br> UseDatabaseQuotaDefaults — используется ли квота БД или false - индвидиуальные <br> <code>Set-Mailbox -Identity $mailbox -UseDatabaseQuotaDefaults $false -IssueWarningQuota "3 GB" -ProhibitSendQuota "4 GB" -ProhibitSendReceiveQuota "5 GB"</code> задать квоту для пользователя<p><code>Get-MailboxDatabase $db_name | fl Name, *Quota</code> отобразить квоты наложенные на БД <br> <code>Set-MailboxDatabase $db -ProhibitSendReceiveQuota "5 GB" -ProhibitSendQuota "4 GB" -IssueWarningQuota "3 GB"</code> настроить квоты на БД<h3 id=database><a aria-label="Anchor link for: database" class=zola-anchor href=#database><i class=icon></i></a> Database</h3><p><code>Get-MailboxDatabase -Status | select ServerName,Name,DatabaseSize</code> список и размер всех БД на всех MX-серверах <br> <code>New-MailboxDatabase -Name it_2022 -EdbFilePath E:\Bases\it_2022\it_2022.edb -LogFolderPath G:\Logs\it_2022 -OfflineAddressBook "Default Offline Address List" -server exch-mx-01</code> создать БД <br> <code>Restart-Service MSExchangeIS</code> <br> <code>Get-Service | Where {$_ -match "exchange"} | Restart-Service</code> <br> <code>Get-MailboxDatabase -Server exch-01</code> список баз данных на MX-сервере <br> <code>New-MoveRequest -Identity "support4" -TargetDatabase it_2022</code> переместить почтовый ящик в новую БД <br> <code>Move-Databasepath $db_name –EdbFilepath "F:\DB\$db_name\$db_name.edb" –LogFolderpath "E:\DB\$db_name\logs\"</code> переместить БД и транзакционные логи на другой диск <br> <code>Set-MailboxDatabase -CircularLoggingEnabled $true -Identity $db_name</code> включить циклическое ведение журнала (Circular Logging), где последовательно пишутся 4 файла логов по 5 МБ, после чего первый лог-файл перезаписывается <br> <code>Set-MailboxDatabase -CircularLoggingEnabled $false -Identity $db_name</code> отключить циклическое ведение журнала <br> <code>Get-MailboxDatabase -Server "exch-mx-01" -Status | select EdbFilePath,LogFolderPath,LogFilePrefix</code> путь к БД, логам, имя текущего актуального лог-файла<h3 id=mailboxrepairrequest><a aria-label="Anchor link for: mailboxrepairrequest" class=zola-anchor href=#mailboxrepairrequest><i class=icon></i></a> MailboxRepairRequest</h3><p><code>New-MailboxRepairRequest -Database it2 -CorruptionType ProvisionedFolder, SearchFolder, AggregateCounts, Folderview</code> запустить последовательный тест (в конкретный момент времени не доступен один почтовый ящик) и исправление ошибок на прикладном уровне <br> <code>Get-MailboxRepairRequest -Database it2</code> прогресс выполнения <br> Позволяет исправить: <br> ProvisionedFolder – нарушения логической структуры папок <br> SearchFolder – ошибки в папках поиска <br> AggregateCounts – проверка и исправление информации о количестве элементов в папках и их размере <br> FolderView – неверное содержимое, отображаемое представлениями папок<h3 id=eseutil><a aria-label="Anchor link for: eseutil" class=zola-anchor href=#eseutil><i class=icon></i></a> eseutil</h3><p>При отправке/получении любого письма Exchange сначала вносит информацию в транзакционный лог, и только потом сохраняет элемент непосредственно в базу данных. Размер одного лог файла - 1 Мб. Есть три способа урезания логов: DAG, Backup на базе Volume Shadow Copy, Circular Logging.<p>Ручное удаление журналов транзакций: <br> <code>cd E:\MS_Exchange_2010\MailBox\Reg_v1_MailBoxes\</code> перейти в каталог с логами <br> <code>ls E*.chk</code> узнать имя файла, в котором находится информация из контрольной точки фиксации журналов <br> <code>eseutil /mk .\E18.chk</code> узнать последний файл журнала, действия из которого были занесены в БД Exchange <br> <code>Checkpoint: (0x561299,8,16)</code> 561299 имя файла, который был последним зафиксирован (его информация уже в базе данных) <br> Находим в проводнике файл E0500561299.txt, можно удалять все файлы журналов, которые старше найденного файла<p>Восстановление БД (если две копии БД с ошибкой): <br> <code>Get-MailboxDatabaseCopyStatus -Identity db_name\* | Format-List Name,Status,ContentIndexState</code> <br> Status : FailedAndSuspended <br> ContentIndexState : Failed <br> Status : Dismounted <br> ContentIndexState : Failed<p><code>Get-MailboxDatabase -Server exch-mx-01 -Status | fl Name,EdbFilePath,LogFolderPath</code> проверить расположение базы и транзакционных логов <br> LogFolderPath - директория логов <br> E18 - имя транкзакционного лога (из него читаются остальные логи) <br> <code>dismount-Database db_name</code> отмантировать БД <br> <code>eseutil /mh D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> проверить базу <br> State: Dirty Shutdown - несогласованное состояние, означает, что часть транзакций не перенесена в базу, например, после того, как была осуществлена аварийная перезагрузка сервера. <br> <code>eseutil /ml E:\MS_Exchange_2010\MailBox\db_name\E18</code> проверка целостности транзакционных логи, если есть логи транзакций и они не испорчены, то можно восстановить из них, из файла E18 считываются все логи, должен быть статус - ОК<p>Soft Recovery (мягкое восстановление) - необходимо перевести базу в состояние корректного отключения (Clear shutdown) путем записи недостающих файлов журналов транзакций в БД. <br> <code>eseutil /R E18 /l E:\MS_Exchange_2010\MailBox\db_name\ /d D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> <br> <code>eseutil /R E18 /a /i /l E:\MS_Exchange_2010\MailBox\db_name\ /d D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> если с логами что-то не так, можно попробовать восстановить базу игнорируя ошибку в логах <br> <code>eseutil /mk D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> cостоянии файла контрольных точек <br> <code>eseutil /g D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> проверка целостности БД <br> <code>eseutil /k D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> проверка контрольных сумм базы (CRC)<p>Hard Recovery - если логи содержат ошибки и база не восстанавливается, то восстанавливаем базу без логов. <br> <code>eseutil /p D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> <br> /p - удалит поврежденные страницы, эта информация будет удалена из БД и восстановит целостность <br> <code>esetuil /d D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> выполнить дефрагментацию (если был потерян большой объем данных, то может сильно снизиться производительность) <br> После выполнения команд необходимо вручную удалить все файлы с расширением log в папке MDBDATA, перед попыткой смонтировать базу данных. <br> <code>isinteg -s "db_name.edb" -test alltests</code> проверьте целостность базы данных <br> <code>isinteg -s "server_name" -fix -test -alltests</code> если проверка будет провалена. Выполнять команду до тех пор, пока у всех ошибок не станет статус 0 или статус не перестанет меняться, иногда необходимо 3 прохода для достижения результата. <br> <code>eseutil /mh D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb | Select-String -Pattern "State:","Log Required:"</code> проверить статус <br> State: Clear shutdown - успешный статус <br> <code>Log Required</code> требуются ли файлы журналов, необходимые базе, чтобы перейти в согласованное состояние. Если база размонтирована корректно, то это значение будет равняться 0. <br> <code>mount-Database -force db_name</code> примонтировать БД <br> <code>Get-MailboxDatabase –Status db_name | fl Mounted</code> статус БД <br> <code>New-MailboxRepairRequest -Database db_name -CorruptionType SearchFolder,AggregateCounts,ProvisionedFolder,FolderView</code> восстановление логической целостности данных <br> После этого восстановить Index. <br> Если индексы не восстанавливаются, но БД монтируется, то перенести почтовые ящики в новую БД.<p>Восстановление БД из Backup:<p>1-й вариант:<ol><li>Отмантировать текущую БД и удалить или переименовать директорию с файлами текущей БД.<li>Восстановить в ту же директорию из Backup базу с логами.<li>Запустить мягкое восстановление БД (Soft Recovery).<li>Примониторвать.</ol><p>2-й вариант:<ol><li>Отмантировать и удалить текущую БД.<li>Восстановить БД с логами из Backup в любое место.<li>Запустить мягкое восстановление БД (Soft Recovery).<li>Создать новую БД.<li>Создать Recovery Database и смонтировать в нее восстановленную из бэкапа БД, скопировать из неё почтовые ящики в новую БД и переключить на них пользователей.<li>Если использовать Dial Tone Recovery, то так же перенести из временной БД промежуточные данные почтовых ящиков.</ol><p>3-й вариант:<ol><li>Восстановить целостность Soft Repair или Hard Recovery.<li>Создать новую БД. Указывать в свойствах: «база может быть перезаписана при восстановлении».<li>Если база была только что оздана и еще не была подмонтирована, то эта папка будет пуста, туда перемещаем базу из Backup, которая была обработана ESEUTIL вместе со всеми файлами. Указать имя .edb такое же, которое было при создании новой базы.<li>Монтируем базу.<li>Перенацеливаем ящики со старой (Mailbox_DB_02), неисправной базы, на новую базу (Mailbox_DB_02_02): <code>Get-Mailbox -Database Mailbox_DB_02 | where {$_.ObjectClass -NotMatch '(SystemAttendantMailbox|ExOleDbSystemMailbox)'} | Set-Mailbox -Database Mailbox_DB_02_02</code><li>Восстановление логической целостности данных: <code>New-MailboxRepairRequest -Database "Mailbox_DB_02_02" -CorruptionType ProvisionedFolder, SearchFolder, AggregateCounts, Folderview</code></ol><h3 id=dial-tone-recovery><a aria-label="Anchor link for: dial-tone-recovery" class=zola-anchor href=#dial-tone-recovery><i class=icon></i></a> Dial Tone Recovery</h3><p><code>Get-Mailbox -Database "MailboxDB" | Set-Mailbox -Database "TempDB"</code> перенацелить ящики с одной БД (нерабочей) на другую (пустую) <br> <code>Get-Mailbox -Database TempDB</code> отобразить почтовые ящики в БД TempDB <br> <code>Restart-Service MSExchangeIS</code> перезапустить службу Mailbox Information Store (банка данных), иначе пользователи будут по-прежнему пытаться подключиться к старой БД <br> <code>iisreset</code> <br> <code>Get-Mailbox -Database "TempDB" | Set-Mailbox -Database "MailboxDB"</code> после восстановления старой БД, нужно переключить пользователей с временной БД обратно <br> После этого сделать слияние с временной БД с помощью Recovery.<h3 id=recovery-database-rdb><a aria-label="Anchor link for: recovery-database-rdb" class=zola-anchor href=#recovery-database-rdb><i class=icon></i></a> Recovery database (RDB)</h3><p><code>New-MailboxDatabase –Recovery –Name RecoveryDB –Server $exch_mx –EdbFilePath "D:\TempDB\TempDB.edb" -LogFolderPath "D:\TempDB"</code> для переноса новых писем из временной БД в основную необходим только сам файл TempDB.edb со статусом Clean Shutdown, из нее необходимо создать служебную БД (ключ -Recovery) <br> <code>Mount-Database "D:\TempDB\TempDB.edb"</code> примонтировать БД <br> <code>Get-MailboxStatistics -Database RecoveryDB</code> <br> <code>New-MailboxRestoreRequest –SourceDatabase RecoveryDB –SourceStoreMailbox support –TargetMailbox support</code> скопировать данные почтового ящика с DisplayName: support из RecoveryDB в почтовый ящик с псевдонимом support существующей базы. По умолчанию ищет в почтовой базе совпадающие LegacyExchangeDN либо проверяет совпадение адреса X500, если нужно восстановить данные в другой ящик, нужно указывать ключ -AllowLegacyDNMisMatch <br> <code>New-MailboxRestoreRequest –SourceDatabase RecoveryDB –SourceStoreMailbox support –TargetMailbox support –TargetRootFolder "Restore"</code> скопировать письма в отдельную папку в ящике назначения (создается автоматически), возможно восстановить содержимое конкретной папки -IncludeFolders “#Inbox#” <br> <code>Get-MailboxRestoreRequest | Get-MailboxRestoreRequestStatistics</code> статус запроса восстановления <br> <code>Get-MailboxRestoreRequestStatistics -Identity support</code> <br> <code>Get-MailboxRestoreRequest -Status Completed | Remove-MailboxRestoreRequest</code> удалить все успешные запросы<h3 id=transport><a aria-label="Anchor link for: transport" class=zola-anchor href=#transport><i class=icon></i></a> Transport</h3><p><code>Get-TransportServer $srv_cas | select MaxConcurrentMailboxDeliveries,MaxConcurrentMailboxSubmissions,MaxConnectionRatePerMinute,MaxOutboundConnections,MaxPerDomainOutboundConnections,PickupDirectoryMaxMessagesPerMinute</code> настройки пропускной способности транспортного сервера <br> MaxConcurrentMailboxDeliveries — максимальное количество одновременных потоков, которое может открыть сервер для отправки писем. <br> MaxConcurrentMailboxSubmissions — максимальное количество одновременных потоков, которое может открыть сервер для получения писем. <br> MaxConnectionRatePerMinute — максимальное возможная скорость открытия входящих соединений в минуту. <br> MaxOutboundConnections — максимальное возможное количество соединений, которое может открыть Exchange для отправки. <br> MaxPerDomainOutboundConnections — максимальное возможное количество исходящих соединений, которое может открыть Exchange для одного удаленного домена. <br> PickupDirectoryMaxMessagesPerMinute — скорость внутренней обработки сообщений в минуту (распределение писем по папкам). <br> <code>Set-TransportServer exchange-cas -MaxConcurrentMailboxDeliveries 21 -MaxConcurrentMailboxSubmissions 21 -MaxConnectionRatePerMinute 1201 -MaxOutboundConnections 1001 -MaxPerDomainOutboundConnections 21 -PickupDirectoryMaxMessagesPerMinute 101</code> изменить значения<p><code>Get-TransportConfig | select MaxSendSize, MaxReceiveSize</code> ограничение размера сообщения на уровне траспорта (наименьший приоритет, после коннектора и почтового ящика). <br> <code>New-TransportRule -Name AttachmentLimit -AttachmentSizeOver 15MB -RejectMessageReasonText "Sorry, messages with attachments over 15 MB are not accepted"</code> создать транспортное правило для проверки размера вложения<h3 id=connector><a aria-label="Anchor link for: connector" class=zola-anchor href=#connector><i class=icon></i></a> Connector</h3><p><code>Get-ReceiveConnector | select Name,MaxMessageSize,RemoteIPRanges,WhenChanged</code> ограничения размера сообщения на уровне коннектора (приоритет ниже, чем у почтового ящика) <br> <code>Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MaxMessageSize 30Mb</code> изменить размер у последнего коннектора в списке (приоритет выше, чем у траспорта) <br> <code>Get-Mailbox "support4" | select MaxSendSize, MaxReceiveSize</code> наивысший приоритет <br> <code>Set-Mailbox "support4" -MaxSendSize 30MB -MaxReceiveSize 30MB</code> изменить размер<p><code>Set-SendConnector -Identity "ConnectorName" -Port 26</code> изменить порт коннектора отправки <br> <code>Get-SendConnector "proxmox" | select port</code><p><code>Get-ReceiveConnector | select Name,MaxRecipientsPerMessage</code> по умолчанию Exchange принимает ограниченное количество адресатов в одном письме (200) <br> <code>Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MaxRecipientsPerMessage 50</code> изменить значение <br> <code>Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MessageRateLimit 1000</code> задать лимит обработки сообщений в минуту для коннектора<p><code>Get-OfflineAddressbook | Update-OfflineAddressbook</code> обновить OAB <br> <code>Get-ClientAccessServer | Update-FileDistributionService</code><h3 id=pst><a aria-label="Anchor link for: pst" class=zola-anchor href=#pst><i class=icon></i></a> PST</h3><p><code>New-MailboxExportRequest -Mailbox $name -filepath "\\$srv\pst\$name.PST" # -ContentFilter {(Received -lt "01/01/2021")} -Priority Highest/Lower # -IsArchive</code> выполнить экспорт из архива пользователя <br> <code>New-MailboxExportRequest -Mailbox $name -IncludeFolders "#Inbox#" -FilePath "\\$srv\pst\$name.PST"</code> только папку входящие <br> <code>New-MailboxImportRequest -Mailbox $name "\\$srv\pst\$name.PST"</code> импорт из PST <br> <code>Get-MailboxExportRequest</code> статус запросов <br> <code>Get-MailboxExportRequest -Status Completed | Remove-MailboxExportRequest</code> удалить успешно завершенные запросы <br> <code>Remove-MailboxExportRequest -RequestQueue MBXDB01 -RequestGuid 25e0eaf2-6cc2-4353-b83e-5cb7b72d441f</code> отменить экспорт<h3 id=distributiongroup><a aria-label="Anchor link for: distributiongroup" class=zola-anchor href=#distributiongroup><i class=icon></i></a> DistributionGroup</h3><p><code>Get-DistributionGroup</code> список групп рассылки <br> <code>Get-DistributionGroupMember "!_Офис"</code> список пользователей в группе <br> <code>Add-DistributionGroupMember -Identity "!_Офис" -Member "$name@$domain"</code> добавить в группу рассылки <br> <code>Remove-DistributionGroupMember -Identity "!_Офис" -Member "$name@$domain"</code> <br> <code>New-DistributionGroup -Name "!_Тест" -Members "$name@$domain"</code> создать группу <br> <code>Set-DistributionGroup -Identity "support4" -HiddenFromAddressListsEnabled $true (или Set-Mailbox)</code> скрыть из списка адресов Exchange<h3 id=search><a aria-label="Anchor link for: search" class=zola-anchor href=#search><i class=icon></i></a> Search</h3><p><code>Search-Mailbox -Identity "support4" -SearchQuery 'Тема:"Mikrotik DOWN"'</code> поиск писем по теме <br> <code>Search-Mailbox -Identity "support4" -SearchQuery 'Subject:"Mikrotik DOWN"'</code><br> <code>Search-Mailbox -Identity "support4" -SearchQuery 'attachment -like:"*.rar"'</code><br> <code>Search-Mailbox -Identity "support4" -SearchQuery "отправлено: < 01/01/2020" -DeleteContent -Force</code> удаление писем по дате<p>Формат даты в зависимости от региональных настроек сервера: <br> <code>20/07/2018</code> <br> <code>07/20/2018</code> <br> <code>20-Jul-2018</code> <br> <code>20/July/2018</code><h3 id=auditlog><a aria-label="Anchor link for: auditlog" class=zola-anchor href=#auditlog><i class=icon></i></a> AuditLog</h3><p><code>Get-AdminAuditLogConfig</code> настройки аудита <br> <code>Set-Mailbox -Identity "support4" -AuditOwner HardDelete</code> добавить логирование HardDelete писем <br> <code>Set-mailbox -identity "support4" -AuditlogAgelimit 120</code> указать время хранения <br> <code>Get-mailbox -identity "support4" | Format-list Audit*</code> данные аудита <br> <code>Search-MailboxAuditLog -Identity "support4" -LogonTypes Delegate -ShowDetails -Start "2022-02-22 18:00" -End "2022-03-22 18:00"</code> просмотр логов <br> <code>Search-AdminAuditLog -StartDate "02/20/2022" | ft CmdLetName,Caller,RunDate,ObjectModified -Autosize</code> поиск событий истории выполненых команд в журнале аудита Exchange<h3 id=test><a aria-label="Anchor link for: test" class=zola-anchor href=#test><i class=icon></i></a> Test</h3><p><code>Test-ServiceHealth</code> проверить доступность ролей сервера: почтовых ящиков, клиентского доступа, единой системы обмена сообщениями, траспортного сервера <br> <code>$mx_srv_list | %{Test-MapiConnectivity -Server $_}</code> проверка подключения MX-серверов к БД <br> <code>Test-MAPIConnectivity -Database $db</code> проверка возможности логина в базу <br> <code>Test-MAPIConnectivity –Identity $user@$domain</code> проверка возможности логина в почтовый ящик <br> <code>Test-ComputerSecureChannel</code> проверка работы службы AD <br> <code>Test-MailFlow</code> результат тестового потока почты<h3 id=queue><a aria-label="Anchor link for: queue" class=zola-anchor href=#queue><i class=icon></i></a> Queue</h3><p><code>Get-TransportServer | %{Get-Queue -Server $_.Name}</code> отобразить очереди на всех транспортных серверах <br> <code>Get-Queue -Identity EXCHANGE-CAS\155530 | Format-List</code> подробная информация об очереди <br> <code>Get-Queue -Identity EXCHANGE-CAS\155530 | Get-Message -ResultSize Unlimited | Select FromAddress,Recipients</code> отобразить список отправителей (FromAddress) и список получателей в очереди (Recipients) <br> <code>Get-Message -Queue EXCHANGE-CAS\155530</code> отобразить индентификатор сообщений в конкретной очереди (сервер\очередь\идентификатор письма) <br> <code>Resume-Message EXCHANGE-CAS\155530\444010</code> повторить отправку письма из очереди <br> <code>Retry-Queue -Filter {Status -eq "Retry"}</code> принудительно повторить отправку всех сообщений c статусом “Повторить” <br> <code>Get-Queue -Identity EXCHANGE-CAS\155530 | Get-Message -ResultSize unlimited | Remove-Message -WithNDR $False</code> очистить очередь <br> <code>Get-transportserver EXCHANGE-CAS | Select MessageExpirationTimeout</code> отобразить время жизни сообщений в очереди (по умолчанию, 2 дня)<p>Error Exchange 452 4.3.1 Insufficient system resources - окончание свободного места на диске, на котором находятся очереди службы Exchange Hub Transport, за мониторинг отвечает компонент доступных ресурсов Back Pressure, который в том числе отслеживает свободное место на диске <br> Порог Medium (90%) — перестать принимать по SMTP почту от внешних отправителей (почта от MAPI клиентов при этом обрабатывается) <br> Порог High (99%) — обработка потока почты полностью прекращается <br> Решение: очистить, например логи IIS (C:\inetpub\logs\LogFiles\W3SVC1), увеличить размер диска, отключить мониторинг Back Pressure (плохой вариант) или перенести транспортные очередь на другой диск достаточного объёма.<p><code>Get-Service | ? name -like "MSExchangeTransport" | Stop-Service</code> остановить служу очереди <br> <code>Rename-Item "C:\Program Files\Microsoft\Exchange Server\V15\TransportRoles\data\Queue" "C:\Program Files\Microsoft\Exchange Server\V15\TransportRoles\data\Queue_old"</code> очистить базу очереди <br> <code>C:\Program Files\Microsoft\Exchange Server\V15\Bin\EdgeTransport.exe.config</code> конфигурационный файл, который содержит путь к бд с очередью (блок <appsettings> ключи <add key=QueueDatabasePath value=$new_path> и QueueDatabaseLoggingPath) <br> Для переноса БД, необходимо переместить существующие файлы базы данных Mail.que и Trn.chk (контрольные точки для отслеживания записи в логах) из исходного местоположения в новое. Переместите существующие файлы журнала транзакций Trn.log, Trntmp.log, Trn nnnn.log , Trnres00001.jrs, Trnres00002.jrs и Temp.edb из старого расположения в новое. tmp.edb — временный файл для проверки схемы самой базы, перености не нужно. <br> После запуска службы транспорта удалить старую базу данных очереди и файлы журнала транзакций из старого расположения. <h3 id=defrag><a aria-label="Anchor link for: defrag" class=zola-anchor href=#defrag><i class=icon></i></a> Defrag</h3> <p><code>Get-MailboxDatabase -Status | ft Name, DatabaseSize, AvailableNewMailboxSpace</code> <br> DatabaseSize - текущий размер базы <br> AvailableNewMailboxSpace - объём пустых страниц, пространство, которое можно освободить при дефрагментации <br> (DatabaseSize — AvailableNewMailboxSpace) x 1,1 - необходимо дополнительно иметь свободного места не менее 110% от текущего размера базы (без учета пустых страниц) <br> <code>cd $path</code> <br> <code>Dismount-Database "$path\$db_name"</code> отмонтировать БД <br> <code>eseutil /d "$path\$db_name.edb"</code> <br> <code>Mount-Database "$path\$db"</code> примонтировать БД</p> <h3 id=dag><a aria-label="Anchor link for: dag" class=zola-anchor href=#dag><i class=icon></i></a> DAG</h3> <blockquote><p>Database Availability Group</blockquote> <p><code>Install-WindowsFeature -Name Failover-Clustering -ComputerName EXCH-MX-01</code> основывается на технологии Windows Server Failover Cluster <br> <code>New-DatabaseAvailabilityGroup -Name dag-01 -WitnessServer fs-05 -WitnessDirectory C:\witness_exchange1</code> создать группу с указанием файлового свидетеля для кворума <br> Quorum - это процесс голосования, в котором для принятия решения нужно иметь большинство голосов, что бы сделать текущую копию базы данных активной. <br> WitnessDirectory — используется для хранения данных файлового ресурса-свидетеля. <br> <code>Set-DatabaseAvailabilityGroup dag-01 –DatabaseAvailabilityGroupIPAdress $ip</code> изменить ip-адрес группы <br> <code>Get-DatabaseAvailabilityGroup</code> список всех групп <br> <code>Get-DatabaseAvailabilityGroup -Identity dag-01</code> <br> <code>Add-DatabaseAvailabilityGroupServer -Identity dag-01 -MailboxServer EXCH-MX-01</code> добавить первый сервер (все БД на серверах в DAG должны храниться по одинаковому пути) <br> <code>Add-MailboxDatabaseCopy -Identity db_name -MailboxServer EXCH-MX-04</code> добавить копию БД <br> <code>Get-MailboxDatabaseCopyStatus -Identity db_name\* | select Name,Status,LastInspectedLogTime</code> статус и время последнего копирования журнала транзакий</p> <p>Status: <br> Mounted - рабочая база <br> Suspended - приостановлено копирование <br> Healthy - рабочая пассивная копия <br> ServiceDown - недоступна (выключен сервер) <br> Dismounted - отмонтирована <br> FailedAndSuspended - ошибка и приостановка копирования <br> Resynchronizing - процесс синхронизация, где будет постепенно уменьшаться длина очереди <br> CopyQueue Length - длина репликационной очереди копирования (0 - значит все изменения из активной базы реплицированы в пассивную копию)</p> <p><code>Resume-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04</code> возобновить (Resume) или запустить копирование бд на EXCH-MX-04 (из статуса Suspended в Healthy) <br> <code>Suspend-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04</code> остановить копирование (в статус Suspended) <br> <code>Update-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04 -DeleteExistingFiles</code> обновить копию БД (сделать Full Backup) <br> <code>Set-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04 -ActivationPreference 1</code> изменить приоритет для активации копий БД (какую использовать, 1 – самое высокое значение) <br> <code>Move-ActiveMailboxDatabase db_name -ActivateOnServer EXCH-MX-04 -MountDialOverride:None -Confirm:$false</code> включить копию БД в DAG (переключиться на активную копию) <br> <code>Remove-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04 -Confirm:$False</code> удалить копии пассивной базы в DAG-группе (у БД должно быть отключено ведение циклического журнала) <br> <code>Remove-DatabaseAvailabilityGroupServer -Identity dag-01 -MailboxServer EXCH-MX-04 -ConfigurationOnly</code> удалить MX сервер из группы DAG <br> <code>Import-Module FailoverClusters</code> <br> <code>Get-ClusterNode EXCH-MX-04 | Remove-ClusterNode -Force</code> удалить отказавший узел из Windows Failover Cluster</p> <p><code>Get-DatabaseAvailabilityGroup | Get-DatabaseAvailabilityGroupHealth</code> мониторинг</p> <h3 id=index-1><a aria-label="Anchor link for: index-1" class=zola-anchor href=#index-1><i class=icon></i></a> Index</h3> <p><code>Get-MailboxDatabaseCopyStatus * | select name,status,ContentIndexState,ContentIndexErrorMessage,ActiveDatabaseCopy,LatestCopyBackupTime,CopyQueueLength</code> узнать состояние работы индксов БД и текст ошибки, на каком сервере активная копия БД, дата последней копии и текущая очередь <br> <code>Get-MailboxDatabaseCopyStatus -Identity $db_name\* | Format-List Name,ContentIndexState</code> отобразить список всех копий конкретной БД на всех серверах, и статус их индексов, если у второго сервера статус Healthy, можно восстановить из него <br> <code>Get-MailboxDatabaseCopyStatus -Identity $db_name\EXCH-MX-04 | Update-MailboxDatabaseCopy -SourceServer EXCH-MX-01 -CatalogOnly</code> восстановить БД из копии <br> <code>cd %PROGRAMFILES%\Microsoft\Exchange Server\V14\Scripts</code> или v15 для Exchange 2016 <br> <code>.\ResetSearchIndex.ps1 $db_name</code> скрипт восстановления индекса</p> <p><code>Get-MailboxDatabaseCopyStatus * | where {$_.ContentIndexState -eq "Failed" -or $_.ContentIndexState -eq "FailedAndSuspended"}</code> отобразить у какой БД произошел сбой работы (FailedAndSuspended) или индекса (ContentIndexState)</p> <h2 id=nas><a aria-label="Anchor link for: nas" class=zola-anchor href=#nas><i class=icon></i></a> NAS</h2> <h3 id=truenas><a aria-label="Anchor link for: truenas" class=zola-anchor href=#truenas><i class=icon></i></a> TrueNAS</h3> <p><a href=https://github.com/PowerTrueNas/TrueNas>PowerTrueNas</a></p> <p><code>Install-Module TrueNas</code> <br> <code>Import-Module TrueNas</code> <br> <code>$(Get-Module TrueNas).ExportedCommands</code> <br> <code>Connect-TrueNasServer -Server tnas-01 -SkipCertificateCheck</code> <br> <code>Get-TrueNasCertificate</code> настройки сертификата <br> <code>Get-TrueNasSetting</code> настройки языка, time zone, syslog level и server, https port <br> <code>Get-TrueNasUser</code> список пользователей <br> <code>Get-TrueNasSystemVersion</code> характеристики (Physical Memory, Model, Cores) и Uptime <br> <code>Get-TrueNasSystemAlert</code> snmp для оповещений <br> <code>Get-TrueNasSystemNTP</code> список используемых NTP серверов <br> <code>Get-TrueNasDisk</code> список разделов физического диска <br> <code>Get-TrueNasInterface</code> сетевые интерфейсы <br> <code>Get-TrueNasGlobalConfig</code> сетевые настройки <br> <code>Get-TrueNasDnsServer</code> настроенные DNS-сервера <br> <code>Get-TrueNasIscsiTarget</code> отобразить ID группы инициаторов использующих таргет, используемый portal, authentification и authen-method <br> <code>Get-TrueNasIscsiInitiator</code> отобразить группы инициаторов <br> <code>Get-TrueNasIscsiPortal</code> слушатель (Listen) и порт <br> <code>Get-TrueNasIscsiExtent</code> список ISCSi Target (статус работы, путь) <br> <code>Get-TrueNasPool</code> список pool (Id, Path, Status, Healthy) <br> <code>Get-TrueNasVolume -Type FILESYSTEM</code> список pool файловых систем <br> <code>Get-TrueNasVolume -Type VOLUME</code> список разделов в pool и их размер <br> <code>Get-TrueNasService | ft</code> список служб и их статус <br> <code>Start-TrueNasService ssh</code> запустить службу <br> <code>Stop-TrueNasService ssh</code> остановить службу</p> <h3 id=synology><a aria-label="Anchor link for: synology" class=zola-anchor href=#synology><i class=icon></i></a> Synology</h3> <p><a href=https://github.com/pspete/pSynology>pSynology</a></p> <p><code>New-SYNOSession</code> аутентификация на Synology Diskstation и запуск нового сеанса API <br> <code>Close-SYNOSession</code> выход из сеанса API <br> <code>Get-SYNOInfo</code> получить информацию об API DiskStation <br> <code>Add-SYNOFSFAvorite</code> добавить папку в избранное пользователя <br> <code>Add-SYNOFSFile</code> загрузить файл <br> <code>Clear-SYNOFSBackgroundTask</code> удалить все завершенные фоновые задачи <br> <code>Clear-SYNOFSFavoriteStatus</code> удалить все избранное с неработающим статусом <br> <code>Clear-SYNOFSSharingLink</code> удалить все просроченные и неработающие ссылки для обмена <br> <code>Get-SYNOFSArchiveCompress</code> получить статус задачи сжатия <br> <code>Get-SYNOFSArchiveContent</code> вывести содержимое архива <br> <code>Get-SYNOFSArchiveExtract</code> получить статус задачи извлечения <br> <code>Get-SYNOFSBackgroundTask</code> список всех фоновых задач, включая копирование <br> <code>Get-SYNOFSCopy</code> получить статус операции копирования <br> <code>Get-SYNOFSDeleteItem</code> получить статус задачи удаления <br> <code>Get-SYNOFSDirSize</code> получить статус задачи расчета размера <br> <code>Get-SYNOFSFavorite</code> список избранного пользователя <br> <code>Get-SYNOFSFile</code> перечислить файлы в заданной папке <br> <code>Get-SYNOFSFileInfo</code> получить информацию о файлах или файле <br> <code>Get-SYNOFSInfo</code> получить информацию о файловой станции <br> <code>Get-SYNOFSMD5</code> получить статус вычислительной задачи MD5 <br> <code>Get-SYNOFSSearch</code> перечислить совпадающие файлы во временной базе данных поиска <br> <code>Get-SYNOFSShare</code> список всех общих папок <br> <code>Get-SYNOFSSharingLink</code> список ссылок пользователя на общий доступ к файлам <br> <code>Get-SYNOFSSharingLinkInfo</code> получить информацию о ссылке общего доступа по идентификатору ссылки общего доступа <br> <code>Get-SYNOFSThumbnail</code> получить миниатюру файла <br> <code>Get-SYNOFSVirtualFolder</code> список всех папок точек монтирования заданного типа виртуальной файловой системы <br> <code>New-SYNOFSFolder</code> создать папку <br> <code>New-SYNOFSSharingLink</code> создать одну или несколько ссылок для общего доступа по пути к файл или папку <br> <code>Remove-SYNOFSFAvorite</code> удаление избранного из избранного пользователя <br> <code>Remove-SYNOFSItem</code> удалить файл или папку <br> <code>Remove-SYNOFSSearch</code> удалить временные базы данных поиска <br> <code>Remove-SYNOFSSharingLink</code> удалить одну или несколько ссылок общего доступа <br> <code>Rename-SYNOFSItem</code> переименовываем файл или папку <br> <code>Save-SYNOFSFile</code> загрузить файл или папку <br> <code>Set-SYNOFSFAvorite</code> редактировать избранное имя <br> <code>Set-SYNOFSSharingLink</code> изменить ссылку для общего доступа <br> <code>Start-SYNOFSArchiveCompress</code> запустить задание сжатия файла или папки <br> <code>Start-SYNOFSArchiveExtract</code> запустить задание распаковки архива <br> <code>Start-SYNOFSCopy</code> запустить задание копирования файлов <br> <code>Start-SYNOFSDeleteItem</code> запустить задание удаления файлов или папок <br> <code>Start-SYNOFSDirSize</code> расчитать размер для одного или нескольких путей к файлам или папкам <br> <code>Start-SYNOFSMD5</code> получить MD5 файла <br> <code>Start-SYNOFSSearch</code> поиск файлов по заданным критериям <br> <code>Stop-SYNOFSArchiveCompress</code> остановить задачу сжатия <br> <code>Stop-SYNOFSArchiveExtract</code> остановить задачу извлечения <br> <code>Stop-SYNOFSCopy</code> остановить задачу копирования <br> <code>Stop-SYNOFSDeleteItem</code> остановить задачу удаления <br> <code>Stop-SYNOFSDirSize</code> остановить расчет размера <br> <code>Stop-SYNOFSMD5</code> остановить вычисление MD5 файла <br> <code>Stop-SYNOFSSearch</code> остановить задачу поиска <br> <code>Test-SYNOFSPermission</code> проверить, имеет ли вошедший в систему пользователь разрешение на запись в данную папку <br> <code>Update-SYNOFSFAvorite</code> заменить несколько избранных папок в избранном пользователя</p> <h2 id=veeam><a aria-label="Anchor link for: veeam" class=zola-anchor href=#veeam><i class=icon></i></a> Veeam</h2> <p>VeeamHub (https://github.com/VeeamHub/powershell)</p> <h3 id=get-vbrcommand><a aria-label="Anchor link for: get-vbrcommand" class=zola-anchor href=#get-vbrcommand><i class=icon></i></a> Get-VBRCommand</h3> <p><code>Set-ExecutionPolicy AllSigned</code> <br> <code>Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))</code> установить choco <br> <code>choco install veeam-backup-and-replication-console</code> установить консоль управления (https://community.chocolatey.org/packages/veeam-backup-and-replication-console) <br> <code>Get-Module Veeam.Backup.PowerShell</code> модуль, который устанавливается вместе с клиентской консолью по умолчанию <br> <code>Get-Command -Module Veeam.Backup.PowerShell</code> <br> <code>Get-Command -Module Get-VBRCommand</code> <br> <code>Connect-VBRServer -Server $srv -Credential $cred -Port 9392</code> <br> <code>Get-VBRJob</code> <br> <code>Get-VBRCommand *get*backup*</code> <br> <code>Get-VBRComputerBackupJob</code> <br> <code>Get-VBRBackup</code> <br> <code>Get-VBRBackupRepository</code> <br> <code>Get-VBRBackupSession</code> <br> <code>Get-VBRBackupServerCertificate</code> <br> <code>Get-VBRRestorePoint</code> <br> <code>Get-VBRViProxy</code></p> <h3 id=veeam-restat><a aria-label="Anchor link for: veeam-restat" class=zola-anchor href=#veeam-restat><i class=icon></i></a> Veeam-REStat</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>PSModulePath<span class="z-variable z-other z-member z-powershell">.Split</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\Veeam-REStat\Veeam-REStat.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-unary z-powershell">!</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">New-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>File<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>iwr https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">raw.githubusercontent.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Lifailon<span class="z-keyword z-operator z-assignment z-powershell">/</span>Veeam<span class="z-keyword z-operator z-assignment z-powershell">-</span>REStat<span class="z-keyword z-operator z-assignment z-powershell">/</span>rsa<span class="z-keyword z-operator z-assignment z-powershell">/</span>Veeam<span class="z-keyword z-operator z-assignment z-powershell">-</span>REStat<span class="z-keyword z-operator z-assignment z-powershell">/</span>Veeam<span class="z-keyword z-operator z-assignment z-powershell">-</span>REStat.psm1<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.Content <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></code></pre> <p><code>Veeam-REStat -Server srv-veeam-11 -Port 9419</code> при первом запуске необходимо заполнить Credential для подключения к экземпляру сервера VBR, которые сохраняются в файл с именем сервера в формате xml с применением шифрования PSCredential для последующего подключения <br> <code>Veeam-REStat -Reset</code> сброс учетных данных для подключения к серверу VBR <br> <code>Veeam-REStat -Statistic</code> статистика всех заданий с сортировкой по дате (выводит время начала, завершения и статус работы, процент прогресса, результат выполнений и сообщение с причиной в случае ошибки: Warning или Failed) <br> <code>Veeam-REStat -Jobs</code> подробная статистика по всем настроенным заданиям резеврного копирования: статус работы (In Active/disabled), результат последнего задания (LastResult), тип аутентификации (Standard/Linux), имя и размер виртуальной машины, тип резервного копирования (например, Incremental), дату и время последнего и следущего выполнения <br> <code>Veeam-REStat -ConfigBackup</code> отображает статус состояния работы резервного копирования конфигурации сервера VBR, кол-во точек восстановления, дату и время последней копии <br> <code>Veeam-REStat -Repositories</code> статистика по инвентарным данным репозиториев: тип хранилища, путь на сервере до директории хранения, общий (capacityGB), свободный (freeGB) и используемый (usedSpaceGB) размер диска под данные <br> <code>Veeam-REStat -Backup</code> список заданий резервного копирования, тип копирования (VM/Directory) и кол-во точек восстановления <br> <code>Veeam-REStat -Points</code> история статистики всех точек восстановления с датой создания <br> <code>Veeam-REStat -Hosts</code> список физически (в ручную) добавленных хостов в инфраструктуру VBR <br> <code>Veeam-REStat -Proxy</code> список серверов с ролью Proxy <br> <code>Veeam-REStat -Users</code> список УЗ, добавленных для подключения к серверам <br> <code>Veeam-REStat -Service</code> выводит информацию о связанных внутренних службах, подключение к этим службам может потребоваться только для интеграции с VBR</p> <h2 id=rest-api><a aria-label="Anchor link for: rest-api" class=zola-anchor href=#rest-api><i class=icon></i></a> REST API</h2> <p><code>$url = "https://habr.com/ru/rss/users/Lifailon/publications/articles/?fl=ru"</code> RSS лента публикаций на Habr <br> <code>Invoke-RestMethod $url</code> <br> <code>$iwr = Invoke-WebRequest -Uri $url</code> <br> <code>$iwr | Get-Member</code> <br> <code>$iwr.Content</code> <br> <code>$iwr.StatusCode -eq 200</code> <br> <code>$iwr.Headers</code> <br> <code>$iwr.ParsedHtml | Select lastModified</code> <br> <code>$iwr.Links | fl title,innerText,href</code> <br> <code>$iwr.Images.src</code></p> <h3 id=methods><a aria-label="Anchor link for: methods" class=zola-anchor href=#methods><i class=icon></i></a> Methods</h3> <p><strong>GET</strong> - Read <br> <strong>POST</strong> - Create <br> <strong>PATCH</strong> - Partial update/modify <br> <strong>PUT</strong> - Update/replace <br> <strong>DELETE</strong> - Remove</p> <h3 id=download-image><a aria-label="Anchor link for: download-image" class=zola-anchor href=#download-image><i class=icon></i></a> Download Image</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Download-Image</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>folder</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http.+://<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>-<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>-$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Pictures\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>folder</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType Directory <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-redirection z-powershell">></span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType Directory <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-redirection z-powershell">></span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>irm</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-WebRequest</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>img</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>irm<span class="z-variable z-other z-member z-powershell">.Images.src</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>img</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.+/<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Start-Job</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-support z-function z-powershell">Invoke-WebRequest</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:img</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:path</span>\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:name</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-redirection z-powershell">></span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Job</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.State<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span> <span class="z-keyword z-operator z-comparison z-powershell">-like</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Completed<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Get-Job</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Remove-Job</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">break</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>count_all</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>irm<span class="z-variable z-other z-member z-powershell">.Images.src.Count</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>count_down</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>\<span class="z-keyword z-operator z-assignment z-powershell">*</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.count
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Downloaded <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>count_down</span> of <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>count_all</span> files to <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>Download-Image -url https://losst.pro/</code></p> <h3 id=token><a aria-label="Anchor link for: token" class=zola-anchor href=#token><i class=icon></i></a> Token</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell">https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>veeam<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">11</span>:<span class="z-constant z-numeric z-integer z-powershell">9419</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>swagger<span class="z-keyword z-operator z-assignment z-powershell">/</span>ui<span class="z-keyword z-operator z-assignment z-powershell">/</span>index.html
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Header</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>x-api-version<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>1.0-rev2<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>grant_type<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>password<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>username<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>login</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>password<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>password</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>vpost</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> iwr <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://veeam-11:9419/api/oauth2/token<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Header</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Body</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>SkipCertificateCheck
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>vtoken</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>vpost<span class="z-variable z-other z-member z-powershell">.Content</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>"<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></code></pre> <h3 id=get><a aria-label="Anchor link for: get" class=zola-anchor href=#get><i class=icon></i></a> GET</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>token</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>vtoken</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-SecureString</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>AsPlainText –Force
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>vjob</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> iwr <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://veeam-11:9419/api/v1/jobs<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method GET <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Header</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Authentication Bearer <span class="z-keyword z-operator z-assignment z-powershell">-</span>Token <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>token</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>SkipCertificateCheck
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Header</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>x-api-version<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>1.0-rev1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Bearer <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>vtoken</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>vjob</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> iwr <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://veeam-11:9419/api/v1/jobs<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method GET <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Header</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>SkipCertificateCheck
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>vjob</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>vjob<span class="z-variable z-other z-member z-powershell">.Content</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>vjob</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://veeam-11:9419/api/v1/jobs<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method GET <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Header</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>SkipCertificateCheck
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>vjob<span class="z-variable z-other z-member z-powershell">.data.virtualMachines.includes.inventoryObject</span></span>
</span></code></pre> <h3 id=cookie><a aria-label="Anchor link for: cookie" class=zola-anchor href=#cookie><i class=icon></i></a> Cookie</h3> <p>Получить hash торрент файла на сайте Кинозал</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-KinozalTorrentHash</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>id</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cookies</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://kinozal.tv/get_srv_details.php?id=<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>id</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>&action=2<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cookies</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>uid=...+<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>User-Agent<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Cookie<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cookies</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method Get
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Инфо хеш: (.+)&LT/li>&LTli>Размер<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-Null</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">return</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Matches</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>$id = 1656552</code> <br> <code>$cookies = "uid=..."</code> получить cookie в браузере на вкладке сеть из загловка запросов после авторизации на сайте <br> <code>Get-KinozalTorrentHash $id $cookies</code></p> <h2 id=pode><a aria-label="Anchor link for: pode" class=zola-anchor href=#pode><i class=icon></i></a> Pode</h2> <p><a href=https://github.com/Badgerati/Pode>PowerShell Web framework</a> для создания <code>REST API</code>, Веб-сайтов, <code>TCP</code> и <code>SMTP</code> серверов.</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Start-PodeServer</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Add-PodeEndpoint</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Address localhost <span class="z-keyword z-operator z-assignment z-powershell">-</span>Port <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>8080<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Protocol <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>HTTP<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>## Get info endpoints<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Add-PodeRoute</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>GET<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ScriptBlock <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-PodeJsonResponse</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>service<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/api/service<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>process<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/api/process<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>## GET<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Add-PodeRoute</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/api/service<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>GET<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ScriptBlock <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-PodeJsonResponse</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell">            <span class="z-support z-function z-powershell">Get-Service</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> Name<span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Status<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Status</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>StartType<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.StartType</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell">        <span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Add-PodeRoute</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/api/process<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>GET<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ScriptBlock <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-PodeJsonResponse</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell">            <span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Sort-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Descending CPU <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>First <span class="z-constant z-numeric z-integer z-powershell">15</span> ProcessName<span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell">            <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ProcessorTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.TotalProcessorTime</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d+$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell">            <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Memory<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.WS</span></span> <span class="z-keyword z-operator z-assignment z-powershell">/</span> <span class="z-constant z-numeric z-integer z-powershell">1024</span><span class="z-keyword z-other z-powershell">kb</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MB<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell">            <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Label</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>RunTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.StartTime</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d+$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell">        <span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Add-PodeRoute</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/api/process-html<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>GET<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ScriptBlock <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-PodeHtmlResponse</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">            <span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Sort-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Descending CPU <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>First <span class="z-constant z-numeric z-integer z-powershell">15</span> ProcessName<span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">            <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ProcessorTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.TotalProcessorTime</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d+$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">            <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Memory<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.WS</span></span> <span class="z-keyword z-operator z-assignment z-powershell">/</span> <span class="z-constant z-numeric z-integer z-powershell">1024</span><span class="z-keyword z-other z-powershell">kb</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MB<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">            <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Label</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>RunTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.StartTime</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d+$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Auto ConvertTo-Html<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>## POST<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Add-PodeRoute</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/api/service<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>POST<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ScriptBlock <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> https://pode.readthedocs.io/en/latest/Tutorials/WebEvent/<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> $WebEvent | Out-Default<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Value</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WebEvent<span class="z-variable z-other z-member z-powershell">.Data</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ServiceName<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Service</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Value</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Status
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-PodeJsonResponse</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Name<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Value</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Status<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Status</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>irm http://localhost:8080/api/service -Method Get</code> <br> <code>irm http://localhost:8080/api/process -Method Get</code> <br> <code>http://localhost:8080/api/process-html</code> использовать браузер <br> <code>irm http://localhost:8080/api/service -Method Post -Body @{"ServiceName" = "AnyDesk"}</code></p> <h2 id=selenium><a aria-label="Anchor link for: selenium" class=zola-anchor href=#selenium><i class=icon></i></a> Selenium</h2> <p><code>Invoke-Expression(New-Object Net.WebClient).DownloadString("https://raw.githubusercontent.com/Lifailon/Deploy-Selenium/rsa/Deploy-Selenium-Drivers.ps1")</code> установка всех драйверов и Chromium соответствующий версии для драйвера</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\Selenium\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>log</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>\ChromeDriver.log<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChromeDriver</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>\ChromeDriver.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WebDriver</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>\WebDriver.dll<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SupportDriver</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>\WebDriver.Support.dll<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Chromium</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-ChildItem</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> Name <span class="z-keyword z-operator z-comparison z-powershell">-like</span> <span class="z-support z-function z-powershell">chrome.exe</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.FullName
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WebDriver</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SupportDriver</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">try</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChromeOptions</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> OpenQA.Selenium.Chrome.ChromeOptions <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> создаем объект с настройками запуска браузера<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChromeOptions<span class="z-variable z-other z-member z-powershell">.BinaryLocation</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Chromium</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> передаем путь до исполняемого файла, который отвечает за запуск браузера<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChromeOptions<span class="z-variable z-other z-member z-powershell">.AddArgument</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>start-maximized<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> добавляем аргумент, который позволяет запустить браузер на весь экран<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>$ChromeOptions.AddArgument("start-minimized") # запускаем браузер в окне<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>$ChromeOptions.AddArgument("window-size=400,800") # запускаем браузер с заданными размерам окна в пикселях<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChromeOptions<span class="z-variable z-other z-member z-powershell">.AcceptInsecureCertificates</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> игнорировать предупреждение на сайтах с не валидным сертификатом<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>$ChromeOptions.AddArgument("headless") # скрывать окно браузера при запуске<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChromeDriverService</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.Chrome.ChromeDriverService</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::CreateDefaultService<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChromeDriver</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> создаем объект настроек службы драйвера<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChromeDriverService<span class="z-variable z-other z-member z-powershell">.HideCommandPromptWindow</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> отключаем весь вывод логирования драйвера в консоль (этот вывод нельзя перенаправить)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChromeDriverService<span class="z-variable z-other z-member z-powershell">.LogPath</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>log</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> указать путь до файла с журналом<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChromeDriverService<span class="z-variable z-other z-member z-powershell">.EnableAppendLog</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> не перезаписывать журнал при каждом новом запуске<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>$ChromeDriverService.EnableVerboseLogging = $True # кроме INFO и ошибок, записывать DEBUG сообщения<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> OpenQA.Selenium.Chrome.ChromeDriver<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChromeDriverService</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChromeOptions</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> инициализируем запуск с указанными настройками<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.Navigate</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GoToUrl<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://google.com<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> переходим по указанной ссылке в браузере<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>$Selenium.Manage().Window.Minimize() # свернуть окно браузера после запуска и перехода по нужному url (что бы считать страницу корректно)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Ищем поле для ввода текста:<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Search</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.FindElements</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.By</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Id<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>APjFqb<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Search</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.FindElements</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.By</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::XPath<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>//*[@id="APjFqb"]<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Search</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.FindElements</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.By</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Name<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>q<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Search</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.FindElements</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.By</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::XPath<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>//*[@name="q"]<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Search</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.FindElements</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.By</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ClassName<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>gLFyf<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Search</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.FindElements</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.By</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::CssSelector<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>[jsname="yZiJbe"]<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Search</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.FindElements</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.By</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::TagName<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>textarea<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> ComputedAccessibleRole <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> combobox
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Search<span class="z-variable z-other z-member z-powershell">.SendKeys</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>calculator online<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> передаем текст выбранному элементу<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Search<span class="z-variable z-other z-member z-powershell">.SendKeys</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.Keys</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Enter</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> нажимаем Enter для вызова функции поиска<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>div</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.FindElements</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.By</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::TagName<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>div<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>2</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>div</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.ComputedAccessibleRole</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>button<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-logical z-powershell">-and</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.ComputedAccessibleLabel</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>2<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>2<span class="z-variable z-other z-member z-powershell">.Click</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>2<span class="z-variable z-other z-member z-powershell">.Click</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>plus</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>div</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.ComputedAccessibleRole</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>button<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-logical z-powershell">-and</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Text</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>+<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>plus<span class="z-variable z-other z-member z-powershell">.Click</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>3</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.FindElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.By</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::CssSelector<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>[jsname="KN1kY"]<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>3<span class="z-variable z-other z-member z-powershell">.Click</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>3<span class="z-variable z-other z-member z-powershell">.Click</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sum</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.FindElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.By</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::CssSelector<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>[jsname="Pt8tGc"]<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sum<span class="z-variable z-other z-member z-powershell">.Click</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.FindElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">OpenQA.Selenium.By</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::CssSelector<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>[jsname="VssY5c"]<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Text
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Result: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ForegroundColor Green
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">finally</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Selenium<span class="z-variable z-other z-member z-powershell">.Quit</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <h3 id=selenium-modules><a aria-label="Anchor link for: selenium-modules" class=zola-anchor href=#selenium-modules><i class=icon></i></a> Selenium modules</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">raw.githubusercontent.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Lifailon<span class="z-keyword z-operator z-assignment z-powershell">/</span>Selenium<span class="z-keyword z-operator z-assignment z-powershell">-</span>Modules<span class="z-keyword z-operator z-assignment z-powershell">/</span>rsa<span class="z-keyword z-operator z-assignment z-powershell">/</span>Modules<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Get-GPT</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Get-GPT</span>.psm1 <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">Env:</span>PSModulePath</span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Get-GPT<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType Directory <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Get-GPT.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></code></pre> <p><code>Get-GPT "Исполняй роль калькулятора. Посчитай сумму чисел: 22+33"</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">raw.githubusercontent.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Lifailon<span class="z-keyword z-operator z-assignment z-powershell">/</span>Selenium<span class="z-keyword z-operator z-assignment z-powershell">-</span>Modules<span class="z-keyword z-operator z-assignment z-powershell">/</span>rsa<span class="z-keyword z-operator z-assignment z-powershell">/</span>Modules<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Get-Translation</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Get-Translation</span>.psm1 <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">Env:</span>PSModulePath</span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Get-Translation<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType Directory <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Get-Translation.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></code></pre> <p><code>Get-Translation -Provider DeepL -Text "I translating the text"</code> <br> <code>Get-Translation -Provider DeepL -Text "Я перевожу текст"</code> <br> <code>Get-Translation -Provider Google -Text "I translating the text"</code> <br> <code>Get-Translation -Provider Google -Text "Я перевожу текст" -Language en</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">raw.githubusercontent.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Lifailon<span class="z-keyword z-operator z-assignment z-powershell">/</span>Selenium<span class="z-keyword z-operator z-assignment z-powershell">-</span>Modules<span class="z-keyword z-operator z-assignment z-powershell">/</span>rsa<span class="z-keyword z-operator z-assignment z-powershell">/</span>Modules<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Get-SpeedTest</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Get-SpeedTest</span>.psm1 <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">Env:</span>PSModulePath</span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Get-SpeedTest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType Directory <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Get-SpeedTest.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></code></pre> <p><code>Get-SpeedTest -Provider Libre</code> <br> <code>Get-SpeedTest -Provider Open</code> <br> <code>Get-SpeedTest -Provider Ookla</code></p> <h2 id=ie><a aria-label="Anchor link for: ie" class=zola-anchor href=#ie><i class=icon></i></a> IE</h2> <p><code>$ie.document.IHTMLDocument3_getElementsByTagName("input")  | select name</code> получить имена всех Input Box <br> <code>$ie.document.IHTMLDocument3_getElementsByTagName("button") | select innerText</code> получить имена всех Button <br> <code>$ie.Document.documentElement.innerHTML</code> прочитать сырой Web Content (&LTinput name=“login” tabindex=“100” class=“input__control input__input” id=“uniq32005644019429136” spellcheck=“false” placeholder=“Логин”) <br> <code>$All_Elements = $ie.document.IHTMLDocument3_getElementsByTagName("*")</code> забрать все элементы <br> <code>$Go_Button = $All_Elements | ? innerText -like "go"</code> поиск элемента по имени <br> <code>$Go_Button | select ie9_tagName</code> получить TagName (SPAN) для быстрого дальнейшего поиска <br> <code>$SPAN_Elements = $ie.document.IHTMLDocument3_getElementsByTagName("SPAN")</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ie</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject InternetExplorer.Application
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ie<span class="z-variable z-other z-member z-powershell">.navigate</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://yandex.ru<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ie<span class="z-variable z-other z-member z-powershell">.visible</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ie<span class="z-variable z-other z-member z-powershell">.document.IHTMLDocument3_getElementByID</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>login<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.value <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Login<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ie<span class="z-variable z-other z-member z-powershell">.document.IHTMLDocument3_getElementByID</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>passwd<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.value <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Password<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Button_Auth</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ie<span class="z-variable z-other z-member z-powershell">.document.IHTMLDocument3_getElementsByTagName</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>button<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">?</span> innerText <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Войти<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Button_Auth<span class="z-variable z-other z-member z-powershell">.Click</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ie<span class="z-variable z-other z-member z-powershell">.Document.documentElement.innerHTML</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ie<span class="z-variable z-other z-member z-powershell">.Quit</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h2 id=com><a aria-label="Anchor link for: com" class=zola-anchor href=#com><i class=icon></i></a> COM</h2> <p><code>$wshell = New-Object -ComObject Wscript.Shell</code> <br> <code>$wshell | Get-Member</code> <br> <code>$link = $wshell.CreateShortcut("$Home\Desktop\Yandex.lnk")</code> создать ярлык <br> <code>$link | Get-Member</code> <br> <code>$link.TargetPath = "https://yandex.ru"</code> куда ссылается (метод TargetPath объекта $link где хранится объект CreateShortcut) <br> <code>$link.Save()</code> сохранить</p> <p><code>Set-WinUserLanguageList -LanguageList en-us,ru -Force</code> изменить языковую раскладку клавиатуры</p> <h3 id=wscript-shell-sendkeys><a aria-label="Anchor link for: wscript-shell-sendkeys" class=zola-anchor href=#wscript-shell-sendkeys><i class=icon></i></a> Wscript.Shell.SendKeys</h3> <p><code>(New-Object -ComObject Wscript.shell).SendKeys([char]173)</code> включить/выключить звук <br> <code>$wshell.Exec("notepad.exe")</code> запустить приложение <br> <code>$wshell.AppActivate("Блокнот")</code> развернуть запущенное приложение</p> <p><code>$wshell.SendKeys("Login")</code> текст <br> <code>$wshell.SendKeys("{A 5}")</code> напечатать букву 5 раз подряд <br> <code>$wshell.SendKeys("%{TAB}")</code> ALT+TAB <br> <code>$wshell.SendKeys("^")</code> CTRL <br> <code>$wshell.SendKeys("%")</code> ALT <br> <code>$wshell.SendKeys("+")</code> SHIFT <br> <code>$wshell.SendKeys("{DOWN}")</code> вниз <br> <code>$wshell.SendKeys("{UP}")</code> вверх <br> <code>$wshell.SendKeys("{LEFT}")</code> влево <br> <code>$wshell.SendKeys("{RIGHT}")</code> вправо <br> <code>$wshell.SendKeys("{PGUP}")</code> PAGE UP <br> <code>$wshell.SendKeys("{PGDN}")</code> PAGE DOWN <br> <code>$wshell.SendKeys("{BACKSPACE}")</code> BACKSPACE/BKSP/BS <br> <code>$wshell.SendKeys("{DEL}")</code> DEL/DELETE <br> <code>$wshell.SendKeys("{INS}")</code> INS/INSERT <br> <code>$wshell.SendKeys("{PRTSC}")</code> PRINT SCREEN <br> <code>$wshell.SendKeys("{ENTER}")</code> <br> <code>$wshell.SendKeys("{ESC}")</code> <br> <code>$wshell.SendKeys("{TAB}")</code> <br> <code>$wshell.SendKeys("{END}")</code> <br> <code>$wshell.SendKeys("{HOME}")</code> <br> <code>$wshell.SendKeys("{BREAK}")</code> <br> <code>$wshell.SendKeys("{SCROLLLOCK}")</code> <br> <code>$wshell.SendKeys("{CAPSLOCK}")</code> <br> <code>$wshell.SendKeys("{NUMLOCK}")</code> <br> <code>$wshell.SendKeys("{F1}")</code> <br> <code>$wshell.SendKeys("{F12}")</code> <br> <code>$wshell.SendKeys("{+}{^}{%}{~}{(}{)}{[}{]}{{}{}}")</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-AltTab</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject wscript.shell</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.SendKeys<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>%{Tab}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-Random</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Minimum <span class="z-constant z-numeric z-integer z-powershell">30</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Maximum <span class="z-constant z-numeric z-integer z-powershell">180</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Get-AltTab</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>Get-AltTab</code></p> <h3 id=wscript-shell-popup><a aria-label="Anchor link for: wscript-shell-popup" class=zola-anchor href=#wscript-shell-popup><i class=icon></i></a> Wscript.Shell.Popup</h3> <p><code>$wshell = New-Object -ComObject Wscript.Shell</code> <br> <code>$output = $wshell.Popup("Выберите действие?",0,"Заголовок",4)</code> <br> <code>if ($output -eq 6) {"yes"} elseif ($output -eq 7) {"no"} else {"no good"}</code></p> <pre class=z-code><code><span class="z-text z-plain">Type:
</span><span class="z-text z-plain">0 ОК
</span><span class="z-text z-plain">1 ОК и Отмена
</span><span class="z-text z-plain">2 Стоп, Повтор, Пропустить
</span><span class="z-text z-plain">3 Да, Нет, Отмена
</span><span class="z-text z-plain">4 Да и Нет
</span><span class="z-text z-plain">5 Повтор и Отмена
</span><span class="z-text z-plain">16 Stop
</span><span class="z-text z-plain">32 Question
</span><span class="z-text z-plain">48 Exclamation
</span><span class="z-text z-plain">64 Information
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Output:
</span><span class="z-text z-plain">-1 Timeout
</span><span class="z-text z-plain">1 ОК
</span><span class="z-text z-plain">2 Отмена
</span><span class="z-text z-plain">3 Стоп
</span><span class="z-text z-plain">4 Повтор
</span><span class="z-text z-plain">5 Пропустить
</span><span class="z-text z-plain">6 Да
</span><span class="z-text z-plain">7 Нет
</span></code></pre> <h3 id=wscript-network><a aria-label="Anchor link for: wscript-network" class=zola-anchor href=#wscript-network><i class=icon></i></a> WScript.Network</h3> <p><code>$wshell = New-Object -ComObject WScript.Network</code> <br> <code>$wshell | Get-Member</code> <br> <code>$wshell.UserName</code> <br> <code>$wshell.ComputerName</code> <br> <code>$wshell.UserDomain</code></p> <h3 id=shell-application><a aria-label="Anchor link for: shell-application" class=zola-anchor href=#shell-application><i class=icon></i></a> Shell.Application</h3> <p><code>$wshell = New-Object -ComObject Shell.Application</code> <br> <code>$wshell | Get-Member</code> <br> <code>$wshell.Explore("C:\")</code> <br> <code>$wshell.Windows() | Get-Member</code> получить доступ к открытым в проводнике или браузере Internet Explorer окон</p> <p><code>$shell = New-Object -Com Shell.Application</code> <br> <code>$RecycleBin = $shell.Namespace(10)</code> <br> <code>$RecycleBin.Items()</code></p> <h3 id=outlook><a aria-label="Anchor link for: outlook" class=zola-anchor href=#outlook><i class=icon></i></a> Outlook</h3> <p><code>$Outlook = New-Object -ComObject Outlook.Application</code> <br> <code>$Outlook | Get-Member</code> <br> <code>$Outlook.Version</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Outlook</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject Outlook.Application
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Namespace</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Outlook<span class="z-variable z-other z-member z-powershell">.GetNamespace</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MAPI<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Folder</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>namespace<span class="z-variable z-other z-member z-powershell">.GetDefaultFolder</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> исходящие
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Folder</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>namespace<span class="z-variable z-other z-member z-powershell">.GetDefaultFolder</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">6</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> входящие
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Explorer</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Folder<span class="z-variable z-other z-member z-powershell">.GetExplorer</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Explorer<span class="z-variable z-other z-member z-powershell">.Display</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>	
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Outlook<span class="z-variable z-other z-member z-powershell">.Quit</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=microsoft-update><a aria-label="Anchor link for: microsoft-update" class=zola-anchor href=#microsoft-update><i class=icon></i></a> Microsoft.Update</h3> <p><code>(New-Object -com 'Microsoft.Update.AutoUpdate').Settings</code> <br> <code>(New-Object -com 'Microsoft.Update.AutoUpdate').Results</code> <br> <code>(New-Timespan -Start ((New-Object -com 'Microsoft.Update.AutoUpdate').Results|Select -ExpandProperty LastInstallationSuccessDate) -End (Get-Date)).hours</code> кол-во часов, прошедших с последней даты установки обновления безопасности в Windows.</p> <h2 id=net><a aria-label="Anchor link for: net" class=zola-anchor href=#net><i class=icon></i></a> .NET</h2> <p><code>[System.Diagnostics.EventLog] | select Assembly,Module</code> <br> <code>$EventLog = [System.Diagnostics.EventLog]::new("Application")</code> <br> <code>$EventLog = New-Object -TypeName System.Diagnostics.EventLog -ArgumentList Application,192.168.3.100</code> <br> <code>$EventLog | Get-Member -MemberType Method</code> <br> <code>$EventLog.MaximumKilobytes</code> максимальный размер журнала <br> <code>$EventLog.Entries</code> просмотреть журнал <br> <code>$EventLog.Clear()</code> очистить журнал</p> <p><code>Join-Path C: Install Test</code> <br> <code>[System.IO.Path]::Combine("C:", "Install", "Test")</code></p> <h3 id=match><a aria-label="Anchor link for: match" class=zola-anchor href=#match><i class=icon></i></a> Match</h3> <p><code>[System.Math] | Get-Member -Static -MemberType Methods</code> <br> <code>[System.Math]::Max(2,7)</code> <br> <code>[System.Math]::Min(2,7)</code> <br> <code>[System.Math]::Floor(3.9)</code> <br> <code>[System.Math]::Truncate(3.9)</code></p> <h3 id=generatepassword><a aria-label="Anchor link for: generatepassword" class=zola-anchor href=#generatepassword><i class=icon></i></a> GeneratePassword</h3> <p><code>Add-Type -AssemblyName System.Web</code> <br> <code>[System.Web.Security.Membership]::GeneratePassword(10,2)</code></p> <h3 id=soundplayer><a aria-label="Anchor link for: soundplayer" class=zola-anchor href=#soundplayer><i class=icon></i></a> SoundPlayer</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CriticalSound</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Media.SoundPlayer
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CriticalSound<span class="z-variable z-other z-member z-powershell">.SoundLocation</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\WINDOWS\Media\Windows Critical Stop.wav<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CriticalSound<span class="z-variable z-other z-member z-powershell">.Play</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>GoodSound</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Media.SoundPlayer
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>GoodSound<span class="z-variable z-other z-member z-powershell">.SoundLocation</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\WINDOWS\Media\tada.wav<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>GoodSound<span class="z-variable z-other z-member z-powershell">.Play</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=static-class><a aria-label="Anchor link for: static-class" class=zola-anchor href=#static-class><i class=icon></i></a> Static Class</h3> <p><code>[System.Environment] | Get-Member -Static</code> <br> <code>[System.Environment]::OSVersion</code> <br> <code>[System.Environment]::Version</code> <br> <code>[System.Environment]::MachineName</code> <br> <code>[System.Environment]::UserName</code></p> <p><code>[System.Diagnostics.Process] | Get-Member -Static</code> <br> <code>[System.Diagnostics.Process]::Start('notepad.exe')</code></p> <h3 id=clicker><a aria-label="Anchor link for: clicker" class=zola-anchor href=#clicker><i class=icon></i></a> Clicker</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cSource</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-heredoc z-powershell">@'
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">using System;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">using System.Drawing;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">using System.Runtime.InteropServices;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">using System.Windows.Forms;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">public class Clicker
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646270(v=vs.85).aspx
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">[StructLayout(LayoutKind.Sequential)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">struct INPUT
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">{ 
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int        type; // 0 = INPUT_MOUSE,
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">                            // 1 = INPUT_KEYBOARD
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">                            // 2 = INPUT_HARDWARE
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public MOUSEINPUT mi;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646273(v=vs.85).aspx
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">[StructLayout(LayoutKind.Sequential)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">struct MOUSEINPUT
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    dx ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    dy ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    mouseData ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    dwFlags;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    time;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public IntPtr dwExtraInfo;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//This covers most use cases although complex mice may have additional buttons
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//There are additional constants you can use for those cases, see the msdn page
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_MOVED      = 0x0001 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_LEFTDOWN   = 0x0002 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_LEFTUP     = 0x0004 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_RIGHTDOWN  = 0x0008 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_RIGHTUP    = 0x0010 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_MIDDLEDOWN = 0x0020 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_MIDDLEUP   = 0x0040 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_WHEEL      = 0x0080 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_XDOWN      = 0x0100 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_XUP        = 0x0200 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_ABSOLUTE   = 0x8000 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int screen_length          = 0x10000 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646310(v=vs.85).aspx
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">[System.Runtime.InteropServices.DllImport("user32.dll")]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">extern static uint SendInput(uint nInputs, INPUT[] pInputs, int cbSize);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">public static void LeftClickAtPoint(int x, int y)
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    //Move the mouse
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    INPUT[] input = new INPUT[3];
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[0].mi.dx = x*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[0].mi.dy = y*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[0].mi.dwFlags = MOUSEEVENTF_MOVED | MOUSEEVENTF_ABSOLUTE;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    //Left mouse button down
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[1].mi.dwFlags = MOUSEEVENTF_LEFTDOWN;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    //Left mouse button up
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[2].mi.dwFlags = MOUSEEVENTF_LEFTUP;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    SendInput(3, input, Marshal.SizeOf(input[0]));
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">'@</span>
</span></code></pre> <p><code>Add-Type -TypeDefinition $cSource -ReferencedAssemblies System.Windows.Forms,System.Drawing</code> <br> <code>[Clicker]::LeftClickAtPoint(1900,1070)</code></p> <h3 id=audio><a aria-label="Anchor link for: audio" class=zola-anchor href=#audio><i class=icon></i></a> Audio</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Language CsharpVersion3 <span class="z-keyword z-operator z-assignment z-powershell">-</span>TypeDefinition <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">using System.Runtime.InteropServices;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[Guid("5CDF2C82-841E-4546-9722-0CF74078229A"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">interface IAudioEndpointVolume {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">// f(), g(), ... are unused COM method slots. Define these if you care
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int f(); int g(); int h(); int i();
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int SetMasterVolumeLevelScalar(float fLevel, System.Guid pguidEventContext);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int j();
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int GetMasterVolumeLevelScalar(out float pfLevel);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int k(); int l(); int m(); int n();
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int SetMute([MarshalAs(UnmanagedType.Bool)] bool bMute, System.Guid pguidEventContext);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int GetMute(out bool pbMute);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[Guid("D666063F-1587-4E43-81F1-B948E807363F"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">interface IMMDevice {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int Activate(ref System.Guid id, int clsCtx, int activationParams, out IAudioEndpointVolume aev);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[Guid("A95664D2-9614-4F35-A746-DE8DB63617E6"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">interface IMMDeviceEnumerator {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int f(); // Unused
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int GetDefaultAudioEndpoint(int dataFlow, int role, out IMMDevice endpoint);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[ComImport, Guid("BCDE0395-E52F-467C-8E3D-C4579291692E")] class MMDeviceEnumeratorComObject { }
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public class Audio {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">static IAudioEndpointVolume Vol() {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">var enumerator = new MMDeviceEnumeratorComObject() as IMMDeviceEnumerator;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">IMMDevice dev = null;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">Marshal.ThrowExceptionForHR(enumerator.GetDefaultAudioEndpoint(/*eRender*/ 0, /*eMultimedia*/ 1, out dev));
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">IAudioEndpointVolume epv = null;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">var epvid = typeof(IAudioEndpointVolume).GUID;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">Marshal.ThrowExceptionForHR(dev.Activate(ref epvid, /*CLSCTX_ALL*/ 23, 0, out epv));
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">return epv;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public static float Volume {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">get {float v = -1; Marshal.ThrowExceptionForHR(Vol().GetMasterVolumeLevelScalar(out v)); return v;}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">set {Marshal.ThrowExceptionForHR(Vol().SetMasterVolumeLevelScalar(value, System.Guid.Empty));}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public static bool Mute {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">get { bool mute; Marshal.ThrowExceptionForHR(Vol().GetMute(out mute)); return mute; }
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">set { Marshal.ThrowExceptionForHR(Vol().SetMute(value, System.Guid.Empty)); }
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span></code></pre> <p><code>[Audio]::Volume = 0.50</code> <br> <code>[Audio]::Mute = $true</code></p> <h3 id=netsessionenum><a aria-label="Anchor link for: netsessionenum" class=zola-anchor href=#netsessionenum><i class=icon></i></a> NetSessionEnum</h3> <p><a href="https://learn.microsoft.com/ru-ru/windows/win32/api/lmshare/nf-lmshare-netsessionenum?redirectedfrom=MSDN">Function</a> <br> <a href=https://fuzzysecurity.com/tutorials/24.html>Source</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Invoke-NetSessionEnum</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HostName</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>TypeDefinition <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">using System;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">using System.Diagnostics;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">using System.Runtime.InteropServices;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[StructLayout(LayoutKind.Sequential)]
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public struct SESSION_INFO_10
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">{
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    [MarshalAs(UnmanagedType.LPWStr)]public string OriginatingHost;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    [MarshalAs(UnmanagedType.LPWStr)]public string DomainUser;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    public uint SessionTime;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    public uint IdleTime;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public static class Netapi32
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">{
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[DllImport("Netapi32.dll", SetLastError=true)]
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    public static extern int NetSessionEnum(
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        [In,MarshalAs(UnmanagedType.LPWStr)] string ServerName,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        [In,MarshalAs(UnmanagedType.LPWStr)] string UncClientName,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        [In,MarshalAs(UnmanagedType.LPWStr)] string UserName,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        Int32 Level,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        out IntPtr bufptr,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        int prefmaxlen,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        ref Int32 entriesread,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        ref Int32 totalentries,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        ref Int32 resume_handle);
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">         
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[DllImport("Netapi32.dll", SetLastError=true)]
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    public static extern int NetApiBufferFree(
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        IntPtr Buffer);
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Create SessionInfo10 Struct<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> SESSION_INFO_10
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10StructSize</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Runtime.InteropServices.Marshal</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::SizeOf<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Grab size to loop bufptr
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10<span class="z-variable z-other z-member z-powershell">.GetType</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Hacky<span class="z-keyword z-operator z-other z-powershell">,</span> but we need this <span class="z-punctuation z-terminator z-statement z-powershell">;</span>))
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> NetSessionEnum params<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">IntPtr</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Zero<span class="z-keyword z-operator z-other z-powershell">`</span> Struct output buffer
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EntriesRead</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TotalEntries</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ResumeHandle</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">`</span> Counters <span class="z-keyword z-operator z-other z-powershell">&</span> ResumeHandle
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CallResult</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Netapi32</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::NetSessionEnum<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HostName</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">10</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EntriesRead</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TotalEntries</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ResumeHandle</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CallResult</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Mmm something went wrong!<span class="z-constant z-character z-escape z-powershell">`n</span>Error Code: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CallResult</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IntPtr</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Size <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-constant z-character z-escape z-powershell">`n</span>Netapi32::NetSessionEnum Buffer Offset  --> 0x<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0:X8}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr<span class="z-variable z-other z-member z-powershell">.ToInt32</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-constant z-character z-escape z-powershell">`n</span>Netapi32::NetSessionEnum Buffer Offset  --> 0x<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0:X16}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr<span class="z-variable z-other z-member z-powershell">.ToInt64</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Result-set contains <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EntriesRead</span> session(s)!<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Change buffer offset to int<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BufferOffset</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr<span class="z-variable z-other z-member z-powershell">.ToInt64</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Loop buffer entries and cast pointers as SessionInfo10<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">for</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Count</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Count</span> <span class="z-keyword z-operator z-comparison z-powershell">-lt</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EntriesRead</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Count</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-keyword z-operator z-assignment z-powershell">+</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NewIntPtr</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Intptr <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BufferOffset</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Info</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">system.runtime.interopservices.marshal</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::PtrToStructure<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NewIntPtr</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">type</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Info</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BufferOffset</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BufferOffset</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10StructSize</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-constant z-character z-escape z-powershell">`n</span>Calling NetApiBufferFree, no memleaks here!<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Netapi32</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::NetApiBufferFree<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span><span class="z-support z-function z-powershell">Out-Null</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>Invoke-NetSessionEnum localhost</code></p> <h3 id=copyfile><a aria-label="Anchor link for: copyfile" class=zola-anchor href=#copyfile><i class=icon></i></a> CopyFile</h3> <p><a href=https://learn.microsoft.com/ru-ru/windows/win32/api/winbase/nf-winbase-copyfile>Function</a> <br> <a href=https://devblogs.microsoft.com/scripting/use-powershell-to-interact-with-the-windows-api-part-1/>Source</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MethodDefinition</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[DllImport("kernel32.dll", CharSet = CharSet.Unicode)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public static extern bool CopyFile(string lpExistingFileName, string lpNewFileName, bool bFailIfExists);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Kernel32</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>MemberDefinition <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MethodDefinition</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Kernel32<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Namespace <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Win32<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PassThru
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Kernel32</span>::CopyFile<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">Env:</span>SystemRoot</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\System32\calc.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">Env:</span>USERPROFILE</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Desktop\calc.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>False</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> 
</span></code></pre> <h3 id=showwindowasync><a aria-label="Anchor link for: showwindowasync" class=zola-anchor href=#showwindowasync><i class=icon></i></a> ShowWindowAsync</h3> <p><a href=https://learn.microsoft.com/ru-ru/windows/win32/api/winuser/nf-winuser-showwindowasync>Function</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Signature</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[DllImport("user32.dll")]public static extern bool ShowWindowAsync(IntPtr hWnd, int nCmdShow);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>MemberDefinition <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Signature</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Win32ShowWindowAsync<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Namespace Win32Functions <span class="z-keyword z-operator z-assignment z-powershell">-</span>PassThru
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-Member</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-storage z-modifier z-powershell">Static</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span>::ShowWindowAsync<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Id <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pid</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.MainWindowHandle<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span>::ShowWindowAsync<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Id <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Pid</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.MainWindowHandle<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span>::ShowWindowAsync<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Id <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Pid</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.MainWindowHandle<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=getasynckeystate><a aria-label="Anchor link for: getasynckeystate" class=zola-anchor href=#getasynckeystate><i class=icon></i></a> GetAsyncKeyState</h3> <p><a href=https://learn.microsoft.com/ru-ru/windows/win32/api/winuser/nf-winuser-getasynckeystate>Function</a></p> <p><code>Add-Type -AssemblyName System.Windows.Forms</code> <br> <code>[int][System.Windows.Forms.Keys]::F1</code> определить номер [Int] клавиши по ее названию <br> <code>65..90 | % {"{0} = {1}" -f $_, [System.Windows.Forms.Keys]$_}</code> порядковый номер букв (A..Z)</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-ControlKey</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">112</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Signature</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-heredoc z-powershell">@'
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">[DllImport("user32.dll", CharSet=CharSet.Auto, ExactSpelling=true)] 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">public static extern short GetAsyncKeyState(int virtualKeyCode); 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">'@</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>MemberDefinition <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Signature</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name Keyboard <span class="z-keyword z-operator z-assignment z-powershell">-</span>Namespace PsOneApi
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">bool</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PsOneApi.Keyboard</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetAsyncKeyState<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">-32767</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Warning</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Press F1 to exit<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoNewline
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-ControlKey</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">break</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Seconds <span class="z-constant z-numeric z-integer z-powershell">0.5</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <h2 id=console-api><a aria-label="Anchor link for: console-api" class=zola-anchor href=#console-api><i class=icon></i></a> Console API</h2> <p><a href=https://powershell.one/tricks/input-devices/detect-key-press>Source</a></p> <p><code>[Console] | Get-Member -Static</code> <br> <code>[Console]::BackgroundColor = "Blue"</code> <br> <code>[Console]::OutputEncoding</code> используемая кодировка в текущей сессии <br> <code>[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding("utf-8")</code> изменить кодировку для отображения кириллицы <br> <code>[Console]::outputEncoding = [System.Text.Encoding]::GetEncoding("cp866")</code> для ISE <br> <code>[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding("windows-1251")</code> для ps2exe <br> <code>Get-Service | Out-File $home\Desktop\Service.txt -Encoding oem</code> > <br> <code>Get-Service | Out-File $home\Desktop\Service.txt -Append</code> >></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">do</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::KeyAvailable</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyInfo</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ReadKey<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">break</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoNewline
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Host</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyInfo</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-KeyPress</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ConsoleKey</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Key</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.ConsoleModifiers</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ModifierKey</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::KeyAvailable</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressedKey</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ReadKey<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>isPressedKey</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressedKey<span class="z-variable z-other z-member z-powershell">.Key</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>isPressedKey</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressedKey<span class="z-variable z-other z-member z-powershell">.Modifiers</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ModifierKey</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Beep<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1800</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">200</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Warning</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Press Ctrl+Shift+Q to exit<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">do</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoNewline
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressed</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-KeyPress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Key Q <span class="z-keyword z-operator z-assignment z-powershell">-</span>ModifierKey <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Control,Shift<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressed</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-keyword z-control z-powershell">break</span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h2 id=drawing><a aria-label="Anchor link for: drawing" class=zola-anchor href=#drawing><i class=icon></i></a> Drawing</h2> <p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.drawing?view=net-7.0&redirectedfrom=MSDN">API</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>AssemblyName System.Drawing
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Width</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">800</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Height</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">400</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Drawing.Bitmap<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Width</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Height</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>graphic</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Graphics</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromImage<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>background_color</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Brushes</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Blue <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать цвет фона (синий)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>graphic<span class="z-variable z-other z-member z-powershell">.FillRectangle</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>background_color</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image<span class="z-variable z-other z-member z-powershell">.Width</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image<span class="z-variable z-other z-member z-powershell">.Height</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text_color</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Brushes</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::White <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать цвет текста (белый)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>font</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Drawing.Font<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Arial<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.FontStyle</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bold</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать шрифт<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>PowerShell<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> указать текст<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text_position</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Drawing.RectangleF<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">320</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">180</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">300</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">100</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>  <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать положение текста (x, y, width, height)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>graphic<span class="z-variable z-other z-member z-powershell">.DrawString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>font</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text_color</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text_position</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> нанести текст на изображение<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\powershell_image.bmp<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Imaging.ImageFormat</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bmp</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> сохранить изображение<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> освобождение ресурсов<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <p><code>$path = "$home\desktop\powershell_image.bmp"</code> <br> <code>Invoke-Item $path</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>src_image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Image</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromFile<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Width</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">400</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Height</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">200</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dst_image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Drawing.Bitmap <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>src_image</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Width</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Height</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> изменить размер изображения<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dst_image<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\powershell_image_resize.bmp<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Imaging.ImageFormat</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bmp</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rotated_image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>src_image<span class="z-variable z-other z-member z-powershell">.Clone</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> создать копию исходного изображения<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rotated_image<span class="z-variable z-other z-member z-powershell">.RotateFlip</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.RotateFlipType</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Rotate180FlipNone</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> перевернуть изображение на 180 градусов<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rotated_image<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\powershell_image_rotated.bmp<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Imaging.ImageFormat</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bmp</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>src_image<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> закрыть (отпустить) исходный файл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <h2 id=objectevent><a aria-label="Anchor link for: objectevent" class=zola-anchor href=#objectevent><i class=icon></i></a> ObjectEvent</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timer</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Timers.Timer
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timer<span class="z-variable z-other z-member z-powershell">.Interval</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">1000</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Register-ObjectEvent</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>InputObject <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timer</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>EventName Elapsed <span class="z-keyword z-operator z-assignment z-powershell">-</span>SourceIdentifier Timer.Output <span class="z-keyword z-operator z-assignment z-powershell">-</span>Action <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Random</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Random</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Min <span class="z-constant z-numeric z-integer z-powershell">0</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Max <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Random</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timer<span class="z-variable z-other z-member z-powershell">.Enabled</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span>
</span></code></pre> <p><code>$Timer.Enabled = $False</code> остановить <br> <code>$Timer | Get-Member -MemberType Event</code> отобразить список всех событий объекта <br> <code>Get-EventSubscriber</code> список зарегистрированных подписок на события в текущей сессии <br> <code>Unregister-Event -SourceIdentifier Timer.Output</code> удаляет регистрацию подписки на событие по имени события (EventName) или все * <br> <code>-Forward</code> перенаправляет события из удаленного сеанса (New-PSSession) в локальный сеанс <br> <code>-SupportEvent</code> не выводит результат регистрации события на экран (и Get-EventSubscriber и Get-Job)</p> <pre class=z-code><code><span class="z-text z-plain">Register-EngineEvent -SourceIdentifier PowerShell.Exiting -Action {
</span><span class="z-text z-plain">$date = Get-Date -f hh:mm:ss
</span><span class="z-text z-plain">(New-Object -ComObject Wscript.Shell).Popup("PowerShell Exit: $date",0,"Action",64)
</span><span class="z-text z-plain">}
</span></code></pre> <h2 id=sockets><a aria-label="Anchor link for: sockets" class=zola-anchor href=#sockets><i class=icon></i></a> Sockets</h2> <h3 id=udp-socket><a aria-label="Anchor link for: udp-socket" class=zola-anchor href=#udp-socket><i class=icon></i></a> UDP-Socket</h3> <p><a href=https://cloudbrothers.info/en/test-udp-connection-powershell/>Source</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-UDPServer</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Port</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">5201</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RemoteComputer</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Net.IPEndPoint<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.IPAddress</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Any<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">do</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UdpObject</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Net.Sockets.UdpClient<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Port</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ReceiveBytes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UdpObject<span class="z-variable z-other z-member z-powershell">.Receive</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RemoteComputer</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UdpObject<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ASCIIEncoding</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Text.ASCIIEncoding
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ReturnString</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ASCIIEncoding<span class="z-variable z-other z-member z-powershell">.GetString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ReceiveBytes</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">LocalDateTime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-Date</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>UFormat <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>%Y-%m-%d %T<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ClientIP</span>      <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RemoteComputer<span class="z-variable z-other z-member z-powershell">.address.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ClientPort</span>    <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RemoteComputer<span class="z-variable z-other z-member z-powershell">.Port.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Message</span>       <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ReturnString</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>Start-UDPServer -Port 5201</code></p> <h3 id=test-netudpconnection><a aria-label="Anchor link for: test-netudpconnection" class=zola-anchor href=#test-netudpconnection><i class=icon></i></a> Test-NetUDPConnection</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Test-NetUDPConnection</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ComputerName</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>127.0.0.1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int32</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PortServer</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">5201</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int32</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PortClient</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">5211</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Message</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">begin</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UdpObject</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> system.Net.Sockets.Udpclient<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PortClient</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UdpObject<span class="z-variable z-other z-member z-powershell">.Connect</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ComputerName</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PortServer</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">process</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ASCIIEncoding</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Text.ASCIIEncoding
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-unary z-powershell">!</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Message</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Message</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Date</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>UFormat <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>%Y-%m-%d %T<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Bytes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ASCIIEncoding<span class="z-variable z-other z-member z-powershell">.GetBytes</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Message</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">void</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UdpObject<span class="z-variable z-other z-member z-powershell">.Send</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Bytes</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Bytes<span class="z-variable z-other z-member z-powershell">.length</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">end</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UdpObject<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>Test-NetUDPConnection -ComputerName 127.0.0.1 -PortServer 5201</code> <br> <code>Test-NetUDPConnection -ComputerName 127.0.0.1 -PortServer 514 -Message "&LT30>May 31 00:00:00 HostName multipathd[784]: Test message"</code></p> <h3 id=tcp-socket><a aria-label="Anchor link for: tcp-socket" class=zola-anchor href=#tcp-socket><i class=icon></i></a> TCP-Socket</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-TCPServer</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Port</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">5201</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">do</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TcpObject</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Net.Sockets.TcpListener<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ReceiveBytes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TcpObject<span class="z-variable z-other z-member z-powershell">.Start</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ReceiveBytes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TcpObject<span class="z-variable z-other z-member z-powershell">.AcceptTcpClient</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TcpObject<span class="z-variable z-other z-member z-powershell">.Stop</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ReceiveBytes<span class="z-variable z-other z-member z-powershell">.Client.RemoteEndPoint</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> select Address<span class="z-keyword z-operator z-other z-powershell">,</span> Port
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>Start-TCPServer -Port 5201</code> <br> <code>Test-NetConnection -ComputerName 127.0.0.1 -Port 5201</code></p> <h3 id=wakeonlan><a aria-label="Anchor link for: wakeonlan" class=zola-anchor href=#wakeonlan><i class=icon></i></a> WakeOnLan</h3> <p>Broadcast package consisting of 6 byte filled “0xFF” and then 96 byte where the mac address is repeated 16 times</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Send-WOL</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Mac</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IP</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Port</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">9</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Mac</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Mac<span class="z-variable z-other z-member z-powershell">.replace</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>:<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>-<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-unary z-powershell">!</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IP</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IP</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.IPAddress</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Broadcast <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SynchronizationChain</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">byte</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-hex z-powershell">0xFF</span> <span class="z-keyword z-operator z-assignment z-powershell">*</span> <span class="z-constant z-numeric z-integer z-powershell">6</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ByteMac</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Mac<span class="z-variable z-other z-member z-powershell">.Split</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>-<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">%</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">byte</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>0x<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Package</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SynchronizationChain</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ByteMac</span> <span class="z-keyword z-operator z-assignment z-powershell">*</span> <span class="z-constant z-numeric z-integer z-powershell">16</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UdpClient</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Net.Sockets.UdpClient
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UdpClient<span class="z-variable z-other z-member z-powershell">.Connect</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IP</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UdpClient<span class="z-variable z-other z-member z-powershell">.Send</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Package</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Package<span class="z-variable z-other z-member z-powershell">.Length</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UdpClient<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>Send-WOL -Mac "D8-BB-C1-70-A3-4E"</code> <br> <code>Send-WOL -Mac "D8-BB-C1-70-A3-4E" -IP 192.168.3.100</code></p> <h3 id=httplistener><a aria-label="Anchor link for: httplistener" class=zola-anchor href=#httplistener><i class=icon></i></a> HTTPListener</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>httpListener</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Net.HttpListener
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>httpListener<span class="z-variable z-other z-member z-powershell">.Prefixes.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://+:8888/<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>httpListener<span class="z-variable z-other z-member z-powershell">.Start</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-unary z-powershell">!</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::KeyAvailable</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>info</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Service</span> <span class="z-keyword z-operator z-other z-powershell">|</span> select name<span class="z-keyword z-operator z-other z-powershell">,</span> status <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-HTML</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>context</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>httpListener<span class="z-variable z-other z-member z-powershell">.GetContext</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>context<span class="z-variable z-other z-member z-powershell">.Response.StatusCode</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">200</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>context<span class="z-variable z-other z-member z-powershell">.Response.ContentType</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>text/HTML<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WebContent</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>info</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EncodingWebContent</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::UTF8.GetBytes<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WebContent</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>context<span class="z-variable z-other z-member z-powershell">.Response.OutputStream.Write</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EncodingWebContent</span> <span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EncodingWebContent<span class="z-variable z-other z-member z-powershell">.Length</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>context<span class="z-variable z-other z-member z-powershell">.Response.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Get-NetTcpConnection</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>LocalPort <span class="z-constant z-numeric z-integer z-powershell">8888</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.datetime
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>httpListener<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=webclient><a aria-label="Anchor link for: webclient" class=zola-anchor href=#webclient><i class=icon></i></a> WebClient</h3> <p><code>[System.Net.WebClient] | Get-Member</code> <br> <code>(New-Object Net.WebClient).DownloadString("https://raw.githubusercontent.com/Lifailon/PowerShell-Commands/rsa/README.md")</code></p> <h3 id=httpclient><a aria-label="Anchor link for: httpclient" class=zola-anchor href=#httpclient><i class=icon></i></a> HttpClient</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-support z-function z-powershell">Split-Path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Leaf</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>httpClient</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.Http.HttpClient</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::new<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Выполнение GET-запроса для загрузки файла (считывая заголовки ответа)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>httpClient<span class="z-variable z-other z-member z-powershell">.GetAsync</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.Http.HttpCompletionOption</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ResponseHeadersRead</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Result
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Получение потока содержимого из заголовка ответа<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stream</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.Content.ReadAsStreamAsync</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Result
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Открытие файла для записи<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileStream</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.File</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::OpenWrite<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">try</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создание буфера размером 81920 байт (80 КБ) для чтения данных из потока<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>buffer</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> byte<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-constant z-numeric z-integer z-powershell">81920</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Чтение данных из потока и запись их в файл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bytesRead</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stream<span class="z-variable z-other z-member z-powershell">.Read</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>buffer</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>buffer<span class="z-variable z-other z-member z-powershell">.Length</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileStream<span class="z-variable z-other z-member z-powershell">.Write</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>buffer</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bytesRead</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">finally</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Освобождение ресурсов, связанных с потоками<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stream<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileStream<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <h3 id=certificate><a aria-label="Anchor link for: certificate" class=zola-anchor href=#certificate><i class=icon></i></a> Certificate</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-WebCertificate</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>iwr</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> iwr <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_code</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>iwr<span class="z-variable z-other z-member z-powershell">.StatusCode</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>iwr<span class="z-variable z-other z-member z-powershell">.BaseResponse.StatusCode</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>info</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>iwr<span class="z-variable z-other z-member z-powershell">.BaseResponse.Server</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>spm</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.ServicePointManager</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FindServicePoint<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>date_end</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>spm<span class="z-variable z-other z-member z-powershell">.Certificate.GetExpirationDateString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cert_name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>spm<span class="z-variable z-other z-member z-powershell">.Certificate.Subject</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>CN=<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cert_owner</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>spm<span class="z-variable z-other z-member z-powershell">.Certificate.Issuer</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>, <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">where</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>O=<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>O=<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Object</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Host</span>        <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Server</span>      <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>info</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Status</span>      <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">StatusCode</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_code</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Certificate</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cert_name</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Issued</span>      <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cert_owner</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">End</span>         <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>date_end</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>Get-WebCertificate https://google.com</code></p> <h2 id=base64><a aria-label="Anchor link for: base64" class=zola-anchor href=#base64><i class=icon></i></a> Base64</h2> <h3 id=utf8><a aria-label="Anchor link for: utf8" class=zola-anchor href=#utf8><i class=icon></i></a> UTF8</h3> <p><code>$loginPassword = "login:password"</code> <br> <code>$Base64 = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($loginPassword))</code> закодировать логин и пароль в строку Base64 <br> <code>[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($Base64))</code> преобразовать в байты и обратно декодировать в исходную строку с помощью UTF-8 кодировки</p> <h3 id=unicode><a aria-label="Anchor link for: unicode" class=zola-anchor href=#unicode><i class=icon></i></a> Unicode</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>password<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>byte</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Unicode.GetBytes<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> преобразует строку $text в последовательность байтов, используя кодировку Unicode<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>base64</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Convert</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ToBase64String<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>byte</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> байты конвертируются в строку Base64 с помощью метода ToBase64String<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>decode_base64</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Convert</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromBase64String<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>base64</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> декодировать строку Base64 обратно в последовательность байтов с помощью метода FromBase64String<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>decode_string</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Unicode.GetString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>decode_base64</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> закодированные байты преобразуются обратно в строку с использованием кодировки Unicode с помощью метода GetString<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <h3 id=image><a aria-label="Anchor link for: image" class=zola-anchor href=#image><i class=icon></i></a> Image</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\1200x800.jpg<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BBase64</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Convert</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ToBase64String<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Content</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_image</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Encoding Byte</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>assembly System.Drawing
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Bitmap</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromStream<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">IO.MemoryStream</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Convert</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromBase64String<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BBase64</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Image<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Desktop\1200x800.jpg<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h2 id=excel><a aria-label="Anchor link for: excel" class=zola-anchor href=#excel><i class=icon></i></a> Excel</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Desktop\Services-to-Excel.xlsx<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject Excel.Application
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel<span class="z-variable z-other z-member z-powershell">.Visible</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span><span class="z-keyword z-operator z-other z-powershell">`</span> отключить открытие GUI
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel<span class="z-variable z-other z-member z-powershell">.Workbooks.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Создать книгу
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook<span class="z-variable z-other z-member z-powershell">.Worksheets.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Создать лист
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Name</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Services<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> задать имя листа
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Cells.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Name service<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Задать имена столбцов:<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Cells.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Description<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Cells.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Status<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Cells.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Startup type<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Rows.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Font.Bold <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-keyword z-operator z-other z-powershell">`</span> выделить жирным шрифтом
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Rows.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Font.size<span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">14</span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Задать ширину колонок:<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ColumnWidth<span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">30</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ColumnWidth<span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">80</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ColumnWidth<span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">15</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ColumnWidth<span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">25</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>services</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span>  <span class="z-support z-function z-powershell">Get-Service</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-keyword z-operator z-other z-powershell">`</span> задать начальный номер строки для записи
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>service</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>services</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>service<span class="z-variable z-other z-member z-powershell">.Status</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Stopped<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Running<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Start</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>service<span class="z-variable z-other z-member z-powershell">.StartType</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Start</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>start_type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Delayed start<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Start</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>start_type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Automatic<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Start</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>start_type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Manually<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Start</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>start_type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Disabled<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Rows.Item<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>service<span class="z-variable z-other z-member z-powershell">.Name</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Rows.Item<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>service<span class="z-variable z-other z-member z-powershell">.DisplayName</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Rows.Item<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_type</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Rows.Item<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>start_type</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_type</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Running<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Rows.Item<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Font.Bold <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> +1 увеличить для счетчика строки Rows<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-keyword z-operator z-assignment z-powershell">+</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook<span class="z-variable z-other z-member z-powershell">.SaveAs</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook<span class="z-variable z-other z-member z-powershell">.close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel<span class="z-variable z-other z-member z-powershell">.Quit</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=excel-application-open><a aria-label="Anchor link for: excel-application-open" class=zola-anchor href=#excel-application-open><i class=icon></i></a> Excel.Application.Open</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Desktop\Services-to-Excel.xlsx<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject Excel.Application
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel<span class="z-variable z-other z-member z-powershell">.Visible</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>excel<span class="z-variable z-other z-member z-powershell">.Workbooks.Open</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> открыть xlsx<span class="z-keyword z-operator z-assignment z-powershell">-</span>файл
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook<span class="z-variable z-other z-member z-powershell">.Sheets</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> select Name<span class="z-keyword z-operator z-other z-powershell">,</span>Index<span class="z-keyword z-operator z-other z-powershell">`</span> отобразить листы
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook<span class="z-variable z-other z-member z-powershell">.Sheets.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> открыть лист по номеру Index
</span><span class="z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">100</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">%</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Range</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>A<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Text<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> прочитать значение из столбца А строки c <span class="z-constant z-numeric z-integer z-powershell">1</span> по <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel<span class="z-variable z-other z-member z-powershell">.Quit</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=importexcel><a aria-label="Anchor link for: importexcel" class=zola-anchor href=#importexcel><i class=icon></i></a> ImportExcel</h3> <p><code>Install-Module -Name ImportExcel</code> <br> <code>$data | Export-Excel .\Data.xlsx</code> <br> <code>$data = Import-Excel .\Data.xlsx</code></p> <p><code>$data = ps</code> <br> <code>$Chart = New-ExcelChartDefinition -XRange CPU -YRange WS -Title "Process" -NoLegend</code> <br> <code>$data | Export-Excel .\ps.xlsx -AutoNameRange -ExcelChartDefinition $Chart -Show</code></p> <h2 id=csv><a aria-label="Anchor link for: csv" class=zola-anchor href=#csv><i class=icon></i></a> CSV</h2> <p><code>Get-Service | Select Name,DisplayName,Status,StartType | Export-Csv -path "$home\Desktop\Get-Service.csv" -Append -Encoding Default</code> экспортировать в csv (-Encoding UTF8) <br> <code>Import-Csv "$home\Desktop\Get-Service.csv" -Delimiter ","</code> импортировать массив</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">ConvertFrom-Csv</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">Region,State,Units,Price
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">West,Texas,927,923.71
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span>,Tennessee,466,770.67
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span></code></pre> <p><code>$systeminfo = systeminfo /FO csv | ConvertFrom-Csv</code> вывод работы программы в CSV и конвертация в объект <br> <code>$systeminfo."Полный объем физической памяти"</code> <br> <code>$systeminfo."Доступная физическая память"</code></p> <h3 id=convertfrom-string><a aria-label="Anchor link for: convertfrom-string" class=zola-anchor href=#convertfrom-string><i class=icon></i></a> ConvertFrom-String</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">log = 
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">   level = 4;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">};
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-String</span><span class="z-keyword z-operator z-other z-powershell">`</span> создает PSCustomObject <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">разбивает по пробелам<span class="z-keyword z-operator z-other z-powershell">,</span> удаляет все пробелы и пустые строки</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=convertfrom-stringdata><a aria-label="Anchor link for: convertfrom-stringdata" class=zola-anchor href=#convertfrom-stringdata><i class=icon></i></a> ConvertFrom-StringData</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">key1 = value1
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">key2 = value2
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-StringData</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> создает Hashtable<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <h2 id=xml><a aria-label="Anchor link for: xml" class=zola-anchor href=#xml><i class=icon></i></a> XML</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">xml</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Content</span> <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\test.rdg</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> прочитать содержимое XML<span class="z-keyword z-operator z-assignment z-powershell">-</span>файла
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.load</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\test.rdg<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> открыть файл
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.RDCMan.file.group.properties.name</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> имена групп
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.RDCMan.file.group.server.properties</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> имена всех серверов
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.RDCMan.file.group</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.server.properties<span class="z-keyword z-operator z-other z-powershell">`</span> список серверов в <span class="z-constant z-numeric z-integer z-powershell">4</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>й группе
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.RDCMan.file.group</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.server.properties <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">?</span> name <span class="z-keyword z-operator z-comparison z-powershell">-like</span> ADIRK</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Name <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>New-Name<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> изменить значение
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.RDCMan.file.group</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.server<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.properties.displayName <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>New-displayName<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> 
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.RDCMan.file.group</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.server<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.RemoveAll<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> удалить объект <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>й сервер в списке</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>file</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> сохранить содержимое объекта в файла
</span></code></pre> <p><code>Get-Service | Export-Clixml -path $home\desktop\test.xml</code> экспортировать объект PowerShell в XML <br> <code>Import-Clixml -Path $home\desktop\test.xml</code> импортировать объект XML в PowerShell <br> <code>ConvertTo-Xml (Get-Service)</code></p> <h3 id=get-credtoxml><a aria-label="Anchor link for: get-credtoxml" class=zola-anchor href=#get-credtoxml><i class=icon></i></a> Get-CredToXML</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-CredToXML</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CredFile</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\cred.xml<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CredFile</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Import-Clixml</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CredFile</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-unary z-powershell">!</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CredFile</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cred</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Credential</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Message <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Enter credential<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cred</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cred</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Export-CliXml</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CredFile</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cred</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">return</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>$Cred = Get-CredToXML</code> <br> <code>$Login = $Cred.UserName</code> <br> <code>$PasswordText = $Cred.GetNetworkCredential().password</code> получить пароль в текстовом виде</p> <h3 id=xmlwriter><a aria-label="Anchor link for: xmlwriter" class=zola-anchor href=#xmlwriter><i class=icon></i></a> XmlWriter</h3> <p><a href="https://learn.microsoft.com/ru-ru/dotnet/api/system.xml.xmlwriter?view=net-8.0">Extensible Markup Language</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlWriterSettings</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Xml.XmlWriterSettings
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlWriterSettings<span class="z-variable z-other z-member z-powershell">.Indent</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-keyword z-operator z-other z-powershell">`</span> включить отступы
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlWriterSettings<span class="z-variable z-other z-member z-powershell">.IndentChars</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>    <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> задать отступ
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlFilePath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\test.xml<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.XML.XmlWriter</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Create<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlFilePath</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlWriterSettings</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> создать документ
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteStartDocument</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> начать запись в документ
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteComment</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Comment<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteStartElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Root<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> создать стартовый элемент<span class="z-keyword z-operator z-other z-powershell">,</span> который содержит дочерние объекты
</span><span class="z-source z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteStartElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Configuration<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> создать первый дочерний элемент для BaseSettings
</span><span class="z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteElementString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Language<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>RU<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteStartElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Fonts<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>   		<span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> &LTFonts><span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteElementString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Name<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Arial<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteElementString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Size<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>12<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteEndElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>               	<span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> &LT/Fonts><span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteEndElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> конечный элемент <span class="z-keyword z-operator z-redirection z-powershell"><</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Configuration<span class="z-keyword z-operator z-redirection z-powershell">></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteEndElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> конечный элемент <span class="z-keyword z-operator z-redirection z-powershell"><</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Root<span class="z-keyword z-operator z-redirection z-powershell">></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteEndDocument</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> завершить запись в документ
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.Flush</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=createelement><a aria-label="Anchor link for: createelement" class=zola-anchor href=#createelement><i class=icon></i></a> CreateElement</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">xml</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">gc <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\test.xml</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.Root.Configuration.Fonts</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NewElement</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.CreateElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Fonts<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> выбрать элемент куда добавить
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NewElement<span class="z-variable z-other z-member z-powershell">.set_InnerXML</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTName>Times New Roman&LT/Name>&LTSize>14&LT/Size><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Заполнить значениями дочерние элементы Fonts
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.Root.Configuration.AppendChild</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NewElement</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> добавить элемент новой строкой в Configuration <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">родитель Fonts</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\test.xml<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h2 id=json><a aria-label="Anchor link for: json" class=zola-anchor href=#json><i class=icon></i></a> JSON</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>log</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">  "log": {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    "level": 7
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">  }
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-Service</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OOKLA</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">"result" : 
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">{"date":1683534970,"id":"14708271987","connection_icon":"wireless","download":33418,"upload":35442,"latency":15,"distance":50,"country_code":"RU","server_id":2707,"server_name":"Bryansk","sponsor_name":"DOM.RU","sponsor_url":null,"connection_mode":"multi","isp_name":"Resource Link","isp_rating":"4.0","test_rank":63,"test_grade":"B-","test_rating":4,"idle_latency":"17","download_latency":"116","upload_latency":"75","additional_servers":
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">[{"server_id":8191,"server_name":"Bryansk","sponsor_name":"SectorTelecom.ru"},{"server_id":46278,"server_name":"Fokino","sponsor_name":"Fokks - Promyshlennaya avtomatika Ltd."},{"server_id":18218,"server_name":"Bryansk","sponsor_name":"RIA-link Ltd."}],
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">"path":"result\u002F14708271987","hasSecondary":true
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ookla<span class="z-variable z-other z-member z-powershell">.result</span></span>
</span></code></pre> <h2 id=yaml><a aria-label="Anchor link for: yaml" class=zola-anchor href=#yaml><i class=icon></i></a> YAML</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-Module</span> PSYaml<span class="z-keyword z-operator z-other z-powershell">`</span> используется в Docker<span class="z-keyword z-operator z-assignment z-powershell">/</span>Ansible
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>netplan</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">network:` словарь по типу - ключ : значение с вложенными словарями
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">  ethernets:
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">    ens160:
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">      dhcp4: yes
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">      dhcp6: no
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">      nameservers:
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">        addresses:` [8.8.8.8, 1.1.1.1]` список данных (строк)
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">		  - 8.8.8.8
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">		  - 1.1.1.1
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">  version: 2
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>network</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">ConvertFrom-Yaml</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>netplan</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>network<span class="z-variable z-other z-member z-powershell">.Values.ethernets.ens160.nameservers</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataType</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">int: !!int 10.1
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">flo: !!float 10.1
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">str: !!str string
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">bool: !!bool` boolean
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre> <h2 id=toml><a aria-label="Anchor link for: toml" class=zola-anchor href=#toml><i class=icon></i></a> TOML</h2> <p><code>Install-Module -Name PSToml -Scope CurrentUser</code> Устанавливаем модуль для чтения toml (PSToml) <br> <code>$toml = Get-Content "$home\Documents\Git\lifailon.github.io\hugo.toml"</code> Читаем содержимое конфигурации Hugo в формате toml <br> <code>$json = ConvertFrom-Toml $toml | ConvertTo-Json -Depth 3</code> Конвертируем TOML в JSON <br> <code>$json | Out-File "$home\Documents\Git\lifailon.github.io\hugo.json"</code> Сохраняем конфигурационный файл в формате JSON</p> <h2 id=markdown><a aria-label="Anchor link for: markdown" class=zola-anchor href=#markdown><i class=icon></i></a> Markdown</h2> <h3 id=convert-markdown-to-html><a aria-label="Anchor link for: convert-markdown-to-html" class=zola-anchor href=#convert-markdown-to-html><i class=icon></i></a> Convert Markdown to HTML</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertFrom-MarkdownToHtml</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-parameter z-attribute z-powershell">ValueFromPipeline</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Markdown</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>html</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-Content</span> index.md <span class="z-keyword z-operator z-assignment z-powershell">-</span>Raw <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Markdown</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.html
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">	&LT!DOCTYPE html>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">	&LThtml>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">	&LThead>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">	&LT/head>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">	&LTbody>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">	<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>html</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">	&LT/body>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">	&LT/html>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">	"@
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span></span></code></pre> <p><code>Get-Content index.md -Raw | ConvertFrom-MarkdownToHtml | Out-File index.html</code></p> <h3 id=psmarkdown><a aria-label="Anchor link for: psmarkdown" class=zola-anchor href=#psmarkdown><i class=icon></i></a> PSMarkdown</h3> <p>Install-Module PSMarkdown</p> <h3 id=convertfrom-markdownv2><a aria-label="Anchor link for: convertfrom-markdownv2" class=zola-anchor href=#convertfrom-markdownv2><i class=icon></i></a> ConvertFrom-MarkdownV2</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">Function</span> <span class="z-entity z-name z-function z-powershell">ConvertFrom-MarkdownV2</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">CmdletBinding</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">OutputType</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">            <span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">            <span class="z-variable z-parameter z-attribute z-powershell">Position</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">            <span class="z-variable z-parameter z-attribute z-powershell">ValueFromPipeline</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">        <span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>InputObject</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Begin</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Process</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mddata</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>InputObject</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mddata</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-comparison z-powershell">-notmatch</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>--<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">End</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">       <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>object</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span> +<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span><span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Csv</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Delimiter <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>|<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">       <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>object</span> 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <h2 id=convertto-markdown><a aria-label="Anchor link for: convertto-markdown" class=zola-anchor href=#convertto-markdown><i class=icon></i></a> ConvertTo-Markdown</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">Function</span> <span class="z-entity z-name z-function z-powershell">ConvertTo-Markdown</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">CmdletBinding</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">OutputType</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">            <span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">            <span class="z-variable z-parameter z-attribute z-powershell">Position</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">            <span class="z-variable z-parameter z-attribute z-powershell">ValueFromPipeline</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">        <span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSObject</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>InputObject</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Begin</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Process</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">ForEach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>item</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>InputObject</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>item</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>item<span class="z-variable z-other z-member z-powershell">.PSObject.Properties</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-keyword z-control z-powershell">if</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Value</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                    <span class="z-keyword z-control z-powershell">if</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-logical z-powershell">-not</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns<span class="z-variable z-other z-member z-powershell">.ContainsKey</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Name</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-logical z-powershell">-or</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Name</span></span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-comparison z-powershell">-lt</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Value.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Length</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Name</span></span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Value.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Length
</span></span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">End</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">ForEach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns<span class="z-variable z-other z-member z-powershell">.Keys</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Math</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Max<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key<span class="z-variable z-other z-member z-powershell">.Length</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>header</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">ForEach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns<span class="z-variable z-other z-member z-powershell">.Keys</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>header</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>{0,-<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>}<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>header</span> <span class="z-keyword z-operator z-unary z-powershell">-join</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span> | <span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>separator</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">ForEach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns<span class="z-variable z-other z-member z-powershell">.Keys</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>separator</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>-<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">*</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>separator</span> <span class="z-keyword z-operator z-unary z-powershell">-join</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span> | <span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">ForEach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>item</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>values</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-keyword z-control z-powershell">ForEach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns<span class="z-variable z-other z-member z-powershell">.Keys</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>values</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>{0,-<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>}<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>item</span>.<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>values</span> <span class="z-keyword z-operator z-unary z-powershell">-join</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span> | <span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <h2 id=html><a aria-label="Anchor link for: html" class=zola-anchor href=#html><i class=icon></i></a> HTML</h2> <h3 id=convertfrom-html><a aria-label="Anchor link for: convertfrom-html" class=zola-anchor href=#convertfrom-html><i class=icon></i></a> ConvertFrom-Html</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertFrom-Html</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">ValueFromPipeline</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>irm</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HTMLFile</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject HTMLFile
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Bytes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Unicode.GetBytes<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>irm</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HTMLFile<span class="z-variable z-other z-member z-powershell">.write</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Bytes</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HTMLFile<span class="z-variable z-other z-member z-powershell">.all</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">where</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.tagname</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>body<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.innerText
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>apache_status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://192.168.3.102/server-status<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>apache_status</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Html</span>
</span></code></pre> <h3 id=convertto-html><a aria-label="Anchor link for: convertto-html" class=zola-anchor href=#convertto-html><i class=icon></i></a> ConvertTo-Html</h3> <p><code>Get-Process | select Name, CPU | ConvertTo-Html -As Table > "$home\desktop\proc-table.html"</code> вывод в формате List (Format-List) или Table (Format-Table)</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>servers</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ya.ru<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ya.com<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>google.com<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Desktop\Ping.html<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> 
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>header</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LT!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LThtml xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LThead>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LTtitle>Отчет о статусе серверов&LT/title>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LTstyle type="text/css">
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LT!--
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">body {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">background-color: #E0E0E0;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">font-family: sans-serif
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">table, th, td {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">background-color: white;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">border-collapse:collapse;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">border: 1px solid black;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">padding: 5px
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">-->
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LT/style>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LTh1>Ping status&LT/h1>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LTp><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-support z-function z-powershell">get-date</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Format <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>dd.MM.yyyy hh:mm<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.&LT/p>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>server</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>servers</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Connection</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>server</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Count <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ea <span class="z-constant z-numeric z-integer z-powershell">0</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Quiet</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Up<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Down<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>server</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Html</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>head <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>header</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>body <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTtd>Down&LT/td><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTtd style='background-color:#FF8080'>Down&LT/td><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTtd>Up&LT/td><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTtd style='background-color:#5BCCF3'>Up&LT/td><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>
</span></code></pre> <h3 id=pswritehtml><a aria-label="Anchor link for: pswritehtml" class=zola-anchor href=#pswritehtml><i class=icon></i></a> PSWriteHTML</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-Module</span> PSWriteHTML
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Module</span> PSWriteHTML</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ExportedCommands
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-Service</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-GridHtml</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath ~<span class="z-support z-function z-powershell">\Desktop\Get-Service</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-support z-function z-powershell">Out-GridHtml</span>.html
</span></code></pre> <h3 id=htmlreport><a aria-label="Anchor link for: htmlreport" class=zola-anchor href=#htmlreport><i class=icon></i></a> HtmlReport</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-Module</span> HtmlReport
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>topVM</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> ps <span class="z-keyword z-operator z-other z-powershell">|</span> Sort PrivateMemorySize <span class="z-keyword z-operator z-assignment z-powershell">-</span>Descending <span class="z-keyword z-operator z-other z-powershell">|</span> Select <span class="z-keyword z-operator z-assignment z-powershell">-</span>First <span class="z-constant z-numeric z-integer z-powershell">10</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">%</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.ProcessName</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span> <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Id</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.PrivateMemorySize</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>topCPU</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> ps <span class="z-keyword z-operator z-other z-powershell">|</span> Sort CPU <span class="z-keyword z-operator z-assignment z-powershell">-</span>Descending <span class="z-keyword z-operator z-other z-powershell">|</span> Select <span class="z-keyword z-operator z-assignment z-powershell">-</span>First <span class="z-constant z-numeric z-integer z-powershell">10</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">%</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.ProcessName</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span> <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Id</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.CPU</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-Report</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Title <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Piggy Processes<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Input <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">New-Chart</span> Bar <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Top VM Users<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>input <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>topVm</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">New-Chart</span> Column <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Top CPU Overall<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>input <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>topCPU</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">ps <span class="z-keyword z-operator z-other z-powershell">|</span> Select ProcessName<span class="z-keyword z-operator z-other z-powershell">,</span> Id<span class="z-keyword z-operator z-other z-powershell">,</span> CPU<span class="z-keyword z-operator z-other z-powershell">,</span> WorkingSet<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-keyword z-operator z-assignment z-powershell">*</span>MemorySize <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">New-Table</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>All Processes<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-redirection z-powershell">></span> ~<span class="z-support z-function z-powershell">\Desktop\Get-Process</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>HtmlReport.html
</span></code></pre> <h2 id=htmlagilitypack><a aria-label="Anchor link for: htmlagilitypack" class=zola-anchor href=#htmlagilitypack><i class=icon></i></a> HtmlAgilityPack</h2> <p><a href=https://www.nuget.org/packages/HtmlAgilityPack>Source</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Загрузка библиотеки C#, которая позволяет парсить HTML-документы, выбирать элементы DOM и извлекать из них данные<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Users\Lifailon\Downloads\HtmlAgilityPack\Net40\HtmlAgilityPack.dll<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>title</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>новобранец<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://fasts-torrent.net<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ep</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>engine/ajax/search_torrent.php?title=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>title</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>html</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ep</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создание нового объекта HtmlDocument из HtmlAgilityPack, который будет использоваться для загрузки и обработки HTML-кода<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HtmlDocument</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> HtmlAgilityPack.HtmlDocument
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Загрузка HTML в созданный объект HtmlDocument<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HtmlDocument<span class="z-variable z-other z-member z-powershell">.LoadHtml</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>html</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>torrents</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Использование XPath для выбора всех элементов &LTtr> (строк таблицы) в документе<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HtmlDocument<span class="z-variable z-other z-member z-powershell">.DocumentNode.SelectNodes</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>//tr<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Для каждой строки таблицы выбираем классы, соответствующие названию раздачи, размеру и ссылке для скачивания.<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>titleNode</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.SelectSingleNode</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.//td[@class='torrent-title']<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sizeNode</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.SelectSingleNode</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.//td[@class='torrent-sp']<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadLinkNode</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.SelectSingleNode</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.//td[@class='torrent-d-btn']/a<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Проверяем, что все классы найдены<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>titleNode</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span> <span class="z-keyword z-operator z-logical z-powershell">-and</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sizeNode</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span> <span class="z-keyword z-operator z-logical z-powershell">-and</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadLinkNode</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Извлечение текста из классов<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>title</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>titleNode<span class="z-variable z-other z-member z-powershell">.InnerText.Trim</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>size</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sizeNode<span class="z-variable z-other z-member z-powershell">.InnerText.Trim</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadLink</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadLinkNode<span class="z-variable z-other z-member z-powershell">.Attributes</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>href<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.Value
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>torrent</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> PSObject <span class="z-keyword z-operator z-assignment z-powershell">-</span>Property <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Title</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>title</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Size</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>size</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">DownloadLink</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadLink</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>torrents</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>torrent</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>$torrents</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell">Title                                                                    Size     DownloadLink
</span><span class="z-source z-powershell"><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>                                                                    <span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>     <span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">6</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">3</span> серии из <span class="z-constant z-numeric z-integer z-powershell">13</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2024</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEBRip <span class="z-keyword z-operator z-other z-powershell">|</span> RuDub              <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">55</span> ГБ  http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">449613</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-6</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">13</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2024</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>webrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>rudub<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">5</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span> серии из <span class="z-constant z-numeric z-integer z-powershell">22</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2023</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEBRip 1080p <span class="z-keyword z-operator z-other z-powershell">|</span> RuDub       <span class="z-constant z-numeric z-integer z-powershell">54</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">15</span> ГБ http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">433749</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-5</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2023</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>webrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>1080p<span class="z-keyword z-operator z-assignment z-powershell">-</span>rudub<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">5</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span> серии из <span class="z-constant z-numeric z-integer z-powershell">22</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2023</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEBRip 720p <span class="z-keyword z-operator z-other z-powershell">|</span> RuDub        <span class="z-constant z-numeric z-integer z-powershell">30</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">14</span> ГБ http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">433750</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-5</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2023</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>webrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>720p<span class="z-keyword z-operator z-assignment z-powershell">-</span>rudub<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">5</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span> серии из <span class="z-constant z-numeric z-integer z-powershell">22</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2023</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEBRip <span class="z-keyword z-operator z-other z-powershell">|</span> RuDub             <span class="z-constant z-numeric z-integer z-powershell">11</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">55</span> ГБ http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">433751</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-5</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2023</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>webrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>rudub<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">4</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span> серии из <span class="z-constant z-numeric z-integer z-powershell">22</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2021</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEB<span class="z-keyword z-operator z-assignment z-powershell">-</span>DL 720p <span class="z-keyword z-operator z-other z-powershell">|</span> RG.Paravozik <span class="z-constant z-numeric z-integer z-powershell">21.33</span> Gb http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">418618</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-4</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2021</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>web<span class="z-keyword z-operator z-assignment z-powershell">-</span>dl<span class="z-keyword z-operator z-assignment z-powershell">-</span>720p<span class="z-keyword z-operator z-assignment z-powershell">-</span>rgparavozik<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Полицейский с половиной: Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2017</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEB<span class="z-keyword z-operator z-assignment z-powershell">-</span>DLRip 720p<span class="z-keyword z-operator z-other z-powershell">|</span> Чистый звук   <span class="z-constant z-numeric z-integer z-powershell">3.41</span> Gb  http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">254846</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-2017</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>web<span class="z-keyword z-operator z-assignment z-powershell">-</span>dlrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>720p<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Полицейский с половиной: Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2017</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEB<span class="z-keyword z-operator z-assignment z-powershell">-</span>DLRip <span class="z-keyword z-operator z-other z-powershell">|</span> Чистый звук       <span class="z-constant z-numeric z-integer z-powershell">1.37</span> Gb  http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">254845</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-2017</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>web<span class="z-keyword z-operator z-assignment z-powershell">-</span>dlrip<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span> серии из <span class="z-constant z-numeric z-integer z-powershell">20</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2019</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEBRip <span class="z-keyword z-operator z-other z-powershell">|</span> BaibaKo           <span class="z-constant z-numeric z-integer z-powershell">11.28</span> Gb http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">364669</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-2</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2019</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>webrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>baibako<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span> серии из <span class="z-constant z-numeric z-integer z-powershell">20</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2019</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEBRip 1080p <span class="z-keyword z-operator z-other z-powershell">|</span> Octopus     <span class="z-constant z-numeric z-integer z-powershell">45.97</span> Gb http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">364161</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-2</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2019</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>webrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>1080p<span class="z-keyword z-operator z-assignment z-powershell">-</span>octopus<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span> серии из <span class="z-constant z-numeric z-integer z-powershell">20</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2019</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEB<span class="z-keyword z-operator z-assignment z-powershell">-</span>DLRip <span class="z-keyword z-operator z-other z-powershell">|</span> LostFilm       <span class="z-constant z-numeric z-integer z-powershell">11.95</span> Gb http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">364668</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-2</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2019</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>web<span class="z-keyword z-operator z-assignment z-powershell">-</span>dlrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>lostfilm<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span></code></pre> <h2 id=keepass><a aria-label="Anchor link for: keepass" class=zola-anchor href=#keepass><i class=icon></i></a> KeePass</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Определяем переменные до исполняемого файла, базы и пароль<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>KeePassExecPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Program Files\KeePass Password Safe 2\KeePass.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>basePath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\KeePass\base.kdbx<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>basePass</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>12345<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Загружаем сборку<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Reflection.Assembly</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::LoadFrom<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>KeePassExecPath</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-Null</span>
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">KeePass.Program</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::CommonInitialize<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Открываем базу<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IOConnectionInfo</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">KeePassLib.Serialization.IOConnectionInfo</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromPath<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>basePath</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CompositeKey</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> KeePassLib.Keys.CompositeKey
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>KcpPassword</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> KeePassLib.Keys.KcpPassword <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>basePass</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CompositeKey<span class="z-variable z-other z-member z-powershell">.AddUserKey</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>KcpPassword</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PwDatabase</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> KeePassLib.PwDatabase
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PwDatabase<span class="z-variable z-other z-member z-powershell">.Open</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IOConnectionInfo</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CompositeKey</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Поиск в базе по частичному совпадению (фильтрация)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SearchParameters</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> KeePassLib.SearchParameters
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SearchParameters<span class="z-variable z-other z-member z-powershell">.SearchString</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>test<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PwObjectList</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> KeePassLib.Collections.PwObjectList<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">KeePassLib.PwEntry</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PwDatabase<span class="z-variable z-other z-member z-powershell">.RootGroup.SearchEntries</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SearchParameters</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PwObjectList</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ucount</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PwObjectList<span class="z-variable z-other z-member z-powershell">.UCount</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ucount</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ucount</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PwObjectList<span class="z-variable z-other z-member z-powershell">.GetAt</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Strings.ReadSafe<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">KeePassLib.PwDefs</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::UserNameField</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Получаем список групп<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Groups</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PwDatabase<span class="z-variable z-other z-member z-powershell">.RootGroup.Groups</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>groupCollections</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Object</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Проходим по группам<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Group</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Groups</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>entryCollections</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Object</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Проходим по записям группы и добавляем во временную коллекцию<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>entry</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Group<span class="z-variable z-other z-member z-powershell">.Entries</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>entryCollections<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Title</span>    <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>entry<span class="z-variable z-other z-member z-powershell">.Strings.Get</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Title<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ReadString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Login</span>    <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>entry<span class="z-variable z-other z-member z-powershell">.Strings.Get</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>UserName<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ReadString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Password</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>entry<span class="z-variable z-other z-member z-powershell">.Strings.Get</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Password<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ReadString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>entry<span class="z-variable z-other z-member z-powershell">.Strings.Get</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>URL<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ReadString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Description</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>entry<span class="z-variable z-other z-member z-powershell">.Strings.Get</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Notes<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ReadString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Добавляем запись в основную коллекцию групп (название группы используется как ключ)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>groupCollections</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> ($Group.Name) = $entryCollections<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">		<span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Group</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Group<span class="z-variable z-other z-member z-powershell">.Name</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">		<span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Modification</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Group<span class="z-variable z-other z-member z-powershell">.LastAccessTime.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Entries</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>entryCollections</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Преобразуем структуру в JSON<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>jsonData</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>groupCollections</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Depth <span class="z-constant z-numeric z-integer z-powershell">3</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>jsonData</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Закрываем базу<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PwDatabase<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h2 id=sqlite><a aria-label="Anchor link for: sqlite" class=zola-anchor href=#sqlite><i class=icon></i></a> SQLite</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\Get-Service.db<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Module</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Module</span> MySQLite
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Module</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Install-Module</span> MySQLite <span class="z-keyword z-operator z-assignment z-powershell">-</span>Repository PSGallery <span class="z-keyword z-operator z-assignment z-powershell">-</span>Scope CurrentUser
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-Module</span> MySQLite
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-MySQLiteDB</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> создать БД<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-MySQLiteQuery</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Query <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>CREATE TABLE Service (Name TEXT NOT NULL, DisplayName TEXT NOT NULL, Status TEXT NOT NULL);<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> создать таблицу<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Service</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Service</span> <span class="z-keyword z-operator z-other z-powershell">|</span> select Name<span class="z-keyword z-operator z-other z-powershell">,</span>DisplayName<span class="z-keyword z-operator z-other z-powershell">,</span>Status
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>S</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Service</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>S<span class="z-variable z-other z-member z-powershell">.Name</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DName</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>S<span class="z-variable z-other z-member z-powershell">.DisplayName</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>S<span class="z-variable z-other z-member z-powershell">.Status</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Invoke-MySQLiteQuery</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Query <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>INSERT INTO Service (Name, DisplayName, Status) VALUES ('<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Name</span>', '<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DName</span>', '<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Status</span>');<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>(Get-MySQLiteDB $path).Tables</code> список таблиц в базе <br> <code>Invoke-MySQLiteQuery -Path $path -Query "SELECT name FROM sqlite_master WHERE type='table';"</code> список таблиц в базе <br> <code>Invoke-MySQLiteQuery -Path $path -Query "DROP TABLE Service;"</code> удалить таблицу</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TableName</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Service<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-MySQLiteQuery</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Query <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>SELECT * FROM <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TableName</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> прочитать содержимое таблицы (в формате объекта)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <p><code>Get-Service | select  Name,DisplayName,Status | ConvertTo-MySQLiteDB -Path $path -TableName Service -force</code> конвертировать объект в таблицу</p> <h3 id=database-password><a aria-label="Anchor link for: database-password" class=zola-anchor href=#database-password><i class=icon></i></a> Database password</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Connection</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-SQLiteConnection</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>DataSource <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Connection<span class="z-variable z-other z-member z-powershell">.ChangePassword</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>password<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Connection<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-SqliteQuery</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Query <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>SELECT * FROM Service<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>DataSource <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>;Password=password<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre> <h2 id=mysql><a aria-label="Anchor link for: mysql" class=zola-anchor href=#mysql><i class=icon></i></a> MySQL</h2> <p><code>apt -y install mysql-server mysql-client</code> <br> <code>mysql -V</code> <br> <code>systemctl status mysql</code> <br> <code>mysqladmin -u root password</code> задать пароль root</p> <p><code>nano /etc/mysql/mysql.conf.d/mysqld.cnf</code></p> <pre class=z-code><code><span class="z-text z-plain">[mysqld]
</span><span class="z-text z-plain">user                    = mysql
</span><span class="z-text z-plain"># pid-file              = /var/run/mysqld/mysqld.pid
</span><span class="z-text z-plain"># socket                = /var/run/mysqld/mysqld.sock
</span><span class="z-text z-plain"># port                  = 3306
</span><span class="z-text z-plain"># datadir               = /var/lib/mysql
</span><span class="z-text z-plain"># tmpdir                = /tmp
</span><span class="z-text z-plain">bind-address            = 0.0.0.0
</span><span class="z-text z-plain">mysqlx-bind-address     = 0.0.0.0
</span><span class="z-text z-plain">log_error = /var/log/mysql/error.log
</span></code></pre> <p><code>systemctl restart mysql</code> <br> <code>ss -tulnp | grep 3306</code> <br> <code>ufw allow 3306/tcp</code> <br> <code>nc -zv 192.168.1.253 3306</code> <br> <code>tnc 192.168.1.253 -p 3306</code></p> <p><code>mysql -u root -p</code> <br> <code>SELECT user(), now(), version();</code> <br> <code>quit;</code></p> <p><code>mysql -u root -p -e 'SHOW TABLES FROM db_aduser;'</code> отобразить список таблиц без подключения к консоли MySQL</p> <p><code>CREATE</code> создать БД, пользователя, таблицу <br> <code>ALTER</code> управление столбцами таблице <br> <code>DROP</code> удалить БД, пользователя, таблицу <br> <code>USE</code> выбрать БД <br> <code>SHOW</code> вывесли список БД, прав доступа пользователя (GRANTS), названия столбцов и их свойства <br> <code>GRANT</code> дать доступ пользователю к БД <br> <code>REVOKE</code> удалить доступ пользователя к БД <br> <code>UPDATE</code> изменить права доступа, значения с таблице <br> <code>FLUSH</code> обновить права доступа <br> <code>SELECT</code> отобразить выбранную БД, вывести список пользователей, выборка данных в таблице <br> <code>INSERT</code> внести данные <br> <code>DELETE</code> удалить данные в (FROM) таблице</p> <h3 id=data-type><a aria-label="Anchor link for: data-type" class=zola-anchor href=#data-type><i class=icon></i></a> DATA TYPE</h3> <p><code>VARCHAR(N)</code> строка переменной длины, в формате ASCII, где один символ занимает 1 байт, числом N указывается максимальная возможная длина строки <br> <code>NVARCHAR(N)</code> строка переменной длины, в формате Unicode, где один символ занимает 2 байта <br> <code>CHAR(N)/nchar(N)</code> строка фиксированной длины, которая всегда дополняется справа пробелами до длины N и в базе данных она занимает ровно N символов <br> <code>INT</code> целое число, от -2147483648 до 2147483647, занимает 4 байта <br> <code>FLOAT</code> число, в котором может присутствовать десятичная точка (запятая) <br> <code>BIT</code> флаг, Да - 1 или Нет - 0 <br> <code>DATE</code> формат даты, например 25.05.2023 <br> <code>TIME</code> 23:30:55.1234567 <br> <code>DATETIME</code> 25.05.2023 23:30:55.1234567</p> <h3 id=database-1><a aria-label="Anchor link for: database-1" class=zola-anchor href=#database-1><i class=icon></i></a> DATABASE</h3> <pre class=z-code><code><span class="z-text z-plain">SHOW databases;                                                                     # вывести список БД
</span><span class="z-text z-plain">CREATE DATABASE db_aduser;                                                          # создать БД
</span><span class="z-text z-plain">CREATE DATABASE db_rep DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;  # создать БД с кодировкой UTF-8
</span><span class="z-text z-plain">DROP DATABASE db_rep;                                                               # удалить БД
</span><span class="z-text z-plain">USE db_aduser;                                                                      # выбрать/переключиться на выбранную БД
</span><span class="z-text z-plain">SELECT database();                                                                  # отобразить выбранную БД
</span></code></pre> <h3 id=user><a aria-label="Anchor link for: user" class=zola-anchor href=#user><i class=icon></i></a> USER</h3> <pre class=z-code><code><span class="z-text z-plain">SELECT USER,HOST FROM mysql.user;                                     # вывести список УЗ
</span><span class="z-text z-plain">CREATE USER posh@localhost IDENTIFIED BY '1qaz!QAZ';                  # создать УЗ, которая будет подключаться с локального сервера
</span><span class="z-text z-plain">CREATE USER posh@localhost IDENTIFIED BY '1qaz!QAZ';                  # создать УЗ, которая будет подключаться с указанного сервера
</span><span class="z-text z-plain">CREATE USER posh@'192.168.3.99' IDENTIFIED BY '1qaz!QAZ';             # УЗ для доступа с конкретного сервера
</span><span class="z-text z-plain">CREATE USER 'admin'@'%' IDENTIFIED BY 'Admin12#';                     # УЗ для доступа с любого сервера (% - wildcard)
</span><span class="z-text z-plain">DROP USER posh@localhost;                                             # удалить пользователя
</span><span class="z-text z-plain">SHOW GRANTS FOR posh@'%';                                             # отобразить права доступа пользователя
</span><span class="z-text z-plain">GRANT ALL PRIVILEGES ON db_aduser.* TO posh@'192.168.3.99';           # полный доступ для posh к БД db_aduser
</span><span class="z-text z-plain">GRANT ALL PRIVILEGES ON *.* TO posh@'%';                              # доступ к всем БД c любого клиентского хоста
</span><span class="z-text z-plain">GRANT SELECT,DELETE ON mysql.* TO posh@'%';                           # права SELECT и DELETE на встроенную БД mysql
</span><span class="z-text z-plain">REVOKE DELETE ON mysql.* FROM posh@'%';                               # удалить доступ DELETE
</span><span class="z-text z-plain">UPDATE mysql.user SET super_priv='Y' WHERE USER='posh' AND host='%';  # изменить привелегии для пользователя
</span><span class="z-text z-plain">SELECT USER,HOST,super_priv FROM mysql.user;                          # список УЗ и таблица с правами SUPER privilege
</span><span class="z-text z-plain">FLUSH PRIVILEGES;                                                     # обновить права доступа
</span></code></pre> <h3 id=table><a aria-label="Anchor link for: table" class=zola-anchor href=#table><i class=icon></i></a> TABLE</h3> <pre class=z-code><code><span class="z-text z-plain">SHOW TABLES;               # отобразить список всех таблиц
</span><span class="z-text z-plain">SHOW TABLES LIKE '%user';  # поиск таблицы по wildcard-имени
</span><span class="z-text z-plain">CREATE TABLE table_aduser (id INT NOT NULL AUTO_INCREMENT, Name VARCHAR(100), email VARCHAR(100), PRIMARY KEY (ID));  # создать таблицу
</span><span class="z-text z-plain">DROP TABLE table_aduser;   # удалить таблицу
</span></code></pre> <h3 id=column><a aria-label="Anchor link for: column" class=zola-anchor href=#column><i class=icon></i></a> COLUMN</h3> <pre class=z-code><code><span class="z-text z-plain">SHOW COLUMNS FROM table_aduser;                                                         # отобразить название стобцов и их свойства
</span><span class="z-text z-plain">ALTER TABLE table_aduser DROP COLUMN id;                                                # удалить столбец id
</span><span class="z-text z-plain">ALTER TABLE table_aduser ADD COLUMN info VARCHAR(10);                                   # добавить столбец info
</span><span class="z-text z-plain">ALTER TABLE table_aduser CHANGE info new_info VARCHAR(100);                             # изменить имя столбца info на new_info и его тип данных
</span><span class="z-text z-plain">ALTER TABLE table_aduser ADD COLUMN (id INT NOT NULL AUTO_INCREMENT, PRIMARY KEY (ID)); # добавить столбец id
</span></code></pre> <h3 id=insert><a aria-label="Anchor link for: insert" class=zola-anchor href=#insert><i class=icon></i></a> INSERT</h3> <pre class=z-code><code><span class="z-text z-plain">INSERT table_aduser (Name,email) VALUES ('Alex','no-email');
</span><span class="z-text z-plain">INSERT table_aduser (Name,email) VALUES ('Alex','no-email');
</span><span class="z-text z-plain">INSERT table_aduser (Name) VALUES ('Support');
</span><span class="z-text z-plain">INSERT table_aduser (Name) VALUES ('Jack');
</span></code></pre> <h3 id=select><a aria-label="Anchor link for: select" class=zola-anchor href=#select><i class=icon></i></a> SELECT</h3> <pre class=z-code><code><span class="z-text z-plain">SELECT * FROM table_aduser;                     # содержимое всех стобцов в выбранной (FROM) таблице
</span><span class="z-text z-plain">SELECT Name,email FROM table_aduser;            # содержимое указанных стобцов
</span><span class="z-text z-plain">SELECT DISTINCT Name,Email FROM table_aduser;   # отобразить уникальные записи (без повторений)
</span><span class="z-text z-plain">SELECT * FROM table_aduser ORDER BY Name;       # отсортировать по Name
</span><span class="z-text z-plain">SELECT * FROM table_aduser ORDER BY Name DESC;  # обратная сортировка
</span><span class="z-text z-plain">SELECT COUNT(*) FROM table_aduser;              # количество строк в таблице
</span><span class="z-text z-plain">SELECT COUNT(new_info) FROM table_aduser;       # количество строк в столбце
</span></code></pre> <h3 id=where><a aria-label="Anchor link for: where" class=zola-anchor href=#where><i class=icon></i></a> WHERE</h3> <pre class=z-code><code><span class="z-text z-plain">NOT; AND; OR                                                  # по приоритетам условий
</span><span class="z-text z-plain">SELECT * FROM table_aduser WHERE Name = 'Alex';               # поиск по содержимому
</span><span class="z-text z-plain">SELECT * FROM table_aduser WHERE NOT Name != 'Alex';          # условие NOT где Name не равен значению
</span><span class="z-text z-plain">SELECT * FROM table_aduser WHERE email != '';                 # вывести строки, где содержимое email не рано null
</span><span class="z-text z-plain">SELECT * FROM table_aduser WHERE email != '' OR id > 1000;    # или id выше 1000
</span><span class="z-text z-plain">SELECT * FROM table_aduser WHERE Name RLIKE "support";        # регистронезависемый (RLIKE) поиск
</span><span class="z-text z-plain">SELECT * FROM table_aduser WHERE Name RLIKE "^support";       # начинаются только с этого словосочетания
</span></code></pre> <h3 id=delete><a aria-label="Anchor link for: delete" class=zola-anchor href=#delete><i class=icon></i></a> DELETE</h3> <pre class=z-code><code><span class="z-text z-plain">SELECT * FROM table_aduser WHERE Name RLIKE "alex";   # найти и проверить значения перед удалением
</span><span class="z-text z-plain">DELETE FROM table_aduser WHERE Name RLIKE "alex";     # Query OK, 2 rows affected # удалено две строки
</span><span class="z-text z-plain">DELETE FROM table_aduser;                             # удалить ВСЕ значения
</span></code></pre> <h3 id=update><a aria-label="Anchor link for: update" class=zola-anchor href=#update><i class=icon></i></a> UPDATE</h3> <pre class=z-code><code><span class="z-text z-plain">SELECT * FROM table_aduser WHERE Name = 'Jack';             # найти и проверить значение перед изменением
</span><span class="z-text z-plain">UPDATE table_aduser SET Name = 'Alex' WHERE Name = 'Jack';  # изменить значение 'Jack' на 'Alex'
</span><span class="z-text z-plain">UPDATE db_aduser.table_aduser SET Name='BCA' WHERE id=1;    # изменить значение в строке с ID 1
</span></code></pre> <h3 id=check><a aria-label="Anchor link for: check" class=zola-anchor href=#check><i class=icon></i></a> CHECK</h3> <pre class=z-code><code><span class="z-text z-plain">CHECK TABLE db_aduser.table_aduser;     # проверить
</span><span class="z-text z-plain">ANALYZE TABLE db_aduser.table_aduser;   # анализировать
</span><span class="z-text z-plain">OPTIMIZE TABLE db_aduser.table_aduser;  # оптимизировать
</span><span class="z-text z-plain">REPAIR TABLE db_aduser.table_aduser;    # восстановить
</span><span class="z-text z-plain">TRUNCATE TABLE db_aduser.table_aduser;  # очистить
</span></code></pre> <h3 id=dump><a aria-label="Anchor link for: dump" class=zola-anchor href=#dump><i class=icon></i></a> DUMP</h3> <pre class=z-code><code><span class="z-text z-plain">mysqldump -u root -p --databases db_aduser > /bak/db_aduser.sql
</span><span class="z-text z-plain">mysql -u root -p db_aduser < /bak/db_aduser.sql
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">crontab -e
</span><span class="z-text z-plain">00 22 * * * /usr/bin/mysqldump -uroot -p1qaz!QAZ db_zabbix | /bin/bzip2 > `date +/dump/zabbix/zabbix-\%d-\%m-\%Y-\%H:\%M.bz2`
</span><span class="z-text z-plain">00 23 * * * /usr/bin/mysqldump -uroot -p1qaz!QAZ db_zabbix > `date +/dump/smb/zabbix-\%d-\%m-\%Y-\%H:\%M.sql`
</span><span class="z-text z-plain">0 0 * * * find /dump/zabbix -mtime +7 -exec rm {} \;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">mysqldump -u root --single-transaction db_zabbix > /dump/zabbix/db_zabbix.sql
</span><span class="z-text z-plain">mysql -u user_zabbix -p -e 'CREATE DATABASE db_zabbix;'
</span><span class="z-text z-plain">mysql -u user_zabbix -p db_zabbix < /root/db_zabbix.sql
</span></code></pre> <h3 id=innodb-force-recovery><a aria-label="Anchor link for: innodb-force-recovery" class=zola-anchor href=#innodb-force-recovery><i class=icon></i></a> innodb_force_recovery</h3> <pre class=z-code><code><span class="z-text z-plain">sed -i '/innodb_force_recovery/d' /etc/mysql/my.cnf # удалить
</span><span class="z-text z-plain">mode=6; sed -i "/^\[mysqld\]/{N;s/$/\ninnodb_force_recovery=$mode/}" /etc/mysql/my.cnf # добавить mode 6
</span><span class="z-text z-plain">systemctl restart mysql
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">[mysqld]
</span><span class="z-text z-plain">innodb_force_recovery=1 # сервер пытается начать работу независимо от того, есть ли поврежденные данные InnoDB или нет
</span><span class="z-text z-plain">innodb_force_recovery=2 # удается восстановить работу за счет остановки потока команд, которые были частично выполнены или не выполнены (не запускает фоновые операции)
</span><span class="z-text z-plain">innodb_force_recovery=3 # отменяет откат после восстановления поврежденных файлов (не пытается откатить транзакции)
</span><span class="z-text z-plain">innodb_force_recovery=6 # запуск СУБД в режиме read only
</span></code></pre> <h3 id=mysql-connector-net><a aria-label="Anchor link for: mysql-connector-net" class=zola-anchor href=#mysql-connector-net><i class=icon></i></a> MySQL Connector NET</h3> <h3 id=add-aduser><a aria-label="Anchor link for: add-aduser" class=zola-anchor href=#add-aduser><i class=icon></i></a> Add-ADUser</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.1.253<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>posh<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pass</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>1qaz!QAZ<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>db</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>db_aduser<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> –Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\MySQL-Connector-NET\8.0.31-4.8\MySql.Data.dll<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Connection</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">MySql.Data.MySqlClient.MySqlConnection</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ConnectionString</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>server=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span>;uid=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user</span>;pwd=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pass</span>;database=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>db</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Connection<span class="z-variable z-other z-member z-powershell">.Open</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Command</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> MySql.Data.MySqlClient.MySqlCommand
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Command<span class="z-variable z-other z-member z-powershell">.Connection</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Connection</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UserList</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-ADUser</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>filter <span class="z-keyword z-operator z-assignment z-powershell">*</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>properties name<span class="z-keyword z-operator z-other z-powershell">,</span>EmailAddress
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UserList</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>uname</span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user<span class="z-variable z-other z-member z-powershell">.Name</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>uemail</span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user<span class="z-variable z-other z-member z-powershell">.EmailAddress</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Command<span class="z-variable z-other z-member z-powershell">.CommandText</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>INSERT INTO table_aduser (Name,Email) VALUES ('<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>uname</span>','<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>uemail</span>')<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Command<span class="z-variable z-other z-member z-powershell">.ExecuteNonQuery</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Connection<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=get-aduser><a aria-label="Anchor link for: get-aduser" class=zola-anchor href=#get-aduser><i class=icon></i></a> Get-ADUser</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.1.253<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>posh<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pass</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>1qaz!QAZ<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>db</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>db_aduser<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> –Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\MySQL-Connector-NET\8.0.31-4.8\MySql.Data.dll<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Connection</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">MySql.Data.MySqlClient.MySqlConnection</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ConnectionString</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>server=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span>;uid=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user</span>;pwd=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pass</span>;database=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>db</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Connection<span class="z-variable z-other z-member z-powershell">.Open</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Command</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> MySql.Data.MySqlClient.MySqlCommand
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Command<span class="z-variable z-other z-member z-powershell">.Connection</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Connection</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MYSQLDataAdapter</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> MySql.Data.MySqlClient.MySqlDataAdapter
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MYSQLDataSet</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.DataSet
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Command<span class="z-variable z-other z-member z-powershell">.CommandText</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>SELECT * FROM table_aduser<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MYSQLDataAdapter<span class="z-variable z-other z-member z-powershell">.SelectCommand</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Command</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NumberOfDataSets</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MYSQLDataAdapter<span class="z-variable z-other z-member z-powershell">.Fill</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MYSQLDataSet</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>data<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Object</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataSet</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MYSQLDataSet<span class="z-variable z-other z-member z-powershell">.tables</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataSet<span class="z-variable z-other z-member z-powershell">.name</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Mail</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataSet<span class="z-variable z-other z-member z-powershell">.email</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Connection<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span>
</span></code></pre> <h2 id=mssql><a aria-label="Anchor link for: mssql" class=zola-anchor href=#mssql><i class=icon></i></a> MSSQL</h2> <p><code>wget -qO- https://packages.microsoft.com/keys/microsoft.asc | apt-key add -</code> импортировать GPG-ключ для репозитория <br> <code>https://packages.microsoft.com/config/ubuntu/</code> выбрать репозиторий и скопировать URL <br> <code>add-apt-repository "$(wget -qO- https://packages.microsoft.com/config/ubuntu/20.04/mssql-server-2019.list)"</code> <br> <code>apt-get update</code> обновить список пакетов <br> <code>apt-get install mssql-server</code> <br> <code>/opt/mssql/bin/mssql-conf setup</code> скрипт начальной конфигурации (выбрать редакцию, 3 - express и русский язык 9 из 11) <br> <code>systemctl status mssql-server</code> <br> <code>curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -</code> установить клиент <br> <code>curl https://packages.microsoft.com/config/ubuntu/20.04/prod.list | tee /etc/apt/sources.list.d/msprod.list</code> <br> <code>apt-get update</code> <br> <code>apt-get install mssql-tools</code> <br> <code>echo 'export PATH="$PATH:/opt/mssql-tools/bin"' >> ~/.bashrc</code> добавить в домашний каталог файла bashrc, что бы не писать путь к исполняемому файлу <br> <code>export PATH="$PATH:/opt/mssql-tools/bin"</code> <br> <code>iptables -I INPUT 1 -p tcp --dport 1433 -j ACCEPT</code></p> <pre class=z-code><code><span class="z-text z-plain">sqlcmd -S localhost -U SA
</span><span class="z-text z-plain">CREATE DATABASE itinvent
</span><span class="z-text z-plain">go
</span><span class="z-text z-plain">SELECT name FROM master.dbo.sysdatabases
</span><span class="z-text z-plain">go
</span></code></pre> <h3 id=system-data-sqlclient><a aria-label="Anchor link for: system-data-sqlclient" class=zola-anchor href=#system-data-sqlclient><i class=icon></i></a> System.Data.SqlClient</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>itinvent<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pass</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>itinvent<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>db</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>itinvent<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.103<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlConnection</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.SqlClient.SqlConnection
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlConnection<span class="z-variable z-other z-member z-powershell">.ConnectionString</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>server=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span>;database=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>db</span>;user id=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user</span>;password=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pass</span>;Integrated Security=false<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlCommand</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.SqlClient.SqlCommand<span class="z-keyword z-operator z-other z-powershell">`</span> класс формата команды
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlCommand<span class="z-variable z-other z-member z-powershell">.CommandText</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>SELECT * FROM ITINVENT.dbo.USERS<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> отобразить содержимое таблицы
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>$SqlCommand.CommandText = "SELECT LICENCE_DATE,DESCR,MODEL_NO,TYPE_NO FROM ITINVENT.dbo.ITEMS where LICENCE_DATE IS NOT NULL"<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlCommand<span class="z-variable z-other z-member z-powershell">.Connection</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlConnection</span><span class="z-keyword z-operator z-other z-powershell">`</span> передать формат подключения
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlAdapter</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.SqlClient.SqlDataAdapter<span class="z-keyword z-operator z-other z-powershell">`</span> создать адаптер подключения для выполнения SELECT запросов к БД
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlAdapter<span class="z-variable z-other z-member z-powershell">.SelectCommand</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlCommand</span><span class="z-keyword z-operator z-other z-powershell">`</span> передать команду
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataSet</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.DataSet<span class="z-keyword z-operator z-other z-powershell">`</span> создать объект приема данных формата XML
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlAdapter<span class="z-variable z-other z-member z-powershell">.Fill</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataSet</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> заполнить данными полученные от адаптера <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">возвращает кол<span class="z-keyword z-operator z-assignment z-powershell">-</span>во объектов</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlConnection<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataSet<span class="z-variable z-other z-member z-powershell">.Tables</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Data</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-other z-powershell">|</span> ft
</span></code></pre> <h3 id=sqlclient-insert><a aria-label="Anchor link for: sqlclient-insert" class=zola-anchor href=#sqlclient-insert><i class=icon></i></a> SqlClient INSERT</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>itinvent<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pass</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>itinvent<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>db</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>db_test<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.103<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sql</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>INSERT INTO table_test (column_user) VALUES ('lifailon')<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> добавить данные в таблицу table_test в колонку column_user
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlConnection</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.SqlClient.SqlConnection
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlConnection<span class="z-variable z-other z-member z-powershell">.ConnectionString</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>server=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span>;database=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>db</span>;user id=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>user</span>;password=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pass</span>;Integrated Security=false<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlCommand</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.SqlClient.SqlCommand
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlCommand<span class="z-variable z-other z-member z-powershell">.CommandText</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sql</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlCommand<span class="z-variable z-other z-member z-powershell">.Connection</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlConnection</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlConnection<span class="z-variable z-other z-member z-powershell">.Open</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rowsAffected</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlCommand<span class="z-variable z-other z-member z-powershell">.ExecuteNonQuery</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span><span class="z-keyword z-operator z-other z-powershell">`</span> для запросов INSERT<span class="z-keyword z-operator z-assignment z-powershell">/</span>UPDATE<span class="z-keyword z-operator z-assignment z-powershell">/</span>DELETE не используется SqlDataAdapter
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SqlConnection<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=ssms-insert><a aria-label="Anchor link for: ssms-insert" class=zola-anchor href=#ssms-insert><i class=icon></i></a> SSMS INSERT</h3> <pre class=z-code><code><span class="z-text z-plain">USE [db_test]
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">INSERT INTO [dbo].[table_test]
</span><span class="z-text z-plain">           ([column_user])
</span><span class="z-text z-plain">     VALUES
</span><span class="z-text z-plain">           ('lifailon')
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">SELECT TOP (1000) [column_user]
</span><span class="z-text z-plain">FROM [db_test].[dbo].[table_test]
</span></code></pre> <h3 id=t-sql><a aria-label="Anchor link for: t-sql" class=zola-anchor href=#t-sql><i class=icon></i></a> T-SQL</h3> <ul><li><p>DDL (Data Definition Language / Язык определения данных). К этому типу относятся команды, которые создают базу данных, таблицы, индексы, хранимые процедуры. <br> <code>CREATE</code> создает объекты базы данных (саму базу даных, таблицы, индексы и т.д.) <br> <code>ALTER</code> изменяет объекты базы данных <br> <code>DROP</code> удаляет объекты базы данных <br> <code>TRUNCATE</code> удаляет все данные из таблиц</p><li><p>DML (Data Manipulation Language / Язык манипуляции данными). К этому типу относят команды по выбору, обновлению, добавлению и удалению данных. <br> <code>SELECT</code> извлекает данные из БД <br> <code>UPDATE</code> обновляет данные <br> <code>INSERT</code> добавляет новые данные <br> <code>DELETE</code> удаляет данные</p><li><p>DCL (Data Control Language / Язык управления доступа к данным). К этому типу относят команды, которые управляют правами по доступу к данным. <br> <code>GRANT</code> предоставляет права для доступа к данным <br> <code>REVOKE</code> отзывает права на доступ к данным</p></ul> <pre class=z-code><code><span class="z-text z-plain">-- Переменные
</span><span class="z-text z-plain">DECLARE @text NVARCHAR(20), @int INT;
</span><span class="z-text z-plain">SET @text='Test';
</span><span class="z-text z-plain">SET @int = 21;
</span><span class="z-text z-plain">select @text,@int
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Имена сервера и экземпляра 
</span><span class="z-text z-plain">Select @@SERVERNAME as [Server\Instance]; 
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- версия SQL Server 
</span><span class="z-text z-plain">Select @@VERSION as SQLServerVersion; 
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Текущая БД (БД, в контексте которой выполняется запрос)
</span><span class="z-text z-plain">Select DB_NAME() AS CurrentDB_Name;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Время работы с момента запуска сервера
</span><span class="z-text z-plain">SELECT  @@Servername AS ServerName ,
</span><span class="z-text z-plain">        create_date AS  ServerStarted ,
</span><span class="z-text z-plain">        DATEDIFF(s, create_date, GETDATE()) / 86400.0 AS DaysRunning ,
</span><span class="z-text z-plain">        DATEDIFF(s, create_date, GETDATE()) AS SecondsRunnig
</span><span class="z-text z-plain">FROM    sys.databases
</span><span class="z-text z-plain">WHERE   name = 'tempdb';
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Количество активных соединений
</span><span class="z-text z-plain">SELECT  @@Servername AS Server ,
</span><span class="z-text z-plain">        DB_NAME(database_id) AS DatabaseName ,
</span><span class="z-text z-plain">        COUNT(database_id) AS Connections ,
</span><span class="z-text z-plain">        Login_name AS  LoginName ,
</span><span class="z-text z-plain">        MIN(Login_Time) AS Login_Time ,
</span><span class="z-text z-plain">        MIN(COALESCE(last_request_end_time, last_request_start_time))
</span><span class="z-text z-plain">                                                         AS  Last_Batch
</span><span class="z-text z-plain">FROM    sys.dm_exec_sessions
</span><span class="z-text z-plain">WHERE   database_id > 0
</span><span class="z-text z-plain">        AND DB_NAME(database_id) NOT IN ( 'master', 'msdb' )
</span><span class="z-text z-plain">GROUP BY database_id ,
</span><span class="z-text z-plain">         login_name
</span><span class="z-text z-plain">ORDER BY DatabaseName;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Статус Backup
</span><span class="z-text z-plain">SELECT  @@Servername AS ServerName ,
</span><span class="z-text z-plain">        d.Name AS DBName ,
</span><span class="z-text z-plain">        MAX(b.backup_finish_date) AS LastBackupCompleted
</span><span class="z-text z-plain">FROM    sys.databases d
</span><span class="z-text z-plain">        LEFT OUTER JOIN msdb..backupset b
</span><span class="z-text z-plain">                    ON b.database_name = d.name
</span><span class="z-text z-plain">                       AND b.[type] = 'D'
</span><span class="z-text z-plain">GROUP BY d.Name
</span><span class="z-text z-plain">ORDER BY d.Name;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Путь к Backup
</span><span class="z-text z-plain">SELECT  @@Servername AS ServerName ,
</span><span class="z-text z-plain">        d.Name AS DBName ,
</span><span class="z-text z-plain">        b.Backup_finish_date ,
</span><span class="z-text z-plain">        bmf.Physical_Device_name
</span><span class="z-text z-plain">FROM    sys.databases d
</span><span class="z-text z-plain">        INNER JOIN msdb..backupset b ON b.database_name = d.name
</span><span class="z-text z-plain">                                        AND b.[type] = 'D'
</span><span class="z-text z-plain">        INNER JOIN msdb.dbo.backupmediafamily bmf ON b.media_set_id = bmf.media_set_id
</span><span class="z-text z-plain">ORDER BY d.NAME ,
</span><span class="z-text z-plain">        b.Backup_finish_date DESC; 
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Вывести список всех БД, модели восстановления и путь к mdf/ldf
</span><span class="z-text z-plain">EXEC sp_helpdb; 
</span><span class="z-text z-plain">SELECT  @@SERVERNAME AS Server ,
</span><span class="z-text z-plain">        d.name AS DBName ,
</span><span class="z-text z-plain">        create_date ,
</span><span class="z-text z-plain">        recovery_model_Desc AS RecoveryModel ,
</span><span class="z-text z-plain">        m.physical_name AS FileName
</span><span class="z-text z-plain">FROM    sys.databases d
</span><span class="z-text z-plain">        JOIN sys.master_files m ON d.database_id = m.database_id
</span><span class="z-text z-plain">ORDER BY d.name;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Размер БД
</span><span class="z-text z-plain">with fs
</span><span class="z-text z-plain">as
</span><span class="z-text z-plain">(
</span><span class="z-text z-plain">    select database_id, type, size * 8.0 / 1024 size
</span><span class="z-text z-plain">    from sys.master_files
</span><span class="z-text z-plain">)
</span><span class="z-text z-plain">select 
</span><span class="z-text z-plain">    name,
</span><span class="z-text z-plain">    (select sum(size) from fs where type = 0 and fs.database_id = db.database_id) DataFileSizeMB,
</span><span class="z-text z-plain">    (select sum(size) from fs where type = 1 and fs.database_id = db.database_id) LogFileSizeMB
</span><span class="z-text z-plain">from sys.databases 
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Поиск таблицы по маске имени (вывод: названия схемы где распологается объект, тип объекта, дата создания и последней модификации):
</span><span class="z-text z-plain">select [object_id], [schema_id],
</span><span class="z-text z-plain">	   schema_name([schema_id]) as [schema_name], 
</span><span class="z-text z-plain">	   [name], 
</span><span class="z-text z-plain">	   [type], 
</span><span class="z-text z-plain">	   [type_desc], 
</span><span class="z-text z-plain">	   [create_date], 
</span><span class="z-text z-plain">	   [modify_date]
</span><span class="z-text z-plain">from sys.all_objects
</span><span class="z-text z-plain">-- where [name]='INVENT';
</span><span class="z-text z-plain">where [name] like '%INVENT%';
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Кол-во строк в таблицах
</span><span class="z-text z-plain">SELECT  @@ServerName AS Server ,
</span><span class="z-text z-plain">        DB_NAME() AS DBName ,
</span><span class="z-text z-plain">        OBJECT_SCHEMA_NAME(p.object_id) AS SchemaName ,
</span><span class="z-text z-plain">        OBJECT_NAME(p.object_id) AS TableName ,
</span><span class="z-text z-plain">        i.Type_Desc ,
</span><span class="z-text z-plain">        i.Name AS IndexUsedForCounts ,
</span><span class="z-text z-plain">        SUM(p.Rows) AS Rows
</span><span class="z-text z-plain">FROM    sys.partitions p
</span><span class="z-text z-plain">        JOIN sys.indexes i ON i.object_id = p.object_id
</span><span class="z-text z-plain">                              AND i.index_id = p.index_id
</span><span class="z-text z-plain">WHERE   i.type_desc IN ( 'CLUSTERED', 'HEAP' )
</span><span class="z-text z-plain">                             -- This is key (1 index per table) 
</span><span class="z-text z-plain">        AND OBJECT_SCHEMA_NAME(p.object_id) <> 'sys'
</span><span class="z-text z-plain">GROUP BY p.object_id ,
</span><span class="z-text z-plain">        i.type_desc ,
</span><span class="z-text z-plain">        i.Name
</span><span class="z-text z-plain">ORDER BY SchemaName ,
</span><span class="z-text z-plain">        TableName; 
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Найти строковое (nvarchar) значение 2023 по всем таблицам базы данных
</span><span class="z-text z-plain">-- Отображается в какой таблице и столбце хранится значение, а также количество найденных пары таблица-колонка
</span><span class="z-text z-plain">set nocount on
</span><span class="z-text z-plain">declare @name varchar(128), @substr nvarchar(4000), @column varchar(128)
</span><span class="z-text z-plain">set @substr = '%2023%'
</span><span class="z-text z-plain">declare @sql nvarchar(max);
</span><span class="z-text z-plain">create table`rslt 
</span><span class="z-text z-plain">(table_name varchar(128), field_name varchar(128), [value] nvarchar(max))
</span><span class="z-text z-plain">declare s cursor for select table_name as table_name from information_schema.tables where table_type = 'BASE TABLE' order by table_name
</span><span class="z-text z-plain">open s
</span><span class="z-text z-plain">fetch next from s into @name
</span><span class="z-text z-plain">while @@fetch_status = 0
</span><span class="z-text z-plain">begin
</span><span class="z-text z-plain">declare c cursor for 
</span><span class="z-text z-plain">select quotename(column_name) as column_name from information_schema.columns 
</span><span class="z-text z-plain">where data_type in ('text', 'ntext', 'varchar', 'char', 'nvarchar', 'char', 'sysname', 'int', 'tinyint') and table_name  = @name
</span><span class="z-text z-plain">set @name = quotename(@name)
</span><span class="z-text z-plain">open c
</span><span class="z-text z-plain">fetch next from c into @column
</span><span class="z-text z-plain">while @@fetch_status = 0
</span><span class="z-text z-plain">begin
</span><span class="z-text z-plain">--print 'Processing table - ' + @name + ', column - ' + @column
</span><span class="z-text z-plain">set @sql='insert into`rslt select ''' + @name + ''' as Table_name, ''' + @column + ''', cast(' + @column + 
</span><span class="z-text z-plain">' as nvarchar(max)) from' + @name + ' where cast(' + @column + ' as nvarchar(max)) like ''' + @substr + '''';
</span><span class="z-text z-plain">print @sql;
</span><span class="z-text z-plain">exec(@sql);
</span><span class="z-text z-plain">fetch next from c into @column;
</span><span class="z-text z-plain">end
</span><span class="z-text z-plain">close c
</span><span class="z-text z-plain">deallocate c
</span><span class="z-text z-plain">fetch next from s into @name
</span><span class="z-text z-plain">end
</span><span class="z-text z-plain">select table_name as [Table Name], field_name as [Field Name], count(*) as [Found Mathes] from`rslt
</span><span class="z-text z-plain">group by table_name, field_name
</span><span class="z-text z-plain">order by table_name, field_name
</span><span class="z-text z-plain">drop table`rslt
</span><span class="z-text z-plain">close s
</span><span class="z-text z-plain">deallocate s
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Поиск в таблице [CI_HISTORY] и столбцу [HIST_ID]:
</span><span class="z-text z-plain">SELECT * FROM ITINVENT.dbo.CI_HISTORY where [HIST_ID] like '%2023%';
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Узнать фрагментацию индексов
</span><span class="z-text z-plain">DECLARE @db_id SMALLINT;
</span><span class="z-text z-plain">SET @db_id = DB_ID(N'itinvent');
</span><span class="z-text z-plain">IF @db_id IS NULL
</span><span class="z-text z-plain">BEGIN;
</span><span class="z-text z-plain">    PRINT N'Неправильное имя базы';
</span><span class="z-text z-plain">END;
</span><span class="z-text z-plain">ELSE
</span><span class="z-text z-plain">BEGIN;
</span><span class="z-text z-plain">	SELECT
</span><span class="z-text z-plain">		object_id AS [ID объекта],
</span><span class="z-text z-plain">		index_id AS [ID индекса],
</span><span class="z-text z-plain">		index_type_desc AS [Тип индекса],
</span><span class="z-text z-plain">		avg_fragmentation_in_percent AS [Фрагментация в %]
</span><span class="z-text z-plain">		
</span><span class="z-text z-plain">	FROM sys.dm_db_index_physical_stats(@db_id, NULL, NULL, NULL , 'LIMITED')
</span><span class="z-text z-plain">	 
</span><span class="z-text z-plain">	ORDER BY [avg_fragmentation_in_percent] DESC;
</span><span class="z-text z-plain">END;
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- TempDB
</span><span class="z-text z-plain">-- Initial size - начальный/минимальный размер БД (1024 MB)
</span><span class="z-text z-plain">-- Autogrowh - прирост (512MB)
</span><span class="z-text z-plain">-- По умолчанию tempdb настроена на авто-расширение (Autogrow) и при каждой перезагрузке SQL Server пересоздаёт файлы этой БД с минимальным размером инициализации.
</span><span class="z-text z-plain">-- Увеличив размер инициализации файлов tempdb, можно свести к минимуму затраты системных ресурсов на операции авто-расширения.
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Изменить путь к БД:
</span><span class="z-text z-plain">USE master;
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">ALTER DATABASE tempdb
</span><span class="z-text z-plain">MODIFY FILE (NAME = tempdev, FILENAME = 'F:\tempdb.mdf');
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">ALTER DATABASE tempdb
</span><span class="z-text z-plain">MODIFY FILE (NAME = temp2, FILENAME = 'F:\tempdb_mssql_2.ndf');
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">ALTER DATABASE tempdb
</span><span class="z-text z-plain">MODIFY FILE (NAME = temp3, FILENAME = 'F:\tempdb_mssql_3.ndf');
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">ALTER DATABASE tempdb
</span><span class="z-text z-plain">MODIFY FILE (NAME = temp4, FILENAME = 'F:\tempdb_mssql_4.ndf');
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">ALTER DATABASE tempdb
</span><span class="z-text z-plain">MODIFY FILE (NAME = temp5, FILENAME = 'F:\tempdb_mssql_5.ndf');
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">ALTER DATABASE tempdb
</span><span class="z-text z-plain">MODIFY FILE (NAME = temp6, FILENAME = 'F:\tempdb_mssql_6.ndf');
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">ALTER DATABASE tempdb
</span><span class="z-text z-plain">MODIFY FILE (NAME = temp7, FILENAME = 'F:\tempdb_mssql_7.ndf');
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">ALTER DATABASE tempdb
</span><span class="z-text z-plain">MODIFY FILE (NAME = temp8, FILENAME = 'F:\tempdb_mssql_8.ndf');
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">ALTER DATABASE tempdb
</span><span class="z-text z-plain">MODIFY FILE (NAME = templog, FILENAME = 'F:\templog.ldf');
</span><span class="z-text z-plain">GO
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">-- Указать размер файла:
</span><span class="z-text z-plain">MODIFY FILE (NAME = temp2, FILENAME = 'F:\tempdb_mssql_2.ndf' , SIZE = 1048576KB , FILEGROWTH = 524288KB);
</span></code></pre> <h3 id=tip-rezervnoi-kopii><a aria-label="Anchor link for: tip-rezervnoi-kopii" class=zola-anchor href=#tip-rezervnoi-kopii><i class=icon></i></a> Тип резервной копии</h3> <ul><li>Full (Полная копия). Когда стартует полное резервирование, записывается Log Sequence Number (LSN - последовательный номер журнала), а так же LSN записывается и при завершении полного резервирования. Этот LSN является механизмом, используемым SQL Server, чтобы знать, в каком порядке выполнялись операторы INSERT, UPDATE или DELETE. При этом наличие записанных LSN начала и окончания, как части полного бэкапа, обеспечивает согласованное с точки зрения транзакций резервное копирование, поскольку при полном резервном копировании учитываются изменения, произошедшие во время резервного копирования. Это обеспечивает обработку таких транзакций в процессе восстановления бэкапа.<li>Differential (дифференциальная/разностная копия). Хранит данных, изменившиеся с момента последней Полной резервной копии. При восстановлении нужно сначала восстановить Полную резервную копию в режиме NORECOVERY, потом можно применить любую из последующих Разностных копий, без предыдущей Полной резервной копии Разностная копия бесполезна. Каждая последующая Разностная копия будет хранить все данные, входящие в предыдущую Разностную резервную копию, сделанную после предыдущей Полной копии.<li>Incremental (инкрементальная/копия журналов транзакций). Резервное копирования журнала транзакций копирует все транзакции, которые произошли с момента последнего резервного копирования, а затем урезает журнал транзакций для освобождения дискового пространства. Транзакции происходят в определенном порядке (LSN), бэкап журнала поддерживает этот порядок транзакций. Бэкапы журналов транзакций должны восстанавливаться по порядку. Для восстановления базы данных потребуется вся цепочка резервных копий: полная и все последующие инкрементальные журнала транзакций.</ul> <h3 id=modeli-vosstanovleniia><a aria-label="Anchor link for: modeli-vosstanovleniia" class=zola-anchor href=#modeli-vosstanovleniia><i class=icon></i></a> Модели восстановления</h3> <ul><li>Simple (Простая). Хранится только необходимый для жизни остаток журнала транзакций. Журнал транзакций (лог) автоматически очищается. Создание резервных копий журнала транзакций невозможна, поэтому остается самое ограниченное число опций по восстановлению. Недоступен функционал: Always On, Point-In-Time восстановление, Резервные копии журнала транзакций.<li>Full (Полная). Хранится журнал транзакций всех изменений в БД с момента последнего резервного копирования журнала транзакций. Журнал транзакций не будет очищаться до тех пор, пока не будет сделана резервная копия журнала транзакций.<li>Bulk logged (С неполным протоколированием). Идентична Full, за исключение: SELECT INTO, BULK INSERT и BCP, INSERT INTO SELECT, операции с индексами (CREATE INDEX, ALTER INDEX REBUILD, DROP INDEX)</ul> <h3 id=sistemnye-bd><a aria-label="Anchor link for: sistemnye-bd" class=zola-anchor href=#sistemnye-bd><i class=icon></i></a> Системные БД</h3> <ul><li>master. Хранятся все данные системного уровня (конфигурация системы, сведенья об учетных записях входа, информация обо всех других базах данных) для экземпляра SQL Server.<li>tempdb. Рабочее пространство для временных объектов, таких как глобальные или локальные временные таблицы, временные хранимые процедуры, табличные переменные и курсоры. Пересоздаётся при каждом запуске SQL Server.<li>model. Используется в качестве шаблона для всех баз данных, создаваемых в экземпляре SQL Server, все содержимое базы данных model, включая параметры базы данных, копируется в создаваемую базу данных. Так как база данных tempdb создается каждый раз при запуске SQL Server, база данных model всегда должна существовать в системе SQL Server.<li>msdb. Используется агентом SQL Server для создания расписания предупреждений (оператор) и выполнение заданий, а также другими компонентами. SQL Server хранит полный журнал резервного копирования и восстановления в базе данных msdb. Для отправки почты оператору используется: USE [msdb].<li>resource. Доступная только для чтения база данных, которая содержит все системные объекты, например sys.objects, физически хранятся в базе данных resource, но логически присутствуют в схеме sys каждой базы данных.</ul> <h3 id=reglamentnye-operatsii><a aria-label="Anchor link for: reglamentnye-operatsii" class=zola-anchor href=#reglamentnye-operatsii><i class=icon></i></a> Регламентные операции</h3> <ul><li>Проверка целостности базы данных</ul> <p><code>DBCC CHECKDB</code></p> <ul><li><p>Индексы. Индексы используются для быстрого поиска данных без необходимости поиска/просмотра всех строк в таблице базы данных при каждом обращении к таблице базы данных. Индекс ускоряет процесс запроса, предоставляя быстрый доступ к строкам данных в таблице, аналогично тому, как указатель в книге помогает вам быстро найти необходимую информацию. Индексы предоставляют путь для быстрого поиска данных на основе значений в этих столбцах. Для каждого индекса обязательно хранится его статистика. MS SQL Server самостоятельно создает и изменяет индексы при работе с базой. С течением времени данные в индексе становятся фрагментированными, т.е. разбросанными по базе данных, что серьезно снижает производительность запросов. Если фрагментация составляет от 5 до 30% (стандартно в задании 15%), то рекомендуется ее устранить с помощью реорганизации, при фрагментации выше 30% (по умолчанию в задаче > 30% фрагментации и число страниц > 1000) необходимо полное перестроение индексов. После перестроения планово используется только реорганизация.</p><li><p>Реорганизация (Reorganize) или дефрагментация индекса — это серия небольших локальных перемещений страниц так, чтобы индекс не был фрагментирован. После реорганизации статистика не обновляется. Во время выполнения почти все данные доступны, пользователи смогут работать.</p></ul> <p><code>sp_msforeachtable N'DBCC INDEXDEFRAG (<имя базы данных>, ''?'')'</code></p> <ul><li>Перестроение (Rebuild) индексов (или задача в мастере планов обслуживания: Восстановить индекс) запускает процесс полного построения индексов. В версии MS SQL Server Standard происходит отключение всех клиентов от базы на время выполнения операции. После перестроения обязательно обновляется статистика.</ul> <p><code>sp_msforeachtable N'DBCC DBREINDEX (''?'')'</code></p> <ul><li>Обновление статистики. Статистика — небольшая таблица (обычно до 200 строк), в которой хранится обобщенная информация о том, какие значения и как часто встречаются в таблице. На основании статистики сервер принимает решение, как лучше построить запрос. Когда происходят запросы к БД (например, SELECT) вы получаете данные, но не описываете то, как эти данные должны быть извлечены. В получении и обработке данных помогает статистика. Во время выполнения процедуры обновления статистики данные не блокируются.</ul> <p><code>exec sp_msforeachtable N'UPDATE STATISTICS ? WITH FULLSCAN'</code></p> <ul><li>Очистка процедурного кэша, выполняется после обновления статистики. Оптимизатор MS SQL Server кэширует планы запросов для их повторного выполнения. Это делается для того, чтобы экономить время, затрачиваемое на компиляцию запроса в том случае, если такой же запрос уже выполнялся и его план известен. После обновия статистики, не будет очищен процедурный кэш, то SQL Server может выбрать старый (неоптимальный) план запроса из кэша вместо того, чтобы построить новый (более оптимальный) план.</ul> <p><code>DBCC FREEPROCCACHE</code></p> <h2 id=influxdb><a aria-label="Anchor link for: influxdb" class=zola-anchor href=#influxdb><i class=icon></i></a> InfluxDB</h2> <p><a href=https://www.influxdata.com/downloads>Download InfluxDB 1.x Open Source</a> <a href=https://github.com/CymaticLabs/InfluxDBStudio>InfluxDB-Studio</a></p> <h3 id=install-windows><a aria-label="Anchor link for: install-windows" class=zola-anchor href=#install-windows><i class=icon></i></a> Install Windows</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://dl.influxdata.com/influxdb/releases/influxdb-1.8.10_windows_amd64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\influxdb-1.8.10_windows_amd64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\influxdb-1.8.10_windows_amd64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>DestinationPath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\influxdb-1.8.10_windows_amd64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-operator z-other z-powershell">&</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\influxdb-1.8.10-1\influxd.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre> <h3 id=install-ubuntu><a aria-label="Anchor link for: install-ubuntu" class=zola-anchor href=#install-ubuntu><i class=icon></i></a> Install Ubuntu</h3> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">wget</span></span><span class="z-meta z-function-call z-arguments z-shell"> https://dl.influxdata.com/influxdb/releases/influxdb_1.8.10_amd64.deb</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sudo</span></span><span class="z-meta z-function-call z-arguments z-shell"> dpkg<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>i</span> influxdb_1.8.10_amd64.deb</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">systemctl</span></span><span class="z-meta z-function-call z-arguments z-shell"> start influxdb</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">systemctl</span></span><span class="z-meta z-function-call z-arguments z-shell"> status influxdb</span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">ps</span></span><span class="z-meta z-function-call z-arguments z-shell"> aux</span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">grep</span></span><span class="z-meta z-function-call z-arguments z-shell"> influxdb</span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">grep</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>Ev</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>grep<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">netstat</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>natpl</span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">grep</span></span><span class="z-meta z-function-call z-arguments z-shell"> 80<span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>8<span class="z-keyword z-operator z-word z-shell">-</span>9<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span><span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>3<span class="z-keyword z-operator z-word z-shell">-</span>9<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span></span>
</span></code></pre> <h3 id=api><a aria-label="Anchor link for: api" class=zola-anchor href=#api><i class=icon></i></a> API</h3> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">nano</span></span><span class="z-meta z-function-call z-arguments z-shell"> /etc/influxdb/influxdb.conf</span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[http]</span></span>
</span><span class="z-source z-shell z-bash">  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">enabled</span></span><span class="z-meta z-function-call z-arguments z-shell"> = true</span>
</span><span class="z-source z-shell z-bash">  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">bind-address</span></span><span class="z-meta z-function-call z-arguments z-shell"> = <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>:8086<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash">  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">auth-enabled</span></span><span class="z-meta z-function-call z-arguments z-shell"> = false</span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">systemctl</span></span><span class="z-meta z-function-call z-arguments z-shell"> restart influxdb</span>
</span></code></pre> <h3 id=chronograf><a aria-label="Anchor link for: chronograf" class=zola-anchor href=#chronograf><i class=icon></i></a> Chronograf</h3> <pre class=z-code><code><span class="z-text z-plain">wget https://dl.influxdata.com/chronograf/releases/chronograf-1.10.2_windows_amd64.zip -UseBasicParsing -OutFile chronograf-1.10.2_windows_amd64.zip
</span><span class="z-text z-plain">Expand-Archive .\chronograf-1.10.2_windows_amd64.zip -DestinationPath 'C:\Program Files\InfluxData\chronograf\'
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">wget https://dl.influxdata.com/chronograf/releases/chronograf_1.10.2_amd64.deb
</span><span class="z-text z-plain">sudo dpkg -i chronograf_1.10.2_amd64.deb
</span><span class="z-text z-plain">systemctl status influxdb
</span><span class="z-text z-plain">http://192.168.3.102:8888
</span></code></pre> <h3 id=grafana><a aria-label="Anchor link for: grafana" class=zola-anchor href=#grafana><i class=icon></i></a> Grafana</h3> <p><a href=https://grafana.com/grafana/download>Download</a></p> <p><code>invoke-RestMethod https://dl.grafana.com/enterprise/release/grafana-enterprise-10.3.1.windows-amd64.msi -OutFile "$home\Download\grafana.msi"</code></p> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">apt-get</span></span><span class="z-meta z-function-call z-arguments z-shell"> install<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>y</span> adduser libfontconfig1 musl</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">wget</span></span><span class="z-meta z-function-call z-arguments z-shell"> https://dl.grafana.com/enterprise/release/grafana-enterprise_10.3.1_amd64.deb</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">dpkg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>i</span> grafana-enterprise_10.3.1_amd64.deb</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">systemctl</span></span><span class="z-meta z-function-call z-arguments z-shell"> start grafana-server</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">systemctl</span></span><span class="z-meta z-function-call z-arguments z-shell"> status grafana-server</span>
</span></code></pre> <h3 id=cli-client><a aria-label="Anchor link for: cli-client" class=zola-anchor href=#cli-client><i class=icon></i></a> CLI Client</h3> <p><code>apt install influxdb-client</code> <br> <code>influx</code> <br> <code>influx --host 192.168.3.102 --username admin --password password</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>influx_client_exec</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\influxdb-1.8.10-1\influx.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-operator z-other z-powershell">&</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>influx_client_exec</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>host <span class="z-constant z-numeric z-integer z-powershell">192.168</span>.<span class="z-constant z-numeric z-integer z-powershell">3.102</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>port <span class="z-constant z-numeric z-integer z-powershell">8086</span>
</span><span class="z-source z-powershell">help
</span><span class="z-source z-powershell">show databases
</span><span class="z-source z-powershell">use PowerShell
</span><span class="z-source z-powershell">SELECT <span class="z-keyword z-operator z-assignment z-powershell">*</span> <span class="z-keyword z-control z-powershell">FROM</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>HardwareMonitor<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-control z-powershell">WHERE</span> time <span class="z-keyword z-operator z-redirection z-powershell">></span> now<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span> <span class="z-constant z-numeric z-integer z-powershell">5m</span>
</span></code></pre> <h3 id=users><a aria-label="Anchor link for: users" class=zola-anchor href=#users><i class=icon></i></a> USERS</h3> <p><code>SHOW USERS</code> отобразить пользователей и их права доступа <br> <code>CREATE USER admin WITH PASSWORD 'password' WITH ALL PRIVILEGES</code> создать пользователя <br> <code>GRANT ALL PRIVILEGES TO "admin"</code> предоставить права доступа <br> <code>GRANT READ ON "database" TO "admin"</code> доступ на чтение для БД или запись (WRITE) <br> <code>REVOKE ALL PRIVILEGES FROM "admin"</code> отозвать права доступа <br> <code>SHOW GRANTS FOR "admin"</code> БД и привелегии доступа для указанного пользователя <br> <code>SET PASSWORD FOR "admin" = 'new_password'</code> изменить пароль <br> <code>DROP USER "admin"</code> удалить пользователя</p> <h3 id=database-2><a aria-label="Anchor link for: database-2" class=zola-anchor href=#database-2><i class=icon></i></a> DATABASE</h3> <p><code>CREATE DATABASE powershell</code> создать БД <br> <code>SHOW DATABASES</code> отобразить список БД <br> <code>DROP DATABASE powershell</code> удалить БД <br> <code>USE powershell</code> <br> <code>SHOW measurements</code> отобразить все таблицы <br> <code>INSERT performance,host=console,counter=CPU value=0.88</code> записать данные в таблицу performance</p> <h3 id=measurement><a aria-label="Anchor link for: measurement" class=zola-anchor href=#measurement><i class=icon></i></a> MEASUREMENT</h3> <p><code>SHOW TAG KEYS FROM "HardwareMonitor"</code> отобразить все тэги в таблице <br> <code>SHOW TAG VALUES FROM "HardwareMonitor" WITH KEY = "HardwareName"</code> отобразить все значения указанного тэга <br> <code>SHOW FIELD KEYS FROM "HardwareMonitor"</code> отобразить все Field Tags и их тип данных <br> <code>SHOW SERIES FROM "HardwareMonitor"</code> отобразить список всех уникальных серий в указанной таблице. Серия - это набор точек данных, которые имеют одинаковые значения для всех тегов, за исключением времени. <br> <code>DROP SERIES FROM "HardwareMonitor"</code> очистить все данные в таблице <br> <code>DROP MEASUREMENT "HardwareMonitor"</code> удалить таблицу</p> <h3 id=select-where><a aria-label="Anchor link for: select-where" class=zola-anchor href=#select-where><i class=icon></i></a> SELECT/WHERE</h3> <p><code>SELECT * FROM performance</code> отобразить все данные в таблице <br> <code>SELECT value FROM performance</code> отфильтровать по столбцу value (только Field Keys) <br> <code>SELECT * FROM performance limit 10</code> отобразить 10 единиц данных <br> <code>SELECT * FROM performance WHERE time > now() -2d</code> отобразить данные за последние 2 дня <br> <code>SELECT * FROM performance WHERE time > now() +3h -5m</code> данные за последние 5 минут (+3 часа от текущего времени по UTC 0 -5 минут) <br> <code>SELECT * FROM performance WHERE counter = 'CPU'</code> выборка по тэгу <br> <code>SELECT upload/1000 FROM speedtest WHERE upload/1000 <= 250</code> выборка по столбцу upload и разделить вывод на 1000, вывести upload меньше 250 <br> <code>DELETE FROM performance WHERE time > now() -1h</code> удалить данные за последние 1/4 часа <br> <code>DELETE FROM performance WHERE time < now() -24h</code> удалить данные старше 24 часов</p> <h3 id=regex-1><a aria-label="Anchor link for: regex-1" class=zola-anchor href=#regex-1><i class=icon></i></a> REGEX</h3> <p><code>SELECT * FROM "win_pdisk" WHERE instance =~/.*C:/ and time > now() - 5m</code> и <br> <code>SELECT * FROM "win_pdisk" WHERE instance =~/.*E:/ or instance =~ /.*F:/</code> или <br> <code>SELECT * FROM "win_pdisk" WHERE instance !~ /.*Total/</code> не равно (исключить) <br> <code>SELECT * FROM "HardwareMonitor" WHERE time > now() - 5m and HardwareName =~ /Intel/</code> приблизительно равно <br> <code>SELECT * FROM "HardwareMonitor" WHERE time > now() - 5m and HardwareName =~ /Intel.+i7/</code> эквивалент 12th_Gen_Intel_Core_i7-1260P <br> <code>SELECT * FROM "HardwareMonitor" WHERE time > now() - 5m and HardwareName =~ /^Intel/</code> начинается на Intel <br> <code>SELECT * FROM "HardwareMonitor" WHERE time > now() - 5m and HardwareName =~ /00$/</code> заканчивается на 00</p> <h3 id=group-by-tag-key><a aria-label="Anchor link for: group-by-tag-key" class=zola-anchor href=#group-by-tag-key><i class=icon></i></a> GROUP BY tag_key</h3> <p><code>SELECT * FROM "HardwareMonitor" WHERE time > now() - 5m and SensorName = 'Temperature' GROUP BY HardwareName</code> создать уникальные группы по тэгу HardwareName <br> <code>SELECT * FROM "HardwareMonitor" WHERE time > now() - 5m and SensorName = 'Temperature' GROUP BY Host,HardwareName</code> больше групп по двум тэгаам</p> <h3 id=functions-field-key><a aria-label="Anchor link for: functions-field-key" class=zola-anchor href=#functions-field-key><i class=icon></i></a> Functions(field_key)</h3> <p><a href=https://docs.influxdata.com/influxdb/v1.8/query_language/functions>Functions</a></p> <p><code>SELECT instance,LAST(Avg._Disk_Read_Queue_Length) FROM "win_pdisk" GROUP BY instance</code> отфильтровать вывод по последнему/текущему значению <br> <code>SELECT instance,FIRST(Avg._Disk_Read_Queue_Length) FROM "win_pdisk" GROUP BY instance</code> отфильтровать вывод по первому значению за весь или указанный отрезок времени <br> <code>SELECT instance,MIN(Avg._Disk_Read_Queue_Length) FROM "win_pdisk" GROUP BY instance</code> отфильтровать вывод с отображением минимального значения <br> <code>SELECT instance,MAX(Avg._Disk_Read_Queue_Length) FROM "win_pdisk" GROUP BY instance</code> отфильтровать вывод с отображением максимального значения <br> <code>SELECT SUM(Bytes_Received_persec) FROM "win_net" GROUP BY instance</code> суммах всех значений <br> <code>SELECT COUNT(Bytes_Received_persec) FROM "win_net" WHERE Bytes_Received_persec >= 0 GROUP BY instance</code> кол-во данных, где значение выше или равно 0 <br> <code>SELECT MEAN(Bytes_Received_persec) FROM "win_net" WHERE Bytes_Received_persec < 1000 GROUP BY instance</code> среднее значение данных с показателем от 0 до 1000 (509)</p> <p><code>SELECT *,MAX(Value) FROM "HardwareMonitor" WHERE time > now() -1h GROUP BY SensorName,Host</code> создать группы для выявления максимального значения значения стобца Value каждого тэга SensorName и хоста за последний час <br> <code>SELECT *,MAX(Value) FROM "HardwareMonitor" WHERE time > now() -1h and SensorName = 'CPU_Package' GROUP BY Host</code> масимальное значение CPU_Package за последний час для каждого хоста <br> <code>SELECT MEAN(Value) FROM "HardwareMonitor" WHERE time > now() -1h and SensorName = 'CPU_Package' GROUP BY Host</code> среднее значение CPU_Package за последний час</p> <h3 id=policy><a aria-label="Anchor link for: policy" class=zola-anchor href=#policy><i class=icon></i></a> POLICY</h3> <p><code>CREATE DATABASE powershell WITH DURATION 48h REPLICATION 1 NAME "del2d"</code> создать БД с политикой хранения 2 дня <br> <code>CREATE RETENTION POLICY del2h ON powershell DURATION 2h REPLICATION 1</code> создать новую политику хранения для БД <br> <code>CREATE RETENTION POLICY del6h ON powershell DURATION 6h REPLICATION 1 SHARD DURATION 2h</code> указать период хранения 6 часов + 2 часа до очистки (по умолчанию 1ч или больше) <br> <code>ALTER RETENTION POLICY del6h ON powershell DEFAULT</code> изменить (ALTER) политику хранения для БД на del6h (DEFAULT) <br> <code>DROP RETENTION POLICY del2d ON powershell</code> удаление политики хранения приводит к безвозвратному удалению всех измерений (таблиц) и данных, хранящихся в политике хранения <br> <code>SHOW RETENTION POLICIES ON PowerShell</code> отобразить действующие политики базы данных PowerShell</p> <h2 id=influxdb-api><a aria-label="Anchor link for: influxdb-api" class=zola-anchor href=#influxdb-api><i class=icon></i></a> InfluxDB-api</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">192.168</span>.<span class="z-constant z-numeric z-integer z-powershell">3.102</span>:<span class="z-constant z-numeric z-integer z-powershell">8086</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>query?q<span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>SHOW RETENTION POLICIES ON PowerShell<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>col</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data<span class="z-variable z-other z-member z-powershell">.results.series.columns</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>val</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data<span class="z-variable z-other z-member z-powershell">.results.series.values</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mass</span>    <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mass</span>   <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>col</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>v</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>val</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mass</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>v</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mass</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mass</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>^<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>"<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mass</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mass</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>$<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>"<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mass</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mass</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>\s<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>","<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mass</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Csv</span>
</span></code></pre> <h3 id=api-post><a aria-label="Anchor link for: api-post" class=zola-anchor href=#api-post><i class=icon></i></a> API POST</h3> <p>Вместо таблиц в InfluxDB имеются измерения. Вместо столбцов в ней есть теги и поля.</p> <pre class=z-code><code><span class="z-text z-plain">   Table                        Tag (string/int)                          Field (double/int)           TIMESTAMP
</span><span class="z-text z-plain">measurement,Tag_Keys1=Tag_Values1,Tag_Keys2=Tag_Values2 Field_Keys1="Values",Field_Keys2="Values" 0000000000000000000
</span><span class="z-text z-plain">           1                                           2                                         3
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">$ip        = "192.168.3.104"
</span><span class="z-text z-plain">$port      = "8086"
</span><span class="z-text z-plain">$db        = "powershell"
</span><span class="z-text z-plain">$table     = "speedtest"
</span><span class="z-text z-plain">$ipp       = $ip+":"+$port
</span><span class="z-text z-plain">$url       = "http://$ipp/write?db=$db"
</span><span class="z-text z-plain">$user      = "admin"
</span><span class="z-text z-plain">$pass      = "password" | ConvertTo-SecureString -AsPlainText -Force
</span><span class="z-text z-plain">$cred      = [System.Management.Automation.PSCredential]::new($user,$pass)
</span><span class="z-text z-plain">$unixtime  = (New-TimeSpan -Start (Get-Date "01/01/1970") -End (Get-Date)).TotalSeconds
</span><span class="z-text z-plain">$timestamp = ([string]$unixtime -replace "\..+") + "000000000"
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Invoke-RestMethod -Method POST -Uri $url -Body "$table,host=$(hostname) download=200000,upload=300000,ping=3 $timestamp"
</span></code></pre> <h3 id=api-get><a aria-label="Anchor link for: api-get" class=zola-anchor href=#api-get><i class=icon></i></a> API GET</h3> <p><code>curl http://192.168.3.104:8086/query --data-urlencode "q=SHOW DATABASES"</code> pwsh7 (ConvertFrom-Json) and bash</p> <p><code>$dbs = irm "http://192.168.3.104:8086/query?q=SHOW DATABASES"</code> <br> <code>$dbs = irm "http://192.168.3.104:8086/query?epoch=ms&u=admin&p=password&q=SHOW DATABASES"</code> <br> <code>$dbs.results.series.values</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span>    <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.104<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>8086<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>db</span>    <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>powershell<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>table</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>speedtest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>query</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>SELECT * FROM <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>table</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ipp</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>:<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ipp</span>/query?db=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>db</span>&q=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>query</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method GET <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span><span class="z-keyword z-operator z-other z-powershell">`</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Credential <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cred</span> 
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data<span class="z-variable z-other z-member z-powershell">.results.series.name</span></span>   <span class="z-keyword z-operator z-other z-powershell">`</span> имя таблицы
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data<span class="z-variable z-other z-member z-powershell">.results.series.columns</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> столбцы<span class="z-keyword z-operator z-assignment z-powershell">/</span>ключи
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data<span class="z-variable z-other z-member z-powershell">.results.series.values</span></span> <span class="z-keyword z-operator z-other z-powershell">`</span> данные построчно
</span></code></pre> <h3 id=endpoints><a aria-label="Anchor link for: endpoints" class=zola-anchor href=#endpoints><i class=icon></i></a> Endpoints</h3> <p><a href=https://docs.influxdata.com/influxdb/v1.7/tools/api/>API doc</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stats</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> irm http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">192.168</span>.<span class="z-constant z-numeric z-integer z-powershell">3.104</span>:<span class="z-constant z-numeric z-integer z-powershell">8086</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>debug<span class="z-keyword z-operator z-assignment z-powershell">/</span>vars<span class="z-keyword z-operator z-other z-powershell">`</span> статистика сервера
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stats</span>.<span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>database:powershell<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>.values<span class="z-keyword z-operator z-other z-powershell">`</span> кол<span class="z-keyword z-operator z-assignment z-powershell">-</span>во таблиц к БД
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stats<span class="z-variable z-other z-member z-powershell">.queryExecutor.values</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> количество query<span class="z-keyword z-operator z-assignment z-powershell">-</span>запросов <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">обращений к endpoint <span class="z-keyword z-operator z-assignment z-powershell">/</span>query</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stats<span class="z-variable z-other z-member z-powershell">.write.values</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> количество <span class="z-support z-function z-powershell">write-запросов</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stats<span class="z-variable z-other z-member z-powershell">.system.uptime</span></span>
</span></code></pre> <p><code>http://192.168.3.104:8086/debug/requests</code> кол-во клиентских HTTP-запросов к конечным точкам /writeи /query <br> <code>http://192.168.3.104:8086/debug/pprof</code> <br> <code>http://192.168.3.104:8086/ping</code> <br> <code>http://192.168.3.104:8086/query</code> <br> <code>http://192.168.3.104:8086/write</code></p> <p><code>http://192.168.3.99:8086/api/v2/setup</code> <br> <code>http://192.168.3.99:8086/api/v2/config</code> <br> <code>http://192.168.3.99:8086/api/v2/write</code></p> <h3 id=pingto-influxdb><a aria-label="Anchor link for: pingto-influxdb" class=zola-anchor href=#pingto-influxdb><i class=icon></i></a> PingTo-InfluxDB</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>tz</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-TimeZone</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.BaseUtcOffset.TotalMinutes
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>unixtime</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">New-TimeSpan</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Start <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>01/01/1970<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>End <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.AddMinutes<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>tz</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.TotalSeconds<span class="z-keyword z-operator z-other z-powershell">`</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>3h UTC
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timestamp</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>unixtime</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\..+<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>000000000<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>tnc</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> tnc <span class="z-constant z-numeric z-integer z-powershell">8.8</span>.<span class="z-constant z-numeric z-integer z-powershell">8.8</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>tnc<span class="z-variable z-other z-member z-powershell">.PingSucceeded</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RTime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>tnc<span class="z-variable z-other z-member z-powershell">.PingReplyDetails.RoundtripTime</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://192.168.3.104:8086/write?db=powershell<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ping,host=<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell">hostname</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> status=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span>,rtime=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RTime</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timestamp</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	sleep <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>SELECT * FROM ping WHERE status = false</code></p> <h3 id=performanceto-influxdb><a aria-label="Anchor link for: performanceto-influxdb" class=zola-anchor href=#performanceto-influxdb><i class=icon></i></a> PerformanceTo-InfluxDB</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertTo-Encoding</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>From</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>To</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Begin</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>encFrom</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetEncoding<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>from</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>encTo</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetEncoding<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>to</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Process</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bytes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>encTo<span class="z-variable z-other z-member z-powershell">.GetBytes</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bytes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Convert<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>encFrom</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>encTo</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bytes</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>encTo<span class="z-variable z-other z-member z-powershell">.GetString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bytes</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>localization</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Culture</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.LCID<span class="z-keyword z-operator z-other z-powershell">`</span> текущая локализация
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>localization</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">1049</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>performance</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\\<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell">hostname</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Процессор(_Total)\% загруженности процессора<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Encoding</span> UTF<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">8</span> windows<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1251</span><span class="z-keyword z-operator z-other z-powershell">`</span> декодировать кириллицу
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>performance</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\Processor(_Total)\% Processor Time<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>tz</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-TimeZone</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.BaseUtcOffset.TotalMinutes
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>unixtime</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">New-TimeSpan</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Start <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>01/01/1970<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>End <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.AddMinutes<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>tz</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.TotalSeconds<span class="z-keyword z-operator z-other z-powershell">`</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>3h UTC
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timestamp</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>unixtime</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\..+<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>000000000<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">double</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>value</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Counter</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>performance</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.CounterSamples.CookedValue.ToString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>0.00<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.replace<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>,<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> округлить в тип данных Double
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	<span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://192.168.3.104:8086/write?db=powershell<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>performance,host=<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell">hostname</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>,counter=CPU value=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>value</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timestamp</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">	sleep <span class="z-constant z-numeric z-integer z-powershell">5</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <h3 id=service><a aria-label="Anchor link for: service" class=zola-anchor href=#service><i class=icon></i></a> Service</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>powershell_Path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Command</span> powershell</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Source
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NSSM_Path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\NSSM\NSSM-2.24.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Script_Path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\NSSM\PerformanceTo-InfluxDB.ps1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Service_Name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>PerformanceTo-InfluxDB<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-operator z-other z-powershell">&</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NSSM_Path</span> install <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Service_Name</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>powershell_Path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ExecutionPolicy Bypass <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoProfile <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Script_Path</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-Service</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Service_Name</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Start-Service</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-Service</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Service_Name</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Set-Service</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>StartupType Automatic
</span></code></pre> <h3 id=psinfluxdb><a aria-label="Anchor link for: psinfluxdb" class=zola-anchor href=#psinfluxdb><i class=icon></i></a> PSInfluxDB</h3> <p><code>Install-Module psinfluxdb -Repository NuGet</code> <br> <code>Get-InfluxUsers -server 192.168.3.102</code> список пользователей на сенвере InfluxDB и права доступа <br> <code>Get-InfluxDatabases -server 192.168.3.102</code> список баз данных <br> <code>Get-InfluxDatabases -server 192.168.3.102 -creat -database test</code> создать базу данных <br> <code>Get-InfluxDatabases -server 192.168.3.102 -delete -database test</code> удалить базу данных <br> <code>Get-InfluxPolicy -server 192.168.3.102 -database PowerShell</code> список политик хранения указанной базы данных <br> <code>Get-InfluxPolicy -server 192.168.3.102 -database PowerShell -creat -policyName del2d -hours 48</code> создать политику хранения <br> <code>Get-InfluxPolicy -server 192.168.3.102 -database PowerShell -policyName del2d -default</code> применить политику хранения к базе данных по умолчанию <br> <code>Get-InfluxTables -server 192.168.3.102 -database PowerShell</code> список таблиц/измерений в базе данных <br> <code>$Data = Get-InfluxData -server 192.168.3.102 -database PowerShell -table ping | Format-Table</code> отобразить данные в таблице <br> <code>$Data | Where-Object {$_.SensorName -match "CPU_Package" -and $_.Value -gt 90} | Format-Table</code> отфильтровать данные по двум параметрам (сенсоры процессора с показателем выше 90) <br> <code>$influx = Get-InfluxData -server 192.168.3.104 -database PowerShell -table speedtest</code> <br> <code>Get-InfluxChart -time ($influx.time) -data ($influx.download) -title "SpeedTest Download" -path "C:\Users\Lifailon\Desktop"</code> создать график (WinForms Chart) измерений и сохранить в jpeg-файл</p> <h2 id=telegraf><a aria-label="Anchor link for: telegraf" class=zola-anchor href=#telegraf><i class=icon></i></a> Telegraf</h2> <p><a href=https://docs.influxdata.com/telegraf/v1.27/plugins/#input-plugins>Plugins</a></p> <p><code>iwr https://dl.influxdata.com/telegraf/releases/telegraf-1.27.1_windows_amd64.zip -UseBasicParsing -OutFile telegraf-1.27.1_windows_amd64.zip</code> <br> <code>Expand-Archive .\telegraf-1.27.1_windows_amd64.zip -DestinationPath "C:\Telegraf"</code> <br> <code>rm telegraf-1.27.1_windows_amd64.zip</code> <br> <code>cd C:\Telegraf</code> <br> <code>.\telegraf.exe -sample-config --input-filter cpu:mem:dns_query --output-filter influxdb > telegraf_nt.conf</code> создать конфигурацию с выбарнными плагинами для сбора метрик <br> <code>Start-Process notepad++ C:\Telegraf\telegraf_nt.conf</code></p> <pre class=z-code><code><span class="z-text z-plain">[[outputs.influxdb]]
</span><span class="z-text z-plain">  urls = ["http://192.168.3.104:8086"]
</span><span class="z-text z-plain">  database = "telegraf_nt"
</span><span class="z-text z-plain">  username = "user"
</span><span class="z-text z-plain">  password = "pass"
</span><span class="z-text z-plain">[[inputs.cpu]]
</span><span class="z-text z-plain">  percpu = false
</span><span class="z-text z-plain">  totalcpu = true
</span><span class="z-text z-plain">[[inputs.dns_query]]
</span><span class="z-text z-plain">  servers = ["8.8.8.8"]
</span><span class="z-text z-plain">  network = "udp"
</span><span class="z-text z-plain">  domains = ["."]
</span><span class="z-text z-plain">  record_type = "A"
</span><span class="z-text z-plain">  port = 53
</span><span class="z-text z-plain">  timeout = "2s"
</span></code></pre> <p><code>.\telegraf.exe --test -config C:\Telegraf\telegraf_nt.conf</code> тест конфигурации (получения метрик с выводом в консоль) <br> <code>C:\Telegraf\telegraf.exe -config C:\Telegraf\telegraf_nt.conf</code> запустить telegraf (тест отправки данных) <br> <code>.\telegraf.exe --config "C:\Telegraf\telegraf_nt.conf" --service install</code> создать службу <br> <code>Get-Service telegraf | Start-Service</code> <br> <code>.\telegraf.exe --service uninstall</code></p> <p><code>USE telegraf</code> <br> <code>SELECT usage_idle,usage_system,usage_user FROM cpu</code></p> <h2 id=elasticsearch><a aria-label="Anchor link for: elasticsearch" class=zola-anchor href=#elasticsearch><i class=icon></i></a> Elasticsearch</h2> <p><code>Install-Module -Name Elastic.Console -AllowPrerelease</code> <a href=https://github.com/elastic/powershell/blob/master/Elastic.Console/README.md>github source</a> <br> <code>Get-Command -Module Elastic.Console</code> <br> <code>Get-ElasticsearchVersion</code> <br> <code>Set-ElasticsearchVersion 7.3.0</code> <br> <code>Invoke-Elasticsearch</code> REST API запросы</p> <h2 id=cdata><a aria-label="Anchor link for: cdata" class=zola-anchor href=#cdata><i class=icon></i></a> CData</h2> <p><a href=https://www.powershellgallery.com/profiles/CData>PowerShell Gallery CData</a> <br> <a href=https://www.cdata.com/kb/tech/elasticsearch-ado-powershell.rst>Automate Elasticsearch Integration Tasks from PowerShell</a></p> <p><code>Install-Module ElasticsearchCmdlets</code> <a href=https://www.powershellgallery.com/packages/ElasticsearchCmdlets/23.0.8565.1>пакет драйвера в psgallery</a> <br> <code>Import-Module ElasticsearchCmdlets</code> <br> <code>Get-Command -Module ElasticsearchCmdlets</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>elasticsearch</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Connect-Elasticsearch</span>  <span class="z-keyword z-operator z-assignment z-powershell">-</span>Server <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Server</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Port <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Port</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>User <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>User</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Password <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Password</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>shipcity</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>New York<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>orders</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Select-Elasticsearch</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Connection <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>elasticsearch</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Table <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Orders<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Where <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ShipCity = <span class="z-constant z-character z-escape z-powershell">`'</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShipCity</span><span class="z-constant z-character z-escape z-powershell">`'</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> поиск и получение данных
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>orders</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-Elasticsearch</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Connection <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>elasticsearch</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Query <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>SELECT * FROM Orders WHERE ShipCity = @ShipCity<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Params <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>@ShipCity<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>New York<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> SQL запросы
</span></code></pre> <h3 id=ado-net-assembly><a aria-label="Anchor link for: ado-net-assembly" class=zola-anchor href=#ado-net-assembly><i class=icon></i></a> ADO.NET Assembly</h3> <p><code>Install-Package CData.Elasticsearch</code> <a href=https://www.nuget.org/packages/CData.Elasticsearch>пакет драйвера в nuget</a> <br> <code>[Reflection.Assembly]::LoadFile("C:\Program Files\PackageManagement\NuGet\Packages\CData.Elasticsearch.23.0.8565\lib\net40\System.Data.CData.Elasticsearch.dll")</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>connect</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.CData.Elasticsearch.ElasticsearchConnection<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Server=127.0.0.1;Port=9200;User=admin;Password=123456;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>connect<span class="z-variable z-other z-member z-powershell">.Open</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sql</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>SELECT OrderName, Freight from Orders<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>da</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.CData.Elasticsearch.ElasticsearchDataAdapter<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sql</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dt</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.DataTable
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>da<span class="z-variable z-other z-member z-powershell">.Fill</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dt</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dt<span class="z-variable z-other z-member z-powershell">.Rows</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.ordername</span></span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.freight</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <h3 id=update-1><a aria-label="Anchor link for: update-1" class=zola-anchor href=#update-1><i class=icon></i></a> UPDATE</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Update-Elasticsearch</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Connection <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Elasticsearch</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Columns <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>OrderName<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Freight<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Values <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>MyOrderName<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>MyFreight<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Table Orders <span class="z-keyword z-operator z-assignment z-powershell">-</span>Id <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MyId<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span>  <span class="z-support z-function z-powershell">New-Object</span> System.Data.CData.Elasticsearch.ElasticsearchCommand<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>UPDATE Orders SET ShipCity='New York' WHERE Id = @myId<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.Parameters.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">new System.Data.CData.Elasticsearch.ElasticsearchParameter<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>@myId<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>10456255-0015501366<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.ExecuteNonQuery</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=insert-1><a aria-label="Anchor link for: insert-1" class=zola-anchor href=#insert-1><i class=icon></i></a> INSERT</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Elasticsearch</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Connection <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Elasticsearch</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Table Orders <span class="z-keyword z-operator z-assignment z-powershell">-</span>Columns <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>OrderName<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Freight<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Values <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MyOrderName<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MyFreight<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span>  <span class="z-support z-function z-powershell">New-Object</span> System.Data.CData.Elasticsearch.ElasticsearchCommand<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>INSERT INTO Orders (ShipCity) VALUES (@myShipCity)<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.Parameters.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">new System.Data.CData.Elasticsearch.ElasticsearchParameter<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>@myShipCity<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>New York<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.ExecuteNonQuery</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=delete-1><a aria-label="Anchor link for: delete-1" class=zola-anchor href=#delete-1><i class=icon></i></a> DELETE</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Elasticsearch</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Connection <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Elasticsearch</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Table <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Orders<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Id <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MyId<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span>  <span class="z-support z-function z-powershell">New-Object</span> System.Data.CData.Elasticsearch.ElasticsearchCommand<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>DELETE FROM Orders WHERE Id=@myId<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.Parameters.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">new System.Data.CData.Elasticsearch.ElasticsearchParameter<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>@myId<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>001d000000YBRseAAH<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.ExecuteNonQuery</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h2 id=odbc><a aria-label="Anchor link for: odbc" class=zola-anchor href=#odbc><i class=icon></i></a> ODBC</h2> <p><code>Get-Command -Module Wdac</code> <br> <code>Get-OdbcDriver | ft</code> список установленных драйверов</p> <p><a href=https://www.elastic.co/guide/en/elasticsearch/reference/current/sql-client-apps-ps1.html>Elasticsearch ODBC драйвер для доступа к данным Elasticsearch из Microsoft PowerShell</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>connectstring</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>DSN=Local Elasticsearch;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sql</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>SELECT * FROM library<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.Odbc.OdbcConnection<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>connectstring</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn<span class="z-variable z-other z-member z-powershell">.open</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> system.Data.Odbc.OdbcCommand<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sql</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>da</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> system.Data.Odbc.OdbcDataAdapter<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dt</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> system.Data.datatable
</span><span class="z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>da<span class="z-variable z-other z-member z-powershell">.fill</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dt</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn<span class="z-variable z-other z-member z-powershell">.close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dt</span>
</span></code></pre> <h2 id=postgresql><a aria-label="Anchor link for: postgresql" class=zola-anchor href=#postgresql><i class=icon></i></a> PostgreSQL</h2> <h3 id=odbc-driver><a aria-label="Anchor link for: odbc-driver" class=zola-anchor href=#odbc-driver><i class=icon></i></a> ODBC Driver</h3> <p><a href=https://www.postgresql.org/ftp/odbc/versions/msi/>Скачать и установить драйвер</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dbServer</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.101<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>5432<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dbName</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>test<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dbUser</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>admin<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dbPass</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>admin<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>szConnect</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Driver={PostgreSQL Unicode(x64)};Server=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dbServer</span>;Port=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span>;Database=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dbName</span>;Uid=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dbUser</span>;Pwd=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dbPass</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> 
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cnDB</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.Odbc.OdbcConnection<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>szConnect</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dsDB</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.DataSet
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">try</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cnDB<span class="z-variable z-other z-member z-powershell">.Open</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>adDB</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.Odbc.OdbcDataAdapter
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>adDB<span class="z-variable z-other z-member z-powershell">.SelectCommand</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Data.Odbc.OdbcCommand<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>SELECT id, name, age, login FROM public.users<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cnDB</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>adDB<span class="z-variable z-other z-member z-powershell">.Fill</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dsDB</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cnDB<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">catch</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Data.Odbc.OdbcException</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Exception</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Exception.Message</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Exception.ItemName</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>row</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dsDB</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.Tables<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.Rows</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>row<span class="z-variable z-other z-member z-powershell">.login</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>row<span class="z-variable z-other z-member z-powershell">.age</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <h3 id=npgsql><a aria-label="Anchor link for: npgsql" class=zola-anchor href=#npgsql><i class=icon></i></a> npgsql</h3> <p><a href=https://github.com/npgsql/npgsql>Source</a> <br> <a href=https://www.nuget.org/packages/Npgsql.EntityFrameworkCore.PostgreSQL>Package</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Подключаем сборку Npgsql<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\Npgsql.PostgreSQL\8.0.4\net8.0\Npgsql.EntityFrameworkCore.PostgreSQL.dll<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Определяем строку подключения к базе данных PostgreSQL<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>connString</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Host=myserver;Username=mylogin;Password=mypass;Database=mydatabase<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создаем объект подключения<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> Npgsql.NpgsqlConnection<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>connString</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Открываем соединение с базой данных<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn<span class="z-variable z-other z-member z-powershell">.Open</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">try</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создаем SQL команду<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn<span class="z-variable z-other z-member z-powershell">.CreateCommand</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.CommandText</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>INSERT INTO data (some_field) VALUES (@p)<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Добавляем параметр и его значение<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>param</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.Parameters.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>p<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">NpgsqlTypes.NpgsqlDbType</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Text</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>param<span class="z-variable z-other z-member z-powershell">.Value</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Hello world<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Выполняем команду<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.ExecuteNonQuery</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-Null</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">finally</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Извлекаем все строки из таблицы<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">try</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создаем команду SQL для извлечения данных<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn<span class="z-variable z-other z-member z-powershell">.CreateCommand</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.CommandText</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>SELECT some_field FROM data<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Выполняем команду и получаем объект чтения данных<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>reader</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.ExecuteReader</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Читаем и выводим данные построчно<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>reader<span class="z-variable z-other z-member z-powershell">.Read</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>reader<span class="z-variable z-other z-member z-powershell">.GetString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">finally</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Освобождаем ресурсы чтения данных и команды<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>reader<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cmd<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Закрываем соединение с базой данных<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conn<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h2 id=wmi><a aria-label="Anchor link for: wmi" class=zola-anchor href=#wmi><i class=icon></i></a> WMI</h2> <h3 id=wmi-cim><a aria-label="Anchor link for: wmi-cim" class=zola-anchor href=#wmi-cim><i class=icon></i></a> WMI/CIM</h3> <blockquote><p>Windows Management Instrumentation/Common Information Model</blockquote> <p><code>Get-WmiObjec -ComputerName localhost -Namespace root -class "__NAMESPACE" | select name,__namespace</code> отобразить дочернии Namespace (логические иерархические группы) <br> <code>Get-WmiObject -List</code> отобразить все классы пространства имен “root\cimv2” (по умолчанию), свойства (описывают конфигурацию и текущее состояние управляемого ресурса) и их методы (какие действия позволяет выполнить над этим ресурсом) <br> <code>Get-WmiObject -List | Where-Object {$_.name -match "video"}</code> поиск класса по имени, его свойств и методов <br> <code>Get-WmiObject -ComputerName localhost -Class Win32_VideoController</code> отобразить содержимое свойств класса</p> <p><code>gwmi -List | where name -match "service" | ft -auto</code> если в таблице присутствуют Methods, то можно взаимодействовать {StartService, StopService} <br> <code>gwmi -Class win32_service | select *</code> отобразить список всех служб и всех их свойств <br> <code>Get-CimInstance Win32_service</code> обращается на прямую к “root\cimv2” <br> <code>gwmi win32_service -Filter "name='Zabbix Agent'"</code> отфильтровать вывод по имени <br> <code>(gwmi win32_service -Filter "name='Zabbix Agent'").State</code> отобразить конкретное свойство <br> <code>gwmi win32_service -Filter "State = 'Running'"</code> отфильтровать запущенные службы <br> <code>gwmi win32_service -Filter "StartMode = 'Auto'"</code> отфильтровать службы по методу запуска <br> <code>gwmi -Query 'select * from win32_service where startmode="Auto"'</code> WQL-запрос (WMI Query Language) <br> <code>gwmi win32_service | Get-Member -MemberType Method</code> отобразить все методы взаимодействия с описание применения (Delete, StartService) <br> <code>(gwmi win32_service -Filter 'name="Zabbix Agent"').Delete()</code> удалить службу <br> <code>(gwmi win32_service -Filter 'name="MSSQL$MSSQLE"').StartService()</code> запустить службу</p> <p><code>Get-CimInstance -ComputerName $srv Win32_OperatingSystem | select LastBootUpTime</code> время последнего включения <br> <code>gwmi -ComputerName $srv -Class Win32_OperatingSystem | select LocalDateTime,LastBootUpTime</code> текущее время и время последнего включения <br> <code>gwmi Win32_OperatingSystem | Get-Member -MemberType Method</code> методы reboot и shutdown <br> <code>(gwmi Win32_OperatingSystem -EnableAllPrivileges).Reboot()</code> используется с ключем повышения привелегий <br> <code>(gwmi Win32_OperatingSystem -EnableAllPrivileges).Win32Shutdown(0)</code> завершение сеанса пользователя</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>system</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-WmiObject</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Class Win32_OperatingSystem
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>InstallDate</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Management.ManagementDateTimeconverter</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ToDateTime<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>system<span class="z-variable z-other z-member z-powershell">.installdate</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Получаем дату установки ОС
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>AfterInstallDays</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> — <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Installdate</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Days<span class="z-keyword z-operator z-other z-powershell">`</span> Вычисляем время<span class="z-keyword z-operator z-other z-powershell">,</span> прошедшее с момента установки
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShortInstallDate</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0:yyyy-MM-dd HH:MM}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>InstallDate</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Система установлена: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShortInstallDate</span> (Прошло <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>AfterInstalldays</span> дней)<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre> <p><code>(Get-WmiObject win32_battery).estimatedChargeRemaining</code> заряд батареи в процентах <br> <code>gwmi Win32_UserAccount</code> доменные пользователи <br> <code>(gwmi Win32_SystemUsers).PartComponent</code> <br> <code>Get-CimInstance -ClassName Win32_LogonSession</code> <br> <code>Get-CimInstance -ClassName Win32_BIOS</code></p> <p><code>gwmi -list -Namespace root\CIMV2\Terminalservices</code> <br> <code>(gwmi -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).AllowTSConnections</code> <br> <code>(gwmi -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).SetAllowTSConnections(1)</code> включить RDP</p> <pre class=z-code><code><span class="z-text z-plain">$srv = "localhost"
</span><span class="z-text z-plain">gwmi Win32_logicalDisk -ComputerName $srv | where {$_.Size -ne $null} | select @{
</span><span class="z-text z-plain">Label="Value"; Expression={$_.DeviceID}}, @{Label="AllSize"; Expression={
</span><span class="z-text z-plain">[string]([int]($_.Size/1Gb))+" GB"}},@{Label="FreeSize"; Expression={
</span><span class="z-text z-plain">[string]([int]($_.FreeSpace/1Gb))+" GB"}}, @{Label="Free%"; Expression={
</span><span class="z-text z-plain">[string]([int]($_.FreeSpace/$_.Size*100))+" %"}}
</span></code></pre> <h3 id=nla><a aria-label="Anchor link for: nla" class=zola-anchor href=#nla><i class=icon></i></a> NLA</h3> <blockquote><p>Network Level Authentication</blockquote> <p><code>(gwmi -class "Win32_TSGeneralSetting" -Namespace root\cimv2\Terminalservices -Filter "TerminalName='RDP-tcp'").UserAuthenticationRequired</code> <br> <code>(gwmi -class "Win32_TSGeneralSetting" -Namespace root\cimv2\Terminalservices -Filter "TerminalName='RDP-tcp'").SetUserAuthenticationRequired(1)</code> включить NLA <br> <code>Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name SecurityLayer</code> отобразить значение (2) <br> <code>Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name UserAuthentication</code> отобразить значение (1) <br> <code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name SecurityLayer -Value 0</code> изменить значение <br> <code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name UserAuthentication -Value 0</code> <br> <code>REG ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters /v AllowEncryptionOracle /t REG_DWORD /d 2</code> отключить на клиентском компьютере проверку версии CredSSP, если на целевом комьютере-сервере не установлены обновления KB4512509 от мая 2018 года</p> <h2 id=regedit><a aria-label="Anchor link for: regedit" class=zola-anchor href=#regedit><i class=icon></i></a> Regedit</h2> <p><code>Get-PSDrive</code> список всех доступных дисков/разделов, их размер и веток реестра <br> <code>cd HKLM:\</code> HKEY_LOCAL_MACHINE <br> <code>cd HKCU:\</code> HKEY_CURRENT_USER <br> <code>Get-Item</code> получить информацию о ветке реестра <br> <code>New-Item</code> создать новый раздел реестра <br> <code>Remove-Item</code> удалить ветку реестра <br> <code>Get-ItemProperty</code> получить значение ключей/параметров реестра (это свойства ветки реестра, аналогично свойствам файла) <br> <code>Set-ItemProperty</code> изменить название или значение параметра реестра <br> <code>New-ItemProperty</code> создать параметр реестра <br> <code>Remove-ItemProperty</code> удалить параметр</p> <p><code>Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Select DisplayName</code> список установленных программ <br> <code>Get-Item HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002</code> посмотреть содержимое Items <br> <code>(Get-ItemProperty HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002)."New Signature"</code> отобразить значение (Value) свойства (Property) Items <br> <code>$reg_path = "HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002"</code> <br> <code>$sig_name = "auto"</code> <br> <code>Set-ItemProperty -Path $reg_path -Name "New Signature" -Value $sig_name</code> изменить или добавить в корне ветки (Path) свойство (Name) со значением (Value) <br> <code>Set-ItemProperty -Path $reg_path -Name "Reply-Forward Signature" -Value $sig_name</code></p> <pre class=z-code><code><span class="z-text z-plain">Windows Registry Editor Version 5.00
</span><span class="z-text z-plain">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\taskmgr.exe]
</span><span class="z-text z-plain">"Debugger"="\"C:\\Windows\\System32\\Taskmgr.exe\""
</span></code></pre> <h2 id=performance><a aria-label="Anchor link for: performance" class=zola-anchor href=#performance><i class=icon></i></a> Performance</h2> <p><code>lodctr /R</code> пересоздать счетчиков производительности из системного хранилища архивов (так же исправляет счетчики для CIM, например, для cpu Win32_PerfFormattedData_PerfOS_Processor и iops Win32_PerfFormattedData_PerfDisk_PhysicalDisk) <br> <code>(Get-Counter -ListSet *).CounterSetName</code> вывести список всех доступных счетчиков производительности в системе <br> <code>(Get-Counter -ListSet *memory*).Counter</code> поиск по wildcard-имени во всех счетчиках (включая дочернии) <br> <code>Get-Counter "\Memory\Available MBytes"</code> объем свободной оперативной памяти <br> <code>Get-Counter -cn $srv "\LogicalDisk(*)\% Free Space"</code> % свободного места на всех разделах дисков <br> <code>(Get-Counter "\Process(*)\ID Process").CounterSamples</code> <br> <code>Get-Counter "\Processor(_Total)\% Processor Time" –ComputerName $srv -MaxSamples 5 -SampleInterval 2</code> 5 проверок каждые 2 секунды <br> <code>Get-Counter "\Процессор(_Total)\% загруженности процессора" -Continuous</code> непрерывно <br> <code>(Get-Counter "\Процессор(*)\% загруженности процессора").CounterSamples</code></p> <p><code>(Get-Counter -ListSet *интерфейс*).Counter</code> найти все счетчики <br> <code>Get-Counter "\Сетевой интерфейс(*)\Всего байт/с"</code> отобразить все адаптеры (выбрать действующий по трафику)</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WARNING</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">25</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CRITICAL</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">50</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TransferRate</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Counter</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\\huawei-mb-x-pro\сетевой интерфейс(intel[r] wi-fi 6e ax211 160mhz)\всего байт/с<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.countersamples <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>ExpandProperty CookedValue</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">*</span><span class="z-constant z-numeric z-integer z-powershell">8</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NetworkUtilisation</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">math</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::round<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TransferRate</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">1000000000</span><span class="z-keyword z-operator z-assignment z-powershell">*</span><span class="z-constant z-numeric z-integer z-powershell">100</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NetworkUtilisation</span> <span class="z-keyword z-operator z-comparison z-powershell">-gt</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CRITICAL</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Write-Output</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>CRITICAL: <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NetworkUtilisation</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> % Network utilisation, <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TransferRate<span class="z-variable z-other z-member z-powershell">.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>N0<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> b/s<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>   
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>exit 2		<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NetworkUtilisation</span> <span class="z-keyword z-operator z-comparison z-powershell">-gt</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WARNING</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Write-Output</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>WARNING: <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NetworkUtilisation</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> % Network utilisation, <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TransferRate<span class="z-variable z-other z-member z-powershell">.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>N0<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> b/s<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>exit 1<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Output</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>OK: <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NetworkUtilisation</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> % Network utilisation, <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TransferRate<span class="z-variable z-other z-member z-powershell">.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>N0<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> b/s<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>   
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>exit 0<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <h2 id=snmp><a aria-label="Anchor link for: snmp" class=zola-anchor href=#snmp><i class=icon></i></a> SNMP</h2> <h3 id=setup-snmp-service><a aria-label="Anchor link for: setup-snmp-service" class=zola-anchor href=#setup-snmp-service><i class=icon></i></a> Setup SNMP Service</h3> <p><code>Install-WindowsFeature SNMP-Service,SNMP-WMI-Provider -IncludeManagementTools</code> установить роль SNMP и WMI провайдер через Server Manager <br> <code>Get-WindowsFeature SNMP*</code> <br> <code>Add-WindowsCapability -Online -Name SNMP.Client~~~~0.0.1.0</code> установить компонент Feature On Demand для Windows 10/11<code>\</code>Get-Service SNMP*<code>\</code>Get-NetFirewallrule -DisplayName <em>snmp</em> | ft<code>\</code>Get-NetFirewallrule -DisplayName <em>snmp</em> | Enable-NetFirewallRule`</p> <h3 id=setting-snmp-service-via-regedit><a aria-label="Anchor link for: setting-snmp-service-via-regedit" class=zola-anchor href=#setting-snmp-service-via-regedit><i class=icon></i></a> Setting SNMP Service via Regedit</h3> <p>Agent: <br> <code>New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\RFC1156Agent" -Name "sysContact" -Value "lifailon-user"</code> создать (New) или изменить (Set) <br> <code>New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\RFC1156Agent" -Name "sysLocation" -Value "plex-server"</code></p> <p>Security: <br> <code>New-Item -Path "HKLM:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\public"</code> создать новый community string <br> <code>New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\SNMP\Parameters\ValidCommunities" -Name "public" -Value 16</code> назначить права на public <br> <code>1 — NONE</code> <br> <code>2 — NOTIFY</code> позволяет получать SNMP ловушки <br> <code>4 — READ ONLY</code> позволяет получать данные с устройства <br> <code>8 — READ WRITE</code> позволяет получать данные и изменять конфигурацию устройства <br> <code>16 — READ CREATE</code> позволяет читать данные, изменять и создавать объекты <br> <code>New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\SNMP\Parameters\PermittedManagers" -Name "1" -Value "192.168.3.99"</code> от кого разрешено принимать запросы <br> <code>Get-Service SNMP | Restart-Service</code></p> <h3 id=snmpwalk><a aria-label="Anchor link for: snmpwalk" class=zola-anchor href=#snmpwalk><i class=icon></i></a> snmpwalk</h3> <p><code>snmpwalk -v 2c -c public 192.168.3.100</code> <br> <code>snmpwalk -v 2c -c public -O e 192.168.3.100</code></p> <h3 id=snmp-modules><a aria-label="Anchor link for: snmp-modules" class=zola-anchor href=#snmp-modules><i class=icon></i></a> SNMP Modules</h3> <p><code>Install-Module -Name SNMP</code> <br> <code>Get-SnmpData -IP 192.168.3.100 -OID 1.3.6.1.2.1.1.4.0 -UDPport 161 -Community public</code> <br> <code>(Get-SnmpData -IP 192.168.3.100 -OID 1.3.6.1.2.1.1.4.0).Data</code> <br> <code>Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.1</code> пройтись по дереву OID <br> <code>Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.25.6.3.1.2</code> список установленного ПО <br> <code>Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.25.2.3.1</code> список разделов и памяти (C: D: Virtual Memory и Physical Memory) <br> <code>Set-SnmpData</code> изменение данных на удаленном устройстве</p> <p><code>Install-Module -Name SNMPv3</code> <br> <code>Invoke-SNMPv3Get</code> получение данных по одному OID <br> <code>Invoke-SNMPv3Set</code> изменение данных <br> <code>Invoke-SNMPv3Walk</code> обход по дереву OID <br> <code>Invoke-SNMPv3Walk -UserName lifailon -Target 192.168.3.100 -AuthSecret password -PrivSecret password -OID 1.3.6.1.2.1.1 -AuthType MD5 -PrivType AES128</code></p> <h3 id=lextm-sharpsnmplib><a aria-label="Anchor link for: lextm-sharpsnmplib" class=zola-anchor href=#lextm-sharpsnmplib><i class=icon></i></a> Lextm.SharpSnmpLib</h3> <p><a href="https://learn.microsoft.com/ru-ru/powershell/dsc/reference/resources/windows/fileresource?view=dsc-1.1">Синтаксис</a> <br> <a href=https://api.nuget.org/v3-flatcontainer/lextm.sharpsnmplib/12.5.2/lextm.sharpsnmplib.12.5.2.nupkg>Download lib</a></p> <p><code>Add-Type -LiteralPath "$home\Desktop\lextm.sharpsnmplib-12.5.2\net471\SharpSnmpLib.dll"</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">161</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OID</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>1.3.6.1.2.1.1.4.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>variableList</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.Variable</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>variableList<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.Variable</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::new<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.ObjectIdentifier</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::new<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OID</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeout</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">3000</span>
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Net.IPAddress</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.100<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>endpoint</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> Net.IpEndPoint <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Community</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>public<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.VersionCode</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Version</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>V2<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>message</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.Messaging.Messenger</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Get<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Version</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>endpoint</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Community</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>variableList</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TimeOut</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>message<span class="z-variable z-other z-member z-powershell">.Data.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=walk><a aria-label="Anchor link for: walk" class=zola-anchor href=#walk><i class=icon></i></a> Walk</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.ObjectIdentifier</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OID</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>1.3.6.1.2.1.1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> дерево или конечный OID<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WalkMode</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.Messaging.WalkMode</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::WithinSubtree <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> режим обхода по дереву<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.Variable</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>message</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.Messaging.Messenger</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Walk<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Version</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>endpoint</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Community</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OID</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TimeOut</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WalkMode</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results2</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>d</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results2</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>ID<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>d<span class="z-variable z-other z-member z-powershell">.id.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Data<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>d<span class="z-variable z-other z-member z-powershell">.Data.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> перекодировать вывод построчно в строку<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results2</span>
</span></code></pre> <h2 id=zabbix><a aria-label="Anchor link for: zabbix" class=zola-anchor href=#zabbix><i class=icon></i></a> Zabbix</h2> <h3 id=zabbix-agent><a aria-label="Anchor link for: zabbix-agent" class=zola-anchor href=#zabbix-agent><i class=icon></i></a> Zabbix Agent</h3> <p><strong>Zabbix Agent Deploy:</strong></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://cdn.zabbix.com/zabbix/binaries/stable/6.4/6.4.5/zabbix_agent2-6.4.5-windows-amd64-static.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\zabbix-agent2-6.4.5.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WebClient</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Net.WebClient
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WebClient<span class="z-variable z-other z-member z-powershell">.DownloadFile</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> скачать файл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>DestinationPath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\zabbix-agent2-6.4.5\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> разархивировать<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> удалить архив<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-NetFirewallRule</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>DisplayName <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Zabbix-Agent<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Profile Any <span class="z-keyword z-operator z-assignment z-powershell">-</span>Direction Inbound <span class="z-keyword z-operator z-assignment z-powershell">-</span>Action Allow <span class="z-keyword z-operator z-assignment z-powershell">-</span>Protocol TCP <span class="z-keyword z-operator z-assignment z-powershell">-</span>LocalPort <span class="z-constant z-numeric z-integer z-powershell">10050</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">10051</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> открыть порты в FW<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Zabbix_Server</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.102<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conf</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.conf<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cat</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> cat <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conf</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rep</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cat</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Server=.+<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Server=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Zabbix_Server</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rep</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-String</span> Server<span class="z-keyword z-operator z-assignment z-powershell">=</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rep</span> <span class="z-keyword z-operator z-redirection z-powershell">></span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conf</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>exe</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\zabbix-agent2-6.4.5\bin\zabbix_agent2.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell">.<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>exe</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>config <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>conf</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>install <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> установить службу<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-Service</span> <span class="z-keyword z-operator z-assignment z-powershell">*</span>Zabbix<span class="z-keyword z-operator z-assignment z-powershell">*</span>Agent<span class="z-keyword z-operator z-assignment z-powershell">*</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Start-Service</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> запустить службу<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>.$exe --config $conf --uninstall # удалить службу<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <p><strong>zabbix_agent2.conf</strong></p> <pre class="language-conf z-code" data-lang=conf><code class=language-conf data-lang=conf><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Агент может работать в пассивном (сервер забирает сам информацию) и активном режиме (агент сам отправляет):
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">Server</span><span class="z-keyword z-operator z-genconfig">=</span></span><span class="z-meta z-ip z-genconfig"><span class="z-constant z-other z-genconfig">192.168.3.102</span></span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">ServerActive</span><span class="z-keyword z-operator z-genconfig">=</span></span><span class="z-meta z-ip z-genconfig"><span class="z-constant z-other z-genconfig">192.168.3.102</span></span>
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Требуется указать hostname для ServerActive:
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">Hostname</span><span class="z-keyword z-operator z-genconfig">=</span></span>huawei<span class="z-keyword z-operator z-genconfig">-</span>book<span class="z-keyword z-operator z-genconfig">-</span><span class="z-constant z-numeric z-genconfig">01</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Если не указано, используется для генерации имени хоста (игнорируется, если имя хоста определено):
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># HostnameItem=system.hostname
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Как часто обновляется список активных проверок, в секундах (Range: 60-3600):
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">RefreshActiveChecks</span><span class="z-keyword z-operator z-genconfig">=</span></span><span class="z-constant z-numeric z-genconfig">120</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># IP-адрес источника для исходящих соединений:
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># SourceIP=
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Агент будет слушать на этом порту соединения с сервером (Range: 1024-32767):
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># ListenPort=10050
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Список IP-адресов, которые агент должен прослушивать через запятую
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># ListenIP=0.0.0.0
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Агент будет прослушивать этот порт для запросов статуса HTTP (Range: 1024-32767):
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># StatusPort=
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">ControlSocket</span><span class="z-keyword z-operator z-genconfig">=</span></span><span class="z-keyword z-operator z-genconfig">\</span><span class="z-keyword z-operator z-genconfig">\</span><span class="z-keyword z-operator z-genconfig">.</span><span class="z-keyword z-operator z-genconfig">\</span>pipe<span class="z-keyword z-operator z-genconfig">\</span>agent<span class="z-keyword z-operator z-genconfig">.</span>sock
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Куда вести журнал (file/syslog/console):
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">LogType</span><span class="z-keyword z-operator z-genconfig">=</span></span>file
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">LogFile</span><span class="z-keyword z-operator z-genconfig">=</span></span><span class="z-support z-constant z-genconfig">C</span><span class="z-keyword z-operator z-genconfig">:</span><span class="z-keyword z-operator z-genconfig">\</span>zabbix<span class="z-keyword z-operator z-genconfig">-</span>agent2<span class="z-keyword z-operator z-genconfig">-</span><span class="z-constant z-numeric z-genconfig">6</span><span class="z-keyword z-operator z-genconfig">.</span><span class="z-constant z-numeric z-genconfig">4</span><span class="z-keyword z-operator z-genconfig">.</span><span class="z-constant z-numeric z-genconfig">5</span><span class="z-keyword z-operator z-genconfig">\</span>zabbix_agent2<span class="z-keyword z-operator z-genconfig">.</span>log
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Размер лога от 0-1024 MB (0 - отключить автоматическую ротацию логов)
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">LogFileSize</span><span class="z-keyword z-operator z-genconfig">=</span></span><span class="z-constant z-numeric z-genconfig">100</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Уровень логирования. 4 - для отладки (выдает много информации)
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">DebugLevel</span><span class="z-keyword z-operator z-genconfig">=</span></span><span class="z-constant z-numeric z-genconfig">4</span>
</span></code></pre> <h3 id=zabbix-sender><a aria-label="Anchor link for: zabbix-sender" class=zola-anchor href=#zabbix-sender><i class=icon></i></a> Zabbix Sender</h3> <p>Используется для отправки данных на сервер</p> <p>Создать host - задать произвольное имя (powershell-host) и добавить в группу на сервере</p> <p>Создать Items вручную:</p> <p><code>Name</code>: Service Count <br> <code>Type</code>: Zabbix trapper <br> <code>Key</code>: service.count <br> <code>Type of Information</code>: Numeric</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\zabbix-agent2-6.4.5\bin<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>scount</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Service</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Count
</span><span class="z-source z-powershell">.<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>\<span class="z-support z-function z-powershell">zabbix_sender.exe</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>z <span class="z-constant z-numeric z-integer z-powershell">192.168</span>.<span class="z-constant z-numeric z-integer z-powershell">3.102</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>s <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>powershell-host<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>k service.count <span class="z-keyword z-operator z-assignment z-powershell">-</span>o <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>scount</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> отправить данные на сервер<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <h3 id=zabbix-get><a aria-label="Anchor link for: zabbix-get" class=zola-anchor href=#zabbix-get><i class=icon></i></a> Zabbix Get</h3> <p>Используется для получения данных с агента (как их запрашивает сервер)</p> <p><code>apt install zabbix-get</code> <br> <code>nano /etc/zabbix/zabbix_agentd.conf</code> <br> <code>Server=127.0.0.1,192.168.3.102,192.168.3.99</code> добавить сервера для получения данных через zabbix_get с агента (как их запрашивает сервер)</p> <p><code>.$path\zabbix_get -s 192.168.3.101 -p 10050 -k agent.version</code> проверить версию агента <br> <code>.$path\zabbix_get -s 192.168.3.101 -p 10050 -k agent.ping</code> 1 - ok <br> <code>.$path\zabbix_get -s 192.168.3.101 -p 10050 -k net.if.discovery</code> список сетевых интерфейсов <br> <code>.$path\zabbix_get -s 192.168.3.101 -p 10050 -k net.if.in["ens33"]</code> <br> <code>.$path\zabbix_get -s 192.168.3.101 -p 10050 -k net.if.out["ens33"]</code></p> <h3 id=userparameter><a aria-label="Anchor link for: userparameter" class=zola-anchor href=#userparameter><i class=icon></i></a> UserParameter</h3> <p>Пользовательские параметры</p> <p><code>UserParameter=process.count,powershell -Command "(Get-Process).Count"</code> <br> <code>UserParameter=process.vm[*],powershell -Command "(Get-Process $1).ws"</code></p> <p>Получение данных:</p> <p><code>C:\zabbix-agent2-6.4.5\bin\zabbix_get.exe -s 127.0.0.1 -p 10050 -k process.count</code> <br> <code>C:\zabbix-agent2-6.4.5\bin\zabbix_get.exe -s 127.0.0.1 -p 10050 -k process.vm[zabbix_agent2] </code><br> <code>C:\zabbix-agent2-6.4.5\bin\zabbix_get.exe -s 127.0.0.1 -p 10050 -k process.vm[powershell]</code></p> <p>Создать новые Items на сервере:</p> <p>key: <code>process.count</code> <br> key: <code>process.vm[zabbix_agent2]</code></p> <h3 id=include-plugins><a aria-label="Anchor link for: include-plugins" class=zola-anchor href=#include-plugins><i class=icon></i></a> Include Plugins</h3> <ul><li>Добавить параметр Include для включения конфигурационных файлов подключаемых плагинов</ul> <p><code>'Include=.\zabbix_agent2.d\plugins.d\*.conf' >> C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.conf</code></p> <ul><li>Создать конфигурационный файл с пользовательскими параметрами в каталоге, путь к которому указан в zabbix_agentd.conf</ul> <p><code>'UserParameter=Get-Query-Param[*],powershell.exe -noprofile -executionpolicy bypass -File C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.d\scripts\User-Sessions\Get-Query-Param.ps1 $1' > C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.d\plugins.d\User-Sessions.conf</code></p> <ul><li>Поместить скрипт Get-Query-Param.ps1 в каталог, путь к которому указан в User-Sessions.conf. Скрипт содержим пользовательские параметры, которые он принимает от Zabbix сервера для передачи их в функции скрипта.</ul> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">Param</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ACTIVEUSER<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Query</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">where</span> status <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Active<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.User
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>INACTIVEUSER<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Query</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">where</span> status <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Disconnect<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.User
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ACTIVECOUNT<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Query</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">where</span> status <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Active<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Status.Count
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>INACTIVECOUNT<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Query</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">where</span> status <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Disconnect<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Status.Count
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <ul><li>Проверить работу скрипта:</ul> <p><code>$path = "C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.d\scripts\User-Sessions"</code> <br> <code>.$path\Get-Query-Param.ps1 ACTIVEUSER</code> <br> <code>.$path\Get-Query-Param.ps1 INACTIVEUSER</code> <br> <code>.$path\Get-Query-Param.ps1 ACTIVECOUNT</code> <br> <code>.$path\Get-Query-Param.ps1 INACTIVECOUNT</code></p> <ul><li>Создать Items с ключами:</ul> <p><code>Get-Query-Param[ACTIVEUSER]</code> Type: Text <br> <code>Get-Query-Param[INACTIVEUSER]</code> Type: Text <br> <code>Get-Query-Param[ACTIVECOUNT]</code> Type: Int <br> <code>Get-Query-Param[INACTIVECOUNT]</code> Type: Int</p> <ul><li>Макросы:</ul> <p><code>{$ACTIVEMAX} = 16</code> <br> <code>{$ACTIVEMIN} = 0</code></p> <ul><li>Триггеры:</ul> <p><code>last(/Windows-User-Sessions/Get-Query-Param[ACTIVECOUNT])>{$ACTIVEMAX}</code> <br> <code>min(/Windows-User-Sessions/Get-Query-Param[ACTIVECOUNT],24h)={$ACTIVEMIN}</code></p> <h3 id=zabbix-api><a aria-label="Anchor link for: zabbix-api" class=zola-anchor href=#zabbix-api><i class=icon></i></a> Zabbix API</h3> <p><a href=https://www.zabbix.com/documentation/current/en/manual/api/reference>Documentation</a></p> <p><code>$ip = "192.168.3.102"</code> <br> <code>$url = "http://$ip/zabbix/api_jsonrpc.php"</code></p> <p>Получение токена доступа:</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>jsonrpc<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>2.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>method<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>user.login<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>params<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>username<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Admin<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> в версии до 6.4 параметр "user"<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>password<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>zabbix<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>id<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>token</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ContentType <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Result
</span></code></pre> <p><code>$token = "2eefd25fdf1590ebcdb7978b5bcea1fff755c65b255da8cbd723181b639bb789"</code> сгенерировать токен в UI (http://192.168.3.102/zabbix/zabbix.php?action=token.list)</p> <ul><li>user.get method</ul> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>jsonrpc<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>2.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>method<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>user.get<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>params<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>auth<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>token</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>id<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>users</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ContentType <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Result
</span></code></pre> <ul><li>problem.get method</ul> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>jsonrpc<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>2.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>method<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>problem.get<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>params<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>auth<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>token</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>id<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ContentType <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Result
</span></code></pre> <ul><li>host.get method</ul> <p>Получить список всех хостов (имя и id)</p> <p><a href=https://www.zabbix.com/documentation/current/en/manual/api/reference/host>Endpoint host documentation</a></p> <p><strong>host.create</strong> — создание новых хостов <br> <strong>host.delete</strong> — удаление хостов <br> <strong>host.get</strong> — получить список хостов <br> <strong>host.massadd</strong> - добавление (привязка) объектов на хосты <br> <strong>host.massremove</strong> - удаление объектов <br> <strong>host.massupdate</strong> - замена или обновление объектов <br> <strong>host.update</strong> - обновление хостов</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>jsonrpc<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>2.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>method<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>host.get<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>params<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>output<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> отфильтровать вывод<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>hostid<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>host<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell">        <span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>id<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>auth<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>token</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>hosts</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ContentType <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Result
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>host_id</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>hosts</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.hostid <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> забрать id хоста по индексу<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <ul><li>item.get</ul> <p>Получить id элементов данных по наименованию ключа для конкретного хоста</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>jsonrpc<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>2.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>method<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>item.get<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>params<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>hostids<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>host_id</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> отфильтровать по хосту<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>auth<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>token</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>id<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ContentType <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Result
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items_id</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">where</span> key_ <span class="z-keyword z-operator z-comparison z-powershell">-match</span> system.uptime</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.itemid <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> забрать id элемента данных<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <ul><li>history.get</ul> <p>Получить всю историю элемента данных по его id</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>jsonrpc<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>2.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>method<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>history.get<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>params<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>hostids<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>host_id</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>  <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> фильтрация по хосту<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>itemids<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items_id</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> фильтрация по элементу данных<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>auth<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>token</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>id<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items_data_uptime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ContentType <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Result <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> получить все данные по ключу у конкретного хоста<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <p>Ковенртация секунд в <code>TimeSpan</code>:</p> <p><code>$sec = $items_data_uptime.value</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertSecondsTo-TimeSpan</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>insec</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TimeSpan</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">TimeSpan</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::fromseconds<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>insec</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0:dd' day 'hh\:mm\:ss}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TimeSpan</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>$UpTime = ConvertSecondsTo-TimeSpan $sec[-1]</code></p> <p>Конвертация из времени <code>Unix</code>:</p> <p><code>$time = $items_data_uptime.clock</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertFrom-UnixTime</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>intime</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EpochTime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">DateTime</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>1/1/1970<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TimeZone</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-TimeZone</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UTCTime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EpochTime<span class="z-variable z-other z-member z-powershell">.AddSeconds</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>intime</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UTCTime<span class="z-variable z-other z-member z-powershell">.AddMinutes</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TimeZone<span class="z-variable z-other z-member z-powershell">.BaseUtcOffset.TotalMinutes</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>$GetDataTime = ConvertFrom-UnixTime $time[-1]</code></p> <p><code>($hosts | where hostid -eq $host_id).host</code> получить имя хоста <br> <code>$UpTime</code> последнее полученное значение времени работы хоста <br> <code>$GetDataTime</code> время последнего полученного значения</p> <h2 id=pki><a aria-label="Anchor link for: pki" class=zola-anchor href=#pki><i class=icon></i></a> pki</h2> <p><code>New-SelfSignedCertificate -CertStoreLocation Cert:\LocalMachine\My -DnsName "$env:computername" -FriendlyName "Test Certificate" -NotAfter (Get-Date).AddYears(5)</code> создать самоподписанный сертификат (в LocalMachine\My - Сертификаты компьютера\Личное) с сроком действия 5 лет</p> <p><code>Get-ChildItem -Path Cert:\CurrentUser\Root\</code> список всех установленных сертификатов в хранилище Доверенные корневые ЦС Текущего пользователя <br> <code>Get-ChildItem -Path Cert:\CurrentUser\My\</code> список самозаверяющих сертификатов в Личное хранилище Текущего пользователя <br> <code>Get-ChildItem -Path Cert:\LocalMachine\My\</code> список самозаверяющих сертификатов в Личное хранилище Локального компьютера <br> <code>Get-ChildItem -Path Cert:\LocalMachine\My\ | select NotBefore,NotAfter,Thumbprint,Subject</code> срок действия сертификата <br> <code>Get-ChildItem -Path Cert:\LocalMachine\My\ | where Thumbprint -eq D9356FB774EE0E6206B7D5B59B99102CA5B17BDA</code> поиск сертификат по отпечатку</p> <p><code>Get-ChildItem -Path $env:APPDATA\Microsoft\SystemCertificates\My\Certificates\</code> сертификаты в файловой системе, каждый файл соответствует сертификату, установленному в личном хранилище текущего пользователя <br> <code>Get-ChildItem -Path $env:APPDATA\Microsoft\SystemCertificates\My\Keys\</code> ссылки на объекты закрытых ключей, созданных поставщиком хранилища ключей (KSP) <br> <code>Get-ChildItem -Path HKCU:\Software\Microsoft\SystemCertificates\CA\Certificates | ft -AutoSize</code> список сертификатов в реестре вошедшего в систему пользователя</p> <p><code>$cert = (Get-ChildItem -Path Cert:\CurrentUser\My\)[1]</code> выбрать сертификат <br> <code>$cert | Remove-Item</code> удалить сертификат</p> <p><code>Export-Certificate -FilePath $home\Desktop\certificate.cer -Cert $cert</code> экспортировать сертификат <br> <code>$cert.HasPrivateKey</code> проверить наличие закрытого ключа <br> <code>$pass = "password" | ConvertTo-SecureString -AsPlainText -Force</code> создать пароль для шифрования закрытого ключа <br> <code>Export-PfxCertificate -FilePath $home\Desktop\certificate.pfx -Password $pass -Cert $certificate</code> экспортировать сертификат с закрытым ключем</p> <p><code>Import-Certificate -FilePath $home\Desktop\certificate.cer -CertStoreLocation Cert:\CurrentUser\My</code> импортировать сертификат <br> <code>Import-PfxCertificate -Exportable -Password $pass -CertStoreLocation Cert:\CurrentUser\My -FilePath $home\Desktop\certificate.pfx</code></p> <h2 id=openssl><a aria-label="Anchor link for: openssl" class=zola-anchor href=#openssl><i class=icon></i></a> OpenSSL</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-WebRequest</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">slproweb.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span>Win64OpenSSL_Light<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">3_1_1.</span>msi <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\OpenSSL<span class="z-keyword z-operator z-assignment z-powershell">-</span>Light<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">3.1</span>.<span class="z-constant z-numeric z-integer z-powershell">1.</span>msi
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Start-Process</span> <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\OpenSSL<span class="z-keyword z-operator z-assignment z-powershell">-</span>Light<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">3.1</span>.<span class="z-constant z-numeric z-integer z-powershell">1.</span>msi <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>/quiet<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Wait<span class="z-keyword z-operator z-other z-powershell">`</span> установить msi пакет в тихом режиме <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">запуск от имени Администратора</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">rm <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\OpenSSL<span class="z-keyword z-operator z-assignment z-powershell">-</span>Light<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">3.1</span>.<span class="z-constant z-numeric z-integer z-powershell">1.</span>msi
</span><span class="z-source z-powershell">cd <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Program Files\OpenSSL-Win64\bin<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre> <ul><li><p>Изменить пароль для PFX <br> <code>openssl pkcs12 -in "C:\Cert\domain.ru.pfx" -out "C:\Cert\domain.ru.pem" -nodes</code> экспортируем имеющийся сертификат и закрытый ключ в .pem-файл без пароля с указанием текущего пароля <br> <code>openssl pkcs12 -export -in "C:\Cert\domain.ru.pem" -out "C:\Cert\domain.ru_password.pfx" -nodes</code> конвертируем .pem обратно в .pfx c указанием нового пароля</p><li><p>Конвертация из закрытого и открытого ключа PEM в PFX <br> <code>openssl pkcs12 -export -in "C:\tmp\vpn\vpn.itproblog.ru-crt.pem" -inkey "C:\tmp\vpn\vpn.itproblog.ru-key.pem" -out "C:\tmp\vpn\vpn.iiproblog.ru.pfx"</code> <br> in – путь до файла с открытым ключом <br> inkey – путь до файла с закрытым ключом <br> out – путь до файла, в который будет конвертирован сертификат (pfx)</p><li><p>Конвертация PFX в CRT <br> <code>openssl pkcs12 -in "C:\OpenSSL-Win64\bin\_.domain.ru.pfx" -clcerts -out "C:\OpenSSL-Win64\bin\_.domain.ru.crt"</code> указывается текущий и 2 раза новый пароль PEM pass phrase (файл содержит EGIN CERTIFICATE и BEGIN ENCRYPTED PRIVATE KEY) <br> <code>openssl pkcs12 -in "C:\OpenSSL-Win64\bin\_.domain.ru.pfx" -clcerts -nokeys -out "C:\OpenSSL-Win64\bin\_.domain.ru.crt"</code> без ключа, получить открытую часть (файл содержит только EGIN CERTIFICATE)</p><li><p>Конвертация PFX в KEY <br> <code>openssl pkcs12 -in "C:\OpenSSL-Win64\bin\_.domain.ru.pfx" -nocerts -out "C:\OpenSSL-Win64\bin\_.domain.ru.key"</code> файл содержит только BEGIN ENCRYPTED PRIVATE KEY</p><li><p>Снять пароль к закрытого ключа .key <br> <code>openssl rsa -in "C:\OpenSSL-Win64\bin\_.domain.ru.key" -out "C:\OpenSSL-Win64\bin\_.domain.ru-decrypted.key"</code></p><li><p>CRT и KEY в PFX: <br> <code>openssl pkcs12 -inkey certificate.key -in certificate.crt -export -out certificate.pfx</code></p></ul> <h2 id=openvpn><a aria-label="Anchor link for: openvpn" class=zola-anchor href=#openvpn><i class=icon></i></a> OpenVPN</h2> <p><code>Invoke-WebRequest -Uri https://swupdate.openvpn.org/community/releases/OpenVPN-2.6.5-I001-amd64.msi -OutFile $home\Downloads\OpenVPN-2.6.5.msi</code> <br> <code>Start-Process $home\Downloads\OpenVPN-2.6.5.msi -ArgumentList '/quiet /SELECT_OPENSSL_UTILITIES=1' -Wait</code> <br> <code>msiexec /i $home\Downloads\OpenVPN-2.6.5.msi ADDLOCAL=EasyRSA /passive /quiet # установить отдельный компонент EasyRSA Certificate Management Scripts</code> <br> <code># msiexec /i $home\Downloads\OpenVPN-2.6.5.msi ADDLOCAL=OpenVPN.Service,Drivers,Drivers.Wintun,OpenVPN,OpenVPN.GUI,OpenVPN.GUI.OnLogon,EasyRSA /passive</code> выборочная установка <br> <code># Invoke-WebRequest -Uri https://github.com/OpenVPN/easy-rsa/releases/download/v3.1.5/EasyRSA-3.1.5-win64.zip -OutFile $home\Downloads\EasyRSA-3.1.5.zip</code> скачать отдельный пакет EasyRSA <br> <code>rm $home\Downloads\OpenVPN-2.6.5.msi</code></p> <p><code>cd "C:\Program Files\OpenVPN\easy-rsa"</code> <br> <code>Copy-Item vars.example vars</code> файл конфигурации для EasyRSA</p> <pre class=z-code><code><span class="z-text z-plain">set_var EASYRSA_TEMP_DIR "$EASYRSA_PKI"
</span><span class="z-text z-plain">set_var EASYRSA_REQ_COUNTRY "RU"
</span><span class="z-text z-plain">set_var EASYRSA_REQ_PROVINCE "MSK"
</span><span class="z-text z-plain">set_var EASYRSA_REQ_CITY "MSK"
</span><span class="z-text z-plain">set_var EASYRSA_REQ_ORG "FAILON.NET"
</span><span class="z-text z-plain">set_var EASYRSA_REQ_EMAIL "lifailon@domain.ru"
</span><span class="z-text z-plain">set_var EASYRSA_REQ_OU "IT"
</span><span class="z-text z-plain">#set_var EASYRSA_KEY_SIZE 2048
</span><span class="z-text z-plain">#set_var EASYRSA_CA_EXPIRE 3650
</span><span class="z-text z-plain">#set_var EASYRSA_CERT_EXPIRE 825
</span></code></pre> <p><code>.\EasyRSA-Start.bat</code> среда EasyRSA Shell <br> <code>easyrsa init-pki</code> инициализация PKI, создает директорию: C:\Program Files\OpenVPN\easy-rsa\pki и читает переменные файла \easy-rsa\vars <br> <code>easyrsa build-ca</code> генерация корневого CA с указанием пароля и произвольное имя сервера (\pki\ca.crt и \pki\private\ca.key) <br> <code>easyrsa gen-req server nopass</code> генерация запроса сертификата и ключ для сервера OpenVPN - yes (\pki\reqs\server.req и \pki\private\server.key) <br> <code>easyrsa sign-req server server</code> подписать запрос на выпуск сертификата сервера с помощью CA - yes (\pki\issued\server.crt) <br> <code>easyrsa gen-dh</code> создать ключ Диффи-Хеллмана (\pki\dh.pem) <br> <code>easyrsa gen-req client1</code> nopass<code> генерация запроса сертификата и ключ для клиента OpenVPN (\pki\reqs\client1.req и \pki\private\client1.key)</code> <br> <code>easyrsa sign-req client client1</code> подписать запрос на выпуск сертификата клиента с помощью CA - yes (\pki\issued\client1.crt) <br> <code>easyrsa revoke client1</code> отозвать сертификат пользователя <br> <code>openssl rsa -in "C:\Program Files\OpenVPN\easy-rsa\pki\private\client1.key" -out "C:\Program Files\OpenVPN\easy-rsa\pki\private\client1_nopass.key"</code> снять защиту паролем для ключа (BEGIN ENCRYPTED PRIVATE KEY -> BEGIN PRIVATE KEY) <br> <code>exit</code> <br> <code>cd "C:\Program Files\OpenVPN\bin"</code> <br> <code>.\openvpn --genkey secret ta.key</code> генерация ключа tls-auth (\bin\ta.key) <br> <code>Move-Item "C:\Program Files\OpenVPN\bin\ta.key" "C:\Program Files\OpenVPN\easy-rsa\pki\"</code></p> <h3 id=server-ovpn><a aria-label="Anchor link for: server-ovpn" class=zola-anchor href=#server-ovpn><i class=icon></i></a> server.ovpn</h3> <p><code># Copy-Item "C:\Program Files\OpenVPN\sample-config\server.ovpn" "C:\Program Files\OpenVPN\config-auto\server.ovpn"</code> <br> <code>New-Item -ItemType File -Path "C:\Program Files\OpenVPN\config-auto\server.ovpn"</code></p> <pre class="language-ini z-code" data-lang=ini><code class=language-ini data-lang=ini><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">port</span> </span><span class="z-constant z-numeric z-genconfig">1194</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">proto</span> </span>udp
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Что именно инкапсулировать в туннеле (ethernet фреймы - tap или ip пакеты - tun)
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">dev</span> </span>tun
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">ca</span> </span><span class="z-string z-quoted z-double z-genconfig">"C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\ca.crt"</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">cert</span> </span><span class="z-string z-quoted z-double z-genconfig">"C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\issued\\server.crt"</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">key</span> </span><span class="z-string z-quoted z-double z-genconfig">"C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\private\\server.key"</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">dh</span> </span><span class="z-string z-quoted z-double z-genconfig">"C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\dh.pem"</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">server</span> </span><span class="z-meta z-ip z-genconfig"><span class="z-constant z-other z-genconfig">192.168.4.0</span></span> <span class="z-meta z-ip z-genconfig"><span class="z-constant z-other z-genconfig">255.255.255.0</span></span>
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Хранит список сопоставления ip для клиентов, что бы назначить тот же адрес при перезапуске сервера
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># ifconfig-pool-persist "C:\\Program Files\\OpenVPN\\dhcp-client-list.txt"
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Разрешить клиентам подключаться под одним ключом
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># duplicate-cn
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># max-clients 30
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Разрешить обмен трафиком между клиентами
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">client-to-client</span>
</span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># compress
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">tls-auth</span> </span><span class="z-string z-quoted z-double z-genconfig">"C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\ta.key"</span> <span class="z-constant z-numeric z-genconfig">0</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">cipher</span> </span><span class="z-support z-constant z-genconfig">AES</span><span class="z-keyword z-operator z-genconfig">-</span><span class="z-constant z-numeric z-genconfig">256</span><span class="z-keyword z-operator z-genconfig">-</span><span class="z-support z-constant z-genconfig">GCM</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">keepalive</span> </span><span class="z-constant z-numeric z-genconfig">20</span> <span class="z-constant z-numeric z-genconfig">60</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Не перечитавать файлы ключей при перезапуске туннеля
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">persist-key</span>
</span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Оставляет без изменения устройства tun/tap при перезапуске OpenVPN
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">persist-tun</span>
</span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">status</span> </span><span class="z-string z-quoted z-double z-genconfig">"C:\\Program Files\\OpenVPN\\log\\status.log"</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">log</span> </span><span class="z-string z-quoted z-double z-genconfig">"C:\\Program Files\\OpenVPN\\log\\openvpn.log"</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">verb</span> </span><span class="z-constant z-numeric z-genconfig">3</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">mute</span> </span><span class="z-constant z-numeric z-genconfig">20</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">windows-driver</span> </span>wintun
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Открыть доступ к подсети за сервером
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">push</span> </span><span class="z-string z-quoted z-double z-genconfig">"route 192.168.3.0 255.255.255.0"</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">push</span> </span><span class="z-string z-quoted z-double z-genconfig">"route 192.168.4.0 255.255.255.0"</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Завернуть все запросы клиента (в том числе Интернет трафик) на OpenVPN сервер
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># push "redirect-gateway def1"
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># push "dhcp-option DNS 192.168.3.101"
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># push "dhcp-option DOMAIN failon.net"
</span></span></span></code></pre> <p><code>New-NetFirewallRule -DisplayName "AllowOpenVPN-In" -Direction Inbound -Protocol UDP –LocalPort 1194 -Action Allow</code> на сервере <br> <code>New-NetFirewallRule -DisplayName "AllowOpenVPN-Out" -Direction Outbound -Protocol UDP –LocalPort 1194 -Action Allow</code> на клиенте <br> <code>Get-Service *openvpn* | Restart-Service</code></p> <h3 id=client-ovpn><a aria-label="Anchor link for: client-ovpn" class=zola-anchor href=#client-ovpn><i class=icon></i></a> client.ovpn</h3> <p><code># Copy-Item "C:\Program Files\OpenVPN\sample-config\client.ovpn" "C:\Program Files\OpenVPN\config-auto\client.ovpn"</code> <br> <code>New-Item -ItemType File -Path "C:\Program Files\OpenVPN\config-auto\client.ovpn"</code></p> <pre class="language-ini z-code" data-lang=ini><code class=language-ini data-lang=ini><span class="z-source z-genconfig"><span class="z-storage z-type z-genconfig">client
</span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">dev</span> </span>tun
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">proto</span> </span>udp
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">remote</span> </span><span class="z-meta z-ip z-genconfig"><span class="z-constant z-other z-genconfig">26.115.154.67</span></span> <span class="z-constant z-numeric z-genconfig">1194</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">resolv-retry</span> </span>infinite
</span><span class="z-source z-genconfig"><span class="z-storage z-type z-genconfig">nobind
</span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">persist-key</span>
</span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">persist-tun</span>
</span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">ca</span> </span>ca<span class="z-keyword z-operator z-genconfig">.</span>crt
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">cert</span> </span>client1<span class="z-keyword z-operator z-genconfig">.</span>crt
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">key</span> </span>client1<span class="z-keyword z-operator z-genconfig">.</span>key
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">remote-cert-tls</span> </span>server
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">tls-auth</span> </span>ta<span class="z-keyword z-operator z-genconfig">.</span>key <span class="z-constant z-numeric z-genconfig">1</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">cipher</span> </span><span class="z-support z-constant z-genconfig">AES</span><span class="z-keyword z-operator z-genconfig">-</span><span class="z-constant z-numeric z-genconfig">256</span><span class="z-keyword z-operator z-genconfig">-</span><span class="z-support z-constant z-genconfig">GCM</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">connect-retry-max</span> </span><span class="z-constant z-numeric z-genconfig">25</span>
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig"><span class="z-comment z-line z-number-sign z-genconfig"># Использовать драйвер wintun и полный путь до сертификатов при использовании openvpn gui
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">windows-driver</span> </span>wintun
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig"><span class="z-variable z-parameter z-genconfig">verb</span> </span><span class="z-constant z-numeric z-genconfig">3</span>
</span></code></pre> <h3 id=client-1><a aria-label="Anchor link for: client-1" class=zola-anchor href=#client-1><i class=icon></i></a> Client</h3> <p><code>iwr -Uri https://openvpn.net/downloads/openvpn-connect-v3-windows.msi -OutFile "$home\downloads\OpenVPN-Connect-3.msi"</code> <br> Передать конфигурацию и ключи: <br> <code>client.ovpn</code> <br> <code>ca.crt</code> <br> <code>dh.pem</code> <br> <code>ta.key</code> <br> <code>client1.crt</code> <br> <code>client1.key</code></p> <h2 id=route><a aria-label="Anchor link for: route" class=zola-anchor href=#route><i class=icon></i></a> Route</h2> <p><code>Get-Service RemoteAccess | Stop-Service</code> <br> <code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters" -Name "IPEnableRouter" -Value 1</code> включает IP маршрутизацию <br> <code>(Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters").IPEnableRouter</code> <br> <code>Get-NetIPInterface | select ifIndex,InterfaceAlias,AddressFamily,ConnectionState,Forwarding | ft</code> отобразить сетевые интерфейсы <br> <code>Set-NetIPInterface -ifIndex 13 -Forwarding Enabled</code> включить переадресацию на интерфейсе</p> <p><code>sysctl net.ipv4.ip_forward=1</code> <br> <code>echo "sysctl net.ipv4.ip_forward = 1" >> /etc/sysctl.conf</code></p> <p><code>Get-NetRoute</code> <br> <code>New-NetRoute -DestinationPrefix "192.168.3.0/24" -NextHop "192.168.4.1" -InterfaceIndex 8</code> <br> <code>route -p add 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 1</code> <br> <code>route -p change 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 2</code> <br> <code>route -p add 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 1 if 7</code> указать номер сетевого интерфейса на который необходимо посылать пакет (Wintun Userspace Tunnel) <br> <code>route print -4</code> <br> <code>route delete 192.168.3.0</code></p> <p><code>tracert 192.168.3.101</code> с 192.168.4.6</p> <pre class=z-code><code><span class="z-text z-plain">1    17 ms     *       22 ms  192.168.4.1
</span><span class="z-text z-plain">2    12 ms    13 ms    14 ms  192.168.3.101
</span></code></pre> <p><code>route add -net 192.168.4.0 netmask 255.255.255.0 gw 192.168.3.100</code> <br> <code>route -e</code></p> <p><code>traceroute 192.168.4.6</code> с 192.168.3.101</p> <pre class=z-code><code><span class="z-text z-plain">1  192.168.3.100 (192.168.3.100)  0.148 ms  0.110 ms  0.106 ms
</span><span class="z-text z-plain">2  192.168.4.6 (192.168.4.6)  14.573 ms * *
</span></code></pre> <p><code>ping 192.168.3.101 -t</code> с 192.168.4.6 <br> <code>tcpdump -n -i ens33 icmp</code> на 192.168.3.101</p> <pre class=z-code><code><span class="z-text z-plain">14:36:34.533771 IP 192.168.4.6 > 192.168.3.101: ICMP echo request, id 1, seq 2962, length 40 # отправил запрос
</span><span class="z-text z-plain">14:36:34.533806 IP 192.168.3.101 > 192.168.4.6: ICMP echo reply, id 1, seq 2962, length 40 # отправил ответ
</span></code></pre> <h2 id=nat><a aria-label="Anchor link for: nat" class=zola-anchor href=#nat><i class=icon></i></a> NAT</h2> <p><code>Get-Command -Module NetNat</code> <br> <code>New-NetNat -Name LocalNat -InternalIPInterfaceAddressPrefix "192.168.3.0/24"</code> <br> <code>Add-NetNatStaticMapping -NatName LocalNat -Protocol TCP -ExternalIPAddress 0.0.0.0 -ExternalPort 80 -InternalIPAddress 192.168.3.102 -InternalPort 80</code> <br> <code>Remove-NetNatStaticMapping -StaticMappingID 0</code> <br> <code>Remove-NetNat -Name LocalNat</code></p> <h2 id=wireguard><a aria-label="Anchor link for: wireguard" class=zola-anchor href=#wireguard><i class=icon></i></a> WireGuard</h2> <p><code>Invoke-WebRequest "https://download.wireguard.com/windows-client/wireguard-amd64-0.5.3.msi" -OutFile "$home\Downloads\WireGuard-Client-0.5.3.msi"</code> <br> <code>msiexec.exe /i "$home\Downloads\WireGuard-Client-0.5.3.msi" DO_NOT_LAUNCH=1 /qn</code> <br> <code>Invoke-WebRequest "http://www.wiresock.net/downloads/wiresock-vpn-gateway-x64-1.1.4.1.msi" -OutFile "$home\Downloads\WireSock-VPN-Gateway-1.1.4.1.msi"</code> <br> <code>msiexec.exe /i "http://www.wiresock.net/downloads/wiresock-vpn-gateway-x64-1.1.4.1.msi" /qn</code> <br> <code>$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")</code> <br> <code>wg-quick-config -add -start</code> <br> <code>26.115.154.67:8181</code> <br> <code>192.168.21.4/24</code> <br> <code>Successfully saved client configuration: C:\ProgramData\NT KERNEL\WireSock VPN Gateway\wsclient_1.conf</code> <br> <code>Successfully saved server configuration: C:\ProgramData\NT KERNEL\WireSock VPN Gateway\wiresock.conf</code> <br> <code>get-service *wire*</code> <br> <code>wg show</code> <br> <code>wg-quick-config -add -restart</code> add client</p> <p>wiresock.conf</p> <pre class=z-code><code><span class="z-text z-plain">[Interface]
</span><span class="z-text z-plain">PrivateKey = gCHC0g2JPwr6sXPiaOL4/KTkMyjN9TculrJUA/GORV8=
</span><span class="z-text z-plain">Address = 192.168.21.5/24
</span><span class="z-text z-plain">ListenPort = 8181
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">[Peer]
</span><span class="z-text z-plain">PublicKey = NoSxjew2RCHiUzI6mlahjd4I+0EcLsoYom/H01z91yU=
</span><span class="z-text z-plain">AllowedIPs = 192.168.21.6/32
</span></code></pre> <p>wsclient_1.conf (добавить маршруты для клиента в AllowedIPs)</p> <pre class=z-code><code><span class="z-text z-plain">[Interface]
</span><span class="z-text z-plain">PrivateKey = yIpRQRmaGrrk9Y+49E8JhEpFmKzSeecvUAdeNgf1hUM=
</span><span class="z-text z-plain">Address = 192.168.21.6/24
</span><span class="z-text z-plain">DNS = 8.8.8.8, 1.1.1.1
</span><span class="z-text z-plain">MTU = 1420
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">[Peer]
</span><span class="z-text z-plain">PublicKey = Fp7674VSYeGj8CYt6RCKR7Qz1y/IKUXCw8ImOFhX3hk=
</span><span class="z-text z-plain">AllowedIPs = 192.168.21.0/24, 192.168.3.0/24
</span><span class="z-text z-plain">Endpoint = 26.115.154.67:8181
</span><span class="z-text z-plain">PersistentKeepalive = 25
</span></code></pre> <h2 id=vpnclient><a aria-label="Anchor link for: vpnclient" class=zola-anchor href=#vpnclient><i class=icon></i></a> VpnClient</h2> <p><code>Get-Command -Module VpnClient</code> <br> <code>Add-VpnConnection -Name "vpn-failon" -ServerAddress "26.115.154.67" -TunnelType L2TP -L2tpPsk "123098" -EncryptionLevel "Required" -AuthenticationMethod MSChapv2 -RememberCredential -AllUserConnection –PassThru -Force</code> <br> <code>-TunnelType PPTP/L2TP/SSTP/IKEv2/Automatic</code> <br> <code>-L2tpPsk</code> использовать общий ключ для аутентификации (без параметра, для L2TP аутентификации используется сертификат) <br> <code>-AuthenticationMethod Pap/Chap/MSChapv2/Eap/MachineCertificate</code> <br> <code>-EncryptionLevel NoEncryption/Optional/Required/Maximum/Custom</code> <br> <code>-SplitTunneling</code> заворачивать весь трафик через VPN-туннель (включение Use default gateway on remote network в настройках параметра VPN адаптера) <br> <code>-UseWinlogonCredential</code> использовать учетные данные текущего пользователя для аутентификации на VPN сервере <br> <code>-RememberCredential</code> разрешить сохранять учетные данные для VPN подключения (учетная запись и пароль сохраняются в диспетчер учетных данных Windows после первого успешного подключения) <br> <code>-DnsSuffix domain.local</code> <br> <code>-AllUserConnection</code> разрешить использовать VPN подключение для всех пользователей компьютера (сохраняется в конфигурационный файл: C:\ProgramData\Microsoft\Network\Connections\Pbk\rasphone.pbk)</p> <p><code>Install-Module -Name VPNCredentialsHelper</code> модуль для сохранения логина и пароля в Windows Credential Manager для VPN подключения <br> <code>Set-VpnConnectionUsernamePassword -connectionname vpn-failon -username user1 -password password</code></p> <p><code>rasdial "vpn-failon"</code> подключиться <br> <code>Get-VpnConnection -AllUserConnection | select *</code> список VPN подключения, доступных для всех пользователей, найстройки и текущий статус подключения (ConnectionStatus) <br> <code>Add-VpnConnectionRoute -ConnectionName vpn-failon -DestinationPrefix 192.168.3.0/24 –PassThru</code> динамически добавить в таблицу маршрутизации маршрут, который будет активен при подключении к VPN <br> <code>Remove-VpnConnection -Name vpn-failon -AllUserConnection -Force</code> удалить</p> <p><code>Set-VpnConnection -Name "vpn-failon" -SplitTunneling $True</code> включить раздельное тунеллирование <br> <code>Add-VpnConnectionRoute -ConnectionName "vpn-failon" -DestinationPrefix 172.22.22.0/24</code> настроить маршрутизацию к указанной подсети через VPN-соединение <br> <code>(Get-VpnConnection -ConnectionName "vpn-failon").routes</code> отобразить таблицу маршрутизации для указанного соединения <br> <code>Remove-VpnConnectionRoute -ConnectionName "vpn-failon" -DestinationPrefix "172.22.23.0/24"</code></p> <h2 id=proxyclient><a aria-label="Anchor link for: proxyclient" class=zola-anchor href=#proxyclient><i class=icon></i></a> ProxyClient</h2> <p><code>$user = "lifailon"</code> <br> <code>$pass = "Proxy"</code> <br> <code>$SecureString = ConvertTo-SecureString $pass -AsPlainText -Force</code> <br> <code>$Credential = New-Object System.Management.Automation.PSCredential($user, $SecureString)</code> <br> <code>[System.Net.Http.HttpClient]::DefaultProxy = New-Object System.Net.WebProxy("http://192.168.3.100:9090")</code> <br> <code>[System.Net.Http.HttpClient]::DefaultProxy.Credentials = [System.Net.CredentialCache]::DefaultCredentials</code> <br> <code>[System.Net.Http.HttpClient]::DefaultProxy.Credentials = $Credential</code> <br> <code>Invoke-RestMethod http://ifconfig.me/ip</code> узнать внешний ip-адрес (по умолчанию в текущей сессии подключения будут происходить через заданный прокси сервер) <br> <code>Invoke-RestMethod https://kinozal.tv/rss.xml</code></p> <h2 id=netsh><a aria-label="Anchor link for: netsh" class=zola-anchor href=#netsh><i class=icon></i></a> netsh</h2> <h3 id=reverse-proxy><a aria-label="Anchor link for: reverse-proxy" class=zola-anchor href=#reverse-proxy><i class=icon></i></a> Reverse Proxy</h3> <p><code>netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=192.168.3.108</code> настраивает входящее подключение на 8080 порту и переадресует трафик на 80 порт указанного хоста <br> <code>netsh interface portproxy show all</code> отобразить список всех настроек <br> <code>netsh interface portproxy delete v4tov4 listenport=8080 listenaddress=0.0.0.0</code> удалить переадресацию</p> <h3 id=wlan><a aria-label="Anchor link for: wlan" class=zola-anchor href=#wlan><i class=icon></i></a> Wlan</h3> <p><code>netsh wlan show profile</code> список сохраненны профилей Wi-Fi и паролей <br> <code>netsh wlan show interfaces</code> хар-ки текущей сети (MAC, speed) <br> <code>netsh wlan show profile SSID-Name-Network key=clear</code> очистить пароль <br> <code>netsh wlan show networks</code> список видемых сетей <br> <code>netsh wlan disconnect</code> отключиться от Wi-Fi <br> <code>netsh wlan connect name="SSID-Name-Network"</code> подключиться <br> <code>netsh wlan show drivers</code> драйвер Wi-Fi <br> <code>netsh wlan set hostednetwork mode=allow ssid="WiFi-Test" key="password"</code> создание точки доступа Wi-Fi (SoftAP)</p> <h3 id=firewall-1><a aria-label="Anchor link for: firewall-1" class=zola-anchor href=#firewall-1><i class=icon></i></a> Firewall</h3> <p><code>netsh advfirewall set allprofiles state off</code> отключить fw <br> <code>netsh advfirewall reset</code> сбросить настройки <br> <code>netsh advfirewall firewall add rule name="Open Remote Desktop" protocol=TCP dir=in localport=3389 action=allow</code> открыть порт 3389 <br> <code>netsh advfirewall firewall add rule name="All ICMP V4" dir=in action=allow protocol=icmpv4</code> открыть icmp</p> <h2 id=openssh><a aria-label="Anchor link for: openssh" class=zola-anchor href=#openssh><i class=icon></i></a> OpenSSH</h2> <p><code>Get-WindowsCapability -Online | ? Name -like 'OpenSSH.Client*'</code> <br> <code>Add-WindowsCapability -Online -Name OpenSSH.Client*</code> <br> <code>dism /Online /Add-Capability /CapabilityName:OpenSSH.Client~~~~0.0.1.0</code> <br> <code>iwr https://github.com/PowerShell/Win32-OpenSSH/releases/download/v9.2.2.0p1-Beta/OpenSSH-Win64-v9.2.2.0.msi -OutFile $home\Downloads\OpenSSH-Win64-v9.2.2.0.msi</code> скачать <br> <code>msiexec /i $home\Downloads\OpenSSH-Win64-v9.2.2.0.msi</code> установить msi пакет <br> <code>Set-Service sshd -StartupType Automatic</code> <br> <code>Get-NetTCPConnection | where LocalPort -eq 22</code> <br> <code>New-NetFirewallRule -Name sshd -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22</code> <br> <code>Get-NetFirewallRule -Name *ssh*</code> <br> <code>Start-Process notepad++ C:\Programdata\ssh\sshd_config</code> конфигурационный файл <br> <code>GSSAPIAuthentication yes</code> включить Kerberos аутентификацию (через AD) <br> <code>SyslogFacility LOCAL0</code> включить локальное ведение журнала в файл (C:\ProgramData\ssh\logs\sshd.log) <br> <code>LogLevel INFO</code> <br> <code>Restart-Service sshd</code> <br> <code>ssh -K $srv</code> выполнить Kerberos аутентификацию <br> <code>ssh Lifailon@192.168.3.99 -p 22</code> <br> <code>pwsh -command Get-Service</code> <br> <code>ssh -L 3101:192.168.3.101:22 -R 3101:192.168.3.101:22 lifailon@192.168.3.101 -p 22</code> SSH Tunnel lifailon@localhost:3101 -> 192.168.3.101:3101</p> <h3 id=psremoting-over-ssh><a aria-label="Anchor link for: psremoting-over-ssh" class=zola-anchor href=#psremoting-over-ssh><i class=icon></i></a> PSRemoting over SSH</h3> <p><code>Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0</code> установка OpenSSH Server <br> <code>Get-WindowsCapability -Online | ? Name -like 'OpenSSH.Ser*'</code> <br> <code>iex "& { $(irm https://aka.ms/install-powershell.ps1) } -UseMSI"</code> установка PowerShell Core последней версии (требуется на клиентской стороне) <br> <code>Set-Service -Name sshd -StartupType "Automatic"</code> <br> <code>Start-Service sshd</code> <br> <code>Get-NetTCPConnection -State Listen|where {$_.localport -eq '22'}</code> <br> <code>Enable-NetFirewallRule -Name *OpenSSH-Server*</code> <br> <code>New-ItemProperty -Path "HKLM:\SOFTWARE\OpenSSH" -Name DefaultShell -Value "C:\Program Files\PowerShell\7\pwsh.exe" -PropertyType String –Force</code> изменить интерпритатор по умолчанию на pwsh <br> <code>notepad $Env:ProgramData\ssh\sshd_config</code></p> <p>PasswordAuthentication yes <br> Subsystem powershell c:/progra~1/powershell/7/pwsh.exe -sshs -NoLogo # запуск интерпретатора pwsh для удаленных SSH подключений</p> <p><code>Restart-Service sshd</code></p> <p><code>$session = New-PSSession -HostName 192.168.3.100 -Port 2121 -UserName lifailon -SSHTransport</code> <br> <code>Invoke-Command -Session $session -ScriptBlock {Get-Service}</code></p> <h2 id=winrm><a aria-label="Anchor link for: winrm" class=zola-anchor href=#winrm><i class=icon></i></a> WinRM</h2> <p><code>Enter-PSSession -ComputerName $srv</code> подключиться к PowerShell сессии через PSRemoting. Подключение возможно только по FQDN-имени <br> <code>Invoke-Command $srv -ScriptBlock {Get-ComputerInfo}</code> выполнение команды через PSRemoting <br> <code>$session = New-PSSession $srv</code> открыть сессию <br> <code>Get-PSSession</code> отобразить активные сессии <br> <code>icm -Session $session {$srv = $using:srv}</code> передать переменную текущей сессии ($using) в удаленную <br> <code>Disconnect-PSSession $session</code> закрыть сессию <br> <code>Remove-PSSession $session</code> удалить сессию <br> <code>Import-Module -Name ActiveDirectory -PSSession $srv</code> импортировать модуль с удаленного компьютера в локальную сессию</p> <h3 id=winrm-configuration><a aria-label="Anchor link for: winrm-configuration" class=zola-anchor href=#winrm-configuration><i class=icon></i></a> WinRM Configuration</h3> <p><code>winrm quickconfig -quiet</code> изменит запуск службы WinRM (Windows Remote Management) на автоматический, задаст стандартные настройки WinRM и добавить исключения для портов в fw <br> <code>Enable-PSRemoting –Force</code> включить PowerShell Remoting, работает только для доменного и частного сетевых профилей Windows <br> <code>Enable-PSRemoting -SkipNetworkProfileCheck -Force</code> для настройки компьютера в общей (public) сети (работает с версии powershell 6)</p> <p><code>$NetProfiles = Get-NetConnectionProfile</code> отобразить профили сетевых подключений <br> <code>Set-NetConnectionProfile -InterfaceIndex $NetProfiles[1].InterfaceIndex -NetworkCategory Private</code> изменить тип сети для профиля (DomainAuthenticated/Public) <br> <code>(Get-CimInstance -ClassName Win32_ComputerSystem).PartOfDomain</code> проверить, что компьютер добавлен в домен AD <br> <code>Get-Service WinRM | Set-Service -StartupType AutomaticDelayedStart</code> отложенный запуск <br> <code>Get-Service -Name winrm -RequiredServices</code> статус зависимых служб <br> <code>New-NetFirewallRule -Profile Any -DisplayName "WinRM HTTP" -Direction Inbound -Protocol TCP -LocalPort 5985,5986</code> <br> <code>Test-NetConnection $srv -port 5895</code> проверить порт <br> <code>Test-WSMan $srv -ErrorAction Ignore</code> проверить работу WinRM на удаленном компьютере (игнорировать вывод ошибок для скрипта) или локально (localhost)</p> <p><code>$Cert = New-SelfSignedCertificate -CertStoreLocation Cert:\LocalMachine\My -DnsName "$env:computername" -FriendlyName "WinRM HTTPS Certificate" -NotAfter (Get-Date).AddYears(5)</code> создать самоподписанный сертификат <br> <code>$Thumbprint = $Cert.Thumbprint</code> забрать отпечаток <br> <code>New-Item -Path WSMan:\Localhost\Listener -Transport HTTPS -Address * -CertificateThumbprint $Thumbprint -Name WinRM_HTTPS_Listener -Force</code> создать прослушиватель <br> <code>New-NetFirewallRule -DisplayName 'WinRM HTTPS' -Profile Domain,Private -Direction Inbound -Action Allow -Protocol TCP -LocalPort 5986</code> открыть порт в fw</p> <pre class=z-code><code><span class="z-text z-plain">$selector_set = @{
</span><span class="z-text z-plain">    Address = "*"
</span><span class="z-text z-plain">    Transport = "HTTPS"
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">$value_set = @{
</span><span class="z-text z-plain">    CertificateThumbprint = "66ABFDA044D8C85135048186E2FDC0DBE6125163"
</span><span class="z-text z-plain">}
</span><span class="z-text z-plain">New-WSManInstance -ResourceURI "winrm/config/Listener" -SelectorSet $selector_set -ValueSet $value_set
</span></code></pre> <p><code>winrm get winrm/config</code> отобразить всю конфигурацию (Client/Service) <br> <code>winrm get winrm/config/service/auth</code> конфигурация авторизации на сервере <br> <code>winrm enumerate winrm/config/listener</code> текущая конфигурация прослушивателей WinRM (отображает отпечаток сертификата для HTTPS 5986) <br> <code>Get-ChildItem -Path Cert:\LocalMachine\My\ | where Thumbprint -eq D9356FB774EE0E6206B7D5B59B99102CA5B17BDA | select *</code> информация о сертификате</p> <p><code>ls WSMan:\localhost\Client</code> конфигурацию клиента <br> <code>ls WSMan:\localhost\Service</code> конфигурация сервера <br> <code>ls WSMan:\localhost\Service\auth</code> список всех конфигураций аутентификации WinRM сервера <br> <code>Set-Item -path WSMan:\localhost\Service\auth\basic -value $true</code> разрешить локальную аутентификацию к текущему серверу <br> <code>ls HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\WSMAN</code> настройки в реестре (например, для включения аудентификации в \Service\auth_basic = 1) <br> <code>Set-Item WSMan:\localhost\Client\TrustedHosts -Value 192.168.* -Force</code> добавить доверенные хосты в конфигурацию на клиенте, чтобы работала Negotiate аутентификация через NTLM <br> <code>Set-Item WSMan:\localhost\Client\TrustedHosts -Value 192.168.3.100 -Concatenate -Force</code> добавить второй компьютер <br> <code>ls WSMan:\localhost\Client\TrustedHosts</code> <br> <code>Set-Item WSMan:\localhost\Client\AllowUnencrypted $true</code> включить передача незашифрованных данных конфигурации клиента <br> <code>Set-Item WSMan:\localhost\Service\AllowUnencrypted $true</code> включить передача незашифрованных данных конфигурации сервера (необходимо быть в private сети)</p> <p><code>Get-PSSessionConfiguration</code> проверить, включен ли PSremoting и вывести список пользователей и групп, которым разрешено подключаться через WinRM <br> <code>Set-PSSessionConfiguration -Name Microsoft.PowerShell -ShowSecurityDescriptorUI</code> назначить права доступа через дескриптор безопасности текущей сессии (до перезагруки) <br> <code>(Get-PSSessionConfiguration -Name "Microsoft.PowerShell").SecurityDescriptorSDDL</code> получить настройки дескриптора в формате SDDL <br> <code>Set-PSSessionConfiguration -Name Microsoft.PowerShell -SecurityDescriptorSDDL $SDDL</code> применить настройки дескриптора на другом компьютере без использования GUI \</p> <p><code>New-LocalUser "WinRM-Writer" -Password (ConvertTo-SecureString -AsPlainText "123098")</code> создать пользователя <br> <code>Add-LocalGroupMember -Group "Remote Management Users" -Member "WinRM-Writer"</code> добавить пользователя WinRM-Writer в локальную группу доступа “Пользователи удаленного управления” <br> <code>cmdkey /add:192.168.3.99 /user:WinRM-Writer /pass:123098</code> сохранить пароль в CredentialManager <code>cmdkey /list</code> <br> <code>Import-Module CredentialManager</code> <br> <code>Add-Type -AssemblyName System.Web</code> <br> <code>New-StoredCredential -Target 192.168.3.99 -UserName WinRM-Writer -Password 123098 -Comment WinRM</code> сохранить пароль в CredentialManager (из PS5) <br> <code>Get-StoredCredential -AsCredentialObject</code> <br> <code>$cred = Get-StoredCredential -Target 192.168.3.99</code> <br> <code>Enter-PSSession -ComputerName 192.168.3.99 -Credential $cred -Authentication Negotiate</code> <br> <code>Enter-PSSession -ComputerName 192.168.3.99 -Credential $cred -Authentication Basic -Port 5985</code> работает при отключении allowunencrypted на стороне сервера и клиента <br> <code>winrs -r:http://192.168.3.100:5985/wsman -u:WinRM-Writer -p:123098 ipconfig</code> передать команду через winrs (-?) <br> <code>winrs -r:https://192.168.3.100:5985/wsman -u:WinRM-Writer -p:123098 -ssl ipconfig</code> через https <br> <code>pwsh -Command "Install-Module -Name PSWSMan"</code> установить модуль для использования в Linux системе</p> <h3 id=kerberos><a aria-label="Anchor link for: kerberos" class=zola-anchor href=#kerberos><i class=icon></i></a> Kerberos</h3> <p><code>.\CheckMaxTokenSize.ps1 -Principals login -OSEmulation $true -Details $true</code> узнать размер токена пользователя в домене <br> <code>Get-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Parameters | select maxtokensize</code> максимальный размер токена на сервере <br> <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\HTTP\Parameters</code> изменить размера, если заголовок пакета аутентификации превышает 16 Кб (из за большого кол-ва групп) <br> <code>MaxFieldLength увеличить до 0000ffff (65535)</code> <br> <code>MaxRequestBytes увеличить до 0000ffff (65535)</code></p> <h2 id=packagemanagement><a aria-label="Anchor link for: packagemanagement" class=zola-anchor href=#packagemanagement><i class=icon></i></a> PackageManagement</h2> <p><code>Import-Module PackageManagement</code> импортировать модуль <br> <code>Get-Module PackageManagement</code> информация о модуле <br> <code>Get-Command -Module PackageManagement</code> отобразить все командлеты модуля <br> <code>Get-Package</code> отобразить все установленные пакеты PowerShellGallery <br> <code>Get-Package -ProviderName msi,Programs</code> список установленных программ <code>[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12</code> включить использование протокол TLS 1.2 (если не отключены протоколы TLS 1.0 и 1.1) <br> <code>Get-PackageSource</code> источники установки пакетов <br> <code>Get-PackageProvider</code> отобразить список провайдеров менеджеров пакетов <br> <code>Get-PackageProvider | Where-Object Name -Match nuget</code> <br> <code>Find-PackageProvider</code> отображение всех доступных менеджеров пакетов <br> <code>Find-PackageProvider nuget</code> <br> <code>Install-PackageProvider NuGet -Force</code> установить менеджер пакетов nuget <br> <code>Install-PackageProvider PSGallery -Force</code> установить источник <br> <code>Install-PackageProvider Chocolatey -Force</code> <br> <code>Set-PackageSource nuget -Trusted</code> разрешить установку пакетов из указанного источника <br> <code>Register-PSRepository -Name "NuGet" -SourceLocation "https://www.nuget.org/api/v2" -InstallationPolicy Trusted</code> зарегестрировать менеджер пакетов используя url (работает для Power Shell Core) <br> <code>Set-PackageSource -Name NuGet -Trusted</code> изменить источник по умолчанию <br> <code>Find-Package PSEverything</code> поиск пакетов по имени во всех менеджерах <br> <code>Find-Package PSEverything -Provider NuGet</code> поиск пакета у выбранного провайдера <br> <code>Install-Module PSEverything -Scope CurrentUser</code> установить модуль для текущего пользователя <br> <code>Install-Package -Name VeeamLogParser -ProviderName PSGallery -scope CurrentUser</code> <br> <code>Get-Command *Veeam*</code> <br> <code>Import-Module -Name VeeamLogParser</code> загрузить модуль <br> <code>Get-Module VeeamLogParser | select -ExpandProperty ExportedCommands</code> отобразить список функций</p> <h3 id=winget><a aria-label="Anchor link for: winget" class=zola-anchor href=#winget><i class=icon></i></a> winget</h3> <p><a href=https://github.com/microsoft/winget-cli>Source</a> <a href=https://winget.run>Web</a></p> <p><code>winget list</code> список установленных пакетов <br> <code>winget search VLC</code> найти пакет <br> <code>winget show VideoLAN.VLC</code> информация о пакете <br> <code>winget show VideoLAN.VLC --versions</code> список доступных версий в репозитории <br> <code>winget install VideoLAN.VLC</code> установить пакет <br> <code>winget uninstall VideoLAN.VLC</code> удалить пакет <br> <code>winget download jqlang.jq</code> загрузкить пакет (https://github.com/jqlang/jq/releases/download/jq-1.7/jq-windows-amd64.exe) <br> <code>winget install jqlang.jq</code> добавляет в переменную среду и псевдоним командной строки jq <br> <code>winget uninstall jqlang.jq</code></p> <h3 id=jqlang><a aria-label="Anchor link for: jqlang" class=zola-anchor href=#jqlang><i class=icon></i></a> jqlang</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">uri</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>irm https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">api.github.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>repos<span class="z-keyword z-operator z-assignment z-powershell">/</span>jqlang<span class="z-keyword z-operator z-assignment z-powershell">/</span>jq<span class="z-keyword z-operator z-assignment z-powershell">/</span>releases<span class="z-keyword z-operator z-assignment z-powershell">/</span>latest<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.assets.browser_download_url <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>windows-amd64<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.ToString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> получить версию latest на GitHub<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">irm <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Windows\System32\jq.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> загрузить jq.exe<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <h3 id=scoop><a aria-label="Anchor link for: scoop" class=zola-anchor href=#scoop><i class=icon></i></a> Scoop</h3> <p><code>Set-ExecutionPolicy RemoteSigned -Scope CurrentUser</code> <br> <code>irm get.scoop.sh | iex</code> установка <br> <code>scoop help</code> <br> <code>scoop search jq</code> <br> <code>scoop info jq</code> <br> <code>(scoop info jq).version</code> <br> <code>scoop cat jq</code> <br> <code>scoop download jq</code> C:\Users\lifailon\scoop\cache <br> <code>scoop install jq</code> C:\Users\lifailon\scoop\apps\jq\1.7 <br> <code>scoop list</code> <br> <code>(scoop list).version</code> <br> <code>scoop uninstall jq</code></p> <h3 id=chocolatey><a aria-label="Anchor link for: chocolatey" class=zola-anchor href=#chocolatey><i class=icon></i></a> Chocolatey</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Set-ExecutionPolicy</span> Bypass <span class="z-keyword z-operator z-assignment z-powershell">-</span>Scope <span class="z-keyword z-control z-powershell">Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force<span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.ServicePointManager</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::SecurityProtocol <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.ServicePointManager</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::SecurityProtocol <span class="z-keyword z-operator z-bitwise z-powershell">-bor</span> <span class="z-constant z-numeric z-integer z-powershell">3072</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> iex <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">New-Object</span> System.Net.WebClient</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.DownloadString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>https://community.chocolatey.org/install.ps1<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <p><code>choco -v</code> <br> <code>choco -help</code> <br> <code>choco list</code> <br> <code>choco install adobereader</code></p> <h2 id=nuget><a aria-label="Anchor link for: nuget" class=zola-anchor href=#nuget><i class=icon></i></a> NuGet</h2> <p><code>Invoke-RestMethod https://dist.nuget.org/win-x86-commandline/latest/nuget.exe -OutFile "$home\Documents\nuget.exe"</code> <br> <code>Invoke-Expression "$home\Documents\nuget.exe search Selenium.WebDriver"</code> <br> <code>Invoke-Expression "$home\Documents\nuget.exe install Selenium.WebDriver"</code> <br> <code>Get-Item $home\Documents\*Selenium*</code></p> <p><code>& "$home\Documents\nuget.exe" list console-translate</code> <br> <code>$nuget_api_key = "&LTAPI-KEY>"</code> <br> <code>$source = "https://api.nuget.org/v3/index.json"</code> <br> <code>$Name = "Console-Translate"</code> <br> <code>$path = "$home\Documents\$Name"</code> <br> <code>New-Item -Type Directory $path</code> <br> <code>Copy-Item "$home\Documents\Git\$Name\$Name\0.2\*" "$path\"</code> <br> <code>Copy-Item "$home\Documents\Git\$Name\LICENSE" "$path\"</code> <br> <code>Copy-Item "$home\Documents\Git\$Name\README.md" "$path\"</code></p> <pre class="language-xml z-code" data-lang=xml><code class=language-xml data-lang=xml><span class="z-text z-xml">'<span class="z-meta z-tag z-preprocessor z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT?</span><span class="z-entity z-name z-tag z-xml">xml</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">version</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>1.0<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">?></span></span>
</span><span class="z-text z-xml"><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">package</span> <span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">  <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">metadata</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">id</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>Console-Translate<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">id</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">version</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>0.2.2<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">version</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">authors</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>Lifailon<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">authors</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">owners</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>Lifailon<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">owners</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">description</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>Cross-platform client for translating text in the console, uses API Google (edded public free token), MyMemory and DeepLX (no token required)<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">description</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">tags</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>PowerShell, Module, Translate, api<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">tags</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">repository</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>git<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">url</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>https://github.com/Lifailon/Console-Translate<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">projectUrl</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>https://github.com/Lifailon/Console-Translate<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">projectUrl</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">licenseUrl</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>https://github.com/Lifailon/Console-Translate/blob/rsa/LICENSE<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">licenseUrl</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">contentFiles</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Console-Translate.psm1<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Console-Translate.psd1<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>lang-iso-639-1.csv<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>README.md<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>LICENSE<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">contentFiles</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">  <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">metadata</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml"><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">package</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>' > "$path\$Name.nuspec"
</span></code></pre> <p><code>Set-Location $path</code> <br> <code>& "$home\Documents\nuget.exe" pack "$path\$Name.nuspec"</code> <br> <code>& "$home\Documents\nuget.exe" push "$path\$Name.0.2.2.nupkg" -ApiKey $nuget_api_key -Source $source</code> <br> <code>& "$home\Documents\nuget.exe" push "$path\$Name.0.2.2.nupkg" -ApiKey $nuget_api_key -Source $source -SkipDuplicate</code></p> <p><code>Install-Package Console-Translate -Source nuget.org</code> <br> <code>Get-Package Console-Translate | select *</code></p> <p><code>Register-PSRepository -Name "NuGet" -SourceLocation "https://www.nuget.org/api/v2" -InstallationPolicy Trusted</code> <br> <code>Get-PSRepository</code> <br> <code>Find-Module -Name Console-Translate</code> <br> <code>Install-Module Console-Translate -Repository NuGet</code></p> <p><code>& "$home\Documents\nuget.exe" delete Console-Translate 0.2.0 -Source https://api.nuget.org/v3/index.json -ApiKey $nuget_api_key -NoPrompt</code></p> <h2 id=modules><a aria-label="Anchor link for: modules" class=zola-anchor href=#modules><i class=icon></i></a> Modules</h2> <h3 id=get-query><a aria-label="Anchor link for: get-query" class=zola-anchor href=#get-query><i class=icon></i></a> Get-Query</h3> <p><code>Install-Module Get-Query -Repository NuGet</code> установить модуль <br> <code>Get-Help Get-Query</code> <br> <code>Get-Query localhost</code> отобразить всех авторизованных пользователей, их статус и время работы (по умолчанию localhost) <br> <code>Get-Query 192.168.1.1.1 -proc</code> список всех пользовательских процессов (по умолчанию -user *) <br> <code>Get-Query 192.168.1.1.1 -proc -user username</code> список процессов указанного пользователя</p> <h3 id=console-translate><a aria-label="Anchor link for: console-translate" class=zola-anchor href=#console-translate><i class=icon></i></a> Console-Translate</h3> <p><code>Install-Module Console-Translate -Repository NuGet</code> <br> <code>Get-Translate "Module for text translation"</code> <br> <code>Get-Translate "Модуль для перевода текста"</code> <br> <code>Get-Translate "Привет world" -LanguageSelected</code> т.к. больше латинских символов (на 1), то перевод будет произведен на английский язык <br> <code>Get-Translate "Hello друг" -LanguageSelected</code> перевод на русский язык <br> <code>Get-Translate -Text "Модуль для перевода текста" -LanguageSource ru -LanguageTarget tr</code> <br> <code>Get-Translate -Provider MyMemory -Text "Hello World" -Alternatives</code> выбрать провайдер перевода и добавить альтернативные варианты вывода <br> <code>Get-DeepLX "Get select" ru</code> <br> <code>Start-DeepLX -Job</code> запустить сервер в режиме процесса <br> <code>Start-DeepLX -Status</code> <br> <code>Get-DeepLX -Server 192.168.3.99 -Text "Module for text translation" ru</code> <br> <code>Stop-DeepLX</code> <br> <code>Get-LanguageCode</code> получение кодов языков по стандарту ISO-639-1</p> <h3 id=console-download><a aria-label="Anchor link for: console-download" class=zola-anchor href=#console-download><i class=icon></i></a> Console-Download</h3> <p><code>Install-Module Console-Download -Repository NuGet</code> устаовить модуль из менеджера пакетов NuGet <br> <code>Invoke-Expression $(Invoke-RestMethod "https://raw.githubusercontent.com/Lifailon/Console-Download/rsa/module/Console-Download/Console-Download.psm1")</code> или импортировать модуль из GitHub репозитория в текущую сессию PowerShell <br> <code>Invoke-Download -Url "https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip"</code> загрузить файл в один поток с отображением скорости загрузки в реальном времен (путь загрузки файла по умолчанию: $home\downloads) <br> <code>Invoke-Download -Url "https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip" -Thread 3</code> загрузить один и тотже файл в 3 потока (создается 3 файла, доступно от 1 до 20 потоков)</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>urls</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-group z-array-expression z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-group z-array-expression z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/Lifailon/helperd/releases/download/0.0.1/Helper-Desktop-Setup-0.0.1.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-Download</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>urls</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> загрузить параллельно 2 файла<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <p><code>$urls = Get-Content "$home\Desktop\links.txt"</code> <br> <code>Invoke-Download $urls</code> передайте список URL-адресов из файла для загрузки файлов, эквивалентному числу url</p> <p><code>$urls = Get-LookingGlassList</code> отобразить актуальный список конечных точек Looking Glass через Looking.House (выдает 3 ссылки на загрузку файлов по 10, 100 и 1000 мбайт для каждого региона) <br> <code>$usaNy = $urls | Where-Object region -like *USA*New*York*</code> отфильтровать список по региону и городу <br> <code>$url = $usaNy[0].url100mb</code> забрать первую ссылку с файлов на 100 МБайт <br> <code>Invoke-Download $url</code> начать загрузку файла <br> <code>Invoke-Download $url -Thread 3</code> начать загрузку 3-х одинаковых файлов</p> <h3 id=pseverything><a aria-label="Anchor link for: pseverything" class=zola-anchor href=#pseverything><i class=icon></i></a> PSEverything</h3> <p><code>Install-Module PSEverything -Repository NuGet</code> <br> <code>Find-Everything pingui</code> найти все файлы в системе (на всех локальных дисках) с именем <em>pingui</em> через dll csharp версии Everything (по умолчанию) <br> <code>Find-Everything pingui-0.1.py | Format-List</code> <br> <code>Find-Everything pingui -es</code> использовать cli версию Everything для поиска (при первом использовании версии, необходимо дождаться автоматической установки файлов зависимостей) <br> <code>Find-Everything pingui-0.1 -ComputerName localhost</code> поиск на удаленном компьютере через REST API, если запущен HTTP-сервер Everything</p> <h3 id=hardwaremonitor><a aria-label="Anchor link for: hardwaremonitor" class=zola-anchor href=#hardwaremonitor><i class=icon></i></a> HardwareMonitor</h3> <p><code>Install-Module HardwareMonitor -Repository NuGet -Scope AllUsers</code> <br> <code>Install-LibreHardwareMonitor</code> установить и запустить LibreHardwareMonitor в систему (https://github.com/LibreHardwareMonitor/LibreHardwareMonitor) <br> <code>Install-OpenHardwareMonitor</code> установить OpenHardwareMonitor (https://github.com/openhardwaremonitor/openhardwaremonitor) <br> <code>Get-Sensor | Where-Object {($_.SensorName -match "Temperature") -or ($_.SensorType -match "Temperature")} | Format-Table</code> использовать LibreHardwareMonitor и WMI/CIM (по умолчанию) и отфильтровать вывод по наименованию датчикам или типу сенсора для вывода датчиков температуры <br> <code>Get-Sensor -Open</code> использовать OpenHardwareMonitor <br> <code>Get-Sensor -ComputerName 192.168.3.99 -Port 8086 | Format-Table</code> вывести датчики системы через REST API <br> <code>Get-Sensor -ComputerName 192.168.3.99 -Port 8085 -User hardware -Password monitor | Where-Object Value -notmatch "^0,0" | Format-Table</code> использовать авторизацию и отфильтровать вывод не пустых датчиков <br> <code>Get-Sensor -Library | Where-Object Value -ne 0 | Format-Table</code> использовать динамическую библиотеку (dll) через .NET</p> <h3 id=crystaldisk-cli><a aria-label="Anchor link for: crystaldisk-cli" class=zola-anchor href=#crystaldisk-cli><i class=icon></i></a> CrystalDisk-Cli</h3> <p><code>Install-Module CrystalDisk-Cli -Repository NuGet</code> <br> <code>Get-DiskInfoSettings</code> отобразить настройки программы Crystal-DiskInfo (https://github.com/hiyohiyo/CrystalDiskInfo) <br> <code>Get-DiskInfoSettings -AutoRefresh 5</code> изминить время сканирования на 5 минут <br> <code>Get-DiskInfo -List</code> отобразить список дисков <br> <code>Get-DiskInfo</code> получить результаты последнего сканирования (статус, температура и т.п.) <br> <code>Get-DiskInfo -Report | Select-Object Name,Date,HealthStatus,Temperature</code> получить актуальный отчет (запустить сканирование и дождаться результатов)</p> <h3 id=ps-pi-hole><a aria-label="Anchor link for: ps-pi-hole" class=zola-anchor href=#ps-pi-hole><i class=icon></i></a> PS-Pi-Hole</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_psm</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>PSModulePath<span class="z-variable z-other z-member z-powershell">.Split</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\Invoke-Pi-Hole\Invoke-Pi-Hole.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-unary z-powershell">!</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_psm</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">New-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_psm</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType File <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">irm https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">raw.githubusercontent.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Lifailon<span class="z-keyword z-operator z-assignment z-powershell">/</span>PS<span class="z-keyword z-operator z-assignment z-powershell">-</span>Pi<span class="z-keyword z-operator z-assignment z-powershell">-</span>Hole<span class="z-keyword z-operator z-assignment z-powershell">/</span>rsa<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Invoke-Pi</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>Hole<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Invoke-Pi</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>Hole.psm1 <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_psm</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></code></pre> <p><code>sudo cat /etc/pihole/setupVars.conf | grep WEBPASSWORD</code> получить токен доступа <br> <code>$Server = "192.168.1.253"</code> <br> <code>$Token = "5af9bd44aebce0af6206fc8ad4c3750b6bf2dd38fa59bba84ea9570e16a05d0f"</code> <br> <code>Invoke-Pi-Hole -Versions -Server $Server -Token $Token</code> получить текущую версию ядра (backend) и веб (frontend) на сервере а также последнюю доступную версию для обновления <br> <code>Invoke-Pi-Hole -Releases -Server $Server -Token $Token</code> узнать последнюю доступную версию в репозитории на GitHub <br> <code>Invoke-Pi-Hole -QueryLog -Server $Server -Token $Token</code> отобразить полный журнал запросов (клиент, домен назначения, тип записи, статус время запроса и адрес пересылки forward dns - куда ушел запрос) <br> <code>Invoke-Pi-Hole -AdList -Server $Server -Token $Token</code> получить списки блокировак используемых на сервере (дата обновления, количество доменов и url-источника) <br> <code>Invoke-Pi-Hole -Status -Server $Server -Token $Token</code> статус работы режима блокировки <br> <code>Invoke-Pi-Hole -Enable -Server $Server -Token $Token</code> включить блокировку <br> <code>Invoke-Pi-Hole -Disable -Server $Server -Token $Token</code> отключить блокировку <br> <code>Invoke-Pi-Hole -Stats -Server $Server -Token $Token</code> подключиться к серверу Pi-Hole для получения статистики (метрики: количество доменов для блокировки, количество запросов и блокировок за сегодня и т.д.) <br> <code>Invoke-Pi-Hole -QueryTypes -Server $Server -Token $Token</code> статистика запросов по типу записей относительно 100% <br> <code>Invoke-Pi-Hole -TopClient -Server $Server -Token $Token</code> список самых активных клиентов (ip/name и количество запросов проходящих через сервер) <br> <code>Invoke-Pi-Hole -TopPermittedDomains -Count 100 -Server $Server -Token $Token</code> список самых посещяемых доменов и количество запросов <br> <code>Invoke-Pi-Hole -LastBlockedDomain -Server $Server -Token $Token</code> адрес последнего заблокированного домена <br> <code>Invoke-Pi-Hole -ForwardServer -Server $Server -Token $Token</code> список серверов для пересылки, которым обычно выступает DNS-сервер стоящий за Pi-Hole в локальной сети, например AD <br> <code>Invoke-Pi-Hole -Data -Server $Server -Token $Token</code> количество запросов за каждые 10 минут в течение последних 24 часов</p> <h3 id=check-host><a aria-label="Anchor link for: check-host" class=zola-anchor href=#check-host><i class=icon></i></a> Check-Host</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>PSModulePath</span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\Get-CheckHost<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType Directory <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType Directory <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://raw.githubusercontent.com/Lifailon/Check-Host/rsa/Get-CheckHost/Get-CheckHost.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>\Get-CheckHost.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre> <p><code>Install-Module CheckHost</code> установить модуль работы с Check-Host (https://check-host.net) через api <br> <code>Get-CheckHost -List</code> список хостов (node) разных регионов (40) <br> <code>Get-CheckHost -Server google.com -Type ping -Count 5</code> использовать 5 любых хостов для 4 пингов с каждого до указанного url (google) <br> <code>Get-CheckHost -Server google.com -Type dns -Count 5</code> проверить DNS (возвращает А-запись или диапазон с ip-адресом) <br> <code>Get-CheckHost -Server google.com:443 -Type http -Count 5</code> проверить доступность порта <br> <code>Get-CheckHost -Server google.com:443 -Type tcp -Count 5</code> проверить доступность TCP или UDP порта</p> <h3 id=psdomaintest><a aria-label="Anchor link for: psdomaintest" class=zola-anchor href=#psdomaintest><i class=icon></i></a> PSDomainTest</h3> <p><code>Install-Module PSDomainTest -Repository NuGet -Scope CurrentUser</code> <br> <code>Get-DomainTest -Domain github.com -Warning</code> протестировать домен и DNS записи на ошибки (вывести только ошибки) через ZoneMaster (https://github.com/zonemaster/zonemaster) <br> <code>Get-DomainTest -Domain github.com -Warning -json</code> вывод в формате json <br> <code>Get-DomainTest -Domain github.com -html | Out-File .\result.html</code> получить отчет в формате HTML-таблицы с фильтрацией по столбцам</p> <h3 id=winapi><a aria-label="Anchor link for: winapi" class=zola-anchor href=#winapi><i class=icon></i></a> WinAPI</h3> <p><code>Install-Module ps.win.api -Repository NuGet -AllowClobber</code> <br> <code>Import-Module ps.win.api</code> <br> <code>Get-Command -Module ps.win.api</code> <br> <code>Start-WinAPI</code> запустить сервер <br> <code>Test-WinAPI</code> статус сервера <br> <code>Stop-WinAPI</code> остановить сервер <br> <code>Read-WinAPI</code> отобразить лог в реальном времени <br> <code>Get-Hardware</code> вывести сводную информацию о системе с использованием потоков (фоновых заданий) <br> <code>Get-DiskPhysical</code> отобразить список физических дисков, их размер, интерфейс и статус <br> <code>Get-DiskPhysical -ComputerName 192.168.3.100 -Port 8443 -User rest -Pass api</code> получить информацию с удаленного сервер, на котором запущен сервер WinAPI (доступно для всех функций модуля) <br> <code>Get-DiskLogical</code> список логических дисков (включая виртуальные диски), их файловая система, общий и используемый размер в гб и процентах <br> <code>Get-DiskPartition</code> список разделов физических дисков (отобразит скрытые разделы, загрузочный и порядок назначения байт) <br> <code>Get-Smart</code> статус работы всех дисков и текущая температура <br> <code>Get-IOps</code> количество операций ввода/вывода дисковой подсистемы <br> <code>Get-Files</code> подробная информация о файлах (добавляет дату создания, изменения, доступа, количество дочерних файлов и директорий) <br> <code>Find-Process</code> поиск пути к исполняемому файлу по имени остановленного (не запущенного) процесса в директориях <br> <code>Get-ProcessPerformance</code> информация о процессах (Get-Process) в человеко-читаемом формате <br> <code>Get-CPU</code> список все ядер и нагрузка на каждое ядро и на все сразу (суммарное процессорное время, привилегированное и пользовательское время процессора) <br> <code>Get-MemorySize</code> размер оперативной, виртуальной памяти, суммарное потребление памяти процессов и путь к файлу подкачки <br> <code>Get-MemorySlots</code> список всех слотов оперативной памяти <br> <code>Get-NetInterfaceStat</code> статистика активного сетевого интерфейса за время с момента загрузки системы (количество пакетов и ГБ) <br> <code>Get-NetInterfaceStat -Current</code> текущая статистика активного сетевого интерфейса (количество пакетов и МБ/c) <br> <code>Get-NetIpConfig</code> конфигурация всех сетевых интерфейсов (ip и mac-адрес, статус DHCP сервера, дата аренды) <br> <code>Get-NetStat</code> развернутая статистика сетевых интерфейсов (из Get-NetTCPConnection), добавляет имя процесса, имя удаленного хоста (через nslookup), время работы процесса (не процессорное время) и путь к исполняемому файлу <br> <code>Get-Performance</code> информация из счетчиков (Get-Counter) человеко-читаемом формате <br> <code>Get-VideoCard</code> информация о всех видео-картах (наименование, частота и объем видео-памяти) <br> <code>Get-Software</code> список установленного програмного обеспечения <br> <code>Get-WinUpdate</code> список обновлений Windows (дата установки и источник) <br> <code>Get-Driver</code> список установленных драйверов (имя, провайдер, версия и дата установки)</p> <h3 id=psyslog><a aria-label="Anchor link for: psyslog" class=zola-anchor href=#psyslog><i class=icon></i></a> pSyslog</h3> <p><code>Install-Module pSyslog -Repository NuGet</code> <br> <code>Start-pSyslog -Port 514</code> запустить сервер на порту 514 (по умолчанию) <br> <code>Start-pSyslog -RotationSize 500</code> указать размер файла локального журнала для его ротации (обрезания) в КБ <br> <code>Get-pSyslog -Status | Format-List</code> отобразить статус работы <br> <code>Get-pSyslog</code> вывести журнал сообщений в реальном времени <br> <code>Stop-pSyslog</code> остановить сервер <br> <code>Send-pSyslog -Content "Test" -Server 192.168.3.99</code> отправить сообщение на Syslog-сервер <br> <code>Send-pSyslog -Content "Test" -Server 192.168.3.99 -Type Informational -PortServer 514 -PortClient 55514</code> <br> <code>(Get-Service -Name WinRM).Status | Send-pSyslog -Server 192.168.3.102 -Tag Service[WinRM]</code> <br> <code>Send-pSyslog -Content "test" -Server 192.168.3.99 -PortServer 514 -Base64</code> использовать шифрование при отправки сообщения (расшифровка работает только для сервера pSyslog) <br> <code>Start-UDPRelay -inPort 515 -outIP 192.168.3.102 -outPort 514</code> запустить сервер в режиме UDP-Relay, который слушает на порту 515 и переадресует сообщения на Syslog сервер 192.168.3.102 с портом 514 <br> <code>Send-pSyslog -Server 192.168.3.99 -PortServer 515 -Content $(Get-Date)</code> отправить сообщение на сервере UDP-Relay <br> <code>Show-pSyslog -Type Warning -Count</code> отобразить метрики (количество ошибок) <br> <code>Show-pSyslog -Type Alert -Count</code> <br> <code>Show-pSyslog -Type Critical -Count</code> <br> <code>Show-pSyslog -Type Error -Count</code> <br> <code>Show-pSyslog -Type Emergency -Count</code> <br> <code>Show-pSyslog -Type Informational -Count</code> <br> <code>Show-pSyslog -LogFile 05-06 | Out-GridView</code> прочитать локальный журнал логирования и вывести в GridView для фильтрации сообщений <br> <code>Show-pSyslog -Count</code> отобразить количество сообщений локального журнала <br> <code>Show-pSyslog -Count -LogFile 10-06</code> выбрать журнал по дате</p> <h3 id=syslog-source-message><a aria-label="Anchor link for: syslog-source-message" class=zola-anchor href=#syslog-source-message><i class=icon></i></a> Syslog source message</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>TypeDefinition <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public enum Syslog_Facility {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    kern,     // 0  kernel (core) messages
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    user,     // 1  user level messages
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    mail,     // 2  mail system
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    daemon,   // 3  system daemons
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    auth,     // 4  security/authorization messages (login/su)
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    syslog,   // 5  syslog daemon
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    lpr,      // 6  line printer subsystem (creating jobs and send to spool for print by using lpd)
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    news,     // 7  network news subsystem (USENET)
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    uucp,     // 8  Unix-to-Unix Copy subsystem
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    cron,     // 9  scheduling daemon
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    authpriv, // 10 security/authorization private messages
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    ftp,      // 11 FTP daemon
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    ntp,      // 12 NTP daemon
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    security, // 13 security log audit
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    console,  // 14 console log alert
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    clock,    // 15 clock subsystem
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local0,   // 16 local use
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local1,   // 17
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local2,   // 18
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local3,   // 19
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local4,   // 20
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local5,   // 21
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local6,   // 22
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local7    // 23
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span></code></pre> <h3 id=syslog-type-message><a aria-label="Anchor link for: syslog-type-message" class=zola-anchor href=#syslog-type-message><i class=icon></i></a> Syslog type message</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>TypeDefinition <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public enum Syslog_Severity {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Emergency,     // 0 emerg
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Alert,         // 1 alert
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Critical,      // 2 crit
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Error,         // 3 err
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Warning,       // 4 warning
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Notice,        // 5 notice
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Informational, // 6 info
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Debug          // 7 debug
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span></code></pre> <h2 id=atlassian><a aria-label="Anchor link for: atlassian" class=zola-anchor href=#atlassian><i class=icon></i></a> Atlassian</h2> <h3 id=bitbucket><a aria-label="Anchor link for: bitbucket" class=zola-anchor href=#bitbucket><i class=icon></i></a> Bitbucket</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/AtlassianPS/BitbucketPS/archive/refs/heads/master.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\BitbucketPS.zip
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\BitbucketPS.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutputPath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Copy-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\BitbucketPS-master\*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Destination <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>PSModulePath<span class="z-variable z-other z-member z-powershell">.Split</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\PSBitBucket<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\Bitbucket*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></code></pre> <p><code>Import-Module PSBitBucket</code> <br> <code>Get-Command -Module PSBitBucket</code> <br> <code>Set-BitBucketConfigServer -Url $url -User username -Password password</code> установить конфигурацию сервера BitBucket <br> <code>Get-BitBucketConfigServer</code> получить текущую конфигурацию сервера BitBucket <br> <code>Get-Repositories</code> получить список всех репозиториев для текущей конфигурации сервера BitBucket <br> <code>Get-ProjectKey</code> получить ключ проекта BitBucket <br> <code>Get-BranchList -Repository pSyslog</code> список всех веток в репозитории <br> <code>Get-Branch -Repository pSyslog -Branch main</code> получить информацию о конкретной ветке репозитория <br> <code>Get-CommitMessage -Repository pSyslog -CommitHash $hash</code> получить сообщение коммита по его хэшу <br> <code>Get-Commits -Repository pSyslog -Limit 10</code> список последних 10 коммитов в репозитории <br> <code>Get-CommitsForBranch -Repository pSyslog -Branch main</code> список коммитов для конкретной ветки в репозитории</p> <h3 id=jira><a aria-label="Anchor link for: jira" class=zola-anchor href=#jira><i class=icon></i></a> Jira</h3> <p><code>Install-Module JiraPS -Scope CurrentUser -Repository PSGallery -AllowClobber -Force</code> <br> <code>Get-Command -Module JiraPS</code> <br> <code>Get-JiraServerInfo</code> информация о сервере <br> <code>Add-JiraFilterPermission</code> добавить разрешения для фильтра <br> <code>Add-JiraGroupMember</code> добавить участника в группу <br> <code>Add-JiraIssueAttachment</code> добавить вложения к задаче <br> <code>Add-JiraIssueComment</code> добавить комментария к задаче <br> <code>Add-JiraIssueLink</code> добавить ссылки на задачу <br> <code>Add-JiraIssueWatcher</code> добавить наблюдателя к задаче <br> <code>Add-JiraIssueWorklog</code> добавить рабочего журнала к задаче <br> <code>Find-JiraFilter</code> поиск фильтра <br> <code>Format-Jira</code> форматирование данных Jira <br> <code>Get-JiraComponent</code> получение компонента проекта <br> <code>Get-JiraConfigServer</code> получение конфигурации сервера Jira <br> <code>Get-JiraField</code> получение поля Jira <br> <code>Get-JiraFilter</code> получение фильтра <br> <code>Get-JiraFilterPermission</code> получение разрешения фильтра <br> <code>Get-JiraGroup</code> получение группы <br> <code>Get-JiraGroupMember</code> получение участников группы <br> <code>Get-JiraIssue</code> получение задачи <br> <code>Get-JiraIssueAttachment</code> получение вложения задачи <br> <code>Get-JiraIssueAttachmentFile</code> получение файла вложения задачи <br> <code>Get-JiraIssueComment</code> получение комментария задачи <br> <code>Get-JiraIssueCreateMetadata</code> получение метаданных создания задачи <br> <code>Get-JiraIssueEditMetadata</code> получение метаданных редактирования задачи <br> <code>Get-JiraIssueLink</code> получение ссылки задачи <br> <code>Get-JiraIssueLinkType</code> получение типа ссылки задачи <br> <code>Get-JiraIssueType</code> получение типа задачи <br> <code>Get-JiraIssueWatcher</code> получение наблюдателя задачи <br> <code>Get-JiraIssueWorklog</code> получение рабочего журнала задачи <br> <code>Get-JiraPriority</code> получение приоритета задачи <br> <code>Get-JiraProject</code> получение проекта <br> <code>Get-JiraRemoteLink</code> получение удаленной ссылки <br> <code>Get-JiraServerInformation</code> получение информации о сервере Jira <br> <code>Get-JiraSession</code> получение сессии <br> <code>Get-JiraUser</code> получение пользователя <br> <code>Get-JiraVersion</code> получение версии проекта <br> <code>Invoke-JiraIssueTransition</code> выполнение перехода задачи <br> <code>Invoke-JiraMethod</code> выполнение метода Jira <br> <code>Move-JiraVersion</code> перемещение версии проекта <br> <code>New-JiraFilter</code> создание нового фильтра <br> <code>New-JiraGroup</code> создание новой группы <br> <code>New-JiraIssue</code> создание новой задачи <br> <code>New-JiraSession</code> создание новой сессии <br> <code>New-JiraUser</code> создание нового пользователя <br> <code>New-JiraVersion</code> создание новой версии проекта <br> <code>Remove-JiraFilter</code> удаление фильтра <br> <code>Remove-JiraFilterPermission</code> удаление разрешения фильтра <br> <code>Remove-JiraGroup</code> удаление группы <br> <code>Remove-JiraGroupMember</code> удаление участника группы <br> <code>Remove-JiraIssue</code> удаление задачи <br> <code>Remove-JiraIssueAttachment</code> удаление вложения задачи <br> <code>Remove-JiraIssueLink</code> удаление ссылки задачи <br> <code>Remove-JiraIssueWatcher</code> удаление наблюдателя задачи <br> <code>Remove-JiraRemoteLink</code> удаление удаленной ссылки <br> <code>Remove-JiraSession</code> удаление сессии <br> <code>Remove-JiraUser</code> удаление пользователя <br> <code>Remove-JiraVersion</code> удаление версии проекта <br> <code>Set-JiraConfigServer</code> установка конфигурации сервера Jira <br> <code>Set-JiraFilter</code> установка фильтра <br> <code>Set-JiraIssue</code> установка задачи <br> <code>Set-JiraIssueLabel</code> установка метки задачи <br> <code>Set-JiraUser</code> установка пользователя <br> <code>Set-JiraVersion</code> установка версии проекта</p> <h3 id=confluence><a aria-label="Anchor link for: confluence" class=zola-anchor href=#confluence><i class=icon></i></a> Confluence</h3> <p><code>Install-Module ConfluencePS -Scope CurrentUser -Repository PSGallery -AllowClobber -Force</code> <br> <code>Get-Command -Module ConfluencePS</code> <br> <code>Add-ConfluenceAttachment</code> добавить вложения к странице <br> <code>Add-ConfluenceLabel</code> добавить метки к странице <br> <code>ConvertTo-ConfluenceStorageFormat</code> конвертация содержимого в формат хранения Confluence <br> <code>ConvertTo-ConfluenceTable</code> конвертация данных в таблицу Confluence <br> <code>Get-ConfluenceAttachment</code> получение вложения страницы <br> <code>Get-ConfluenceAttachmentFile</code> получение файла вложения страницы <br> <code>Get-ConfluenceChildPage</code> получение дочерних страниц <br> <code>Get-ConfluenceLabel</code> получение меток страницы <br> <code>Get-ConfluencePage</code> получение информации о странице <br> <code>Get-ConfluenceSpace</code> получение информации о пространстве <br> <code>Invoke-ConfluenceMethod</code> выполнение метода Confluence <br> <code>New-ConfluencePage</code> создание новой страницы <br> <code>New-ConfluenceSpace</code> создание нового пространства <br> <code>Remove-ConfluenceAttachment</code> удаление вложения страницы <br> <code>Remove-ConfluenceLabel</code> удаление метки со страницы <br> <code>Remove-ConfluencePage</code> удаление страницы <br> <code>Remove-ConfluenceSpace</code> удаление пространства <br> <code>Set-ConfluenceAttachment</code> установка вложения страницы <br> <code>Set-ConfluenceInfo</code> установка информации о странице <br> <code>Set-ConfluenceLabel</code> установка метки страницы <br> <code>Set-ConfluencePage</code> установка страницы</p> <h2 id=pester><a aria-label="Anchor link for: pester" class=zola-anchor href=#pester><i class=icon></i></a> Pester</h2> <p><a href=https://github.com/pester/Pester>Source</a></p> <p><code>Install-Module -Name Pester -Repository PSGallery -Force -AllowClobber</code> <br> <code>Import-Module Pester</code> <br> <code>$(Get-Module Pester -ListAvailable).Version</code></p> <p><code>.Tests.ps1</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Add-Numbers</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>a</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>b</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>a</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>b</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">Describe <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Add-Numbers<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Context <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>При сложении двух чисел<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        It <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Должна вернуться правильная сумма<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Add-Numbers</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>a <span class="z-constant z-numeric z-integer z-powershell">3</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>b <span class="z-constant z-numeric z-integer z-powershell">4</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-other z-powershell">|</span> Should <span class="z-keyword z-operator z-assignment z-powershell">-</span>Be <span class="z-constant z-numeric z-integer z-powershell">7</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Context <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>При сложении двух чисел<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        It <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Должна вернуться ошибка (5+0 -ne 4)<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Add-Numbers</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>a <span class="z-constant z-numeric z-integer z-powershell">5</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>b <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-other z-powershell">|</span> Should <span class="z-keyword z-operator z-assignment z-powershell">-</span>Be <span class="z-constant z-numeric z-integer z-powershell">4</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-RunningProcess</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">return</span> <span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ExpandProperty Name
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">Describe <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Get-RunningProcess<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Context <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>При наличии запущенных процессов<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        It <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Должен возвращать список имен процессов<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-RunningProcess</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-other z-powershell">|</span> Should <span class="z-keyword z-operator z-assignment z-powershell">-</span>Contain <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>svchost<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-other z-powershell">|</span> Should <span class="z-keyword z-operator z-assignment z-powershell">-</span>Contain <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>explorer<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Context <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Когда нет запущенных процессов<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        It <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Должен возвращать пустой список<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Замокать функцию Get-Process, чтобы она всегда возвращала пустой список процессов<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            Mock <span class="z-support z-function z-powershell">Get-Process</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-keyword z-control z-powershell">return</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-RunningProcess</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-other z-powershell">|</span> Should <span class="z-keyword z-operator z-assignment z-powershell">-</span>BeEmpty
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <h2 id=dsc><a aria-label="Anchor link for: dsc" class=zola-anchor href=#dsc><i class=icon></i></a> DSC</h2> <p><code>Import-Module PSDesiredStateConfiguration</code> <br> <code>Get-Command -Module PSDesiredStateConfiguration</code> <br> <code>(Get-Module PSDesiredStateConfiguration).ExportedCommands</code> <br> <code>Get-DscLocalConfigurationManager</code></p> <p><code>Get-DscResource</code> <br> <code>Get-DscResource -Name File -Syntax</code> <a href="https://learn.microsoft.com/ru-ru/powershell/dsc/reference/resources/windows/fileresource?view=dsc-1.1">синтаксис</a></p> <p><code>Ensure = Present</code> настройка должна быть включена (каталог должен присутствовать, процесс должен быть запущен, если нет – создать, запустить) <br> <code>Ensure = Absent</code> настройка должна быть выключена (каталога быть не должно, процесс не должен быть запущен, если нет – удалить, остановить)</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">Configuration</span> <span class="z-entity z-name z-function z-powershell">TestConfiguraion</span></span>
</span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Ctrl<span class="z-keyword z-operator z-assignment z-powershell">+</span>Space
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">Configuration</span> <span class="z-entity z-name z-function z-powershell">DSConfigurationProxy</span></span> 
</span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Node vproxy<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">01</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        File CreateDir
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            Ensure <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Present<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            Type <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Directory<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            DestinationPath <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Temp<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        Service StopW32time
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            Name <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>w32time<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            State <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Stopped<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> Running
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">		WindowsProcess RunCalc
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            Ensure <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Present<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            Path <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\WINDOWS\system32\calc.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            Arguments <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        Registry RegSettings
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            Ensure <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Present<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            Key <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>HKEY_LOCAL_MACHINE\SOFTWARE\MySoft<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            ValueName <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>TestName<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            ValueData <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>TestValue<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            ValueType <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>String<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>		WindowsFeature IIS<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>       {<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>            Ensure = "Present"<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>            Name = "Web-Server"<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>       }<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>$Path = (DSConfigurationProxy).DirectoryName</code> <br> <code>Test-DscConfiguration -Path $Path | select *</code> ResourcesInDesiredState - уже настроено, ResourcesNotInDesiredState - не настроено (не соответствует) <br> <code>Start-DscConfiguration -Path $Path</code> <br> <code>Get-Job</code> <br> <code>$srv = "vproxy-01"</code> <br> <code>Get-Service -ComputerName $srv | ? name -match w32time # Start-Service</code> <br> <code>icm $srv {Get-Process | ? ProcessName -match calc} | ft # Stop-Process -Force</code> <br> <code>icm $srv {ls C:\ | ? name -match Temp} | ft</code> rm`</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">Configuration</span> <span class="z-entity z-name z-function z-powershell">InstallPowerShellCore</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Import-DscResource</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ModuleName PSDesiredStateConfiguration
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Node localhost <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        Script InstallPowerShellCore <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            GetScript <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-keyword z-control z-powershell">return</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">                    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">GetScript</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>GetScript</span>
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            SetScript <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">				<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">api.github.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>repos<span class="z-keyword z-operator z-assignment z-powershell">/</span>PowerShell<span class="z-keyword z-operator z-assignment z-powershell">/</span>PowerShell<span class="z-keyword z-operator z-assignment z-powershell">/</span>releases<span class="z-keyword z-operator z-assignment z-powershell">/</span>latest<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.assets.browser_download_url <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>win-x64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\PowerShell.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>installPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>ProgramFiles</span>\PowerShell\7<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-support z-function z-powershell">Invoke-WebRequest</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadPath</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadPath</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>DestinationPath <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>installPath</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            TestScript <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-keyword z-control z-powershell">return</span> <span class="z-support z-function z-powershell">Test-Path</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>ProgramFiles</span>\PowerShell\7\pwsh.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>$Path = (InstallPowerShellCore).DirectoryName</code> <br> <code>Test-DscConfiguration -Path $Path</code> <br> <code>Start-DscConfiguration -Path $path -Wait -Verbose</code> <br> <code>Get-Job</code></p> <h2 id=psappdeploytoolkit><a aria-label="Anchor link for: psappdeploytoolkit" class=zola-anchor href=#psappdeploytoolkit><i class=icon></i></a> PSAppDeployToolkit</h2> <h3 id=install-deploytoolkit><a aria-label="Anchor link for: install-deploytoolkit" class=zola-anchor href=#install-deploytoolkit><i class=icon></i></a> Install-DeployToolkit</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>githubRepository</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>psappdeploytoolkit/psappdeploytoolkit<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>filenamePatternMatch</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>PSAppDeployToolkit*.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>psadtReleaseUri</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.github.com/repos/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>githubRepository</span>/releases/latest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>psadtDownloadUri</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method GET <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>psadtReleaseUri</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.assets <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> name <span class="z-keyword z-operator z-comparison z-powershell">-like</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>filenamePatternMatch</span> </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.browser_download_url
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipExtractionPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Join-Path</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>USERPROFILE</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Downloads<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>PSAppDeployToolkit<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipTempDownloadPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Join-Path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.Path</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetTempPath<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ChildPath <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Split-Path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>psadtDownloadUri</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Leaf<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span># Download to a temporary folder<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-WebRequest</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>psadtDownloadUri</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Out <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipTempDownloadPath</span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span># Remove any Zone.Identifier alternate data streams to unblock the file (if required)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Unblock-File</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipTempDownloadPath</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Type Directory <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipExtractionPath</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipTempDownloadPath</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutputPath <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipExtractionPath</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>File: {0} extracted to Path: {1}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>psadtDownloadUri</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipExtractionPath</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ForegroundColor Yellow
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipTempDownloadPath</span>
</span></code></pre> <h3 id=deploy-notepad-plus-plus><a aria-label="Anchor link for: deploy-notepad-plus-plus" class=zola-anchor href=#deploy-notepad-plus-plus><i class=icon></i></a> Deploy-Notepad-Plus-Plus</h3> <p><code>$url_notepad = "https://github.com/notepad-plus-plus/notepad-plus-plus/releases/download/v8.6.6/npp.8.6.6.Installer.x64.exe"</code> <br> <code>Invoke-RestMethod $url_notepad -OutFile "$home\Downloads\PSAppDeployToolkit\Toolkit\Files\npp.8.6.6.Installer.x64.exe"</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span># Подключаем модуль PSAppDeployToolkit
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">Import-Module "$PSScriptRoot\AppDeployToolkit\AppDeployToolkitMain.ps1"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"># Название приложения
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">$AppName = "Notepad++"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"># Версия приложения
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">$AppVersion = "8.6.6"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"># Путь к установщику Notepad++
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">$InstallerPath = "$PSScriptRoot\Files\npp.$AppVersion.Installer.x64.exe"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"># Проверка существования установщика
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">If (-not (Test-Path $InstallerPath)) {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    Write-Host "Установщик Notepad++ не найден: $InstallerPath"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    Exit-Script -ExitCode 1
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"># Настройки установки Notepad++
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">$InstallerArguments = "/S /D=$ProgramFiles\Notepad++"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">Function Install-Application {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    # Выводим сообщение о начале установки
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    Show-InstallationWelcome -CloseApps "iexplore" -CheckDiskSpace -PersistPrompt
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    # Запускаем установку
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    Execute-Process -Path $InstallerPath -Parameters $InstallerArguments -WindowStyle Hidden -IgnoreExitCodes "3010"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    # Выводим сообщение об успешной установке
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    Show-InstallationPrompt -Message "Установка $AppName завершена." -ButtonRightText "Закрыть" -Icon Information -NoWait
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    # Завершаем процесс установки
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    Exit-Script -ExitCode $AppDependentExitCode
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">Install-Application<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\PSAppDeployToolkit\Toolkit\Deploy-Application.ps1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Encoding unicode
</span></code></pre> <p><code>powershell -File "$home\Downloads\PSAppDeployToolkit\Toolkit\Deploy-Application.ps1"</code></p> <h3 id=uninstall-notepad-plus-plus><a aria-label="Anchor link for: uninstall-notepad-plus-plus" class=zola-anchor href=#uninstall-notepad-plus-plus><i class=icon></i></a> Uninstall-Notepad-Plus-Plus</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Import-Module "$PSScriptRoot\AppDeployToolkit\AppDeployToolkitMain.ps1"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">$AppName = "Notepad++"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">$UninstallerPath = "C:\Program Files\Notepad++\uninstall.exe"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">If (-not (Test-Path $UninstallerPath)) {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    Write-Host "Деинсталлятор Notepad++ не найден: $UninstallerPath"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    Exit-Script -ExitCode 1
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">Function Uninstall-Application {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    Show-InstallationWelcome -CloseApps "iexplore" -CheckDiskSpace -PersistPrompt
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    Execute-Process -Path $UninstallerPath -Parameters "/S" -WindowStyle Hidden -IgnoreExitCodes "3010"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    Show-InstallationPrompt -Message "Программа $AppName удалена." -ButtonRightText "Закрыть" -Icon Information -NoWait
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    Exit-Script -ExitCode $AppDependentExitCode
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">Uninstall-Application<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\PSAppDeployToolkit\Toolkit\Deploy-Application.ps1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Encoding unicode
</span></code></pre> <p><code>powershell -File "$home\Downloads\PSAppDeployToolkit\Toolkit\Deploy-Application.ps1"</code></p> <h3 id=deploy-winscp><a aria-label="Anchor link for: deploy-winscp" class=zola-anchor href=#deploy-winscp><i class=icon></i></a> Deploy-WinSCP</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PSAppDeployToolkit</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\PSAppDeployToolkit\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>version</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>6.3.3<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url_winscp</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://cdn.winscp.net/files/WinSCP-<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>version</span>.msi?secure=P2HLWGKaMDigpDQw-H9BgA==,1716466173<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WinSCP_Template</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Content</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PSAppDeployToolkit</span>\Examples\WinSCP\Deploy-Application.ps1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> читаем пример конфигурации для WinSCP<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WinSCP_Template_Latest</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WinSCP_Template</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>6.3.2<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>version</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> обновляем версию на актуальную<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WinSCP_Template_Latest</span> <span class="z-keyword z-operator z-redirection z-powershell">></span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PSAppDeployToolkit</span>\Toolkit\Deploy-Application.ps1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> заменяем скрипт развертывания <span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url_winscp</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PSAppDeployToolkit</span>\Toolkit\Files\WinSCP-<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>version</span>.msi<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> загружаем msi-пакет<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">powershell <span class="z-keyword z-operator z-assignment z-powershell">-</span>File <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PSAppDeployToolkit</span>\Toolkit\Deploy-Application.ps1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> запускаем установку<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <h2 id=load-testing><a aria-label="Anchor link for: load-testing" class=zola-anchor href=#load-testing><i class=icon></i></a> Load Testing</h2> <h3 id=apache-benchmark><a aria-label="Anchor link for: apache-benchmark" class=zola-anchor href=#apache-benchmark><i class=icon></i></a> Apache Benchmark</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HOME</span>\Downloads\apache<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Type Directory
</span><span class="z-source z-powershell">cd <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>
</span><span class="z-source z-powershell">curl <span class="z-keyword z-operator z-assignment z-powershell">-</span>L <span class="z-keyword z-operator z-assignment z-powershell">-</span>o apache.zip <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://www.apachelounge.com/download/VS17/binaries/httpd-2.4.63-250207-win64-VS17.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path apache.zip
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Copy-Item</span> .\Apache24\bin\ <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HOME</span>\Documents\apache\ <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span><span class="z-source z-powershell">cd .<span class="z-keyword z-operator z-other z-powershell">.</span> <span class="z-punctuation z-terminator z-statement z-powershell">&&</span> <span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HOME</span>\Downloads\apache<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span></code></pre> <p><code>$ab = "$HOME\Documents\apache\ab.exe"</code> <br> <code>. $ab -n 10000 -c 100 http://192.168.3.100:8444/api/provider/list</code></p> <pre class=z-code><code><span class="z-text z-plain">Количество одновременных запросов:  100
</span><span class="z-text z-plain">Время проведения тестов:            52,402 секунды
</span><span class="z-text z-plain">Выполненные запросы:                10000
</span><span class="z-text z-plain">Неудачные запросы:                  0
</span><span class="z-text z-plain">Передано всего:                     6830000 байтов
</span><span class="z-text z-plain">Передано HTML:                      3290000 байт
</span><span class="z-text z-plain">RPS (Requests Per Second):          190,83 [#/sec] (среднее)
</span><span class="z-text z-plain">Время одного запроса:               524.017 [MS] (среднее)
</span><span class="z-text z-plain">Время одного запроса:               5.240 [MS] (среднее, во всех одновременных запросах)
</span><span class="z-text z-plain">Скорость передачи:                  127,28 [Kbytes/Sec]
</span></code></pre> <h3 id=locust><a aria-label="Anchor link for: locust" class=zola-anchor href=#locust><i class=icon></i></a> Locust</h3> <p><a href=https://github.com/locustio/locust>Locust</a> - это инструмент нагрузочного тестирования для <code>HTTP</code> и других протоколов на <code>Python</code>.</p> <p><code>pip3 install locust</code></p> <pre class="language-Python z-code" data-lang=Python><code class=language-Python data-lang=Python><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">echo</span></span> <span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">'</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-invalid z-illegal z-unclosed-string z-python">
</span></span></span></span><span class="z-source z-python"><span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-python">import</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">os</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-from z-python">from</span></span><span class="z-meta z-statement z-import z-python"><span class="z-meta z-import-source z-python"> <span class="z-meta z-import-path z-python"><span class="z-meta z-import-name z-python">locust</span></span> <span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-python">import</span></span></span></span><span class="z-meta z-statement z-import z-python"></span><span class="z-meta z-statement z-import z-python"> <span class="z-meta z-generic-name z-python">HttpUser</span><span class="z-punctuation z-separator z-import-list z-python">,</span> <span class="z-meta z-generic-name z-python">task</span><span class="z-punctuation z-separator z-import-list z-python">,</span> <span class="z-meta z-generic-name z-python">between</span></span>
</span><span class="z-source z-python"><span class="z-meta z-class z-python"><span class="z-storage z-type z-class z-python"><span class="z-keyword z-declaration z-class z-python">class</span></span> <span class="z-entity z-name z-class z-python"><span class="z-meta z-generic-name z-python">TorApiUser</span></span><span class="z-meta z-class z-inheritance z-python"><span class="z-punctuation z-section z-inheritance z-begin z-python">(</span></span></span><span class="z-meta z-class z-inheritance z-python"><span class="z-entity z-other z-inherited-class z-python">HttpUser</span><span class="z-punctuation z-section z-inheritance z-end z-python">)</span></span><span class="z-meta z-class z-python"><span class="z-punctuation z-section z-class z-begin z-python">:</span></span>
</span><span class="z-source z-python">    <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> Каждый виртуальный пользователь будет ждать от 2 до 5 секунд перед выполнением следующего @task
</span></span><span class="z-source z-python">    <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">wait_time</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">between</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-decimal z-python">2</span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-constant z-numeric z-integer z-decimal z-python">5</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">    <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> Определяем заголовки запросов
</span></span><span class="z-source z-python">    <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">headers</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-mapping-or-set z-python"><span class="z-punctuation z-section z-mapping-or-set z-begin z-python">{</span>
</span></span><span class="z-source z-python"><span class="z-meta z-mapping-or-set z-python"></span><span class="z-meta z-mapping z-python">        </span><span class="z-meta z-mapping z-key z-python"><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">User-Agent<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span></span><span class="z-meta z-mapping z-python"><span class="z-punctuation z-separator z-mapping z-key-value z-python">:</span></span><span class="z-meta z-mapping z-python"> </span><span class="z-meta z-mapping z-value z-python"><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">Locust<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span>
</span></span><span class="z-source z-python"><span class="z-meta z-mapping z-value z-python"></span><span class="z-meta z-mapping z-python">    <span class="z-punctuation z-section z-mapping z-end z-python">}</span></span>
</span><span class="z-source z-python">    <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> Получаем параметры из переменных окружения или использовать значение по умолчанию
</span></span><span class="z-source z-python">    <span class="z-meta z-qualified-name z-python"><span class="z-variable z-other z-constant z-python">QUERY</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">os</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">getenv</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">QUERY<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">test<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">    <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> GET запросы (вес приоритета задачи для частоты ее выполнения, чем выше, тем чаще выполнение)
</span></span><span class="z-source z-python">    <span class="z-meta z-annotation z-python"><span class="z-punctuation z-definition z-annotation z-python">@</span><span class="z-meta z-annotation z-function z-python"></span></span><span class="z-meta z-annotation z-function z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-annotation z-function z-python"><span class="z-meta z-generic-name z-python">task</span></span></span></span><span class="z-meta z-annotation z-function z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span></span><span class="z-meta z-annotation z-arguments z-python"><span class="z-constant z-numeric z-integer z-decimal z-python">1</span></span><span class="z-meta z-annotation z-function z-python"><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python"><span class="z-meta z-function z-python">    <span class="z-storage z-type z-function z-python"><span class="z-keyword z-declaration z-function z-python">def</span></span> <span class="z-entity z-name z-function z-python"><span class="z-meta z-generic-name z-python">test_status</span></span></span><span class="z-meta z-function z-parameters z-python"><span class="z-punctuation z-section z-parameters z-begin z-python">(</span></span><span class="z-meta z-function z-parameters z-python"><span class="z-variable z-parameter z-python">self</span><span class="z-punctuation z-section z-parameters z-end z-python">)</span></span><span class="z-meta z-function z-python"><span class="z-punctuation z-section z-function z-begin z-python">:</span></span>
</span><span class="z-source z-python">        <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-language z-python">self</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">client</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">get</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">/api/provider/list<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">headers</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-language z-python">self</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">headers</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">    <span class="z-meta z-annotation z-python"><span class="z-punctuation z-definition z-annotation z-python">@</span><span class="z-meta z-annotation z-function z-python"></span></span><span class="z-meta z-annotation z-function z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-annotation z-function z-python"><span class="z-meta z-generic-name z-python">task</span></span></span></span><span class="z-meta z-annotation z-function z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span></span><span class="z-meta z-annotation z-arguments z-python"><span class="z-constant z-numeric z-integer z-decimal z-python">2</span></span><span class="z-meta z-annotation z-function z-python"><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python"><span class="z-meta z-function z-python">    <span class="z-storage z-type z-function z-python"><span class="z-keyword z-declaration z-function z-python">def</span></span> <span class="z-entity z-name z-function z-python"><span class="z-meta z-generic-name z-python">test_search</span></span></span><span class="z-meta z-function z-parameters z-python"><span class="z-punctuation z-section z-parameters z-begin z-python">(</span></span><span class="z-meta z-function z-parameters z-python"><span class="z-variable z-parameter z-python">self</span><span class="z-punctuation z-section z-parameters z-end z-python">)</span></span><span class="z-meta z-function z-python"><span class="z-punctuation z-section z-function z-begin z-python">:</span></span>
</span><span class="z-source z-python">        <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> Словарь параметров, который автоматически конвертируется в строку запроса (?key=value&key2=value2)
</span></span><span class="z-source z-python">        <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">searchParams</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-mapping-or-set z-python"><span class="z-punctuation z-section z-mapping-or-set z-begin z-python">{</span>
</span></span><span class="z-source z-python"><span class="z-meta z-mapping-or-set z-python"></span><span class="z-meta z-mapping z-python">            </span><span class="z-meta z-mapping z-key z-python"><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">query<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span></span><span class="z-meta z-mapping z-python"><span class="z-punctuation z-separator z-mapping z-key-value z-python">:</span></span><span class="z-meta z-mapping z-python"> </span><span class="z-meta z-mapping z-value z-python"><span class="z-meta z-set z-python"><span class="z-punctuation z-section z-set z-begin z-python">{</span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-language z-python">self</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-variable z-other z-constant z-python">QUERY</span></span><span class="z-punctuation z-section z-set z-end z-python">}</span></span></span><span class="z-meta z-mapping z-python"><span class="z-punctuation z-separator z-mapping z-python">,</span>
</span></span><span class="z-source z-python"><span class="z-meta z-mapping z-python">            </span><span class="z-meta z-mapping z-key z-python"><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">category<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span></span><span class="z-meta z-mapping z-python"><span class="z-punctuation z-separator z-mapping z-key-value z-python">:</span></span><span class="z-meta z-mapping z-python"> </span><span class="z-meta z-mapping z-value z-python"><span class="z-constant z-numeric z-integer z-decimal z-python">0</span></span><span class="z-meta z-mapping z-python"><span class="z-punctuation z-separator z-mapping z-python">,</span>
</span></span><span class="z-source z-python"><span class="z-meta z-mapping z-python">            </span><span class="z-meta z-mapping z-key z-python"><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">page<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span></span><span class="z-meta z-mapping z-python"><span class="z-punctuation z-separator z-mapping z-key-value z-python">:</span></span><span class="z-meta z-mapping z-python"> </span><span class="z-meta z-mapping z-value z-python"><span class="z-constant z-numeric z-integer z-decimal z-python">0</span>
</span></span><span class="z-source z-python"><span class="z-meta z-mapping z-value z-python"></span><span class="z-meta z-mapping z-python">        <span class="z-punctuation z-section z-mapping z-end z-python">}</span></span>
</span><span class="z-source z-python">        <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-language z-python">self</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">client</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">get</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">/api/search/title/rutracker<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">headers</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-language z-python">self</span><span class="z-punctuation z-accessor z-dot z-python">.</span><span class="z-meta z-generic-name z-python">headers</span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-variable z-parameter z-python">params</span><span class="z-keyword z-operator z-assignment z-python">=</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">searchParams</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">    <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> POST запрос с телом запроса
</span></span><span class="z-source z-python">    <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> @task(3)
</span></span><span class="z-source z-python">    <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> def test_post_auth(self):
</span></span><span class="z-source z-python">    <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span>     self.client.post("/api/auth", json={"username": "admin", "password": "password"})
</span></span><span class="z-source z-python"><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"><span class="z-punctuation z-definition z-string z-begin z-python">'</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-single z-python"> > locustfile.py<span class="z-invalid z-illegal z-unclosed-string z-python">
</span></span></span></span></code></pre> <p><code>locust -f locustfile.py --host http://192.168.3.100:8444</code> <br> <code>$env:QUERY = "The+Rookie"</code> определяем переменную окружения для параметра запросов <br> <code>locust -f locustfile.py --host http://192.168.3.100:8444 -u 10 -r 2 -t 30s</code> количество виртуальных пользователей (VU), частота появления новых пользователей в секунду (10 пользователей будут созданы за 5 секунд) и длительность 30 секунд <br> <code>locust -f locustfile.py --host http://192.168.3.100:8444 -u 10 -r 2 -t 30s --headless --csv locustresult</code> запуск без веб-интерфейса с выгрузкой результатов в csv файлы</p> <p>Запуск Web-интерфейса в контейнере Docker:</p> <p><code>mkdir locust && cd locust</code></p> <pre class="language-dockerfile z-code" data-lang=dockerfile><code class=language-dockerfile data-lang=dockerfile><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">FROM</span> alpine:<span class="z-entity z-name z-enum z-tag-digest">latest</span>
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">RUN </span>apk add --no-cache python3 py3-pip gcc musl-dev linux-headers python3-dev
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">RUN </span>python3 -m venv /venv
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">RUN </span>/venv/bin/pip install --no-cache-dir locust
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">ENV </span>PATH=<span class="z-string z-quoted z-double z-dockerfile"><span class="z-punctuation z-definition z-string z-begin z-dockerfile">"</span>/venv/bin:$PATH<span class="z-punctuation z-definition z-string z-end z-dockerfile">"</span></span>
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">COPY</span> locustfile.py .
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">EXPOSE </span>8089
</span><span class="z-source z-dockerfile"><span class="z-keyword z-operator z-dockerfile">CMD </span>[<span class="z-string z-quoted z-double z-dockerfile"><span class="z-punctuation z-definition z-string z-begin z-dockerfile">"</span>locust<span class="z-punctuation z-definition z-string z-end z-dockerfile">"</span></span>, <span class="z-string z-quoted z-double z-dockerfile"><span class="z-punctuation z-definition z-string z-begin z-dockerfile">"</span>-f<span class="z-punctuation z-definition z-string z-end z-dockerfile">"</span></span>, <span class="z-string z-quoted z-double z-dockerfile"><span class="z-punctuation z-definition z-string z-begin z-dockerfile">"</span>/locustfile.py<span class="z-punctuation z-definition z-string z-end z-dockerfile">"</span></span>]
</span></code></pre> <p><code>sudo docker build -t locust-alpine-web . && sudo docker run -d --name locust -p 8089:8089 --restart=unless-stopped locust-alpine-web</code></p> <h2 id=llm><a aria-label="Anchor link for: llm" class=zola-anchor href=#llm><i class=icon></i></a> LLM</h2> <h2 id=openai><a aria-label="Anchor link for: openai" class=zola-anchor href=#openai><i class=icon></i></a> OpenAI</h2> <p>Пример запроса для перевода текста</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>The OpenAI API uses API keys for authentication. You can create API keys at a user or service account level.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> https://platform.openai.com/docs/api-reference/authentication<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>toLang</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Russian<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>presetPrompt</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Translate the following text into <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>toLang</span> :
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">Respond ONLY with the translated text. Do not include any other explanations, context, or comments.
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>apiKey</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>sk-proj-XXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>apiUrl</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.openai.com/v1/chat/completions<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">model</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>gpt-4o-mini<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">messages</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">role</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>user<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">content</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>presetPrompt</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">temperature</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-constant z-numeric z-integer z-powershell">0.7</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Depth <span class="z-constant z-numeric z-integer z-powershell">10</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Compress
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>apiUrl</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method Post <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Content-Type<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Bearer <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>apiKey</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.choices.message.content</span></span>
</span></code></pre> <h2 id=mock><a aria-label="Anchor link for: mock" class=zola-anchor href=#mock><i class=icon></i></a> Mock</h2> <p>Создаем серверную заглушку для <code>API</code> OpenAI через <a href=https://github.com/typicode/json-server>JSON Server</a></p> <p><code>npm install -g json-server@0.17.4</code></p> <p>Конфигурация ответов в файле <code>openai.json</code></p> <pre class="language-json z-code" data-lang=json><code class=language-json data-lang=json><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-json">  </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>completions<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">    </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>model<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>gpt-4o-mini-2024-07-18<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">    </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>choices<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-punctuation z-section z-sequence z-begin z-json">[</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">      <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>message<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">          </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>role<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>assistant<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">          </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>content<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>Response from JSON Server<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>finish_reason<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>stop<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">      <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">    <span class="z-punctuation z-section z-sequence z-end z-json">]</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">  <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></code></pre> <p>Настройка маршрутизации в файле <code>routes.json</code></p> <pre class="language-json z-code" data-lang=json><code class=language-json data-lang=json><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-json">    </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>/v1/chat/completions<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>/completions<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></code></pre> <p>Конфигурация сервера в файле <code>json-server.json</code></p> <pre class="language-json z-code" data-lang=json><code class=language-json data-lang=json><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-json">    </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>port<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">3001</span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></code></pre> <p>Запускаем сервер:</p> <p><code>json-server --watch openai.json --routes routes.json</code></p> <p>Делаем запрос:</p> <p><code>$(Invoke-RestMethod -Uri "http://localhost:3001/v1/chat/completions").choices.message.content</code></p> <h2 id=openrouter><a aria-label="Anchor link for: openrouter" class=zola-anchor href=#openrouter><i class=icon></i></a> OpenRouter</h2> <p>Регестрируем аккаунт на <a href=https://openrouter.ai>OpenRouter</a> через Google, выпускаем <a href=https://openrouter.ai/settings/keys>api ключ</a> и выбираем <a href="https://openrouter.ai/models?max_price=0">бесплатную модель</a>.</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OPENROUTER_API_KEY</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>sk-or-v1-KEY<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OPENROUTER_MODEL</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>deepseek/deepseek-r1:free<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Content-Type<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Bearer <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OPENROUTER_API_KEY</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>model<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OPENROUTER_MODEL</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>messages<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell">        <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>role<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>    <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>system<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>content<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Your role is a translator. You only translate the text into Russian and do not analyze the answer.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell">        <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>role<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>    <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>user<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>content<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Hello! I translate the text into English!<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell">    <span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Depth <span class="z-constant z-numeric z-integer z-powershell">10</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Compress
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://openrouter.ai/api/v1/chat/completions<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method Post <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.choices.message.content</span></span>
</span></code></pre> <h2 id=lm-studio><a aria-label="Anchor link for: lm-studio" class=zola-anchor href=#lm-studio><i class=icon></i></a> LM Studio</h2> <p><code>API</code> в <a href=https://lmstudio.ai>LM Studio</a> совместим с OpenAI</p> <p>Получить список моделей:</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://127.0.0.1:1234/v1/models/<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.data.id
</span><span class="z-source z-powershell">deepseek<span class="z-keyword z-operator z-assignment z-powershell">-</span>r1<span class="z-keyword z-operator z-assignment z-powershell">-</span>distill<span class="z-keyword z-operator z-assignment z-powershell">-</span>llama<span class="z-keyword z-operator z-assignment z-powershell">-</span>8b
</span><span class="z-source z-powershell">llama<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">3.2</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>3b<span class="z-keyword z-operator z-assignment z-powershell">-</span>instruct
</span><span class="z-source z-powershell">text<span class="z-keyword z-operator z-assignment z-powershell">-</span>embedding<span class="z-keyword z-operator z-assignment z-powershell">-</span>nomic<span class="z-keyword z-operator z-assignment z-powershell">-</span>embed<span class="z-keyword z-operator z-assignment z-powershell">-</span>text<span class="z-keyword z-operator z-assignment z-powershell">-</span>v1.<span class="z-constant z-numeric z-integer z-powershell">5</span>
</span></code></pre> <p>Режим чата (когда <code>stream</code> установлен в <code>True</code>, ответ приходит по частям):</p> <pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"> http://127.0.0.1:1234/v1/chat/completions <span class="z-meta z-group z-expansion z-command z-backticks z-shell"><span class="z-punctuation z-section z-group z-begin z-shell">`</span>
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-command z-backticks z-shell">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">-H</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Content-Type: application/json<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> </span><span class="z-punctuation z-section z-group z-end z-shell">`</span></span></span>
</span><span class="z-source z-shell z-bash">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">-d</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>{
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">    "model": "deepseek-r1-distill-llama-8b",
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">    "messages": [ 
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">        { "role": "system", "content": "Твоя роль переводчик. Ты только переводишь текст на русский язык и не анализируешь ответ." },
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">        { "role": "user", "content": "Привет! Я перевожу текст на англйский язык!" }
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">    ], 
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">    "temperature": 0.7, 
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">    "max_tokens": -1,
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">    "stream": false
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">}<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span>
</span></code></pre> <h2 id=ollama><a aria-label="Anchor link for: ollama" class=zola-anchor href=#ollama><i class=icon></i></a> Ollama</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell">cd <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>versionLatest</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.github.com/repos/ollama/ollama/releases/latest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.tag_name
</span><span class="z-source z-powershell">irm https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">github.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>ollama<span class="z-keyword z-operator z-assignment z-powershell">/</span>ollama<span class="z-keyword z-operator z-assignment z-powershell">/</span>releases<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>versionLatest<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-assignment z-powershell">/</span>ollama<span class="z-keyword z-operator z-assignment z-powershell">-</span>windows<span class="z-keyword z-operator z-assignment z-powershell">-</span>amd64.zip <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile ollama.zip
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path ollama.zip <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutputPath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.\ollama<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> -DestinationPath for Windows PowerShell 5.1<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> ollama.zip<span class="z-punctuation z-terminator z-statement z-powershell">;</span> cd ollama
</span></code></pre> <p><code>.\ollama serve</code> запускаем сервер <br> <code>.\ollama pull mistral:7b-instruct</code> загружаем модель (https://ollama.com/library/mistral) <br> <code>.\ollama run mistral</code> запустить консоль для общения с LLM в режиме чата</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Отправляем API запрос<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> curl <span class="z-keyword z-operator z-assignment z-powershell">-</span>sS <span class="z-keyword z-operator z-assignment z-powershell">-</span>X POST http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>localhost:<span class="z-constant z-numeric z-integer z-powershell">11434</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>api<span class="z-keyword z-operator z-assignment z-powershell">/</span>generate <span class="z-keyword z-operator z-assignment z-powershell">-</span>d <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">  "model": "mistral",
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">  "prompt":"Return only the word test in the answer"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">}<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Собираем ответ из частей response<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.response.trim<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h2 id=gigachat><a aria-label="Anchor link for: gigachat" class=zola-anchor href=#gigachat><i class=icon></i></a> GigaChat</h2> <h3 id=windows><a aria-label="Anchor link for: windows" class=zola-anchor href=#windows><i class=icon></i></a> Windows</h3> <p><a href=https://developers.sber.ru/gigachat/login>Developers chat</a></p> <ul><li>Установка сертификатов:</ul> <p><code>Invoke-WebRequest "https://gu-st.ru/content/lending/russian_trusted_root_ca_pem.crt" -OutFile "$home\Downloads\russian_trusted_root_ca.cer"</code> скачать сертификат минцифры <br> <code>Invoke-WebRequest "https://gu-st.ru/content/lending/russian_trusted_sub_ca_pem.crt" -OutFile "$home\Downloads\russian_trusted_sub_ca.cer"</code> <br> <code>Import-Certificate -FilePath "$home\Downloads\russian_trusted_root_ca.cer" -CertStoreLocation "Cert:\CurrentUser\Root"</code> установить сертификат минцифры <br> <code>Import-Certificate -FilePath "$home\Downloads\russian_trusted_sub_ca.cer" -CertStoreLocation "Cert:\CurrentUser\CA"</code></p> <ul><li><ol start=2><li>Авторизация по Sber ID и генерация новых авторизационных данных для получения токена: <a href=https://developers.sber.ru/studio>Developers</a> (время жизни 30 минут)</ol><li><ol start=3><li>Формирование авторизационных данных в формате Base64 из Client ID и Client Secret:</ol></ul> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client_ID</span>     <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>7e6d2f9f-825e-49b7-98f4-62fbb7506427<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> [System.Guid]::Parse("7e6d2f9f-825e-49b7-98f4-62fbb7506427")<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client_Secret</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>c35113ee-6757-47ba-9853-ea1d0d9db1ef<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> [System.Guid]::Parse("c35113ee-6757-47ba-9853-ea1d0d9db1ef")<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client_Join</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client_ID</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>:<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client_Secret</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> объединяем два UUID в одну строку, разделяя их символом ':'<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Bytes</span>         <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::UTF8.GetBytes<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client_Join</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> преобразуем строку в массив байт<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cred_Base64</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Convert</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ToBase64String<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Bytes</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> кодируем байты в строку Base64<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <ul><li><ol start=4><li>Получение токена:</ol></ul> <p><code>$Cred_Base64   = "N2U2ZDJmOWYtODI1ZS00OWI3LTk4ZjQtNjJmYmI3NTA2NDI3OmIyYzgwZmZmLTEzOGUtNDg1Mi05MjgwLWE2MGI4NTc0YTM2MQ=="</code> <br> <code>$UUID = [System.Guid]::NewGuid()</code> генерируем UUID для журналирования входящих вызовов и разбора инцидентов</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://ngw.devices.sberbank.ru:9443/api/v2/oauth<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Basic <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cred_Base64</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>RqUID<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UUID</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Content-Type<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/x-www-form-urlencoded<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">scope</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>GIGACHAT_API_PERS<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>GIGA_TOKEN</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.access_token
</span></code></pre> <ul><li><ol start=5><li>Параметры:</ol></ul> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>content</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Посчитай сумму чисел: 22+33<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>role</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>user<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> роль автора сообщения (user/assistant/system)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">float</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temperature</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0.7</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> температура выборки в диапазоне от 0 до 2. Чем выше значение, тем более случайным будет ответ модели.<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">float</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>top_p</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0.1</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> используется как альтернатива temperature и изменяется в диапазоне от 0 до 1. Задает вероятностную массу токенов, которые должна учитывать модель. Так, если передать значение 0.1, модель будет учитывать только токены, чья вероятностная масса входит в верхние 10%.<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int64</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> количество вариантов ответов (1..4), которые нужно сгенерировать для каждого входного сообщения<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int64</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>max_tokens</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">512</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> максимальное количество токенов, которые будут использованы для создания ответов<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">boolean</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stream</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> передавать сообщения по частям в потоке<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <ul><li><ol start=6><li>Составление запросов:</ol></ul> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://gigachat.devices.sberbank.ru/api/v1/chat/completions<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Bearer <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>GIGA_TOKEN</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Content-Type<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://gigachat.devices.sberbank.ru/api/v1/models<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.data <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> список доступных моделей<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">model</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>GigaChat:latest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">messages</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell">        <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">role</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>role</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">content</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>content</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-group z-array-expression z-powershell">    <span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">temperature</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temperature</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">	<span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">n</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">	<span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">max_tokens</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>max_tokens</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">	<span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">stream</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stream</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Request</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Request<span class="z-variable z-other z-member z-powershell">.choices.message.content</span></span>
</span></code></pre> <h3 id=linux><a aria-label="Anchor link for: linux" class=zola-anchor href=#linux><i class=icon></i></a> Linux</h3> <ul><li>Установка сертификатов в Ubuntu:</ul> <p><code>wget https://gu-st.ru/content/lending/russian_trusted_root_ca_pem.crt</code> <br> <code>wget https://gu-st.ru/content/lending/russian_trusted_sub_ca_pem.crt</code> <br> <code>mkdir /usr/local/share/ca-certificates/russian_trusted</code> <br> <code>cp russian_trusted_root_ca_pem.crt russian_trusted_sub_ca_pem.crt /usr/local/share/ca-certificates/russian_trusted</code> <br> <code>update-ca-certificates -v</code> <br> <code>wget -qS --spider --max-redirect=0 https://www.sberbank.ru</code></p> <ul><li>Получение токена:</ul> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">Cred_Base64</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>N2U2ZDJmOWYtODI1ZS00OWI3LTk4ZjQtNjJmYmI3NTA2NDI3OmIyYzgwZmZmLTEzOGUtNDg1Mi05MjgwLWE2MGI4NTc0YTM2MQ==<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">UUID</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">uuidgen</span></span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">GIGA_TOKEN</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>location</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>request</span> POST <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>https://ngw.devices.sberbank.ru:9443/api/v2/oauth<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">--</span>header</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Basic <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">Cred_Base64</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">--</span>header</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>RqUID: <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">UUID</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">--</span>header</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Content-Type: application/x-www-form-urlencoded<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">--</span>data-urlencode</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>scope=GIGACHAT_API_PERS<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>r</span> .access_token</span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span>
</span></code></pre> <p><code>curl -s --location "https://gigachat.devices.sberbank.ru/api/v1/models" --header "Authorization: Bearer $GIGA_TOKEN" | jq .</code> для проверки</p> <ul><li>Составление запроса:</ul> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">request</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span> https://gigachat.devices.sberbank.ru/api/v1/chat/completions <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Content-Type: application/json<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Bearer <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">GIGA_TOKEN</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>d</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>{
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  "model": "GigaChat:latest",
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  "messages": [
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">        {
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">            "role": "user",
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">            "content": "Когда уже ИИ захватит этот мир?"
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">        }
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">    ],
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  "temperature": 0.7
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">}<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">request</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>r</span> .choices<span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span><span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>.message.content</span>
</span></code></pre> <h2 id=yandexgpt><a aria-label="Anchor link for: yandexgpt" class=zola-anchor href=#yandexgpt><i class=icon></i></a> YandexGPT</h2> <ul><li>Получить OAuth-Token:</ul> <p><a href=https://cloud.yandex.ru/ru/docs/iam/operations/iam-token/create>Create AIM Token</a> время жизни IAM-токена не больше 12 часов <br> <code>yandexPassportOauthToken="y0_AgAAAAAGaLFLAATuwQAAAAD3xtRLQE4hvlazQ5euKO43XXXXXXXXXXX"</code> для bash <br> <code>$yandexPassportOauthToken = "y0_AgAAAAAGaLFLAATuwQAAAAD3xtRLQE4hvlazQ5euKO43XXXXXXXXXXX"</code> для PowerShell</p> <ul><li>Обменять OAuth-Token на IAM-Token:</ul> <p><code>IAM_TOKEN=$(curl -s -d "{\"yandexPassportOauthToken\":\"$yandexPassportOauthToken\"}" "https://iam.api.cloud.yandex.net/iam/v1/tokens" | jq -r .iamToken)</code> <br> <code>$IAM_TOKEN = $(Invoke-RestMethod -Method POST -Uri "https://iam.api.cloud.yandex.net/iam/v1/tokens" -Body $(@{yandexPassportOauthToken = "$yandexPassportOauthToken"} | ConvertTo-Json -Compress)).iamToken</code></p> <ul><li>Получить FOLDER_ID:</ul> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">CLOUD_ID</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Bearer <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">IAM_TOKEN</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> https://resource-manager.api.cloud.yandex.net/resource-manager/v1/clouds</span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>r</span> .clouds<span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span><span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>.id</span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> получить cloud id</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>request</span> GET<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Bearer <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">IAM_TOKEN</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>d</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>{<span class="z-constant z-character z-escape z-shell">\"</span>cloudId<span class="z-constant z-character z-escape z-shell">\"</span>: <span class="z-constant z-character z-escape z-shell">\"</span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">CLOUD_ID</span></span><span class="z-constant z-character z-escape z-shell">\"</span>}<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> получить список директорий в облаке</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>request</span> POST<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Bearer <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">IAM_TOKEN</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>d</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>{<span class="z-constant z-character z-escape z-shell">\"</span>cloudId<span class="z-constant z-character z-escape z-shell">\"</span>: <span class="z-constant z-character z-escape z-shell">\"</span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">CLOUD_ID</span></span><span class="z-constant z-character z-escape z-shell">\"</span>, <span class="z-constant z-character z-escape z-shell">\"</span>name<span class="z-constant z-character z-escape z-shell">\"</span>: <span class="z-constant z-character z-escape z-shell">\"</span>test<span class="z-constant z-character z-escape z-shell">\"</span>}<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> создать директорию в облаке</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">FOLDER_ID</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>request</span> GET<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Bearer <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">IAM_TOKEN</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>d</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>{"cloudId": "b1gf9n6heihqj0pt5piu"}<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>r</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>.folders[] | select(.name == "test") | .id<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> забрать id директории</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></code></pre> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CLOUD_ID</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method Get <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://resource-manager.api.cloud.yandex.net/resource-manager/v1/clouds<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Bearer <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IAM_TOKEN</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Content-Type<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.clouds.id
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FOLDER_ID</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method Get <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Bearer <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IAM_TOKEN</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Content-Type<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>cloudId<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CLOUD_ID</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.folders <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> name <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> test <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ExpandProperty id
</span></code></pre> <ul><li>Составление запроса:</ul> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">model</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>gpt://<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">FOLDER_ID</span></span>/yandexgpt/latest<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> https://cloud.yandex.ru/ru/docs/yandexgpt/concepts/models</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">body</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">cat</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-unquoted z-heredoc z-shell"><span class="z-keyword z-operator z-assignment z-redirection z-shell"><<</span><span class="z-keyword z-control z-heredoc-token z-shell">EOF</span></span><span class="z-string z-unquoted z-heredoc z-shell">
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">{
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">  "modelUri": "<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">model</span></span>",
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">  "completionOptions": {
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">    "stream": false,
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">    "temperature": 0.6,
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">    "maxTokens": 2000
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">  },
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">  "messages": [
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">    {
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">      "role": "user",
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">      "text": "Посчитай сумму 22+33"
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">    }
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">  ]
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">}
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">EOF)
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">curl --request POST \
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">  -H "Content-Type: application/json" \
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">  -H "Authorization: Bearer <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">IAM_TOKEN</span></span>" \
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">  -H "x-folder-id: <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">FOLDER_ID</span></span>" \
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">  -d "<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">body</span></span>" \
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-unquoted z-heredoc z-shell">  "https://llm.api.cloud.yandex.net/foundationModels/v1/completion"
</span></span></span></span></span></code></pre> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>model</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>gpt://<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FOLDER_ID</span>/yandexgpt/latest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  "modelUri": "<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>model</span>",
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  "completionOptions": {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    "stream": false,
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    "temperature": 0.6,
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    "maxTokens": 2000
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  },
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  "messages": [
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">      "role": "user",
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">      "text": "Посчитай сумму 22+33"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    }
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  ]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://llm.api.cloud.yandex.net/foundationModels/v1/completion<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Content-Type<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Bearer <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>IAM_TOKEN</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>x-folder-id<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FOLDER_ID</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span>
</span></code></pre> <h2 id=superagi><a aria-label="Anchor link for: superagi" class=zola-anchor href=#superagi><i class=icon></i></a> SuperAGI</h2> <p><a href=https://github.com/TransformerOptimus/SuperAGI>Source</a> <br> <a href=https://models.superagi.com/playground/generate>Playground generate</a> <br> <a href=https://documenter.getpostman.com/view/30119783/2s9YR3cFJG>API Doc (exaples)</a></p> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">SUPERAGI_API_KEY</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>31f72164129XXXXX<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">prompt</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>посчитай сумму 22+33, дай только ответ без лишнего текста<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">request</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>X</span> POST <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>https://api.superagi.com/v1/generate/65437cbf227a4018516ad1ce<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">-</span>H</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>Content-Type: application/json<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">-</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Bearer <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">SUPERAGI_API_KEY</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">-</span>d</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>{
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  "prompt": ["$prompt"],
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  "max_tokens": 500,
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  "temperature": 0.9,
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  "top_p": 0.15,
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  "repetition_penalty": 0,
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  "best_of": 1.05,
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  "top_k": 50,
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  "stream": false
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">}<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">request</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sed</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>s/data: //<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>r</span> .choices<span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span><span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>.text</span>
</span></code></pre> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SUPERAGI_API_KEY</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>31f72164129XXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>prompt</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>посчитай сумму 22+33, дай только ответ без лишнего текста<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>request</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method Post <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>https://api.superagi.com/v1/generate/65437cbf227a4018516ad1ce<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Content-Type<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Authorization<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Bearer <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SUPERAGI_API_KEY</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">prompt</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>prompt</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">max_tokens</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-constant z-numeric z-integer z-powershell">500</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">temperature</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-constant z-numeric z-integer z-powershell">0.9</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">top_p</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-constant z-numeric z-integer z-powershell">0.15</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">repetition_penalty</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-constant z-numeric z-integer z-powershell">0</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">best_of</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-constant z-numeric z-integer z-powershell">1.05</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">top_k</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-constant z-numeric z-integer z-powershell">50</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">stream</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>request</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>^data: <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.choices.text
</span></code></pre> <h2 id=replicate><a aria-label="Anchor link for: replicate" class=zola-anchor href=#replicate><i class=icon></i></a> Replicate</h2> <p><a href="https://replicate.com/stability-ai/stable-diffusion/examples?input=http">API curl examples</a></p> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">REPLICATE_API_TOKEN</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>r8_STyeUNXiGonkLfxE1FSKaqll26lXXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">prompt</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Жираф в полоску зебры<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">request</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>X</span> POST <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Token <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">REPLICATE_API_TOKEN</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Content-Type: application/json<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>d</span> <span class="z-string z-quoted z-single z-ansi-c z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">$'</span>{
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-ansi-c z-shell">    "version": "ac732df83cea7fff18b8472768c88ad041fa750ff7682a21affe81863cbe77e4",
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-ansi-c z-shell">    "input": {
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-ansi-c z-shell">      "prompt": "$prompt"
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-ansi-c z-shell">    }
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-ansi-c z-shell">  }<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell">  https://api.replicate.com/v1/predictions</span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">request_url</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">request</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>r</span> .urls.get</span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">response_status</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Token <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">REPLICATE_API_TOKEN</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">request_url</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>r</span> .status</span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-keyword z-control z-loop z-while z-shell">while</span> <span class="z-meta z-function-call z-arguments z-shell"><span class="z-support z-function z-double-brace z-begin z-shell">[[</span> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">response_status</span></span> <span class="z-keyword z-operator z-logical z-shell">!=</span> succeeded <span class="z-support z-function z-double-brace z-end z-shell">]]</span></span><span class="z-keyword z-operator z-logical z-continue z-shell">;</span> <span class="z-keyword z-control z-loop z-do z-shell">do</span>
</span><span class="z-source z-shell z-bash">    <span class="z-variable z-other z-readwrite z-assignment z-shell">response_status</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Token <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">REPLICATE_API_TOKEN</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">request_url</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>r</span> .status</span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-keyword z-control z-loop z-end z-shell">done</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Token <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">REPLICATE_API_TOKEN</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">request_url</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>r</span> .output<span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span><span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span></span>
</span></code></pre> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>REPLICATE_API_TOKEN</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>r8_STyeUNXiGonkLfxE1FSKaqll26lXXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>prompt</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Жираф в полоску зебры<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">   <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">version</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ac732df83cea7fff18b8472768c88ad041fa750ff7682a21affe81863cbe77e4<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">   <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">input</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">       <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">prompt</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>prompt</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">   <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">   <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Token <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>REPLICATE_API_TOKEN</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">   <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Content-Type<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>request</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.replicate.com/v1/predictions<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>request<span class="z-variable z-other z-member z-powershell">.urls.get</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Token <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>REPLICATE_API_TOKEN</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.status</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>succeeded<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>request<span class="z-variable z-other z-member z-powershell">.urls.get</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Token <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>REPLICATE_API_TOKEN</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.output</span></span>
</span></code></pre> <h2 id=google-api><a aria-label="Anchor link for: google-api" class=zola-anchor href=#google-api><i class=icon></i></a> Google API</h2> <h3 id=google-translate><a aria-label="Anchor link for: google-translate" class=zola-anchor href=#google-translate><i class=icon></i></a> Google Translate</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Key</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTTOKEN_API><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> получить токен: https://console.cloud.google.com/apis/credentials<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Text</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>You can see in the right corner how long each translation request takes (this does not depend on the amount of text being transferred).<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LanguageTarget</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>RU<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LanguageSource</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>EN<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://translation.googleapis.com/language/translate/v2?key=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Header</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Content-Type<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>q<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Text</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>target<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LanguageTarget</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>source<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LanguageSource</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WebClient</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Net.WebClient
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Header<span class="z-variable z-other z-member z-powershell">.Keys</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WebClient<span class="z-variable z-other z-member z-powershell">.Headers.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Header</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Response</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WebClient<span class="z-variable z-other z-member z-powershell">.UploadString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>POST<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Body</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Response<span class="z-variable z-other z-member z-powershell">.data.translations.translatedText</span></span>
</span></code></pre> <h3 id=google-search><a aria-label="Anchor link for: google-search" class=zola-anchor href=#google-search><i class=icon></i></a> Google Search</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Key</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTTOKEN_API><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> получить токен: https://developers.google.com/custom-search/v1/overview?hl=ru (пользовательский поиск JSON API предоставляет 100 поисковых запросов в день бесплатно)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cx</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>35c78340f49eb474a<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> создать поисковую систему https://programmablesearchengine.google.com/controlpanel/all<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Query</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>как создать бота discord<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Lang</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ru<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Num</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">10</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Start</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://www.googleapis.com/customsearch/v1?q=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Query</span>&key=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Key</span>&cx=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cx</span>&lr=lang_<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Lang</span>&num=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Num</span>&<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>start</span>=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Start</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.items</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> title<span class="z-keyword z-operator z-other z-powershell">,</span>snippet<span class="z-keyword z-operator z-other z-powershell">,</span>displayLink<span class="z-keyword z-operator z-other z-powershell">,</span>link <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Format-List</span>
</span></code></pre> <h3 id=google-search-via-rapidapi><a aria-label="Anchor link for: google-search-via-rapidapi" class=zola-anchor href=#google-search-via-rapidapi><i class=icon></i></a> Google Search via RapidAPI</h3> <p><a href=https://rapidapi.com/ru/neoscrap-net/api/google-search72>Google-Search72</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Key</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTTOKEN_API><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>X-RapidAPI-Key<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Key</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>X-RapidAPI-Host<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>google-search72.p.rapidapi.com<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>query</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>как создать бота discord<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://google-search72.p.rapidapi.com/search?q=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>query</span>%20gitgub&gl=us&lr=lang_ru&num=20&start=0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method GET <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.items</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> title<span class="z-keyword z-operator z-other z-powershell">,</span>snippet<span class="z-keyword z-operator z-other z-powershell">,</span>displayLink<span class="z-keyword z-operator z-other z-powershell">,</span>link <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Format-List</span>
</span></code></pre> <h3 id=google-filter><a aria-label="Anchor link for: google-filter" class=zola-anchor href=#google-filter><i class=icon></i></a> Google Filter</h3> <p><code>https://www.google.com/search?q=the+rookie+2018+imdb</code> формат url-запроса поиска с пробелами <br> <code>https://www.google.com/search?q=the+rookie+2018+site:imdb.com</code> поиск по сайту <br> <code>https://www.google.com/search?q=the+rookie+intitle:index.of+"last modified"+(mkv|avi)</code> искать страницы, на которых указано “last modified” (последние изменения), заголовок страницы через расширенный оператор поиска (все перечисленные слова должны встречаться в заголовке) содержит слово “index.of” (указывает на директорию на веб-сервере, которая содержит список файлов) и искать файлы с расширениями .mkv или (|) .avi <br> <code>https://www.google.com/search?q=the+rookie+2018+filetype:torrent</code> <br> <code>инструкция gopro hero 11 filetype:pdf</code> искать сразу документ (на странице .pdf или загрузка) <br> <code>"действия/глаголы, утвержденные для использования в командлетах"</code> искать по фразе целиком, без разбиения на отдельные слова <br> <code>"ягуар скорость -животное -xe -xj"</code> узнаем скорость Ягуара, исключаем животное и модели автомобиля <br> <code>"intitle:лучшие фильмы 2023"</code> запрос ищет страницы, заголовки (title HTML документа) которых содержат слова “лучшие”, “фильмы” и “2023” (все слова должны быть в заголовке) <br> <code>"allintitle:лучшие фильмы 2023"</code> запрос ищет страницы, заголовки (title HTML документа) которых содержат слова “лучшие”, “фильмы” или “2023” (одно из) <br> <code>"intext:telegram бот powershell"</code> поиск страниц, содержащих указанное ключевое слово в тексте страницы (а не только в заголовке) <br> <code>"inurl:lifailon"</code> поиск страниц, в URL которых содержится указанное ключевое слово <br> <code>intitle:index.of "game of thrones" mkv daterange:2010..2015</code> фильтрация по дате изменения, оператор позволяет задать диапазон дат в формате YYYYMMDD..YYYYMMDD <br> <code>intitle:index.of "game of thrones" mkv after:2015</code> ограничить результаты поиска файлов, измененных до (before) или после (after) указанной даты <br> <code>intitle:index.of "game of thrones" mkv from:2010 to:2015</code> фильтрация по диапазону дат <br> <code>https://www.google.com/search?q=the-rookie-2018+site:imdb.com&btnI</code> редирект на первый url</p> <h2 id=media-api><a aria-label="Anchor link for: media-api" class=zola-anchor href=#media-api><i class=icon></i></a> Media API</h2> <h2 id=imdb><a aria-label="Anchor link for: imdb" class=zola-anchor href=#imdb><i class=icon></i></a> IMDb</h2> <p><a href=https://rapidapi.com/apidojo/api/imdb8>IMDb8</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTTOKEN_API><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> 500 запросов в месяц<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>query</span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Break<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>X-RapidAPI-Key<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>X-RapidAPI-Host<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>imdb8.p.rapidapi.com<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://imdb8.p.rapidapi.com/title/find?q=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>query</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method GET <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.results</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> select title<span class="z-keyword z-operator z-other z-powershell">,</span>titletype<span class="z-keyword z-operator z-other z-powershell">,</span>year<span class="z-keyword z-operator z-other z-powershell">,</span>runningTimeInMinutes<span class="z-keyword z-operator z-other z-powershell">,</span>id <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Format-Table</span>
</span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://www.imdb.com<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.results.id</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.results.principals</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> актеры<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.results.image</span></span>
</span></code></pre> <h2 id=moviesdatabase><a aria-label="Anchor link for: moviesdatabase" class=zola-anchor href=#moviesdatabase><i class=icon></i></a> MoviesDatabase</h2> <p><a href=https://rapidapi.com/SAdrian/api/moviesdatabase>MoviesDatabase</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTTOKEN_API><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>imdb_id</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>tt0455275<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>X-RapidAPI-Key<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>X-RapidAPI-Host<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>moviesdatabase.p.rapidapi.com<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://moviesdatabase.p.rapidapi.com/titles/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>imdb_id</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method GET <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.results</span></span>
</span></code></pre> <h2 id=tmdb><a aria-label="Anchor link for: tmdb" class=zola-anchor href=#tmdb><i class=icon></i></a> TMDB</h2> <p><a href=https://developer.themoviedb.org/reference/intro/getting-started>Developer TMDB</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TOKEN</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>548e444e7812575caa0a7eXXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Endpoint</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>search/tv<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> поиск сериала (tv) и фильма (movie) по названию<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Query</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>зимородок<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.themoviedb.org/3/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Endpoint</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>?api_key=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TOKEN</span>&query=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Query</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method Get<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.results
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>id</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method Get<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.results.id <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> забрать id сериала (210865) https://www.themoviedb.org/tv/210865<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Endpoint</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>tv/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>id</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> получение информации о сериале по его ID<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.themoviedb.org/3/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Endpoint</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>?api_key=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TOKEN</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method Get<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> список сезонов (.seasons), количество эпизодов (.seasons.episode_count)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.themoviedb.org/3/tv/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>id</span>/season/2?api_key=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Token</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method Get</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.episodes <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> вывести 2 сезон<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.themoviedb.org/3/tv/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>id</span>/season/2/episode/8?api_key=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Token</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method Get <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> вывести 8 эпизод<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <h2 id=omdb><a aria-label="Anchor link for: omdb" class=zola-anchor href=#omdb><i class=icon></i></a> OMDb</h2> <p>Получение API ключа по <a href=https://www.omdbapi.com>email</a></p> <p><code>$API_KEY = "XXXXXXXX"</code> <br> <code>$IMDb_ID = "tt7587890"</code> <br> <code>curl -s "https://omdbapi.com/?apikey=$($API_KEY)&i=$($IMDb_ID)" | jq .</code> <br> <code>curl -s "https://omdbapi.com/?apikey=$($API_KEY)&i=$($IMDb_ID)" | ConvertFrom-Json</code> <br> <code>Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&s=The Rookie"</code> <br> <code>Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&t=The Rookie"</code> поиск по Title <br> <code>Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&t=The Rookie&y=1990"</code> поиск по Title и году выхода <br> <code>Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&t=The Rookie&type=movie"</code> поиск только фильма (movie) или сериала (series) <br> <code>$(Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&s=The Rookie").Search</code> поиск всех совпадений (фильмы и сериалы)</p> <h2 id=ivi><a aria-label="Anchor link for: ivi" class=zola-anchor href=#ivi><i class=icon></i></a> ivi</h2> <p><a href=https://ask.ivi.ru/knowledge-bases/10/articles/51697-dokumentatsiya-dlya-api-ivi>ivi api doc</a></p> <p><code>Invoke-RestMethod https://api.ivi.ru/mobileapi/categories</code> список категорий и жанров (genres/meta_genres) <br> <code>Invoke-RestMethod https://api.ivi.ru/mobileapi/collections</code> подборки</p> <p><code>(Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.seasons.number</code> кол-во сезонов <br> <code>(Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.seasons[1].episode_count</code> кол-во серий во втором сезоне <br> <code>(Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.seasons[1].ivi_release_info.date_interval_min</code> дата выхода следующей серии <br> <code>(Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.kp_rating</code> рейтинг в Кинопоиск (8.04)</p> <p><code>$id = (Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.kp_id</code> получить id в Кинопоиск (5106881) <br> <code>id=$(curl -s https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok | jq .result[].kp_id)</code> получить id в Кинопоиск</p> <h2 id=kinopoisk><a aria-label="Anchor link for: kinopoisk" class=zola-anchor href=#kinopoisk><i class=icon></i></a> Kinopoisk</h2> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">id</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">5106881</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">get</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span> https://www.kinopoisk.ru/film/<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">id</span></span>/episodes/</span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-printf z-shell">printf</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>%s\n<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-expansion z-parameter z-begin z-shell">{</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-variable z-other z-readwrite z-shell">get<span class="z-punctuation z-section z-braces z-begin z-shell">[</span><span class="z-variable z-language z-array z-shell">@</span><span class="z-punctuation z-section z-braces z-end z-shell">]</span></span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-section z-expansion z-parameter z-end z-shell">}</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">grep</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>A</span> 1 <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Сезон 2<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">grep</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>эпизодов<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">sed</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>r</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>s/^.+\: //<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> количество эпиздовод во втором сезоне</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></span></code></pre> <h3 id=kinopoisk-dev><a aria-label="Anchor link for: kinopoisk-dev" class=zola-anchor href=#kinopoisk-dev><i class=icon></i></a> kinopoisk.dev</h3> <p><a href=https://t.me/kinopoiskdev_bot>Получить токен</a> <br> <a href=https://kinopoisk.dev/documentation>Документация по API в формате OpenAPI</a></p> <p><code>GET /v1.4/movie/{id}</code> поиск по id</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>id</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">5106881</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>API_KEY</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ZYMNJJA-0J8MNPN-PB4N7R7-XXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Header</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>accept<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>X-API-KEY<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>API_KEY</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>irm</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.kinopoisk.dev/v1.4/movie/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>id</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method GET <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Header</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>irm<span class="z-variable z-other z-member z-powershell">.rating.kp</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> рейтинг в Кинопоиск (8,079)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>irm<span class="z-variable z-other z-member z-powershell">.seasonsInfo</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> количество сезонов и эпизодов в них<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">id</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">5106881</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">API_KEY</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>ZYMNJJA-0J8MNPN-PB4N7R7-XXXXXXX<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">get</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>X</span> GET <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell">  <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>https://api.kinopoisk.dev/v1.4/movie/<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">id</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>accept: application/json<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>X-API-KEY: <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">API_KEY</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">get</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"> .rating.kp <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> рейтинг в Кинопоиск (8,079)</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">get</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"> .seasonsInfo<span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>1<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>.episodesCount <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> количество эпизодов во втором [1] сезоне (6)</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></span></code></pre> <p><code>GET /v1.4/movie/search</code></p> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">query</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>zimorodok<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">page</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">1</span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> кол-во страниц для выборки</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">limit</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">1</span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> кол-во элементов на странице</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>X</span> GET <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell">  <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>https://api.kinopoisk.dev/v1.4/movie/search?page=<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">page</span></span>&limit=<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">limit</span></span>&query=<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">query</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>accept: application/json<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>X-API-KEY: <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">API_KEY</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"> .</span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">limit</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">5</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">request</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>X</span> GET <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell">  <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>https://api.kinopoisk.dev/v1.4/movie/search?page=<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">page</span></span>&limit=<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">limit</span></span>&query=%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>accept: application/json<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-command z-parens z-shell"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>X-API-KEY: <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">API_KEY</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"> .</span><span class="z-punctuation z-section z-parens z-end z-shell">)</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">request</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>.docs[] | select(.year == 2022)<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> отфильтровать вывод по году выхода</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></span></code></pre> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>API_KEY</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ZYMNJJA-0J8MNPN-PB4N7R7-XXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>page</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>limit</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">5</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>query</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>request</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.kinopoisk.dev/v1.4/movie/search?page=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>page</span>&limit=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>limit</span>&query=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>query</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>accept<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>X-API-KEY<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>API_KEY</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>request<span class="z-variable z-other z-member z-powershell">.docs</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> year <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2022</span>
</span></code></pre> <h3 id=urlcode><a aria-label="Anchor link for: urlcode" class=zola-anchor href=#urlcode><i class=icon></i></a> UrlCode</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-PercentEncode</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>str</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">   <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bytes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::UTF8.GetBytes<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>str</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">   <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bytes</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0:X2}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-unary z-powershell">-join</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>%<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>^<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>%<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-PercentEncode</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>зимородок<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-UrlEncode</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>str</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">   <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Web.HttpUtility</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::UrlEncode<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>str</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">UrlEncode <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>зимородок<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell"><span class="z-entity z-name z-function z-shell">percent-encode</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-punctuation z-section z-parens z-end z-shell">)</span> <span class="z-punctuation z-section z-braces z-begin z-shell">{</span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell">	<span class="z-variable z-other z-readwrite z-assignment z-shell">str</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">1</span></span></span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell">    <span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">-</span>n</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">1</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">iconv</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>t</span> utf8</span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">od</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>An</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>tx1</span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">tr</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span> <span class="z-punctuation z-definition z-string z-end z-shell">'</span></span> <span class="z-meta z-group z-expansion z-job z-shell"><span class="z-punctuation z-definition z-variable z-job z-shell">%</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">tr</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>d</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>\n<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell"><span class="z-punctuation z-section z-braces z-end z-shell">}</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">percent-encode</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>зимородок<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span></code></pre> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-UrlDecode</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>encoded</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Uri</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::UnescapeDataString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>encoded</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-UrlDecode</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell"><span class="z-entity z-name z-function z-shell">percent-decode</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-punctuation z-section z-parens z-end z-shell">)</span> <span class="z-punctuation z-section z-braces z-begin z-shell">{</span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell">    <span class="z-variable z-other z-readwrite z-assignment z-shell">encoded</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">1</span></span></span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell"><span class="z-meta z-function-call z-shell">    <span class="z-storage z-modifier z-shell">local</span> <span class="z-variable z-other z-readwrite z-assignment z-shell">url_encoded</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-expansion z-parameter z-begin z-shell">{</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-variable z-other z-readwrite z-shell">1</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-keyword z-operator z-substitution z-shell">/</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-variable z-parameter z-switch z-shell">/</span></span><span class="z-meta z-group z-expansion z-parameter z-shell">+<span class="z-keyword z-operator z-substitution z-shell">/</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"> </span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-section z-expansion z-parameter z-end z-shell">}</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span></span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell">    <span class="z-meta z-function-call z-shell"><span class="z-support z-function z-printf z-shell">printf</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>%b<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-expansion z-parameter z-begin z-shell">{</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-variable z-other z-readwrite z-shell">url_encoded</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-keyword z-operator z-substitution z-shell">/</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-variable z-parameter z-switch z-shell">/</span></span><span class="z-meta z-group z-expansion z-parameter z-shell">%<span class="z-keyword z-operator z-substitution z-shell">/</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-constant z-character z-escape z-shell">\\</span>x</span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-section z-expansion z-parameter z-end z-shell">}</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell"><span class="z-punctuation z-section z-braces z-end z-shell">}</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">percent-decode</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span></code></pre> <h3 id=kinopoiskapiunofficial><a aria-label="Anchor link for: kinopoiskapiunofficial" class=zola-anchor href=#kinopoiskapiunofficial><i class=icon></i></a> KinopoiskApiUnofficial</h3> <p>Бесплатно 500 запросов в сутки. <a href=https://kinopoiskapiunofficial.tech/documentation/api>Swagger documentation</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell">API_KEY<span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>828ec96a-f45d-4e3d-84b1-XXXXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>accept<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>X-API-KEY<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>API_KEY</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>https://kinopoiskapiunofficial.tech/api/v2.2/films/1142153<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Headers <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>headers</span>
</span></code></pre> <p><code>curl -s "https://kinopoiskapiunofficial.tech/api/v2.2/films/1142153" -H "accept: application/json" -H "X-API-KEY: $API_KEY" | jq .</code></p> <h2 id=kinobox><a aria-label="Anchor link for: kinobox" class=zola-anchor href=#kinobox><i class=icon></i></a> Kinobox</h2> <p><code>$url = "https://www.kinopoisk.ru/film/694051"</code> <br> <code>$kp_id = $url -replace ".+/"</code> <br> <code>https://kinomix.web.app/#694051</code> <br> <code>curl -s -X GET "https://kinobox.tv/api/players/main?kinopoisk=$kp_id" -H "accept: application/json"</code> поиск по id Кинопоиск <br> <code>curl -s -X GET "https://kinobox.tv/api/players/main?imdb=tt2293640" -H "accept: application/json"</code> поиск по id IMDb <br> <code>curl -s -X GET "https://kinobox.tv/api/players/main?title=minions" -H "accept: application/json"</code> поиск основных плееров по названию <br> <code>curl -s -X GET "https://kinobox.tv/api/players/all?title=minions" -H "accept: application/json"</code> поиск всех плееров <br> <code>curl -s -X GET "https://kinobox.tv/api/popular/films" -H "accept: application/json"</code> популярные фильмы <br> <code>curl -s -X GET "https://kinobox.tv/api/popular/series" -H "accept: application/json"</code> популярные сериалы</p> <h2 id=videocdn><a aria-label="Anchor link for: videocdn" class=zola-anchor href=#videocdn><i class=icon></i></a> VideoCDN</h2> <p><a href=https://github.com/notssh/videocdn-api>API</a> <br> <a href=https://github.com/API-Movies/videocdn>Source</a> <br> <a href=https://api-movies.github.io/videocdn/index.json>API JSON</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>kp_id</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">5106881</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>token</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>YfTWH2p3Mai7ziqDoGjS3yXXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ep</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>tv-series<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://videocdn.tv/api/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ep</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>?api_token=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>token</span>&field=kinopoisk_id&query=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>kp_id</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.data.episodes <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> season_num <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Episode<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.num</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Voice<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.media.translation.title</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> отфильтровать серии по второму сезону и отобразить все озвучки к сериям<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">kp_id</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">5106881</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">token</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>YfTWH2p3Mai7ziqDoGjS3yXXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">ep</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>tv-series<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>https://videocdn.tv/api/<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">ep</span></span>?api_token=<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">token</span></span>&field=kinopoisk_id&query=<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">kp_id</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>.data[].episodes | length<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> количество серий</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>https://videocdn.tv/api/<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">ep</span></span>?api_token=<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">token</span></span>&field=kinopoisk_id&query=<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">kp_id</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>.data[].episodes[] | select(.season_num == 2) | {episode: .ru_title, voice: .media[].translation.title}<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> отфильтровать параметры вывода</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></span></code></pre> <h2 id=torrent><a aria-label="Anchor link for: torrent" class=zola-anchor href=#torrent><i class=icon></i></a> Torrent</h2> <h3 id=jackett><a aria-label="Anchor link for: jackett" class=zola-anchor href=#jackett><i class=icon></i></a> Jackett</h3> <p><a href=https://github.com/Jackett/Jackett>Source</a></p> <p><code>mkdir /jackett</code> <br> <code>docker-compose.yml</code></p> <pre class="language-yaml z-code" data-lang=yaml><code class=language-yaml data-lang=yaml><span class="z-source z-yaml"><span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">services</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">  <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">jackett</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">image</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">lscr.io/linuxserver/jackett:latest</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">container_name</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">jackett</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">environment</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-punctuation z-definition z-block z-sequence z-item z-yaml">-</span> <span class="z-string z-unquoted z-plain z-out z-yaml">PUID=1000</span>
</span><span class="z-source z-yaml">      <span class="z-punctuation z-definition z-block z-sequence z-item z-yaml">-</span> <span class="z-string z-unquoted z-plain z-out z-yaml">PGID=1000</span>
</span><span class="z-source z-yaml">      <span class="z-punctuation z-definition z-block z-sequence z-item z-yaml">-</span> <span class="z-string z-unquoted z-plain z-out z-yaml">TZ=Etc/UTC</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">volumes</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-punctuation z-definition z-block z-sequence z-item z-yaml">-</span> <span class="z-string z-unquoted z-plain z-out z-yaml">/jackett/data:/config</span>
</span><span class="z-source z-yaml">      <span class="z-punctuation z-definition z-block z-sequence z-item z-yaml">-</span> <span class="z-string z-unquoted z-plain z-out z-yaml">/jackett/blackhole:/downloads</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">ports</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span>
</span><span class="z-source z-yaml">      <span class="z-punctuation z-definition z-block z-sequence z-item z-yaml">-</span> <span class="z-string z-unquoted z-plain z-out z-yaml">9117:9117</span>
</span><span class="z-source z-yaml">    <span class="z-string z-unquoted z-plain z-out z-yaml"><span class="z-entity z-name z-tag z-yaml">restart</span></span><span class="z-punctuation z-separator z-key-value z-mapping z-yaml">:</span> <span class="z-string z-unquoted z-plain z-out z-yaml">unless-stopped</span>
</span></code></pre> <p><code>docker-compose up -d jackett</code> <br> <code>docker exec -it jackett /bin/bash</code> доступ к оболочке во время работы контейнера <br> <code>docker logs -f jackett</code> мониторинг журналов контейнера</p> <p><code>/jackett/data/Jackett/ServerConfig.json</code> место хранения конфигурации сервера <br> <code>/jackett/data/Jackett/Indexers/*.json</code> место хранения конфигурации индексаторов</p> <p><code>$API_KEY = "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</code> <br> <code>Invoke-RestMethod "http://127.0.0.1:9117/api/v2.0/indexers/rutor/results/torznab/api?apikey=$API_KEY"</code> Прочитать RSS ленту RuTor <br> <code>$query = "the+rookie"</code> <br> <code>Invoke-RestMethod "http://127.0.0.1:9117/api/v2.0/indexers/rutor/results/torznab/api?apikey=$API_KEY&t=search&cat=&q=$query"</code> поиск в RuTor <br> <code>Invoke-RestMethod "http://127.0.0.1:9117/api/v2.0/indexers/kinozal/results/torznab/api?apikey=$API_KEY&t=search&q=$query"</code> поиск в кинозал <br> <code>Invoke-RestMethod "http://127.0.0.1:9117/api/v2.0/indexers/kinozal/results/torznab/api?apikey=$API_KEY&t=search&q=$query&cat=5000"</code> отфильтровать вывод по сериалам (Capabilities: 5000) <br> <code>Invoke-RestMethod "http://127.0.0.1:9117/api/v2.0/indexers/all/results/torznab/api?apikey=$API_KEY&t=search&q=riverdale"</code> поиск во всех индексаторах <br> <code>$(Invoke-RestMethod "http://127.0.0.1:9117/api/v2.0/indexers/all/results/torznab/api?apikey=$API_KEY&t=indexers&configured=true").indexers.indexer</code> cписок всех настроенных индексаторов (трекеров)</p> <h3 id=torrent-api-py><a aria-label="Anchor link for: torrent-api-py" class=zola-anchor href=#torrent-api-py><i class=icon></i></a> Torrent-API-py</h3> <p><a href=https://github.com/Ryuk-me/Torrent-Api-py>Source</a> <br> <a href=https://torrent-api-py-nx0x.onrender.com/docs#/default/health_route_health_get>Documentation</a></p> <pre class=z-code><code><span class="z-text z-plain">git clone https://github.com/Ryuk-me/Torrent-Api-py
</span><span class="z-text z-plain">cd Torrent-Api-py
</span><span class="z-text z-plain">pip install virtualenv
</span><span class="z-text z-plain">py -3 -m venv api-py
</span><span class="z-text z-plain"># Активировать виртуальную среду для Windows
</span><span class="z-text z-plain">.\api-py\Scripts\activate
</span><span class="z-text z-plain"># Активировать виртуальную среду для Linux
</span><span class="z-text z-plain"># $ source api-py/bin/activate
</span><span class="z-text z-plain"># Установить зависимости и запустить
</span><span class="z-text z-plain">pip install -r requirements.txt
</span><span class="z-text z-plain">python main.py
</span><span class="z-text z-plain"># Proxy: https://github.com/dperson/torproxy
</span><span class="z-text z-plain"># export HTTP_PROXY="http://proxy-host:proxy-port"
</span></code></pre> <p><code>$srv = "http://localhost:8009"</code> local <br> <code>$srv = "https://torrent-api-py-nx0x.onrender.com"</code> public <br> <code>Invoke-RestMethod $srv/api/v1/sites</code> список доступных трекеров <br> <code>Invoke-RestMethod "$srv/api/v1/search/?site=torlock&query=the+rookie&limit=0&page=1"</code> поиск в выбранном трекере <br> <code>Invoke-RestMethod "$srv/api/v1/all/search?query=the+rookie&limit=0"</code> поиск по названию во всех трекерах</p> <h3 id=plex><a aria-label="Anchor link for: plex" class=zola-anchor href=#plex><i class=icon></i></a> Plex</h3> <p><code>$API_TOKEN = "XXXXXXXXXXXXXXXXXXXX"</code></p> <pre class=z-code><code><span class="z-text z-plain">$headers = @{
</span><span class="z-text z-plain">    "X-Plex-Token" = $API_TOKEN
</span><span class="z-text z-plain">    "accept" = "application/json"
</span><span class="z-text z-plain">}
</span></code></pre> <p><code>$(Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/servers).MediaContainer.Server</code> версия сервера <br> <code>Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/diagnostics/logs -OutFile log.zip</code> выгруить лог с сервера <br> <code>$(Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/library/sections).MediaContainer.Directory</code> список секций добавленных на сервер <br> <code>$section_key = $(Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/library/sections).MediaContainer.Directory.key[0]</code> <br> <code>Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/library/sections/$section_key/refresh</code> синхронизация указанной секции в Plex по ключу <br> <code>$(Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/library/sections/2/folder).MediaContainer.Metadata</code> получить список директорий и файлов в корне выбранной секции <br> <code>$(Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/library/sections/2/folder?parent=204).MediaContainer.Metadata</code> получить список всех файлов в указанной директории через ключ (MediaContainer.Metadata.key) конечной точки</p> <h3 id=jellyfin><a aria-label="Anchor link for: jellyfin" class=zola-anchor href=#jellyfin><i class=icon></i></a> Jellyfin</h3> <p><a href=https://github.com/jellyfin/jellyfin>Source</a> <br> <a href=https://api.jellyfin.org>API Docs</a></p> <p><code>$API_TOKEN "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</code> <br> <code>Invoke-RestMethod -Headers @{"X-Emby-Token" = $API_TOKEN} http://localhost:8096/Users</code> список пользователей и их id <br> <code>$Users = Invoke-RestMethod -Headers @{"X-Emby-Token" = $API_TOKEN} http://localhost:8096/Users</code> <br> <code>$UserId = $($Users | Where-Object Name -match "Lifailon").Id</code> забрать id пользователя <br> <code>Invoke-RestMethod -Headers @{"X-Emby-Token" = $API_TOKEN} http://localhost:8096/System/Info</code> информация о системе <br> <code>$(Invoke-RestMethod -Headers @{"X-Emby-Token" = $API_TOKEN} http://localhost:8096/Items).Items</code> список добавленных объектов директорий <br> <code>$ItemId = $(Invoke-RestMethod -Headers @{"X-Emby-Token" = $API_TOKEN} http://localhost:8096/Items).Items[-1].Id</code> забрать id директории <br> <code>$Data = $(Invoke-RestMethod -Headers @{"X-Emby-Token" = $API_TOKEN} "http://localhost:8096/Users/$UserId/Items?ParentId=$ItemId").Items</code> получить содержимое корневой директории по Id из Items <br> <code>$TvId = $($data | Where-Object Name -match "Rookie").Id</code> найти сериал или фильм по имени и забрать его Id <br> <code>$(Invoke-RestMethod -Headers @{"X-Emby-Token" = $API_TOKEN} "http://localhost:8096/Users/$UserId/Items?ParentId=$TvId").Items</code> получить содержимое дочерней директории по Id ее родительской директории</p> <h2 id=telegram><a aria-label="Anchor link for: telegram" class=zola-anchor href=#telegram><i class=icon></i></a> Telegram</h2> <p>@BotFather (https://t.me/BotFather) /newbot</p> <p>Format: <code>https://api.telegram.org/bot&LTtoken>/&LTendpoint></code></p> <p><a href=https://core.telegram.org/bots/api#getupdates>getupdates</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-FromTelegram</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Token</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>687...:AAF...<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Date</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Last</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChatID</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>endpoint</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>getUpdates<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>      <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.telegram.org/bot<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Token</span>/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>endpoint</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Object</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>r</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result<span class="z-variable z-other z-member z-powershell">.result</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EpochTime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">DateTime</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>1/1/1970<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TimeZone</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-TimeZone</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UTCTime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EpochTime<span class="z-variable z-other z-member z-powershell">.AddSeconds</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>r<span class="z-variable z-other z-member z-powershell">.message.date</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>d</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>UTCTime<span class="z-variable z-other z-member z-powershell">.AddMinutes</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TimeZone<span class="z-variable z-other z-member z-powershell">.BaseUtcOffset.TotalMinutes</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Message</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>r<span class="z-variable z-other z-member z-powershell">.message.text</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Date</span>    <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>d</span>
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Last</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result<span class="z-variable z-other z-member z-powershell">.result.message.text</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ChatID</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Object</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>r</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result<span class="z-variable z-other z-member z-powershell">.result</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Message</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>r<span class="z-variable z-other z-member z-powershell">.message.text</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">UserName</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>r<span class="z-variable z-other z-member z-powershell">.message.chat.username</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ChatID</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>r<span class="z-variable z-other z-member z-powershell">.message.chat.id</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ChatType</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>r<span class="z-variable z-other z-member z-powershell">.message.chat.type</span></span>
</span></span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">                <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result<span class="z-variable z-other z-member z-powershell">.result.message.text</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>Get-FromTelegram</code> <br> <code>Get-FromTelegram -Last</code> <br> <code>Get-FromTelegram -Date</code> <br> <code>Get-FromTelegram -ChatID</code></p> <p><a href=https://core.telegram.org/bots/api#sendmessage>sendmessage</a></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Send-ToTelegram</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Text</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Token</span>    <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>687...:AAF...<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Chat</span>     <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>125468108<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Keyboard</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>endpoint</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>sendMessage<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>      <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.telegram.org/bot<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Token</span>/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>endpoint</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">chat_id</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Chat</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">text</span>    <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Text</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyboard</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Body</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">reply_markup</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyboard</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Body</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>Send-ToTelegram -Text "Send test from powershell"</code></p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastDate</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-FromTelegram</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>date</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.Date
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastMessage</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-FromTelegram</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>date</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastDateTest</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastMessage<span class="z-variable z-other z-member z-powershell">.Date</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastMessage<span class="z-variable z-other z-member z-powershell">.Message</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/Service<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-logical z-powershell">-and</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastDate</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastDateTest</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ServiceName</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastMessage<span class="z-variable z-other z-member z-powershell">.Message</span></span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span> <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-Service</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ServiceName</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ErrorAction Ignore<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.Status
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Result</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-support z-function z-powershell">Send-ToTelegram</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Text <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Result</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-support z-function z-powershell">Send-ToTelegram</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Text <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Service not found<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastDate</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastDateTest</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>/Service vpnagent</code> <br> <code>/Service WinRM</code> <br> <code>/Service test</code></p> <h3 id=button><a aria-label="Anchor link for: button" class=zola-anchor href=#button><i class=icon></i></a> Button</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyboard</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    "inline_keyboard":[[
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">        {"text":"Uptime","callback_data":"/Uptime"},
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">        {"text":"Test","callback_data":"/Test"}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    ]]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">}<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Send-ToTelegram</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Text <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test buttons<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Keyboard <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyboard</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>request</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.telegram.org/bot<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Token</span>/getUpdates<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.result.callback_query
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>request<span class="z-variable z-other z-member z-powershell">.data</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> прочитать callback_data нажатой кнопки<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>request<span class="z-variable z-other z-member z-powershell">.message.date</span></span>
</span></code></pre> <h3 id=send-totelegramfile><a aria-label="Anchor link for: send-totelegramfile" class=zola-anchor href=#send-totelegramfile><i class=icon></i></a> Send-ToTelegramFile</h3> <p>https://core.telegram.org/bots/api#senddocument</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Send-ToTelegramFile</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Path</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Token</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Chat</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Keyboard</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>endpoint</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>senddocument<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>      <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.telegram.org/bot<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Token</span>/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>endpoint</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>multipartContent</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.Http.MultipartFormDataContent</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::new<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileStream</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.FileStream</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::new<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Path</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.FileMode</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Open</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileContent</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.Http.StreamContent</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::new<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileStream</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileHeader</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.Http.Headers.ContentDispositionHeaderValue</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::new<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>form-data<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileHeader<span class="z-variable z-other z-member z-powershell">.Name</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>document<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileHeader<span class="z-variable z-other z-member z-powershell">.FileName</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.Path</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetFileName<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileContent<span class="z-variable z-other z-member z-powershell">.Headers.ContentDisposition</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileHeader</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>multipartContent<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileContent</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>document<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Keyboard</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyboardContent</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.Http.StringContent</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::new<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Keyboard</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyboardContent<span class="z-variable z-other z-member z-powershell">.Headers.ContentType.MediaType</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>multipartContent<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyboardContent</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>reply_markup<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>chatContent</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.Http.StringContent</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::new<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Chat</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>multipartContent<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>chatContent</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>chat_id<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Uri <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Method Post <span class="z-keyword z-operator z-assignment z-powershell">-</span>Body <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>multipartContent</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ContentType <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>multipart/form-data<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileStream<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">return</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <p><code>Send-ToTelegramFile -Path "C:\Users\Lifailon\Documents\lake.jpg" -Token "7777777777:AAF..." -Chat "7777777777"</code></p> <h2 id=discord><a aria-label="Anchor link for: discord" class=zola-anchor href=#discord><i class=icon></i></a> Discord</h2> <p><a href=https://discord.com/developers/applications>Developers</a></p> <p>Создаем Applications (General Information). В Bot привязываем к Application и копируем токен авторизации. В OAuth2 - URL Generator выбираем bot и права Administrator и копируем созданный URL для добавления на канал. Переходим по url и добавляем бота на сервер. Получаем ID канала на сервере (текстовые каналы, правой кнопкой мыши копируем ссылку и забираем последний id в url).</p> <h3 id=send-to-discord><a aria-label="Anchor link for: send-to-discord" class=zola-anchor href=#send-to-discord><i class=icon></i></a> Send to Discord</h3> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">DISCORD_TOKEN</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">DISCORD_CHANNEL_ID</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>119403124XXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">TEXT</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>test from bash<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">URL</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>https://discordapp.com/api/channels/<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">DISCORD_CHANNEL_ID</span></span>/messages<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>X</span> POST <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">URL</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Bot <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">DISCORD_TOKEN</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Content-Type: application/json<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>d</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>{<span class="z-constant z-character z-escape z-shell">\"</span>content<span class="z-constant z-character z-escape z-shell">\"</span>: <span class="z-constant z-character z-escape z-shell">\"</span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">TEXT</span></span><span class="z-constant z-character z-escape z-shell">\"</span>}<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span></code></pre> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DISCORD_TOKEN</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DISCORD_CHANNEL_ID</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>119403124XXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TEXT</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>test from PowerShell<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>URL</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://discordapp.com/api/channels/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DISCORD_CHANNEL_ID</span>/messages<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">content</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TEXT</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span>
</span><span class="z-source z-powershell">curl <span class="z-keyword z-operator z-assignment z-powershell">-</span>s <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>URL</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>X POST <span class="z-keyword z-operator z-assignment z-powershell">-</span>H <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization: Bot <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DISCORD_TOKEN</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>H <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Content-Type: application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>d <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Body</span>
</span></code></pre> <h3 id=read-from-discord><a aria-label="Anchor link for: read-from-discord" class=zola-anchor href=#read-from-discord><i class=icon></i></a> Read from Discord</h3> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>X</span> GET <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">URL</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Bot <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">DISCORD_TOKEN</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Content-Type: application/json<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">jq</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>r</span> .<span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>0<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>.content</span>
</span></code></pre> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>messages</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">curl <span class="z-keyword z-operator z-assignment z-powershell">-</span>s <span class="z-keyword z-operator z-assignment z-powershell">-</span>X GET <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>URL</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>H <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Authorization: Bot <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DISCORD_TOKEN</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>H <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Content-Type: application/json<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>messages</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> content<span class="z-keyword z-operator z-other z-powershell">,</span>timestamp<span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.author.username</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre> <h3 id=httpclient-1><a aria-label="Anchor link for: httpclient-1" class=zola-anchor href=#httpclient-1><i class=icon></i></a> HttpClient</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DISCORD_TOKEN</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DISCORD_CHANNEL_ID</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>119403124XXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>URL</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://discordapp.com/api/channels/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DISCORD_CHANNEL_ID</span>/messages<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HttpClient</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Net.Http.HttpClient
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HttpClient<span class="z-variable z-other z-member z-powershell">.DefaultRequestHeaders.Authorization</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Bot <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DISCORD_TOKEN</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HttpClient<span class="z-variable z-other z-member z-powershell">.GetAsync</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>URL</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Result
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>messages</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>response<span class="z-variable z-other z-member z-powershell">.Content.ReadAsStringAsync</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Result
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>messages</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.content
</span></code></pre> <h3 id=button-1><a aria-label="Anchor link for: button-1" class=zola-anchor href=#button-1><i class=icon></i></a> Button</h3> <pre class="language-Bash z-code" data-lang=Bash><code class=language-Bash data-lang=Bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>X</span> POST <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">URL</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Content-Type: application/json<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>H</span> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>Authorization: Bot <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">DISCORD_TOKEN</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span> <span class="z-punctuation z-separator z-continuation z-line z-shell">\
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell">  -</span>d</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  {
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">    "content": "Test text for button",
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">    "components": [
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">      {
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">        "type": 1,
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">        "components": [
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">          {
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">            "type": 2,
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">            "label": "Button",
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">            "style": 1,
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">            "custom_id": "button_click"
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">          }
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">        ]
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">      }
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">    ]
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-string z-quoted z-single z-shell">  }<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span>
</span></code></pre> <h3 id=discord-net-webhook><a aria-label="Anchor link for: discord-net-webhook" class=zola-anchor href=#discord-net-webhook><i class=icon></i></a> Discord.Net.Webhook</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>ls <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\Discord.NET\*.dll<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.FullName
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> https://discordapp.com/api/webhooks/&LTwebhook_id>/&LTwebhook_token> (Настроить канал - Интеграция)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>webhookId</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">1197577280000000000</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>webhookToken</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>rs8AA-XXXXXXXXXXX_Vk5RUI4A6HuSGhpCCTepq25duwCwLXasfv6u23a7XXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>messageContent</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test dotNET<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>client</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> Discord.Webhook.DiscordWebhookClient<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>webhookId</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>webhookToken</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>client<span class="z-variable z-other z-member z-powershell">.SendMessageAsync</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>messageContent</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Wait<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h3 id=discord-net-websocket><a aria-label="Anchor link for: discord-net-websocket" class=zola-anchor href=#discord-net-websocket><i class=icon></i></a> Discord.Net.WebSocket</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DiscordAssemblies</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>ls <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\Discord.NET\*.dll<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.FullName
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>assembly</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DiscordAssemblies</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>assembly</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DISCORD_TOKEN</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> Discord.WebSocket.DiscordSocketClient
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client<span class="z-variable z-other z-member z-powershell">.Add_MessageReceived</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>message</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>message<span class="z-variable z-other z-member z-powershell">.Author.Id</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client<span class="z-variable z-other z-member z-powershell">.CurrentUser.Id</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Received message from <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>message<span class="z-variable z-other z-member z-powershell">.Author.Username</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>: <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>message<span class="z-variable z-other z-member z-powershell">.Content</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>message<span class="z-variable z-other z-member z-powershell">.Content.Contains</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ping<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>message<span class="z-variable z-other z-member z-powershell">.Channel.SendMessageAsync</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>pong<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetAwaiter<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetResult<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client<span class="z-variable z-other z-member z-powershell">.LoginAsync</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Discord.TokenType</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bot<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DISCORD_TOKEN</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetAwaiter<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetResult<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>$Client.StartAsync().Wait()<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client<span class="z-variable z-other z-member z-powershell">.StartAsync</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetAwaiter<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetResult<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client<span class="z-variable z-other z-member z-powershell">.ConnectionState</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ReadKey<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client<span class="z-variable z-other z-member z-powershell">.LogoutAsync</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetAwaiter<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetResult<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Client<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre> <h2 id=oh-my-posh><a aria-label="Anchor link for: oh-my-posh" class=zola-anchor href=#oh-my-posh><i class=icon></i></a> oh-my-posh</h2> <p><a href=https://ohmyposh.dev/docs/installation/windows>Install</a></p> <p><code>winget install JanDeDobbeleer.OhMyPosh -s winget</code> <br> <code>choco install oh-my-posh -y</code> <br> <code>scoop install https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/oh-my-posh.json</code> <br> <code>Set-ExecutionPolicy Bypass -Scope Process -Force; Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://ohmyposh.dev/install.ps1'))</code></p> <p><a href=https://ohmyposh.dev/docs/themes>Themes</a></p> <p><code>Get-PoshThemes</code> отобразить список всех тем <br> <code>oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/di4am0nd.omp.json" | Invoke-Expression</code> применить (использовать) тему в текущей сессии <br> <code>oh-my-posh init pwsh --config "https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/cert.omp.json" | Invoke-Expression</code> считать тему из репозитория <br> <code>New-Item -Path $PROFILE -Type File -Force</code> создайт файл профилья PowerShell <br> <code>'oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/di4am0nd.omp.json" | Invoke-Expression' > $PROFILE</code> сохранить тему профиля (загружать тему при запуске PowerShell)</p> <h3 id=themes-performance><a aria-label="Anchor link for: themes-performance" class=zola-anchor href=#themes-performance><i class=icon></i></a> themes-performance</h3> <p><code>Install-Module themes-performance -Repository NuGet</code> установить модуль с темами <br> <code>Set-PoshTheme -Theme System-Sensors</code> использовать тему с датчиками из LibreHardwareMonitor <br> <code>Set-PoshTheme -Theme System-Sensors -Save</code> загрузить тему из репозитория на локальный компьютер и сохранить тему в профиле <br> <code>Set-PoshTheme -Theme System-Performance</code> использовать тему с датчиками системы, получаемыми из системы WMI/CIM (заряд батареи ноутбука | загрузка CPU в % | использование оперативной памяти | скорость активного сетевого интерфейса) <br> <code>Set-PoshTheme -Theme System-Performance -Save</code> <br> <code>Set-PoshTheme -Theme Pwsh-Process-Performance</code> время работы текущего процесса pwsh (процессорное время), количество работающих/общее (статус успех/ошибка) фоновых заданий, Working Set текущего процесса и всех процессов PowerShell в системе <br> <code>Set-PoshTheme -Theme Pwsh-Process-Performance -Save</code></p> <h2 id=windows-terminal><a aria-label="Anchor link for: windows-terminal" class=zola-anchor href=#windows-terminal><i class=icon></i></a> Windows-Terminal</h2> <h3 id=terminal-icons><a aria-label="Anchor link for: terminal-icons" class=zola-anchor href=#terminal-icons><i class=icon></i></a> Terminal-Icons</h3> <p><code>Install-Module -Name Terminal-Icons -Repository PSGallery</code> <br> <code>scoop bucket add extras</code> <br> <code>scoop install terminal-icons</code></p> <p><code>notepad $PROFILE</code> <br> <code>Import-Module -Name Terminal-Icons</code></p> <p>Использует шрифты, которые необходимо установить и настроить в параметрах профиля PowerShell: <a href=https://github.com/ryanoasis/nerd-fonts>Nerd Fonts</a> <br> <a href=https://www.nerdfonts.com/font-downloads>Список шрифтов</a> <br> Скачать и установить шрифт похожий на Cascadia Code - <a href=https://github.com/ryanoasis/nerd-fonts/releases/download/v3.1.1/CascadiaCode.zip>CaskaydiaCove</a></p> <p>Установить шрифт в конфигурацию Windows Terminal для PowerShell Core:</p> <pre class="language-json z-code" data-lang=json><code class=language-json data-lang=json><span class="z-source z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>profiles<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>: 
</span><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-json">    </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>defaults<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> 
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-json">    </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>colorScheme<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>One Half Dark<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>experimental.retroTerminalEffect<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>font<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> 
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>size<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-float z-decimal z-json">10<span class="z-punctuation z-separator z-decimal z-json">.</span>0</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>useAtlasEngine<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json">    </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>list<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> 
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json">    </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-punctuation z-section z-sequence z-begin z-json">[</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">        <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> PowerShell Core
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">        <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>font<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> 
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">                </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>face<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>CaskaydiaMono Nerd Font<span class="z-punctuation z-definition z-string z-end z-json">"</span></span> <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> устанавливаем шрифт для работы Terminal-Icons
</span></span></span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>guid<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>{574e775e-4f2a-5b96-ac1e-a2962a402336}<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>hidden<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">false</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>name<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>PowerShell Core<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>source<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>Windows.Terminal.PowershellCore<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">        <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> WSL (Ubuntu)
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">        <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>guid<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>{2c4de342-38b7-51cf-b940-2309a097f518}<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>hidden<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">false</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>name<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>WSL<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>source<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>Windows.Terminal.Wsl<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">        <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> ssh
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">        <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>commandline<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ssh lifailon@192.168.1.100 -p 22<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>guid<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>{a3ec86f6-2bc1-59dd-814d-2a0d935af5f8}<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>icon<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>🐧<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>name<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>devops-01<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">    <span class="z-punctuation z-section z-sequence z-end z-json">]</span></span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></code></pre> <h3 id=custom-actions><a aria-label="Anchor link for: custom-actions" class=zola-anchor href=#custom-actions><i class=icon></i></a> Custom Actions</h3> <p>Custom actions: https://learn.microsoft.com/ru-ru/windows/terminal/customize-settings/actions <br> Escape-последовательности: https://learn.microsoft.com/ru-ru/cpp/c-language/escape-sequences?view=msvc-170</p> <pre class="language-json z-code" data-lang=json><code class=language-json data-lang=json><span class="z-source z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>actions<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>: 
</span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-punctuation z-section z-sequence z-begin z-json">[</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> 
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>copy<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>singleLine<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">false</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+c<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>paste<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Сохраняем классическую вставку интерпритатора, не заставляя выполнять код построчно
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+shift+v<span class="z-punctuation z-definition z-string z-end z-json">"</span></span> <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> default: ctrl+v
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>find<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+f<span class="z-punctuation z-definition z-string z-end z-json">"</span></span> <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> default: ctrl+shift+f
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> 
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>splitPane<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>split<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>left<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span> <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> default: auto
</span></span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>splitMode<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>duplicate<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+shift+d<span class="z-punctuation z-definition z-string z-end z-json">"</span></span> <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> default: alt+shift+d
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Очистить строку
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>sendInput<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>input<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span><span class="z-constant z-character z-escape z-json">\u0001</span><span class="z-constant z-character z-escape z-json">\u001b</span>[3~<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+k<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Очистить терминал
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>sendInput<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>input<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span><span class="z-constant z-character z-escape z-json">\u0001</span><span class="z-constant z-character z-escape z-json">\u001b</span>[3~clear<span class="z-constant z-character z-escape z-json">\r</span><span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+l<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Вставить шаблон модуля для перевода текста через Google Translate
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>sendInput<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>input<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span><span class="z-constant z-character z-escape z-json">\u0001</span><span class="z-constant z-character z-escape z-json">\u001b</span>[3~Get-Translate -Alternatives -Provider Google ''<span class="z-constant z-character z-escape z-json">\u001b</span>[D<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+g<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Вставить шаблон модуля для перевода текста через MyMemory
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>sendInput<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>input<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span><span class="z-constant z-character z-escape z-json">\u0001</span><span class="z-constant z-character z-escape z-json">\u001b</span>[3~Get-Translate -Alternatives -Provider MyMemory ''<span class="z-constant z-character z-escape z-json">\u001b</span>[D<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+q<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Быстрый перевод текста из буфера обмена
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>sendInput<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>input<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span><span class="z-constant z-character z-escape z-json">\u0001</span><span class="z-constant z-character z-escape z-json">\u001b</span>[3~Get-Translate -Alternatives -Provider MyMemory -Text $(Get-Clipboard)<span class="z-constant z-character z-escape z-json">\u001b</span>[D<span class="z-constant z-character z-escape z-json">\r</span><span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+shift+q<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Быстрый пинг dns google
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>sendInput<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>input<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span><span class="z-constant z-character z-escape z-json">\u0001</span><span class="z-constant z-character z-escape z-json">\u001b</span>[3~ping 8.8.8.8 -t<span class="z-constant z-character z-escape z-json">\r</span><span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+p<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-punctuation z-section z-sequence z-end z-json">]</span></span>
</span></code></pre> <h2 id=pandoc><a aria-label="Anchor link for: pandoc" class=zola-anchor href=#pandoc><i class=icon></i></a> Pandoc</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>release_latest</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.github.com/repos/jgm/pandoc/releases/latest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>release_latest<span class="z-variable z-other z-member z-powershell">.assets</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> name <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>windows-x86_64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.browser_download_url
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\pandoc.zip
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\pandoc.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>DestinationPath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-ChildItem</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\pandoc-*\*.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.FullName
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Copy-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Destination <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Windows\System32\pandoc.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\pandoc*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span></code></pre> <p><code>pandoc -s README.md -o index.html</code> конвертация из Markdown в HTML <br> <code>pandoc README.md -o index.html --css=styles.css</code> применить стили из css <br> <code>pandoc -s index.html -o README.md</code> конвертация из HTML в Markdown <br> <code>pandoc -s README.md -o README.docx</code> конвертация в Word <br> <code>pandoc -s README.md -o README.epub</code> конвертация в открытый формат электронных версий книг <br> <code>pandoc -s README.md -o README.pdf</code> конвертация в PDF (требуется rsvg-convert) <br> <code>pandoc input.md -f markdown+hard_line_breaks -o output.md</code> конвертация из markdown документа, который не содержит обратный слэш в конце каждой строки для переноса (), который их добавит</p> <h3 id=convert-excel-to-markdown><a aria-label="Anchor link for: convert-excel-to-markdown" class=zola-anchor href=#convert-excel-to-markdown><i class=icon></i></a> Convert Excel to Markdown</h3> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-Module</span> ImportExcel
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-Excel</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path srv.xlsx <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Export-Csv</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>csvFilePath</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoTypeInformation <span class="z-keyword z-operator z-assignment z-powershell">-</span>Encoding UTF8 <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> конвертация Excel в csv<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">pandoc <span class="z-keyword z-operator z-assignment z-powershell">-</span>s <span class="z-keyword z-operator z-string-format z-powershell">-f</span> csv <span class="z-keyword z-operator z-assignment z-powershell">-</span>t markdown input.csv <span class="z-keyword z-operator z-assignment z-powershell">-</span>o output.md <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> конвертация таблицу csv в markdown<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre> <h2 id=ffmpeg><a aria-label="Anchor link for: ffmpeg" class=zola-anchor href=#ffmpeg><i class=icon></i></a> FFmpeg</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>release_latest</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.github.com/repos/BtbN/FFmpeg-Builds/releases/latest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>release_latest<span class="z-variable z-other z-member z-powershell">.assets</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> name <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ffmpeg-master-latest-win64-gpl.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.browser_download_url
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\ffmpeg<span class="z-keyword z-operator z-assignment z-powershell">-</span>master<span class="z-keyword z-operator z-assignment z-powershell">-</span>latest<span class="z-keyword z-operator z-assignment z-powershell">-</span>win64<span class="z-keyword z-operator z-assignment z-powershell">-</span>gpl.zip
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\ffmpeg-master-latest-win64-gpl.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>DestinationPath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Copy-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\ffmpeg-master-latest-win64-gpl\bin\ffmpeg.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Destination <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Windows\System32\ffmpeg.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\ffmpeg-*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span></code></pre> <p><code>ffmpeg -i input.mp4 output.gif</code> конвертировать mp4 в gif <br> <code>ffmpeg -i input.mp4 -filter_complex "scale=1440:-1:flags=lanczos" output.gif</code> изменить разрешение на выходе <br> <code>ffmpeg -i input.mp4 -filter_complex "scale=1440:-1:flags=lanczos" -r 10 output.gif</code> изменить количество кадров в секунду на выходе <br> <code>ffmpeg -i input.mp4 -filter_complex "fps=5,scale=960:-1:flags=lanczos,split[s0][s1];[s0]palettegen=max_colors=32[p];[s1][p]paletteuse=dither=bayer" output.gif</code> сжатие за счет цветовой политры <br> <code>ffmpeg -i input.mp4 -ss 00:00:10 -frames:v 1 -q:v 1 output.jpg</code> вытащить скриншот из видео на 10 секунде <br> <code>ffmpeg -i input.mp4 -ss 00:00:05 -to 00:00:10 -c copy output.mp4</code> вытащить кусок видео <br> <code>ffmpeg -i "%d.jpeg" -framerate 2 -c:v libx264 -r 30 -pix_fmt yuv420p output.mp4</code> создать видео из фото (1.jpeg, 2.jpeg и т.д.) с framerate (частотой кадров) в создаваемом видео 2 кадра в секунду <br> <code>ffmpeg -i "rtsp://admin:password@192.168.3.201:554" -rtsp_transport tcp -c:v copy -c:a aac -strict experimental output.mp4</code> запись без перекодирования (copy) RTSP-потока с камеры видеонаблюдения (+ аудио в кодеке AAC) в файл <br> <code>ffmpeg -i "rtsp://admin:password@192.168.3.201:554" -rtsp_transport tcp -c:v copy -c:a aac -strict experimental -movflags +faststart+frag_keyframe+empty_moov output.mp4</code> переместить метаданные в начало файла, что позволяет начать воспроизведение файла в видеоплеере до его полной загрузки <br> <code>ffmpeg -i "rtsp://admin:password@192.168.3.201:554" -rtsp_transport tcp -frames:v 1 -c:v mjpeg output.jpg</code> сделать скриншот <br> <code>ffmpeg -i input.mp4 -vf "pad=width=iw:height=ih+100:x=0:y=100:color=black" -c:a copy output.mp4</code> width=iw: (ширина видео остается как у исходного файла), height=ih+100 (высота видео увеличивается на 100 пикселей), x=0 (горизонтальное смещение установлено в 0), y=100 (вертикальное смещение установлено в 100 пикселей вниз, чтобы добавить черное пространство сверху), color=black (цвет добавленного пространства — черный)</p> <h2 id=handbrake><a aria-label="Anchor link for: handbrake" class=zola-anchor href=#handbrake><i class=icon></i></a> HandBrake</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/HandBrake/HandBrake/releases/download/1.8.0/HandBrakeCLI-1.8.0-win-x86_64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\HandBrakeCLI.zip
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\HandBrakeCLI.zip <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutputPath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Copy-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\HandBrakeCLI.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Destination <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Windows\System32\HandBrakeCLI.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\doc<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\HandBrakeCLI*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre> <p><code>HandBrakeCLI -i input.mp4 -o output.mkv</code> конвертирует видео в формате mp4 в формат mkv с использованием стандартных настроек HandBrake <br> <code>HandBrakeCLI -i input.mp4 -o output.mkv -q 20</code> установить качество видео 20, значения варьируются от 0 (максимальное качество) до 51 (минимальное качество), где 20 считается хорошим качеством для большинства видео <br> <code>HandBrakeCLI -i input.mp4 -o output.mkv -r 30</code> установить частоту кадров на 30 fps <br> <code>HandBrakeCLI -i input.mp4 -o output.mkv --maxWidth 1280 --maxHeight 720</code> изменить размер на 1280х720 <br> <code>HandBrakeCLI -i input.mp4 -o output.mkv -b 1500</code> установить битрейт видео 1500 кбит/с <br> <code>HandBrakeCLI -i input.mp4 -o output.mkv -e x264</code> преобразовать видео с использованием кодека x264 <br> <code>HandBrakeCLI -i input.mp4 -o output.mp4 --crop 0:200:0:0</code> обрезать видео снизу на 200px (верх:низ:лево:право) <br> <code>HandBrakeCLI -i input.mp4 -o output.mp4 --start-at duration:5 --stop-at duration:15</code> обрезать видео (на выходе будет 15-секундное видео с 5 по 20 секунду)</p> <h2 id=imagemagick><a aria-label="Anchor link for: imagemagick" class=zola-anchor href=#imagemagick><i class=icon></i></a> ImageMagick</h2> <p>Source: <a href=https://sourceforge.net/projects/imagemagick>ImageMagick</a></p> <p><code>magick identify -verbose PowerShell-Commands.png</code> извлечь метаданные изображения <br> <code>magick PowerShell-Commands.png output.jpg</code> конвертация формата изображения <br> <code>magick PowerShell-Commands.png -resize 800x600 output.jpg</code> изменить размер (увеличить или уменьшить) <br> <code>magick PowerShell-Commands.png -crop 400x300+100+50 output.jpg</code> обрезать <br> <code>magick PowerShell-Commands.png -rotate 90 output.jpg</code> повернуть изображение <br> <code>magick PowerShell-Commands.png -fill white -pointsize 24 -gravity center -annotate +0+0 "PowerShell" output.jpg</code> наложить текст на изображение <br> <code>magick PowerShell-Commands.png -brightness-contrast +20x+10 output.jpg</code> изменить яркость и контрастность <br> <code>magick convert -delay 100 1.png 2.png 3.png output.gif</code> создать gif из изображений <br> <code>magick convert image1.jpg image2.jpg -append output.jpg</code> вертикально объединенить изображения</p> <h2 id=youtube><a aria-label="Anchor link for: youtube" class=zola-anchor href=#youtube><i class=icon></i></a> YouTube</h2> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>release_latest</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.github.com/repos/yt-dlp/yt-dlp/releases/latest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>release_latest<span class="z-variable z-other z-member z-powershell">.assets</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> name <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>yt-dlp.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.browser_download_url
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Windows\System32\yt-dlp.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre> <p><code>yt-dlp -F https://www.youtube.com/watch?v=gxplizjhqiw</code> отобразить список всех доступных форматов <br> <code>yt-dlp -J https://www.youtube.com/watch?v=gxplizjhqiw</code> вывести данные в формате JSON <br> <code>yt-dlp -J https://www.youtube.com/watch?v=gxplizjhqiw | jq -r .formats.[].format</code> id - resolution (format_note) <br> <code>yt-dlp -f 137 https://www.youtube.com/watch?v=gxplizjhqiw</code> загрузить только видео в указанном формате по id <br> <code>yt-dlp -f bestaudio https://www.youtube.com/watch?v=gxplizjhqiw</code> загрузить только аудио <br> <code>yt-dlp -f best https://www.youtube.com/watch?v=gxplizjhqiw</code> загрузить видео с аудио в лучшем качестве <br> <code>yt-dlp -f 'bestvideo[height<=1080]+bestaudio/best[height<=1080]' https://www.youtube.com/watch?v=gxplizjhqiw</code> загрузить в указанном качестве <br> <code>yt-dlp -r 2m https://www.youtube.com/watch?v=gxplizjhqiw</code> ограничить скорость загрузки до 2 МБит/с</p> <pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-YouTube</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> yt<span class="z-keyword z-operator z-assignment z-powershell">-</span>dlp <span class="z-keyword z-operator z-assignment z-powershell">-</span>J <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.formats <span class="z-keyword z-operator z-other z-powershell">|</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Where-Object</span> filesize <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span> <span class="z-keyword z-operator z-other z-powershell">|</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Select-Object</span> format_id<span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>FileSize<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.filesize</span></span> <span class="z-keyword z-operator z-assignment z-powershell">/</span> <span class="z-constant z-numeric z-integer z-powershell">1024</span><span class="z-keyword z-other z-powershell">kb</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ToString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>0.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span> Mb<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    resolution<span class="z-keyword z-operator z-other z-powershell">,</span>format_note<span class="z-keyword z-operator z-other z-powershell">,</span>quality<span class="z-keyword z-operator z-other z-powershell">,</span>fps<span class="z-keyword z-operator z-other z-powershell">,</span>ext<span class="z-keyword z-operator z-other z-powershell">,</span>language
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>formats</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-YouTube</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://www.youtube.com/watch?v=gxplizjhqiw<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>video</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>formats</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> format_note <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-constant z-numeric z-integer z-powershell">1080</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> ext <span class="z-keyword z-operator z-comparison z-powershell">-match</span> mp4<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.format_id
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>audio</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>formats</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> resolution <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>audio<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> ext <span class="z-keyword z-operator z-comparison z-powershell">-match</span> m4a<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.format_id
</span><span class="z-source z-powershell">cd <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell">yt<span class="z-keyword z-operator z-assignment z-powershell">-</span>dlp <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>video</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>audio</span> https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">www.youtube.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>watch?v<span class="z-keyword z-operator z-assignment z-powershell">=</span>gxplizjhqiw <span class="z-keyword z-operator z-assignment z-powershell">-</span>o <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>%(title)s.%(ext)s<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></code></pre> <footer id=site-footer><nav><ul><li><a class=active href=https://lifailon.github.io/powershell/>PowerShell</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/devops/>DevOps</a><li><a href=https://lifailon.github.io/golang/>GoLang</a><li><a href=https://lifailon.github.io/node-js/>Node.js</a></ul></nav><p><strong>2023-2025</strong> © <em>Lifailon</em><p><small>Powered by <a class="link external" href=https://www.getzola.org>Zola</a> and <a class="link external" href=https://duckquill.daudix.one>Duckquill</a> </small><ul id=socials><li><a rel=" me" href=https://github.com/lifailon/PS-Commands title=GitHub> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34)" class=icon></i> <span>GitHub</span> </a><li><a rel=" me" href=https://www.nuget.org/profiles/Lifailon title=NuGet> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ENUGet%3C/title%3E%3Cpath d='M1.57 0A1.57 1.57 0 000 1.57v20.86A1.57 1.57 0 001.57 24h20.86A1.57 1.57 0 0024 22.43V1.57A1.57 1.57 0 0022.43 0zM7.5 1.5A2.5 2.5 0 0110 4a2.5 2.5 0 01-2.5 2.5A2.5 2.5 0 015 4a2.5 2.5 0 012.5-2.5zM12 6h9v12h-1.5a3.76 3.76 0 00-2.81-1.25A3.76 3.76 0 0012.5 20a3.76 3.76 0 002.19 3.25A3.76 3.76 0 0018.5 24H21V6z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>NuGet</span> </a><li><a rel=" me" href=https://www.npmjs.com/~lifailon title=NPM> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ENPM%3C/title%3E%3Cpath d='M0 0v24h24V0zm14.74 14.74h-3.66v-5.5h-1.83v5.5H5.5V5.5h9.24z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>NPM</span> </a><li><a rel=" me" title="Docker Hub" href=https://hub.docker.com/u/lifailon> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EDocker%3C/title%3E%3Cpath d='M22.149 10.74c-.111-.086-1.15-.86-3.3-.86-.26.002-.52.017-.78.045-.24-1.35-1.32-1.8-1.35-1.81l-.45-.17-.3.42c-.17.24-.65.88-.65 1.76.001.29.04.58.12.86-.66.19-1.3.35-1.95.48a9.72 9.72 0 0 1-1.95.22H.75c-.41 0-.75.34-.75.75 0 4.42 2.4 5.98 4.41 6.68.9.28 1.91.42 3.01.42 1.08 0 2.11-.14 3.01-.42 1.98-.61 3.51-2.01 4.14-4.01.34.04.68.07 1.02.07 1.35 0 2.61-.35 3.72-1.04 1.64-1.01 1.87-2.23 1.87-2.92.01-.96-.34-1.68-.35-1.7zM6.75 8.22h2.25c.14 0 .25-.11.25-.25V6.47c0-.14-.11-.25-.25-.25H6.75c-.14 0-.25.11-.25.25v1.5c0 .14.11.25.25.25zM12 8.22h2.25c.14 0 .25-.11.25-.25V6.47c0-.14-.11-.25-.25-.25H12c-.14 0-.25.11-.25.25v1.5c0 .14.11.25.25.25zM9.375 6.72h-2.25c-.14 0-.25.11-.25.25v1.5c0 .14.11.25.25.25h2.25c.14 0 .25-.11.25-.25v-1.5c0-.14-.11-.25-.25-.25zM12 5.47h-2.25c-.14 0-.25.11-.25.25v1.5c0 .14.11.25.25.25H12c.14 0 .25-.11.25-.25v-1.5c0-.14-.11-.25-.25-.25z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>Docker Hub</span> </a></ul></footer> <span class=hidden id=copy-code-text>Copy Code</span> <span class=hidden id=search-index>https://lifailon.github.io/search_index.en.json</span> <span class=hidden id=more-matches-text>$MATCHES more matches</span> <style>:root{--alert-note-text:"Note";--alert-tip-text:"Tip";--alert-important-text:"Important";--alert-warning-text:"Warning";--alert-caution-text:"Caution"}</style> 