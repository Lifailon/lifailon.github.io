<!doctype html><html data-theme=dark lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation), Linux commands and RuDocs for Node.js" name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ff7800 name=theme-color><meta content=#ffa348 media=(prefers-color-scheme:dark) name=theme-color><meta content="default-src 'none';font-src 'self';img-src 'self' https: data:;media-src 'self' https:;style-src 'self' 'unsafe-inline';frame-src https://player.vimeo.com https://www.youtube-nocookie.com https://toot.community;frame-ancestors 'none';base-uri 'none';form-action 'none';connect-src 'self' https://toot.community;script-src 'self' 'self'" http-equiv=content-security-policy><title>PowerShell Syntax - PowerShell Commands</title><link href=https://lifailon.github.io/powershell/ rel=canonical><link href=https://lifailon.github.io/favicon.png rel=icon type=image/png><link href=https://lifailon.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link title="PowerShell Commands - RSS Feed" href=https://lifailon.github.io/rss.xml rel=alternate type=application/rss+xml><link title="PowerShell Commands - Atom Feed" href=https://lifailon.github.io/atom.xml rel=alternate type=application/atom+xml><style>:root{--accent-color:#ff7800}[data-theme=dark]{--accent-color:#ffa348}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--accent-color:#ffa348}}</style><link href=https://lifailon.github.io/style.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=https://lifailon.github.io/syntax-theme-light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://lifailon.github.io/syntax-theme-dark.css rel=stylesheet><script defer src=https://lifailon.github.io/closable.js></script><script defer src=https://lifailon.github.io/copy-button.js></script><script defer src=https://lifailon.github.io/fuse.js></script><script defer src=https://lifailon.github.io/search-fuse.js></script><script defer src=https://lifailon.github.io/theme-switcher.js></script><meta content="PowerShell Commands" property=og:site_name><meta content="PowerShell Syntax - PowerShell Commands" property=og:title><meta content=https://lifailon.github.io/powershell/ property=og:url><meta content="Web version for PowerShell notes in Russian language (Сheat Sheet & Documentation), Linux commands and RuDocs for Node.js" property=og:description><meta content=https://lifailon.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><div id=handle></div><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://lifailon.github.io> <i class=icon></i>PowerShell Commands</a><li class=divider><li><a class=active href=https://lifailon.github.io/powershell/>PowerShell</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li><a href=https://lifailon.github.io/golang/>GoLang</a><li><a href=https://lifailon.github.io/node-js/>Node.js</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/windowsserver/>Windows Server</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/api/>API</a><li><a href=https://lifailon.github.io/devops/>DevOps</a><li id=search><button class=circle id=search-toggle title=Search><i class=icon></i></button><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details><li id=repo><a class=circle href=https://github.com/Lifailon/PS-Commands title=Repository> <i class=icon></i> </a></ul></nav><div id=search-container><label class=visually-hidden for=search-bar>Search</label><input placeholder="Search for…" autocomplete=off disabled id=search-bar type=search><div id=search-results-container><div id=search-results></div></div></div></header><div id=sidebar><div><h2>Table of Contents</h2><ul><li><a href=https://lifailon.github.io/powershell/#help>Help</a><li><a href=https://lifailon.github.io/powershell/#object>Object</a><ul><li><a href=https://lifailon.github.io/powershell/#variable>Variable</a><li><a href=https://lifailon.github.io/powershell/#env>ENV</a><li><a href=https://lifailon.github.io/powershell/#history>History</a><li><a href=https://lifailon.github.io/powershell/#clipboard>Clipboard</a><li><a href=https://lifailon.github.io/powershell/#write-host>Write-Host</a><li><a href=https://lifailon.github.io/powershell/#write-progress>Write-Progress</a><li><a href=https://lifailon.github.io/powershell/#for>for</a><li><a href=https://lifailon.github.io/powershell/#array>Array</a><li><a href=https://lifailon.github.io/powershell/#index>Index</a><li><a href=https://lifailon.github.io/powershell/#hashtable>HashTable</a><li><a href=https://lifailon.github.io/powershell/#collections>Collections</a><li><a href=https://lifailon.github.io/powershell/#pscustomobject>PSCustomObject</a><li><a href=https://lifailon.github.io/powershell/#add-and-remove-property>Add and Remove Property</a><li><a href=https://lifailon.github.io/powershell/#add-method>Add Method</a><li><a href=https://lifailon.github.io/powershell/#class>Class</a><li><a href=https://lifailon.github.io/powershell/#pipeline>Pipeline</a><li><a href=https://lifailon.github.io/powershell/#select-object>Select-Object</a><li><a href=https://lifailon.github.io/powershell/#expression>Expression</a><li><a href=https://lifailon.github.io/powershell/#select-string>Select-String</a><li><a href=https://lifailon.github.io/powershell/#format>Format</a><li><a href=https://lifailon.github.io/powershell/#measure-object>Measure-Object</a><li><a href=https://lifailon.github.io/powershell/#compare-object>Compare-Object</a><li><a href=https://lifailon.github.io/powershell/#where-object>Where-Object</a><li><a href=https://lifailon.github.io/powershell/#sort-object>Sort-Object</a><li><a href=https://lifailon.github.io/powershell/#last-and-first>Last and First</a><li><a href=https://lifailon.github.io/powershell/#group-object>Group-Object</a><li><a href=https://lifailon.github.io/powershell/#property>Property</a><li><a href=https://lifailon.github.io/powershell/#method>Method</a></ul><li><a href=https://lifailon.github.io/powershell/#error>Error</a><ul><li><a href=https://lifailon.github.io/powershell/#executionstatus>ExecutionStatus</a><li><a href=https://lifailon.github.io/powershell/#measure-command>Measure-Command</a></ul><li><a href=https://lifailon.github.io/powershell/#datetime>DateTime</a><li><a href=https://lifailon.github.io/powershell/#timespan>TimeSpan</a><ul><li><a href=https://lifailon.github.io/powershell/#format-1>Format</a><li><a href=https://lifailon.github.io/powershell/#timer>Timer</a></ul><li><a href=https://lifailon.github.io/powershell/#regex>Regex</a><li><a href=https://lifailon.github.io/powershell/#datatype>DataType</a><ul><li><a href=https://lifailon.github.io/powershell/#math>Math</a><li><a href=https://lifailon.github.io/powershell/#round>Round</a><li><a href=https://lifailon.github.io/powershell/#tostring>ToString</a><li><a href=https://lifailon.github.io/powershell/#char>Char</a></ul><li><a href=https://lifailon.github.io/powershell/#function>Function</a><ul><li><a href=https://lifailon.github.io/powershell/#switch-function>Switch function</a><li><a href=https://lifailon.github.io/powershell/#switch-param>Switch param</a><li><a href=https://lifailon.github.io/powershell/#psm1-module-file-and-parameters>psm1 (module file and parameters)</a><li><a href=https://lifailon.github.io/powershell/#psd1-module-description-file>psd1 (module description file)</a></ul><li><a href=https://lifailon.github.io/powershell/#bit>Bit</a><ul><li><a href=https://lifailon.github.io/powershell/#bit-convertor>Bit Convertor</a></ul><li><a href=https://lifailon.github.io/powershell/#cycle>Cycle</a><ul><li><a href=https://lifailon.github.io/powershell/#foreach>Foreach</a><li><a href=https://lifailon.github.io/powershell/#foreach-object>ForEach-Object</a><li><a href=https://lifailon.github.io/powershell/#while>While</a><li><a href=https://lifailon.github.io/powershell/#try-catch-finally>Try-Catch-Finally</a></ul><li><a href=https://lifailon.github.io/powershell/#files>Files</a><ul><li><a href=https://lifailon.github.io/powershell/#clear-env-temp-14-days>Clear-env-Temp-14-days</a><li><a href=https://lifailon.github.io/powershell/#system-io-file>System IO File</a><li><a href=https://lifailon.github.io/powershell/#read-and-write-bytes>Read and Write Bytes</a></ul><li><a href=https://lifailon.github.io/powershell/#archive>Archive</a><ul><li><a href=https://lifailon.github.io/powershell/#microsoft-powershell-archive>Microsoft PowerShell Archive</a><li><a href=https://lifailon.github.io/powershell/#system-io-compression-filesystem>System IO Compression FileSystem</a><li><a href=https://lifailon.github.io/powershell/#winrar>WinRAR</a></ul><li><a href=https://lifailon.github.io/powershell/#handles>Handles</a><li><a href=https://lifailon.github.io/powershell/#console-menu>Console-Menu</a><li><a href=https://lifailon.github.io/powershell/#credential>Credential</a><ul><li><a href=https://lifailon.github.io/powershell/#out-gridview>Out-Gridview</a><li><a href=https://lifailon.github.io/powershell/#out-file>Out-File</a><li><a href=https://lifailon.github.io/powershell/#get-content>Get-Content</a><li><a href=https://lifailon.github.io/powershell/#aes-key>AES Key</a></ul><li><a href=https://lifailon.github.io/powershell/#winevent>WinEvent</a><ul><li><a href=https://lifailon.github.io/powershell/#xpath>XPath</a><li><a href=https://lifailon.github.io/powershell/#reboot>Reboot</a><li><a href=https://lifailon.github.io/powershell/#logon>Logon</a><li><a href=https://lifailon.github.io/powershell/#eventlog>EventLog</a></ul><li><a href=https://lifailon.github.io/powershell/#firewall>Firewall</a><ul><li><a href=https://lifailon.github.io/powershell/#firewall-manager>Firewall-Manager</a></ul><li><a href=https://lifailon.github.io/powershell/#defender>Defender</a><li><a href=https://lifailon.github.io/powershell/#dism>DISM</a><li><a href=https://lifailon.github.io/powershell/#scheduled>Scheduled</a><li><a href=https://lifailon.github.io/powershell/#shutdown>shutdown</a><li><a href=https://lifailon.github.io/powershell/#localaccounts>LocalAccounts</a><li><a href=https://lifailon.github.io/powershell/#ps2exe>PS2EXE</a><li><a href=https://lifailon.github.io/powershell/#nssm>NSSM</a><li><a href=https://lifailon.github.io/powershell/#jobs>Jobs</a><ul><li><a href=https://lifailon.github.io/powershell/#threadjob>ThreadJob</a><li><a href=https://lifailon.github.io/powershell/#poshrsjob>PoshRSJob</a><li><a href=https://lifailon.github.io/powershell/#invoke-parallel>Invoke-Parallel</a><li><a href=https://lifailon.github.io/powershell/#foreach-object-parallel>ForEach-Object-Parallel</a></ul><li><a href=https://lifailon.github.io/powershell/#com>COM</a><ul><li><a href=https://lifailon.github.io/powershell/#wscript-shell-sendkeys>Wscript Shell SendKeys</a><li><a href=https://lifailon.github.io/powershell/#wscript-shell-popup>Wscript Shell Popup</a><li><a href=https://lifailon.github.io/powershell/#wscript-network>WScript Network</a><li><a href=https://lifailon.github.io/powershell/#shell-application>Shell Application</a><li><a href=https://lifailon.github.io/powershell/#outlook>Outlook</a><li><a href=https://lifailon.github.io/powershell/#microsoft-update>Microsoft Update</a></ul><li><a href=https://lifailon.github.io/powershell/#dotnet>dotNET</a><ul><li><a href=https://lifailon.github.io/powershell/#match>Match</a><li><a href=https://lifailon.github.io/powershell/#generate-password>Generate Password</a><li><a href=https://lifailon.github.io/powershell/#sound-player>Sound Player</a><li><a href=https://lifailon.github.io/powershell/#static-class>Static Class</a><li><a href=https://lifailon.github.io/powershell/#clicker>Clicker</a><li><a href=https://lifailon.github.io/powershell/#audio>Audio</a><li><a href=https://lifailon.github.io/powershell/#netsessionenum>NetSessionEnum</a><li><a href=https://lifailon.github.io/powershell/#copyfile>CopyFile</a><li><a href=https://lifailon.github.io/powershell/#showwindowasync>ShowWindowAsync</a><li><a href=https://lifailon.github.io/powershell/#getasynckeystate>GetAsyncKeyState</a></ul><li><a href=https://lifailon.github.io/powershell/#console-api>Console API</a><li><a href=https://lifailon.github.io/powershell/#drawing>Drawing</a><li><a href=https://lifailon.github.io/powershell/#objectevent>ObjectEvent</a><li><a href=https://lifailon.github.io/powershell/#base64>Base64</a><ul><li><a href=https://lifailon.github.io/powershell/#utf8>UTF8</a><li><a href=https://lifailon.github.io/powershell/#unicode>Unicode</a><li><a href=https://lifailon.github.io/powershell/#image>Image</a></ul><li><a href=https://lifailon.github.io/powershell/#excel>Excel</a><ul><li><a href=https://lifailon.github.io/powershell/#excel-application-open>Excel Application Open</a><li><a href=https://lifailon.github.io/powershell/#importexcel>ImportExcel</a></ul><li><a href=https://lifailon.github.io/powershell/#csv>CSV</a><ul><li><a href=https://lifailon.github.io/powershell/#convertfrom-string>ConvertFrom-String</a><li><a href=https://lifailon.github.io/powershell/#convertfrom-stringdata>ConvertFrom-StringData</a></ul><li><a href=https://lifailon.github.io/powershell/#xml>XML</a><ul><li><a href=https://lifailon.github.io/powershell/#get-credtoxml>Get-CredToXML</a><li><a href=https://lifailon.github.io/powershell/#xmlwriter-extensible-markup-language>XmlWriter (Extensible Markup Language)</a><li><a href=https://lifailon.github.io/powershell/#createelement>CreateElement</a></ul><li><a href=https://lifailon.github.io/powershell/#json>JSON</a><li><a href=https://lifailon.github.io/powershell/#yaml>YAML</a><li><a href=https://lifailon.github.io/powershell/#toml>TOML</a><li><a href=https://lifailon.github.io/powershell/#markdown>Markdown</a><ul><li><a href=https://lifailon.github.io/powershell/#convert-markdown-to-html>Convert Markdown to HTML</a><li><a href=https://lifailon.github.io/powershell/#psmarkdown>PSMarkdown</a><li><a href=https://lifailon.github.io/powershell/#convertfrom-markdownv2>ConvertFrom-MarkdownV2</a></ul><li><a href=https://lifailon.github.io/powershell/#convertto-markdown>ConvertTo-Markdown</a><li><a href=https://lifailon.github.io/powershell/#html>HTML</a><ul><li><a href=https://lifailon.github.io/powershell/#convertfrom-html>ConvertFrom-Html</a><li><a href=https://lifailon.github.io/powershell/#convertto-html>ConvertTo-Html</a><li><a href=https://lifailon.github.io/powershell/#pswritehtml>PSWriteHTML</a><li><a href=https://lifailon.github.io/powershell/#htmlreport>HtmlReport</a></ul><li><a href=https://lifailon.github.io/powershell/#htmlagilitypack>HtmlAgilityPack</a><li><a href=https://lifailon.github.io/powershell/#wmi>WMI</a><ul><li><a href=https://lifailon.github.io/powershell/#windows-management-instrumentation>Windows Management Instrumentation</a><li><a href=https://lifailon.github.io/powershell/#network-level-authentication>Network Level Authentication</a></ul><li><a href=https://lifailon.github.io/powershell/#regedit>Regedit</a><li><a href=https://lifailon.github.io/powershell/#performance>Performance</a><li><a href=https://lifailon.github.io/powershell/#snmp>SNMP</a><ul><li><a href=https://lifailon.github.io/powershell/#setup-snmp-service>Setup SNMP Service</a><li><a href=https://lifailon.github.io/powershell/#setting-snmp-service-via-regedit>Setting SNMP Service via Regedit</a><li><a href=https://lifailon.github.io/powershell/#snmpwalk>snmpwalk</a><li><a href=https://lifailon.github.io/powershell/#snmp-modules>SNMP Modules</a><li><a href=https://lifailon.github.io/powershell/#lextm-sharpsnmplib>Lextm SharpSnmpLib</a><li><a href=https://lifailon.github.io/powershell/#walk>Walk</a></ul><li><a href=https://lifailon.github.io/powershell/#packagemanagement>PackageManagement</a><ul><li><a href=https://lifailon.github.io/powershell/#winget>winget</a><li><a href=https://lifailon.github.io/powershell/#jqlang>jqlang</a><li><a href=https://lifailon.github.io/powershell/#scoop>Scoop</a><li><a href=https://lifailon.github.io/powershell/#chocolatey>Chocolatey</a></ul><li><a href=https://lifailon.github.io/powershell/#nuget>NuGet</a><li><a href=https://lifailon.github.io/powershell/#modules>Modules</a><ul><li><a href=https://lifailon.github.io/powershell/#get-query>Get-Query</a><li><a href=https://lifailon.github.io/powershell/#console-translate>Console-Translate</a><li><a href=https://lifailon.github.io/powershell/#console-download>Console-Download</a><li><a href=https://lifailon.github.io/powershell/#pseverything>PSEverything</a><li><a href=https://lifailon.github.io/powershell/#hardwaremonitor>HardwareMonitor</a><li><a href=https://lifailon.github.io/powershell/#crystaldisk-cli>CrystalDisk-Cli</a><li><a href=https://lifailon.github.io/powershell/#ps-pi-hole>PS-Pi-Hole</a><li><a href=https://lifailon.github.io/powershell/#check-host>Check-Host</a><li><a href=https://lifailon.github.io/powershell/#psdomaintest>PSDomainTest</a><li><a href=https://lifailon.github.io/powershell/#winapi>WinAPI</a><li><a href=https://lifailon.github.io/powershell/#psyslog>pSyslog</a><li><a href=https://lifailon.github.io/powershell/#syslog-source-message>Syslog source message</a><li><a href=https://lifailon.github.io/powershell/#syslog-type-message>Syslog type message</a></ul><li><a href=https://lifailon.github.io/powershell/#pester>Pester</a><li><a href=https://lifailon.github.io/powershell/#oh-my-posh>oh-my-posh</a><ul><li><a href=https://lifailon.github.io/powershell/#themes-performance>themes-performance</a></ul><li><a href=https://lifailon.github.io/powershell/#windows-terminal>Windows-Terminal</a><ul><li><a href=https://lifailon.github.io/powershell/#terminal-icons>Terminal-Icons</a><li><a href=https://lifailon.github.io/powershell/#custom-actions>Custom Actions</a></ul><li><a href=https://lifailon.github.io/powershell/#pandoc>Pandoc</a><ul><li><a href=https://lifailon.github.io/powershell/#convert-excel-to-markdown>Convert Excel to Markdown</a></ul><li><a href=https://lifailon.github.io/powershell/#ffmpeg>FFmpeg</a><li><a href=https://lifailon.github.io/powershell/#handbrake>HandBrake</a><li><a href=https://lifailon.github.io/powershell/#imagemagick>ImageMagick</a><li><a href=https://lifailon.github.io/powershell/#youtube>YouTube</a></ul></div></div><main id=main-content><h1>PowerShell Syntax</h1><p align=center><a href=https://github.com/Lifailon/PS-Commands><img title="PS-Commands Logo" src=PS-Commands-Logo.png></a><p align=center>Синтаксис и работа с модулями в <b>PowerShell</b>.<hr><p align=center><a href=https://github.com/Lifailon/PS-Commands><img title="PowerShell Cheat Sheet RU" src=PowerShell-Cheat-Sheet-RU.jpg></a><hr><h1 id=help><a aria-label="Anchor link for: help" class=zola-anchor href=#help><i class=icon></i></a> Help</h1><p><code>Get-Verb</code> действия/глаголы, утвержденные для использования в командлетах <br> <code>Get-Command *Language*</code> поиск команды по имени <br> <code>(Get-Command Get-Language).Module</code> узнать к какому модулю принадлежит команда <br> <code>Get-Command Get-Content | fl Module,DLL</code> узнать принадлежность команды к модулю и dll <br> <code>Get-Command -Module LanguagePackManagement</code> отобразить список команд указанного модуля <br> <code>(Get-Module LanguagePackManagement).ExportedCommands.Values</code> отобразить список команд указанного модуля <br> <code>Get-Language | Get-Member</code> отобразить список методов команды (действия), объекты вывода и Event (события объектов: Click) <br> <code>(Get-Help Get-Service).Aliases</code> узнать псевдонимом команды <br> <code>Get-Alias gsv</code> узнать имя команды по псевдониму <br> <code>Get-Help Get-Service</code> синтаксис <br> <code>Get-Help Get-Service -Parameter *</code> описание всех параметров <br> <code>Get-Help Get-Service -Online</code> <br> <code>Get-Help Get-Service -ShowWindow</code> описание параметров в GUI с фильтрацией <br> <code>Show-Command</code> вывести список команд в GUI <br> <code>Show-Command Get-Service</code> список параметров команды в GUI <br> <code>Invoke-Expression</code> iex принимает текст для выполнения в консоли как команды <br> <code>$PSVersionTable</code> текущая версия PowerShell <br> <code>Set-ExecutionPolicy Unrestricted</code> <br> <code>Get-ExecutionPolicy</code> <br> <code>$Metadata = New-Object System.Management.Automation.CommandMetaData (Get-Command Get-Service)</code> получить информацию о командлете <br> <code>[System.Management.Automation.ProxyCommand]::Create($Metadata)</code> исходный код функции<h1 id=object><a aria-label="Anchor link for: object" class=zola-anchor href=#object><i class=icon></i></a> Object</h1><h3 id=variable><a aria-label="Anchor link for: variable" class=zola-anchor href=#variable><i class=icon></i></a> Variable</h3><p><code>$var = Read-Host "Enter"</code> ручной ввод <br> <code>$pass = Read-Host "Enter Password" -AsSecureString</code> скрывать набор <br> <code>$global:path = "\\path"</code> задать глобальную переменную, например в функции <br> <code>$using:srv</code> использовать переменную текущей сесси в Invoke-сессии <br> <code>Get-Variable</code> отобразить все переменные <br> <code>ls variable:/</code> отобразить все переменные <br> <code>Get-Variable *srv*</code> найти переменную по имени <br> <code>Get-Variable -Scope Global</code> отобразить все глобальные переменные <br> <code>Get-Variable Error</code> последняя команда с ошибкой <br> <code>Remove-Variable -Name *</code> очистить все переменные <br> <code>$LASTEXITCODE</code> содержит код вывода последней запущенной программы, например ping. Если код возврата положительный (True), то $LastExitCode = 0<h3 id=env><a aria-label="Anchor link for: env" class=zola-anchor href=#env><i class=icon></i></a> ENV</h3><p><code>Get-ChildItem Env:</code> отобразить все переменные окружения <br> <code>$env:PSModulePath</code> директории импорта модулей <br> <code>$env:userprofile</code> <br> <code>$env:computername</code> <br> <code>$env:username</code> <br> <code>$env:userdnsdomain</code> <br> <code>$env:logonserver</code> <br> <code>([DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()).Name</code> <br> <code>[Environment]::GetFolderPath('ApplicationData')</code><h3 id=history><a aria-label="Anchor link for: history" class=zola-anchor href=#history><i class=icon></i></a> History</h3><p><code>Get-History</code> история команд текущей сессии <br> <code>(Get-History)[-1].Duration.TotalSeconds</code> время выполнения последней команды <br> <code>(Get-PSReadLineOption).HistorySavePath</code> путь к сохраненному файлу с 4096 последних команд (из модуля PSReadLine) <br> <code>Get-Content (Get-PSReadlineOption).HistorySavePath | Select-String Get</code> поиск по содержимому файла (GREP) <br> <code>Set-PSReadlineOption -MaximumHistoryCount 10000</code> изменить количество сохраняемых команд в файл <br> <code>Get-PSReadLineOption | select MaximumHistoryCount</code> <br> <code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code> отключить ведение журнала <br> <code>F2</code> переключиться с InlineView на ListView<h3 id=clipboard><a aria-label="Anchor link for: clipboard" class=zola-anchor href=#clipboard><i class=icon></i></a> Clipboard</h3><p><code>Set-Clipboard $srv</code> скопировать в буфер обмена <br> <code>Get-Clipboard</code> вставить<h3 id=write-host><a aria-label="Anchor link for: write-host" class=zola-anchor href=#write-host><i class=icon></i></a> Write-Host</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>BackgroundColor Green <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test:<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoNewline <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> изменить цвет фона и запретить перенос строки<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span> True<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ForegroundColor Green <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> данная строка будет печататься продолжая предыдущую с новыми параметрами цвета (фон по умолчанию, изменяем цвет текста)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><p><code>Write-Error "False"</code> <br> <code>Write-Warning "False"</code><h3 id=write-progress><a aria-label="Anchor link for: write-progress" class=zola-anchor href=#write-progress><i class=icon></i></a> Write-Progress</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">100</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Progress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Activity <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test Progress<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PercentComplete <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Milliseconds <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=for><a aria-label="Anchor link for: for" class=zola-anchor href=#for><i class=icon></i></a> for</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">for</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>i</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>i</span> <span class="z-keyword z-operator z-comparison z-powershell">-le</span> <span class="z-constant z-numeric z-integer z-powershell">100</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>i</span><span class="z-keyword z-operator z-assignment z-powershell">+=</span><span class="z-constant z-numeric z-integer z-powershell">10</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Progress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Activity <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test Progress<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PercentComplete <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>i</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Seconds <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=array><a aria-label="Anchor link for: array" class=zola-anchor href=#array><i class=icon></i></a> Array</h3><p><code>$srv = @("server-01", "server-02")</code> создать массив <br> <code>$srv += @("server-03")</code> добавить в массив новый элемент <br> <code>$srv.Count</code> отобразить кол-во элементов в массиве <br> <code>Out-String</code> построчный вывод<h3 id=index><a aria-label="Anchor link for: index" class=zola-anchor href=#index><i class=icon></i></a> Index</h3><p><code>$srv[0]</code> вывести первое значение элемента массива <br> <code>$srv[0] = Name</code> замена элемента в массиве <br> <code>$srv[0].Length</code> узнать кол-во символов первого значения в массиве <br> <code>$srv[10..100]</code> срез<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>a<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>b<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>c<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>d<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>num</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>a</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>num</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">array</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::IndexOf<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>a</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> узнать номер индекса по зачению<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>num</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> пересобрать исходный массив<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=hashtable><a aria-label="Anchor link for: hashtable" class=zola-anchor href=#hashtable><i class=icon></i></a> HashTable</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>hashtable</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создать (инициализировать)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>User<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>USERNAME</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Server<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>COMPUTERNAME</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>hashtable</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Добавить ключи<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Profile<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PROFILE</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>PowerShell_Home_Dir<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>PSHOME</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>$hashtable.Keys</code> список всех ключей <br> <code>$hashtable["User"]</code> получить значение (Values) по ключу <br> <code>$hashtable["User"] = "Test"</code> изменить <br> <code>$hashtable.Remove("User")</code> удалить ключ<h3 id=collections><a aria-label="Anchor link for: collections" class=zola-anchor href=#collections><i class=icon></i></a> Collections</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Object</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Collections<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">User</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>username</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Server</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>computername</span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=pscustomobject><a aria-label="Anchor link for: pscustomobject" class=zola-anchor href=#pscustomobject><i class=icon></i></a> PSCustomObject</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CustomObject</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ordered</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">User</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>username</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Server</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>computername</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=add-and-remove-property><a aria-label="Anchor link for: add-and-remove-property" class=zola-anchor href=#add-and-remove-property><i class=icon></i></a> Add and Remove Property</h3><p><code>$CustomObject | Add-Member –MemberType NoteProperty –Name Arr –Value @(1,2,3)</code> добавить свойство/стобец <br> <code>$CustomObject.Arr = @(1,3,5)</code> изменить содержимое <br> <code>$CustomObject.PsObject.Properties.Remove('User')</code> удалить Property<h3 id=add-method><a aria-label="Anchor link for: add-method" class=zola-anchor href=#add-method><i class=icon></i></a> Add Method</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ScriptBlock</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Get-Service</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CustomObject</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Add-Member</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>TestMethod<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>MemberType ScriptMethod <span class="z-keyword z-operator z-assignment z-powershell">-</span>Value <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ScriptBlock</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CustomObject</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-Member</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CustomObject<span class="z-variable z-other z-member z-powershell">.TestMethod</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=class><a aria-label="Anchor link for: class" class=zola-anchor href=#class><i class=icon></i></a> Class</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-storage z-type z-powershell">Class</span> <span class="z-entity z-name z-function">CustomClass</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>User</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Server</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Start<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">bool</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Param1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">If</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Param1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Start Function<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>$Class = New-Object -TypeName CustomClass</code> <br> <code>$Class.User = $env:username</code> <br> <code>$Class.Server = $env:computername</code> <br> <code>$Class.Start(1)</code><h3 id=pipeline><a aria-label="Anchor link for: pipeline" class=zola-anchor href=#pipeline><i class=icon></i></a> Pipeline</h3><p><code>$CustomObject | Add-Member -MemberType NoteProperty -Name "Type" -Value "user" -Force</code> добавление объкта вывода NoteProperty <br> <code>$CustomObject | Add-Member -MemberType NoteProperty -Name "User" -Value "admin" -Force</code> изменеие содержимого для сущности объекта User <br> <code>ping $srv | Out-Null</code> перенаправить результат вывода в Out-Null<h3 id=select-object><a aria-label="Anchor link for: select-object" class=zola-anchor href=#select-object><i class=icon></i></a> Select-Object</h3><p><code>Get-Process | Select-Object -Property *</code> отобразить все доступные объекты вывода <br> <code>Get-Process | select -Unique "Name"</code> удалить повторяющиеся значения в массиве <br> <code>Get-Process | select -ExpandProperty ProcessName</code> преобразовать из объекта-коллекции в массив (вывести содержимое без наименовая столбца) <br> <code>(Get-Process | ? Name -match iperf).Modules</code> список используемых модулей процессом<h3 id=expression><a aria-label="Anchor link for: expression" class=zola-anchor href=#expression><i class=icon></i></a> Expression</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Sort-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Descending CPU <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>first <span class="z-constant z-numeric z-integer z-powershell">10</span> ProcessName<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> сортировка по CPU, вывести первых 10 значений (-first)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ProcessorTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.TotalProcessorTime</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d+$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> затрачено процессорного времени в минутах<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Memory<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.WS</span></span> <span class="z-keyword z-operator z-assignment z-powershell">/</span> <span class="z-constant z-numeric z-integer z-powershell">1024</span><span class="z-keyword z-other z-powershell">kb</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MB<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> делим байты на КБ (1mb)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Label</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>RunTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.StartTime</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d+$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> вычесть из текущего времени - время запуска, и удалить milisec<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=select-string><a aria-label="Anchor link for: select-string" class=zola-anchor href=#select-string><i class=icon></i></a> Select-String</h3><p><code>$(ipconfig | Select-String IPv4) -replace ".+: " | Where-Object {$_ -match "^172."}</code> узнать только IP <br> <code>$Current_IP = Get-Content $RDCMan_RDG_PATH | Select-String $RDCMan_Display_Name -Context 0,1</code> получить две строки <br> <code>$Current_IP = $Current_IP.Context.DisplayPostContext[0] -replace ".+&LTname>|<\/name>"</code> забрать только вторую строку и удалить тэги<h3 id=format><a aria-label="Anchor link for: format" class=zola-anchor href=#format><i class=icon></i></a> Format</h3><p><code>Get-Process | fl ProcessName, StartTime</code> <br> <code>Get-Process | ft ProcessName, StartTime -Autosize</code> автоматическая группировка размера столбцов<h3 id=measure-object><a aria-label="Anchor link for: measure-object" class=zola-anchor href=#measure-object><i class=icon></i></a> Measure-Object</h3><p><code>Get-Process | Measure | select Count</code> кол-во объектов <br> <code>Get-Process | Measure -Line -Word -Character</code> кол-во строк, слов и Char объектов <br> <code>Get-Process | Measure-Object PM -sum | Select-Object Count,@{Name="MEM_MB"; Expression={[int]($_.Sum/1mb)}}</code> кол-во процессов и общий объем занятой памяти в МБайт<h3 id=compare-object><a aria-label="Anchor link for: compare-object" class=zola-anchor href=#compare-object><i class=icon></i></a> Compare-Object</h3><p><code>Compare-Object -ReferenceObject (Get-Content -Path .\file1.txt) -DifferenceObject (Get-Content -Path .\file2.txt)</code> сравнение двух файлов <br> <code>$group1 = Get-ADGroupMember -Identity "Domain Admins"</code> <br> <code>$group2 = Get-ADGroupMember -Identity "Enterprise Admins"</code> <br> <code>Compare-Object -ReferenceObject $group1 -DifferenceObject $group2 -IncludeEqual</code> сравнение друх объектов <code>==</code> нет изменений <br> <code><=</code> есть изменения в $group1 <br> <code>=></code> есть изменения в $group2<h3 id=where-object><a aria-label="Anchor link for: where-object" class=zola-anchor href=#where-object><i class=icon></i></a> Where-Object</h3><p><code>Get-Process | Where-Object {$_.ProcessName -match "zabbix"}</code> фильтрация/поиск процессов по имени свойства объекта <br> <code>Get-Process | where CPU -gt 10 | Sort-Object -Descending CPU</code> вывести объекты, где значения CPU больше 10 <br> <code>Get-Process | where WS -gt 200MB</code> отобразить процессы где WS выше 200МБ <br> <code>Get-Service | where Name -match "zabbix"</code> поиск службы <br> <code>Get-Service -ComputerName $srv | Where {$_.Name -match "WinRM"} | Restart-Service</code> перезапустить службу на удаленном компьютере <br> <code>(Get-Service).DisplayName</code> вывести значения свойства массива <br> <code>netstat -an | where {$_ -match 443}</code> <br> <code>netstat -an | ?{$_ -match 443}</code> <br> <code>(netstat -an) -match 443</code><h3 id=sort-object><a aria-label="Anchor link for: sort-object" class=zola-anchor href=#sort-object><i class=icon></i></a> Sort-Object</h3><p><code>Get-Process | Sort-Object -Descending CPU | ft</code> обратная (-Descending) сортировка по CPU <br> <code>Get-Process | Sort-Object -Descending cpu,ws</code> сортировка по двум свойствам <br> <code>$path[-1..-10]</code> обратная сборка массива без сортировки <br> <code>$arr = @(1..20); $arr[$($arr.Count - 1)..0]</code> пересобрать массив с конца<h3 id=last-and-first><a aria-label="Anchor link for: last-and-first" class=zola-anchor href=#last-and-first><i class=icon></i></a> Last and First</h3><p><code>Get-Process | Sort-Object -Descending CPU | select -First 10</code> вывести первых 10 объектов <br> <code>Get-Process | Sort-Object -Descending CPU | select -Last 10</code> вывести последних 10 объектов<h3 id=group-object><a aria-label="Anchor link for: group-object" class=zola-anchor href=#group-object><i class=icon></i></a> Group-Object</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Groups</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-CimInstance</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Class Win32_PnPSignedDriver <span class="z-keyword z-operator z-other z-powershell">|</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Select-Object</span> DriverProviderName<span class="z-keyword z-operator z-other z-powershell">,</span> FriendlyName<span class="z-keyword z-operator z-other z-powershell">,</span> Description<span class="z-keyword z-operator z-other z-powershell">,</span> DriverVersion<span class="z-keyword z-operator z-other z-powershell">,</span> DriverDate <span class="z-keyword z-operator z-other z-powershell">|</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Group-Object</span> DriverProviderName<span class="z-keyword z-operator z-other z-powershell">,</span> FriendlyName<span class="z-keyword z-operator z-other z-powershell">,</span> Description<span class="z-keyword z-operator z-other z-powershell">,</span> DriverVersion<span class="z-keyword z-operator z-other z-powershell">,</span> DriverDate
</span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Group</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Groups</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Group<span class="z-variable z-other z-member z-powershell">.Group</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Format-Table</span>
</span></code></pre><h3 id=property><a aria-label="Anchor link for: property" class=zola-anchor href=#property><i class=icon></i></a> Property</h3><p><code>$srv.Count</code> кол-во элементов в массиве <br> <code>$srv.Length</code> содержит количество символом строки переменной [string] или количество значений (строк) объекта <br> <code>$srv.Chars(2)</code> отобразить 3-й символ в строке <br> <code>$srv[2]</code> отобразить 3-ю строку в массиве<h3 id=method><a aria-label="Anchor link for: method" class=zola-anchor href=#method><i class=icon></i></a> Method</h3><p><code>$srv = "127.0.0.1"</code> <br> <code>$srv.Insert(0,"https://")</code> добавить значение перед первым символом <br> <code>$srv.Substring(4)</code> удалить (из всего массива) первые 4 символа <br> <code>$srv.Remove(3)</code> удалить из всего массива все после 3 символа <br> <code>$string = "123"</code> создать строку <br> <code>$int = [convert]::ToInt32($string)</code> преобразовать строку в тип данных число <br> <code>[string]::Concat($text,$num)</code> объеденить переменные в одну строку <br> <code>[string]::Join(":",$text,$num)</code> объеденить используя разделитель <br> <code>[string]::Compare($text,$num,$true)</code> выдает 0 при совпадении или 1/-1 при несовпадении, $true (без учета регистра) или $false (с учетом регистра) <br> <code>[string]::Equals($text,$num)</code> производит сравнение двух строк и выдает $true при их совпадении или $false при несовпадении <br> <code>[string]::IsNullOrEmpty($text)</code> проверяет наличие строки, если строка пуста $true, если нет $false <br> <code>[string]::IsNullOrWhiteSpace($text2)</code> проверяет на наличие только символов пробел, табуляция или символ новой строки<h1 id=error><a aria-label="Anchor link for: error" class=zola-anchor href=#error><i class=icon></i></a> Error</h1><p><code>$Error</code> выводит все ошибки текущего сеанса <br> <code>$Error[0].InvocationInfo</code> развернутый отчет об ошибке <br> <code>$Error.clear()</code> <br> <code>$LASTEXITCODE</code> результат выполнения последней команды (0 - успех) <br> <code>exit 1</code> код завершения, который возвращается $LASTEXITCODE<h3 id=executionstatus><a aria-label="Anchor link for: executionstatus" class=zola-anchor href=#executionstatus><i class=icon></i></a> ExecutionStatus</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-History</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>RunTime<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.EndExecutionTime</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.StartExecutionTime</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>ExecutionStatus<span class="z-keyword z-operator z-other z-powershell">,</span>CommandLine <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> посчитать время работы последней [-1] (или Select-Object -Last 1) выполненной команды и ее узнать статус<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h3 id=measure-command><a aria-label="Anchor link for: measure-command" class=zola-anchor href=#measure-command><i class=icon></i></a> Measure-Command</h3><p><code>$(Measure-Command {ping ya.ru}).TotalSeconds</code> получить время выполнения в секундах<h1 id=datetime><a aria-label="Anchor link for: datetime" class=zola-anchor href=#datetime><i class=icon></i></a> DateTime</h1><p><code>[DateTime]::UtcNow</code> время в формате UTC 0 <br> <code>$(Get-Date).AddHours(-3)</code> вычесть три часа из текущего времени <br> <code>$Date = $(Get-Date -Format "dd/MM/yyyy HH:mm:ss")</code> изменить формат отображения времени <br> <code>$Date = Get-Date -f "dd/MM/yyyy"</code> получаем тип данных [string] $($Date.GetType().Name) <br> <code>$Date = "19.05.2024"</code> <br> <code>[DateTime]$Date = Get-Date "$Date"</code> преобразовать строку подходящую под формат даты в тип данных [DateTime] <br> <code>$BeforeDate = Get-Date "12.05.2024"</code> <br> <code>[int32]$days=$($Date - $BeforeDate).Days</code> посчитать разницу в днях <br> <code>"5/7/07" -as [DateTime]</code> преобразовать входные данные в тип данных [DateTime]<h1 id=timespan><a aria-label="Anchor link for: timespan" class=zola-anchor href=#timespan><i class=icon></i></a> TimeSpan</h1><p><code>New-TimeSpan -Start $(Get-Date) -End $($(Get-Date).AddMinutes(+1))</code> получить разницу во времени <br> <code>$TimeZone = (Get-TimeZone).BaseUtcOffset.TotalMinutes</code> получить разницу в минутах от текущего часового пояса относительно UTC 0 <br> <code>$UnixTime  = (New-TimeSpan -Start (Get-Date "01/01/1970") -End ((Get-Date).AddMinutes(-$tz))).TotalSeconds</code> вычесть минуты для получения UTC 0 <br> <code>$TimeStamp = ([string]$UnixTime -replace "\..+") + "000000000"</code> получить текущий TimeStamp<h3 id=format-1><a aria-label="Anchor link for: format-1" class=zola-anchor href=#format-1><i class=icon></i></a> Format</h3><pre class=z-code><code><span class="z-text z-plain">HH   # Часы в 24-часовом формате (00 до 23)
</span><span class="z-text z-plain">hh   # Часы в 12-часовом формате (01 до 12)
</span><span class="z-text z-plain">mm   # Минуты (00 до 59)
</span><span class="z-text z-plain">ss   # Секунды (00 до 59)
</span><span class="z-text z-plain">tt   # Десигнатор (AM/PM)
</span><span class="z-text z-plain">fff  # Миллисекунды (000 до 999)
</span><span class="z-text z-plain">d    # День месяца без ведущего нуля (1-31)
</span><span class="z-text z-plain">dd   # День месяца с ведущим нулём (01-31)
</span><span class="z-text z-plain">ddd  # Сокращённое название дня недели (например, "Пн")
</span><span class="z-text z-plain">dddd # Полное название дня недели (например, "Понедельник")
</span><span class="z-text z-plain">M    # Номер месяца без ведущего нуля (1-12)
</span><span class="z-text z-plain">MM   # Номер месяца с ведущим нулём (01-12)
</span><span class="z-text z-plain">MMM  # Сокращённое название месяца (например, "Янв")
</span><span class="z-text z-plain">MMMM # Полное название месяца (например, "Январь")
</span><span class="z-text z-plain">y    # Год без века (0-99)
</span><span class="z-text z-plain">yy   # Год без века с ведущим нулём (00-99)
</span><span class="z-text z-plain">yyyy # Год с веком (например, 2024)
</span><span class="z-text z-plain">g    # Период или эра (например, "н.э.")
</span></code></pre><h3 id=timer><a aria-label="Anchor link for: timer" class=zola-anchor href=#timer><i class=icon></i></a> Timer</h3><p><code>$start_time = Get-Date</code> зафиксировать время до выполнения команды <br> <code>$end_time = Get-Date</code> зафиксировать время по завершению <br> <code>$time = $end_time - $start_time</code> высчитать время работы скрипта <br> <code>$min = $time.minutes</code> <br> <code>$sec = $time.seconds</code> <br> <code>Write-Host "$min минут $sec секунд"</code><p><code>$timer = [System.Diagnostics.Stopwatch]::StartNew()</code> запустить таймер <br> <code>$timer.IsRunning</code> статус работы таймера <br> <code>$timer.Elapsed.TotalSeconds</code> отобразить время с момента запуска (в секундах) <br> <code>$timer.Stop()</code> остановить таймер<h1 id=regex><a aria-label="Anchor link for: regex" class=zola-anchor href=#regex><i class=icon></i></a> Regex</h1><pre class=z-code><code><span class="z-text z-plain">.       # Обозначает любой символ, кроме новой строки
</span><span class="z-text z-plain">\       # Экранирует любой специальный символ (метасимвол). Используется, если нужно указать конкретный символ, вместо специального ({ } [ ] / \ + * . $ ^ | ?)
</span><span class="z-text z-plain">\A (^)  # Начало строки
</span><span class="z-text z-plain">\Z ($)  # Конец строки
</span><span class="z-text z-plain">\n      # Новая строка
</span><span class="z-text z-plain">\s      # Пробел (эквивалент " "), табуляция, перенос строки
</span><span class="z-text z-plain">\S      # Не пробел
</span><span class="z-text z-plain">\d      # Число от 0 до 9 (20-07-2022 эквивалент: "\d\d-\d\d-\d\d\d\d")
</span><span class="z-text z-plain">\D      # Обозначает любой символ, кроме числа (цифры). Удаления всех символов, кроме цифр: [int]$("123 test" -replace "\D")
</span><span class="z-text z-plain">\w      # Любая буква латиницы, цифра, или знак подчёркивания (от "a" до "z" и от "A" до "Z" или число от 0 до 9)
</span><span class="z-text z-plain">\W      # Не латиница, не цифра, не подчёркивание
</span><span class="z-text z-plain">\b      # Граница слова. Применяется когда нужно выделить, что искомые символы являются словом, а не частью другого слова
</span><span class="z-text z-plain">\B      # Не граница слова
</span><span class="z-text z-plain">\A      # Начало текста
</span><span class="z-text z-plain">\Z      # Конец текста
</span><span class="z-text z-plain">+       # Повторяется 1 и более раз (\s+)
</span><span class="z-text z-plain">|       # Или. Соединяет несколько вариантов
</span><span class="z-text z-plain">()      # В круглые скобки заключаются все комбинации с "или" и поиск начала и конца строк
</span><span class="z-text z-plain">[]      # поиск совпадения любой буквы, например, [A-z0-9] от A до z и цифры от 0 до 9 ("192.168.1.1" -match "192.1[6-7][0-9]")
</span><span class="z-text z-plain">[^ ]    # Исключает из поиска символы указанные в квадратных скобках
</span><span class="z-text z-plain">{ }     # Квантификатор в фигурных скобках, указывает количество повторений символа слева на право (от 1 до 25 раз)
</span><span class="z-text z-plain">\d{2}   # Найти две цифры
</span><span class="z-text z-plain">\d{2,4} # Найти две или четыре
</span><span class="z-text z-plain">{4,}    # Найти четыре и более
</span></code></pre><ul><li>Якори</ul><p><code>^</code> или <code>\A</code> определяет начало строки. $url -replace ‘^’,‘https:’<code>добавить в начало; \</code>$<code>или</code>\Z<code>обозначают конец строки. $ip -replace "\d{1,3}$","0" \</code>(?=text)<code>поиск слова слева. Пишем слева на право от искомого (ищет только целые словосочетания) "Server:\s(.{1,30})\s(?=$username)" \</code>(?<=text)<code> поиск слова справа. $in_time -replace ".+(?<=Last)"</code> удалить все до слова Last <br> <code>(?!text)</code> не совпадает со словом слева <br> <code>(?&LT!text)</code> не совпадает со словом справа<p><code>$test = "string"</code> <br> <code>$test -replace ".{1}$"</code> удалить любое кол-во символов в конце строки <br> <code>$test -replace "^.{1}"</code> удалить любое кол-во символов в начале строки \<ul><li>Группы захвата</ul><p><code>$date = '12.31.2021'</code> <br> <code>$date -replace '^(\d{2}).(\d{2})','$2.$1'</code> поменять местами <br> <code>$1</code> содержимое первой группы в скобках <br> <code>$2</code> содержимое второй группы<p><code>-replace "1","2"</code> замена элементов в индексах массива (везде где присутствует 1, заменить на 2), для удаления используется только первое значение <br> <code>-split " "</code> преобразовать строку в массив, разделителем указан пробел, которой удаляется ($url.Split(“/”)[-1]) <br> <code>-join " "</code> преобразовать массив (коллекцию) в единую строку (string), добавить разделителем пробел<p><code>@(1,2,3) -contains 3</code> проверить, что элемент справа содержится в массиве слева <br> <code>@(1,2) -notcontains 3</code> проверить, что элемент справа не содержится в массиве слева<p><code>-like *txt*</code> поиск по маскам wildcard, выводит значение на экран <br> <code>-match txt</code> поиска по шаблонам, проверка на соответствие содержимого текста <br> <code>-match "zabbix|rpc"</code> условия, для поиска по нескольким словам <br> <code>-NotMatch</code> проверка на отсутствие вхождения \<ul><li>Matches</ul><p><code>"num: 777" -match "num: ([0-9]+)" | Out-Null</code> <br> <code>$Matches[1]</code> выводим только номер<p><code>$ip = "192.168.10.1"</code> <br> <code>$ip -match "(\.\d{1,3})\.\d{1,2}"</code> True <br> <code>$Matches</code> отобразить все подходящие переменные последнего поиска, которые входят и не входят в группы ()<p><code>$String = "09/14/2017 12:00:27 - mtbill_post_201709141058.txt 7577_Delivered: OK"</code> <br> <code>$String -Match ".*(?=\.txt)" | Out-Null</code> <br> <code>$Matches[0][-4..-1] -Join ""</code><p><code>$string.Substring($string.IndexOf(".txt")-4, 4)</code> 2-й вариант (IndexOf)<ul><li>Форматирование (.NET method format)</ul><p><code>[string]::Format("{1} {0}","Index0","Index1")</code> <br> <code>"{1} {0}" -f "Index0","Index1"</code> <br> <code>"{0:###-##-##}" -f 1234567</code> записать число в другом формате (#) <br> <code>"{0:0000}" -f 123</code> вывести число в формате не меньше 4 знаков (0123) <br> <code>"{0:P0}" -f (220/1000)</code> посчитать в процентах (P) <br> <code>"{0:P}" -f (512MB/1GB)</code> сколько % составляет 512Мб от 1Гб <br> <code>"{0:0.0%}" -f 0.123</code> умножить на 100%<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>gp</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-other z-powershell">|</span> sort cpu <span class="z-keyword z-operator z-assignment z-powershell">-</span>Descending <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>First <span class="z-constant z-numeric z-integer z-powershell">10</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>p</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>gp</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0} - {1:N2}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>p<span class="z-variable z-other z-member z-powershell">.processname</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>p<span class="z-variable z-other z-member z-powershell">.cpu</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> округлить<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><ul><li>Условный оператор</ul><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rh</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Read-Host</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rh</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    ipconfig
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rh</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    getmac
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    hostname
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p>Если условие if () является истенным ($True), выполнить действие в {} <br> Если условие if () является ложным ($False), выполнить действие не обязательного оператора else <br> Условие Elseif идёт после условия if для проверки дополнительных условий перед выполнение оператора else. Оператор, который первый вернет $True, отменит выполнение следующих дополнительных условий <br> Если передать переменную в условие без оператора, то будет проверяться наличие значения у переменной на $True/$False \<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Test-NetConnection</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Port <span class="z-constant z-numeric z-integer z-powershell">80</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.TcpTestSucceeded</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Opened port<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Closed port<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><ul><li>Логические операторы сравнения</ul><p><code>-eq</code> равно (equal) <br> <code>-ceq</code> учитывать регистр <br> <code>-ne</code> не равно (not equal) <br> <code>-cne</code> не равно учитывая регистр <br> <code>-gt</code> больше (greater) <br> <code>-ge</code> больше или равно <br> <code>-lt</code> меньше (less) <br> <code>-le</code> меньше или равно <br> <code>-in</code> проверить на наличие (5 -in @(1,2,3,4,5)) <br> <code>-NOT</code> логическое НЕТ !(Test-Path $path) <br> <code>-and</code> логическое И <br> <code>-or</code> логическое ИЛИ \<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>1</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-logical z-powershell">-and</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>2</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-logical z-powershell">-or</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>1</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> два условия: (если $1 = 1 И $2 = 2) ИЛИ $1 не равно 3 вернуть $true<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><ul><li>Pipeline Operators</ul><p><code>Write-Output "First" && Write-Output "Second"</code> две успешные команды выполняются <br> <code>Write-Error "Bad" && Write-Output "Second"</code> первая команда завершается ошибкой, из-за чего вторая команда не выполняется <br> <code>Write-Error "Bad" || Write-Output "Second"</code> первая команда завершается ошибкой, поэтому выполняется вторая команда <br> <code>Write-Output "First" || Write-Output "Second"</code> первая команда выполнена успешно, поэтому вторая команда не выполняется<ul><li>Invocation Operator</ul><p><code>$addr = "8.8.8.8"</code> <br> <code>$ping = "ping"</code> <br> <code>& $ping $addr</code> запускает текст как команду<p><code>& $ping $addr &</code> запустить команду в фоне <br> <code>(Get-Job)[-1] | Receive-Job -Keep</code><h1 id=datatype><a aria-label="Anchor link for: datatype" class=zola-anchor href=#datatype><i class=icon></i></a> DataType</h1><p><code>$srv.GetType()</code> узнать тип данных <br> <code>$srv -is [string]</code> проверка на соответствие типа данных <br> <code>$srv -isnot [System.Object]</code> проверка на несоответствие <br> <code>[Object]</code> массив (BaseType:System.Array) <br> <code>[DateTime]</code> формат времени (BaseType:System.ValueType) <br> <code>[Bool]/[Boolean]</code> логическое значение ($True/$False) или 1/0 (1 бит) наличие/отсуствие напряжения <br> <code>[Byte]</code> 8-битное (1 байт) целое число без знака (0..255) <br> <code>[Int16]</code> 16-битное знаковое целое число от -32767 до 32767 (тип данных WORD 0..65535) <br> <code>[Int]</code> 32-битное (4 байта) знаковое целое число от –2147483648 до 2147483647 (DWORD) <br> <code>[Int64]</code> 64-битное от -9223372036854775808 до 9223372036854775808 (LWORD) <br> <code>[Decimal]</code> 128-битное десятичное значение от –79228162514264337593543950335 до 79228162514264337593543950335 <br> <code>[Single]</code> число с плавающей запятой (32-разрядное) <br> <code>[Double]</code> число с плавающей запятой с двойной точностью (64-разрядное) <br> <code>[String]</code> неизменяемая строка символов Юникода фиксированной длины (BaseType:System.Object)<h3 id=math><a aria-label="Anchor link for: math" class=zola-anchor href=#math><i class=icon></i></a> Math</h3><p><code>[math] | Get-Member -Static</code> <br> <code>[math]::Pow(2,4)</code> 2 в 4 степени <br> <code>[math]::Truncate(1.8)</code> грубое округление, удаляет дробную часть <br> <code>[math]::Ceiling(1.8)</code> округляет число в большую сторону до ближайшего целого значения <br> <code>[math]::Floor(-1.8)</code> округляет число в меньшую сторону <br> <code>[math]::Min(33,22)</code> возвращает наименьшее значение двух значений <br> <code>[math]::Max(33,22)</code> возвращает наибольшее значение двух значений<h3 id=round><a aria-label="Anchor link for: round" class=zola-anchor href=#round><i class=icon></i></a> Round</h3><p><code>[double]::Round(87.5, 0)</code> 88 (нечетное), в .NET по умолчанию используется округление в средней точке ToEven, где *.5 значения округляются до ближайшего четного целого числа <br> <code>[double]::Round(88.5, 0)</code> 88 (четное) <br> <code>[double]::Round(88.5, 0, 1)</code> 89 (округлять в большую сторону) <br> <code>[double]::Round(1234.56789, 2)</code> округлить до 2 символов после запятой<h3 id=tostring><a aria-label="Anchor link for: tostring" class=zola-anchor href=#tostring><i class=icon></i></a> ToString</h3><p><code>(4164539/1MB).ToString("0.00")</code> разделить на дважды на 1024/1024 и округлить до 3,97<h3 id=char><a aria-label="Anchor link for: char" class=zola-anchor href=#char><i class=icon></i></a> Char</h3><p><code>[Char]</code> cимвол Юникода (16-разрядный) <br> <code>$char = $srv.ToCharArray()</code> разбить строку [string] на массив [System.Array] из букв<h1 id=function><a aria-label="Anchor link for: function" class=zola-anchor href=#function><i class=icon></i></a> Function</h1><h3 id=switch-function><a aria-label="Anchor link for: switch-function" class=zola-anchor href=#switch-function><i class=icon></i></a> Switch function</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MMM</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Date</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>UFormat <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>%m<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">switch</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MMM</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>01<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Jan<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>02<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Feb<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>03<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Mar<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>04<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Apr<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>05<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>May<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>06<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Jun<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>07<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Jul<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>08<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Aug<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>09<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Sep<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>10<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Oct<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>11<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Nov<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>12<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Month</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Dec<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=switch-param><a aria-label="Anchor link for: switch-param" class=zola-anchor href=#switch-param><i class=icon></i></a> Switch param</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">Function</span> <span class="z-entity z-name z-function z-powershell">fun-switch</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>param</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">If</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>param</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>yes<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>no<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>fun-switch -param</code><h3 id=psm1-module-file-and-parameters><a aria-label="Anchor link for: psm1-module-file-and-parameters" class=zola-anchor href=#psm1-module-file-and-parameters><i class=icon></i></a> psm1 (module file and parameters)</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-Function</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-block z-powershell"><span class="z-punctuation z-definition z-comment z-block z-begin z-powershell"><#</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">SYNOPSIS</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    Описание
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">DESCRIPTION</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    Описание
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">LINK</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    https://github.com/Lifailon/PS-Commands
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    <span class="z-punctuation z-definition z-comment z-block z-end z-powershell">#></span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-parameter z-attribute z-powershell">ValueFromPipeline</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Text</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">ValidateSet</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test2<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Provider</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Test1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">ValidateRange</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Number</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-keyword z-control z-powershell">Param</span> Text: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Text</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-keyword z-control z-powershell">Param</span> Provider: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Provider</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-keyword z-control z-powershell">Param</span> Number: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Number</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Get-Function -Text Text1</code> <br> <code>Get-Function -Text Text2 -Provider Test2 -Number 3</code><h3 id=psd1-module-description-file><a aria-label="Anchor link for: psd1-module-description-file" class=zola-anchor href=#psd1-module-description-file><i class=icon></i></a> psd1 (module description file)</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">RootModule</span>        <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Get-Function.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ModuleVersion</span>     <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>0.1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Author</span>            <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Lifailon<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">CompanyName</span>       <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Open Source Community<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Copyright</span>         <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Apache-2.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Description</span>       <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Function example<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">PowerShellVersion</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>7.2<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">PrivateData</span>       <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">PSData</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Tags</span>         <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Function<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Example<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ProjectUri</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/Lifailon/PS-Commands<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">LicenseUri</span>   <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/Lifailon/Console-Translate/blob/rsa/LICENSE<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">ReleaseNotes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Second release<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h1 id=bit><a aria-label="Anchor link for: bit" class=zola-anchor href=#bit><i class=icon></i></a> Bit</h1><pre class=z-code><code><span class="z-text z-plain">Двоичное    Десятичное
</span><span class="z-text z-plain">1           1
</span><span class="z-text z-plain">10          2
</span><span class="z-text z-plain">11          3
</span><span class="z-text z-plain">100         4
</span><span class="z-text z-plain">101         5
</span><span class="z-text z-plain">110         6
</span><span class="z-text z-plain">111         7
</span><span class="z-text z-plain">1000        8
</span><span class="z-text z-plain">1001        9
</span><span class="z-text z-plain">1010        10
</span><span class="z-text z-plain">1011        11
</span><span class="z-text z-plain">1100        12
</span><span class="z-text z-plain">1101        13
</span><span class="z-text z-plain">1110        14
</span><span class="z-text z-plain">1111        15
</span><span class="z-text z-plain">1 0000      16
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Двоичное    Десятичное  Номер разряда
</span><span class="z-text z-plain">1           1           0
</span><span class="z-text z-plain">10          2           1
</span><span class="z-text z-plain">100         4           2
</span><span class="z-text z-plain">1000        8           3
</span><span class="z-text z-plain">1 0000      16          4
</span><span class="z-text z-plain">10 0000     32          5
</span><span class="z-text z-plain">100 0000    64          6
</span><span class="z-text z-plain">1000 0000   128         7
</span><span class="z-text z-plain">1 0000 0000 256         8
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Из двоичного => десятичное (1-й вариант по таблице)
</span><span class="z-text z-plain">1001 0011 = 1000 0000 + 1 0000 + 10 + 1 = 128 + 16 + 2 + 1 = 147
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">2-й вариант
</span><span class="z-text z-plain">7654 3210 (разряды двоичного выражения) = (1*2^7)+(0*2^6)+(0*2^5)+(1*2^4)+(0*2^3)+(0*2^2)+(1*2^1)+(1*2^0) = 147
</span><span class="z-text z-plain">[math]::Pow(2,7) + [math]::Pow(2,4) + [math]::Pow(2,1) + [math]::Pow(2,0) = 147` исключить 0 и сложить степень
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Из десятичного => двоичное (1-й вариант по таблице)
</span><span class="z-text z-plain">347 вычесть ближайшие 256 = 91 (+ 1 0000 0000 забрать двоичный остаток)
</span><span class="z-text z-plain">91  - 64  = 27 ближайшее 16 (+ 100 0000)
</span><span class="z-text z-plain">27  - 16  = 11 ближайшее 8 (+ 1 0000)
</span><span class="z-text z-plain">11  - 8   = 3  ближайшее 2 (+ 1000)
</span><span class="z-text z-plain">3   - 2   = 1 (+ 10)
</span><span class="z-text z-plain">1   - 1   = 0 (+ 1)
</span><span class="z-text z-plain">1 0101 1011
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">2-й вариант
</span><span class="z-text z-plain">Последовательное деления числа на 2, предворительно забирая остаток для получения четного числа в меньшую сторону
</span><span class="z-text z-plain">347 - 346 = остаток 1, (347-1)/2 = 173
</span><span class="z-text z-plain">173 - 172 = остаток 1, (172-1)/2 = 86
</span><span class="z-text z-plain">86  - 86  = остаток 0, 86/2 = 43
</span><span class="z-text z-plain">43  - 42  = остаток 1, (43-1)/2 = 21
</span><span class="z-text z-plain">21  - 20  = остаток 1, (21-1)/2 = 10
</span><span class="z-text z-plain">10  - 10  = остаток 0, 10/2 = 5
</span><span class="z-text z-plain">5   - 4   = остаток 1, (5-1)/2 = 2
</span><span class="z-text z-plain">2   - 2   = остаток 0, 2/2 = 1
</span><span class="z-text z-plain">1   - 2   = остаток 1, (1-1)/2 = 0
</span><span class="z-text z-plain">Результат деления записывается снизу вверх
</span></code></pre><h3 id=bit-convertor><a aria-label="Anchor link for: bit-convertor" class=zola-anchor href=#bit-convertor><i class=icon></i></a> Bit Convertor</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertTo-Bit</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">array</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetType<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">double</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">array</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.GetType<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">2</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">array</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span>  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">-999</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\s<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>ConvertTo-Bit 347</code><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertFrom-Bit</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bit</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bit<span class="z-variable z-other z-member z-powershell">.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ToCharArray<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits<span class="z-variable z-other z-member z-powershell">.Count</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-constant z-numeric z-integer z-powershell">-1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>b</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>bits</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>b</span> <span class="z-keyword z-operator z-comparison z-powershell">-notlike</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">math</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Pow<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>index</span> <span class="z-keyword z-operator z-assignment z-powershell">-=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>int</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>ConvertFrom-Bit 10010011</code><p><code>Get-Process pwsh | fl ProcessorAffinity</code> привязка процесса к ядрам, представляет из себя битовую маску (bitmask), где каждому биту соответствует ядро процессора. Если для ядра отмечено сходство (affinity), то бит выставляется в 1, если нет — то в 0. Например, если выбраны все 16 ядер, то это 1111 1111 1111 1111 или 65535. <br> <code>$(Get-Process pwsh).ProcessorAffinity = 15</code> 0000000000001111 присвоить 4 первых ядра <br> <code>$(Get-Process pwsh).ProcessorAffinity = 61440</code> 1111000000000000 присвоить 4 последних ядра <br> <code>$(Get-Process pwsh).ProcessorAffinity = (ConvertFrom-Bit 1111000000000000)</code><h1 id=cycle><a aria-label="Anchor link for: cycle" class=zola-anchor href=#cycle><i class=icon></i></a> Cycle</h1><h3 id=foreach><a aria-label="Anchor link for: foreach" class=zola-anchor href=#foreach><i class=icon></i></a> Foreach</h3><p><code>$list = 100..110</code> создать массив из цифр от 100 до 110 <br> <code>foreach ($srv in $list) {ping 192.168.3.$srv -n 1 -w 50}</code> $srv хранит текущий элемент из $list и повторяет команду до последнего элемента в массиве <br> <code>$foreach.Current</code> текущий элемент в цикле <br> <code>$foreach.Reset()</code> обнуляет итерацию, перебор начнется заново, что приводит к бесконечному циклу <br> <code>$foreach.MoveNext()</code> переход к следующему элементу в цикле<h3 id=foreach-object><a aria-label="Anchor link for: foreach-object" class=zola-anchor href=#foreach-object><i class=icon></i></a> ForEach-Object</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">100</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">110</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">%</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-constant z-numeric z-integer z-powershell">192.168</span>.<span class="z-constant z-numeric z-integer z-powershell">3</span>.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-redirection z-powershell">></span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>LastExitCode</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ForegroundColor green
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">-</span>ForegroundColor Red
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>% </code> передать цикл через конвеер (ForEach-Object) <br> <code>$_</code> переменная цикла и конвеера ($PSItem) <br> <code>gwmi Win32_QuickFixEngineering | where {$_.InstalledOn.ToString() -match "2022"} | %{($_.HotFixID.Substring(2))}</code> gwmi создает массив, вывод команды передается where для поиска подходящих под критерии объектов. По конвееру передается в цикл для удаления первых (2) символов методом Substring из всех объектов HotFixID.<h3 id=while><a aria-label="Anchor link for: while" class=zola-anchor href=#while><i class=icon></i></a> While</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>yandex.ru<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out2</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Есть пинг<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out3</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Нет пинга<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> предварительно сбросить переменную, While проверяет условие до запуска цикла<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">While</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> пока условие является $true, цикл будет повторяться<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ttl<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out2</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out3</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> sleep <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> запустить бесконечный цикл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> ping yandex.ru <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>TTL<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> условие, при котором будет выполнен break<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Сайт доступен<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">break</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> остановит цикл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Сайт недоступен<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> sleep <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=try-catch-finally><a aria-label="Anchor link for: try-catch-finally" class=zola-anchor href=#try-catch-finally><i class=icon></i></a> Try-Catch-Finally</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">Try</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> pping <span class="z-constant z-numeric z-integer z-powershell">192.168</span>.<span class="z-constant z-numeric z-integer z-powershell">3.1</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">Catch</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Write-Warning</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>error</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> выводит в случае ошибки (вместо ошибки)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">finally</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>End<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> выполняется в конце в любом случае<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h1 id=files><a aria-label="Anchor link for: files" class=zola-anchor href=#files><i class=icon></i></a> Files</h1><p><code>Get-Content $home/desktop\test.txt -Wait</code> аналог tail <br> <code>Test-Path $path</code> проверить доступность пути <br> <code>Get-FileHash -Algorithm SHA256 "$path"</code> узнать хэш файла по алгоритму sha256 <br> <code>Get-ChildItem $path -Filter *.txt -Recurse</code> отобразить содержимое каталога (Alias: ls/gci/dir) и дочерних каталогов (-Recurse) и отфильтровать вывод <br> <code>Get-Location</code> отобразить текущие месторасположение (Alias: pwd/gl) <br> <code>Set-Location $path</code> перемещение по каталогам (Alias: cd/sl) <br> <code>Invoke-Item $path</code> открыть файл (Alias: ii/start) <br> <code>Get-ItemProperty $env:userprofile\Documents\dns-list.txt | select FullName,Directory,Name,BaseName,Extension</code> свойтсва файла <br> <code>Get-ItemProperty -Path $path\* | select FullName,CreationTime,LastWriteTime</code> свойства файлов содержимого директории, дата их создания и последнего изменения <br> <code>New-Item -Path "C:\test\" -ItemType "Directory"</code> создать директорию (Alias: mkdir/md) <br> <code>New-Item -Path "C:\test\file.txt" -ItemType "File" -Value "Добавить текст в файл"</code> создать файл <br> <code>"test" > "C:\test\file.txt"</code> заменить содержимое <br> <code>"test" >> "C:\test\file.txt"</code> добавить строку в файл <br> <code>New-Item -Path "C:\test\test\file.txt" -Force</code> ключ используется для создания отсутствующих в пути директорий или перезаписи файла если он уже существует <br> <code>Move-Item</code> перемещение объектов (Alias: mv/move) <br> <code>Remove-Item "$path\" -Recurse</code> удаление всех файлов внутри каталога, без запроса подверждения (Alias: rm/del) <br> <code>Remove-Item $path -Recurse -Include "*.txt","*.temp" -Exclude "log.txt"</code> удалить все файлы с расширением txt и temp ([Array]), кроме log.txt <br> <code>Rename-Item "C:\test\*.*" "*.jpg"</code> переименовать файлы по маске (Alias: ren) <br> <code>Copy-Item</code> копирование файлов и каталогов (Alias: cp/copy) <br> <code>Copy-Item -Path "\\server-01\test" -Destination "C:\" -Recurse</code> копировать директорию с ее содержимым (-Recurse) <br> <code>Copy-Item -Path "C:\*.txt" -Destination "C:\test\"</code> знак ’' в конце Destination используется для переноса папки внутрь указанной, отсутствие, что это новое имя директории <br> <code>Copy-Item -Path "C:\*" -Destination "C:\test\" -Include '*.txt','*.jpg'</code> копировать объекты с указанным расширением (Include) <br> <code>Copy-Item -Path "C:\*" -Destination "C:\test\" -Exclude '*.jpeg'</code> копировать объекты, за исключением файлов с расширением (Exclude) <br> <code>$log = Copy-Item "C:\*.txt" "C:\test\" -PassThru</code> вывести результат копирования (логирование) в переменную, можно забирать строки с помощью индексов $log[0].FullName <br> <code>Unblock-File "script.ps1"</code> разблокирует файлы скриптов PowerShell скачанных из Интернета, чтобы их можно было запустить, даже если политика выполнения PowerShell в режиме RemoteSigned<h3 id=clear-env-temp-14-days><a aria-label="Anchor link for: clear-env-temp-14-days" class=zola-anchor href=#clear-env-temp-14-days><i class=icon></i></a> Clear-env-Temp-14-days</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ls</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>TEMP</span>\<span class="z-keyword z-operator z-assignment z-powershell">*</span>.tmp <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> считать все файлы с указанным расширением<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>date</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.AddDays<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">-14</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>l</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ls</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>l<span class="z-variable z-other z-member z-powershell">.LastWriteTime</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-le</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>l<span class="z-variable z-other z-member z-powershell">.FullName</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>l<span class="z-variable z-other z-member z-powershell">.FullName</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=system-io-file><a aria-label="Anchor link for: system-io-file" class=zola-anchor href=#system-io-file><i class=icon></i></a> System IO File</h3><p><code>$file = [System.IO.File]::Create("$home\desktop\test.txt")</code> создать файл <br> <code>$file.Close()</code> закрыть файл <br> <code>[System.IO.File]::ReadAllLines("$home\desktop\test.txt")</code> прочитать файл <br> <code>$file = New-Object System.IO.StreamReader("$home\desktop\test.txt")</code> файл будет занят процессом PowerShell <br> <code>$file | Get-Member</code> <br> <code>$file.ReadLine()</code> построчный вывод <br> <code>$file.ReadToEnd()</code> прочитать файл целиком<h3 id=read-and-write-bytes><a aria-label="Anchor link for: read-and-write-bytes" class=zola-anchor href=#read-and-write-bytes><i class=icon></i></a> Read and Write Bytes</h3><p><code>$file = [io.file]::ReadAllBytes("$home\desktop\powershell.jpg")</code> метод открывает двоичный файл, считывает его в массив байт и закрывает файл <br> <code>[io.file]::WriteAllBytes("$home\desktop\tloztotk-2.jpg",$file)</code> сохранить байты в файл (можно использовать для выгрузки двоичных файлов из БД)<h1 id=archive><a aria-label="Anchor link for: archive" class=zola-anchor href=#archive><i class=icon></i></a> Archive</h1><h3 id=microsoft-powershell-archive><a aria-label="Anchor link for: microsoft-powershell-archive" class=zola-anchor href=#microsoft-powershell-archive><i class=icon></i></a> Microsoft PowerShell Archive</h3><p><code>Compress-Archive -Path $srcPath -DestinationPath "$($srcPath).zip" -CompressionLevel Optimal</code> архивировать (по исходному пути и названию с добавлением расширения) <br> <code>Expand-Archive -Path $zip</code> разархивировать <br> <code>Expand-Archive -Path $zip -DestinationPath $dstPath</code> указать путь извлечения <br> <code>Expand-Archive -Path $zip -OutputPath $dstPath</code><h3 id=system-io-compression-filesystem><a aria-label="Anchor link for: system-io-compression-filesystem" class=zola-anchor href=#system-io-compression-filesystem><i class=icon></i></a> System IO Compression FileSystem</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Expand-ArchiveFile</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Путь к архиву<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Path</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Путь, куда извлечь файл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DestinationPath</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Имя файла, который нужно извлечь<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FileName</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>AssemblyName System.IO.Compression.FileSystem
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">try</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Открыть архив для чтения<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipArchive</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.Compression.ZipFile</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::OpenRead<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Найти файл в архиве<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileEntry</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipArchive<span class="z-variable z-other z-member z-powershell">.Entries</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.FullName</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileName</span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileEntry</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создание потока для чтения содержимого файла<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stream</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileEntry<span class="z-variable z-other z-member z-powershell">.Open</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создание файла и запись в него данных из потока<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DestinationPathFileName</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DestinationPath</span>\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FileName</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileStream</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.File</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Create<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DestinationPathFileName</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stream<span class="z-variable z-other z-member z-powershell">.CopyTo</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileStream</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Закрытие потоков<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>stream<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileStream<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-support z-function z-powershell">Write-Output</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Файл <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fileName</span> не найден в архиве<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">catch</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Error</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Ошибка при извлечении файла из архива<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">finally</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Закрыть архив<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>zipArchive<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h3 id=winrar><a aria-label="Anchor link for: winrar" class=zola-anchor href=#winrar><i class=icon></i></a> WinRAR</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Expand-ArchivePassword</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Path</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Password</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>winrar</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span>  <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Program Files\WinRAR\WinRAR.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-operator z-other z-powershell">&</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>winrar</span> x <span class="z-keyword z-operator z-assignment z-powershell">-</span>p<span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Password</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Path</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>cd "$home\Downloads"</code> <br> <code>Expand-ArchivePassword archive.rar qwe123</code><h1 id=handles><a aria-label="Anchor link for: handles" class=zola-anchor href=#handles><i class=icon></i></a> Handles</h1><p><code>$url = "https://download.sysinternals.com/files/Handle.zip"</code> <br> <code>Invoke-RestMethod $url -OutFile "$env:TEMP\handle.zip"</code> <br> <code>Expand-ArchiveFile -Path "$env:TEMP\handle.zip" -DestinationPath "$home\Documents" -FileName "handle.exe"</code> извлекаем выбранный файл из архива <br> <code>Remove-Item "$env:TEMP\handle.zip"</code> <br> <code>$handle = "$home\Documents\handle.exe"</code> <br> <code>$test = New-Object System.IO.StreamReader("$home\desktop\test.txt")</code> занять файл текущим процессом pwsh ($pid) <br> <code>$SearchProcess = & $handle "C:\Users\Lifailon\Desktop\test.txt" -nobanner -u -v | ConvertFrom-Csv</code> вывести список дескрипторов по пути к файлу (имя процесса, его PID и пользователь который запустил) <br> <code>Stop-Process $SearchProcess.PID</code> завершить процесс, который удерживал файл<h1 id=console-menu><a aria-label="Anchor link for: console-menu" class=zola-anchor href=#console-menu><i class=icon></i></a> Console-Menu</h1><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Импортируем модуль PS-Menu в текущую сессию из репозитория GitHub<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>module</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://raw.githubusercontent.com/chrisseroka/ps-menu/master/ps-menu.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-Expression</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>module</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></code></pre><p>Пример навигации по директориям в системе используя меню:<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ls-menu</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">  <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">  clear
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">  <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Проверяем, что мы не находимся в root директории (исключить возврат назад)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">  <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.Path</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetPathRoot<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> menu <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-array-expression z-powershell">      <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-ChildItem</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.name<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-array-expression z-powershell">    <span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">  <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">  <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> menu <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-array-expression z-powershell">      <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>..<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-ChildItem</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.name<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-array-expression z-powershell">    <span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">  <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">  <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Если выбрали возврат назад, то забираем только путь у стартовой директории<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">  <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>..<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>backPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IO.Path</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetDirectoryName<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    ls<span class="z-keyword z-operator z-assignment z-powershell">-</span>menu <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>backPath</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">  <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">  <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Проверяем, что выбрали директорию<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span>\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PathType Container<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">      <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Если выбрали директорию, к стартовому пути добавляем выбранное имя директории<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">      ls<span class="z-keyword z-operator z-assignment z-powershell">-</span>menu <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span>\<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>select</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">      ls<span class="z-keyword z-operator z-assignment z-powershell">-</span>menu <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>startDir</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">  <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>ls-menu</code> <br> <code>ls-menu $home</code> <br> <code>ls-menu "D:\"</code><h1 id=credential><a aria-label="Anchor link for: credential" class=zola-anchor href=#credential><i class=icon></i></a> Credential</h1><p><code>$Cred = Get-Credential</code> сохраняет креды в переменные <code>$Cred.Username</code> и <code>$Cred.Password</code> <br> <code>$Cred.GetNetworkCredential().password</code> извлечь пароль <br> <code>cmdkey /generic:"TERMSRV/$srv" /user:"$username" /pass:"$password"</code> добавить указанные креды аудентификации на на терминальный сервер для подключения без пароля <br> <code>mstsc /admin /v:$srv</code> авторизоваться <br> <code>cmdkey /delete:"TERMSRV/$srv"</code> удалить добавленные креды аудентификации из системы <br> <code>rundll32.exe keymgr.dll,KRShowKeyMgr</code> хранилище Stored User Names and Password <br> <code>Get-Service VaultSvc</code> служба для работы Credential Manager <br> <code>Install-Module CredentialManager</code> установить модуль управления Credential Manager к хранилищу PasswordVault из PowerShell <br> <code>[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]'Tls11,Tls12'</code> для устаноки модуля <br> <code>Get-StoredCredential</code> получить учетные данные из хранилища Windows Vault <br> <code>Get-StrongPassword</code> генератор пароля <br> <code>New-StoredCredential -UserName test -Password "123456"</code> добавить учетную запись <br> <code>Remove-StoredCredential</code> удалить учетную запись <br> <code>$Cred = Get-StoredCredential | where {$_.username -match "admin"}</code> <br> <code>$pass = $cred.password</code> <br> <code>$BSTR = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pass)</code> <br> <code>[System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)</code><h3 id=out-gridview><a aria-label="Anchor link for: out-gridview" class=zola-anchor href=#out-gridview><i class=icon></i></a> Out-Gridview</h3><p><code>Get-Service -cn $srv | Out-GridView -Title "Service $srv" -OutputMode Single –PassThru | Restart-Service</code> перезапустить выбранную службу<h3 id=out-file><a aria-label="Anchor link for: out-file" class=zola-anchor href=#out-file><i class=icon></i></a> Out-File</h3><p><code>Read-Host –AsSecureString | ConvertFrom-SecureString | Out-File "$env:userprofile\desktop\password.txt"</code> писать в файл. Преобразовать пароль в формат SecureString с использованием шифрования Windows Data Protection API (DPAPI)<h3 id=get-content><a aria-label="Anchor link for: get-content" class=zola-anchor href=#get-content><i class=icon></i></a> Get-Content</h3><p><code>$password = gc "$env:userprofile\desktop\password.txt" | ConvertTo-SecureString</code> читать хэш пароля из файла с помощью ключей, хранящихся в профиле текущего пользователя, который невозможно прочитать на другом копьютере<h3 id=aes-key><a aria-label="Anchor link for: aes-key" class=zola-anchor href=#aes-key><i class=icon></i></a> AES Key</h3><p><code>$AESKey = New-Object Byte[] 32</code> <br> <code>[Security.Cryptography.RNGCryptoServiceProvider]::Create().GetBytes($AESKey)</code> <br> <code>$AESKey | Out-File "C:\password.key"</code> <br> <code>$Cred.Password | ConvertFrom-SecureString -Key (Get-Content "C:\password.key") | Set-Content "C:\password.txt"</code> сохранить пароль в файл используя внешний ключ <br> <code>$pass = Get-Content "C:\password.txt" | ConvertTo-SecureString -Key (Get-Content "\\Server\Share\password.key")</code> расшифровать пароль на втором компьютере<h1 id=winevent><a aria-label="Anchor link for: winevent" class=zola-anchor href=#winevent><i class=icon></i></a> WinEvent</h1><p><code>Get-WinEvent -ListLog *</code> отобразить все доступные журналы логов <br> <code>Get-WinEvent -ListLog * | where RecordCount -ne 0 | where RecordCount -ne $null | sort -Descending RecordCount</code> отобразить не пустые журналы с сортировкой по кол-ву записей <br> <code>Get-WinEvent -ListProvider * | ft</code> отобразить всех провайдеров приложений <br> <code>Get-WinEvent -ListProvider GroupPolicy</code> найти в какой журнал LogLinks {Application} пишутся логи приложения <br> <code>Get-WinEvent -ListProvider *smb*</code> <br> <code>Get-WinEvent -ListLog * | where logname -match SMB | sort -Descending RecordCount</code> найти все журналы по имени <br> <code>Get-WinEvent -LogName "Microsoft-Windows-SmbClient/Connectivity"</code> <br> <code>Get-WinEvent -ListProvider *firewall*</code><h3 id=xpath><a aria-label="Anchor link for: xpath" class=zola-anchor href=#xpath><i class=icon></i></a> XPath</h3><p><code>Get-WinEvent -FilterHashtable @{LogName="Security";ID=4624}</code> найти логи по ID в журнале Security <br> <code>Get-WinEvent -FilterHashtable @{LogName="System";Level=2}</code> найти все записи ошибки (1 - критический, 3 - предупреждение, 4 - сведения) <br> <code>Get-WinEvent -FilterHashtable @{LogName="System";Level=2;ProviderName="Service Control Manager"}</code> отфильтровать по имени провайдера<p><code>([xml](Get-WinEvent -FilterHashtable @{LogName="Security";ID=4688} -MaxEvents 1).ToXml()).Event.EventData.Data</code> отобразить все свойства, хранимые в EventData (Message) <br> <code>Get-WinEvent -FilterHashtable @{logname="security";ID=4688} -MaxEvents 1 | select timecreated,{$_.Properties[5].value}</code> отфильтровать время события и имя запущенного процесса<pre class=z-code><code><span class="z-text z-plain">$query = '
</span><span class="z-text z-plain">&LTQueryList>
</span><span class="z-text z-plain">    &LTQuery Id="0" Path="Security">
</span><span class="z-text z-plain">        &LTSelect Path="Security">
</span><span class="z-text z-plain">        *[System[EventID=4688]] and 
</span><span class="z-text z-plain">            *[EventData[Data[@Name="NewProcessName"]="C:\Windows\System32\autochk.exe" or Data[@Name="NewProcessName"]="C:\Windows\System32\services.exe"]]
</span><span class="z-text z-plain">        &LT/Select>
</span><span class="z-text z-plain">    &LT/Query>
</span><span class="z-text z-plain">&LT/QueryList>
</span><span class="z-text z-plain">'
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Get-WinEvent -LogName Security -FilterXPath $query
</span></code></pre><h3 id=reboot><a aria-label="Anchor link for: reboot" class=zola-anchor href=#reboot><i class=icon></i></a> Reboot</h3><pre class=z-code><code><span class="z-text z-plain">$query = '
</span><span class="z-text z-plain">&LTQueryList>
</span><span class="z-text z-plain">    &LTQuery Id="0" Path="System">
</span><span class="z-text z-plain">        &LTSelect Path="System">
</span><span class="z-text z-plain">        *[
</span><span class="z-text z-plain">      System[
</span><span class="z-text z-plain">      EventID=41 or
</span><span class="z-text z-plain">      EventID=1074 or
</span><span class="z-text z-plain">      EventID=1076 or
</span><span class="z-text z-plain">      EventID=6005 or
</span><span class="z-text z-plain">      EventID=6006 or
</span><span class="z-text z-plain">      EventID=6008 or
</span><span class="z-text z-plain">      EventID=6009 or
</span><span class="z-text z-plain">      EventID=6013
</span><span class="z-text z-plain">      ]
</span><span class="z-text z-plain">      ]
</span><span class="z-text z-plain">        &LT/Select>
</span><span class="z-text z-plain">    &LT/Query>
</span><span class="z-text z-plain">&LT/QueryList>
</span><span class="z-text z-plain">'
</span><span class="z-text z-plain">Get-WinEvent -LogName System -FilterXPath $query
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">41  ` Система была перезагружена без корректного завершения работы.
</span><span class="z-text z-plain">1074` Система была корректного выключена пользователем или процессом.
</span><span class="z-text z-plain">1076` Следует за Event ID 6008 и означает, что первый пользователь (с правом выключения системы) подключившийся к серверу после неожиданной перезагрузки или выключения, указал причину этого события.
</span><span class="z-text z-plain">6005` Запуск "Журнала событий Windows" (Event Log). Указывает на включение системы.
</span><span class="z-text z-plain">6006` Остановка «Журнала событий Windows». Указывает на выключение системы.
</span><span class="z-text z-plain">6008` Предыдущее выключение системы было неожиданным.
</span><span class="z-text z-plain">6009` Версия операционной системы, зафиксированная при загрузке системы.
</span><span class="z-text z-plain">6013` Время работы системы (system uptime) в секундах.
</span></code></pre><h3 id=logon><a aria-label="Anchor link for: logon" class=zola-anchor href=#logon><i class=icon></i></a> Logon</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>localhost<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FilterXPath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>&LTQueryList>&LTQuery Id="0">&LTSelect>*[System[EventID=21]]&LT/Select>&LT/Query>&LT/QueryList><span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RDPAuths</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-WinEvent</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComputerName <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srv</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>LogName <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft-Windows-TerminalServices-LocalSessionManager/Operational<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilterXPath <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>FilterXPath</span>
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">xml</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RDPAuths</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">Foreach</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.ToXml</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EventData</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-keyword z-control z-powershell">Foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>event</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.Event</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">New-Object</span> PSObject <span class="z-keyword z-operator z-assignment z-powershell">-</span>Property <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Connection Time<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>event<span class="z-variable z-other z-member z-powershell">.System.TimeCreated.SystemTime</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Format <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>yyyy-MM-dd hh:mm K<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>User Name<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>event<span class="z-variable z-other z-member z-powershell">.UserData.EventXML.User</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>User ID<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>event<span class="z-variable z-other z-member z-powershell">.UserData.EventXML.SessionID</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>User Address<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>event<span class="z-variable z-other z-member z-powershell">.UserData.EventXML.Address</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Event ID<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>event<span class="z-variable z-other z-member z-powershell">.System.EventID</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EventData</span> <span class="z-keyword z-operator z-other z-powershell">|</span> ft
</span></code></pre><h3 id=eventlog><a aria-label="Anchor link for: eventlog" class=zola-anchor href=#eventlog><i class=icon></i></a> EventLog</h3><p><code>Get-EventLog -List</code> отобразить все корневые журналы логов и их размер <br> <code>Clear-EventLog Application</code> очистить логи указанного журнала <br> <code>Get-EventLog -LogName Security -InstanceId 4624</code> найти логи по ID в журнале Security<h1 id=firewall><a aria-label="Anchor link for: firewall" class=zola-anchor href=#firewall><i class=icon></i></a> Firewall</h1><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>days</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">5</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>obj</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fw</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-WinEvent</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Microsoft-Windows-Windows Firewall With Advanced Security/Firewall<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temp_fw</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>fw</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temp_fw<span class="z-variable z-other z-member z-powershell">.id</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2097</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> 2004<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Added Rule<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temp_fw<span class="z-variable z-other z-member z-powershell">.id</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2006</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Deleted Rule<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temp_fw<span class="z-variable z-other z-member z-powershell">.Properties</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">7</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>ExpandProperty value
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temp_fw<span class="z-variable z-other z-member z-powershell">.Properties</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>ExpandProperty value
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>obj</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Time</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>temp_fw<span class="z-variable z-other z-member z-powershell">.TimeCreated</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>type</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Port</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>name</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>obj</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> time <span class="z-keyword z-operator z-comparison z-powershell">-gt</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.AddDays<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>days</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><p><code>New-NetFirewallRule -Profile Any -DisplayName "Open Port 135 RPC" -Direction Inbound -Protocol TCP -LocalPort 135</code> открыть in-порт <br> <code>Get-NetFirewallRule | where DisplayName -match kms | select *</code> найти правило по имени <br> <code>Get-NetFirewallPortFilter | where LocalPort -like 80</code> найти действующие правило по номеру порта<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-NetFirewallRule</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Enabled True <span class="z-keyword z-operator z-assignment z-powershell">-</span>Direction Inbound <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>Property DisplayName<span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Protocol<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-NetFirewallPortFilter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Protocol<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>LocalPort<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-NetFirewallPortFilter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.LocalPort<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>RemotePort<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-NetFirewallPortFilter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.RemotePort<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell"><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>RemoteAddress<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-NetFirewallAddressFilter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.RemoteAddress<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span><span class="z-source z-powershell">Enabled<span class="z-keyword z-operator z-other z-powershell">,</span>Profile
</span></code></pre><h3 id=firewall-manager><a aria-label="Anchor link for: firewall-manager" class=zola-anchor href=#firewall-manager><i class=icon></i></a> Firewall-Manager</h3><p><code>Install-Module Firewall-Manager</code> <br> <code>Export-FirewallRules -Name * -CSVFile $home\documents\fw.csv</code> -Inbound -Outbound -Enabled -Disabled -Allow -Block (фильтр правил для экспорта) <br> <code>Import-FirewallRules -CSVFile $home\documents\fw.csv</code><h1 id=defender><a aria-label="Anchor link for: defender" class=zola-anchor href=#defender><i class=icon></i></a> Defender</h1><p><code>Import-Module Defender</code> <br> <code>Get-Command -Module Defender</code> <br> <code>Get-MpComputerStatus</code> <br> <code>(Get-MpComputerStatus).AntivirusEnabled</code> статус работы антивируса<p><code>$session = NewCimSession -ComputerName hostname</code> подключиться к удаленному компьютеру, используется WinRM <br> <code>Get-MpComputerStatus -CimSession $session | fl fullscan*</code> узнать дату последнего сканирования на удаленном компьютере<p><code>Get-MpPreference</code> настройки <br> <code>(Get-MpPreference).ScanPurgeItemsAfterDelay</code> время хранения записей журнала защитника в днях <br> <code>Set-MpPreference -ScanPurgeItemsAfterDelay 30</code> изменить время хранения <br> <code>ls "C:\ProgramData\Microsoft\Windows Defender\Scans\History"</code> <br> <code>Get-MpPreference | select disable*</code> отобразить статус всех видов проверок/сканирований <br> <code>Set-MpPreference -DisableRealtimeMonitoring $true</code> отключить защиту Defender в реальном времени (использовать только ручное сканирование) <br> <code>Set-MpPreference -DisableRemovableDriveScanning $false</code> включить сканирование USB накопителей <br> <code>Get-MpPreference | select excl*</code> отобразить список всех исключений <br> <code>(Get-MpPreference).ExclusionPath</code> <br> <code>Add-MpPreference -ExclusionPath C:\install</code> добавить директорию в исключение <br> <code>Remove-MpPreference -ExclusionPath C:\install</code> удалить из исключения <br> <code>New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force</code> полностью отключить Windows Defender<p><code>Set-MpPreference -SignatureDefinitionUpdateFileSharesSources \\FileShare1\Updates</code> для обновления из сетевой папки нужно предварительно скачать файлы с сигнатурами баз с сайта https://www.microsoft.com/security/portal/definitions/adl.aspx и поместить в сетевой каталог <code>Update-MpSignature -UpdateSource FileShares</code> изменить источник обновлений (MicrosoftUpdateServer – сервера обновлений MS в интернете, InternalDefinitionUpdateServer — внутренний WSUS сервер) <br> <code>Update-MpSignature</code> обновить сигнатуры<p><code>Start-MpScan -ScanType QuickScan</code> быстрая проверка или FullScan <br> <code>Start-MpScan -ScanType FullScan -AsJob</code> <br> <code>Set-MpPreference -RemediationScheduleDay 1-7</code> выбрать дни, начиная с воскресенья или 0 каждый день, 8 - сбросить <br> <code>Set-MpPreference -ScanScheduleQuickScanTime 14:00:00</code> <br> <code>Start-MpScan -ScanType CustomScan -ScanPath "C:\Program Files"</code> сканировать выбранную директорию<p><code>Get-MpThreat</code> история угроз и тип угрозы (ThreatName: HackTool/Trojan) <br> <code>Get-MpThreatCatalog</code> список известных видов угроз <br> <code>Get-MpThreatDetection</code> история защиты (активных и прошлые) и ID угрозы <br> <code>Get-MpThreat -ThreatID 2147760253</code><p><code>ls "C:\ProgramData\Microsoft\Windows Defender\Quarantine\"</code> директория хранения файлов в карантине <br> <code>cd "C:\Program Files\Windows Defender\"</code> <br> <code>.\MpCmdRun.exe -restore -name $ThreatName</code> восстановить файл из карантина <br> <code>.\MpCmdRun.exe -restore -filepath $path_file</code><h1 id=dism><a aria-label="Anchor link for: dism" class=zola-anchor href=#dism><i class=icon></i></a> DISM</h1><p><code>Get-Command -Module Dism -Name *Driver*</code> <br> <code>Export-WindowsDriver -Online -Destination C:\Users\Lifailon\Documents\Drivers\</code> извлечение драйверов из текущей системы (C:\Windows\System32\DriverStore\FileRepository), выгружает список файлов, которые необходимы для установки драйвера (dll,sys,exe) в соответствии со списком файлов, указанных в секции [CopyFiles] inf-файла драйвера. <br> <code>Export-WindowsDriver -Path C:\win_image -Destination C:\drivers</code> извлечь драйвера из офлайн образа Windows, смонтированного в каталог c:\win_image <br> <code>$BackupDrivers = Export-WindowsDriver -Online -Destination C:\Drivers</code> <br> <code>$BackupDrivers | ft Driver,ClassName,ProviderName,Date,Version,ClassDescription</code> список драйверов в объектном представлении <br> <code>$BackupDrivers | where classname -match printer</code> <br> <code>pnputil.exe /add-driver C:\drivers\*.inf /subdirs /install</code> установить все (параметр subdirs) драйвера из указанной папки (включая вложенные)<p><code>sfc /scannow</code> проверить целостность системных файлов с помощью утилиты SFC (System File Checker), в случае поиска ошибок, попробует восстановить их оригинальные копии из хранилища системных компонентов Windows (каталог C:\Windows\WinSxS). Вывод работы логируется в C:\Windows\Logs\CBS с тегом SR <br> <code>Get-ComputerInfo | select *</code> подробная информация о системе (WindowsVersion,WindowsEditionId,<em>Bios</em>) <br> <code>Get-WindowsImage -ImagePath E:\sources\install.wim</code> список доступных версий в образе <br> <code>Repair-WindowsImage -Online –ScanHealth</code> <br> <code>Repair-WindowsImage -Online -RestoreHealth</code> восстановление хранилища системных компонентов <br> <code>Repair-WindowsImage -Online -RestoreHealth -Source E:\sources\install.wim:3 –LimitAccess</code> восстановление в оффлайн режиме из образа по номеру индекса<h1 id=scheduled><a aria-label="Anchor link for: scheduled" class=zola-anchor href=#scheduled><i class=icon></i></a> Scheduled</h1><p><code>$Trigger = New-ScheduledTaskTrigger -At 01:00am -Daily</code> 1:00 ночи <br> <code>$Trigger = New-ScheduledTaskTrigger –AtLogon</code> запуск при входе пользователя в систему <br> <code>$Trigger = New-ScheduledTaskTrigger -AtStartup</code> при запуске системы <br> <code>$User = "NT AUTHORITY\SYSTEM"</code> <br> <code>$Action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "$home\Documents\DNS-Change-Tray-1.3.ps1"</code> <br> <code>$Action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "-NoProfile -NoLogo -NonInteractive -ExecutionPolicy Unrestricted -WindowStyle Hidden -File $home\Documents\DNS-Change-Tray-1.3.ps1"</code> <br> <code>Register-ScheduledTask -TaskName "DNS-Change-Tray-Startup" -Trigger $Trigger -User $User -Action $Action -RunLevel Highest –Force</code><p><code>Get-ScheduledTask | ? state -ne Disabled</code> список всех активных заданий <br> <code>Start-ScheduledTask DNS-Change-Tray-Startup</code> запустить задание немедленно <br> <code>Get-ScheduledTask DNS-Change-Tray-Startup | Disable-ScheduledTask</code> отключить задание <br> <code>Get-ScheduledTask DNS-Change-Tray-Startup | Enable-ScheduledTask</code> включить задание <br> <code>Unregister-ScheduledTask DNS-Change-Tray-Startup</code> удалить задание <br> <code>Export-ScheduledTask DNS-Change-Tray-Startup | Out-File $home\Desktop\Task-Export-Startup.xml</code> экспортировать задание в xml <br> <code>Register-ScheduledTask -Xml (Get-Content $home\Desktop\Task-Export-Startup.xml | Out-String) -TaskName "DNS-Change-Tray-Startup"</code><h1 id=shutdown><a aria-label="Anchor link for: shutdown" class=zola-anchor href=#shutdown><i class=icon></i></a> shutdown</h1><p><code>shutdown /r /o</code> перезагрузка в безопасный режим <br> <code>shutdown /s /t 600 /c "Power off after 10 minutes"</code> выключение <br> <code>shutdown /s /f</code> принудительное закрытие приложений <br> <code>shutdown /a</code> отмена <br> <code>shutdown /r /t 0 /m \\192.168.3.100</code> <br> <code>Restart-Computer -ComputerName 192.168.3.100 -Protocol WSMan</code> через WinRM <br> <code>Restart-Computer –ComputerName 192.168.3.100 –Force</code> через WMI <br> <code>Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\Start\HideShutDown" -Name "value" -Value 1</code> скрыть кнопку выключения <br> <code>Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\Start\HideRestart" -Name "value" -Value 1</code> скрыть кнопку перезагрузки<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-Shutdown</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-block z-powershell"><span class="z-punctuation z-definition z-comment z-block z-begin z-powershell"><#</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">SYNOPSIS</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    Module for shutdown and restart the computer at a specified time
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">DESCRIPTION</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    Example:
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    # Start-Shutdown -Time "18:00"
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    # Start-Shutdown -Restart -Time "18:00"
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    # Start-Shutdown -Cancel
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell"><span class="z-comment z-documentation z-embedded z-powershell">    <span class="z-constant z-string z-documentation z-powershell">.</span><span class="z-keyword z-operator z-documentation z-powershell">LINK</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    https://github.com/Lifailon/PS-Commands
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-block z-powershell">    <span class="z-punctuation z-definition z-comment z-block z-end z-powershell">#></span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Time</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Restart</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cancel</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Time</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>currentDateTime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Date</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>shutdownTime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Date</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Time</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>shutdownTime</span> <span class="z-keyword z-operator z-comparison z-powershell">-lt</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>currentDateTime</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>shutdownTime</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>shutdownTime<span class="z-variable z-other z-member z-powershell">.AddDays</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeUntilShutdown</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>shutdownTime</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>currentDateTime</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>secondsUntilShutdown</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">math</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Round<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeUntilShutdown<span class="z-variable z-other z-member z-powershell">.TotalSeconds</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cancel</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Start-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>shutdown.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/a<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Restart</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>The computer will restart after <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeUntilShutdown<span class="z-variable z-other z-member z-powershell">.Hours</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> hours and <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeUntilShutdown<span class="z-variable z-other z-member z-powershell">.Minutes</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> minutes.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Start-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>shutdown.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/r<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/f<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/t<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>secondsUntilShutdown</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>The computer will shutdown after <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeUntilShutdown<span class="z-variable z-other z-member z-powershell">.Hours</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> hours and <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeUntilShutdown<span class="z-variable z-other z-member z-powershell">.Minutes</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> minutes.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Start-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>shutdown.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/s<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/f<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>/t<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>secondsUntilShutdown</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h1 id=localaccounts><a aria-label="Anchor link for: localaccounts" class=zola-anchor href=#localaccounts><i class=icon></i></a> LocalAccounts</h1><p><code>Get-Command -Module Microsoft.PowerShell.LocalAccounts</code> <br> <code>Get-LocalUser</code> список пользователей <br> <code>Get-LocalGroup</code> список групп <br> <code>New-LocalUser "1C" -Password $Password -FullName "1C Domain"</code> создать пользователя <br> <code>Set-LocalUser -Password $Password 1C</code> изменить пароль <br> <code>Add-LocalGroupMember -Group "Administrators" -Member "1C"</code> добавить в группу Администраторов <br> <code>Get-LocalGroupMember "Administrators"</code> члены группы<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>vproxy-01<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>vproxy-02<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>vproxy-03<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">%</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    icm <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Add-LocalGroupMember</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Group <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Administrators<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Member <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>support4<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    icm <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-function z-powershell">Get-LocalGroupMember</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Administrators<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h1 id=ps2exe><a aria-label="Anchor link for: ps2exe" class=zola-anchor href=#ps2exe><i class=icon></i></a> PS2EXE</h1><p><code>Install-Module ps2exe -Repository PSGallery</code> <br> <code>Get-Module -ListAvailable</code> список всех модулей <br> <code>-noConsole</code> использовать GUI, без окна консоли powershell <br> <code>-noOutput</code> выполнение в фоне <br> <code>-noError</code> без вывода ошибок <br> <code>-requireAdmin</code> при запуске запросить права администратора <br> <code>-credentialGUI</code> вывод диалогового окна для ввода учетных данных <br> <code>Invoke-ps2exe -inputFile "$home\Desktop\WinEvent-Viewer-1.1.ps1" -outputFile "$home\Desktop\WEV-1.1.exe" -iconFile "$home\Desktop\log_48px.ico" -title "WinEvent-Viewer" -noConsole -noOutput -noError</code><h1 id=nssm><a aria-label="Anchor link for: nssm" class=zola-anchor href=#nssm><i class=icon></i></a> NSSM</h1><p><code>$powershell_Path = (Get-Command powershell).Source</code> <br> <code>$NSSM_Path = (Get-Command "C:\WinPerf-Agent\NSSM-2.24.exe").Source</code> <br> <code>$Script_Path = "C:\WinPerf-Agent\WinPerf-Agent-1.1.ps1"</code> <br> <code>$Service_Name = "WinPerf-Agent"</code> <br> <code>& $NSSM_Path install $Service_Name $powershell_Path -ExecutionPolicy Bypass -NoProfile -f $Script_Path</code> создать Service <br> <code>& $NSSM_Path start $Service_Name</code> запустить <br> <code>& $NSSM_Path status $Service_Name</code> статус <br> <code>$Service_Name | Restart-Service</code> перезапустить <br> <code>$Service_Name | Get-Service</code> статус <br> <code>$Service_Name | Stop-Service</code> остановить <br> <code>& $NSSM_Path set $Service_Name description "Check performance CPU and report email"</code> изменить описание <br> <code>& $NSSM_Path remove $Service_Name</code> удалить<h1 id=jobs><a aria-label="Anchor link for: jobs" class=zola-anchor href=#jobs><i class=icon></i></a> Jobs</h1><p><code>Get-Job</code> получение списка задач <br> <code>Start-Job</code> запуск процесса <br> <code>Stop-Job</code> остановка процесса <br> <code>Suspend-Job</code> приостановка работы процесса <br> <code>Resume-Job</code> восстановление работы процесса <br> <code>Wait-Job</code> ожидание вывода команды <br> <code>Receive-Job</code> получение результатов выполненного процесса <br> <code>Remove-Job</code> удалить задачу<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-PingJob</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d{1,3}$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>4</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>4</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создаем задания, забираем 3-ю строку вывода и добавляем к выводу ip-адрес<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Start-Job</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:ip</span> : <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:ip</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-Null</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-Job</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.State<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> забираем статус последнего задания (задания выполняются по очереди сверху вниз)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span> <span class="z-keyword z-operator z-comparison z-powershell">-like</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Completed<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> проверяем задание на выполнение<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping_out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Job</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Receive-Job</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> если выполнено, забираем вывод всех заданий<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-support z-function z-powershell">Get-Job</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Remove-Job</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> удаляем задания<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-keyword z-control z-powershell">break</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> завершаем цикл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping_out</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Start-PingJob -Network 192.168.3.0</code> <br> <code>$(Measure-Command {Start-PingJob -Network 192.168.3.0}).TotalSeconds</code> 60 Seconds<h3 id=threadjob><a aria-label="Anchor link for: threadjob" class=zola-anchor href=#threadjob><i class=icon></i></a> ThreadJob</h3><p><code>Install-Module -Name ThreadJob</code> <br> <code>Get-Module ThreadJob -list</code> <br> <code>Start-ThreadJob {ping ya.ru} | Out-Null</code> создать фоновую задачу <br> <code>Get-Job | Receive-Job -Keep</code> отобразить и не удалять вывод <br> <code>(Get-Job).HasMoreData</code> если False, то вывод команы удален <br> <code>(Get-Job)[-1].Output</code> отобразить вывод последней задачи<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-PingThreadJob</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d{1,3}$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>4</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>4</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Start-ThreadJob</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:ip</span> : <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:ip</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-Null</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-Job</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.State<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span> <span class="z-keyword z-operator z-comparison z-powershell">-like</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Completed<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping_out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Job</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Receive-Job</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-support z-function z-powershell">Get-Job</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Remove-Job</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-keyword z-control z-powershell">break</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping_out</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Start-PingThreadJob -Network 192.168.3.0</code> <br> <code>$(Measure-Command {Start-PingThread -Network 192.168.3.0}).TotalSeconds</code> 24 Seconds<h3 id=poshrsjob><a aria-label="Anchor link for: poshrsjob" class=zola-anchor href=#poshrsjob><i class=icon></i></a> PoshRSJob</h3><p>Install-Module -Name PoshRSJob<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-PingRSJob</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d{1,3}$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>4</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>4</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Start-RSJob</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:ip</span> : <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:ip</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-Null</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-RSJob</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.State <span class="z-keyword z-operator z-comparison z-powershell">-notcontains</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Running<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> проверяем, что массив не содержит активных заданий<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_job</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping_out</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-RSJob</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Receive-RSJob</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-support z-function z-powershell">Get-RSJob</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Remove-RSJob</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-keyword z-control z-powershell">break</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ping_out</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Start-PingRSJob -Network 192.168.3.0</code> <br> <code>$(Measure-Command {Start-PingRSJob -Network 192.168.3.0}).TotalSeconds</code> 10 Seconds<h3 id=invoke-parallel><a aria-label="Anchor link for: invoke-parallel" class=zola-anchor href=#invoke-parallel><i class=icon></i></a> Invoke-Parallel</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Import function from GitHub to current session<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>module</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://raw.githubusercontent.com/RamblingCookieMonster/Invoke-Parallel/master/Invoke-Parallel/Invoke-Parallel.ps1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-Expression</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>module</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></code></pre><p>Get-Help Invoke-Parallel -Full<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-PingInvokeParallel</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d{1,3}$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srvList</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Invoke-Parallel</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>InputObject <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>srvList</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ScriptBlock <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> : <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Start-PingInvokeParallel -Network 192.168.3.0</code> <br> <code>$(Get-History)[-1].Duration.TotalSeconds</code> 7 seconds<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_main</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">10</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-Parallel</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>InputObject <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_main<span class="z-variable z-other z-member z-powershell">.Count</span></span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ScriptBlock <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">100</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Milliseconds <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Progress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Activity <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_main</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PercentComplete <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>id <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ImportVariables
</span></code></pre><h3 id=foreach-object-parallel><a aria-label="Anchor link for: foreach-object-parallel" class=zola-anchor href=#foreach-object-parallel><i class=icon></i></a> ForEach-Object-Parallel</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-PingParallel</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d{1,3}$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Parallel <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:RNetwork</span>.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> : <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>ping <span class="z-keyword z-operator z-assignment z-powershell">-</span>n <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>w <span class="z-constant z-numeric z-integer z-powershell">50</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:RNetwork</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ThrottleLimit <span class="z-constant z-numeric z-integer z-powershell">254</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Start-PingParallel -Network 192.168.3.0</code> <br> <code>$(Get-History)[-1].Duration.TotalSeconds</code> 2 seconds<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Start-TestConnectParallel</span></span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">switch</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Csv</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>RNetwork</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Network</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\.\d{1,3}$<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>csv</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Address,Status,Latency<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">254</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Parallel <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Test-Connection</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:RNetwork</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Count <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>TimeoutSeconds <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:csv</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:RNetwork</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span>,<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test<span class="z-variable z-other z-member z-powershell">.Status</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>,<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test<span class="z-variable z-other z-member z-powershell">.Latency</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>test</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ThrottleLimit <span class="z-constant z-numeric z-integer z-powershell">254</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Start-TestConnectParallel -Network 192.168.3.0 -Csv | ConvertFrom-Csv</code> <br> <code>$(Get-History)[-1].Duration.TotalSeconds</code> 3 seconds<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_main</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">10</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_main<span class="z-variable z-other z-member z-powershell">.Count</span></span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Parallel <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">100</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Milliseconds <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_temp</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-storage z-modifier z-scope z-powershell">using</span>:array_main</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Write-Progress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Activity <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_temp</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PercentComplete <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>n</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>id <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ThrottleLimit <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>array_main<span class="z-variable z-other z-member z-powershell">.Count</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></code></pre><h1 id=com><a aria-label="Anchor link for: com" class=zola-anchor href=#com><i class=icon></i></a> COM</h1><p><code>$wshell = New-Object -ComObject Wscript.Shell</code> <br> <code>$wshell | Get-Member</code> <br> <code>$link = $wshell.CreateShortcut("$Home\Desktop\Yandex.lnk")</code> создать ярлык <br> <code>$link | Get-Member</code> <br> <code>$link.TargetPath = "https://yandex.ru"</code> куда ссылается (метод TargetPath объекта $link где хранится объект CreateShortcut) <br> <code>$link.Save()</code> сохранить<p><code>Set-WinUserLanguageList -LanguageList en-us,ru -Force</code> изменить языковую раскладку клавиатуры<h3 id=wscript-shell-sendkeys><a aria-label="Anchor link for: wscript-shell-sendkeys" class=zola-anchor href=#wscript-shell-sendkeys><i class=icon></i></a> Wscript Shell SendKeys</h3><p><code>(New-Object -ComObject Wscript.shell).SendKeys([char]173)</code> включить/выключить звук <br> <code>$wshell.Exec("notepad.exe")</code> запустить приложение <br> <code>$wshell.AppActivate("Блокнот")</code> развернуть запущенное приложение<p><code>$wshell.SendKeys("Login")</code> текст <br> <code>$wshell.SendKeys("{A 5}")</code> напечатать букву 5 раз подряд <br> <code>$wshell.SendKeys("%{TAB}")</code> ALT+TAB <br> <code>$wshell.SendKeys("^")</code> CTRL <br> <code>$wshell.SendKeys("%")</code> ALT <br> <code>$wshell.SendKeys("+")</code> SHIFT <br> <code>$wshell.SendKeys("{DOWN}")</code> вниз <br> <code>$wshell.SendKeys("{UP}")</code> вверх <br> <code>$wshell.SendKeys("{LEFT}")</code> влево <br> <code>$wshell.SendKeys("{RIGHT}")</code> вправо <br> <code>$wshell.SendKeys("{PGUP}")</code> PAGE UP <br> <code>$wshell.SendKeys("{PGDN}")</code> PAGE DOWN <br> <code>$wshell.SendKeys("{BACKSPACE}")</code> BACKSPACE/BKSP/BS <br> <code>$wshell.SendKeys("{DEL}")</code> DEL/DELETE <br> <code>$wshell.SendKeys("{INS}")</code> INS/INSERT <br> <code>$wshell.SendKeys("{PRTSC}")</code> PRINT SCREEN <br> <code>$wshell.SendKeys("{ENTER}")</code> <br> <code>$wshell.SendKeys("{ESC}")</code> <br> <code>$wshell.SendKeys("{TAB}")</code> <br> <code>$wshell.SendKeys("{END}")</code> <br> <code>$wshell.SendKeys("{HOME}")</code> <br> <code>$wshell.SendKeys("{BREAK}")</code> <br> <code>$wshell.SendKeys("{SCROLLLOCK}")</code> <br> <code>$wshell.SendKeys("{CAPSLOCK}")</code> <br> <code>$wshell.SendKeys("{NUMLOCK}")</code> <br> <code>$wshell.SendKeys("{F1}")</code> <br> <code>$wshell.SendKeys("{F12}")</code> <br> <code>$wshell.SendKeys("{+}{^}{%}{~}{(}{)}{[}{]}{{}{}}")</code><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-AltTab</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject wscript.shell</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.SendKeys<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>%{Tab}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-Random</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Minimum <span class="z-constant z-numeric z-integer z-powershell">30</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Maximum <span class="z-constant z-numeric z-integer z-powershell">180</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Get-AltTab</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Get-AltTab</code><h3 id=wscript-shell-popup><a aria-label="Anchor link for: wscript-shell-popup" class=zola-anchor href=#wscript-shell-popup><i class=icon></i></a> Wscript Shell Popup</h3><p><code>$wshell = New-Object -ComObject Wscript.Shell</code> <br> <code>$output = $wshell.Popup("Выберите действие?",0,"Заголовок",4)</code> <br> <code>if ($output -eq 6) {"yes"} elseif ($output -eq 7) {"no"} else {"no good"}</code><pre class=z-code><code><span class="z-text z-plain">Type:
</span><span class="z-text z-plain">0 ОК
</span><span class="z-text z-plain">1 ОК и Отмена
</span><span class="z-text z-plain">2 Стоп, Повтор, Пропустить
</span><span class="z-text z-plain">3 Да, Нет, Отмена
</span><span class="z-text z-plain">4 Да и Нет
</span><span class="z-text z-plain">5 Повтор и Отмена
</span><span class="z-text z-plain">16 Stop
</span><span class="z-text z-plain">32 Question
</span><span class="z-text z-plain">48 Exclamation
</span><span class="z-text z-plain">64 Information
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Output:
</span><span class="z-text z-plain">-1 Timeout
</span><span class="z-text z-plain">1 ОК
</span><span class="z-text z-plain">2 Отмена
</span><span class="z-text z-plain">3 Стоп
</span><span class="z-text z-plain">4 Повтор
</span><span class="z-text z-plain">5 Пропустить
</span><span class="z-text z-plain">6 Да
</span><span class="z-text z-plain">7 Нет
</span></code></pre><h3 id=wscript-network><a aria-label="Anchor link for: wscript-network" class=zola-anchor href=#wscript-network><i class=icon></i></a> WScript Network</h3><p><code>$wshell = New-Object -ComObject WScript.Network</code> <br> <code>$wshell | Get-Member</code> <br> <code>$wshell.UserName</code> <br> <code>$wshell.ComputerName</code> <br> <code>$wshell.UserDomain</code><h3 id=shell-application><a aria-label="Anchor link for: shell-application" class=zola-anchor href=#shell-application><i class=icon></i></a> Shell Application</h3><p><code>$wshell = New-Object -ComObject Shell.Application</code> <br> <code>$wshell | Get-Member</code> <br> <code>$wshell.Explore("C:\")</code> <br> <code>$wshell.Windows() | Get-Member</code> получить доступ к открытым в проводнике или браузере Internet Explorer окон<p><code>$shell = New-Object -Com Shell.Application</code> <br> <code>$RecycleBin = $shell.Namespace(10)</code> <br> <code>$RecycleBin.Items()</code><h3 id=outlook><a aria-label="Anchor link for: outlook" class=zola-anchor href=#outlook><i class=icon></i></a> Outlook</h3><p><code>$Outlook = New-Object -ComObject Outlook.Application</code> <br> <code>$Outlook | Get-Member</code> <br> <code>$Outlook.Version</code><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Outlook</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject Outlook.Application
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Namespace</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Outlook<span class="z-variable z-other z-member z-powershell">.GetNamespace</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>MAPI<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Folder</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>namespace<span class="z-variable z-other z-member z-powershell">.GetDefaultFolder</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> исходящие
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Folder</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>namespace<span class="z-variable z-other z-member z-powershell">.GetDefaultFolder</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">6</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> входящие
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Explorer</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Folder<span class="z-variable z-other z-member z-powershell">.GetExplorer</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Explorer<span class="z-variable z-other z-member z-powershell">.Display</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>	
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Outlook<span class="z-variable z-other z-member z-powershell">.Quit</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=microsoft-update><a aria-label="Anchor link for: microsoft-update" class=zola-anchor href=#microsoft-update><i class=icon></i></a> Microsoft Update</h3><p><code>(New-Object -com 'Microsoft.Update.AutoUpdate').Settings</code> <br> <code>(New-Object -com 'Microsoft.Update.AutoUpdate').Results</code> <br> <code>(New-Timespan -Start ((New-Object -com 'Microsoft.Update.AutoUpdate').Results|Select -ExpandProperty LastInstallationSuccessDate) -End (Get-Date)).hours</code> кол-во часов, прошедших с последней даты установки обновления безопасности в Windows.<h1 id=dotnet><a aria-label="Anchor link for: dotnet" class=zola-anchor href=#dotnet><i class=icon></i></a> dotNET</h1><p><code>[System.Diagnostics.EventLog] | select Assembly,Module</code> <br> <code>$EventLog = [System.Diagnostics.EventLog]::new("Application")</code> <br> <code>$EventLog = New-Object -TypeName System.Diagnostics.EventLog -ArgumentList Application,192.168.3.100</code> <br> <code>$EventLog | Get-Member -MemberType Method</code> <br> <code>$EventLog.MaximumKilobytes</code> максимальный размер журнала <br> <code>$EventLog.Entries</code> просмотреть журнал <br> <code>$EventLog.Clear()</code> очистить журнал<p><code>Join-Path C: Install Test</code> <br> <code>[System.IO.Path]::Combine("C:", "Install", "Test")</code><h3 id=match><a aria-label="Anchor link for: match" class=zola-anchor href=#match><i class=icon></i></a> Match</h3><p><code>[System.Math] | Get-Member -Static -MemberType Methods</code> <br> <code>[System.Math]::Max(2,7)</code> <br> <code>[System.Math]::Min(2,7)</code> <br> <code>[System.Math]::Floor(3.9)</code> <br> <code>[System.Math]::Truncate(3.9)</code><h3 id=generate-password><a aria-label="Anchor link for: generate-password" class=zola-anchor href=#generate-password><i class=icon></i></a> Generate Password</h3><p><code>Add-Type -AssemblyName System.Web</code> <br> <code>[System.Web.Security.Membership]::GeneratePassword(10,2)</code><h3 id=sound-player><a aria-label="Anchor link for: sound-player" class=zola-anchor href=#sound-player><i class=icon></i></a> Sound Player</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CriticalSound</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Media.SoundPlayer
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CriticalSound<span class="z-variable z-other z-member z-powershell">.SoundLocation</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\WINDOWS\Media\Windows Critical Stop.wav<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CriticalSound<span class="z-variable z-other z-member z-powershell">.Play</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>GoodSound</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Media.SoundPlayer
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>GoodSound<span class="z-variable z-other z-member z-powershell">.SoundLocation</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\WINDOWS\Media\tada.wav<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>GoodSound<span class="z-variable z-other z-member z-powershell">.Play</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=static-class><a aria-label="Anchor link for: static-class" class=zola-anchor href=#static-class><i class=icon></i></a> Static Class</h3><p><code>[System.Environment] | Get-Member -Static</code> <br> <code>[System.Environment]::OSVersion</code> <br> <code>[System.Environment]::Version</code> <br> <code>[System.Environment]::MachineName</code> <br> <code>[System.Environment]::UserName</code><p><code>[System.Diagnostics.Process] | Get-Member -Static</code> <br> <code>[System.Diagnostics.Process]::Start('notepad.exe')</code><h3 id=clicker><a aria-label="Anchor link for: clicker" class=zola-anchor href=#clicker><i class=icon></i></a> Clicker</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>cSource</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-heredoc z-powershell">@'
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">using System;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">using System.Drawing;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">using System.Runtime.InteropServices;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">using System.Windows.Forms;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">public class Clicker
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646270(v=vs.85).aspx
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">[StructLayout(LayoutKind.Sequential)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">struct INPUT
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">{ 
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int        type; // 0 = INPUT_MOUSE,
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">                            // 1 = INPUT_KEYBOARD
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">                            // 2 = INPUT_HARDWARE
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public MOUSEINPUT mi;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646273(v=vs.85).aspx
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">[StructLayout(LayoutKind.Sequential)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">struct MOUSEINPUT
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    dx ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    dy ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    mouseData ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    dwFlags;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public int    time;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    public IntPtr dwExtraInfo;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//This covers most use cases although complex mice may have additional buttons
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//There are additional constants you can use for those cases, see the msdn page
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_MOVED      = 0x0001 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_LEFTDOWN   = 0x0002 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_LEFTUP     = 0x0004 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_RIGHTDOWN  = 0x0008 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_RIGHTUP    = 0x0010 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_MIDDLEDOWN = 0x0020 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_MIDDLEUP   = 0x0040 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_WHEEL      = 0x0080 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_XDOWN      = 0x0100 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_XUP        = 0x0200 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int MOUSEEVENTF_ABSOLUTE   = 0x8000 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">const int screen_length          = 0x10000 ;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646310(v=vs.85).aspx
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">[System.Runtime.InteropServices.DllImport("user32.dll")]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">extern static uint SendInput(uint nInputs, INPUT[] pInputs, int cbSize);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">public static void LeftClickAtPoint(int x, int y)
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    //Move the mouse
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    INPUT[] input = new INPUT[3];
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[0].mi.dx = x*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[0].mi.dy = y*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[0].mi.dwFlags = MOUSEEVENTF_MOVED | MOUSEEVENTF_ABSOLUTE;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    //Left mouse button down
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[1].mi.dwFlags = MOUSEEVENTF_LEFTDOWN;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    //Left mouse button up
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    input[2].mi.dwFlags = MOUSEEVENTF_LEFTUP;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">    SendInput(3, input, Marshal.SizeOf(input[0]));
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">'@</span>
</span></code></pre><p><code>Add-Type -TypeDefinition $cSource -ReferencedAssemblies System.Windows.Forms,System.Drawing</code> <br> <code>[Clicker]::LeftClickAtPoint(1900,1070)</code><h3 id=audio><a aria-label="Anchor link for: audio" class=zola-anchor href=#audio><i class=icon></i></a> Audio</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Language CsharpVersion3 <span class="z-keyword z-operator z-assignment z-powershell">-</span>TypeDefinition <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">using System.Runtime.InteropServices;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[Guid("5CDF2C82-841E-4546-9722-0CF74078229A"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">interface IAudioEndpointVolume {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">// f(), g(), ... are unused COM method slots. Define these if you care
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int f(); int g(); int h(); int i();
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int SetMasterVolumeLevelScalar(float fLevel, System.Guid pguidEventContext);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int j();
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int GetMasterVolumeLevelScalar(out float pfLevel);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int k(); int l(); int m(); int n();
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int SetMute([MarshalAs(UnmanagedType.Bool)] bool bMute, System.Guid pguidEventContext);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int GetMute(out bool pbMute);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[Guid("D666063F-1587-4E43-81F1-B948E807363F"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">interface IMMDevice {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int Activate(ref System.Guid id, int clsCtx, int activationParams, out IAudioEndpointVolume aev);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[Guid("A95664D2-9614-4F35-A746-DE8DB63617E6"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">interface IMMDeviceEnumerator {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int f(); // Unused
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">int GetDefaultAudioEndpoint(int dataFlow, int role, out IMMDevice endpoint);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[ComImport, Guid("BCDE0395-E52F-467C-8E3D-C4579291692E")] class MMDeviceEnumeratorComObject { }
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public class Audio {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">static IAudioEndpointVolume Vol() {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">var enumerator = new MMDeviceEnumeratorComObject() as IMMDeviceEnumerator;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">IMMDevice dev = null;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">Marshal.ThrowExceptionForHR(enumerator.GetDefaultAudioEndpoint(/*eRender*/ 0, /*eMultimedia*/ 1, out dev));
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">IAudioEndpointVolume epv = null;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">var epvid = typeof(IAudioEndpointVolume).GUID;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">Marshal.ThrowExceptionForHR(dev.Activate(ref epvid, /*CLSCTX_ALL*/ 23, 0, out epv));
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">return epv;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public static float Volume {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">get {float v = -1; Marshal.ThrowExceptionForHR(Vol().GetMasterVolumeLevelScalar(out v)); return v;}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">set {Marshal.ThrowExceptionForHR(Vol().SetMasterVolumeLevelScalar(value, System.Guid.Empty));}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public static bool Mute {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">get { bool mute; Marshal.ThrowExceptionForHR(Vol().GetMute(out mute)); return mute; }
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">set { Marshal.ThrowExceptionForHR(Vol().SetMute(value, System.Guid.Empty)); }
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span></code></pre><p><code>[Audio]::Volume = 0.50</code> <br> <code>[Audio]::Mute = $true</code><h3 id=netsessionenum><a aria-label="Anchor link for: netsessionenum" class=zola-anchor href=#netsessionenum><i class=icon></i></a> NetSessionEnum</h3><p><a href="https://learn.microsoft.com/ru-ru/windows/win32/api/lmshare/nf-lmshare-netsessionenum?redirectedfrom=MSDN">Function</a> <br> <a href=https://fuzzysecurity.com/tutorials/24.html>Source</a><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Invoke-NetSessionEnum</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HostName</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>TypeDefinition <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">using System;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">using System.Diagnostics;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">using System.Runtime.InteropServices;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[StructLayout(LayoutKind.Sequential)]
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public struct SESSION_INFO_10
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">{
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    [MarshalAs(UnmanagedType.LPWStr)]public string OriginatingHost;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    [MarshalAs(UnmanagedType.LPWStr)]public string DomainUser;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    public uint SessionTime;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    public uint IdleTime;
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public static class Netapi32
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">{
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[DllImport("Netapi32.dll", SetLastError=true)]
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    public static extern int NetSessionEnum(
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        [In,MarshalAs(UnmanagedType.LPWStr)] string ServerName,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        [In,MarshalAs(UnmanagedType.LPWStr)] string UncClientName,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        [In,MarshalAs(UnmanagedType.LPWStr)] string UserName,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        Int32 Level,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        out IntPtr bufptr,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        int prefmaxlen,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        ref Int32 entriesread,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        ref Int32 totalentries,
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        ref Int32 resume_handle);
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">         
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[DllImport("Netapi32.dll", SetLastError=true)]
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    public static extern int NetApiBufferFree(
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">        IntPtr Buffer);
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Create SessionInfo10 Struct<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> SESSION_INFO_10
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10StructSize</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Runtime.InteropServices.Marshal</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::SizeOf<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Grab size to loop bufptr
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10<span class="z-variable z-other z-member z-powershell">.GetType</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Hacky<span class="z-keyword z-operator z-other z-powershell">,</span> but we need this <span class="z-punctuation z-terminator z-statement z-powershell">;</span>))
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> NetSessionEnum params<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">IntPtr</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Zero<span class="z-keyword z-operator z-other z-powershell">`</span> Struct output buffer
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EntriesRead</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TotalEntries</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ResumeHandle</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">`</span> Counters <span class="z-keyword z-operator z-other z-powershell">&</span> ResumeHandle
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CallResult</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Netapi32</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::NetSessionEnum<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HostName</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">10</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EntriesRead</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TotalEntries</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ref</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ResumeHandle</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CallResult</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-numeric z-integer z-powershell">0</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Mmm something went wrong!<span class="z-constant z-character z-escape z-powershell">`n</span>Error Code: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CallResult</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.IntPtr</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Size <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-constant z-character z-escape z-powershell">`n</span>Netapi32::NetSessionEnum Buffer Offset  --> 0x<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0:X8}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr<span class="z-variable z-other z-member z-powershell">.ToInt32</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-constant z-character z-escape z-powershell">`n</span>Netapi32::NetSessionEnum Buffer Offset  --> 0x<span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0:X16}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr<span class="z-variable z-other z-member z-powershell">.ToInt64</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Result-set contains <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EntriesRead</span> session(s)!<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Change buffer offset to int<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BufferOffset</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr<span class="z-variable z-other z-member z-powershell">.ToInt64</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Loop buffer entries and cast pointers as SessionInfo10<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">for</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Count</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Count</span> <span class="z-keyword z-operator z-comparison z-powershell">-lt</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>EntriesRead</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Count</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-keyword z-operator z-assignment z-powershell">+</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NewIntPtr</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Intptr <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BufferOffset</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Info</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">system.runtime.interopservices.marshal</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::PtrToStructure<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NewIntPtr</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">type</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Info</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BufferOffset</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BufferOffset</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>SessionInfo10StructSize</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">echo <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-constant z-character z-escape z-powershell">`n</span>Calling NetApiBufferFree, no memleaks here!<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Netapi32</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::NetApiBufferFree<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OutBuffPtr</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span><span class="z-support z-function z-powershell">Out-Null</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>Invoke-NetSessionEnum localhost</code><h3 id=copyfile><a aria-label="Anchor link for: copyfile" class=zola-anchor href=#copyfile><i class=icon></i></a> CopyFile</h3><p><a href=https://learn.microsoft.com/ru-ru/windows/win32/api/winbase/nf-winbase-copyfile>Function</a> <br> <a href=https://devblogs.microsoft.com/scripting/use-powershell-to-interact-with-the-windows-api-part-1/>Source</a><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MethodDefinition</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[DllImport("kernel32.dll", CharSet = CharSet.Unicode)]
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public static extern bool CopyFile(string lpExistingFileName, string lpNewFileName, bool bFailIfExists);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Kernel32</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>MemberDefinition <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>MethodDefinition</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Kernel32<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Namespace <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Win32<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>PassThru
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Kernel32</span>::CopyFile<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">Env:</span>SystemRoot</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\System32\calc.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">Env:</span>USERPROFILE</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>\Desktop\calc.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>False</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> 
</span></code></pre><h3 id=showwindowasync><a aria-label="Anchor link for: showwindowasync" class=zola-anchor href=#showwindowasync><i class=icon></i></a> ShowWindowAsync</h3><p><a href=https://learn.microsoft.com/ru-ru/windows/win32/api/winuser/nf-winuser-showwindowasync>Function</a><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Signature</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">[DllImport("user32.dll")]public static extern bool ShowWindowAsync(IntPtr hWnd, int nCmdShow);
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>MemberDefinition <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Signature</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Win32ShowWindowAsync<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Namespace Win32Functions <span class="z-keyword z-operator z-assignment z-powershell">-</span>PassThru
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Get-Member</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-storage z-modifier z-powershell">Static</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span>::ShowWindowAsync<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Id <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pid</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.MainWindowHandle<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span>::ShowWindowAsync<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Id <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Pid</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.MainWindowHandle<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShowWindowAsync</span>::ShowWindowAsync<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Id <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Pid</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.MainWindowHandle<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=getasynckeystate><a aria-label="Anchor link for: getasynckeystate" class=zola-anchor href=#getasynckeystate><i class=icon></i></a> GetAsyncKeyState</h3><p><a href=https://learn.microsoft.com/ru-ru/windows/win32/api/winuser/nf-winuser-getasynckeystate>Function</a><p><code>Add-Type -AssemblyName System.Windows.Forms</code> <br> <code>[int][System.Windows.Forms.Keys]::F1</code> определить номер [Int] клавиши по ее названию <br> <code>65..90 | % {"{0} = {1}" -f $_, [System.Windows.Forms.Keys]$_}</code> порядковый номер букв (A..Z)<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-ControlKey</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">112</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Signature</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-heredoc z-powershell">@'
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">[DllImport("user32.dll", CharSet=CharSet.Auto, ExactSpelling=true)] 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">public static extern short GetAsyncKeyState(int virtualKeyCode); 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-single z-heredoc z-powershell">'@</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>MemberDefinition <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Signature</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Name Keyboard <span class="z-keyword z-operator z-assignment z-powershell">-</span>Namespace PsOneApi
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">bool</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PsOneApi.Keyboard</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::GetAsyncKeyState<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">-32767</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Warning</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Press F1 to exit<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoNewline
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-ControlKey</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-keyword z-control z-powershell">break</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Seconds <span class="z-constant z-numeric z-integer z-powershell">0.5</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h1 id=console-api><a aria-label="Anchor link for: console-api" class=zola-anchor href=#console-api><i class=icon></i></a> Console API</h1><p><a href=https://powershell.one/tricks/input-devices/detect-key-press>Source</a><p><code>[Console] | Get-Member -Static</code> <br> <code>[Console]::BackgroundColor = "Blue"</code> <br> <code>[Console]::OutputEncoding</code> используемая кодировка в текущей сессии <br> <code>[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding("utf-8")</code> изменить кодировку для отображения кириллицы <br> <code>[Console]::outputEncoding = [System.Text.Encoding]::GetEncoding("cp866")</code> для ISE <br> <code>[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding("windows-1251")</code> для ps2exe <br> <code>Get-Service | Out-File $home\Desktop\Service.txt -Encoding oem</code> > <br> <code>Get-Service | Out-File $home\Desktop\Service.txt -Append</code> >><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">do</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::KeyAvailable</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyInfo</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ReadKey<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">break</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoNewline
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Host</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>keyInfo</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-KeyPress</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">ConsoleKey</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Key</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.ConsoleModifiers</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ModifierKey</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::KeyAvailable</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressedKey</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ReadKey<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>isPressedKey</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressedKey<span class="z-variable z-other z-member z-powershell">.Key</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>isPressedKey</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressedKey<span class="z-variable z-other z-member z-powershell">.Modifiers</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ModifierKey</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Console</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Beep<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1800</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">200</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Warning</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Press Ctrl+Shift+Q to exit<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">do</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Write-Host</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoNewline
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressed</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-KeyPress</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Key Q <span class="z-keyword z-operator z-assignment z-powershell">-</span>ModifierKey <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Control,Shift<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>pressed</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-keyword z-control z-powershell">break</span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Start-Sleep</span> <span class="z-constant z-numeric z-integer z-powershell">1</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">while</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h1 id=drawing><a aria-label="Anchor link for: drawing" class=zola-anchor href=#drawing><i class=icon></i></a> Drawing</h1><p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.drawing?view=net-7.0&redirectedfrom=MSDN">API</a><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>AssemblyName System.Drawing
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Width</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">800</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Height</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">400</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Drawing.Bitmap<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Width</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Height</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>graphic</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Graphics</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromImage<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>background_color</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Brushes</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Blue <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать цвет фона (синий)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>graphic<span class="z-variable z-other z-member z-powershell">.FillRectangle</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>background_color</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image<span class="z-variable z-other z-member z-powershell">.Width</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image<span class="z-variable z-other z-member z-powershell">.Height</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text_color</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Brushes</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::White <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать цвет текста (белый)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>font</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Drawing.Font<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Arial<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.FontStyle</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bold</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать шрифт<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>PowerShell<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> указать текст<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text_position</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Drawing.RectangleF<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">320</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">180</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">300</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-constant z-numeric z-integer z-powershell">100</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>  <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> задать положение текста (x, y, width, height)<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>graphic<span class="z-variable z-other z-member z-powershell">.DrawString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>font</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text_color</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text_position</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> нанести текст на изображение<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\powershell_image.bmp<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Imaging.ImageFormat</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bmp</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> сохранить изображение<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>image<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> освобождение ресурсов<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><p><code>$path = "$home\desktop\powershell_image.bmp"</code> <br> <code>Invoke-Item $path</code><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>src_image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Image</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromFile<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Width</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">400</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Height</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">200</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dst_image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Drawing.Bitmap <span class="z-keyword z-operator z-assignment z-powershell">-</span>ArgumentList <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>src_image</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Width</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Height</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> изменить размер изображения<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>dst_image<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\powershell_image_resize.bmp<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Imaging.ImageFormat</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bmp</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rotated_image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>src_image<span class="z-variable z-other z-member z-powershell">.Clone</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> создать копию исходного изображения<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rotated_image<span class="z-variable z-other z-member z-powershell">.RotateFlip</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.RotateFlipType</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Rotate180FlipNone</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> перевернуть изображение на 180 градусов<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>rotated_image<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\powershell_image_rotated.bmp<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Imaging.ImageFormat</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Bmp</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>src_image<span class="z-variable z-other z-member z-powershell">.Dispose</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> закрыть (отпустить) исходный файл<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h1 id=objectevent><a aria-label="Anchor link for: objectevent" class=zola-anchor href=#objectevent><i class=icon></i></a> ObjectEvent</h1><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timer</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Timers.Timer
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timer<span class="z-variable z-other z-member z-powershell">.Interval</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">1000</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Register-ObjectEvent</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>InputObject <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timer</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>EventName Elapsed <span class="z-keyword z-operator z-assignment z-powershell">-</span>SourceIdentifier Timer.Output <span class="z-keyword z-operator z-assignment z-powershell">-</span>Action <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Random</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Random</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Min <span class="z-constant z-numeric z-integer z-powershell">0</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Max <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Write-Host</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Random</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Timer<span class="z-variable z-other z-member z-powershell">.Enabled</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>True</span>
</span></code></pre><p><code>$Timer.Enabled = $False</code> остановить <br> <code>$Timer | Get-Member -MemberType Event</code> отобразить список всех событий объекта <br> <code>Get-EventSubscriber</code> список зарегистрированных подписок на события в текущей сессии <br> <code>Unregister-Event -SourceIdentifier Timer.Output</code> удаляет регистрацию подписки на событие по имени события (EventName) или все * <br> <code>-Forward</code> перенаправляет события из удаленного сеанса (New-PSSession) в локальный сеанс <br> <code>-SupportEvent</code> не выводит результат регистрации события на экран (и Get-EventSubscriber и Get-Job)<pre class=z-code><code><span class="z-text z-plain">Register-EngineEvent -SourceIdentifier PowerShell.Exiting -Action {
</span><span class="z-text z-plain">$date = Get-Date -f hh:mm:ss
</span><span class="z-text z-plain">(New-Object -ComObject Wscript.Shell).Popup("PowerShell Exit: $date",0,"Action",64)
</span><span class="z-text z-plain">}
</span></code></pre><h1 id=base64><a aria-label="Anchor link for: base64" class=zola-anchor href=#base64><i class=icon></i></a> Base64</h1><h3 id=utf8><a aria-label="Anchor link for: utf8" class=zola-anchor href=#utf8><i class=icon></i></a> UTF8</h3><p><code>$loginPassword = "login:password"</code> <br> <code>$Base64 = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($loginPassword))</code> закодировать логин и пароль в строку Base64 <br> <code>[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($Base64))</code> преобразовать в байты и обратно декодировать в исходную строку с помощью UTF-8 кодировки<h3 id=unicode><a aria-label="Anchor link for: unicode" class=zola-anchor href=#unicode><i class=icon></i></a> Unicode</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>password<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>byte</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Unicode.GetBytes<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>text</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> преобразует строку $text в последовательность байтов, используя кодировку Unicode<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>base64</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Convert</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ToBase64String<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>byte</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> байты конвертируются в строку Base64 с помощью метода ToBase64String<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>decode_base64</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Convert</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromBase64String<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>base64</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> декодировать строку Base64 обратно в последовательность байтов с помощью метода FromBase64String<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>decode_string</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Unicode.GetString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>decode_base64</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> закодированные байты преобразуются обратно в строку с использованием кодировки Unicode с помощью метода GetString<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h3 id=image><a aria-label="Anchor link for: image" class=zola-anchor href=#image><i class=icon></i></a> Image</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\1200x800.jpg<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BBase64</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Convert</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ToBase64String<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Content</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_image</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Encoding Byte</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>assembly System.Drawing
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Image</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Drawing.Bitmap</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromStream<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">IO.MemoryStream</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Convert</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::FromBase64String<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>BBase64</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Image<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Desktop\1200x800.jpg<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h1 id=excel><a aria-label="Anchor link for: excel" class=zola-anchor href=#excel><i class=icon></i></a> Excel</h1><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Desktop\Services-to-Excel.xlsx<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject Excel.Application
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel<span class="z-variable z-other z-member z-powershell">.Visible</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span><span class="z-keyword z-operator z-other z-powershell">`</span> отключить открытие GUI
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel<span class="z-variable z-other z-member z-powershell">.Workbooks.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Создать книгу
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook<span class="z-variable z-other z-member z-powershell">.Worksheets.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Создать лист
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Name</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Services<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> задать имя листа
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Cells.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Name service<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Задать имена столбцов:<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Cells.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Description<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Cells.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Status<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Cells.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Startup type<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Rows.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Font.Bold <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-keyword z-operator z-other z-powershell">`</span> выделить жирным шрифтом
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Rows.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Font.size<span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">14</span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Задать ширину колонок:<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ColumnWidth<span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">30</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ColumnWidth<span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">80</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ColumnWidth<span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">15</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ColumnWidth<span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-constant z-numeric z-integer z-powershell">25</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>services</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span>  <span class="z-support z-function z-powershell">Get-Service</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-keyword z-operator z-other z-powershell">`</span> задать начальный номер строки для записи
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>service</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>services</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>service<span class="z-variable z-other z-member z-powershell">.Status</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Stopped<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Running<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Start</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>service<span class="z-variable z-other z-member z-powershell">.StartType</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Start</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>start_type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Delayed start<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Start</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>start_type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Automatic<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Start</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>start_type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Manually<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Start</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>start_type</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Disabled<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Rows.Item<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>service<span class="z-variable z-other z-member z-powershell">.Name</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Rows.Item<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>service<span class="z-variable z-other z-member z-powershell">.DisplayName</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Rows.Item<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_type</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">4</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Rows.Item<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>start_type</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status_type</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Running<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Columns.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">3</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Rows.Item<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Font.Bold <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> +1 увеличить для счетчика строки Rows<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>counter</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-keyword z-operator z-assignment z-powershell">+</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook<span class="z-variable z-other z-member z-powershell">.SaveAs</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook<span class="z-variable z-other z-member z-powershell">.close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel<span class="z-variable z-other z-member z-powershell">.Quit</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=excel-application-open><a aria-label="Anchor link for: excel-application-open" class=zola-anchor href=#excel-application-open><i class=icon></i></a> Excel Application Open</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Desktop\Services-to-Excel.xlsx<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject Excel.Application
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel<span class="z-variable z-other z-member z-powershell">.Visible</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>false</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>excel<span class="z-variable z-other z-member z-powershell">.Workbooks.Open</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> открыть xlsx<span class="z-keyword z-operator z-assignment z-powershell">-</span>файл
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook<span class="z-variable z-other z-member z-powershell">.Sheets</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> select Name<span class="z-keyword z-operator z-other z-powershell">,</span>Index<span class="z-keyword z-operator z-other z-powershell">`</span> отобразить листы
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkBook<span class="z-variable z-other z-member z-powershell">.Sheets.Item</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> открыть лист по номеру Index
</span><span class="z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-range z-powershell">..</span><span class="z-constant z-numeric z-integer z-powershell">100</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">%</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ExcelWorkSheet<span class="z-variable z-other z-member z-powershell">.Range</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>A<span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Text<span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> прочитать значение из столбца А строки c <span class="z-constant z-numeric z-integer z-powershell">1</span> по <span class="z-constant z-numeric z-integer z-powershell">100</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Excel<span class="z-variable z-other z-member z-powershell">.Quit</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=importexcel><a aria-label="Anchor link for: importexcel" class=zola-anchor href=#importexcel><i class=icon></i></a> ImportExcel</h3><p><code>Install-Module -Name ImportExcel</code> <br> <code>$data | Export-Excel .\Data.xlsx</code> <br> <code>$data = Import-Excel .\Data.xlsx</code><p><code>$data = ps</code> <br> <code>$Chart = New-ExcelChartDefinition -XRange CPU -YRange WS -Title "Process" -NoLegend</code> <br> <code>$data | Export-Excel .\ps.xlsx -AutoNameRange -ExcelChartDefinition $Chart -Show</code><h1 id=csv><a aria-label="Anchor link for: csv" class=zola-anchor href=#csv><i class=icon></i></a> CSV</h1><p><code>Get-Service | Select Name,DisplayName,Status,StartType | Export-Csv -path "$home\Desktop\Get-Service.csv" -Append -Encoding Default</code> экспортировать в csv (-Encoding UTF8) <br> <code>Import-Csv "$home\Desktop\Get-Service.csv" -Delimiter ","</code> импортировать массив<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">ConvertFrom-Csv</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">Region,State,Units,Price
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">West,Texas,927,923.71
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span>,Tennessee,466,770.67
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span></code></pre><p><code>$systeminfo = systeminfo /FO csv | ConvertFrom-Csv</code> вывод работы программы в CSV и конвертация в объект <br> <code>$systeminfo."Полный объем физической памяти"</code> <br> <code>$systeminfo."Доступная физическая память"</code><h3 id=convertfrom-string><a aria-label="Anchor link for: convertfrom-string" class=zola-anchor href=#convertfrom-string><i class=icon></i></a> ConvertFrom-String</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">log = 
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">   level = 4;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">};
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-String</span><span class="z-keyword z-operator z-other z-powershell">`</span> создает PSCustomObject <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">разбивает по пробелам<span class="z-keyword z-operator z-other z-powershell">,</span> удаляет все пробелы и пустые строки</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=convertfrom-stringdata><a aria-label="Anchor link for: convertfrom-stringdata" class=zola-anchor href=#convertfrom-stringdata><i class=icon></i></a> ConvertFrom-StringData</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">key1 = value1
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">key2 = value2
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-StringData</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> создает Hashtable<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h1 id=xml><a aria-label="Anchor link for: xml" class=zola-anchor href=#xml><i class=icon></i></a> XML</h1><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">xml</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Content</span> <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\test.rdg</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> прочитать содержимое XML<span class="z-keyword z-operator z-assignment z-powershell">-</span>файла
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.load</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\test.rdg<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> открыть файл
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.RDCMan.file.group.properties.name</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> имена групп
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.RDCMan.file.group.server.properties</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> имена всех серверов
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.RDCMan.file.group</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.server.properties<span class="z-keyword z-operator z-other z-powershell">`</span> список серверов в <span class="z-constant z-numeric z-integer z-powershell">4</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>й группе
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.RDCMan.file.group</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.server.properties <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">?</span> name <span class="z-keyword z-operator z-comparison z-powershell">-like</span> ADIRK</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Name <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>New-Name<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> изменить значение
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.RDCMan.file.group</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.server<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.properties.displayName <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>New-displayName<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> 
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.RDCMan.file.group</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.server<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.RemoveAll<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> удалить объект <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>й сервер в списке</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>file</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> сохранить содержимое объекта в файла
</span></code></pre><p><code>Get-Service | Export-Clixml -path $home\desktop\test.xml</code> экспортировать объект PowerShell в XML <br> <code>Import-Clixml -Path $home\desktop\test.xml</code> импортировать объект XML в PowerShell <br> <code>ConvertTo-Xml (Get-Service)</code><h3 id=get-credtoxml><a aria-label="Anchor link for: get-credtoxml" class=zola-anchor href=#get-credtoxml><i class=icon></i></a> Get-CredToXML</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-CredToXML</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CredFile</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Documents\cred.xml<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CredFile</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-support z-function z-powershell">Import-Clixml</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CredFile</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">elseif</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-unary z-powershell">!</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CredFile</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cred</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-Credential</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Message <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Enter credential<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cred</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cred</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Export-CliXml</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CredFile</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Cred</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">return</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>$Cred = Get-CredToXML</code> <br> <code>$Login = $Cred.UserName</code> <br> <code>$PasswordText = $Cred.GetNetworkCredential().password</code> получить пароль в текстовом виде<h3 id=xmlwriter-extensible-markup-language><a aria-label="Anchor link for: xmlwriter-extensible-markup-language" class=zola-anchor href=#xmlwriter-extensible-markup-language><i class=icon></i></a> XmlWriter (Extensible Markup Language)</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlWriterSettings</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> System.Xml.XmlWriterSettings
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlWriterSettings<span class="z-variable z-other z-member z-powershell">.Indent</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-keyword z-operator z-other z-powershell">`</span> включить отступы
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlWriterSettings<span class="z-variable z-other z-member z-powershell">.IndentChars</span></span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>    <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">`</span> задать отступ
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlFilePath</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\test.xml<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.XML.XmlWriter</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Create<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlFilePath</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlWriterSettings</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> создать документ
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteStartDocument</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> начать запись в документ
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteComment</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Comment<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteStartElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Root<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> создать стартовый элемент<span class="z-keyword z-operator z-other z-powershell">,</span> который содержит дочерние объекты
</span><span class="z-source z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteStartElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Configuration<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> создать первый дочерний элемент для BaseSettings
</span><span class="z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteElementString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Language<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>RU<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteStartElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Fonts<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>   		<span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> &LTFonts><span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteElementString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Name<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Arial<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteElementString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Size<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>12<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteEndElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>               	<span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> &LT/Fonts><span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteEndElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> конечный элемент <span class="z-keyword z-operator z-redirection z-powershell"><</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Configuration<span class="z-keyword z-operator z-redirection z-powershell">></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteEndElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> конечный элемент <span class="z-keyword z-operator z-redirection z-powershell"><</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Root<span class="z-keyword z-operator z-redirection z-powershell">></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.WriteEndDocument</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> завершить запись в документ
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.Flush</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>XmlObjectWriter<span class="z-variable z-other z-member z-powershell">.Close</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=createelement><a aria-label="Anchor link for: createelement" class=zola-anchor href=#createelement><i class=icon></i></a> CreateElement</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">xml</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">gc <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\test.xml</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.Root.Configuration.Fonts</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NewElement</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.CreateElement</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Fonts<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> выбрать элемент куда добавить
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NewElement<span class="z-variable z-other z-member z-powershell">.set_InnerXML</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTName>Times New Roman&LT/Name>&LTSize>14&LT/Size><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Заполнить значениями дочерние элементы Fonts
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.Root.Configuration.AppendChild</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NewElement</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> добавить элемент новой строкой в Configuration <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">родитель Fonts</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>xml<span class="z-variable z-other z-member z-powershell">.Save</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\desktop\test.xml<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h1 id=json><a aria-label="Anchor link for: json" class=zola-anchor href=#json><i class=icon></i></a> JSON</h1><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>log</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">  "log": {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">    "level": 7
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">  }
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-Service</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Json</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OOKLA</span>  <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">{
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">"result" : 
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">{"date":1683534970,"id":"14708271987","connection_icon":"wireless","download":33418,"upload":35442,"latency":15,"distance":50,"country_code":"RU","server_id":2707,"server_name":"Bryansk","sponsor_name":"DOM.RU","sponsor_url":null,"connection_mode":"multi","isp_name":"Resource Link","isp_rating":"4.0","test_rank":63,"test_grade":"B-","test_rating":4,"idle_latency":"17","download_latency":"116","upload_latency":"75","additional_servers":
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">[{"server_id":8191,"server_name":"Bryansk","sponsor_name":"SectorTelecom.ru"},{"server_id":46278,"server_name":"Fokino","sponsor_name":"Fokks - Promyshlennaya avtomatika Ltd."},{"server_id":18218,"server_name":"Bryansk","sponsor_name":"RIA-link Ltd."}],
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">"path":"result\u002F14708271987","hasSecondary":true
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ookla<span class="z-variable z-other z-member z-powershell">.result</span></span>
</span></code></pre><h1 id=yaml><a aria-label="Anchor link for: yaml" class=zola-anchor href=#yaml><i class=icon></i></a> YAML</h1><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-Module</span> PSYaml<span class="z-keyword z-operator z-other z-powershell">`</span> используется в Docker<span class="z-keyword z-operator z-assignment z-powershell">/</span>Ansible
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>netplan</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">network:` словарь по типу - ключ : значение с вложенными словарями
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">  ethernets:
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">    ens160:
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">      dhcp4: yes
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">      dhcp6: no
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">      nameservers:
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">        addresses:` [8.8.8.8, 1.1.1.1]` список данных (строк)
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">      - 8.8.8.8
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">      - 1.1.1.1
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">  version: 2
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>network</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">ConvertFrom-Yaml</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>netplan</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>network<span class="z-variable z-other z-member z-powershell">.Values.ethernets.ens160.nameservers</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>DataType</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">int: !!int 10.1
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">flo: !!float 10.1
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">str: !!str string
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell">bool: !!bool` boolean
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre><h1 id=toml><a aria-label="Anchor link for: toml" class=zola-anchor href=#toml><i class=icon></i></a> TOML</h1><p><code>Install-Module -Name PSToml -Scope CurrentUser</code> Устанавливаем модуль для чтения toml (PSToml) <br> <code>$toml = Get-Content "$home\Documents\Git\lifailon.github.io\hugo.toml"</code> Читаем содержимое конфигурации Hugo в формате toml <br> <code>$json = ConvertFrom-Toml $toml | ConvertTo-Json -Depth 3</code> Конвертируем TOML в JSON <br> <code>$json | Out-File "$home\Documents\Git\lifailon.github.io\hugo.json"</code> Сохраняем конфигурационный файл в формате JSON<h1 id=markdown><a aria-label="Anchor link for: markdown" class=zola-anchor href=#markdown><i class=icon></i></a> Markdown</h1><h3 id=convert-markdown-to-html><a aria-label="Anchor link for: convert-markdown-to-html" class=zola-anchor href=#convert-markdown-to-html><i class=icon></i></a> Convert Markdown to HTML</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertFrom-MarkdownToHtml</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-variable z-parameter z-attribute z-powershell">ValueFromPipeline</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Markdown</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>html</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-Content</span> index.md <span class="z-keyword z-operator z-assignment z-powershell">-</span>Raw <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Markdown</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.html
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  &LT!DOCTYPE html>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  &LThtml>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  &LThead>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  &LT/head>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  &LTbody>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>html</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  &LT/body>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  &LT/html>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">  "@
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span></span></code></pre><p><code>Get-Content index.md -Raw | ConvertFrom-MarkdownToHtml | Out-File index.html</code><h3 id=psmarkdown><a aria-label="Anchor link for: psmarkdown" class=zola-anchor href=#psmarkdown><i class=icon></i></a> PSMarkdown</h3><p>Install-Module PSMarkdown<h3 id=convertfrom-markdownv2><a aria-label="Anchor link for: convertfrom-markdownv2" class=zola-anchor href=#convertfrom-markdownv2><i class=icon></i></a> ConvertFrom-MarkdownV2</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">Function</span> <span class="z-entity z-name z-function z-powershell">ConvertFrom-MarkdownV2</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">CmdletBinding</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">OutputType</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">            <span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">            <span class="z-variable z-parameter z-attribute z-powershell">Position</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">            <span class="z-variable z-parameter z-attribute z-powershell">ValueFromPipeline</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">        <span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>InputObject</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Begin</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Process</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mddata</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>InputObject</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>mddata</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-comparison z-powershell">-notmatch</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>--<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>data</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">End</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">       <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>object</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span> +<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span><span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Csv</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Delimiter <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>|<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">       <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>object</span> 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h1 id=convertto-markdown><a aria-label="Anchor link for: convertto-markdown" class=zola-anchor href=#convertto-markdown><i class=icon></i></a> ConvertTo-Markdown</h1><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">Function</span> <span class="z-entity z-name z-function z-powershell">ConvertTo-Markdown</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">CmdletBinding</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">OutputType</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">            <span class="z-variable z-parameter z-attribute z-powershell">Mandatory</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">            <span class="z-variable z-parameter z-attribute z-powershell">Position</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">            <span class="z-variable z-parameter z-attribute z-powershell">ValueFromPipeline</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>true</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-meta z-attribute z-powershell">        <span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSObject</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>InputObject</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Begin</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">Process</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">ForEach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>item</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>InputObject</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>item</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>item<span class="z-variable z-other z-member z-powershell">.PSObject.Properties</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-keyword z-control z-powershell">if</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Value</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                    <span class="z-keyword z-control z-powershell">if</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-logical z-powershell">-not</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns<span class="z-variable z-other z-member z-powershell">.ContainsKey</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Name</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-logical z-powershell">-or</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Name</span></span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-comparison z-powershell">-lt</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Value.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Length</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Name</span></span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Value.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Length
</span></span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">End</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">ForEach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns<span class="z-variable z-other z-member z-powershell">.Keys</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Math</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Max<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key<span class="z-variable z-other z-member z-powershell">.Length</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>header</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">ForEach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns<span class="z-variable z-other z-member z-powershell">.Keys</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>header</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>{0,-<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>}<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>header</span> <span class="z-keyword z-operator z-unary z-powershell">-join</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span> | <span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>separator</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">ForEach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns<span class="z-variable z-other z-member z-powershell">.Keys</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>separator</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>-<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">*</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>separator</span> <span class="z-keyword z-operator z-unary z-powershell">-join</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span> | <span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-keyword z-control z-powershell">ForEach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>item</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>items</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>values</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-keyword z-control z-powershell">ForEach</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns<span class="z-variable z-other z-member z-powershell">.Keys</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">                <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>values</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>{0,-<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>columns</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>}<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>item</span>.<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>key</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>values</span> <span class="z-keyword z-operator z-unary z-powershell">-join</span> <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span> | <span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h1 id=html><a aria-label="Anchor link for: html" class=zola-anchor href=#html><i class=icon></i></a> HTML</h1><h3 id=convertfrom-html><a aria-label="Anchor link for: convertfrom-html" class=zola-anchor href=#convertfrom-html><i class=icon></i></a> ConvertFrom-Html</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">ConvertFrom-Html</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-meta z-attribute z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-support z-function z-attribute z-powershell">Parameter</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-parameter z-attribute z-powershell">ValueFromPipeline</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>irm</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HTMLFile</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ComObject HTMLFile
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Bytes</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Text.Encoding</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Unicode.GetBytes<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>irm</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HTMLFile<span class="z-variable z-other z-member z-powershell">.write</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Bytes</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HTMLFile<span class="z-variable z-other z-member z-powershell">.all</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">where</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.tagname</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>body<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.innerText
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>apache_status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://192.168.3.102/server-status<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>apache_status</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Html</span>
</span></code></pre><h3 id=convertto-html><a aria-label="Anchor link for: convertto-html" class=zola-anchor href=#convertto-html><i class=icon></i></a> ConvertTo-Html</h3><p><code>Get-Process | select Name, CPU | ConvertTo-Html -As Table > "$home\desktop\proc-table.html"</code> вывод в формате List (Format-List) или Table (Format-Table)<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>servers</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ya.ru<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ya.com<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>google.com<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Desktop\Ping.html<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> 
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>header</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LT!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LThtml xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LThead>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LTtitle>Отчет о статусе серверов&LT/title>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LTstyle type="text/css">
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LT!--
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">body {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">background-color: #E0E0E0;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">font-family: sans-serif
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">table, th, td {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">background-color: white;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">border-collapse:collapse;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">border: 1px solid black;
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">padding: 5px
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">-->
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LT/style>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LTh1>Ping status&LT/h1>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">&LTp><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-support z-function z-powershell">get-date</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Format <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>dd.MM.yyyy hh:mm<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.&LT/p>
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>server</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>servers</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Connection</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>server</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Count <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ea <span class="z-constant z-numeric z-integer z-powershell">0</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Quiet</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Up<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Down<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>server</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Status</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>status</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertTo-Html</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>head <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>header</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>body <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>body</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">foreach</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_</span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTtd>Down&LT/td><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTtd style='background-color:#FF8080'>Down&LT/td><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-comparison z-powershell">-replace</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTtd>Up&LT/td><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>&LTtd style='background-color:#5BCCF3'>Up&LT/td><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>
</span></code></pre><h3 id=pswritehtml><a aria-label="Anchor link for: pswritehtml" class=zola-anchor href=#pswritehtml><i class=icon></i></a> PSWriteHTML</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-Module</span> PSWriteHTML
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Module</span> PSWriteHTML</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ExportedCommands
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Get-Service</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-GridHtml</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>FilePath ~<span class="z-support z-function z-powershell">\Desktop\Get-Service</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-support z-function z-powershell">Out-GridHtml</span>.html
</span></code></pre><h3 id=htmlreport><a aria-label="Anchor link for: htmlreport" class=zola-anchor href=#htmlreport><i class=icon></i></a> HtmlReport</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-Module</span> HtmlReport
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>topVM</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> ps <span class="z-keyword z-operator z-other z-powershell">|</span> Sort PrivateMemorySize <span class="z-keyword z-operator z-assignment z-powershell">-</span>Descending <span class="z-keyword z-operator z-other z-powershell">|</span> Select <span class="z-keyword z-operator z-assignment z-powershell">-</span>First <span class="z-constant z-numeric z-integer z-powershell">10</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">%</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.ProcessName</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span> <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Id</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.PrivateMemorySize</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>topCPU</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> ps <span class="z-keyword z-operator z-other z-powershell">|</span> Sort CPU <span class="z-keyword z-operator z-assignment z-powershell">-</span>Descending <span class="z-keyword z-operator z-other z-powershell">|</span> Select <span class="z-keyword z-operator z-assignment z-powershell">-</span>First <span class="z-constant z-numeric z-integer z-powershell">10</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-keyword z-control z-powershell">%</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.ProcessName</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span> <span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.Id</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.CPU</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">New-Report</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Title <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Piggy Processes<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Input <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">New-Chart</span> Bar <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Top VM Users<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>input <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>topVm</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">New-Chart</span> Column <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Top CPU Overall<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>input <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>topCPU</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">ps <span class="z-keyword z-operator z-other z-powershell">|</span> Select ProcessName<span class="z-keyword z-operator z-other z-powershell">,</span> Id<span class="z-keyword z-operator z-other z-powershell">,</span> CPU<span class="z-keyword z-operator z-other z-powershell">,</span> WorkingSet<span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-keyword z-operator z-assignment z-powershell">*</span>MemorySize <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">New-Table</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>All Processes<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-operator z-redirection z-powershell">></span> ~<span class="z-support z-function z-powershell">\Desktop\Get-Process</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>HtmlReport.html
</span></code></pre><h1 id=htmlagilitypack><a aria-label="Anchor link for: htmlagilitypack" class=zola-anchor href=#htmlagilitypack><i class=icon></i></a> HtmlAgilityPack</h1><p><a href=https://www.nuget.org/packages/HtmlAgilityPack>Source</a><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Загрузка библиотеки C#, которая позволяет парсить HTML-документы, выбирать элементы DOM и извлекать из них данные<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Users\Lifailon\Downloads\HtmlAgilityPack\Net40\HtmlAgilityPack.dll<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>title</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>новобранец<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>http://fasts-torrent.net<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ep</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>engine/ajax/search_torrent.php?title=<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>title</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>html</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>/<span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ep</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Создание нового объекта HtmlDocument из HtmlAgilityPack, который будет использоваться для загрузки и обработки HTML-кода<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HtmlDocument</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> HtmlAgilityPack.HtmlDocument
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Загрузка HTML в созданный объект HtmlDocument<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HtmlDocument<span class="z-variable z-other z-member z-powershell">.LoadHtml</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>html</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>torrents</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Использование XPath для выбора всех элементов &LTtr> (строк таблицы) в документе<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>HtmlDocument<span class="z-variable z-other z-member z-powershell">.DocumentNode.SelectNodes</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>//tr<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ForEach-Object</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Для каждой строки таблицы выбираем классы, соответствующие названию раздачи, размеру и ссылке для скачивания.<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>titleNode</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.SelectSingleNode</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.//td[@class='torrent-title']<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sizeNode</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.SelectSingleNode</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.//td[@class='torrent-sp']<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadLinkNode</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.SelectSingleNode</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>.//td[@class='torrent-d-btn']/a<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Проверяем, что все классы найдены<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>titleNode</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span> <span class="z-keyword z-operator z-logical z-powershell">-and</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sizeNode</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span> <span class="z-keyword z-operator z-logical z-powershell">-and</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadLinkNode</span> <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Извлечение текста из классов<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>title</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>titleNode<span class="z-variable z-other z-member z-powershell">.InnerText.Trim</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>size</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>sizeNode<span class="z-variable z-other z-member z-powershell">.InnerText.Trim</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadLink</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadLinkNode<span class="z-variable z-other z-member z-powershell">.Attributes</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>href<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.Value
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>torrent</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> PSObject <span class="z-keyword z-operator z-assignment z-powershell">-</span>Property <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Title</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>title</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Size</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>size</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">            <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">DownloadLink</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> </span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>downloadLink</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>torrents</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>torrent</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p><code>$torrents</code><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell">Title                                                                    Size     DownloadLink
</span><span class="z-source z-powershell"><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>                                                                    <span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>     <span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">6</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">3</span> серии из <span class="z-constant z-numeric z-integer z-powershell">13</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2024</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEBRip <span class="z-keyword z-operator z-other z-powershell">|</span> RuDub              <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">55</span> ГБ  http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">449613</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-6</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">3</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">13</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2024</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>webrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>rudub<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">5</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span> серии из <span class="z-constant z-numeric z-integer z-powershell">22</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2023</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEBRip 1080p <span class="z-keyword z-operator z-other z-powershell">|</span> RuDub       <span class="z-constant z-numeric z-integer z-powershell">54</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">15</span> ГБ http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">433749</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-5</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2023</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>webrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>1080p<span class="z-keyword z-operator z-assignment z-powershell">-</span>rudub<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">5</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span> серии из <span class="z-constant z-numeric z-integer z-powershell">22</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2023</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEBRip 720p <span class="z-keyword z-operator z-other z-powershell">|</span> RuDub        <span class="z-constant z-numeric z-integer z-powershell">30</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">14</span> ГБ http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">433750</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-5</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2023</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>webrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>720p<span class="z-keyword z-operator z-assignment z-powershell">-</span>rudub<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">5</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span> серии из <span class="z-constant z-numeric z-integer z-powershell">22</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2023</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEBRip <span class="z-keyword z-operator z-other z-powershell">|</span> RuDub             <span class="z-constant z-numeric z-integer z-powershell">11</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">55</span> ГБ http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">433751</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-5</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2023</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>webrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>rudub<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">4</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span> серии из <span class="z-constant z-numeric z-integer z-powershell">22</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2021</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEB<span class="z-keyword z-operator z-assignment z-powershell">-</span>DL 720p <span class="z-keyword z-operator z-other z-powershell">|</span> RG.Paravozik <span class="z-constant z-numeric z-integer z-powershell">21.33</span> Gb http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">418618</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-4</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">22</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2021</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>web<span class="z-keyword z-operator z-assignment z-powershell">-</span>dl<span class="z-keyword z-operator z-assignment z-powershell">-</span>720p<span class="z-keyword z-operator z-assignment z-powershell">-</span>rgparavozik<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Полицейский с половиной: Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2017</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEB<span class="z-keyword z-operator z-assignment z-powershell">-</span>DLRip 720p<span class="z-keyword z-operator z-other z-powershell">|</span> Чистый звук   <span class="z-constant z-numeric z-integer z-powershell">3.41</span> Gb  http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">254846</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-2017</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>web<span class="z-keyword z-operator z-assignment z-powershell">-</span>dlrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>720p<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Полицейский с половиной: Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2017</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEB<span class="z-keyword z-operator z-assignment z-powershell">-</span>DLRip <span class="z-keyword z-operator z-other z-powershell">|</span> Чистый звук       <span class="z-constant z-numeric z-integer z-powershell">1.37</span> Gb  http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">254845</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-2017</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>web<span class="z-keyword z-operator z-assignment z-powershell">-</span>dlrip<span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span> серии из <span class="z-constant z-numeric z-integer z-powershell">20</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2019</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEBRip <span class="z-keyword z-operator z-other z-powershell">|</span> BaibaKo           <span class="z-constant z-numeric z-integer z-powershell">11.28</span> Gb http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">364669</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-2</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2019</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>webrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>baibako<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span> серии из <span class="z-constant z-numeric z-integer z-powershell">20</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2019</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEBRip 1080p <span class="z-keyword z-operator z-other z-powershell">|</span> Octopus     <span class="z-constant z-numeric z-integer z-powershell">45.97</span> Gb http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">364161</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-2</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2019</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>webrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>1080p<span class="z-keyword z-operator z-assignment z-powershell">-</span>octopus<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span><span class="z-source z-powershell">Новобранец <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2</span> сезон: <span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span> серии из <span class="z-constant z-numeric z-integer z-powershell">20</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-constant z-numeric z-integer z-powershell">2019</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> WEB<span class="z-keyword z-operator z-assignment z-powershell">-</span>DLRip <span class="z-keyword z-operator z-other z-powershell">|</span> LostFilm       <span class="z-constant z-numeric z-integer z-powershell">11.95</span> Gb http:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>fasts<span class="z-keyword z-operator z-assignment z-powershell">-</span>torrent.net<span class="z-keyword z-operator z-assignment z-powershell">/</span>download<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">364668</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>torrent<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">-2</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">1</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">20</span><span class="z-keyword z-operator z-assignment z-powershell">-</span><span class="z-constant z-numeric z-integer z-powershell">2019</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>web<span class="z-keyword z-operator z-assignment z-powershell">-</span>dlrip<span class="z-keyword z-operator z-assignment z-powershell">-</span>lostfilm<span class="z-keyword z-operator z-assignment z-powershell">/</span>
</span></code></pre><h1 id=wmi><a aria-label="Anchor link for: wmi" class=zola-anchor href=#wmi><i class=icon></i></a> WMI</h1><h3 id=windows-management-instrumentation><a aria-label="Anchor link for: windows-management-instrumentation" class=zola-anchor href=#windows-management-instrumentation><i class=icon></i></a> Windows Management Instrumentation</h3><p><code>Get-WmiObjec -ComputerName localhost -Namespace root -class "__NAMESPACE" | select name,__namespace</code> отобразить дочернии Namespace (логические иерархические группы) <br> <code>Get-WmiObject -List</code> отобразить все классы пространства имен “root\cimv2” (по умолчанию), свойства (описывают конфигурацию и текущее состояние управляемого ресурса) и их методы (какие действия позволяет выполнить над этим ресурсом) <br> <code>Get-WmiObject -List | Where-Object {$_.name -match "video"}</code> поиск класса по имени, его свойств и методов <br> <code>Get-WmiObject -ComputerName localhost -Class Win32_VideoController</code> отобразить содержимое свойств класса<p><code>gwmi -List | where name -match "service" | ft -auto</code> если в таблице присутствуют Methods, то можно взаимодействовать {StartService, StopService} <br> <code>gwmi -Class win32_service | select *</code> отобразить список всех служб и всех их свойств <br> <code>Get-CimInstance Win32_service</code> обращается на прямую к “root\cimv2” <br> <code>gwmi win32_service -Filter "name='Zabbix Agent'"</code> отфильтровать вывод по имени <br> <code>(gwmi win32_service -Filter "name='Zabbix Agent'").State</code> отобразить конкретное свойство <br> <code>gwmi win32_service -Filter "State = 'Running'"</code> отфильтровать запущенные службы <br> <code>gwmi win32_service -Filter "StartMode = 'Auto'"</code> отфильтровать службы по методу запуска <br> <code>gwmi -Query 'select * from win32_service where startmode="Auto"'</code> WQL-запрос (WMI Query Language) <br> <code>gwmi win32_service | Get-Member -MemberType Method</code> отобразить все методы взаимодействия с описание применения (Delete, StartService) <br> <code>(gwmi win32_service -Filter 'name="Zabbix Agent"').Delete()</code> удалить службу <br> <code>(gwmi win32_service -Filter 'name="MSSQL$MSSQLE"').StartService()</code> запустить службу<p><code>Get-CimInstance -ComputerName $srv Win32_OperatingSystem | select LastBootUpTime</code> время последнего включения <br> <code>gwmi -ComputerName $srv -Class Win32_OperatingSystem | select LocalDateTime,LastBootUpTime</code> текущее время и время последнего включения <br> <code>gwmi Win32_OperatingSystem | Get-Member -MemberType Method</code> методы reboot и shutdown <br> <code>(gwmi Win32_OperatingSystem -EnableAllPrivileges).Reboot()</code> используется с ключем повышения привелегий <br> <code>(gwmi Win32_OperatingSystem -EnableAllPrivileges).Win32Shutdown(0)</code> завершение сеанса пользователя<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>system</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-WmiObject</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Class Win32_OperatingSystem
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>InstallDate</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Management.ManagementDateTimeconverter</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::ToDateTime<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>system<span class="z-variable z-other z-member z-powershell">.installdate</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-other z-powershell">`</span> Получаем дату установки ОС
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>AfterInstallDays</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Date</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> — <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Installdate</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.Days<span class="z-keyword z-operator z-other z-powershell">`</span> Вычисляем время<span class="z-keyword z-operator z-other z-powershell">,</span> прошедшее с момента установки
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShortInstallDate</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>{0:yyyy-MM-dd HH:MM}<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>InstallDate</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Система установлена: <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ShortInstallDate</span> (Прошло <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>AfterInstalldays</span> дней)<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre><p><code>(Get-WmiObject win32_battery).estimatedChargeRemaining</code> заряд батареи в процентах <br> <code>gwmi Win32_UserAccount</code> доменные пользователи <br> <code>(gwmi Win32_SystemUsers).PartComponent</code> <br> <code>Get-CimInstance -ClassName Win32_LogonSession</code> <br> <code>Get-CimInstance -ClassName Win32_BIOS</code><p><code>gwmi -list -Namespace root\CIMV2\Terminalservices</code> <br> <code>(gwmi -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).AllowTSConnections</code> <br> <code>(gwmi -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).SetAllowTSConnections(1)</code> включить RDP<pre class=z-code><code><span class="z-text z-plain">$srv = "localhost"
</span><span class="z-text z-plain">gwmi Win32_logicalDisk -ComputerName $srv | where {$_.Size -ne $null} | select @{
</span><span class="z-text z-plain">Label="Value"; Expression={$_.DeviceID}}, @{Label="AllSize"; Expression={
</span><span class="z-text z-plain">[string]([int]($_.Size/1Gb))+" GB"}},@{Label="FreeSize"; Expression={
</span><span class="z-text z-plain">[string]([int]($_.FreeSpace/1Gb))+" GB"}}, @{Label="Free%"; Expression={
</span><span class="z-text z-plain">[string]([int]($_.FreeSpace/$_.Size*100))+" %"}}
</span></code></pre><h3 id=network-level-authentication><a aria-label="Anchor link for: network-level-authentication" class=zola-anchor href=#network-level-authentication><i class=icon></i></a> Network Level Authentication</h3><p><code>(gwmi -class "Win32_TSGeneralSetting" -Namespace root\cimv2\Terminalservices -Filter "TerminalName='RDP-tcp'").UserAuthenticationRequired</code> <br> <code>(gwmi -class "Win32_TSGeneralSetting" -Namespace root\cimv2\Terminalservices -Filter "TerminalName='RDP-tcp'").SetUserAuthenticationRequired(1)</code> включить NLA <br> <code>Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name SecurityLayer</code> отобразить значение (2) <br> <code>Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name UserAuthentication</code> отобразить значение (1) <br> <code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name SecurityLayer -Value 0</code> изменить значение <br> <code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name UserAuthentication -Value 0</code> <br> <code>REG ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters /v AllowEncryptionOracle /t REG_DWORD /d 2</code> отключить на клиентском компьютере проверку версии CredSSP, если на целевом комьютере-сервере не установлены обновления KB4512509 от мая 2018 года<h1 id=regedit><a aria-label="Anchor link for: regedit" class=zola-anchor href=#regedit><i class=icon></i></a> Regedit</h1><p><code>Get-PSDrive</code> список всех доступных дисков/разделов, их размер и веток реестра <br> <code>cd HKLM:\</code> HKEY_LOCAL_MACHINE <br> <code>cd HKCU:\</code> HKEY_CURRENT_USER <br> <code>Get-Item</code> получить информацию о ветке реестра <br> <code>New-Item</code> создать новый раздел реестра <br> <code>Remove-Item</code> удалить ветку реестра <br> <code>Get-ItemProperty</code> получить значение ключей/параметров реестра (это свойства ветки реестра, аналогично свойствам файла) <br> <code>Set-ItemProperty</code> изменить название или значение параметра реестра <br> <code>New-ItemProperty</code> создать параметр реестра <br> <code>Remove-ItemProperty</code> удалить параметр<p><code>Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Select DisplayName</code> список установленных программ <br> <code>Get-Item HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002</code> посмотреть содержимое Items <br> <code>(Get-ItemProperty HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002)."New Signature"</code> отобразить значение (Value) свойства (Property) Items <br> <code>$reg_path = "HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002"</code> <br> <code>$sig_name = "auto"</code> <br> <code>Set-ItemProperty -Path $reg_path -Name "New Signature" -Value $sig_name</code> изменить или добавить в корне ветки (Path) свойство (Name) со значением (Value) <br> <code>Set-ItemProperty -Path $reg_path -Name "Reply-Forward Signature" -Value $sig_name</code><pre class=z-code><code><span class="z-text z-plain">Windows Registry Editor Version 5.00
</span><span class="z-text z-plain">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\taskmgr.exe]
</span><span class="z-text z-plain">"Debugger"="\"C:\\Windows\\System32\\Taskmgr.exe\""
</span></code></pre><h1 id=performance><a aria-label="Anchor link for: performance" class=zola-anchor href=#performance><i class=icon></i></a> Performance</h1><p><code>lodctr /R</code> пересоздать счетчиков производительности из системного хранилища архивов (так же исправляет счетчики для CIM, например, для cpu Win32_PerfFormattedData_PerfOS_Processor и iops Win32_PerfFormattedData_PerfDisk_PhysicalDisk) <br> <code>(Get-Counter -ListSet *).CounterSetName</code> вывести список всех доступных счетчиков производительности в системе <br> <code>(Get-Counter -ListSet *memory*).Counter</code> поиск по wildcard-имени во всех счетчиках (включая дочернии) <br> <code>Get-Counter "\Memory\Available MBytes"</code> объем свободной оперативной памяти <br> <code>Get-Counter -cn $srv "\LogicalDisk(*)\% Free Space"</code> % свободного места на всех разделах дисков <br> <code>(Get-Counter "\Process(*)\ID Process").CounterSamples</code> <br> <code>Get-Counter "\Processor(_Total)\% Processor Time" –ComputerName $srv -MaxSamples 5 -SampleInterval 2</code> 5 проверок каждые 2 секунды <br> <code>Get-Counter "\Процессор(_Total)\% загруженности процессора" -Continuous</code> непрерывно <br> <code>(Get-Counter "\Процессор(*)\% загруженности процессора").CounterSamples</code><p><code>(Get-Counter -ListSet *интерфейс*).Counter</code> найти все счетчики <br> <code>Get-Counter "\Сетевой интерфейс(*)\Всего байт/с"</code> отобразить все адаптеры (выбрать действующий по трафику)<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WARNING</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">25</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CRITICAL</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">50</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TransferRate</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Counter</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\\huawei-mb-x-pro\сетевой интерфейс(intel[r] wi-fi 6e ax211 160mhz)\всего байт/с<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.countersamples <span class="z-keyword z-operator z-other z-powershell">|</span> select <span class="z-keyword z-operator z-assignment z-powershell">-</span>ExpandProperty CookedValue</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">*</span><span class="z-constant z-numeric z-integer z-powershell">8</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NetworkUtilisation</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">math</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::round<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TransferRate</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-constant z-numeric z-integer z-powershell">1000000000</span><span class="z-keyword z-operator z-assignment z-powershell">*</span><span class="z-constant z-numeric z-integer z-powershell">100</span><span class="z-keyword z-operator z-other z-powershell">,</span><span class="z-constant z-numeric z-integer z-powershell">2</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NetworkUtilisation</span> <span class="z-keyword z-operator z-comparison z-powershell">-gt</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>CRITICAL</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Write-Output</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>CRITICAL: <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NetworkUtilisation</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> % Network utilisation, <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TransferRate<span class="z-variable z-other z-member z-powershell">.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>N0<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> b/s<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>   
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>exit 2		<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NetworkUtilisation</span> <span class="z-keyword z-operator z-comparison z-powershell">-gt</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WARNING</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-support z-function z-powershell">Write-Output</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>WARNING: <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NetworkUtilisation</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> % Network utilisation, <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TransferRate<span class="z-variable z-other z-member z-powershell">.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>N0<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> b/s<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>exit 1<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Write-Output</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>OK: <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>NetworkUtilisation</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> % Network utilisation, <span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-complex z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TransferRate<span class="z-variable z-other z-member z-powershell">.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>N0<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> b/s<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>   
</span><span class="z-source z-powershell"><span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span>exit 0<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h1 id=snmp><a aria-label="Anchor link for: snmp" class=zola-anchor href=#snmp><i class=icon></i></a> SNMP</h1><h3 id=setup-snmp-service><a aria-label="Anchor link for: setup-snmp-service" class=zola-anchor href=#setup-snmp-service><i class=icon></i></a> Setup SNMP Service</h3><p><code>Install-WindowsFeature SNMP-Service,SNMP-WMI-Provider -IncludeManagementTools</code> установить роль SNMP и WMI провайдер через Server Manager <br> <code>Get-WindowsFeature SNMP*</code> <br> <code>Add-WindowsCapability -Online -Name SNMP.Client~~~~0.0.1.0</code> установить компонент Feature On Demand для Windows 10/11<code>\</code>Get-Service SNMP*<code>\</code>Get-NetFirewallrule -DisplayName <em>snmp</em> | ft<code>\</code>Get-NetFirewallrule -DisplayName <em>snmp</em> | Enable-NetFirewallRule`<h3 id=setting-snmp-service-via-regedit><a aria-label="Anchor link for: setting-snmp-service-via-regedit" class=zola-anchor href=#setting-snmp-service-via-regedit><i class=icon></i></a> Setting SNMP Service via Regedit</h3><p>Agent: <br> <code>New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\RFC1156Agent" -Name "sysContact" -Value "lifailon-user"</code> создать (New) или изменить (Set) <br> <code>New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\RFC1156Agent" -Name "sysLocation" -Value "plex-server"</code><p>Security: <br> <code>New-Item -Path "HKLM:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\public"</code> создать новый community string <br> <code>New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\SNMP\Parameters\ValidCommunities" -Name "public" -Value 16</code> назначить права на public <br> <code>1 — NONE</code> <br> <code>2 — NOTIFY</code> позволяет получать SNMP ловушки <br> <code>4 — READ ONLY</code> позволяет получать данные с устройства <br> <code>8 — READ WRITE</code> позволяет получать данные и изменять конфигурацию устройства <br> <code>16 — READ CREATE</code> позволяет читать данные, изменять и создавать объекты <br> <code>New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\SNMP\Parameters\PermittedManagers" -Name "1" -Value "192.168.3.99"</code> от кого разрешено принимать запросы <br> <code>Get-Service SNMP | Restart-Service</code><h3 id=snmpwalk><a aria-label="Anchor link for: snmpwalk" class=zola-anchor href=#snmpwalk><i class=icon></i></a> snmpwalk</h3><p><code>snmpwalk -v 2c -c public 192.168.3.100</code> <br> <code>snmpwalk -v 2c -c public -O e 192.168.3.100</code><h3 id=snmp-modules><a aria-label="Anchor link for: snmp-modules" class=zola-anchor href=#snmp-modules><i class=icon></i></a> SNMP Modules</h3><p><code>Install-Module -Name SNMP</code> <br> <code>Get-SnmpData -IP 192.168.3.100 -OID 1.3.6.1.2.1.1.4.0 -UDPport 161 -Community public</code> <br> <code>(Get-SnmpData -IP 192.168.3.100 -OID 1.3.6.1.2.1.1.4.0).Data</code> <br> <code>Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.1</code> пройтись по дереву OID <br> <code>Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.25.6.3.1.2</code> список установленного ПО <br> <code>Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.25.2.3.1</code> список разделов и памяти (C: D: Virtual Memory и Physical Memory) <br> <code>Set-SnmpData</code> изменение данных на удаленном устройстве<p><code>Install-Module -Name SNMPv3</code> <br> <code>Invoke-SNMPv3Get</code> получение данных по одному OID <br> <code>Invoke-SNMPv3Set</code> изменение данных <br> <code>Invoke-SNMPv3Walk</code> обход по дереву OID <br> <code>Invoke-SNMPv3Walk -UserName lifailon -Target 192.168.3.100 -AuthSecret password -PrivSecret password -OID 1.3.6.1.2.1.1 -AuthType MD5 -PrivType AES128</code><h3 id=lextm-sharpsnmplib><a aria-label="Anchor link for: lextm-sharpsnmplib" class=zola-anchor href=#lextm-sharpsnmplib><i class=icon></i></a> Lextm SharpSnmpLib</h3><p><a href="https://learn.microsoft.com/ru-ru/powershell/dsc/reference/resources/windows/fileresource?view=dsc-1.1">Синтаксис</a> <br> <a href=https://api.nuget.org/v3-flatcontainer/lextm.sharpsnmplib/12.5.2/lextm.sharpsnmplib.12.5.2.nupkg>Download lib</a><p><code>Add-Type -LiteralPath "$home\Desktop\lextm.sharpsnmplib-12.5.2\net471\SharpSnmpLib.dll"</code><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">161</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OID</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>1.3.6.1.2.1.1.4.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>variableList</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.Variable</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>variableList<span class="z-variable z-other z-member z-powershell">.Add</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.Variable</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::new<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.ObjectIdentifier</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::new<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OID</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>timeout</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-constant z-numeric z-integer z-powershell">3000</span>
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Net.IPAddress</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>192.168.3.100<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>endpoint</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> Net.IpEndPoint <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>ip</span><span class="z-keyword z-operator z-other z-powershell">,</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>port</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Community</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>public<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.VersionCode</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Version</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>V2<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>message</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.Messaging.Messenger</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Get<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Version</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>endpoint</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Community</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>variableList</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TimeOut</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>message<span class="z-variable z-other z-member z-powershell">.Data.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><h3 id=walk><a aria-label="Anchor link for: walk" class=zola-anchor href=#walk><i class=icon></i></a> Walk</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.ObjectIdentifier</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OID</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>1.3.6.1.2.1.1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> дерево или конечный OID<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WalkMode</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.Messaging.WalkMode</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::WithinSubtree <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> режим обхода по дереву<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">New-Object</span> Collections.Generic.List<span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.Variable</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>message</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">Lextm.SharpSnmpLib.Messaging.Messenger</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Walk<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Version</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>endpoint</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>Community</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>OID</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>TimeOut</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell">  <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>WalkMode</span>
</span></span><span class="z-source z-powershell"><span class="z-interpolated z-simple z-source z-powershell"></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results</span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results2</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">foreach</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>d</span> <span class="z-keyword z-control z-powershell">in</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results2</span> <span class="z-keyword z-operator z-assignment z-powershell">+=</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">PSCustomObject</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>ID<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>d<span class="z-variable z-other z-member z-powershell">.id.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>Data<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span><span class="z-keyword z-operator z-assignment z-powershell">=</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>d<span class="z-variable z-other z-member z-powershell">.Data.ToString</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> перекодировать вывод построчно в строку<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>results2</span>
</span></code></pre><h1 id=packagemanagement><a aria-label="Anchor link for: packagemanagement" class=zola-anchor href=#packagemanagement><i class=icon></i></a> PackageManagement</h1><p><code>Import-Module PackageManagement</code> импортировать модуль <br> <code>Get-Module PackageManagement</code> информация о модуле <br> <code>Get-Command -Module PackageManagement</code> отобразить все командлеты модуля <br> <code>Get-Package</code> отобразить все установленные пакеты PowerShellGallery <br> <code>Get-Package -ProviderName msi,Programs</code> список установленных программ <code>[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12</code> включить использование протокол TLS 1.2 (если не отключены протоколы TLS 1.0 и 1.1) <br> <code>Get-PackageSource</code> источники установки пакетов <br> <code>Get-PackageProvider</code> отобразить список провайдеров менеджеров пакетов <br> <code>Get-PackageProvider | Where-Object Name -Match nuget</code> <br> <code>Find-PackageProvider</code> отображение всех доступных менеджеров пакетов <br> <code>Find-PackageProvider nuget</code> <br> <code>Install-PackageProvider NuGet -Force</code> установить менеджер пакетов nuget <br> <code>Install-PackageProvider PSGallery -Force</code> установить источник <br> <code>Install-PackageProvider Chocolatey -Force</code> <br> <code>Set-PackageSource nuget -Trusted</code> разрешить установку пакетов из указанного источника <br> <code>Register-PSRepository -Name "NuGet" -SourceLocation "https://www.nuget.org/api/v2" -InstallationPolicy Trusted</code> зарегестрировать менеджер пакетов используя url (работает для Power Shell Core) <br> <code>Set-PackageSource -Name NuGet -Trusted</code> изменить источник по умолчанию <br> <code>Find-Package PSEverything</code> поиск пакетов по имени во всех менеджерах <br> <code>Find-Package PSEverything -Provider NuGet</code> поиск пакета у выбранного провайдера <br> <code>Install-Module PSEverything -Scope CurrentUser</code> установить модуль для текущего пользователя <br> <code>Install-Package -Name VeeamLogParser -ProviderName PSGallery -scope CurrentUser</code> <br> <code>Get-Command *Veeam*</code> <br> <code>Import-Module -Name VeeamLogParser</code> загрузить модуль <br> <code>Get-Module VeeamLogParser | select -ExpandProperty ExportedCommands</code> отобразить список функций<h3 id=winget><a aria-label="Anchor link for: winget" class=zola-anchor href=#winget><i class=icon></i></a> winget</h3><p><a href=https://github.com/microsoft/winget-cli>Source</a> <a href=https://winget.run>Web</a><p><code>winget list</code> список установленных пакетов <br> <code>winget search VLC</code> найти пакет <br> <code>winget show VideoLAN.VLC</code> информация о пакете <br> <code>winget show VideoLAN.VLC --versions</code> список доступных версий в репозитории <br> <code>winget install VideoLAN.VLC</code> установить пакет <br> <code>winget uninstall VideoLAN.VLC</code> удалить пакет <br> <code>winget download jqlang.jq</code> загрузкить пакет (https://github.com/jqlang/jq/releases/download/jq-1.7/jq-windows-amd64.exe) <br> <code>winget install jqlang.jq</code> добавляет в переменную среду и псевдоним командной строки jq <br> <code>winget uninstall jqlang.jq</code><h3 id=jqlang><a aria-label="Anchor link for: jqlang" class=zola-anchor href=#jqlang><i class=icon></i></a> jqlang</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">uri</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>irm https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">api.github.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>repos<span class="z-keyword z-operator z-assignment z-powershell">/</span>jqlang<span class="z-keyword z-operator z-assignment z-powershell">/</span>jq<span class="z-keyword z-operator z-assignment z-powershell">/</span>releases<span class="z-keyword z-operator z-assignment z-powershell">/</span>latest<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.assets.browser_download_url <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>windows-amd64<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.ToString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> получить версию latest на GitHub<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">irm <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Windows\System32\jq.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> загрузить jq.exe<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h3 id=scoop><a aria-label="Anchor link for: scoop" class=zola-anchor href=#scoop><i class=icon></i></a> Scoop</h3><p><code>Set-ExecutionPolicy RemoteSigned -Scope CurrentUser</code> <br> <code>irm get.scoop.sh | iex</code> установка <br> <code>scoop help</code> <br> <code>scoop search jq</code> <br> <code>scoop info jq</code> <br> <code>(scoop info jq).version</code> <br> <code>scoop cat jq</code> <br> <code>scoop download jq</code> C:\Users\lifailon\scoop\cache <br> <code>scoop install jq</code> C:\Users\lifailon\scoop\apps\jq\1.7 <br> <code>scoop list</code> <br> <code>(scoop list).version</code> <br> <code>scoop uninstall jq</code><h3 id=chocolatey><a aria-label="Anchor link for: chocolatey" class=zola-anchor href=#chocolatey><i class=icon></i></a> Chocolatey</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Set-ExecutionPolicy</span> Bypass <span class="z-keyword z-operator z-assignment z-powershell">-</span>Scope <span class="z-keyword z-control z-powershell">Process</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force<span class="z-punctuation z-terminator z-statement z-powershell">;</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.ServicePointManager</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::SecurityProtocol <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">System.Net.ServicePointManager</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::SecurityProtocol <span class="z-keyword z-operator z-bitwise z-powershell">-bor</span> <span class="z-constant z-numeric z-integer z-powershell">3072</span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> iex <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">New-Object</span> System.Net.WebClient</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.DownloadString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>https://community.chocolatey.org/install.ps1<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></code></pre><p><code>choco -v</code> <br> <code>choco -help</code> <br> <code>choco list</code> <br> <code>choco install adobereader</code><h1 id=nuget><a aria-label="Anchor link for: nuget" class=zola-anchor href=#nuget><i class=icon></i></a> NuGet</h1><p><code>Invoke-RestMethod https://dist.nuget.org/win-x86-commandline/latest/nuget.exe -OutFile "$home\Documents\nuget.exe"</code> <br> <code>Invoke-Expression "$home\Documents\nuget.exe search Selenium.WebDriver"</code> <br> <code>Invoke-Expression "$home\Documents\nuget.exe install Selenium.WebDriver"</code> <br> <code>Get-Item $home\Documents\*Selenium*</code><p><code>& "$home\Documents\nuget.exe" list console-translate</code> <br> <code>$nuget_api_key = "&LTAPI-KEY>"</code> <br> <code>$source = "https://api.nuget.org/v3/index.json"</code> <br> <code>$Name = "Console-Translate"</code> <br> <code>$path = "$home\Documents\$Name"</code> <br> <code>New-Item -Type Directory $path</code> <br> <code>Copy-Item "$home\Documents\Git\$Name\$Name\0.2\*" "$path\"</code> <br> <code>Copy-Item "$home\Documents\Git\$Name\LICENSE" "$path\"</code> <br> <code>Copy-Item "$home\Documents\Git\$Name\README.md" "$path\"</code><pre class="language-xml z-code" data-lang=xml><code class=language-xml data-lang=xml><span class="z-text z-xml">'<span class="z-meta z-tag z-preprocessor z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT?</span><span class="z-entity z-name z-tag z-xml">xml</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">version</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>1.0<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">?></span></span>
</span><span class="z-text z-xml"><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">package</span> <span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">  <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">metadata</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">id</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>Console-Translate<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">id</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">version</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>0.2.2<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">version</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">authors</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>Lifailon<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">authors</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">owners</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>Lifailon<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">owners</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">description</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>Cross-platform client for translating text in the console, uses API Google (edded public free token), MyMemory and DeepLX (no token required)<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">description</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">tags</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>PowerShell, Module, Translate, api<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">tags</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">repository</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>git<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">url</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>https://github.com/Lifailon/Console-Translate<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">projectUrl</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>https://github.com/Lifailon/Console-Translate<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">projectUrl</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">licenseUrl</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>https://github.com/Lifailon/Console-Translate/blob/rsa/LICENSE<span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">licenseUrl</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">contentFiles</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Console-Translate.psm1<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Console-Translate.psd1<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>lang-iso-639-1.csv<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>README.md<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml"><</span><span class="z-entity z-name z-tag z-localname z-xml">files</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">include</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>LICENSE<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">buildAction</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-double z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">"</span>Content<span class="z-punctuation z-definition z-string z-end z-xml">"</span></span> <span class="z-punctuation z-definition z-tag z-end z-xml">/></span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">contentFiles</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml">  <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">metadata</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>
</span><span class="z-text z-xml"><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&LT/</span><span class="z-entity z-name z-tag z-localname z-xml">package</span><span class="z-punctuation z-definition z-tag z-end z-xml">></span></span>' > "$path\$Name.nuspec"
</span></code></pre><p><code>Set-Location $path</code> <br> <code>& "$home\Documents\nuget.exe" pack "$path\$Name.nuspec"</code> <br> <code>& "$home\Documents\nuget.exe" push "$path\$Name.0.2.2.nupkg" -ApiKey $nuget_api_key -Source $source</code> <br> <code>& "$home\Documents\nuget.exe" push "$path\$Name.0.2.2.nupkg" -ApiKey $nuget_api_key -Source $source -SkipDuplicate</code><p><code>Install-Package Console-Translate -Source nuget.org</code> <br> <code>Get-Package Console-Translate | select *</code><p><code>Register-PSRepository -Name "NuGet" -SourceLocation "https://www.nuget.org/api/v2" -InstallationPolicy Trusted</code> <br> <code>Get-PSRepository</code> <br> <code>Find-Module -Name Console-Translate</code> <br> <code>Install-Module Console-Translate -Repository NuGet</code><p><code>& "$home\Documents\nuget.exe" delete Console-Translate 0.2.0 -Source https://api.nuget.org/v3/index.json -ApiKey $nuget_api_key -NoPrompt</code><h1 id=modules><a aria-label="Anchor link for: modules" class=zola-anchor href=#modules><i class=icon></i></a> Modules</h1><h3 id=get-query><a aria-label="Anchor link for: get-query" class=zola-anchor href=#get-query><i class=icon></i></a> Get-Query</h3><p><code>Install-Module Get-Query -Repository NuGet</code> установить модуль <br> <code>Get-Help Get-Query</code> <br> <code>Get-Query localhost</code> отобразить всех авторизованных пользователей, их статус и время работы (по умолчанию localhost) <br> <code>Get-Query 192.168.1.1.1 -proc</code> список всех пользовательских процессов (по умолчанию -user *) <br> <code>Get-Query 192.168.1.1.1 -proc -user username</code> список процессов указанного пользователя<h3 id=console-translate><a aria-label="Anchor link for: console-translate" class=zola-anchor href=#console-translate><i class=icon></i></a> Console-Translate</h3><p><code>Install-Module Console-Translate -Repository NuGet</code> <br> <code>Get-Translate "Module for text translation"</code> <br> <code>Get-Translate "Модуль для перевода текста"</code> <br> <code>Get-Translate "Привет world" -LanguageSelected</code> т.к. больше латинских символов (на 1), то перевод будет произведен на английский язык <br> <code>Get-Translate "Hello друг" -LanguageSelected</code> перевод на русский язык <br> <code>Get-Translate -Text "Модуль для перевода текста" -LanguageSource ru -LanguageTarget tr</code> <br> <code>Get-Translate -Provider MyMemory -Text "Hello World" -Alternatives</code> выбрать провайдер перевода и добавить альтернативные варианты вывода <br> <code>Get-DeepLX "Get select" ru</code> <br> <code>Start-DeepLX -Job</code> запустить сервер в режиме процесса <br> <code>Start-DeepLX -Status</code> <br> <code>Get-DeepLX -Server 192.168.3.99 -Text "Module for text translation" ru</code> <br> <code>Stop-DeepLX</code> <br> <code>Get-LanguageCode</code> получение кодов языков по стандарту ISO-639-1<h3 id=console-download><a aria-label="Anchor link for: console-download" class=zola-anchor href=#console-download><i class=icon></i></a> Console-Download</h3><p><code>Install-Module Console-Download -Repository NuGet</code> устаовить модуль из менеджера пакетов NuGet <br> <code>Invoke-Expression $(Invoke-RestMethod "https://raw.githubusercontent.com/Lifailon/Console-Download/rsa/module/Console-Download/Console-Download.psm1")</code> или импортировать модуль из GitHub репозитория в текущую сессию PowerShell <br> <code>Invoke-Download -Url "https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip"</code> загрузить файл в один поток с отображением скорости загрузки в реальном времен (путь загрузки файла по умолчанию: $home\downloads) <br> <code>Invoke-Download -Url "https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip" -Thread 3</code> загрузить один и тотже файл в 3 потока (создается 3 файла, доступно от 1 до 20 потоков)<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>urls</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-group z-array-expression z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-group z-array-expression z-powershell">    <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/Lifailon/helperd/releases/download/0.0.1/Helper-Desktop-Setup-0.0.1.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-group z-array-expression z-powershell"><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-Download</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>urls</span> <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> загрузить параллельно 2 файла<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><p><code>$urls = Get-Content "$home\Desktop\links.txt"</code> <br> <code>Invoke-Download $urls</code> передайте список URL-адресов из файла для загрузки файлов, эквивалентному числу url<p><code>$urls = Get-LookingGlassList</code> отобразить актуальный список конечных точек Looking Glass через Looking.House (выдает 3 ссылки на загрузку файлов по 10, 100 и 1000 мбайт для каждого региона) <br> <code>$usaNy = $urls | Where-Object region -like *USA*New*York*</code> отфильтровать список по региону и городу <br> <code>$url = $usaNy[0].url100mb</code> забрать первую ссылку с файлов на 100 МБайт <br> <code>Invoke-Download $url</code> начать загрузку файла <br> <code>Invoke-Download $url -Thread 3</code> начать загрузку 3-х одинаковых файлов<h3 id=pseverything><a aria-label="Anchor link for: pseverything" class=zola-anchor href=#pseverything><i class=icon></i></a> PSEverything</h3><p><code>Install-Module PSEverything -Repository NuGet</code> <br> <code>Find-Everything pingui</code> найти все файлы в системе (на всех локальных дисках) с именем <em>pingui</em> через dll csharp версии Everything (по умолчанию) <br> <code>Find-Everything pingui-0.1.py | Format-List</code> <br> <code>Find-Everything pingui -es</code> использовать cli версию Everything для поиска (при первом использовании версии, необходимо дождаться автоматической установки файлов зависимостей) <br> <code>Find-Everything pingui-0.1 -ComputerName localhost</code> поиск на удаленном компьютере через REST API, если запущен HTTP-сервер Everything<h3 id=hardwaremonitor><a aria-label="Anchor link for: hardwaremonitor" class=zola-anchor href=#hardwaremonitor><i class=icon></i></a> HardwareMonitor</h3><p><code>Install-Module HardwareMonitor -Repository NuGet -Scope AllUsers</code> <br> <code>Install-LibreHardwareMonitor</code> установить и запустить LibreHardwareMonitor в систему (https://github.com/LibreHardwareMonitor/LibreHardwareMonitor) <br> <code>Install-OpenHardwareMonitor</code> установить OpenHardwareMonitor (https://github.com/openhardwaremonitor/openhardwaremonitor) <br> <code>Get-Sensor | Where-Object {($_.SensorName -match "Temperature") -or ($_.SensorType -match "Temperature")} | Format-Table</code> использовать LibreHardwareMonitor и WMI/CIM (по умолчанию) и отфильтровать вывод по наименованию датчикам или типу сенсора для вывода датчиков температуры <br> <code>Get-Sensor -Open</code> использовать OpenHardwareMonitor <br> <code>Get-Sensor -ComputerName 192.168.3.99 -Port 8086 | Format-Table</code> вывести датчики системы через REST API <br> <code>Get-Sensor -ComputerName 192.168.3.99 -Port 8085 -User hardware -Password monitor | Where-Object Value -notmatch "^0,0" | Format-Table</code> использовать авторизацию и отфильтровать вывод не пустых датчиков <br> <code>Get-Sensor -Library | Where-Object Value -ne 0 | Format-Table</code> использовать динамическую библиотеку (dll) через .NET<h3 id=crystaldisk-cli><a aria-label="Anchor link for: crystaldisk-cli" class=zola-anchor href=#crystaldisk-cli><i class=icon></i></a> CrystalDisk-Cli</h3><p><code>Install-Module CrystalDisk-Cli -Repository NuGet</code> <br> <code>Get-DiskInfoSettings</code> отобразить настройки программы Crystal-DiskInfo (https://github.com/hiyohiyo/CrystalDiskInfo) <br> <code>Get-DiskInfoSettings -AutoRefresh 5</code> изминить время сканирования на 5 минут <br> <code>Get-DiskInfo -List</code> отобразить список дисков <br> <code>Get-DiskInfo</code> получить результаты последнего сканирования (статус, температура и т.п.) <br> <code>Get-DiskInfo -Report | Select-Object Name,Date,HealthStatus,Temperature</code> получить актуальный отчет (запустить сканирование и дождаться результатов)<h3 id=ps-pi-hole><a aria-label="Anchor link for: ps-pi-hole" class=zola-anchor href=#ps-pi-hole><i class=icon></i></a> PS-Pi-Hole</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_psm</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>PSModulePath<span class="z-variable z-other z-member z-powershell">.Split</span></span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\Invoke-Pi-Hole\Invoke-Pi-Hole.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-keyword z-operator z-unary z-powershell">!</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_psm</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">New-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_psm</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType File <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">irm https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">raw.githubusercontent.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>Lifailon<span class="z-keyword z-operator z-assignment z-powershell">/</span>PS<span class="z-keyword z-operator z-assignment z-powershell">-</span>Pi<span class="z-keyword z-operator z-assignment z-powershell">-</span>Hole<span class="z-keyword z-operator z-assignment z-powershell">/</span>rsa<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Invoke-Pi</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>Hole<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">Invoke-Pi</span><span class="z-keyword z-operator z-assignment z-powershell">-</span>Hole.psm1 <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Out-File</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path_psm</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force
</span></code></pre><p><code>sudo cat /etc/pihole/setupVars.conf | grep WEBPASSWORD</code> получить токен доступа <br> <code>$Server = "192.168.1.253"</code> <br> <code>$Token = "5af9bd44aebce0af6206fc8ad4c3750b6bf2dd38fa59bba84ea9570e16a05d0f"</code> <br> <code>Invoke-Pi-Hole -Versions -Server $Server -Token $Token</code> получить текущую версию ядра (backend) и веб (frontend) на сервере а также последнюю доступную версию для обновления <br> <code>Invoke-Pi-Hole -Releases -Server $Server -Token $Token</code> узнать последнюю доступную версию в репозитории на GitHub <br> <code>Invoke-Pi-Hole -QueryLog -Server $Server -Token $Token</code> отобразить полный журнал запросов (клиент, домен назначения, тип записи, статус время запроса и адрес пересылки forward dns - куда ушел запрос) <br> <code>Invoke-Pi-Hole -AdList -Server $Server -Token $Token</code> получить списки блокировак используемых на сервере (дата обновления, количество доменов и url-источника) <br> <code>Invoke-Pi-Hole -Status -Server $Server -Token $Token</code> статус работы режима блокировки <br> <code>Invoke-Pi-Hole -Enable -Server $Server -Token $Token</code> включить блокировку <br> <code>Invoke-Pi-Hole -Disable -Server $Server -Token $Token</code> отключить блокировку <br> <code>Invoke-Pi-Hole -Stats -Server $Server -Token $Token</code> подключиться к серверу Pi-Hole для получения статистики (метрики: количество доменов для блокировки, количество запросов и блокировок за сегодня и т.д.) <br> <code>Invoke-Pi-Hole -QueryTypes -Server $Server -Token $Token</code> статистика запросов по типу записей относительно 100% <br> <code>Invoke-Pi-Hole -TopClient -Server $Server -Token $Token</code> список самых активных клиентов (ip/name и количество запросов проходящих через сервер) <br> <code>Invoke-Pi-Hole -TopPermittedDomains -Count 100 -Server $Server -Token $Token</code> список самых посещяемых доменов и количество запросов <br> <code>Invoke-Pi-Hole -LastBlockedDomain -Server $Server -Token $Token</code> адрес последнего заблокированного домена <br> <code>Invoke-Pi-Hole -ForwardServer -Server $Server -Token $Token</code> список серверов для пересылки, которым обычно выступает DNS-сервер стоящий за Pi-Hole в локальной сети, например AD <br> <code>Invoke-Pi-Hole -Data -Server $Server -Token $Token</code> количество запросов за каждые 10 минут в течение последних 24 часов<h3 id=check-host><a aria-label="Anchor link for: check-host" class=zola-anchor href=#check-host><i class=icon></i></a> Check-Host</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-support z-variable z-drive z-powershell">env:</span>PSModulePath</span> <span class="z-keyword z-operator z-unary z-powershell">-split</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>;<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">0</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>\Get-CheckHost<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Test-Path</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType Directory <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span> <span class="z-keyword z-control z-powershell">else</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">New-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ItemType Directory <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://raw.githubusercontent.com/Lifailon/Check-Host/rsa/Get-CheckHost/Get-CheckHost.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span>\Get-CheckHost.psm1<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre><p><code>Install-Module CheckHost</code> установить модуль работы с Check-Host (https://check-host.net) через api <br> <code>Get-CheckHost -List</code> список хостов (node) разных регионов (40) <br> <code>Get-CheckHost -Server google.com -Type ping -Count 5</code> использовать 5 любых хостов для 4 пингов с каждого до указанного url (google) <br> <code>Get-CheckHost -Server google.com -Type dns -Count 5</code> проверить DNS (возвращает А-запись или диапазон с ip-адресом) <br> <code>Get-CheckHost -Server google.com:443 -Type http -Count 5</code> проверить доступность порта <br> <code>Get-CheckHost -Server google.com:443 -Type tcp -Count 5</code> проверить доступность TCP или UDP порта<h3 id=psdomaintest><a aria-label="Anchor link for: psdomaintest" class=zola-anchor href=#psdomaintest><i class=icon></i></a> PSDomainTest</h3><p><code>Install-Module PSDomainTest -Repository NuGet -Scope CurrentUser</code> <br> <code>Get-DomainTest -Domain github.com -Warning</code> протестировать домен и DNS записи на ошибки (вывести только ошибки) через ZoneMaster (https://github.com/zonemaster/zonemaster) <br> <code>Get-DomainTest -Domain github.com -Warning -json</code> вывод в формате json <br> <code>Get-DomainTest -Domain github.com -html | Out-File .\result.html</code> получить отчет в формате HTML-таблицы с фильтрацией по столбцам<h3 id=winapi><a aria-label="Anchor link for: winapi" class=zola-anchor href=#winapi><i class=icon></i></a> WinAPI</h3><p><code>Install-Module ps.win.api -Repository NuGet -AllowClobber</code> <br> <code>Import-Module ps.win.api</code> <br> <code>Get-Command -Module ps.win.api</code> <br> <code>Start-WinAPI</code> запустить сервер <br> <code>Test-WinAPI</code> статус сервера <br> <code>Stop-WinAPI</code> остановить сервер <br> <code>Read-WinAPI</code> отобразить лог в реальном времени <br> <code>Get-Hardware</code> вывести сводную информацию о системе с использованием потоков (фоновых заданий) <br> <code>Get-DiskPhysical</code> отобразить список физических дисков, их размер, интерфейс и статус <br> <code>Get-DiskPhysical -ComputerName 192.168.3.100 -Port 8443 -User rest -Pass api</code> получить информацию с удаленного сервер, на котором запущен сервер WinAPI (доступно для всех функций модуля) <br> <code>Get-DiskLogical</code> список логических дисков (включая виртуальные диски), их файловая система, общий и используемый размер в гб и процентах <br> <code>Get-DiskPartition</code> список разделов физических дисков (отобразит скрытые разделы, загрузочный и порядок назначения байт) <br> <code>Get-Smart</code> статус работы всех дисков и текущая температура <br> <code>Get-IOps</code> количество операций ввода/вывода дисковой подсистемы <br> <code>Get-Files</code> подробная информация о файлах (добавляет дату создания, изменения, доступа, количество дочерних файлов и директорий) <br> <code>Find-Process</code> поиск пути к исполняемому файлу по имени остановленного (не запущенного) процесса в директориях <br> <code>Get-ProcessPerformance</code> информация о процессах (Get-Process) в человеко-читаемом формате <br> <code>Get-CPU</code> список все ядер и нагрузка на каждое ядро и на все сразу (суммарное процессорное время, привилегированное и пользовательское время процессора) <br> <code>Get-MemorySize</code> размер оперативной, виртуальной памяти, суммарное потребление памяти процессов и путь к файлу подкачки <br> <code>Get-MemorySlots</code> список всех слотов оперативной памяти <br> <code>Get-NetInterfaceStat</code> статистика активного сетевого интерфейса за время с момента загрузки системы (количество пакетов и ГБ) <br> <code>Get-NetInterfaceStat -Current</code> текущая статистика активного сетевого интерфейса (количество пакетов и МБ/c) <br> <code>Get-NetIpConfig</code> конфигурация всех сетевых интерфейсов (ip и mac-адрес, статус DHCP сервера, дата аренды) <br> <code>Get-NetStat</code> развернутая статистика сетевых интерфейсов (из Get-NetTCPConnection), добавляет имя процесса, имя удаленного хоста (через nslookup), время работы процесса (не процессорное время) и путь к исполняемому файлу <br> <code>Get-Performance</code> информация из счетчиков (Get-Counter) человеко-читаемом формате <br> <code>Get-VideoCard</code> информация о всех видео-картах (наименование, частота и объем видео-памяти) <br> <code>Get-Software</code> список установленного програмного обеспечения <br> <code>Get-WinUpdate</code> список обновлений Windows (дата установки и источник) <br> <code>Get-Driver</code> список установленных драйверов (имя, провайдер, версия и дата установки)<h3 id=psyslog><a aria-label="Anchor link for: psyslog" class=zola-anchor href=#psyslog><i class=icon></i></a> pSyslog</h3><p><code>Install-Module pSyslog -Repository NuGet</code> <br> <code>Start-pSyslog -Port 514</code> запустить сервер на порту 514 (по умолчанию) <br> <code>Start-pSyslog -RotationSize 500</code> указать размер файла локального журнала для его ротации (обрезания) в КБ <br> <code>Get-pSyslog -Status | Format-List</code> отобразить статус работы <br> <code>Get-pSyslog</code> вывести журнал сообщений в реальном времени <br> <code>Stop-pSyslog</code> остановить сервер <br> <code>Send-pSyslog -Content "Test" -Server 192.168.3.99</code> отправить сообщение на Syslog-сервер <br> <code>Send-pSyslog -Content "Test" -Server 192.168.3.99 -Type Informational -PortServer 514 -PortClient 55514</code> <br> <code>(Get-Service -Name WinRM).Status | Send-pSyslog -Server 192.168.3.102 -Tag Service[WinRM]</code> <br> <code>Send-pSyslog -Content "test" -Server 192.168.3.99 -PortServer 514 -Base64</code> использовать шифрование при отправки сообщения (расшифровка работает только для сервера pSyslog) <br> <code>Start-UDPRelay -inPort 515 -outIP 192.168.3.102 -outPort 514</code> запустить сервер в режиме UDP-Relay, который слушает на порту 515 и переадресует сообщения на Syslog сервер 192.168.3.102 с портом 514 <br> <code>Send-pSyslog -Server 192.168.3.99 -PortServer 515 -Content $(Get-Date)</code> отправить сообщение на сервере UDP-Relay <br> <code>Show-pSyslog -Type Warning -Count</code> отобразить метрики (количество ошибок) <br> <code>Show-pSyslog -Type Alert -Count</code> <br> <code>Show-pSyslog -Type Critical -Count</code> <br> <code>Show-pSyslog -Type Error -Count</code> <br> <code>Show-pSyslog -Type Emergency -Count</code> <br> <code>Show-pSyslog -Type Informational -Count</code> <br> <code>Show-pSyslog -LogFile 05-06 | Out-GridView</code> прочитать локальный журнал логирования и вывести в GridView для фильтрации сообщений <br> <code>Show-pSyslog -Count</code> отобразить количество сообщений локального журнала <br> <code>Show-pSyslog -Count -LogFile 10-06</code> выбрать журнал по дате<h3 id=syslog-source-message><a aria-label="Anchor link for: syslog-source-message" class=zola-anchor href=#syslog-source-message><i class=icon></i></a> Syslog source message</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>TypeDefinition <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public enum Syslog_Facility {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    kern,     // 0  kernel (core) messages
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    user,     // 1  user level messages
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    mail,     // 2  mail system
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    daemon,   // 3  system daemons
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    auth,     // 4  security/authorization messages (login/su)
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    syslog,   // 5  syslog daemon
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    lpr,      // 6  line printer subsystem (creating jobs and send to spool for print by using lpd)
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    news,     // 7  network news subsystem (USENET)
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    uucp,     // 8  Unix-to-Unix Copy subsystem
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    cron,     // 9  scheduling daemon
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    authpriv, // 10 security/authorization private messages
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    ftp,      // 11 FTP daemon
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    ntp,      // 12 NTP daemon
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    security, // 13 security log audit
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    console,  // 14 console log alert
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    clock,    // 15 clock subsystem
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local0,   // 16 local use
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local1,   // 17
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local2,   // 18
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local3,   // 19
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local4,   // 20
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local5,   // 21
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local6,   // 22
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    local7    // 23
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span></code></pre><h3 id=syslog-type-message><a aria-label="Anchor link for: syslog-type-message" class=zola-anchor href=#syslog-type-message><i class=icon></i></a> Syslog type message</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Add-Type</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>TypeDefinition <span class="z-string z-quoted z-double z-heredoc z-powershell">@"
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">public enum Syslog_Severity {
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Emergency,     // 0 emerg
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Alert,         // 1 alert
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Critical,      // 2 crit
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Error,         // 3 err
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Warning,       // 4 warning
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Notice,        // 5 notice
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Informational, // 6 info
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">    Debug          // 7 debug
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">}
</span></span><span class="z-source z-powershell"><span class="z-string z-quoted z-double z-heredoc z-powershell">"@</span>
</span></code></pre><h1 id=pester><a aria-label="Anchor link for: pester" class=zola-anchor href=#pester><i class=icon></i></a> Pester</h1><p><a href=https://github.com/pester/Pester>Source</a><p><code>Install-Module -Name Pester -Repository PSGallery -Force -AllowClobber</code> <br> <code>Import-Module Pester</code> <br> <code>$(Get-Module Pester -ListAvailable).Version</code><p><code>.Tests.ps1</code><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Add-Numbers</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>a</span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>b</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>a</span> <span class="z-keyword z-operator z-assignment z-powershell">+</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>b</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">Describe <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Add-Numbers<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Context <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>При сложении двух чисел<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        It <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Должна вернуться правильная сумма<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Add-Numbers</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>a <span class="z-constant z-numeric z-integer z-powershell">3</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>b <span class="z-constant z-numeric z-integer z-powershell">4</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-other z-powershell">|</span> Should <span class="z-keyword z-operator z-assignment z-powershell">-</span>Be <span class="z-constant z-numeric z-integer z-powershell">7</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Context <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>При сложении двух чисел<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        It <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Должна вернуться ошибка (5+0 -ne 4)<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Add-Numbers</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>a <span class="z-constant z-numeric z-integer z-powershell">5</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>b <span class="z-constant z-numeric z-integer z-powershell">0</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-other z-powershell">|</span> Should <span class="z-keyword z-operator z-assignment z-powershell">-</span>Be <span class="z-constant z-numeric z-integer z-powershell">4</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-RunningProcess</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">return</span> <span class="z-support z-function z-powershell">Get-Process</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Select-Object</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>ExpandProperty Name
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">Describe <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Get-RunningProcess<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Context <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>При наличии запущенных процессов<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        It <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Должен возвращать список имен процессов<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-RunningProcess</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-other z-powershell">|</span> Should <span class="z-keyword z-operator z-assignment z-powershell">-</span>Contain <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>svchost<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-other z-powershell">|</span> Should <span class="z-keyword z-operator z-assignment z-powershell">-</span>Contain <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>explorer<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    Context <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Когда нет запущенных процессов<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        It <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>Должен возвращать пустой список<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> Замокать функцию Get-Process, чтобы она всегда возвращала пустой список процессов<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            Mock <span class="z-support z-function z-powershell">Get-Process</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-keyword z-control z-powershell">return</span> <span class="z-meta z-group z-array-expression z-powershell"><span class="z-keyword z-other z-array z-begin z-powershell">@</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-RunningProcess</span>
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">            <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-other z-powershell">|</span> Should <span class="z-keyword z-operator z-assignment z-powershell">-</span>BeEmpty
</span></span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">        <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><h1 id=oh-my-posh><a aria-label="Anchor link for: oh-my-posh" class=zola-anchor href=#oh-my-posh><i class=icon></i></a> oh-my-posh</h1><p><a href=https://ohmyposh.dev/docs/installation/windows>Install</a><p><code>winget install JanDeDobbeleer.OhMyPosh -s winget</code> <br> <code>choco install oh-my-posh -y</code> <br> <code>scoop install https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/oh-my-posh.json</code> <br> <code>Set-ExecutionPolicy Bypass -Scope Process -Force; Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://ohmyposh.dev/install.ps1'))</code><p><a href=https://ohmyposh.dev/docs/themes>Themes</a><p><code>Get-PoshThemes</code> отобразить список всех тем <br> <code>oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/di4am0nd.omp.json" | Invoke-Expression</code> применить (использовать) тему в текущей сессии <br> <code>oh-my-posh init pwsh --config "https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/cert.omp.json" | Invoke-Expression</code> считать тему из репозитория <br> <code>New-Item -Path $PROFILE -Type File -Force</code> создайт файл профилья PowerShell <br> <code>'oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/di4am0nd.omp.json" | Invoke-Expression' > $PROFILE</code> сохранить тему профиля (загружать тему при запуске PowerShell)<h3 id=themes-performance><a aria-label="Anchor link for: themes-performance" class=zola-anchor href=#themes-performance><i class=icon></i></a> themes-performance</h3><p><code>Install-Module themes-performance -Repository NuGet</code> установить модуль с темами <br> <code>Set-PoshTheme -Theme System-Sensors</code> использовать тему с датчиками из LibreHardwareMonitor <br> <code>Set-PoshTheme -Theme System-Sensors -Save</code> загрузить тему из репозитория на локальный компьютер и сохранить тему в профиле <br> <code>Set-PoshTheme -Theme System-Performance</code> использовать тему с датчиками системы, получаемыми из системы WMI/CIM (заряд батареи ноутбука | загрузка CPU в % | использование оперативной памяти | скорость активного сетевого интерфейса) <br> <code>Set-PoshTheme -Theme System-Performance -Save</code> <br> <code>Set-PoshTheme -Theme Pwsh-Process-Performance</code> время работы текущего процесса pwsh (процессорное время), количество работающих/общее (статус успех/ошибка) фоновых заданий, Working Set текущего процесса и всех процессов PowerShell в системе <br> <code>Set-PoshTheme -Theme Pwsh-Process-Performance -Save</code><h1 id=windows-terminal><a aria-label="Anchor link for: windows-terminal" class=zola-anchor href=#windows-terminal><i class=icon></i></a> Windows-Terminal</h1><h3 id=terminal-icons><a aria-label="Anchor link for: terminal-icons" class=zola-anchor href=#terminal-icons><i class=icon></i></a> Terminal-Icons</h3><p><code>Install-Module -Name Terminal-Icons -Repository PSGallery</code> <br> <code>scoop bucket add extras</code> <br> <code>scoop install terminal-icons</code><p><code>notepad $PROFILE</code> <br> <code>Import-Module -Name Terminal-Icons</code><p>Использует шрифты, которые необходимо установить и настроить в параметрах профиля PowerShell: <a href=https://github.com/ryanoasis/nerd-fonts>Nerd Fonts</a> <br> <a href=https://www.nerdfonts.com/font-downloads>Список шрифтов</a> <br> Скачать и установить шрифт похожий на Cascadia Code - <a href=https://github.com/ryanoasis/nerd-fonts/releases/download/v3.1.1/CascadiaCode.zip>CaskaydiaCove</a><p>Установить шрифт в конфигурацию Windows Terminal для PowerShell Core:<pre class="language-json z-code" data-lang=json><code class=language-json data-lang=json><span class="z-source z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>profiles<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>: 
</span><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-json">    </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>defaults<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> 
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-json">    </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>colorScheme<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>One Half Dark<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>experimental.retroTerminalEffect<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>font<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> 
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>size<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-float z-decimal z-json">10<span class="z-punctuation z-separator z-decimal z-json">.</span>0</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>useAtlasEngine<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json">    </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>list<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> 
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json">    </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-punctuation z-section z-sequence z-begin z-json">[</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">        <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> PowerShell Core
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">        <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>font<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> 
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">                </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>face<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>CaskaydiaMono Nerd Font<span class="z-punctuation z-definition z-string z-end z-json">"</span></span> <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> устанавливаем шрифт для работы Terminal-Icons
</span></span></span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>guid<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>{574e775e-4f2a-5b96-ac1e-a2962a402336}<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>hidden<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">false</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>name<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>PowerShell Core<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>source<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>Windows.Terminal.PowershellCore<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">        <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> WSL (Ubuntu)
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">        <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>guid<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>{2c4de342-38b7-51cf-b940-2309a097f518}<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>hidden<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">false</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>name<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>WSL<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>source<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>Windows.Terminal.Wsl<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">        <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> ssh
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">        <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>commandline<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ssh lifailon@192.168.1.100 -p 22<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>guid<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>{a3ec86f6-2bc1-59dd-814d-2a0d935af5f8}<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>icon<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>🐧<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>name<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>devops-01<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json">    <span class="z-punctuation z-section z-sequence z-end z-json">]</span></span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></code></pre><h3 id=custom-actions><a aria-label="Anchor link for: custom-actions" class=zola-anchor href=#custom-actions><i class=icon></i></a> Custom Actions</h3><p>Custom actions: https://learn.microsoft.com/ru-ru/windows/terminal/customize-settings/actions <br> Escape-последовательности: https://learn.microsoft.com/ru-ru/cpp/c-language/escape-sequences?view=msvc-170<pre class="language-json z-code" data-lang=json><code class=language-json data-lang=json><span class="z-source z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>actions<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>: 
</span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-punctuation z-section z-sequence z-begin z-json">[</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> 
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>copy<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>singleLine<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">false</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+c<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>paste<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Сохраняем классическую вставку интерпритатора, не заставляя выполнять код построчно
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+shift+v<span class="z-punctuation z-definition z-string z-end z-json">"</span></span> <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> default: ctrl+v
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>find<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+f<span class="z-punctuation z-definition z-string z-end z-json">"</span></span> <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> default: ctrl+shift+f
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> 
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>splitPane<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>split<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>left<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span> <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> default: auto
</span></span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>splitMode<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>duplicate<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+shift+d<span class="z-punctuation z-definition z-string z-end z-json">"</span></span> <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> default: alt+shift+d
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Очистить строку
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>sendInput<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>input<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span><span class="z-constant z-character z-escape z-json">\u0001</span><span class="z-constant z-character z-escape z-json">\u001b</span>[3~<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+k<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Очистить терминал
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>sendInput<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>input<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span><span class="z-constant z-character z-escape z-json">\u0001</span><span class="z-constant z-character z-escape z-json">\u001b</span>[3~clear<span class="z-constant z-character z-escape z-json">\r</span><span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+l<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Вставить шаблон модуля для перевода текста через Google Translate
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>sendInput<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>input<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span><span class="z-constant z-character z-escape z-json">\u0001</span><span class="z-constant z-character z-escape z-json">\u001b</span>[3~Get-Translate -Alternatives -Provider Google ''<span class="z-constant z-character z-escape z-json">\u001b</span>[D<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+g<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Вставить шаблон модуля для перевода текста через MyMemory
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>sendInput<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>input<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span><span class="z-constant z-character z-escape z-json">\u0001</span><span class="z-constant z-character z-escape z-json">\u001b</span>[3~Get-Translate -Alternatives -Provider MyMemory ''<span class="z-constant z-character z-escape z-json">\u001b</span>[D<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+q<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Быстрый перевод текста из буфера обмена
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>sendInput<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>input<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span><span class="z-constant z-character z-escape z-json">\u0001</span><span class="z-constant z-character z-escape z-json">\u001b</span>[3~Get-Translate -Alternatives -Provider MyMemory -Text $(Get-Clipboard)<span class="z-constant z-character z-escape z-json">\u001b</span>[D<span class="z-constant z-character z-escape z-json">\r</span><span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+shift+q<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-sequence z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Быстрый пинг dns google
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json">    <span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>command<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>action<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>sendInput<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>input<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span><span class="z-constant z-character z-escape z-json">\u0001</span><span class="z-constant z-character z-escape z-json">\u001b</span>[3~ping 8.8.8.8 -t<span class="z-constant z-character z-escape z-json">\r</span><span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>keys<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>ctrl+p<span class="z-punctuation z-definition z-string z-end z-json">"</span></span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></span><span class="z-source z-json"><span class="z-meta z-sequence z-json"><span class="z-punctuation z-section z-sequence z-end z-json">]</span></span>
</span></code></pre><h1 id=pandoc><a aria-label="Anchor link for: pandoc" class=zola-anchor href=#pandoc><i class=icon></i></a> Pandoc</h1><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>release_latest</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.github.com/repos/jgm/pandoc/releases/latest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>release_latest<span class="z-variable z-other z-member z-powershell">.assets</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> name <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>windows-x86_64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.browser_download_url
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\pandoc.zip
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\pandoc.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>DestinationPath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-support z-function z-powershell">Get-ChildItem</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\pandoc-*\*.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.FullName
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Copy-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>path</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Destination <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Windows\System32\pandoc.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\pandoc*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span></code></pre><p><code>pandoc -s README.md -o index.html</code> конвертация из Markdown в HTML <br> <code>pandoc README.md -o index.html --css=styles.css</code> применить стили из css <br> <code>pandoc -s index.html -o README.md</code> конвертация из HTML в Markdown <br> <code>pandoc -s README.md -o README.docx</code> конвертация в Word <br> <code>pandoc -s README.md -o README.epub</code> конвертация в открытый формат электронных версий книг <br> <code>pandoc -s README.md -o README.pdf</code> конвертация в PDF (требуется rsvg-convert) <br> <code>pandoc input.md -f markdown+hard_line_breaks -o output.md</code> конвертация из markdown документа, который не содержит обратный слэш в конце каждой строки для переноса (), который их добавит<h3 id=convert-excel-to-markdown><a aria-label="Anchor link for: convert-excel-to-markdown" class=zola-anchor href=#convert-excel-to-markdown><i class=icon></i></a> Convert Excel to Markdown</h3><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-Module</span> ImportExcel
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Import-Excel</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path srv.xlsx <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Export-Csv</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>csvFilePath</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>NoTypeInformation <span class="z-keyword z-operator z-assignment z-powershell">-</span>Encoding UTF8 <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> конвертация Excel в csv<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span><span class="z-source z-powershell">pandoc <span class="z-keyword z-operator z-assignment z-powershell">-</span>s <span class="z-keyword z-operator z-string-format z-powershell">-f</span> csv <span class="z-keyword z-operator z-assignment z-powershell">-</span>t markdown input.csv <span class="z-keyword z-operator z-assignment z-powershell">-</span>o output.md <span class="z-comment z-line z-powershell"><span class="z-punctuation z-definition z-comment z-powershell">#</span> конвертация таблицу csv в markdown<span class="z-punctuation z-definition z-comment z-powershell">
</span></span></span></code></pre><h1 id=ffmpeg><a aria-label="Anchor link for: ffmpeg" class=zola-anchor href=#ffmpeg><i class=icon></i></a> FFmpeg</h1><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>release_latest</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.github.com/repos/BtbN/FFmpeg-Builds/releases/latest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>release_latest<span class="z-variable z-other z-member z-powershell">.assets</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> name <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>ffmpeg-master-latest-win64-gpl.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.browser_download_url
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\ffmpeg<span class="z-keyword z-operator z-assignment z-powershell">-</span>master<span class="z-keyword z-operator z-assignment z-powershell">-</span>latest<span class="z-keyword z-operator z-assignment z-powershell">-</span>win64<span class="z-keyword z-operator z-assignment z-powershell">-</span>gpl.zip
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\ffmpeg-master-latest-win64-gpl.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>DestinationPath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Copy-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\ffmpeg-master-latest-win64-gpl\bin\ffmpeg.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Destination <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Windows\System32\ffmpeg.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\ffmpeg-*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span></code></pre><p><code>ffmpeg -i input.mp4 output.gif</code> конвертировать mp4 в gif <br> <code>ffmpeg -i input.mp4 -filter_complex "scale=1440:-1:flags=lanczos" output.gif</code> изменить разрешение на выходе <br> <code>ffmpeg -i input.mp4 -filter_complex "scale=1440:-1:flags=lanczos" -r 10 output.gif</code> изменить количество кадров в секунду на выходе <br> <code>ffmpeg -i input.mp4 -filter_complex "fps=5,scale=960:-1:flags=lanczos,split[s0][s1];[s0]palettegen=max_colors=32[p];[s1][p]paletteuse=dither=bayer" output.gif</code> сжатие за счет цветовой политры <br> <code>ffmpeg -i input.mp4 -ss 00:00:10 -frames:v 1 -q:v 1 output.jpg</code> вытащить скриншот из видео на 10 секунде <br> <code>ffmpeg -i input.mp4 -ss 00:00:05 -to 00:00:10 -c copy output.mp4</code> вытащить кусок видео <br> <code>ffmpeg -i "%d.jpeg" -framerate 2 -c:v libx264 -r 30 -pix_fmt yuv420p output.mp4</code> создать видео из фото (1.jpeg, 2.jpeg и т.д.) с framerate (частотой кадров) в создаваемом видео 2 кадра в секунду <br> <code>ffmpeg -i "rtsp://admin:password@192.168.3.201:554" -rtsp_transport tcp -c:v copy -c:a aac -strict experimental output.mp4</code> запись без перекодирования (copy) RTSP-потока с камеры видеонаблюдения (+ аудио в кодеке AAC) в файл <br> <code>ffmpeg -i "rtsp://admin:password@192.168.3.201:554" -rtsp_transport tcp -c:v copy -c:a aac -strict experimental -movflags +faststart+frag_keyframe+empty_moov output.mp4</code> переместить метаданные в начало файла, что позволяет начать воспроизведение файла в видеоплеере до его полной загрузки <br> <code>ffmpeg -i "rtsp://admin:password@192.168.3.201:554" -rtsp_transport tcp -frames:v 1 -c:v mjpeg output.jpg</code> сделать скриншот <br> <code>ffmpeg -i input.mp4 -vf "pad=width=iw:height=ih+100:x=0:y=100:color=black" -c:a copy output.mp4</code> width=iw: (ширина видео остается как у исходного файла), height=ih+100 (высота видео увеличивается на 100 пикселей), x=0 (горизонтальное смещение установлено в 0), y=100 (вертикальное смещение установлено в 100 пикселей вниз, чтобы добавить черное пространство сверху), color=black (цвет добавленного пространства — черный)<h1 id=handbrake><a aria-label="Anchor link for: handbrake" class=zola-anchor href=#handbrake><i class=icon></i></a> HandBrake</h1><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://github.com/HandBrake/HandBrake/releases/download/1.8.0/HandBrakeCLI-1.8.0-win-x86_64.zip<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\HandBrakeCLI.zip
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Expand-Archive</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\HandBrakeCLI.zip <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutputPath <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Copy-Item</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Path <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\HandBrakeCLI.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Destination <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Windows\System32\HandBrakeCLI.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\doc<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Force <span class="z-keyword z-operator z-assignment z-powershell">-</span>Recurse
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Remove-Item</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads\HandBrakeCLI*<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre><p><code>HandBrakeCLI -i input.mp4 -o output.mkv</code> конвертирует видео в формате mp4 в формат mkv с использованием стандартных настроек HandBrake <br> <code>HandBrakeCLI -i input.mp4 -o output.mkv -q 20</code> установить качество видео 20, значения варьируются от 0 (максимальное качество) до 51 (минимальное качество), где 20 считается хорошим качеством для большинства видео <br> <code>HandBrakeCLI -i input.mp4 -o output.mkv -r 30</code> установить частоту кадров на 30 fps <br> <code>HandBrakeCLI -i input.mp4 -o output.mkv --maxWidth 1280 --maxHeight 720</code> изменить размер на 1280х720 <br> <code>HandBrakeCLI -i input.mp4 -o output.mkv -b 1500</code> установить битрейт видео 1500 кбит/с <br> <code>HandBrakeCLI -i input.mp4 -o output.mkv -e x264</code> преобразовать видео с использованием кодека x264 <br> <code>HandBrakeCLI -i input.mp4 -o output.mp4 --crop 0:200:0:0</code> обрезать видео снизу на 200px (верх:низ:лево:право) <br> <code>HandBrakeCLI -i input.mp4 -o output.mp4 --start-at duration:5 --stop-at duration:15</code> обрезать видео (на выходе будет 15-секундное видео с 5 по 20 секунду)<h1 id=imagemagick><a aria-label="Anchor link for: imagemagick" class=zola-anchor href=#imagemagick><i class=icon></i></a> ImageMagick</h1><p>Source: <a href=https://sourceforge.net/projects/imagemagick>ImageMagick</a><p><code>magick identify -verbose PowerShell-Commands.png</code> извлечь метаданные изображения <br> <code>magick PowerShell-Commands.png output.jpg</code> конвертация формата изображения <br> <code>magick PowerShell-Commands.png -resize 800x600 output.jpg</code> изменить размер (увеличить или уменьшить) <br> <code>magick PowerShell-Commands.png -crop 400x300+100+50 output.jpg</code> обрезать <br> <code>magick PowerShell-Commands.png -rotate 90 output.jpg</code> повернуть изображение <br> <code>magick PowerShell-Commands.png -fill white -pointsize 24 -gravity center -annotate +0+0 "PowerShell" output.jpg</code> наложить текст на изображение <br> <code>magick PowerShell-Commands.png -brightness-contrast +20x+10 output.jpg</code> изменить яркость и контрастность <br> <code>magick convert -delay 100 1.png 2.png 3.png output.gif</code> создать gif из изображений <br> <code>magick convert image1.jpg image2.jpg -append output.jpg</code> вертикально объединенить изображения<h1 id=youtube><a aria-label="Anchor link for: youtube" class=zola-anchor href=#youtube><i class=icon></i></a> YouTube</h1><pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>release_latest</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://api.github.com/repos/yt-dlp/yt-dlp/releases/latest<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>release_latest<span class="z-variable z-other z-member z-powershell">.assets</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> name <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>yt-dlp.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.browser_download_url
</span><span class="z-source z-powershell"><span class="z-support z-function z-powershell">Invoke-RestMethod</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>OutFile <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>C:\Windows\System32\yt-dlp.exe<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span></code></pre><p><code>yt-dlp -F https://www.youtube.com/watch?v=gxplizjhqiw</code> отобразить список всех доступных форматов <br> <code>yt-dlp -J https://www.youtube.com/watch?v=gxplizjhqiw</code> вывести данные в формате JSON <br> <code>yt-dlp -J https://www.youtube.com/watch?v=gxplizjhqiw | jq -r .formats.[].format</code> id - resolution (format_note) <br> <code>yt-dlp -f 137 https://www.youtube.com/watch?v=gxplizjhqiw</code> загрузить только видео в указанном формате по id <br> <code>yt-dlp -f bestaudio https://www.youtube.com/watch?v=gxplizjhqiw</code> загрузить только аудио <br> <code>yt-dlp -f best https://www.youtube.com/watch?v=gxplizjhqiw</code> загрузить видео с аудио в лучшем качестве <br> <code>yt-dlp -f 'bestvideo[height<=1080]+bestaudio/best[height<=1080]' https://www.youtube.com/watch?v=gxplizjhqiw</code> загрузить в указанном качестве <br> <code>yt-dlp -r 2m https://www.youtube.com/watch?v=gxplizjhqiw</code> ограничить скорость загрузки до 2 МБит/с<pre class="language-PowerShell z-code" data-lang=PowerShell><code class=language-PowerShell data-lang=PowerShell><span class="z-source z-powershell"><span class="z-meta z-function z-powershell"><span class="z-storage z-type z-powershell">function</span> <span class="z-entity z-name z-function z-powershell">Get-YouTube</span></span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-keyword z-control z-powershell">param</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell">
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">        <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-interpolated z-simple z-source z-powershell">    </span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> yt<span class="z-keyword z-operator z-assignment z-powershell">-</span>dlp <span class="z-keyword z-operator z-assignment z-powershell">-</span>J <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>url</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>result</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">ConvertFrom-Json</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span>.formats <span class="z-keyword z-operator z-other z-powershell">|</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Where-Object</span> filesize <span class="z-keyword z-operator z-comparison z-powershell">-ne</span> <span class="z-constant z-language z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>null</span> <span class="z-keyword z-operator z-other z-powershell">|</span> 
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-support z-function z-powershell">Select-Object</span> format_id<span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    <span class="z-meta z-hashtable z-powershell"><span class="z-keyword z-other z-hashtable z-begin z-powershell">@</span><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Name</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>FileSize<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-terminator z-statement z-powershell">;</span> 
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">        <span class="z-meta z-hashtable z-assignment z-powershell"><span class="z-variable z-other z-readwrite z-powershell">Expression</span><span class="z-keyword z-operator z-assignment z-powershell">=</span></span><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">string</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">int</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-variable z-automatic z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>_<span class="z-variable z-other z-member z-powershell">.filesize</span></span> <span class="z-keyword z-operator z-assignment z-powershell">/</span> <span class="z-constant z-numeric z-integer z-powershell">1024</span><span class="z-keyword z-other z-powershell">kb</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span>.ToString<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>0.0<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span> Mb<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-meta z-hashtable z-powershell">    <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span><span class="z-keyword z-operator z-other z-powershell">,</span>
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell">    resolution<span class="z-keyword z-operator z-other z-powershell">,</span>format_note<span class="z-keyword z-operator z-other z-powershell">,</span>quality<span class="z-keyword z-operator z-other z-powershell">,</span>fps<span class="z-keyword z-operator z-other z-powershell">,</span>ext<span class="z-keyword z-operator z-other z-powershell">,</span>language
</span></span><span class="z-source z-powershell"><span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span><span class="z-source z-powershell">
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>formats</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-support z-function z-powershell">Get-YouTube</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>https://www.youtube.com/watch?v=gxplizjhqiw<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>video</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>formats</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> format_note <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-constant z-numeric z-integer z-powershell">1080</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> ext <span class="z-keyword z-operator z-comparison z-powershell">-match</span> mp4<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.format_id
</span><span class="z-source z-powershell"><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>audio</span> <span class="z-keyword z-operator z-assignment z-powershell">=</span> <span class="z-meta z-group z-complex z-subexpression z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>formats</span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> resolution <span class="z-keyword z-operator z-comparison z-powershell">-match</span> <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span>audio<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span> <span class="z-keyword z-operator z-other z-powershell">|</span> <span class="z-support z-function z-powershell">Where-Object</span> ext <span class="z-keyword z-operator z-comparison z-powershell">-match</span> m4a<span class="z-punctuation z-section z-group z-end z-powershell">)</span></span><span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-constant z-numeric z-integer z-powershell">-1</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>.format_id
</span><span class="z-source z-powershell">cd <span class="z-string z-quoted z-double z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">"</span><span class="z-support z-constant z-variable z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>home</span>\Downloads<span class="z-punctuation z-definition z-string z-end z-powershell">"</span></span>
</span><span class="z-source z-powershell">yt<span class="z-keyword z-operator z-assignment z-powershell">-</span>dlp <span class="z-keyword z-operator z-string-format z-powershell">-f</span> <span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>video</span><span class="z-keyword z-operator z-assignment z-powershell">+</span><span class="z-variable z-other z-readwrite z-powershell"><span class="z-punctuation z-definition z-variable z-powershell">$</span>audio</span> https:<span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-keyword z-operator z-assignment z-powershell">/</span><span class="z-support z-function z-powershell">www.youtube.com</span><span class="z-keyword z-operator z-assignment z-powershell">/</span>watch?v<span class="z-keyword z-operator z-assignment z-powershell">=</span>gxplizjhqiw <span class="z-keyword z-operator z-assignment z-powershell">-</span>o <span class="z-string z-quoted z-single z-powershell"><span class="z-punctuation z-definition z-string z-begin z-powershell">'</span>%(title)s.%(ext)s<span class="z-punctuation z-definition z-string z-end z-powershell">'</span></span>
</span></code></pre><span class=hidden id=copy-code-text>Copy Code</span><span class=hidden id=search-index>https://lifailon.github.io/search_index.en.json</span><span class=hidden id=more-matches-text>$MATCHES more matches</span></main><footer id=site-footer><nav><ul><li><a class=active href=https://lifailon.github.io/powershell/>PowerShell</a><li><a href=https://lifailon.github.io/linux/>Linux</a><li><a href=https://lifailon.github.io/docker/>Docker</a><li><a href=https://lifailon.github.io/golang/>GoLang</a><li><a href=https://lifailon.github.io/node-js/>Node.js</a><li><a href=https://lifailon.github.io/network/>Network</a><li><a href=https://lifailon.github.io/windowsserver/>Windows Server</a><li><a href=https://lifailon.github.io/database/>Database</a><li><a href=https://lifailon.github.io/api/>API</a><li><a href=https://lifailon.github.io/devops/>DevOps</a></ul></nav><p>© <strong>2023-2025</strong> <code>Lifailon</code><p><a class=external href=https://github.com/Lifailon/PS-Commands>Website source</a><p><small>Powered by <a class="link external" href=https://www.getzola.org>Zola</a> and <a class="link external" href=https://duckquill.daudix.one>Duckquill</a> </small><ul id=socials><li><a rel=" me" href=https://github.com/lifailon/PS-Commands title=GitHub> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34)" class=icon></i> <span>GitHub</span> </a><li><a rel=" me" href=https://www.nuget.org/profiles/Lifailon title=NuGet> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ENUGet%3C/title%3E%3Cpath d='M1.57 0A1.57 1.57 0 000 1.57v20.86A1.57 1.57 0 001.57 24h20.86A1.57 1.57 0 0024 22.43V1.57A1.57 1.57 0 0022.43 0zM7.5 1.5A2.5 2.5 0 0110 4a2.5 2.5 0 01-2.5 2.5A2.5 2.5 0 015 4a2.5 2.5 0 012.5-2.5zM12 6h9v12h-1.5a3.76 3.76 0 00-2.81-1.25A3.76 3.76 0 0012.5 20a3.76 3.76 0 002.19 3.25A3.76 3.76 0 0018.5 24H21V6z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>NuGet</span> </a><li><a rel=" me" href=https://www.npmjs.com/~lifailon title=NPM> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ENPM%3C/title%3E%3Cpath d='M0 0v24h24V0zm14.74 14.74h-3.66v-5.5h-1.83v5.5H5.5V5.5h9.24z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>NPM</span> </a><li><a rel=" me" title="Docker Hub" href=https://hub.docker.com/u/lifailon> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EDocker%3C/title%3E%3Cpath d='M22.149 10.74c-.111-.086-1.15-.86-3.3-.86-.26.002-.52.017-.78.045-.24-1.35-1.32-1.8-1.35-1.81l-.45-.17-.3.42c-.17.24-.65.88-.65 1.76.001.29.04.58.12.86-.66.19-1.3.35-1.95.48a9.72 9.72 0 0 1-1.95.22H.75c-.41 0-.75.34-.75.75 0 4.42 2.4 5.98 4.41 6.68.9.28 1.91.42 3.01.42 1.08 0 2.11-.14 3.01-.42 1.98-.61 3.51-2.01 4.14-4.01.34.04.68.07 1.02.07 1.35 0 2.61-.35 3.72-1.04 1.64-1.01 1.87-2.23 1.87-2.92.01-.96-.34-1.68-.35-1.7zM6.75 8.22h2.25c.14 0 .25-.11.25-.25V6.47c0-.14-.11-.25-.25-.25H6.75c-.14 0-.25.11-.25.25v1.5c0 .14.11.25.25.25zM12 8.22h2.25c.14 0 .25-.11.25-.25V6.47c0-.14-.11-.25-.25-.25H12c-.14 0-.25.11-.25.25v1.5c0 .14.11.25.25.25zM9.375 6.72h-2.25c-.14 0-.25.11-.25.25v1.5c0 .14.11.25.25.25h2.25c.14 0 .25-.11.25-.25v-1.5c0-.14-.11-.25-.25-.25zM12 5.47h-2.25c-.14 0-.25.11-.25.25v1.5c0 .14.11.25.25.25H12c.14 0 .25-.11.25-.25v-1.5c0-.14-.11-.25-.25-.25z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>Docker Hub</span> </a></ul></footer>