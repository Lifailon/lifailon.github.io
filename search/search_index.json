{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p> \u0411\u043e\u043b\u044c\u0448\u0430\u044f \u0431\u0430\u0437\u0430 \u0437\u0430\u043c\u0435\u0442\u043e\u043a PowerShell \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u043e\u043c \u044f\u0437\u044b\u043a\u0435. </p> <p>\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u044f\u0437\u044b\u043a\u0430, \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0441 \u043a\u043e\u043c\u0430\u043d\u0434\u043b\u0435\u0442\u043e\u0432 \u0438 \u043c\u043e\u0434\u0443\u043b\u0435\u0439, \u0440\u0430\u0431\u043e\u0442\u0430 \u0441 \u043e\u0431\u044a\u0435\u043a\u0442\u0430\u043c\u0438, \u0434\u0430\u043d\u043d\u044b\u043c\u0438, \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439, \u0441\u0435\u0442\u0435\u0432\u044b\u043c\u0438 \u0443\u0442\u0438\u043b\u0438\u0442\u0430\u043c\u0438, \u0431\u0430\u0437\u0430\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u0445, REST API, \u043a\u043b\u0430\u0441\u0441\u0430\u043c\u0438 \u0438 \u043c\u0435\u0442\u043e\u0434\u0430\u043c\u0438 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u044b .NET, \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u043c\u0438 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u0433\u043e \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (Active Directory, MS Exchange, Hyper-V, VMWare). \u0417\u0430\u043c\u0435\u0442\u043a\u0438 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u044b \u043d\u0430 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u043e\u0432 \u0438 \u043a\u0440\u0430\u0442\u043a\u043e\u0433\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f.</p> <p>\u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043d\u0430\u0431\u043e\u0440 \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u0445 \u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0432 \u0438 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u0430\u0432\u0442\u043e\u0440\u0430, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0439 \u0441\u0442\u0435\u043d\u0434 WinForms \u0441 \u043f\u0440\u0438\u043c\u0435\u0440\u0430\u043c\u0438 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0431\u043e\u043b\u044c\u0448\u0438\u043d\u0441\u0442\u0432\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u0430 (DataGridView, Button, Checkbox \u0438 \u0442.\u0434.), \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u0430\u043a \u0448\u0430\u0431\u043b\u043e\u043d \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b \u0441 \u0433\u0440\u0430\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u043c.</p> <ul> <li>\ud83d\udcac 20.05.2024: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0437\u0430\u043c\u0435\u0442\u043a\u0438 \u043f\u043e \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \ud83d\udc33 Docker</li> <li>\ud83d\udcac 15.07.2024: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0437\u0430\u043c\u0435\u0442\u043a\u0438 \u043f\u043e \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u043c\u0438 \u043a\u043e\u043c\u0430\u043d\u0434\u0430\u043c\u0438 \u0438 \u043a\u043e\u043d\u0441\u043e\u043b\u044c\u043d\u044b\u043c\u0438 \u0443\u0442\u0438\u043b\u0438\u0442\u0430\u043c\u0438 \ud83d\udc27 Linux</li> </ul> <p>\u0414\u0440\u0443\u0433\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u044b \u043d\u0430 PowerShell:</p> <ul> <li> <p>REST API \u0438 Web-\u0441\u0435\u0440\u0432\u0435\u0440 (\u0441\u0442\u0430\u0442\u044c\u044f \u043d\u0430 \u0425\u0430\u0431\u0440) \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u041e\u0421 Windows \u0447\u0435\u0440\u0435\u0437 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u0438\u043b\u0438 REST-\u043a\u043b\u0438\u0435\u043d\u0442 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, curl \u0432 Linux). \u0417\u0430\u043f\u0443\u0441\u043a \u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0441\u043b\u0443\u0436\u0431 \u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432, \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0441\u0438\u0441\u0442\u0435\u043c\u0435, \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0438 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 (\u043b\u043e\u0433\u043e\u0432) \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 \u0438 \u0442.\u0434.</p> </li> <li> <p>Syslog \u0441\u0435\u0440\u0432\u0435\u0440 \u0438 \u043a\u043b\u0438\u0435\u043d\u0442 \u043d\u0430 \u0431\u0430\u0437\u0435 .NET \u0438 PowerShell.</p> </li> <li> <p>Remote Shadow Administrator. \u0418\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0442\u0435\u043a\u0443\u0449\u0438\u043c RDP-\u0441\u0435\u0441\u0441\u0438\u044f\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043d\u0430 \u0431\u0430\u0437\u0435 RDShadow. \u0422\u0430\u043a\u0436\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043d\u0430\u0431\u043e\u0440 \u043c\u043e\u0434\u0443\u043b\u0435\u0439, \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043d\u0430 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u044e \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u041e\u0421 Windows (\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b, \u0441\u043b\u0443\u0436\u0431\u044b, \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f, \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 KMS, NTP \u0438 \u0442.\u0434.).</p> </li> <li> <p>\u0413\u0440\u0430\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0434\u043b\u044f iperf3 \u0438 \u043c\u043e\u0434\u0443\u043b\u044c psiperf \u0434\u043b\u044f \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u043d\u043e\u0439 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u043a\u0430\u043d\u0430\u043b\u0430 \u0441\u0432\u044f\u0437\u0438.</p> </li> <li> <p>AD Manager. \u0424\u043e\u0440\u043c\u0430 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0432 Active Directory \u0438 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0445 \u044f\u0449\u0438\u043a\u043e\u0432 Exchange, \u0441 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0430\u0437\u043e\u0432\u043e\u0433\u043e \u043e\u0442\u0447\u0435\u0442\u0430, \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0433\u0440\u0443\u043f\u043f\u0430\u043c\u0438 \u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438.</p> </li> <li> <p>PST Export GUI. \u0413\u0440\u0430\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0431\u0430\u0437 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0445 \u044f\u0449\u0438\u043a\u043e\u0432 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445 Exchange 2010-2016, \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0438 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f Message Tracking Log, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u043d\u044f\u043c\u0438 \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0430 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0445 \u044f\u0449\u0438\u043a\u043e\u0432 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442 PST.</p> </li> <li> <p>VMWare Inventory. \u0413\u0440\u0430\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0438\u043d\u0435\u0440\u0444\u0435\u0439\u0441 \u0440\u0435\u0430\u043b\u0438\u0437\u0443\u044e\u0449\u0438\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u043e\u0442\u0447\u0435\u0442\u0430 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d, \u0434\u0438\u0441\u043a\u043e\u0432, ESXi \u0445\u043e\u0441\u0442\u043e\u0432, \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0446\u0435\u043d\u0442\u0440\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u043f\u0438\u0442\u0430\u043d\u0438\u0435\u043c (\u043d\u0430 \u0431\u0430\u0437\u0435 WinForms \u0438 \u043c\u043e\u0434\u0443\u043b\u044f PowerCLI).</p> </li> <li> <p>WinEvent Viewer. \u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0438 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 (\u043b\u043e\u0433\u043e\u0432) \u041e\u0421 Windows.</p> </li> <li> <p>DNS Change Tray. \u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430 \u0434\u043b\u044f \u0431\u044b\u0441\u0442\u0440\u043e\u0439 \u0441\u043c\u0435\u043d\u044b DNS-\u0430\u0434\u0440\u0435\u0441\u0430 \u043d\u0430 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c \u0441\u0435\u0442\u0435\u0432\u043e\u043c \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0435 \u0432 \u0442\u0440\u0435\u0435.</p> </li> <li> <p>ACL-Backup. \u0420\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0435 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u043f\u0440\u0430\u0432 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b NTFS \u0432 txt-\u0444\u0430\u0439\u043b \u0441 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f.</p> </li> <li> <p>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f InfluxDB 1.x \u0438 PowerShell \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0431\u0430\u0437\u0430\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u0445, \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0430\u043c\u0438 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438 \u0438 \u0442\u0430\u0431\u043b\u0438\u0446\u0430\u043c\u0438, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0432\u044b\u0432\u043e\u0434 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u0439 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430.</p> </li> <li> <p>\u0421\u0446\u0435\u043d\u0430\u0440\u0438\u0439 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u0432\u0441\u0435\u0445 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 Selenium \u0447\u0435\u0440\u0435\u0437 PowerShell \u0438 \u043c\u043e\u0434\u0443\u043b\u0438 \u0434\u043b\u044f AI (GPT), SpeedTest \u0438 Translation \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0440\u0430\u0437\u043d\u044b\u0445 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432. \u0421\u0442\u0430\u0442\u044c\u044f \u043d\u0430 habr PowerShell \u0438 Selenium. \u041f\u0440\u043e\u0449\u0435, \u0447\u0435\u043c \u043a\u0430\u0436\u0435\u0442\u0441\u044f.</p> </li> <li> <p>\u041c\u043e\u0434\u0443\u043b\u044c \u0434\u043b\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0431\u043e\u0440\u0430 \u043c\u0435\u0442\u0440\u0438\u043a \u0442\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u044b, \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u0434\u0430\u0442\u0447\u0438\u043a\u043e\u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0447\u0435\u0440\u0435\u0437 LibreHardwareMonitor \u0438 OpenHardwareMonitor. \u0421\u0442\u0430\u0442\u044c\u044f \u043d\u0430 habr \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0442\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u044b Windows (\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043c\u0435\u0442\u0440\u0438\u043a, \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 InfluxDB \u0438 Grafana).</p> </li> <li> <p>PSEverything. \u041c\u043e\u0434\u0443\u043b\u044c \u043c\u043d\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432 \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0445 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u0445 Windows \u0447\u0435\u0440\u0435\u0437 Everything \u0438 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 .NET. </p> </li> <li> <p>\u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0434\u043b\u044f CrystalDiskInfo.</p> </li> <li> <p>Console-Translate. \u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0430 \u0442\u0435\u043a\u0441\u0442\u0430 (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 3 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 \u0438 \u0440\u0435\u0436\u0438\u043c \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0438\u0441\u0445\u043e\u0434\u043d\u043e\u0433\u043e \u044f\u0437\u044b\u043a\u0430).</p> </li> <li> <p>Console-Download. \u0418\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0444\u0430\u0439\u043b\u043e\u0432 \u0438\u0437 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430 URL-\u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u0432 \u043c\u043d\u043e\u0433\u043e\u043f\u043e\u0442\u043e\u0447\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438. \u0420\u0435\u0430\u043b\u0438\u0437\u0443\u0435\u0442 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u043d\u043e\u0439 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 \u0447\u0435\u0440\u0435\u0437 \u0445\u043e\u0441\u0442\u044b Looking Glass (\u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 Looking.House) \u0441 \u0446\u0435\u043b\u044c\u044e \u043e\u0442\u043b\u0430\u0434\u043a\u0438 \u0434\u0430\u0442\u0447\u0438\u043a\u043e\u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u0441\u0435\u0442\u0438 \u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442.</p> </li> <li> <p>PSDomainTest \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f DNS-\u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u0434\u043e\u043c\u0435\u043d\u0430 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c API ZoneMaster \u0438 \u043a\u0440\u043e\u0441\u0441\u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0435\u043d\u043d\u044b\u0439 \u043c\u043e\u0434\u0443\u043b\u044c \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a ping, http, tcp, udp \u043d\u0430 \u0445\u043e\u0441\u0442\u0430\u0445 \u0432 \u0441\u0435\u0442\u0438 \u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0435 \u0447\u0435\u0440\u0435\u0437 API Check-Host.</p> </li> <li> <p>\u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u043d\u043e\u0439 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u0441\u0435\u0442\u0438 \u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442 \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 Ookla SpeedTest (\u0431\u0435\u0437 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f API \u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439) \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u043c\u0435\u0442\u0440\u0438\u043a \u0432 InfluxDB \u0438 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0432 Grafana.</p> </li> <li> <p>Veeam Backup &amp; Replication: \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0437\u0430\u0434\u0430\u043d\u0438\u0439, \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0435\u0432 \u0438 \u0438\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438.</p> </li> <li> <p>\u0428\u0430\u0431\u043b\u043e\u043d Zabbix \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0438 \u043d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0445 \u0441\u0435\u0441\u0441\u0438\u0439 \u043d\u0430 \u043c\u0430\u0448\u0438\u043d\u0430\u0445 \u0441 \u041e\u0421 Windows \u0438 Windows Server \u0447\u0435\u0440\u0435\u0437 \u043c\u043e\u0434\u0443\u043b\u044c Get-Query.</p> </li> <li> <p>\u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043e\u043f\u043e\u0432\u0435\u0449\u0435\u043d\u0438\u0439 \u043e \u0438\u0441\u0442\u0435\u0447\u0435\u043d\u0438\u0438 \u0441\u0440\u043e\u043a\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u0439 \u0432 It-Invent \u0447\u0435\u0440\u0435\u0437 \u0421\u0423\u0411\u0414 MS SQL.</p> </li> <li> <p>Get Invent SQLite. \u041c\u043e\u0434\u0443\u043b\u044c \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0430 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430\u0445 \u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 WMI \u0434\u043b\u044f \u043d\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 SQLite.</p> </li> <li> <p>\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 Excel-\u0442\u0430\u0431\u043b\u0438\u0446 \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439 \u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438 \u0441\u0440\u043e\u043a\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u0439 \u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043c.</p> </li> <li> <p>RDCMan-LDAP. \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441\u043f\u0438\u0441\u043a\u0430 \u0432\u0441\u0435\u0445 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043e\u0432 \u0441 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043c\u0435\u0441\u0442\u043e\u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435\u043c \u0432 \u0434\u043e\u043c\u0435\u043d\u043d\u043e\u0439 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0435 \u0438\u0437 Active Directory.</p> </li> <li> <p>ConvertTo-Base64. \u041a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0442\u0435\u043a\u0441\u0442\u0430 \u0438 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0439 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442 Base64.</p> </li> <li> <p>\u0411\u0440\u0430\u0443\u0437\u0435\u0440 \u043a\u043b\u0430\u0441\u0441\u043e\u0432 WMI.</p> </li> </ul>"},{"location":"#_1","title":"Home","text":""},{"location":"API/","title":"API","text":""},{"location":"API/#property","title":"Property","text":"<p><code>$url = \"https://habr.com/ru/rss/users/Lifailon/publications/articles/?fl=ru\"</code> RSS \u043b\u0435\u043d\u0442\u0430 \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u0439 \u043d\u0430 Habr  <code>Invoke-RestMethod $url</code> <code>$iwr = Invoke-WebRequest -Uri $url</code> <code>$iwr | Get-Member</code> <code>$iwr.Content</code> <code>$iwr.StatusCode -eq 200</code> <code>$iwr.Headers</code> <code>$iwr.ParsedHtml | Select lastModified</code> <code>$iwr.Links | fl title,innerText,href</code> <code>$iwr.Images.src</code></p>"},{"location":"API/#methods","title":"Methods","text":"<p>GET - Read  POST - Create  PATCH - Partial update/modify  PUT - Update/replace  DELETE - Remove</p>"},{"location":"API/#download-image","title":"Download Image","text":"<pre><code>function Download-Image {\nparam (\n    [Parameter(Mandatory = $True)]$url\n)\n    $folder = $url -replace \"http.+://\" -replace \"/\",\"-\" -replace \"-$\"\n    $path = \"$home\\Pictures\\$folder\"\n    if (Test-Path $path) {\n        Remove-Item $path -Recurse -Force\n        New-Item -ItemType Directory $path &gt; $null\n    } else {\n        New-Item -ItemType Directory $path &gt; $null\n    }\n    $irm = Invoke-WebRequest -Uri $url\n    foreach ($img in $irm.Images.src) {\n        $name = $img -replace \".+/\"\n        Start-Job {\n            Invoke-WebRequest $using:img -OutFile \"$using:path\\$using:name\"\n        } &gt; $null\n    }\n    while ($True){\n        $status_job = (Get-Job).State[-1]\n        if ($status_job -like \"Completed\"){\n        Get-Job | Remove-Job -Force\n        break\n    }}\n    $count_all = $irm.Images.src.Count\n    $count_down = (Get-Item $path\\*).count\n    \"Downloaded $count_down of $count_all files to $path\"\n}\n</code></pre> <p><code>Download-Image -url https://losst.pro/</code></p>"},{"location":"API/#token","title":"Token","text":"<pre><code>https://veeam-11:9419/swagger/ui/index.html\n$Header = @{\n    \"x-api-version\" = \"1.0-rev2\"\n}\n$Body = @{\n    \"grant_type\" = \"password\"\n    \"username\" = \"$login\"\n    \"password\" = \"$password\"\n}\n$vpost = iwr \"https://veeam-11:9419/api/oauth2/token\" -Method POST -Headers $Header -Body $Body -SkipCertificateCheck\n$vtoken = (($vpost.Content) -split '\"')[3]\n</code></pre>"},{"location":"API/#get","title":"GET","text":"<pre><code>$token = $vtoken | ConvertTo-SecureString -AsPlainText \u2013Force\n$vjob = iwr \"https://veeam-11:9419/api/v1/jobs\" -Method GET -Headers $Header -Authentication Bearer -Token $token -SkipCertificateCheck\n\n$Header = @{\n    \"x-api-version\" = \"1.0-rev1\"\n    \"Authorization\" = \"Bearer $vtoken\"\n}\n$vjob = iwr \"https://veeam-11:9419/api/v1/jobs\" -Method GET -Headers $Header -SkipCertificateCheck\n$vjob = $vjob.Content | ConvertFrom-Json\n\n$vjob = Invoke-RestMethod \"https://veeam-11:9419/api/v1/jobs\" -Method GET -Headers $Header -SkipCertificateCheck\n$vjob.data.virtualMachines.includes.inventoryObject\n</code></pre>"},{"location":"API/#cookie","title":"Cookie","text":"<p>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c hash \u0442\u043e\u0440\u0440\u0435\u043d\u0442 \u0444\u0430\u0439\u043b\u0430 \u043d\u0430 \u0441\u0430\u0439\u0442\u0435 \u041a\u0438\u043d\u043e\u0437\u0430\u043b</p> <pre><code>function Get-KinozalTorrentHash {\n    param (\n        [Parameter(Mandatory = $True)][string]$id,\n        [Parameter(Mandatory = $True)][string]$cookies\n    )\n    $url = \"https://kinozal.tv/get_srv_details.php?id=$($id)&amp;action=2\"\n    $cookies = \"uid=...+\"\n    $headers = @{\n        \"User-Agent\" = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36\"\n        \"Cookie\" = $cookies\n    }\n    $result = Invoke-RestMethod -Uri $url -Headers $headers -Method Get\n    $result -match \"\u0418\u043d\u0444\u043e \u0445\u0435\u0448: (.+)&lt;/li&gt;&lt;li&gt;\u0420\u0430\u0437\u043c\u0435\u0440\" | Out-Null\n    return $Matches[1]\n}\n</code></pre> <p><code>$id = 1656552</code> <code>$cookies = \"uid=...\"</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c cookie \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 \u043d\u0430 \u0432\u043a\u043b\u0430\u0434\u043a\u0435 \u0441\u0435\u0442\u044c \u0438\u0437 \u0437\u0430\u0433\u043b\u043e\u0432\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043f\u043e\u0441\u043b\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043d\u0430 \u0441\u0430\u0439\u0442\u0435  <code>Get-KinozalTorrentHash $id $cookies</code></p>"},{"location":"API/#pode","title":"Pode","text":"<pre><code>Start-PodeServer {\n    Add-PodeEndpoint -Address localhost -Port \"8080\" -Protocol \"HTTP\"\n    ## Get info endpoints\n    Add-PodeRoute -Path \"/\" -Method \"GET\" -ScriptBlock {\n        Write-PodeJsonResponse -Value @{\n        \"service\"=\"/api/service\";\n        \"process\"=\"/api/process\"\n        }\n    }\n    ## GET\n    Add-PodeRoute -Path \"/api/service\" -Method \"GET\" -ScriptBlock {\n        Write-PodeJsonResponse -Value $(\n            Get-Service | Select-Object Name,@{\n                Name=\"Status\"; Expression={[string]$_.Status}\n            },@{\n                Name=\"StartType\"; Expression={[string]$_.StartType}\n            } | ConvertTo-Json\n        )\n    }\n    Add-PodeRoute -Path \"/api/process\" -Method \"GET\" -ScriptBlock {\n        Write-PodeJsonResponse -Value $(\n            Get-Process | Sort-Object -Descending CPU | Select-Object -First 15 ProcessName,\n            @{Name=\"ProcessorTime\"; Expression={$_.TotalProcessorTime -replace \"\\.\\d+$\"}},\n            @{Name=\"Memory\"; Expression={[string]([int]($_.WS / 1024kb))+\"MB\"}},\n            @{Label=\"RunTime\"; Expression={((Get-Date) - $_.StartTime) -replace \"\\.\\d+$\"}}\n        )\n    }\n    Add-PodeRoute -Path \"/api/process-html\" -Method \"GET\" -ScriptBlock {\n        Write-PodeHtmlResponse -Value (\n            Get-Process | Sort-Object -Descending CPU | Select-Object -First 15 ProcessName,\n            @{Name=\"ProcessorTime\"; Expression={$_.TotalProcessorTime -replace \"\\.\\d+$\"}},\n            @{Name=\"Memory\"; Expression={[string]([int]($_.WS / 1024kb))+\"MB\"}},\n            @{Label=\"RunTime\"; Expression={((Get-Date) - $_.StartTime) -replace \"\\.\\d+$\"}} # Auto ConvertTo-Html\n        )\n    }\n    ## POST\n    Add-PodeRoute -Path \"/api/service\" -Method \"POST\" -ScriptBlock {\n        # https://pode.readthedocs.io/en/latest/Tutorials/WebEvent/\n        # $WebEvent | Out-Default\n        $Value = $WebEvent.Data[\"ServiceName\"]\n        $Status = (Get-Service -Name $Value).Status\n        Write-PodeJsonResponse -Value @{\n            \"Name\"=\"$Value\";\n            \"Status\"=\"$Status\";\n        }\n    }\n}\n</code></pre> <p><code>irm http://localhost:8080/api/service -Method Get</code> <code>irm http://localhost:8080/api/process -Method Get</code> <code>http://localhost:8080/api/process-html</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u0440\u0430\u0443\u0437\u0435\u0440  <code>irm http://localhost:8080/api/service -Method Post -Body @{\"ServiceName\" = \"AnyDesk\"}</code></p>"},{"location":"API/#telegram","title":"Telegram","text":"<p>@BotFather (https://t.me/BotFather) /newbot</p> <p>Format: <code>https://api.telegram.org/bot&lt;token&gt;/&lt;endpoint&gt;</code></p> <p>getupdates</p> <pre><code>function Get-FromTelegram {\n    param (\n        $Token = \"687...:AAF...\",\n        [switch]$Date,\n        [switch]$Last,\n        [switch]$ChatID\n    )\n    $endpoint = \"getUpdates\"\n    $url      = \"https://api.telegram.org/bot$Token/$endpoint\"\n    $result   = Invoke-RestMethod -Uri $url\n    if ($Date) {\n        $Collections = New-Object System.Collections.Generic.List[System.Object]\n        foreach ($r in $($result.result)) {\n            $EpochTime = [DateTime]\"1/1/1970\"\n            $TimeZone = Get-TimeZone\n            $UTCTime = $EpochTime.AddSeconds($r.message.date)\n            $d = $UTCTime.AddMinutes($TimeZone.BaseUtcOffset.TotalMinutes)\n            $Collections.Add([PSCustomObject]@{\n                Message = $r.message.text;\n                Date    = $d\n            })\n        }\n        $Collections\n    }\n    else {\n        if ($Last) {\n            $result.result.message.text[-1]\n        }\n        elseif ($ChatID) {\n            $Collections = New-Object System.Collections.Generic.List[System.Object]\n            foreach ($r in $($result.result)) {\n                $Collections.Add([PSCustomObject]@{\n                    Message = $r.message.text;\n                    UserName = $r.message.chat.username;\n                    ChatID = $r.message.chat.id;\n                    ChatType = $r.message.chat.type\n                })\n            }\n            $Collections\n        }\n        else {\n            $result.result.message.text\n        }\n    }\n}\n</code></pre> <p><code>Get-FromTelegram</code> <code>Get-FromTelegram -Last</code> <code>Get-FromTelegram -Date</code> <code>Get-FromTelegram -ChatID</code></p> <p>sendmessage</p> <pre><code>function Send-ToTelegram {\nparam (\n    [Parameter(Mandatory = $True)]$Text,\n    $Token    = \"687...:AAF...\",\n    $Chat     = \"125468108\",\n    $Keyboard\n)\n    $endpoint = \"sendMessage\"\n    $url      = \"https://api.telegram.org/bot$Token/$endpoint\"\n    $Body = @{\n        chat_id = $Chat\n        text    = $Text\n    }\n    if ($keyboard -ne $null) {\n        $Body += @{reply_markup = $keyboard}\n    }\n    Invoke-RestMethod -Uri $url -Body $Body\n}\n</code></pre> <p><code>Send-ToTelegram -Text \"Send test from powershell\"</code></p> <pre><code>$LastDate = (Get-FromTelegram -date)[-1].Date\nwhile ($true) {\n    $LastMessage  = (Get-FromTelegram -date)[-1]\n    Start-Sleep 1\n    $LastDateTest = $LastMessage.Date\n    if (($LastMessage.Message -match \"/Service\") -and ($LastDate -ne $LastDateTest)) {\n        $ServiceName = $($LastMessage.Message -split \" \")[-1]\n        $Result = $(Get-Service $ServiceName -ErrorAction Ignore).Status\n        if ($Result) {\n            Send-ToTelegram -Text $Result\n        } else {\n            Send-ToTelegram -Text \"Service not found\"\n        }\n        $LastDate = $LastDateTest\n    }\n}\n</code></pre> <p><code>/Service vpnagent</code> <code>/Service WinRM</code> <code>/Service test</code></p>"},{"location":"API/#button","title":"Button","text":"<pre><code>$keyboard = '{\n    \"inline_keyboard\":[[\n        {\"text\":\"Uptime\",\"callback_data\":\"/Uptime\"},\n        {\"text\":\"Test\",\"callback_data\":\"/Test\"}\n    ]]\n}'\nSend-ToTelegram -Text \"Test buttons\" -Keyboard $keyboard\n$request = (Invoke-RestMethod -Uri \"https://api.telegram.org/bot$Token/getUpdates\").result.callback_query\n$request.data # \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c callback_data \u043d\u0430\u0436\u0430\u0442\u043e\u0439 \u043a\u043d\u043e\u043f\u043a\u0438\n$request.message.date\n</code></pre>"},{"location":"API/#send-totelegramfile","title":"Send-ToTelegramFile","text":"<p>https://core.telegram.org/bots/api#senddocument</p> <pre><code>function Send-ToTelegramFile {\n    param (\n        [Parameter(Mandatory = $true)][string]$Path,\n        [Parameter(Mandatory = $true)][string]$Token,\n        [Parameter(Mandatory = $true)][string]$Chat,\n        $Keyboard\n    )\n    $endpoint = \"senddocument\"\n    $url      = \"https://api.telegram.org/bot$Token/$endpoint\"\n    $multipartContent = [System.Net.Http.MultipartFormDataContent]::new()\n    $fileStream = [System.IO.FileStream]::new($Path, [System.IO.FileMode]::Open)\n    $fileContent = [System.Net.Http.StreamContent]::new($fileStream)\n    $fileHeader = [System.Net.Http.Headers.ContentDispositionHeaderValue]::new(\"form-data\")\n    $fileHeader.Name = \"document\"\n    $fileHeader.FileName = [System.IO.Path]::GetFileName($Path)\n    $fileContent.Headers.ContentDisposition = $fileHeader\n    $multipartContent.Add($fileContent, \"document\")\n    if ($Keyboard) {\n        $keyboardContent = [System.Net.Http.StringContent]::new($Keyboard)\n        $keyboardContent.Headers.ContentType.MediaType = \"application/json\"\n        $multipartContent.Add($keyboardContent, \"reply_markup\")\n    }\n    $chatContent = [System.Net.Http.StringContent]::new($Chat)\n    $multipartContent.Add($chatContent, \"chat_id\")\n    $response = Invoke-RestMethod -Uri $url -Method Post -Body $multipartContent -ContentType \"multipart/form-data\"\n    $fileStream.Dispose()\n    return $response\n}\n</code></pre> <p><code>Send-ToTelegramFile -Path \"C:\\Users\\Lifailon\\Documents\\lake.jpg\" -Token \"7777777777:AAF...\" -Chat \"7777777777\"</code></p>"},{"location":"API/#discord","title":"Discord","text":"<p>Developers</p> <p>\u0421\u043e\u0437\u0434\u0430\u0435\u043c Applications (General Information). \u0412 Bot \u043f\u0440\u0438\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u043c \u043a Application \u0438 \u043a\u043e\u043f\u0438\u0440\u0443\u0435\u043c \u0442\u043e\u043a\u0435\u043d \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438. \u0412 OAuth2 - URL Generator \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u043c bot \u0438 \u043f\u0440\u0430\u0432\u0430 Administrator \u0438 \u043a\u043e\u043f\u0438\u0440\u0443\u0435\u043c \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0439 URL \u0434\u043b\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043d\u0430 \u043a\u0430\u043d\u0430\u043b. \u041f\u0435\u0440\u0435\u0445\u043e\u0434\u0438\u043c \u043f\u043e url \u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0431\u043e\u0442\u0430 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440. \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u043c ID \u043a\u0430\u043d\u0430\u043b\u0430 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 (\u0442\u0435\u043a\u0441\u0442\u043e\u0432\u044b\u0435 \u043a\u0430\u043d\u0430\u043b\u044b, \u043f\u0440\u0430\u0432\u043e\u0439 \u043a\u043d\u043e\u043f\u043a\u043e\u0439 \u043c\u044b\u0448\u0438 \u043a\u043e\u043f\u0438\u0440\u0443\u0435\u043c \u0441\u0441\u044b\u043b\u043a\u0443 \u0438 \u0437\u0430\u0431\u0438\u0440\u0430\u0435\u043c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 id \u0432 url).</p>"},{"location":"API/#send-to-discord","title":"Send to Discord","text":"<pre><code>DISCORD_TOKEN=\"MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX\"\nDISCORD_CHANNEL_ID=\"119403124XXXXXXXXXX\"\nTEXT=\"test from bash\"\nURL=\"https://discordapp.com/api/channels/$DISCORD_CHANNEL_ID/messages\"\ncurl -s -X POST $URL \n  -H \"Authorization: Bot $DISCORD_TOKEN\" \n  -H \"Content-Type: application/json\" \n  -d \"{\\\"content\\\": \\\"$TEXT\\\"}\"\n</code></pre> <pre><code>$DISCORD_TOKEN = \"MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX\"\n$DISCORD_CHANNEL_ID = \"119403124XXXXXXXXXX\"\n$TEXT = \"test from PowerShell\"\n$URL = \"https://discordapp.com/api/channels/$DISCORD_CHANNEL_ID/messages\"\n$Body = @{\n    content = $TEXT\n} | ConvertTo-Json\ncurl -s $URL -X POST -H \"Authorization: Bot $DISCORD_TOKEN\" -H \"Content-Type: application/json\" -d $Body\n</code></pre>"},{"location":"API/#read-from-discord","title":"Read from Discord","text":"<pre><code>curl -s -X GET $URL \n  -H \"Authorization: Bot $DISCORD_TOKEN\" \n  -H \"Content-Type: application/json\" | jq -r .[0].content\n</code></pre> <pre><code>$messages = (curl -s -X GET $URL -H \"Authorization: Bot $DISCORD_TOKEN\" -H \"Content-Type: application/json\" | ConvertFrom-Json)\n$messages | Select-Object content,timestamp,{$_.author.username}\n</code></pre>"},{"location":"API/#httpclient","title":"HttpClient","text":"<pre><code>$DISCORD_TOKEN = \"MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX\"\n$DISCORD_CHANNEL_ID = \"119403124XXXXXXXXXX\"\n$URL = \"https://discordapp.com/api/channels/$DISCORD_CHANNEL_ID/messages\"\n$HttpClient = New-Object System.Net.Http.HttpClient\n$HttpClient.DefaultRequestHeaders.Authorization = \"Bot $DISCORD_TOKEN\"\n$response = $HttpClient.GetAsync($URL).Result\n$messages = $response.Content.ReadAsStringAsync().Result\n($messages | ConvertFrom-Json).content\n</code></pre>"},{"location":"API/#button_1","title":"Button","text":"<pre><code>curl -X POST $URL \n  -H \"Content-Type: application/json\" \n  -H \"Authorization: Bot $DISCORD_TOKEN\" \n  -d '\n  {\n    \"content\": \"Test text for button\",\n    \"components\": [\n      {\n        \"type\": 1,\n        \"components\": [\n          {\n            \"type\": 2,\n            \"label\": \"Button\",\n            \"style\": 1,\n            \"custom_id\": \"button_click\"\n          }\n        ]\n      }\n    ]\n  }'\n</code></pre>"},{"location":"API/#discordnetwebhook","title":"Discord.Net.Webhook","text":"<pre><code>Add-Type -Path $(ls \"$home\\Documents\\Discord.NET\\*.dll\").FullName\n## https://discordapp.com/api/webhooks/&lt;webhook_id&gt;/&lt;webhook_token&gt; (\u041d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043a\u0430\u043d\u0430\u043b - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f)\n$webhookId = 1197577280000000000\n$webhookToken = \"rs8AA-XXXXXXXXXXX_Vk5RUI4A6HuSGhpCCTepq25duwCwLXasfv6u23a7XXXXXXXXXX\"\n$messageContent = \"Test dotNET\"\n$client = New-Object Discord.Webhook.DiscordWebhookClient($webhookId, $webhookToken)\n$client.SendMessageAsync($messageContent).Wait()\n</code></pre>"},{"location":"API/#discordnetwebsocket","title":"Discord.Net.WebSocket","text":"<pre><code>$DiscordAssemblies = $(ls \"$home\\Documents\\Discord.NET\\*.dll\").FullName\nforeach ($assembly in $DiscordAssemblies) {\n    Add-Type -Path $assembly\n}\n$DISCORD_TOKEN = \"MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX\"\n$Client = New-Object Discord.WebSocket.DiscordSocketClient\n$Client.Add_MessageReceived({\n    param($message)\n    if ($message.Author.Id -ne $Client.CurrentUser.Id) {\n        Write-Host (\"Received message from \" + $message.Author.Username + \": \" + $message.Content)\n        if ($message.Content.Contains(\"ping\")) {\n            $message.Channel.SendMessageAsync(\"pong\").GetAwaiter().GetResult()\n        }\n    }\n})\n$Client.LoginAsync([Discord.TokenType]::Bot, $DISCORD_TOKEN).GetAwaiter().GetResult()\n#$Client.StartAsync().Wait()\n$Client.StartAsync().GetAwaiter().GetResult()\n$Client.ConnectionState\n\n[console]::ReadKey($true)\n$Client.LogoutAsync().GetAwaiter().GetResult()\n$Client.Dispose()\n</code></pre>"},{"location":"API/#gigachat","title":"GigaChat","text":"<p>Developers chat</p> <ul> <li> <ol> <li>\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432:</li> </ol> </li> </ul> <p><code>Invoke-WebRequest \"https://gu-st.ru/content/lending/russian_trusted_root_ca_pem.crt\" -OutFile \"$home\\Downloads\\russian_trusted_root_ca.cer\"</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043c\u0438\u043d\u0446\u0438\u0444\u0440\u044b  <code>Invoke-WebRequest \"https://gu-st.ru/content/lending/russian_trusted_sub_ca_pem.crt\" -OutFile \"$home\\Downloads\\russian_trusted_sub_ca.cer\"</code> <code>Import-Certificate -FilePath \"$home\\Downloads\\russian_trusted_root_ca.cer\" -CertStoreLocation \"Cert:\\CurrentUser\\Root\"</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043c\u0438\u043d\u0446\u0438\u0444\u0440\u044b  <code>Import-Certificate -FilePath \"$home\\Downloads\\russian_trusted_sub_ca.cer\" -CertStoreLocation \"Cert:\\CurrentUser\\CA\"</code></p> <ul> <li> <ol> <li>\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u043e Sber ID \u0438 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043d\u043e\u0432\u044b\u0445 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0442\u043e\u043a\u0435\u043d\u0430: Developers (\u0432\u0440\u0435\u043c\u044f \u0436\u0438\u0437\u043d\u0438 30 \u043c\u0438\u043d\u0443\u0442)</li> </ol> </li> <li> <ol> <li>\u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 Base64 \u0438\u0437 Client ID \u0438 Client Secret:</li> </ol> </li> </ul> <pre><code>$Client_ID     = \"7e6d2f9f-825e-49b7-98f4-62fbb7506427\" # [System.Guid]::Parse(\"7e6d2f9f-825e-49b7-98f4-62fbb7506427\")\n$Client_Secret = \"c35113ee-6757-47ba-9853-ea1d0d9db1ef\" # [System.Guid]::Parse(\"c35113ee-6757-47ba-9853-ea1d0d9db1ef\")\n$Client_Join   = $Client_ID+\":\"+$Client_Secret # \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0435\u043c \u0434\u0432\u0430 UUID \u0432 \u043e\u0434\u043d\u0443 \u0441\u0442\u0440\u043e\u043a\u0443, \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u044f \u0438\u0445 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u043c ':'\n$Bytes         = [System.Text.Encoding]::UTF8.GetBytes($Client_Join) # \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c \u0441\u0442\u0440\u043e\u043a\u0443 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432 \u0431\u0430\u0439\u0442\n$Cred_Base64   = [Convert]::ToBase64String($Bytes) # \u043a\u043e\u0434\u0438\u0440\u0443\u0435\u043c \u0431\u0430\u0439\u0442\u044b \u0432 \u0441\u0442\u0440\u043e\u043a\u0443 Base64\n</code></pre> <ul> <li> <ol> <li>\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0442\u043e\u043a\u0435\u043d\u0430:</li> </ol> </li> </ul> <p><code>$Cred_Base64   = \"N2U2ZDJmOWYtODI1ZS00OWI3LTk4ZjQtNjJmYmI3NTA2NDI3OmIyYzgwZmZmLTEzOGUtNDg1Mi05MjgwLWE2MGI4NTc0YTM2MQ==\"</code> <code>$UUID = [System.Guid]::NewGuid()</code> \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u043c UUID \u0434\u043b\u044f \u0436\u0443\u0440\u043d\u0430\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0432\u044b\u0437\u043e\u0432\u043e\u0432 \u0438 \u0440\u0430\u0437\u0431\u043e\u0440\u0430 \u0438\u043d\u0446\u0438\u0434\u0435\u043d\u0442\u043e\u0432</p> <pre><code>$url = \"https://ngw.devices.sberbank.ru:9443/api/v2/oauth\"\n$headers = @{\n    \"Authorization\" = \"Basic $Cred_Base64\"\n    \"RqUID\" = \"$UUID\"\n    \"Content-Type\" = \"application/x-www-form-urlencoded\"\n}\n$body = @{\n    scope = \"GIGACHAT_API_PERS\"\n}\n$GIGA_TOKEN = $(Invoke-RestMethod -Uri $url -Method POST -Headers $headers -Body $body).access_token\n</code></pre> <ul> <li> <ol> <li>\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:</li> </ol> </li> </ul> <pre><code>[string]$content = \"\u041f\u043e\u0441\u0447\u0438\u0442\u0430\u0439 \u0441\u0443\u043c\u043c\u0443 \u0447\u0438\u0441\u0435\u043b: 22+33\"\n[string]$role = \"user\" # \u0440\u043e\u043b\u044c \u0430\u0432\u0442\u043e\u0440\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f (user/assistant/system)\n[float]$temperature = 0.7 # \u0442\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u0430 \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u0432 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d\u0435 \u043e\u0442 0 \u0434\u043e 2. \u0427\u0435\u043c \u0432\u044b\u0448\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u0442\u0435\u043c \u0431\u043e\u043b\u0435\u0435 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u044b\u043c \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u0432\u0435\u0442 \u043c\u043e\u0434\u0435\u043b\u0438.\n[float]$top_p = 0.1 # \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u0430 temperature \u0438 \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u0432 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d\u0435 \u043e\u0442 0 \u0434\u043e 1. \u0417\u0430\u0434\u0430\u0435\u0442 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u043d\u0443\u044e \u043c\u0430\u0441\u0441\u0443 \u0442\u043e\u043a\u0435\u043d\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0434\u043e\u043b\u0436\u043d\u0430 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c. \u0422\u0430\u043a, \u0435\u0441\u043b\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 0.1, \u043c\u043e\u0434\u0435\u043b\u044c \u0431\u0443\u0434\u0435\u0442 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u043e\u043a\u0435\u043d\u044b, \u0447\u044c\u044f \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u043c\u0430\u0441\u0441\u0430 \u0432\u0445\u043e\u0434\u0438\u0442 \u0432 \u0432\u0435\u0440\u0445\u043d\u0438\u0435 10%.\n[int64]$n = 1 # \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u043e\u0442\u0432\u0435\u0442\u043e\u0432 (1..4), \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0443\u0436\u043d\u043e \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0432\u0445\u043e\u0434\u043d\u043e\u0433\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f\n[int64]$max_tokens = 512 # \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u043a\u0435\u043d\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u044b \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043e\u0442\u0432\u0435\u0442\u043e\u0432\n[boolean]$stream = $false # \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043f\u043e \u0447\u0430\u0441\u0442\u044f\u043c \u0432 \u043f\u043e\u0442\u043e\u043a\u0435\n</code></pre> <ul> <li> <ol> <li>\u0421\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432:</li> </ol> </li> </ul> <pre><code>$url = \"https://gigachat.devices.sberbank.ru/api/v1/chat/completions\"\n$headers = @{\n    \"Authorization\" = \"Bearer $GIGA_TOKEN\"\n    \"Content-Type\" = \"application/json\"\n}\n\n$(Invoke-RestMethod -Uri \"https://gigachat.devices.sberbank.ru/api/v1/models\" -Headers $headers).data # \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439\n\n$body = @{\n    model = \"GigaChat:latest\"\n    messages = @(\n        @{\n            role = $role\n            content = $content\n        }\n    )\n    temperature = $temperature\n    n = $n\n    max_tokens = $max_tokens\n    stream = $stream\n} | ConvertTo-Json\n$Request = Invoke-RestMethod -Method POST -Uri $url -Headers $headers -Body $body\n$Request.choices.message.content\n</code></pre>"},{"location":"API/#curl","title":"Curl","text":""},{"location":"API/#ubuntu","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u0432 Ubuntu:","text":"<p><code>wget https://gu-st.ru/content/lending/russian_trusted_root_ca_pem.crt</code> <code>wget https://gu-st.ru/content/lending/russian_trusted_sub_ca_pem.crt</code> <code>mkdir /usr/local/share/ca-certificates/russian_trusted</code> <code>cp russian_trusted_root_ca_pem.crt russian_trusted_sub_ca_pem.crt /usr/local/share/ca-certificates/russian_trusted</code> <code>update-ca-certificates -v</code> <code>wget -qS --spider --max-redirect=0 https://www.sberbank.ru</code></p>"},{"location":"API/#_1","title":"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0442\u043e\u043a\u0435\u043d\u0430:","text":"<pre><code>Cred_Base64=\"N2U2ZDJmOWYtODI1ZS00OWI3LTk4ZjQtNjJmYmI3NTA2NDI3OmIyYzgwZmZmLTEzOGUtNDg1Mi05MjgwLWE2MGI4NTc0YTM2MQ==\"\nUUID=$(uuidgen)\nGIGA_TOKEN=$(curl -s --location --request POST \"https://ngw.devices.sberbank.ru:9443/api/v2/oauth\" \n--header \"Authorization: Basic $Cred_Base64\" \n--header \"RqUID: $UUID\" \n--header \"Content-Type: application/x-www-form-urlencoded\" \n--data-urlencode 'scope=GIGACHAT_API_PERS' | jq -r .access_token)\n</code></pre> <p><code>curl -s --location \"https://gigachat.devices.sberbank.ru/api/v1/models\" --header \"Authorization: Bearer $GIGA_TOKEN\" | jq .</code> \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438</p>"},{"location":"API/#_2","title":"\u0421\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u0430:","text":"<pre><code>request=$(curl -s https://gigachat.devices.sberbank.ru/api/v1/chat/completions \n  -H \"Content-Type: application/json\" \n  -H \"Authorization: Bearer $GIGA_TOKEN\" \n  -d '{\n  \"model\": \"GigaChat:latest\",\n  \"messages\": [\n        {\n            \"role\": \"user\",\n            \"content\": \"\u041a\u043e\u0433\u0434\u0430 \u0443\u0436\u0435 \u0418\u0418 \u0437\u0430\u0445\u0432\u0430\u0442\u0438\u0442 \u044d\u0442\u043e\u0442 \u043c\u0438\u0440?\"\n        }\n    ],\n  \"temperature\": 0.7\n}')\necho $request | jq -r .choices[].message.content\n</code></pre>"},{"location":"API/#yandexgpt","title":"YandexGPT","text":""},{"location":"API/#oauth-token","title":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c OAuth-Token:","text":"<p>Create AIM Token \u0432\u0440\u0435\u043c\u044f \u0436\u0438\u0437\u043d\u0438 IAM-\u0442\u043e\u043a\u0435\u043d\u0430 \u043d\u0435 \u0431\u043e\u043b\u044c\u0448\u0435 12 \u0447\u0430\u0441\u043e\u0432  <code>yandexPassportOauthToken=\"y0_AgAAAAAGaLFLAATuwQAAAAD3xtRLQE4hvlazQ5euKO43XXXXXXXXXXX\"</code> \u0434\u043b\u044f bash  <code>$yandexPassportOauthToken = \"y0_AgAAAAAGaLFLAATuwQAAAAD3xtRLQE4hvlazQ5euKO43XXXXXXXXXXX\"</code> \u0434\u043b\u044f PowerShell</p>"},{"location":"API/#oauth-token-iam-token","title":"\u041e\u0431\u043c\u0435\u043d\u044f\u0442\u044c OAuth-Token \u043d\u0430 IAM-Token:","text":"<p><code>IAM_TOKEN=$(curl -s -d \"{\\\"yandexPassportOauthToken\\\":\\\"$yandexPassportOauthToken\\\"}\" \"https://iam.api.cloud.yandex.net/iam/v1/tokens\" | jq -r .iamToken)</code> <code>$IAM_TOKEN = $(Invoke-RestMethod -Method POST -Uri \"https://iam.api.cloud.yandex.net/iam/v1/tokens\" -Body $(@{yandexPassportOauthToken = \"$yandexPassportOauthToken\"} | ConvertTo-Json -Compress)).iamToken</code></p>"},{"location":"API/#folder_id","title":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c FOLDER_ID:","text":"<pre><code>CLOUD_ID=$(curl -s -H \"Authorization: Bearer $IAM_TOKEN\" https://resource-manager.api.cloud.yandex.net/resource-manager/v1/clouds | jq -r .clouds[].id) # \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c cloud id\ncurl -s --request GET -H \"Authorization: Bearer $IAM_TOKEN\" https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders -d \"{\\\"cloudId\\\": \\\"$CLOUD_ID\\\"}\" # \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439 \u0432 \u043e\u0431\u043b\u0430\u043a\u0435\ncurl -s --request POST -H \"Authorization: Bearer $IAM_TOKEN\" https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders -d \"{\\\"cloudId\\\": \\\"$CLOUD_ID\\\", \\\"name\\\": \\\"test\\\"}\" # \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u0432 \u043e\u0431\u043b\u0430\u043a\u0435\nFOLDER_ID=$(curl -s --request GET -H \"Authorization: Bearer $IAM_TOKEN\" https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders -d '{\"cloudId\": \"b1gf9n6heihqj0pt5piu\"}' | jq -r '.folders[] | select(.name == \"test\") | .id') # \u0437\u0430\u0431\u0440\u0430\u0442\u044c id \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438\n</code></pre> <pre><code>$CLOUD_ID = $(Invoke-RestMethod -Method Get -Uri \"https://resource-manager.api.cloud.yandex.net/resource-manager/v1/clouds\" -Headers @{\"Authorization\"=\"Bearer $IAM_TOKEN\"; \"Content-Type\"=\"application/json\"}).clouds.id\n$FOLDER_ID = $(Invoke-RestMethod -Method Get -Uri \"https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders\" -Headers @{\"Authorization\"=\"Bearer $IAM_TOKEN\"; \"Content-Type\"=\"application/json\"} -Body (@{\"cloudId\"= $CLOUD_ID} | ConvertTo-Json)).folders | Where-Object name -eq test | Select-Object -ExpandProperty id\n</code></pre>"},{"location":"API/#_3","title":"\u0421\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u0430:","text":"<pre><code>model=\"gpt://$FOLDER_ID/yandexgpt/latest\" # https://cloud.yandex.ru/ru/docs/yandexgpt/concepts/models\nbody=$(cat &lt;&lt;EOF\n{\n  \"modelUri\": \"$model\",\n  \"completionOptions\": {\n    \"stream\": false,\n    \"temperature\": 0.6,\n    \"maxTokens\": 2000\n  },\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"text\": \"\u041f\u043e\u0441\u0447\u0438\u0442\u0430\u0439 \u0441\u0443\u043c\u043c\u0443 22+33\"\n    }\n  ]\n}\nEOF)\ncurl --request POST \n  -H \"Content-Type: application/json\" \n  -H \"Authorization: Bearer $IAM_TOKEN\" \n  -H \"x-folder-id: $FOLDER_ID\" \n  -d \"$body\" \n  \"https://llm.api.cloud.yandex.net/foundationModels/v1/completion\"\n</code></pre> <pre><code>$model = \"gpt://$FOLDER_ID/yandexgpt/latest\"\n$body = @\"\n{\n  \"modelUri\": \"$model\",\n  \"completionOptions\": {\n    \"stream\": false,\n    \"temperature\": 0.6,\n    \"maxTokens\": 2000\n  },\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"text\": \"\u041f\u043e\u0441\u0447\u0438\u0442\u0430\u0439 \u0441\u0443\u043c\u043c\u0443 22+33\"\n    }\n  ]\n}\n\"@\nInvoke-RestMethod -Method POST -Uri \"https://llm.api.cloud.yandex.net/foundationModels/v1/completion\" -Headers @{\"Content-Type\"=\"application/json\"; \"Authorization\"=\"Bearer $IAM_TOKEN\"; \"x-folder-id\"=\"$FOLDER_ID\"} -Body $body\n</code></pre>"},{"location":"API/#superagi","title":"SuperAGI","text":"<p>Source Playground generate API Doc (exaples)</p> <pre><code>SUPERAGI_API_KEY=\"31f72164129XXXXX\"\nprompt=\"\u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0439 \u0441\u0443\u043c\u043c\u0443 22+33, \u0434\u0430\u0439 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0442\u0432\u0435\u0442 \u0431\u0435\u0437 \u043b\u0438\u0448\u043d\u0435\u0433\u043e \u0442\u0435\u043a\u0441\u0442\u0430\"\nrequest=$(curl -s -X POST 'https://api.superagi.com/v1/generate/65437cbf227a4018516ad1ce' \n-H 'Content-Type: application/json' \n-H \"Authorization: Bearer $SUPERAGI_API_KEY\" \n-d '{\n  \"prompt\": [\"$prompt\"],\n  \"max_tokens\": 500,\n  \"temperature\": 0.9,\n  \"top_p\": 0.15,\n  \"repetition_penalty\": 0,\n  \"best_of\": 1.05,\n  \"top_k\": 50,\n  \"stream\": false\n}')\necho $request | sed \"s/data: //\" | jq -r .choices[].text\n</code></pre> <pre><code>$SUPERAGI_API_KEY = \"31f72164129XXXXX\"\n$prompt = \"\u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0439 \u0441\u0443\u043c\u043c\u0443 22+33, \u0434\u0430\u0439 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0442\u0432\u0435\u0442 \u0431\u0435\u0437 \u043b\u0438\u0448\u043d\u0435\u0433\u043e \u0442\u0435\u043a\u0441\u0442\u0430\"\n$request = Invoke-RestMethod -Method Post -Uri 'https://api.superagi.com/v1/generate/65437cbf227a4018516ad1ce' -Headers @{\n    'Content-Type' = 'application/json'\n    'Authorization' = \"Bearer $SUPERAGI_API_KEY\"\n} -Body (@{\n    prompt = @($prompt)\n    max_tokens = 500\n    temperature = 0.9\n    top_p = 0.15\n    repetition_penalty = 0\n    best_of = 1.05\n    top_k = 50\n    stream = $false\n} | ConvertTo-Json)\n$($request -replace \"^data: \" | ConvertFrom-Json).choices.text\n</code></pre>"},{"location":"API/#replicate","title":"Replicate","text":"<p>API curl examples</p> <pre><code>REPLICATE_API_TOKEN=\"r8_STyeUNXiGonkLfxE1FSKaqll26lXXXXXXXXXX\"\nprompt=\"\u0416\u0438\u0440\u0430\u0444 \u0432 \u043f\u043e\u043b\u043e\u0441\u043a\u0443 \u0437\u0435\u0431\u0440\u044b\"\nrequest=$(curl -s -X POST \n  -H \"Authorization: Token $REPLICATE_API_TOKEN\" \n  -H \"Content-Type: application/json\" \n  -d $'{\n    \"version\": \"ac732df83cea7fff18b8472768c88ad041fa750ff7682a21affe81863cbe77e4\",\n    \"input\": {\n      \"prompt\": \"$prompt\"\n    }\n  }' \n  https://api.replicate.com/v1/predictions)\nrequest_url=$(echo $request | jq -r .urls.get)\nresponse_status=$(curl -s -H \"Authorization: Token $REPLICATE_API_TOKEN\" $request_url | jq -r .status)\nwhile [[ $response_status != succeeded ]]; do\n    response_status=$(curl -s -H \"Authorization: Token $REPLICATE_API_TOKEN\" $request_url | jq -r .status)\ndone\ncurl -s -H \"Authorization: Token $REPLICATE_API_TOKEN\" $request_url | jq -r .output[]\n</code></pre> <pre><code>$REPLICATE_API_TOKEN = \"r8_STyeUNXiGonkLfxE1FSKaqll26lXXXXXXXXXX\"\n$prompt = \"\u0416\u0438\u0440\u0430\u0444 \u0432 \u043f\u043e\u043b\u043e\u0441\u043a\u0443 \u0437\u0435\u0431\u0440\u044b\"\n$body = @{\n   version = \"ac732df83cea7fff18b8472768c88ad041fa750ff7682a21affe81863cbe77e4\"\n   input = @{\n       prompt = $prompt\n   }\n} | ConvertTo-Json\n$headers = @{\n   \"Authorization\" = \"Token $REPLICATE_API_TOKEN\"\n   \"Content-Type\" = \"application/json\"\n}\n$request = Invoke-RestMethod -Uri \"https://api.replicate.com/v1/predictions\" -Method POST -Body $body -Headers $headers\n$response = Invoke-RestMethod $($request.urls.get) -Headers @{\"Authorization\" = \"Token $REPLICATE_API_TOKEN\"}\nwhile ($response.status -ne \"succeeded\") {\n    $response = Invoke-RestMethod $($request.urls.get) -Headers @{\"Authorization\" = \"Token $REPLICATE_API_TOKEN\"}\n}\n$response.output\n</code></pre>"},{"location":"API/#google-filter","title":"Google-Filter","text":"<p><code>https://www.google.com/search?q=the+rookie+2018+imdb</code> \u0444\u043e\u0440\u043c\u0430\u0442 url-\u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043f\u043e\u0438\u0441\u043a\u0430 \u0441 \u043f\u0440\u043e\u0431\u0435\u043b\u0430\u043c\u0438  <code>https://www.google.com/search?q=the+rookie+2018+site:imdb.com</code> \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0441\u0430\u0439\u0442\u0443  <code>https://www.google.com/search?q=the+rookie+intitle:index.of+\"last modified\"+(mkv|avi)</code> \u0438\u0441\u043a\u0430\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \"last modified\" (\u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f), \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0447\u0435\u0440\u0435\u0437 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u043d\u044b\u0439 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043f\u043e\u0438\u0441\u043a\u0430 (\u0432\u0441\u0435 \u043f\u0435\u0440\u0435\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0435 \u0441\u043b\u043e\u0432\u0430 \u0434\u043e\u043b\u0436\u043d\u044b \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0442\u044c\u0441\u044f \u0432 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0435) \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0441\u043b\u043e\u0432\u043e \"index.of\" (\u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043d\u0430 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u043d\u0430 \u0432\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440\u0435, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u0430\u0439\u043b\u043e\u0432) \u0438 \u0438\u0441\u043a\u0430\u0442\u044c \u0444\u0430\u0439\u043b\u044b \u0441 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f\u043c\u0438 .mkv \u0438\u043b\u0438 (|) .avi  <code>https://www.google.com/search?q=the+rookie+2018+filetype:torrent</code> <code>\u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f gopro hero 11 filetype:pdf</code> \u0438\u0441\u043a\u0430\u0442\u044c \u0441\u0440\u0430\u0437\u0443 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 (\u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 .pdf \u0438\u043b\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430)  <code>\"\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f/\u0433\u043b\u0430\u0433\u043e\u043b\u044b, \u0443\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u043b\u0435\u0442\u0430\u0445\"</code> \u0438\u0441\u043a\u0430\u0442\u044c \u043f\u043e \u0444\u0440\u0430\u0437\u0435 \u0446\u0435\u043b\u0438\u043a\u043e\u043c, \u0431\u0435\u0437 \u0440\u0430\u0437\u0431\u0438\u0435\u043d\u0438\u044f \u043d\u0430 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0435 \u0441\u043b\u043e\u0432\u0430  <code>\"\u044f\u0433\u0443\u0430\u0440 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c -\u0436\u0438\u0432\u043e\u0442\u043d\u043e\u0435 -xe -xj\"</code> \u0443\u0437\u043d\u0430\u0435\u043c \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u042f\u0433\u0443\u0430\u0440\u0430, \u0438\u0441\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u0436\u0438\u0432\u043e\u0442\u043d\u043e\u0435 \u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f  <code>\"intitle:\u043b\u0443\u0447\u0448\u0438\u0435 \u0444\u0438\u043b\u044c\u043c\u044b 2023\"</code> \u0437\u0430\u043f\u0440\u043e\u0441 \u0438\u0449\u0435\u0442 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b, \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0438 (title HTML \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430) \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442 \u0441\u043b\u043e\u0432\u0430 \"\u043b\u0443\u0447\u0448\u0438\u0435\", \"\u0444\u0438\u043b\u044c\u043c\u044b\" \u0438 \"2023\" (\u0432\u0441\u0435 \u0441\u043b\u043e\u0432\u0430 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0432 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0435)  <code>\"allintitle:\u043b\u0443\u0447\u0448\u0438\u0435 \u0444\u0438\u043b\u044c\u043c\u044b 2023\"</code> \u0437\u0430\u043f\u0440\u043e\u0441 \u0438\u0449\u0435\u0442 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b, \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0438 (title HTML \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430) \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442 \u0441\u043b\u043e\u0432\u0430 \"\u043b\u0443\u0447\u0448\u0438\u0435\", \"\u0444\u0438\u043b\u044c\u043c\u044b\" \u0438\u043b\u0438 \"2023\" (\u043e\u0434\u043d\u043e \u0438\u0437)  <code>\"intext:telegram \u0431\u043e\u0442 powershell\"</code> \u043f\u043e\u0438\u0441\u043a \u0441\u0442\u0440\u0430\u043d\u0438\u0446, \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0438\u0445 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0435 \u043a\u043b\u044e\u0447\u0435\u0432\u043e\u0435 \u0441\u043b\u043e\u0432\u043e \u0432 \u0442\u0435\u043a\u0441\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b (\u0430 \u043d\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0435)  <code>\"inurl:lifailon\"</code> \u043f\u043e\u0438\u0441\u043a \u0441\u0442\u0440\u0430\u043d\u0438\u0446, \u0432 URL \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442\u0441\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0435 \u043a\u043b\u044e\u0447\u0435\u0432\u043e\u0435 \u0441\u043b\u043e\u0432\u043e  <code>intitle:index.of \"game of thrones\" mkv daterange:2010..2015</code> \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e \u0434\u0430\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f, \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0437\u0430\u0434\u0430\u0442\u044c \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u0434\u0430\u0442 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 YYYYMMDD..YYYYMMDD  <code>intitle:index.of \"game of thrones\" mkv after:2015</code> \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u043e\u0438\u0441\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432, \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u043d\u044b\u0445 \u0434\u043e (before) \u0438\u043b\u0438 \u043f\u043e\u0441\u043b\u0435 (after) \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0434\u0430\u0442\u044b  <code>intitle:index.of \"game of thrones\" mkv from:2010 to:2015</code> \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d\u0443 \u0434\u0430\u0442  <code>https://www.google.com/search?q=the-rookie-2018+site:imdb.com&amp;btnI</code> \u0440\u0435\u0434\u0438\u0440\u0435\u043a\u0442 \u043d\u0430 \u043f\u0435\u0440\u0432\u044b\u0439 url</p>"},{"location":"API/#google-api","title":"Google-API","text":""},{"location":"API/#google-translate","title":"Google-Translate","text":"<pre><code>$Key = \"&lt;TOKEN_API&gt;\" # \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u043e\u043a\u0435\u043d: https://console.cloud.google.com/apis/credentials\n$Text = \"You can see in the right corner how long each translation request takes (this does not depend on the amount of text being transferred).\"\n$LanguageTarget = \"RU\"\n$LanguageSource = \"EN\"\n$url = \"https://translation.googleapis.com/language/translate/v2?key=$key\"\n$Header = @{\n    \"Content-Type\" = \"application/json\"\n}\n$Body = @{\n    \"q\" = \"$Text\"\n    \"target\" = \"$LanguageTarget\"\n    \"source\" = \"$LanguageSource\"\n} | ConvertTo-Json\n$WebClient = New-Object System.Net.WebClient\nforeach ($key in $Header.Keys) {\n    $WebClient.Headers.Add($key, $Header[$key])\n}\n$Response = $WebClient.UploadString($url, \"POST\", $Body) | ConvertFrom-Json\n$Response.data.translations.translatedText\n</code></pre>"},{"location":"API/#google-search","title":"Google-Search","text":"<pre><code>$Key = \"&lt;TOKEN_API&gt;\" # \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u043e\u043a\u0435\u043d: https://developers.google.com/custom-search/v1/overview?hl=ru (\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u043f\u043e\u0438\u0441\u043a JSON API \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 100 \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0432 \u0434\u0435\u043d\u044c \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e)\n$cx = \"35c78340f49eb474a\" # \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443 https://programmablesearchengine.google.com/controlpanel/all\n$Query = \"\u043a\u0430\u043a \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0431\u043e\u0442\u0430 discord\"\n$Lang = \"ru\"\n$Num = 10\n$Start = 0\n$response = Invoke-RestMethod \"https://www.googleapis.com/customsearch/v1?q=$Query&amp;key=$Key&amp;cx=$cx&amp;lr=lang_$Lang&amp;num=$Num&amp;$start=$Start\"\n$response.items | Select-Object title,snippet,displayLink,link | Format-List\n</code></pre>"},{"location":"API/#rapidapi","title":"RapidAPI","text":"<p>Google-Search72</p> <pre><code>$Key = \"&lt;TOKEN_API&gt;\"\n$headers=@{}\n$headers.Add(\"X-RapidAPI-Key\", \"$Key\")\n$headers.Add(\"X-RapidAPI-Host\", \"google-search72.p.rapidapi.com\")\n$query = \"\u043a\u0430\u043a \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0431\u043e\u0442\u0430 discord\"\n$response = Invoke-RestMethod \"https://google-search72.p.rapidapi.com/search?q=$query%20gitgub&amp;gl=us&amp;lr=lang_ru&amp;num=20&amp;start=0\" -Method GET -Headers $headers\n$response.items | Select-Object title,snippet,displayLink,link | Format-List\n</code></pre>"},{"location":"API/#imdb","title":"IMDb","text":"<p>IMDb8</p> <pre><code>$key = \"&lt;TOKEN_API&gt;\" # 500 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0432 \u043c\u0435\u0441\u044f\u0446\n$query=\"Break\"\n$headers=@{}\n$headers.Add(\"X-RapidAPI-Key\", \"$key\")\n$headers.Add(\"X-RapidAPI-Host\", \"imdb8.p.rapidapi.com\")\n$response = Invoke-RestMethod \"https://imdb8.p.rapidapi.com/title/find?q=$query\" -Method GET -Headers $headers\n$response.results | select title,titletype,year,runningTimeInMinutes,id | Format-Table\n\"https://www.imdb.com$($response.results.id[0])\"\n$response.results.principals # \u0430\u043a\u0442\u0435\u0440\u044b\n$response.results.image\n</code></pre>"},{"location":"API/#moviesdatabase","title":"MoviesDatabase","text":"<p>MoviesDatabase</p> <pre><code>$key = \"&lt;TOKEN_API&gt;\"\n$imdb_id = \"tt0455275\"\n$headers=@{}\n$headers.Add(\"X-RapidAPI-Key\", \"$key\")\n$headers.Add(\"X-RapidAPI-Host\", \"moviesdatabase.p.rapidapi.com\")\n$response = Invoke-RestMethod \"https://moviesdatabase.p.rapidapi.com/titles/$imdb_id\" -Method GET -Headers $headers\n$response.results\n</code></pre>"},{"location":"API/#tmdb","title":"TMDB","text":"<p>Developer TMDB</p> <pre><code>$TOKEN = \"548e444e7812575caa0a7eXXXXXXXXXX\"\n$Endpoint = \"search/tv\" # \u043f\u043e\u0438\u0441\u043a \u0441\u0435\u0440\u0438\u0430\u043b\u0430 (tv) \u0438 \u0444\u0438\u043b\u044c\u043c\u0430 (movie) \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e\n$Query = \"\u0437\u0438\u043c\u043e\u0440\u043e\u0434\u043e\u043a\"\n$url = $(\"https://api.themoviedb.org/3/$Endpoint\"+\"?api_key=$TOKEN&amp;query=$Query\")\n$(Invoke-RestMethod -Uri $url -Method Get).results\n$id = $(Invoke-RestMethod -Uri $url -Method Get).results.id # \u0437\u0430\u0431\u0440\u0430\u0442\u044c id \u0441\u0435\u0440\u0438\u0430\u043b\u0430 (210865) https://www.themoviedb.org/tv/210865\n\n$Endpoint = \"tv/$id\" # \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0441\u0435\u0440\u0438\u0430\u043b\u0435 \u043f\u043e \u0435\u0433\u043e ID\n$url = $(\"https://api.themoviedb.org/3/$Endpoint\"+\"?api_key=$TOKEN\")\n$(Invoke-RestMethod -Uri $url -Method Get) # \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0437\u043e\u043d\u043e\u0432 (.seasons), \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u044d\u043f\u0438\u0437\u043e\u0434\u043e\u0432 (.seasons.episode_count)\n\n(Invoke-RestMethod -Uri \"https://api.themoviedb.org/3/tv/$id/season/2?api_key=$Token\" -Method Get).episodes # \u0432\u044b\u0432\u0435\u0441\u0442\u0438 2 \u0441\u0435\u0437\u043e\u043d\nInvoke-RestMethod -Uri \"https://api.themoviedb.org/3/tv/$id/season/2/episode/8?api_key=$Token\" -Method Get # \u0432\u044b\u0432\u0435\u0441\u0442\u0438 8 \u044d\u043f\u0438\u0437\u043e\u0434\n</code></pre>"},{"location":"API/#omdb","title":"OMDb","text":"<p>\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 API \u043a\u043b\u044e\u0447\u0430 \u043f\u043e email</p> <p><code>$API_KEY = \"XXXXXXXX\"</code> <code>$IMDb_ID = \"tt7587890\"</code> <code>curl -s \"https://omdbapi.com/?apikey=$($API_KEY)&amp;i=$($IMDb_ID)\" | jq .</code> <code>curl -s \"https://omdbapi.com/?apikey=$($API_KEY)&amp;i=$($IMDb_ID)\" | ConvertFrom-Json</code> <code>Invoke-RestMethod \"https://omdbapi.com/?apikey=$($API_KEY)&amp;s=The Rookie\"</code> <code>Invoke-RestMethod \"https://omdbapi.com/?apikey=$($API_KEY)&amp;t=The Rookie\"</code> \u043f\u043e\u0438\u0441\u043a \u043f\u043e Title  <code>Invoke-RestMethod \"https://omdbapi.com/?apikey=$($API_KEY)&amp;t=The Rookie&amp;y=1990\"</code> \u043f\u043e\u0438\u0441\u043a \u043f\u043e Title \u0438 \u0433\u043e\u0434\u0443 \u0432\u044b\u0445\u043e\u0434\u0430  <code>Invoke-RestMethod \"https://omdbapi.com/?apikey=$($API_KEY)&amp;t=The Rookie&amp;type=movie\"</code> \u043f\u043e\u0438\u0441\u043a \u0442\u043e\u043b\u044c\u043a\u043e \u0444\u0438\u043b\u044c\u043c\u0430 (movie) \u0438\u043b\u0438 \u0441\u0435\u0440\u0438\u0430\u043b\u0430 (series)  <code>$(Invoke-RestMethod \"https://omdbapi.com/?apikey=$($API_KEY)&amp;s=The Rookie\").Search</code> \u043f\u043e\u0438\u0441\u043a \u0432\u0441\u0435\u0445 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 (\u0444\u0438\u043b\u044c\u043c\u044b \u0438 \u0441\u0435\u0440\u0438\u0430\u043b\u044b)</p>"},{"location":"API/#ivi","title":"ivi","text":"<p>ivi api doc</p> <p><code>Invoke-RestMethod https://api.ivi.ru/mobileapi/categories</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u0438 \u0436\u0430\u043d\u0440\u043e\u0432 (genres/meta_genres)  <code>Invoke-RestMethod https://api.ivi.ru/mobileapi/collections</code> \u043f\u043e\u0434\u0431\u043e\u0440\u043a\u0438</p> <p><code>(Invoke-RestMethod \"https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok\").result.seasons.number</code> \u043a\u043e\u043b-\u0432\u043e \u0441\u0435\u0437\u043e\u043d\u043e\u0432  <code>(Invoke-RestMethod \"https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok\").result.seasons[1].episode_count</code> \u043a\u043e\u043b-\u0432\u043e \u0441\u0435\u0440\u0438\u0439 \u0432\u043e \u0432\u0442\u043e\u0440\u043e\u043c \u0441\u0435\u0437\u043e\u043d\u0435  <code>(Invoke-RestMethod \"https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok\").result.seasons[1].ivi_release_info.date_interval_min</code> \u0434\u0430\u0442\u0430 \u0432\u044b\u0445\u043e\u0434\u0430 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439 \u0441\u0435\u0440\u0438\u0438  <code>(Invoke-RestMethod \"https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok\").result.kp_rating</code> \u0440\u0435\u0439\u0442\u0438\u043d\u0433 \u0432 \u041a\u0438\u043d\u043e\u043f\u043e\u0438\u0441\u043a (8.04)</p> <p><code>$id = (Invoke-RestMethod \"https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok\").result.kp_id</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c id \u0432 \u041a\u0438\u043d\u043e\u043f\u043e\u0438\u0441\u043a (5106881)  <code>id=$(curl -s https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok | jq .result[].kp_id)</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c id \u0432 \u041a\u0438\u043d\u043e\u043f\u043e\u0438\u0441\u043a</p>"},{"location":"API/#kinopoisk","title":"Kinopoisk","text":"<pre><code>id=5106881\nget=$(curl -s https://www.kinopoisk.ru/film/$id/episodes/)\nprintf \"%s\\n\" \"${get[@]}\" | grep -A 1 \"\u0421\u0435\u0437\u043e\u043d 2\" | grep \"\u044d\u043f\u0438\u0437\u043e\u0434\u043e\u0432\" | sed -r \"s/^.+\\: //\" # \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u044d\u043f\u0438\u0437\u0434\u043e\u0432\u043e\u0434 \u0432\u043e \u0432\u0442\u043e\u0440\u043e\u043c \u0441\u0435\u0437\u043e\u043d\u0435\n</code></pre>"},{"location":"API/#kinopoiskdev","title":"kinopoisk.dev","text":"<p>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u043e\u043a\u0435\u043d \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u043e API \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 OpenAPI</p> <p><code>GET /v1.4/movie/{id}</code> \u043f\u043e\u0438\u0441\u043a \u043f\u043e id</p> <pre><code>$id = 5106881\n$API_KEY = \"ZYMNJJA-0J8MNPN-PB4N7R7-XXXXXXX\"\n\n$Header = @{\n    \"accept\" = \"application/json\"\n    \"X-API-KEY\" = \"$API_KEY\"\n}\n$irm = Invoke-RestMethod \"https://api.kinopoisk.dev/v1.4/movie/$id\" -Method GET -Headers $Header\n$irm.rating.kp # \u0440\u0435\u0439\u0442\u0438\u043d\u0433 \u0432 \u041a\u0438\u043d\u043e\u043f\u043e\u0438\u0441\u043a (8,079)\n$irm.seasonsInfo # \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0435\u0437\u043e\u043d\u043e\u0432 \u0438 \u044d\u043f\u0438\u0437\u043e\u0434\u043e\u0432 \u0432 \u043d\u0438\u0445\n</code></pre> <pre><code>id=5106881\nAPI_KEY=\"ZYMNJJA-0J8MNPN-PB4N7R7-XXXXXXX\"\nget=$(curl -s -X GET \n  \"https://api.kinopoisk.dev/v1.4/movie/$id\" \n  -H \"accept: application/json\" \n  -H \"X-API-KEY: $API_KEY\")\necho $get | jq .rating.kp # \u0440\u0435\u0439\u0442\u0438\u043d\u0433 \u0432 \u041a\u0438\u043d\u043e\u043f\u043e\u0438\u0441\u043a (8,079)\necho $get | jq .seasonsInfo[1].episodesCount # \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u044d\u043f\u0438\u0437\u043e\u0434\u043e\u0432 \u0432\u043e \u0432\u0442\u043e\u0440\u043e\u043c [1] \u0441\u0435\u0437\u043e\u043d\u0435 (6)\n</code></pre> <p><code>GET /v1.4/movie/search</code></p> <pre><code>query=\"zimorodok\"\npage=1 # \u043a\u043e\u043b-\u0432\u043e \u0441\u0442\u0440\u0430\u043d\u0438\u0446 \u0434\u043b\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0438\nlimit=1 # \u043a\u043e\u043b-\u0432\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435\ncurl -s -X GET \n  \"https://api.kinopoisk.dev/v1.4/movie/search?page=$page&amp;limit=$limit&amp;query=$query\" \n  -H \"accept: application/json\" \n  -H \"X-API-KEY: $API_KEY\" | jq .\n\nlimit=5\nrequest=$(curl -s -X GET \n  \"https://api.kinopoisk.dev/v1.4/movie/search?page=$page&amp;limit=$limit&amp;query=%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA\" \n  -H \"accept: application/json\" \n  -H \"X-API-KEY: $API_KEY\" | jq .)\necho $request | jq '.docs[] | select(.year == 2022)' # \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043f\u043e \u0433\u043e\u0434\u0443 \u0432\u044b\u0445\u043e\u0434\u0430\n</code></pre> <pre><code>$API_KEY = \"ZYMNJJA-0J8MNPN-PB4N7R7-XXXXXXX\"\n$page = 1\n$limit = 5\n$query = \"%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA\"\n$request = Invoke-RestMethod -Uri \"https://api.kinopoisk.dev/v1.4/movie/search?page=$page&amp;limit=$limit&amp;query=$query\" -Headers @{\"accept\"=\"application/json\"; \"X-API-KEY\"=\"$API_KEY\"}\n$request.docs | Where-Object year -eq 2022\n</code></pre>"},{"location":"API/#urlcode","title":"UrlCode","text":"<pre><code>function Get-PercentEncode ($str) {\n   $bytes = [System.Text.Encoding]::UTF8.GetBytes($str)\n   ($bytes | ForEach-Object { \"{0:X2}\" -f $_ }) -join '%' -replace \"^\",\"%\"\n}\nGet-PercentEncode \"\u0437\u0438\u043c\u043e\u0440\u043e\u0434\u043e\u043a\"\n</code></pre> <pre><code>function Get-UrlEncode($str) {\n   [System.Web.HttpUtility]::UrlEncode($str)\n}\nUrlEncode \"\u0437\u0438\u043c\u043e\u0440\u043e\u0434\u043e\u043a\"\n</code></pre> <pre><code>percent-encode() {\n    str=$1\n    echo -n \"$1\" | iconv -t utf8 | od -An -tx1 | tr ' ' % | tr -d '\\n'\n}\npercent-encode \"\u0437\u0438\u043c\u043e\u0440\u043e\u0434\u043e\u043a\"\n</code></pre> <pre><code>function Get-UrlDecode($encoded) {\n    [System.Uri]::UnescapeDataString($encoded)\n}\nGet-UrlDecode \"%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA\"\n</code></pre> <pre><code>percent-decode() {\n    encoded=$1\n    local url_encoded=\"${1//+/ }\"\n    printf '%b' \"${url_encoded//%/\\\\x}\"\n}\npercent-decode \"%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA\"\n</code></pre>"},{"location":"API/#kinopoiskapiunofficial","title":"KinopoiskApiUnofficial","text":"<p>\u0411\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e 500 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0432 \u0441\u0443\u0442\u043a\u0438. Swagger documentation</p> <pre><code>API_KEY=\"828ec96a-f45d-4e3d-84b1-XXXXXXXXXXXX\"\n$headers = @{\n    \"accept\" = \"application/json\"\n    \"X-API-KEY\" = \"$API_KEY\"\n}\nInvoke-RestMethod -Uri 'https://kinopoiskapiunofficial.tech/api/v2.2/films/1142153' -Headers $headers\n</code></pre> <p><code>curl -s \"https://kinopoiskapiunofficial.tech/api/v2.2/films/1142153\" -H \"accept: application/json\" -H \"X-API-KEY: $API_KEY\" | jq .</code></p>"},{"location":"API/#kinobox","title":"Kinobox","text":"<p><code>$url = \"https://www.kinopoisk.ru/film/694051\"</code> <code>$kp_id = $url -replace \".+/\"</code> <code>https://kinomix.web.app/#694051</code> <code>curl -s -X GET \"https://kinobox.tv/api/players/main?kinopoisk=$kp_id\" -H \"accept: application/json\"</code> \u043f\u043e\u0438\u0441\u043a \u043f\u043e id \u041a\u0438\u043d\u043e\u043f\u043e\u0438\u0441\u043a  <code>curl -s -X GET \"https://kinobox.tv/api/players/main?imdb=tt2293640\" -H \"accept: application/json\"</code> \u043f\u043e\u0438\u0441\u043a \u043f\u043e id IMDb  <code>curl -s -X GET \"https://kinobox.tv/api/players/main?title=minions\" -H \"accept: application/json\"</code> \u043f\u043e\u0438\u0441\u043a \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u043f\u043b\u0435\u0435\u0440\u043e\u0432 \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e  <code>curl -s -X GET \"https://kinobox.tv/api/players/all?title=minions\" -H \"accept: application/json\"</code> \u043f\u043e\u0438\u0441\u043a \u0432\u0441\u0435\u0445 \u043f\u043b\u0435\u0435\u0440\u043e\u0432  <code>curl -s -X GET \"https://kinobox.tv/api/popular/films\" -H \"accept: application/json\"</code> \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u0444\u0438\u043b\u044c\u043c\u044b  <code>curl -s -X GET \"https://kinobox.tv/api/popular/series\" -H \"accept: application/json\"</code> \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u0441\u0435\u0440\u0438\u0430\u043b\u044b</p>"},{"location":"API/#videocdn","title":"VideoCDN","text":"<p>API Source API JSON</p> <pre><code>$kp_id = 5106881\n$token = \"YfTWH2p3Mai7ziqDoGjS3yXXXXXXXXXX\"\n$ep = \"tv-series\"\n$(Invoke-RestMethod $(\"https://videocdn.tv/api/$ep\"+\"?api_token=$token&amp;field=kinopoisk_id&amp;query=$kp_id\")).data.episodes | Where-Object season_num -eq 2 | Select-Object @{Name=\"Episode\"; Expression={$_.num}}, @{Name=\"Voice\"; Expression={$_.media.translation.title}} # \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u0440\u0438\u0438 \u043f\u043e \u0432\u0442\u043e\u0440\u043e\u043c\u0443 \u0441\u0435\u0437\u043e\u043d\u0443 \u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043e\u0437\u0432\u0443\u0447\u043a\u0438 \u043a \u0441\u0435\u0440\u0438\u044f\u043c\n</code></pre> <pre><code>kp_id=5106881\ntoken=\"YfTWH2p3Mai7ziqDoGjS3yXXXXXXXXXX\"\nep=\"tv-series\"\ncurl -s \"https://videocdn.tv/api/$ep?api_token=$token&amp;field=kinopoisk_id&amp;query=$kp_id\" | jq \".data[].episodes | length\" # \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0435\u0440\u0438\u0439\ncurl -s \"https://videocdn.tv/api/$ep?api_token=$token&amp;field=kinopoisk_id&amp;query=$kp_id\" | jq \".data[].episodes[] | select(.season_num == 2) | {episode: .ru_title, voice: .media[].translation.title}\" # \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0432\u044b\u0432\u043e\u0434\u0430\n</code></pre>"},{"location":"API/#torrent","title":"Torrent","text":""},{"location":"API/#jackett","title":"Jackett","text":"<p>Source</p> <p><code>mkdir /jackett</code> <code>docker-compose.yml</code></p> <pre><code>---\nservices:\n  jackett:\n    image: lscr.io/linuxserver/jackett:latest\n    container_name: jackett\n    environment:\n      - PUID=1000\n      - PGID=1000\n      - TZ=Etc/UTC\n    volumes:\n      - /jackett/data:/config\n      - /jackett/blackhole:/downloads\n    ports:\n      - 9117:9117\n    restart: unless-stopped\n</code></pre> <p><code>docker-compose up -d jackett</code> <code>docker exec -it jackett /bin/bash</code> \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043e\u0431\u043e\u043b\u043e\u0447\u043a\u0435 \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 <code>docker logs -f jackett</code> \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430</p> <p><code>/jackett/data/Jackett/ServerConfig.json</code> \u043c\u0435\u0441\u0442\u043e \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>/jackett/data/Jackett/Indexers/*.json</code> \u043c\u0435\u0441\u0442\u043e \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u0442\u043e\u0440\u043e\u0432</p> <p><code>$API_KEY = \"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\"</code> <code>Invoke-RestMethod \"http://127.0.0.1:9117/api/v2.0/indexers/rutor/results/torznab/api?apikey=$API_KEY\"</code> \u041f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c RSS \u043b\u0435\u043d\u0442\u0443 RuTor <code>$query = \"the+rookie\"</code> <code>Invoke-RestMethod \"http://127.0.0.1:9117/api/v2.0/indexers/rutor/results/torznab/api?apikey=$API_KEY&amp;t=search&amp;cat=&amp;q=$query\"</code> \u043f\u043e\u0438\u0441\u043a \u0432 RuTor <code>Invoke-RestMethod \"http://127.0.0.1:9117/api/v2.0/indexers/kinozal/results/torznab/api?apikey=$API_KEY&amp;t=search&amp;q=$query\"</code> \u043f\u043e\u0438\u0441\u043a \u0432 \u043a\u0438\u043d\u043e\u0437\u0430\u043b <code>Invoke-RestMethod \"http://127.0.0.1:9117/api/v2.0/indexers/kinozal/results/torznab/api?apikey=$API_KEY&amp;t=search&amp;q=$query&amp;cat=5000\"</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043f\u043e \u0441\u0435\u0440\u0438\u0430\u043b\u0430\u043c (Capabilities: 5000) <code>Invoke-RestMethod \"http://127.0.0.1:9117/api/v2.0/indexers/all/results/torznab/api?apikey=$API_KEY&amp;t=search&amp;q=riverdale\"</code> \u043f\u043e\u0438\u0441\u043a \u0432\u043e \u0432\u0441\u0435\u0445 \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u0442\u043e\u0440\u0430\u0445 <code>$(Invoke-RestMethod \"http://127.0.0.1:9117/api/v2.0/indexers/all/results/torznab/api?apikey=$API_KEY&amp;t=indexers&amp;configured=true\").indexers.indexer</code> c\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0445 \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u0442\u043e\u0440\u043e\u0432 (\u0442\u0440\u0435\u043a\u0435\u0440\u043e\u0432)</p>"},{"location":"API/#torrent-api-py","title":"Torrent-API-py","text":"<p>Source Documentation</p> <pre><code>git clone https://github.com/Ryuk-me/Torrent-Api-py\ncd Torrent-Api-py\npip install virtualenv\npy -3 -m venv api-py\n# \u0410\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0440\u0435\u0434\u0443 \u0434\u043b\u044f Windows\n.\\api-py\\Scripts\\activate\n# \u0410\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0440\u0435\u0434\u0443 \u0434\u043b\u044f Linux\n# $ source api-py/bin/activate\n# \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u0438 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c\npip install -r requirements.txt\npython main.py\n# Proxy: https://github.com/dperson/torproxy\n# export HTTP_PROXY=\"http://proxy-host:proxy-port\"\n</code></pre> <p><code>$srv = \"http://localhost:8009\"</code> local <code>$srv = \"https://torrent-api-py-nx0x.onrender.com\"</code> public <code>Invoke-RestMethod $srv/api/v1/sites</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0442\u0440\u0435\u043a\u0435\u0440\u043e\u0432 <code>Invoke-RestMethod \"$srv/api/v1/search/?site=torlock&amp;query=the+rookie&amp;limit=0&amp;page=1\"</code> \u043f\u043e\u0438\u0441\u043a \u0432 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c \u0442\u0440\u0435\u043a\u0435\u0440\u0435 <code>Invoke-RestMethod \"$srv/api/v1/all/search?query=the+rookie&amp;limit=0\"</code> \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0432\u043e \u0432\u0441\u0435\u0445 \u0442\u0440\u0435\u043a\u0435\u0440\u0430\u0445</p>"},{"location":"API/#plex","title":"Plex","text":"<p><code>$API_TOKEN = \"XXXXXXXXXXXXXXXXXXXX\"</code></p> <pre><code>$headers = @{\n    \"X-Plex-Token\" = $API_TOKEN\n    \"accept\" = \"application/json\"\n}\n</code></pre> <p><code>$(Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/servers).MediaContainer.Server</code> \u0432\u0435\u0440\u0441\u0438\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/diagnostics/logs -OutFile log.zip</code> \u0432\u044b\u0433\u0440\u0443\u0438\u0442\u044c \u043b\u043e\u0433 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>$(Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/library/sections).MediaContainer.Directory</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u043a\u0446\u0438\u0439 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 <code>$section_key = $(Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/library/sections).MediaContainer.Directory.key[0]</code> <code>Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/library/sections/$section_key/refresh</code> \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0441\u0435\u043a\u0446\u0438\u0438 \u0432 Plex \u043f\u043e \u043a\u043b\u044e\u0447\u0443 <code>$(Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/library/sections/2/folder).MediaContainer.Metadata</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439 \u0438 \u0444\u0430\u0439\u043b\u043e\u0432 \u0432 \u043a\u043e\u0440\u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u0441\u0435\u043a\u0446\u0438\u0438 <code>$(Invoke-RestMethod -Headers $headers -Uri http://localhost:32400/library/sections/2/folder?parent=204).MediaContainer.Metadata</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0447\u0435\u0440\u0435\u0437 \u043a\u043b\u044e\u0447 (MediaContainer.Metadata.key) \u043a\u043e\u043d\u0435\u0447\u043d\u043e\u0439 \u0442\u043e\u0447\u043a\u0438</p>"},{"location":"API/#jellyfin","title":"Jellyfin","text":"<p>Source API Docs</p> <p><code>$API_TOKEN \"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\"</code> <code>Invoke-RestMethod -Headers @{\"X-Emby-Token\" = $API_TOKEN} http://localhost:8096/Users</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0438 \u0438\u0445 id <code>$Users = Invoke-RestMethod -Headers @{\"X-Emby-Token\" = $API_TOKEN} http://localhost:8096/Users</code> <code>$UserId = $($Users | Where-Object Name -match \"Lifailon\").Id</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c id \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>Invoke-RestMethod -Headers @{\"X-Emby-Token\" = $API_TOKEN} http://localhost:8096/System/Info</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0438\u0441\u0442\u0435\u043c\u0435 <code>$(Invoke-RestMethod -Headers @{\"X-Emby-Token\" = $API_TOKEN} http://localhost:8096/Items).Items</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439 <code>$ItemId = $(Invoke-RestMethod -Headers @{\"X-Emby-Token\" = $API_TOKEN} http://localhost:8096/Items).Items[-1].Id</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c id \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 <code>$Data = $(Invoke-RestMethod -Headers @{\"X-Emby-Token\" = $API_TOKEN} \"http://localhost:8096/Users/$UserId/Items?ParentId=$ItemId\").Items</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u043f\u043e Id \u0438\u0437 Items <code>$TvId = $($data | Where-Object Name -match \"Rookie\").Id</code> \u043d\u0430\u0439\u0442\u0438 \u0441\u0435\u0440\u0438\u0430\u043b \u0438\u043b\u0438 \u0444\u0438\u043b\u044c\u043c \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u0438 \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u0435\u0433\u043e Id <code>$(Invoke-RestMethod -Headers @{\"X-Emby-Token\" = $API_TOKEN} \"http://localhost:8096/Users/$UserId/Items?ParentId=$TvId\").Items</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0434\u043e\u0447\u0435\u0440\u043d\u0435\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u043f\u043e Id \u0435\u0435 \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438</p>"},{"location":"ActiveDirectory/","title":"Active Directory","text":""},{"location":"ActiveDirectory/#rsat-remote-server-administration-tools","title":"RSAT (Remote Server Administration Tools)","text":"<p><code>DISM.exe /Online /add-capability /CapabilityName:Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0 /CapabilityName:Rsat.GroupPolicy.Management.Tools~~~~0.0.1.0</code> <code>Add-WindowsCapability \u2013online \u2013Name Rsat.Dns.Tools~~~~0.0.1.0</code> <code>Add-WindowsCapability -Online -Name Rsat.DHCP.Tools~~~~0.0.1.0</code> <code>Add-WindowsCapability \u2013online \u2013Name Rsat.FileServices.Tools~~~~0.0.1.0</code> <code>Add-WindowsCapability -Online -Name Rsat.WSUS.Tools~~~~0.0.1.0</code> <code>Add-WindowsCapability -Online -Name Rsat.CertificateServices.Tools~~~~0.0.1.0</code> <code>Add-WindowsCapability -Online -Name Rsat.RemoteDesktop.Services.Tools~~~~0.0.1.0</code> <code>Get-WindowsCapability -Name RSAT* -Online | Select-Object -Property DisplayName, State</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u0430\u043d\u0435\u043d\u0442\u043e\u0432</p>"},{"location":"ActiveDirectory/#import-module-activedirectory","title":"Import-Module ActiveDirectory","text":"<p><code>$Session = New-PSSession -ComputerName $srv</code> -Credential $cred  <code>Export-PSsession -Session $Session -Module ActiveDirectory -OutputModule ActiveDirectory</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u0438\u0437 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0439 \u0441\u0435\u0441\u0441\u0438 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0441 DC)  <code>Remove-PSSession -Session $Session</code> <code>Import-Module ActiveDirectory</code> <code>Get-Command -Module ActiveDirectory</code></p>"},{"location":"ActiveDirectory/#adsi-active-directory-service-interface","title":"ADSI (Active Directory Service Interface)","text":"<p><code>$d0 = $env:userdnsdomain</code> <code>$d0 = $d0 -split \"\\.\"</code> <code>$d1 = $d0[0]</code> <code>$d2 = $d0[1]</code> <code>$group = [ADSI]\"LDAP://OU=Domain Controllers,DC=$d1,DC=$d2\"</code> <code>$group | select *</code></p> <p><code>$Local_User = [ADSI]\"WinNT://./\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440,user\"</code> <code>$Local_User | Get-Member</code> <code>$Local_User.Description</code> <code>$Local_User.LastLogin</code> \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</p>"},{"location":"ActiveDirectory/#ldap-lightweight-directory-access-protocol","title":"LDAP (Lightweight Directory Access Protocol)","text":"<p><code>$ldapsearcher = New-Object System.DirectoryServices.DirectorySearcher</code> <code>$ldapsearcher.SearchRoot = \"LDAP://OU=Domain Controllers,DC=$d1,DC=$d2\"</code> <code>$ldapsearcher.Filter = \"(objectclass=computer)\"</code> <code>$dc = $ldapsearcher.FindAll().path</code></p> <p><code>$usr = $env:username</code> c\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>$ldapsearcher = New-Object System.DirectoryServices.DirectorySearcher</code> <code>$ldapsearcher.Filter = \"(&amp;(objectCategory=User)(samAccountName=$usr))\"</code> <code>$usrfind = $ldapsearcher.FindOne()</code> <code>$groups = $usrfind.properties.memberof -replace \"(,OU=.+)\"</code> <code>$groups = $groups -replace \"(CN=)\"</code></p> <p>DC (Domain Component) - \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0434\u043e\u043c\u0435\u043d\u043d\u043e\u0433\u043e \u0438\u043c\u0435\u043d\u0438  OU (Organizational Unit) - \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u043f\u043e\u0434\u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u044f (type), \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0434\u043b\u044f \u0443\u043f\u043e\u0440\u044f\u0434\u043e\u0447\u0435\u043d\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432  Container - \u0442\u0430\u043a \u0436\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0443\u043f\u043e\u0440\u044f\u0434\u043e\u0447\u0435\u043d\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432, \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u044b \u0432 \u043e\u0442\u043b\u0438\u0447\u0438\u0438 \u043e\u0442 \u043f\u043e\u0434\u0440\u0430\u0434\u0435\u043b\u0435\u043d\u0438\u0439 \u043d\u0435 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u044b, \u0443\u0434\u0430\u043b\u0435\u043d\u044b, \u0441\u043e\u0437\u0434\u0430\u043d\u044b \u0438\u043b\u0438 \u0441\u0432\u044f\u0437\u0430\u043d\u044b \u0441 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u043c \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u043e\u0439 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 (Computers, Domain Controllers, Users)  DN (Distinguished Name) \u2014 \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u043e\u0435 \u0438\u043c\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0438 \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0432 \u043b\u0435\u0441\u0443 AD. \u0412 DN \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u043e\u0432 \u0432 \u0434\u0435\u0440\u0435\u0432\u0435 (\u043f\u0443\u0442\u044c \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u0438), \u0442\u0440\u0435\u0431\u0443\u0435\u043c\u043e\u0435 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 \u0438\u043b\u0438 \u0435\u0435 \u043f\u043e\u0438\u0441\u043a\u0430  CN (Common Name) - \u043e\u0431\u0449\u0435\u0435 \u0438\u043c\u044f</p> <p><code>(Get-ADObject (Get-ADRootDSE).DefaultNamingContext -Properties wellKnownObjects).wellKnownObjects</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u044b \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e  <code>redircmp OU=Client Computers,DC=root,DC=domain,DC=local</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043e\u0432 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e  <code>redirusr</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e</p>"},{"location":"ActiveDirectory/#laps-local-admin-password-management","title":"LAPS (Local Admin Password Management)","text":"<p><code>Import-module AdmPwd.ps</code> \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c  <code>Get-AdmPwdPassword -ComputerName NAME</code> \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c  <code>Reset-AdmPwdPassword -ComputerName NAME</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c  <code>Get-ADComputer -Filter * -SearchBase \"DC=$d1,DC=$d2\" | Get-AdmPwdPassword -ComputerName {$_.Name} | select ComputerName,Password,ExpirationTimestamp | Out-GridView</code> <code>Get-ADComputer -Identity $srv | Get-AdmPwdPassword -ComputerName {$_.Name} | select ComputerName,Password,ExpirationTimestamp</code></p>"},{"location":"ActiveDirectory/#recycle-bin","title":"Recycle Bin","text":"<p>\u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0435 AD \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0437\u0430\u0445\u043e\u0440\u043e\u043d\u0435\u043d\u0438\u044f (\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u0432 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 msDS-deletedObjectLifetime), \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u043c \u0434\u043b\u044f \u043b\u0435\u0441\u0430. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u044d\u0442\u043e 180 \u0434\u043d\u0435\u0439. \u0415\u0441\u043b\u0438 \u0434\u0430\u043d\u043d\u044b\u0439 \u0441\u0440\u043e\u043a \u043f\u0440\u043e\u0448\u0435\u043b, \u043e\u0431\u044a\u0435\u043a\u0442 \u0432\u0441\u0435 \u0435\u0449\u0435 \u043e\u0441\u0442\u0430\u0435\u0442\u0441\u044f \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 Deleted Objects, \u043d\u043e \u0431\u043e\u043b\u044c\u0448\u0438\u043d\u0441\u0442\u0432\u043e \u0435\u0433\u043e \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u043e\u0432 \u0438 \u0441\u0432\u044f\u0437\u0435\u0439 \u043e\u0447\u0438\u0449\u0430\u044e\u0442\u0441\u044f (Recycled Object). \u041f\u043e\u0441\u043b\u0435 \u0438\u0441\u0442\u0435\u0447\u0435\u043d\u0438\u044f \u043f\u0435\u0440\u0438\u043e\u0434\u0430 tombstoneLifetime (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0442\u0430\u043a\u0436\u0435 180 \u0434\u043d\u0435\u0439, \u043d\u043e \u043c\u043e\u0436\u043d\u043e \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c) \u043e\u0431\u044a\u0435\u043a\u0442 \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0443\u0434\u0430\u043b\u044f\u0435\u0442\u0441\u044f \u0438\u0437 AD \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c \u043e\u0447\u0438\u0441\u0442\u043a\u0438.  <code>Get-ADForest domain.local</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0440\u0430\u0431\u043e\u0442\u044b \u043b\u0435\u0441\u0430  <code>Set-ADForestMode -Identity domain.local -ForestMode Windows2008R2Forest -force</code> \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0440\u0430\u0431\u043e\u0442\u044b \u043b\u0435\u0441\u0430  <code>Enable-ADOptionalFeature \u2013Identity \"CN=Recycle Bin Feature,CN=Optional Features,CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration,DC=domain,DC=local\" \u2013Scope ForestOrConfigurationSet \u2013Target \"domain.local\"</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043a\u043e\u0440\u0437\u0438\u043d\u0443  <code>Get-ADOptionalFeature \"Recycle Bin Feature\" | select-object name,EnabledScopes</code> \u0435\u0441\u043b\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 EnabledScopes \u043d\u0435 \u043f\u0443\u0441\u0442\u043e\u0435, \u0437\u043d\u0430\u0447\u0438\u0442 \u0432 \u0434\u043e\u043c\u0435\u043d\u0435 \u043a\u043e\u0440\u0437\u0438\u043d\u0430 Active Directory \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0430  <code>Get-ADObject -Filter 'Name -like \"*tnas*\"' -IncludeDeletedObjects</code> \u043d\u0430\u0439\u0442\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u0443\u044e (Deleted: True) \u0423\u0417 (ObjectClass: user) \u0432 AD  <code>Get-ADObject -Filter 'Name -like \"*tnas*\"' \u2013IncludeDeletedObjects -Properties *| select-object Name, sAMAccountName, LastKnownParent, memberOf, IsDeleted | fl</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430 IsDeleted, \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043d\u0430\u0445\u043e\u0434\u0438\u043b\u0441\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435 \u043f\u0435\u0440\u0435\u0434 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435\u043c (LastKnownParent) \u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043e\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u043b  <code>Get-ADObject \u2013filter {Deleted -eq $True -and ObjectClass -eq \"user\"} \u2013includeDeletedObjects</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439  <code>Restore-ADObject -Identity \"3dc33c7c-b912-4a19-b1b7-415c1395a34e\"</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430 ObjectGUID  <code>Get-ADObject -Filter 'SAMAccountName -eq \"tnas-01\"' \u2013IncludeDeletedObjects | Restore-ADObject</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u043e SAMAccountName  <code>Get-ADObject -Filter {Deleted -eq $True -and ObjectClass -eq 'group' -and Name -like '*Allow*'} \u2013IncludeDeletedObjects | Restore-ADObject \u2013Verbose</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0438\u043b\u0438 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440</p>"},{"location":"ActiveDirectory/#thumbnailphoto","title":"thumbnailPhoto","text":"<p><code>$photo = [byte[]](Get-Content C:\\Install\\adm.jpg -Encoding byte)</code> \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432 \u0431\u0430\u0439\u0442\u043e\u0432 (jpeg/bmp \u0444\u0430\u0439\u043b, \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c \u0444\u043e\u0442\u043e \u0434\u043e 100 \u041a\u0431 \u0438 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435\u043c 96?96)  <code>Set-ADUser support4 -Replace @{thumbnailPhoto=$photo}</code> \u0437\u0430\u0434\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430 thumbnailPhoto</p>"},{"location":"ActiveDirectory/#addomaincontroller","title":"ADDomainController","text":"<p><code>Get-ADDomainController</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0442\u0435\u043a\u0443\u0449\u0435\u043c \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 (LogonServer), \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u0430\u043d\u043d\u044b\u043c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043e\u043c \u0434\u043b\u044f \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 (DC \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u0442\u043e\u043f\u043e\u043b\u043e\u0433\u0438\u0435\u0439 \u0441\u0430\u0439\u0442\u043e\u0432 AD)  <code>Get-ADDomainController -Discover -Service PrimaryDC</code> \u043d\u0430\u0439\u0442\u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0441 \u0440\u043e\u043b\u044c\u044e PDC \u0432 \u0434\u043e\u043c\u0435\u043d\u0435  <code>Get-ADDomainController -Filter * | ft HostName,IPv4Address,Name,Site,OperatingSystem,IsGlobalCatalog</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435 DC, \u043f\u0440\u0438\u043d\u0430\u0434\u043b\u0435\u0436\u043d\u043e\u0441\u0442\u044c \u043a \u0441\u0430\u0439\u0442\u0443, \u0432\u0435\u0440\u0441\u0438\u0438 \u041e\u0421 \u0438 GC</p> <p>\u041f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u041e\u0421 \u0441\u043b\u0443\u0436\u0431\u0430 NetLogon \u0434\u0435\u043b\u0430\u0435\u0442 DNS \u0437\u0430\u043f\u0440\u043e\u0441 \u0441\u043e \u0441\u043f\u0438\u0441\u043a\u043e\u043c \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u043e\u0432 \u0434\u043e\u043c\u0435\u043d\u0430 (\u043a SRV \u0437\u0430\u043f\u0438\u0441\u0438 ldap._tcp.dc._msdcs.domain), DNS \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a DC \u0432 \u0434\u043e\u043c\u0435\u043d\u0435 \u0441 \u0437\u0430\u043f\u0438\u0441\u044c\u044e Service Location (SRV). \u041a\u043b\u0438\u0435\u043d\u0442 \u0434\u0435\u043b\u0430\u0435\u0442 LDAP \u0437\u0430\u043f\u0440\u043e\u0441 \u043a DC \u0434\u043b\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0441\u0430\u0439\u0442\u0430 AD \u043f\u043e \u0441\u0432\u043e\u0435\u043c\u0443 IP \u0430\u0434\u0440\u0435\u0441\u0443. \u041a\u043b\u0438\u0435\u043d\u0442 \u0447\u0435\u0440\u0435\u0437 DNS \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u043e\u0432 \u0434\u043e\u043c\u0435\u043d\u0430 \u0432 \u0441\u0430\u0439\u0442\u0435 (\u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 _tcp.sitename._sites...).</p> <p>USN (Update Sequence Numbers) - \u0441\u0447\u0435\u0442\u0447\u0438\u043a \u043d\u043e\u043c\u0435\u0440\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0443 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430 AD. \u041f\u0440\u0438 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u044b \u043e\u0431\u043c\u0435\u043d\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u043c\u0438 USN, \u043e\u0431\u044a\u0435\u043a\u0442 \u0441 \u0431\u043e\u043b\u0435\u0435 \u043d\u0438\u0437\u043a\u0438\u043c USN \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u0430\u043d \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u043c \u0441 \u0431\u043e\u043b\u0435\u0435 \u0432\u044b\u0441\u043e\u043a\u0438\u043c USN. \u041d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0432 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430\u0445 - Object (\u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c View - Advanced Features). \u041a\u0430\u0436\u0434\u044b\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0434\u043e\u043c\u0435\u043d\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u0441\u0447\u0435\u0442\u0447\u0438\u043a USN, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442 \u043e\u0442\u0441\u0447\u0435\u0442 \u0432 \u043c\u043e\u043c\u0435\u043d\u0442 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 Dcpromo \u0438 \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u0435\u0442 \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043e\u0432\u0430\u043d\u0438\u044f \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0434\u043e\u043c\u0435\u043d\u0430. \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0430 USN \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u0436\u0434\u044b\u0439 \u0440\u0430\u0437, \u043a\u043e\u0433\u0434\u0430 \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u044f, \u044d\u0442\u043e \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f, \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0438\u043b\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430.</p> <p><code>Get-ADDomainController -Filter * | % {</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c USN \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043d\u0430 \u0432\u0441\u0435\u0445 DC \u0432 \u0434\u043e\u043c\u0435\u043d\u0435<code></code>Get-ADUser -Server $_.HostName -Identity support4 -Properties uSNChanged | select SamAccountName,uSNChanged<code></code>}`</p> <p><code>dcpromo /forceremoval</code> \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442 \u043f\u043e\u043d\u0438\u0436\u0435\u043d\u0438\u0435 \u0432 \u0440\u043e\u043b\u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0434\u043e\u043c\u0435\u043d\u0430 \u0434\u043e \u0443\u0440\u043e\u0432\u043d\u044f \u0440\u044f\u0434\u043e\u0432\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041f\u043e\u0441\u043b\u0435 \u043f\u043e\u043d\u0438\u0436\u0435\u043d\u0438\u044f \u0440\u043e\u043b\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u0441\u0441\u044b\u043b\u043e\u043a \u0432 \u0434\u043e\u043c\u0435\u043d\u0435 \u043d\u0430 \u044d\u0442\u043e\u0442 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440. \u0414\u0430\u043b\u0435\u0435 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0432 \u0441\u043e\u0441\u0442\u0430\u0432 \u0434\u043e\u043c\u0435\u043d\u0430, \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430, \u0442.\u0435. \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0434\u043e \u0443\u0440\u043e\u0432\u043d\u044f \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0434\u043e\u043c\u0435\u043d\u0430.</p>"},{"location":"ActiveDirectory/#adcomputer","title":"ADComputer","text":"<p><code>nltest /DSGETDC:$env:userdnsdomain</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043d\u0430 \u043a\u0430\u043a\u043e\u043c DC \u0430\u0443\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d \u0445\u043e\u0441\u0442 (Logon Server)  <code>nltest /SC_RESET:$env:userdnsdomain\\srv-dc2.$env:userdnsdomain</code> \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043d\u0430 \u0434\u0440\u0443\u0433\u043e\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0434\u043e\u043c\u0435\u043d\u0430 AD \u0432\u0440\u0443\u0447\u043d\u0443\u044e (The command completed successfully)  <code>Get-ADComputer \u2013Identity $env:computername -Properties PasswordLastSet</code> \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0441\u043c\u0435\u043d\u044b \u043f\u0430\u0440\u043e\u043b\u044f \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435  <code>Test-ComputerSecureChannel \u2013verbose</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0434\u043e\u0432\u0435\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0441 \u0434\u043e\u043c\u0435\u043d\u043e\u043c (\u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u043b\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u043f\u0430\u0440\u043e\u043b\u044e, \u0445\u0440\u0430\u043d\u044f\u0449\u0435\u043c\u0443\u0441\u044f \u0432 AD)  <code>Reset-ComputerMachinePassword -Credential domain\\admin</code> \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c  <code>Netdom ResetPWD /Server:dc-01 /UserD:domain\\admin /PasswordD:*</code> \u0441\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0445\u044d\u0448 \u043f\u0430\u0440\u043e\u043b\u044f \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0432 \u0434\u043e\u043c\u0435\u043d\u0435 (\u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f)  <code>Search-ADAccount -AccountDisabled -ComputersOnly | select Name,LastLogonDate,Enabled</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u044b</p> <p><code>Get-ADComputer -Filter * -Properties * | select name</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043e\u0432 \u0432 \u0434\u043e\u043c\u0435\u043d\u0435 (Filter), \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0435 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430 (Properties)  <code>Get-ADComputer -Identity $srv -Properties * | ft Name,LastLogonDate,PasswordLastSet,ms-Mcs-AdmPwd -Autosize</code> \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0432 AD (Identity)  <code>Get-ADComputer -SearchBase \"OU=Domain Controllers,DC=$d1,DC=$d2\" -Filter * -Properties * | ft Name, LastLogonDate, distinguishedName -Autosize</code> \u043f\u043e\u0438\u0441\u043a \u0432 \u0431\u0430\u0437\u0435 \u043f\u043e DN (SearchBase)</p> <p><code>(Get-ADComputer -Filter {enabled -eq \"true\"}).count</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 (\u043d\u0435\u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445) \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043e\u0432  <code>(Get-ADComputer -Filter {enabled -eq \"true\" -and OperatingSystem -like \"*Windows Server 2016*\"}).count</code> \u043a\u043e\u043b-\u0432\u043e \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u043a\u043e\u043f\u044c\u044e\u0442\u0435\u0440\u043e\u0432 \u0441 \u041e\u0421 WS 2016</p> <p><code>Get-ADComputer -Filter * -Properties * | select @{Label=\"Ping Status\"; Expression={</code> <code>$ping = ping -n 1 -w 50 $_.Name</code> <code>if ($ping -match \"TTL\") {\"Online\"} else {\"Offline\"}</code> <code>}},</code> <code>@{Label=\"Status\"; Expression={</code> <code>if ($_.Enabled -eq \"True\") {$_.Enabled -replace \"True\",\"Active\"} else {$_.Enabled -replace \"False\",\"Blocked\"}</code> <code>}}, Name, IPv4Address, OperatingSystem, @{Label=\"UserOwner\"; Expression={$_.ManagedBy -replace \"(CN=|,.+)\"}</code> <code>},Created | Out-GridView</code></p>"},{"location":"ActiveDirectory/#aduser","title":"ADUser","text":"<p><code>Get-ADUser -Identity support4 -Properties *</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u043e\u0432  <code>Get-ADUser -Identity support4 -Properties DistinguishedName, EmailAddress, Description</code> \u043f\u0443\u0442\u044c DN, email \u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435  <code>Get-ADUser -Filter {(Enabled -eq \"True\") -and (mail -ne \"null\")} -Properties mail | ft Name,mail</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0438 \u0435\u0441\u0442\u044c \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a  <code>Get-ADUser -Filter {SamAccountName -like \"*\"} | Measure-Object</code> \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u043a\u043e\u043b-\u0432\u043e \u0432\u0441\u0435\u0445 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u043e\u0432 (Count)  <code>Get-ADUser -Filter * -Properties WhenCreated | sort WhenCreated | ft Name, whenCreated</code> \u0434\u0430\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f  <code>Get-ADUser -Identity support4 -property LockedOut | select samaccountName,Name,Enabled,Lockedout</code> <code>Enabled=True</code> \u0443\u0447\u0435\u0442\u043d\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0430 - \u0434\u0430  <code>Lockedout=False</code> \u0443\u0447\u0435\u0442\u043d\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u043e\u0439 \u043f\u0430\u0440\u043e\u043b\u0435\u0439) - \u043d\u0435\u0442  <code>Get-ADUser -Identity support4 | Unlock-ADAccount</code> \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0443\u0447\u0435\u0442\u043d\u0443\u044e \u0437\u0430\u043f\u0438\u0441\u044c  <code>Disable-ADAccount -Identity support4</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0443\u0447\u0435\u0442\u043d\u0443\u044e \u0437\u0430\u043f\u0438\u0441\u044c  <code>Enable-ADAccount -Identity support4</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0443\u0447\u0435\u0442\u043d\u0443\u044e \u0437\u0430\u043f\u0438\u0441\u044c  <code>Search-ADAccount -LockedOut</code> \u043d\u0430\u0439\u0442\u0438 \u0432\u0441\u0435 \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0443\u0447\u0435\u0442\u043d\u044b\u0435 \u0437\u0430\u043f\u0438\u0441\u0438  <code>Search-ADAccount -AccountDisabled | select Name,LastLogonDate,Enabled</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0435 \u0443\u0447\u0435\u0442\u043d\u044b\u0435 \u0437\u0430\u043f\u0438\u0441\u0438 \u0441 \u0432\u0440\u0435\u043c\u0435\u043d\u0435\u043c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0432\u0445\u043e\u0434\u0430</p> <p><code>Get-ADUser -Identity support4 -Properties PasswordLastSet,PasswordExpired,PasswordNeverExpires</code> <code>PasswordLastSet</code> \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0441\u043c\u0435\u043d\u044b \u043f\u0430\u0440\u043e\u043b\u044f  <code>PasswordExpired=False</code> \u043f\u0430\u0440\u043e\u043b\u044c \u0438\u0441\u0442\u0435\u043a - \u043d\u0435\u0442  <code>PasswordNeverExpires=True</code> \u0441\u0440\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u0430\u0440\u043e\u043b\u044f \u043d\u0435 \u0438\u0441\u0442\u0435\u043a\u0430\u0435\u0442 - \u0434\u0430  <code>Set-ADAccountPassword support4 -Reset -NewPassword (ConvertTo-SecureString -AsPlainText \"password\" -Force -Verbose)</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438  <code>Set-ADUser -Identity support4 -ChangePasswordAtLogon $True</code> \u0441\u043c\u0435\u043d\u0430 \u043f\u0430\u0440\u043e\u043b\u044f \u043f\u0440\u0438 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c \u0432\u0445\u043e\u0434\u0435 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443</p> <p><code>$day = (Get-Date).adddays(-90)</code> <code>Get-ADUser -filter {(passwordlastset -le $day)} | ft</code> \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u043c\u0435\u043d\u044f\u043b\u0438 \u0441\u0432\u043e\u0439 \u043f\u0430\u0440\u043e\u043b\u044c \u0431\u043e\u043b\u044c\u0448\u0435 90 \u0434\u043d\u0435\u0439</p> <p><code>$day = (Get-Date).adddays(-30)</code> <code>Get-ADUser -filter {(Created -ge $day)} -Property Created | select Name,Created</code> \u041d\u043e\u0432\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u0437\u0430 30 \u0434\u043d\u0435\u0439</p> <p><code>$day = (Get-Date).adddays(-360)</code> <code>Get-ADUser -Filter {(LastLogonTimestamp -le $day)} -Property LastLogonTimestamp | select Name,SamAccountName,@{n='LastLogonTimestamp';e={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} | sort -Descending LastLogonTimestamp</code> \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u043b\u043e\u0433\u0438\u043d\u0438\u043b\u0438\u0441\u044c \u0431\u043e\u043b\u044c\u0448\u0435 360 \u0434\u043d\u0435\u0439. \u0420\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u044f \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430 LastLogonTimestamp \u0441\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u043e\u0442 9 \u0434\u043e 14 \u0434\u043d\u0435\u0439.  <code>| Disable-ADAccount $_.SamAccountName</code> \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c  <code>-WhatIf</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u0431\u0435\u0437 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439</p>"},{"location":"ActiveDirectory/#adgroupmember","title":"ADGroupMember","text":"<p><code>(Get-ADUser -Identity support4 -Properties MemberOf).memberof</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c  <code>Get-ADGroupMember -Identity \"Domain Admins\" | Select Name,SamAccountName</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0432 \u0433\u0440\u0443\u043f\u043f\u0435  <code>Add-ADGroupMember -Identity \"Domain Admins\" -Members support5</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0433\u0440\u0443\u043f\u043f\u0443  <code>Remove-ADGroupMember -Identity \"Domain Admins\" -Members support5 -force</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b  <code>Get-ADGroup -filter * | where {!($_ | Get-ADGroupMember)} | Select Name</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0443\u0441\u0442\u044b\u0445 \u0433\u0440\u0443\u043f\u043f (-Not)</p>"},{"location":"ActiveDirectory/#adreplication","title":"ADReplication","text":"<p><code>Get-Command -Module ActiveDirectory -Name *Replication*</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043a\u043e\u043c\u0430\u043d\u0434\u043b\u0435\u0442\u043e\u0432 \u043c\u043e\u0434\u0443\u043b\u044f  <code>Get-ADReplicationFailure -Target dc-01</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043e\u0448\u0438\u0431\u043e\u043a \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0441 \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u0430\u043c\u0438  <code>Get-ADReplicationFailure -Target $env:userdnsdomain -Scope Domain</code> <code>Get-ADReplicationPartnerMetadata -Target dc-01 | select Partner,LastReplicationAttempt,LastReplicationSuccess,LastReplicationResult,LastChangeUsn</code> \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0438 \u0432\u0440\u0435\u043c\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0439 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0441 \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u0430\u043c\u0438  <code>Get-ADReplicationUpToDatenessVectorTable -Target dc-01</code> Update Sequence Number (USN) \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u0436\u0434\u044b\u0439 \u0440\u0430\u0437, \u043a\u043e\u0433\u0434\u0430 \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u044f (\u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f, \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0438\u043b\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430), \u043f\u0440\u0438 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 DC \u043e\u0431\u043c\u0435\u043d\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u043c\u0438 USN, \u043e\u0431\u044a\u0435\u043a\u0442 \u0441 \u0431\u043e\u043b\u0435\u0435 \u043d\u0438\u0437\u043a\u0438\u043c USN \u043f\u0440\u0438 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u0430\u043d \u0432\u044b\u0441\u043e\u043a\u0438\u043c USN.</p>"},{"location":"ActiveDirectory/#repadmin","title":"repadmin","text":"<p><code>repadmin /replsummary</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u043d\u0430 \u0432\u0441\u0435\u0445 DC \u043f\u043e \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044e (Source \u0438 Destination) \u0438 \u0438\u0445 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u043e\u0432  <code>repadmin /showrepl $srv</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0432\u0441\u0435\u0445 \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u043e\u0432 \u043f\u043e \u0440\u0435\u043f\u043b\u043a\u0430\u0446\u0438\u0438 \u0438 \u0438\u0445 \u0441\u0442\u0430\u0442\u0443\u0441 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 Naming Contexts (DC=ForestDnsZones, DC=DomainDnsZones, CN=Schema, CN=Configuration)  <code>repadmin /replicate $srv2 $srv1 DC=domain,DC=local</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u044e \u0441 $srv1 \u043d\u0430 $srv2 \u0442\u043e\u043b\u044c\u043a\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u0440\u0430\u0437\u0434\u0435\u043b\u0430 \u0434\u043e\u043c\u0435\u043d\u0430  <code>repadmin /SyncAll /AdeP</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043c\u0435\u0436\u0441\u0430\u0439\u0442\u043e\u0432\u0443\u044e \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0443\u044e \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u044e \u0432\u0441\u0435\u0445 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 \u043e\u0442 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0441\u043e \u0432\u0441\u0435\u043c\u0438 \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u0430\u043c\u0438 \u043f\u043e \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>/A</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 NC  <code>/d</code> \u0432 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f\u0445 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440\u044b \u043f\u043e DN (\u0432\u043c\u0435\u0441\u0442\u043e GUID DNS - \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u043c \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u043c \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u0430\u043c)  <code>/e</code> \u043c\u0435\u0436\u0441\u0430\u0439\u0442\u043e\u0432\u0430\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0441 DC \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0441\u0430\u0439\u0442\u0430)  <code>/P</code> \u0438\u0437\u0432\u0435\u0449\u0430\u0442\u044c \u043e\u0431 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f\u0445 \u0441 \u044d\u0442\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: \u043e\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0442\u044c \u043e\u0431 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f\u0445)  <code>repadmin /Queue $srv</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043a\u043e\u043b-\u0432\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0432\u0445\u043e\u0434\u044f\u0449\u0435\u0439 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 (\u043e\u0447\u0435\u0440\u0435\u0434\u044c), \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c (\u043f\u0440\u0438\u0447\u0438\u043d\u043e\u0439 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u043e\u0435 \u043a\u043e\u043b-\u0432\u043e \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u043e\u0432 \u0438\u043b\u0438 \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 1000 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0441\u043a\u0440\u0438\u043f\u0442\u043e\u043c)  <code>repadmin /showbackup *</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0434\u0430\u0442\u0443 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e Backup</p> <p><code>Error: 1722</code> \u0441\u0435\u0440\u0432\u0435\u0440 rpc \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d (\u043e\u0448\u0438\u0431\u043a\u0430 \u043e\u0442\u043a\u0430\u0442\u0430 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438). \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0438\u043c\u044f \u0434\u043e\u043c\u0435\u043d\u0430 \u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445 \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0430, \u043f\u0435\u0440\u0432\u044b\u043c \u0434\u043e\u043b\u0436\u0435\u043d \u0438\u0434\u0442\u0438 \u0430\u0434\u0440\u0435\u0441 DNS-\u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0434\u043e\u043c\u0435\u043d\u0430, \u0432\u0442\u043e\u0440\u044b\u043c \u0441\u0432\u043e\u0439 \u0430\u0434\u0440\u0435\u0441.  <code>Get-Service -ComputerName $srv | select name,status | ? name -like \"RpcSs\"</code> <code>Get-Service -ComputerName $srv -Name RpcSs -RequiredServices</code> \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u044b\u0435 \u0441\u043b\u0443\u0436\u0431\u044b  \u0417\u0430\u0432\u0438\u0441\u0438\u043c\u044b\u0435 \u0441\u043b\u0443\u0436\u0431\u044b RPC:  \"\u0421\u043b\u0443\u0436\u0431\u0430 \u0441\u0432\u0435\u0434\u0435\u043d\u0438\u0439 \u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u0441\u0435\u0442\u044f\u0445\" - \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0432\u043a\u043b\u044e\u0447\u0435\u043d \u043e\u0442\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0439 \u0437\u0430\u043f\u0443\u0441\u043a. \u0415\u0441\u043b\u0438 \u0441\u043b\u0443\u0436\u0431\u0430 \u0441\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0434\u043e \"\u0441\u043b\u0443\u0436\u0431\u044b \u0441\u043f\u0438\u0441\u043a\u0430 \u0441\u0435\u0442\u0435\u0439\", \u043c\u043e\u0436\u0435\u0442 \u043f\u0430\u0434\u0430\u0442\u044c \u0441\u0432\u044f\u0437\u044c \u0441 \u0434\u043e\u043c\u0435\u043d\u043e\u043c (netlogon)  \"\u0426\u0435\u043d\u0442\u0440 \u0440\u0430\u0441\u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043a\u043b\u044e\u0447\u0435\u0439 Kerberos\"  \"DNS-\u0441\u0435\u0440\u0432\u0435\u0440\"  <code>nslookup $srv</code> <code>tnc $srv -p 135</code> <code>repadmin /retry</code> \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0438 \u043a \u0446\u0435\u043b\u0435\u0432\u043e\u043c\u0443 DC, \u0435\u0441\u043b\u0438 \u0431\u044b\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 1722 \u0438\u043b\u0438 1753 (RPC \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d)</p> <p><code>repadmin /showrepl $srv</code> <code>Last attempt @ 2022-07-15 10:46:01 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439, \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 8456 (0x2108)</code> \u043f\u0440\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 showrepl \u044d\u0442\u043e\u0433\u043e \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u0430, \u0435\u0433\u043e \u043e\u0448\u0438\u0431\u043a\u0430: 8457 (0x2109)  <code>Last success @ 2022-07-11 02:29:46</code> \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0443\u0441\u043f\u0435\u0445  \u041a\u043e\u0433\u0434\u0430 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0430, \u041e\u0421 \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0432 DSA - not writable \u043e\u0434\u043d\u043e \u0438\u0437 \u0447\u0435\u0442\u044b\u0440\u0435\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439:  <code>Path: HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\NTDS\\Parameters</code> <code>Dsa Not Writable</code> <code>##define DSA_WRITABLE_GEN 1</code> \u0432\u0435\u0440\u0441\u0438\u044f \u043b\u0435\u0441\u0430 \u043d\u0435\u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u0430 \u0441 \u041e\u0421  <code>##define DSA_WRITABLE_NO_SPACE 2</code> \u043d\u0430 \u0434\u0438\u0441\u043a\u0435, \u0433\u0434\u0435 \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0430 \u0431\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 Active Directory \u0438\u043b\u0438 \u0444\u0430\u0439\u043b\u044b \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432 (\u043b\u043e\u0433\u0438), \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u0430  <code>##define DSA_WRITABLE_USNROLLBCK 4</code> \u043e\u0442\u043a\u0430\u0442 USN \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u0435\u043b \u0438\u0437-\u0437\u0430 \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u0442\u043a\u0430\u0442\u0430 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 Active Directory \u0432\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 (\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0438\u0437 \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u0430)  <code>##define DSA_WRITABLE_CORRUPT_UTDV 8</code> \u0432\u0435\u043a\u0442\u043e\u0440 \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u043f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u043c \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0435 \u0434\u043e\u043c\u0435\u043d\u0430</p>"},{"location":"ActiveDirectory/#dcdiag","title":"dcdiag","text":"<p><code>dcdiag /s:&lt;DomainController&gt; [/n:&lt;NamingContext&gt;] [[/u:&lt;domain\\user&gt;] [/p:&lt;password&gt;]] [{/a|/e}{/q|/v}] [/f:&lt;LogFile&gt;] [/ferr:&lt;ErrorLog&gt;] [/test:&lt;test&gt;] [/fix]</code> <code>dcdiag /Test:replications /s:dc-01</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043e\u0448\u0438\u0431\u043a\u0438 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>dcdiag /Test:DNS /e /v /q</code> \u0442\u0435\u0441\u0442 DNS  <code>/a</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0430\u0439\u0442\u0430  <code>/e</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u044f\u0442\u0438\u044f  <code>/q</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043e\u0431 \u043e\u0448\u0438\u0431\u043a\u0430\u0445  <code>/v</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e  <code>/fix</code> \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0438\u0441\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043e\u0448\u0438\u0431\u043a\u0438  <code>/test:</code> <code>NetLogons</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043f\u0440\u0430\u0432 \u043d\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Connectivity</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e DNS \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0434\u043e\u043c\u0435\u043d\u0430, \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0439 \u044d\u0445\u043e-\u043f\u0430\u043a\u0435\u0442 \u043d\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0434\u043e\u043c\u0435\u043d\u0430 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043f\u043e \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430\u043c LDAP \u0438 RPC \u043a \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0443 \u0434\u043e\u043c\u0435\u043d\u0430  <code>Services</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u043e\u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c \u0432\u0441\u0435\u0445 \u0441\u043b\u0443\u0436\u0431, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0445 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0434\u043e\u043c\u0435\u043d\u0430, \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0435 \u0434\u043e\u043c\u0435\u043d\u0430  <code>Systemlog</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a \u0432 \u0436\u0443\u0440\u043d\u0430\u043b\u0430\u0445 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0434\u043e\u043c\u0435\u043d\u0430  <code>FRSEvent</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043e\u0448\u0438\u0431\u043a\u0438 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0432 \u0440\u0430\u0431\u043e\u0442\u0435 \u0441\u043b\u0443\u0436\u0431\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0444\u0430\u0439\u043b\u043e\u0432, \u0447\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u043e\u0437\u043d\u0430\u0447\u0430\u0442\u044c \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u0432 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 SYSVOL \u0438, \u0442\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u0438 \u043a\u043e\u043f\u0438\u0439 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u044b\u0445 \u043f\u043e\u043b\u0438\u0442\u0438\u043a  <code>FSMOCheck</code> \u043d\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0440\u043e\u043b\u0438 \u0445\u043e\u0437\u044f\u0435\u0432 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439, \u0430 \u0432\u043c\u0435\u0441\u0442\u043e \u044d\u0442\u043e\u0433\u043e \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430, \u043f\u0435\u0440\u0432\u0438\u0447\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0434\u043e\u043c\u0435\u043d\u0430, \u043f\u0440\u0435\u0434\u043f\u043e\u0447\u0442\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 \u0432\u0440\u0435\u043c\u0435\u043d\u0438, \u0441\u0435\u0440\u0432\u0435\u0440 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0438 \u0446\u0435\u043d\u0442\u0440 \u0440\u0430\u0441\u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043a\u043b\u044e\u0447\u0435\u0439 (\u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0434\u043e\u043c\u0435\u043d\u0430 \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a KDC, PDC, \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430)  <code>KnowsOfRoleHolders</code> \u043fg\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u043e\u0432 \u0434\u043e\u043c\u0435\u043d\u0430 \u043a\u043e \u0432\u0441\u0435\u043c \u043f\u044f\u0442\u0438 \u0445\u043e\u0437\u044f\u0435\u0432\u0430\u043c \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439 (\u0440\u043e\u043b\u044f\u043c\u0438 FSMO)  <code>MachineAccount</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 \u0446\u0435\u043b\u0435\u0432\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u0438\u0439 \u0441\u043b\u0443\u0436\u0431 \u044d\u0442\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 (\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0441\u0442\u044c \u0434\u043e\u0432\u0435\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0441 \u0434\u043e\u043c\u0435\u043d\u043e\u043c). \u0415\u0441\u043b\u0438 \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u0435\u0435 \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0443\u0442\u0438\u043b\u0438\u0442\u044b dcdiag, \u0443\u043a\u0430\u0437\u0430\u0432 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b /fixmachineaccount \u0438\u043b\u0438 /recreatemachineaccount  <code>Advertising</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442, \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e \u043b\u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0434\u043e\u043c\u0435\u043d\u0430 \u0441\u043e\u043e\u0431\u0449\u0430\u0435\u0442 \u043e \u0441\u0435\u0431\u0435 \u0438 \u043e \u0441\u0432\u043e\u0435\u0439 \u0440\u043e\u043b\u0438 \u0445\u043e\u0437\u044f\u0438\u043d\u0430 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439. \u042d\u0442\u043e\u0442 \u0442\u0435\u0441\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c\u0441\u044f \u043d\u0435\u0443\u0434\u0430\u0447\u043d\u043e, \u0435\u0441\u043b\u0438 \u0441\u043b\u0443\u0436\u0431\u0430 NetLogon \u043d\u0435 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u0430  <code>CheckSDRefDom</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0434\u043e\u043c\u0435\u043d\u043e\u0432 \u0441\u0441\u044b\u043b\u043e\u043a \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u043e\u0432 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0430 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u0432 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c  <code>CrossRefValidation</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u043a\u0440\u0435\u0441\u0442\u043d\u044b\u0445 \u0441\u0441\u044b\u043b\u043e\u043a \u0434\u043b\u044f \u0434\u043e\u043c\u0435\u043d\u043e\u0432  <code>RRSSysvol</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u0438 \u0434\u043b\u044f FRS SYSVOL  <code>Intersite</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0433\u0443\u0442 \u043f\u043e\u043c\u0435\u0448\u0430\u0442\u044c \u043d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u043e\u0439 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u043c\u0435\u0436\u0434\u0443 \u0441\u0430\u0439\u0442\u0430\u043c\u0438. \u041a\u043e\u043c\u043f\u0430\u043d\u0438\u044f Microsoft \u043f\u0440\u0435\u0434\u0443\u043f\u0440\u0435\u0436\u0434\u0430\u0435\u0442, \u0447\u0442\u043e \u0438\u043d\u043e\u0433\u0434\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u044d\u0442\u043e\u0433\u043e \u0442\u0435\u0441\u0442\u0430 \u043c\u043e\u0433\u0443\u0442 \u043e\u043a\u0430\u0437\u0430\u0442\u044c\u0441\u044f \u043d\u0435\u0442\u043e\u0447\u043d\u044b\u043c\u0438  <code>KCCEvent</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0431\u0435\u0437\u043e\u0448\u0438\u0431\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u043c\u0435\u0436\u0434\u0443 \u0441\u0430\u0439\u0442\u0430\u043c\u0438  <code>NCSecDesc</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0432 \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u0430\u0445 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0434\u043b\u044f \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u043e\u0432 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044f  <code>ObjectsReplicated</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0430\u0433\u0435\u043d\u0442\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u0432 \u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043e\u0432  <code>OutboundSecureChannels</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442\u0441\u044f \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u0445 \u043a\u0430\u043d\u0430\u043b\u043e\u0432 \u043c\u0435\u0436\u0434\u0443 \u0432\u0441\u0435\u043c\u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430\u043c\u0438 \u0434\u043e\u043c\u0435\u043d\u0430 \u0432 \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u0443\u044e\u0449\u0435\u043c \u0434\u043e\u043c\u0435\u043d\u0435  <code>Replications</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430\u043c\u0438 \u0434\u043e\u043c\u0435\u043d\u0430 \u0438 \u0441\u043e\u043e\u0431\u0449\u0430\u0435\u0442 \u043e\u0431\u043e \u0432\u0441\u0435\u0445 \u043e\u0448\u0438\u0431\u043a\u0430\u0445 \u043f\u0440\u0438 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>RidManager</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u043e\u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c \u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u0445\u043e\u0437\u044f\u0438\u043d\u0430 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u043e\u0432  <code>VerifyEnterpriseReferences</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u0441\u0441\u044b\u043b\u043e\u043a \u0441\u043b\u0443\u0436\u0431\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0444\u0430\u0439\u043b\u043e\u0432 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u043d\u0430 \u0432\u0441\u0435\u0445 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430\u0445 \u0434\u043e\u043c\u0435\u043d\u0430 \u0432 \u043b\u0435\u0441\u0443  <code>VerifyReferences</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u0441\u0441\u044b\u043b\u043e\u043a \u0441\u043b\u0443\u0436\u0431\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0444\u0430\u0439\u043b\u043e\u0432 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0435 \u0434\u043e\u043c\u0435\u043d\u0430  <code>VerifyReplicas</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0432\u0441\u0435\u0445 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445, \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e\u0449\u0438\u0445 \u0443\u0447\u0430\u0441\u0442\u0438\u0435 \u0432 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438</p>"},{"location":"ActiveDirectory/#ntdsutil","title":"ntdsutil","text":"<p>\u041f\u0435\u0440\u0435\u043d\u043e\u0441 \u0411\u0414 AD (ntds.dit):  <code>Get-Acl C:\\Windows\\NTDS | Set-Acl D:\\AD-DB</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c NTFS \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043d\u0430 \u043d\u043e\u0432\u044b\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433  <code>Stop-Service -ComputerName dc -name NTDS</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443 Active Directory Domain Services  <code>ntdsutil</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0443\u0442\u0438\u043b\u0438\u0442\u0443 ntdsutil  <code>activate instance NTDS</code> \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u0431\u0430\u0437\u044b AD  <code>files</code> \u043f\u0435\u0440\u0435\u0439\u0434\u0435\u043c \u0432 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 files, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u0441 \u0444\u0430\u0439\u043b\u0430\u043c\u0438 \u0431\u0430\u0437\u044b ntds.dit  <code>move DB to D:\\AD-DB\\</code> \u043f\u0435\u0440\u0435\u043d\u0435\u0441\u0442\u0438 \u0431\u0430\u0437\u0443 AD \u0432 \u043d\u043e\u0432\u044b\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 (\u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0443\u0436\u043d\u043e \u0435\u0433\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u044c)  <code>info</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u0447\u0442\u043e \u0411\u0414 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0432 \u043d\u043e\u0432\u043e\u043c \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435  <code>move logs to D:\\AD-DB\\</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u043c \u0432 \u0442\u043e\u0442 \u0436\u0435 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u0444\u0430\u0439\u043b\u044b \u0441 \u0436\u0443\u0440\u043d\u0430\u043b\u0430\u043c\u0438 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439  <code>quit</code> <code>Start-Service -ComputerName dc -name NTDS</code></p> <p>\u0421\u0431\u0440\u043e\u0441 \u043f\u0430\u0440\u043e\u043b\u044f DSRM (\u0440\u0435\u0436\u0438\u043c \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u043b\u0443\u0436\u0431 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u0432): <code>ntdsutil</code> <code>set dsrm password</code> <code>reset password on server NULL</code>  \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c  \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f  <code>quit</code> <code>quit</code></p> <p>\u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441 \u043f\u0430\u0440\u043e\u043b\u0435\u043c \u0423\u0417 \u0432 AD:  <code>ntdsutil</code> <code>set dsrm password</code> <code>sync from domain account dsrmadmin</code> <code>quit</code> <code>quit</code></p> <p>\u041e\u0448\u0438\u0431\u043a\u0430 0x00002e2 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u041e\u0421.  \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c\u0441\u044f \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0435\u043d\u0438\u044f WinRE (Windows Recovery Environment) - Startup Settings - Restart - DSRM (Directory Services Restore Mode)  <code>reagentc /boottore</code> shutdown /f /r /o /t 0 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 WinRE - \u041e\u0421 \u043d\u0430 \u0431\u0430\u0437\u0435 WinPE (Windows Preinstallation Environment), \u043e\u0431\u0440\u0430\u0437 winre.wim \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u043d\u0430 \u0441\u043a\u0440\u044b\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 System Restore  \u041d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 \u0435\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u0430\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u0430\u044f \u0443\u0447\u0435\u0442\u043d\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c \u2014 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440 DSRM. \u041f\u0430\u0440\u043e\u043b\u044c \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0435 \u0440\u043e\u043b\u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0434\u043e\u043c\u0435\u043d\u0430 ADDS \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 (SafeModeAdministratorPassword).  <code>ntdsutil</code> <code>activate instance ntds</code> <code>Files</code> <code>Info</code> <code>integrity</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u044c \u0411\u0414  \u041e\u0448\u0438\u0431\u043a\u0430: Failed to open DIT for AD DS/LDS instance NTDS. Error -2147418113  <code>mkdir c:\\ntds_bak</code> <code>xcopy c:\\Windows\\NTDS\\*.* c:\\ntds_bak</code> backup \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 \u0441 \u0411\u0414  <code>esentutl /g c:\\windows\\ntds\\ntds.dit</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u043c \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u044c \u0444\u0430\u0439\u043b\u0430  \u0412\u044b\u0432\u043e\u0434: Integrity check completed. Database is CORRUPTED \u043e\u0448\u0438\u0431\u043a\u0430, \u0431\u0430\u0437\u0430 AD \u043f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d\u0430  <code>esentutl /p c:\\windows\\ntds\\ntds.dit</code> \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043e\u0448\u0438\u0431\u043a\u0438  \u0412\u044b\u0432\u043e\u0434: Operation completed successfully in xx seconds. \u043d\u0435\u0442 \u043e\u0448\u0438\u0431\u043e\u043a  <code>esentutl /g c:\\windows\\ntds\\ntds.dit</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u043c \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u044c \u0444\u0430\u0439\u043b\u0430  \u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0430\u043d\u0430\u043b\u0438\u0437 \u0441\u0435\u043c\u0430\u043d\u0442\u0438\u043a\u0438 \u0431\u0430\u0437\u044b \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e ntdsutil:  <code>ntdsutil</code> <code>activate instance ntds</code> <code>semantic database analysis</code> <code>go</code> <code>go fixup</code> \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u0435\u043c\u0430\u043d\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043e\u0448\u0438\u0431\u043a\u0438  \u0421\u0436\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0411\u0414:  <code>activate instance ntds</code> <code>files</code> <code>compact to C:\\Windows\\NTDS\\TEMP</code> <code>copy C:\\Windows\\NTDS\\TEMP\\ntds.dit C:\\Windows\\NTDS\\ntds.dit</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b ntds.dit  <code>Del C:\\Windows\\NTDS\\*.log</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u043b\u043e\u0433 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 NTDS</p>"},{"location":"ActiveDirectory/#gpo","title":"GPO","text":"<p><code>Get-Command -Module GroupPolicy</code> <code>Get-GPO -Domain domain.local -All | ft</code> <code>Get-GPO -Name LAPS</code> <code>[xml](Get-GPOReport LAPS -ReportType Xml)</code> <code>Get-GPPermission -Name LAPS -All</code> <code>Get-GPO LAPS | New-GPLink -Target \"ou=servers,dc=domain,dc=local\"</code> <code>Set-GPLink -Name LAPS -Target \"ou=servers,dc=domain,dc=local\" -LinkEnabled No</code> <code>Backup-GPO -Name LAPS -Path \"$home\\Desktop\"</code> <code>Backup-GPO -All -Path \"$home\\Desktop\"</code> <code>Restore-GPO -Name LAPS -Path C:\\Backup\\GPOs\\</code></p>"},{"location":"Ansible/","title":"Ansible","text":""},{"location":"Ansible/#install","title":"Install","text":"<p><code>apt -y update &amp;&amp; apt -y upgrade</code> <code>apt -y install ansible</code> v2.10.8  <code>apt -y install ansible-core</code> v2.12.0  <code>apt -y install sshpass</code></p> <p><code>ansible-galaxy collection install ansible.windows</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u044e \u043c\u043e\u0434\u0443\u043b\u0435\u0439  <code>ansible-galaxy collection install community.windows</code> <code>ansible-galaxy collection list | grep windows</code> <code>ansible-config dump | grep DEFAULT_MODULE_PATH</code> \u043f\u0443\u0442\u044c \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0443\u043b\u0435\u0439</p> <p><code>apt-get -y install python-dev libkrb5-dev krb5-user</code> \u043f\u0430\u043a\u0435\u0442\u044b \u0434\u043b\u044f Kerberos \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438  <code>apt install python3-pip</code> <code>pip3 install requests-kerberos</code> <code>nano /etc/krb5.conf</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c [realms] \u0438 [domain_realm]  <code>kinit -C support4@domail.local</code> <code>klist</code></p> <p><code>ansible --version</code> <code>config file = None</code> <code>nano /etc/ansible/ansible.cfg</code> \u0444\u0430\u0439\u043b \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438</p> <pre><code>[defaults]\ninventory = /etc/ansible/hosts\n# uncomment this to disable SSH key host checking\n# \u041e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u043a\u043b\u044e\u0447\u0430 ssh (\u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043f\u0430\u0440\u043e\u043b\u044c)\nhost_key_checking = False\n</code></pre>"},{"location":"Ansible/#hosts","title":"Hosts","text":"<p><code>nano /etc/ansible/hosts</code></p> <pre><code>[us]\npi-hole-01 ansible_host=192.168.3.101\nzabbix-01 ansible_host=192.168.3.102\ngrafana-01 ansible_host=192.168.3.103\nnetbox-01 ansible_host=192.168.3.104\n\n[all:vars]\nansible_ssh_port=2121\nansible_user=lifailon\nansible_password=123098\npath_user=/home/lifailon\nansible_python_interpreter=/usr/bin/python3\n\n[ws]\nhuawei-book-01 ansible_host=192.168.3.99\nplex-01 ansible_host=192.168.3.100\n\n[ws:vars]\nansible_port=5985\n#ansible_port=5986\nansible_user=Lifailon\n#ansible_user=support4@DOMAIN.LOCAL\nansible_password=123098\nansible_connection=winrm\nansible_winrm_scheme=http\nansible_winrm_transport=basic\n#ansible_winrm_transport=kerberos\nansible_winrm_server_cert_validation=ignore\nvalidate_certs=false\n\n[win_ssh]\nhuawei-book-01 ansible_host=192.168.3.99\nplex-01 ansible_host=192.168.3.100\n\n[win_ssh:vars]\nansible_python_interpreter=C:\\Users\\Lifailon\\AppData\\Local\\Programs\\Python\\Python311\\` \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u0441\u0440\u0435\u0434\u044b \u0438\u043d\u0442\u0435\u0440\u043f\u0440\u0438\u0442\u0430\u0442\u043e\u0440\u0430 Python \u0432 Windows\nansible_connection=ssh\n#ansible_shell_type=cmd\nansible_shell_type=powershell\n</code></pre> <p><code>ansible-inventory --list</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e (\u0447\u0438\u0442\u0430\u0435\u0442 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 JSON) \u0438\u043b\u0438 YAML (-y) \u0441 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u043e\u043c \u0432\u0441\u0435 \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u043c\u044b\u0445 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445</p>"},{"location":"Ansible/#win_modules","title":"Win_Modules","text":"<p><code>ansible us -m ping</code> <code>ansible win_ssh -m ping</code> <code>ansible us -m shell -a \"uptime &amp;&amp; df -h | grep lv\"</code> <code>ansible us -m setup | grep -iP \"mem|proc\"</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0436\u0435\u043b\u0435\u0437\u0435  <code>ansible us -m apt -a \"name=mc\" -b</code> \u043f\u043e\u0432\u044b\u0441\u0438\u0442\u044c \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u0438 sudo (-b)  <code>ansible us -m service -a \"name=ssh state=restarted enabled=yes\" -b</code> \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443  <code>echo \"echo test\" &gt; test.sh</code> <code>ansible us -m copy -a \"src=test.sh dest=/root mode=777\" -b</code> <code>ansible us -a \"ls /root\" -b</code> <code>ansible us -a \"cat /root/test.sh\" -b</code></p> <p><code>ansible-doc -l | grep win_</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 Windows <code>ansible ws -m win_ping</code> windows \u043c\u043e\u0434\u0443\u043b\u044c  <code>ansible ws -m win_ping -u WinRM-Writer</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043b\u043e\u0433\u0438\u043d  <code>ansible ws -m setup</code> \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0441\u0438\u0441\u0442\u0435\u043c\u0435  <code>ansible ws -m win_whoami</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u0440\u0430\u0432\u0430\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u0430\u0445, \u0433\u0440\u0443\u043f\u043f\u0430\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u0430  <code>ansible ws -m win_shell -a '$PSVersionTable'</code> <code>ansible ws -m win_shell -a 'Get-Service | where name -match \"ssh|winrm\"'</code> <code>ansible ws -m win_service -a \"name=sshd state=stopped\"</code> <code>ansible ws -m win_service -a \"name=sshd state=started\"</code></p>"},{"location":"Ansible/#win_shell-varsdebug","title":"win_shell (vars/debug)","text":"<p><code>nano /etc/ansible/PowerShell-Vars.yml</code></p> <pre><code>- hosts: ws\n ` \u0423\u043a\u0430\u0437\u0430\u0442\u044c \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u044e \u043c\u043e\u0434\u0443\u043b\u0435\u0439\n  collections:\n  - ansible.windows\n ` \u0417\u0430\u0434\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435\n  vars:\n    SearchName: PermitRoot\n  tasks:\n  - name: Get port ssh\n    win_shell: |\n      Get-Content \"C:\\Programdata\\ssh\\sshd_config\" | Select-String \"{{SearchName}}\"\n   ` \u041f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u0432 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e\n    register: command_output\n  - name: Output port ssh\n   ` \u0412\u044b\u0432\u0435\u0441\u0442\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u043d\u0430 \u044d\u043a\u0440\u0430\u043d\n    debug:\n      var: command_output.stdout_lines\n</code></pre> <p><code>ansible-playbook /etc/ansible/PowerShell-Vars.yml</code> <code>ansible-playbook /etc/ansible/PowerShell-Vars.yml --extra-vars \"SearchName='LogLevel|Syslog'\"</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e</p>"},{"location":"Ansible/#win_powershell","title":"win_powershell","text":"<p><code>nano /etc/ansible/powershell-param.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Run PowerShell script with parameters\n    ansible.windows.win_powershell:\n      parameters:\n        Path: C:\\Temp\n        Force: true\n      script: |\n        [CmdletBinding()]\n        param (\n          [String]$Path,\n          [Switch]$Force\n        )\n        New-Item -Path $Path -ItemType Directory -Force:$Force\n</code></pre> <p><code>ansible-playbook /etc/ansible/powershell-param.yml</code></p>"},{"location":"Ansible/#win_chocolatey","title":"win_chocolatey","text":"<p><code>nano /etc/ansible/setup-adobe-acrobat.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Install Acrobat Reader\n    win_chocolatey:\n      name: adobereader\n      state: present\n</code></pre> <p><code>ansible-playbook /etc/ansible/setup-adobe-acrobat.yml</code></p> <p><code>nano /etc/ansible/setup-openssh.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: install the Win32-OpenSSH service\n    win_chocolatey:\n      name: openssh\n      package_params: /SSHServerFeature\n      state: present\n</code></pre> <p><code>ansible-playbook /etc/ansible/setup-openssh.yml</code></p>"},{"location":"Ansible/#win_regedit","title":"win_regedit","text":"<p><code>nano /etc/ansible/win-set-shell-ssh-ps7.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Set the default shell to PowerShell 7 for Windows OpenSSH\n    win_regedit:\n      path: HKLM:\\SOFTWARE\\OpenSSH\n      name: DefaultShell\n     ` data: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n      data: 'C:\\Program Files\\PowerShell\\7\\pwsh.exe'\n      type: string\n      state: present\n</code></pre> <p><code>ansible-playbook /etc/ansible/win-set-shell-ssh-ps7.yml</code></p>"},{"location":"Ansible/#win_service","title":"win_service","text":"<p><code>nano /etc/ansible/win-service.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Start service\n    win_service:\n      name: sshd\n      state: started\n#     state: stopped\n#     state: restarted\n#     start_mode: auto\n</code></pre> <p><code>ansible-playbook /etc/ansible/win-service.yml</code></p>"},{"location":"Ansible/#win_service_info","title":"win_service_info","text":"<p><code>nano /etc/ansible/get-service.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Get info for a single service\n    win_service_info:\n      name: sshd\n    register: service_info\n  - name: Print returned information\n    ansible.builtin.debug:\n      var: service_info.services\n</code></pre> <p><code>ansible-playbook /etc/ansible/get-service.yml</code></p>"},{"location":"Ansible/#fetchslurp","title":"fetch/slurp","text":"<p><code>nano /etc/ansible/copy-from-win-to-local.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Retrieve remote file on a Windows host\n#   \u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0438\u0437 Windows-\u0441\u0438\u0441\u0442\u0435\u043c\u044b\n    ansible.builtin.fetch:\n#   \u041f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0444\u0430\u0439\u043b (\u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0432 \u043f\u0430\u043c\u044f\u0442\u044c \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 Base64)\n#   ansible.builtin.slurp:\n      src: C:\\Telegraf\\telegraf.conf\n      dest: /root/telegraf.conf\n      flat: yes\n    register: telegraf_conf\n  - name: Print returned information\n    ansible.builtin.debug:\n      msg: \"{{ telegraf_conf['content'] | b64decode }}\"\n</code></pre> <p><code>ansible-playbook /etc/ansible/copy-from-win-to-local.yml</code></p>"},{"location":"Ansible/#win_copy","title":"win_copy","text":"<p><code>echo \"Get-Service | where name -eq vss | Start-Service\" &gt; /home/lifailon/Start-Service-VSS.ps1</code> <code>nano /etc/ansible/copy-file-to-win.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Copy file to win hosts\n    win_copy:\n      src: /home/lifailon/Start-Service-VSS.ps1\n      dest: C:\\Users\\Lifailon\\Desktop\\Start-Service-VSS.ps1\n</code></pre> <p><code>ansible-playbook /etc/ansible/copy-file-to-win.yml</code></p> <p><code>curl -OL https://github.com/PowerShell/PowerShell/releases/download/v7.3.6/PowerShell-7.3.6-win-x64.msi</code> <code>nano /etc/ansible/copy-file-to-win.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Copy file to win hosts\n    win_copy:\n      src: /home/lifailon/PowerShell-7.3.6-win-x64.msi\n      dest: C:\\Install\\PowerShell-7.3.6.msi\n</code></pre> <p><code>ansible-playbook /etc/ansible/copy-file-to-win.yml</code></p>"},{"location":"Ansible/#win_command","title":"win_command","text":"<p><code>nano /etc/ansible/run-script-ps1.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Run PowerShell Script\n    win_command: powershell -ExecutionPolicy ByPass -File C:\\Users\\Lifailon\\Desktop\\Start-Service-VSS.ps1\n</code></pre> <p><code>ansible-playbook /etc/ansible/run-script-ps1.yml</code></p>"},{"location":"Ansible/#win_package","title":"win_package","text":"<p><code>nano /etc/ansible/setup-msi-package.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Install MSI Package\n    win_package:\n#     path: C:\\Install\\7z-23.01.msi\n      path: C:\\Install\\PowerShell-7.3.6.msi\n      arguments:\n        - /quiet\n        - /passive\n        - /norestart\n</code></pre> <p><code>ansible-playbook /etc/ansible/setup-msi-package.yml</code></p>"},{"location":"Ansible/#win_firewall_rule","title":"win_firewall_rule","text":"<p><code>nano /etc/ansible/win-fw-open.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Open RDP port\n    win_firewall_rule:\n      name: Open RDP port\n      localport: 3389\n      action: allow\n      direction: in\n      protocol: tcp\n      state: present\n      enabled: yes\n</code></pre> <p><code>ansible-playbook /etc/ansible/win-fw-open.yml</code></p>"},{"location":"Ansible/#win_group","title":"win_group","text":"<p><code>nano /etc/ansible/win-creat-group.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Create a new group\n    win_group:\n      name: deploy\n      description: Deploy Group\n      state: present\n</code></pre> <p><code>ansible-playbook /etc/ansible/win-creat-group.yml</code></p>"},{"location":"Ansible/#win_group_membership","title":"win_group_membership","text":"<p><code>nano /etc/ansible/add-user-to-group.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Add a local and domain user to a local group\n    win_group_membership:\n      name: deploy\n      members:\n        - WinRM-Writer\n      state: present\n</code></pre> <p><code>ansible-playbook /etc/ansible/add-user-to-group.yml</code></p>"},{"location":"Ansible/#win_user","title":"win_user","text":"<p><code>nano /etc/ansible/creat-win-user.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Creat user\n    win_user:\n      name: test\n      password: 123098\n      state: present\n      groups:\n        - deploy\n</code></pre> <p><code>ansible-playbook /etc/ansible/creat-win-user.yml</code></p> <p><code>nano /etc/ansible/delete-win-user.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Delete user\n    ansible.windows.win_user:\n      name: test\n      state: absent\n</code></pre> <p><code>ansible-playbook /etc/ansible/delete-win-user.yml</code></p>"},{"location":"Ansible/#win_feature","title":"win_feature","text":"<p><code>nano /etc/ansible/install-feature.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Install Windows Feature\n      win_feature:\n        name: SNMP-Service\n        state: present\n</code></pre> <p><code>ansible-playbook /etc/ansible/install-feature.yml</code></p>"},{"location":"Ansible/#win_reboot","title":"win_reboot","text":"<p><code>nano /etc/ansible/win-reboot.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Reboot a slow machine that might have lots of updates to apply\n    win_reboot:\n      reboot_timeout: 3600\n</code></pre> <p><code>ansible-playbook /etc/ansible/win-reboot.yml</code></p>"},{"location":"Ansible/#win_find","title":"win_find","text":"<p><code>nano /etc/ansible/win-ls.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Find files in multiple paths\n    ansible.windows.win_find:\n      paths:\n      - D:\\Install\\OpenSource\n      patterns: ['*.rar','*.zip','*.msi']\n     ` \u0424\u0430\u0439\u043b \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u0435\u043d\u0435\u0435 7 \u0434\u043d\u0435\u0439 \u043d\u0430\u0437\u0430\u0434\n      age: -7d\n     ` \u0420\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430 \u0431\u043e\u043b\u044c\u0448\u0435 10MB\n      size: 10485760\n     ` \u0420\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u044b\u0439 \u043f\u043e\u0438\u0441\u043a (\u0432 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f\u0445)\n      recurse: true\n    register: command_output\n  - name: Output\n    debug:\n      var: command_output\n</code></pre> <p><code>ansible-playbook /etc/ansible/win-ls.yml</code></p>"},{"location":"Ansible/#win_uri","title":"win_uri","text":"<p><code>nano /etc/ansible/rest-get.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: REST GET request to endpoint github\n    ansible.windows.win_uri:\n      url: https://api.github.com/repos/Lifailon/pSyslog/releases/latest\n    register: http_output\n  - name: Output\n    debug:\n      var: http_output\n</code></pre> <p><code>ansible-playbook /etc/ansible/rest-get.yml</code></p>"},{"location":"Ansible/#win_updates","title":"win_updates","text":"<p><code>nano /etc/ansible/win-update.yml</code></p> <pre><code>- hosts: ws\n  tasks:\n  - name: Install only particular updates based on the KB numbers\n    ansible.windows.win_updates:\n      category_names:\n      - SecurityUpdates\n      - CriticalUpdates\n      - UpdateRollups\n      - Drivers\n     ` \u0424\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f\n     ` accept_list:\n     ` - KB2267602\n     ` \u041f\u043e\u0438\u0441\u043a \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439\n     ` state: searched\n     ` \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\n     ` state: downloaded\n     ` \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\n      state: installed\n      log_path: C:\\Ansible-Windows-Upadte-Log.txt\n      reboot: false\n    register: wu_output\n  - name: Output\n    debug:\n      var: wu_output\n</code></pre> <p><code>ansible-playbook /etc/ansible/win-update.yml</code></p>"},{"location":"Ansible/#win_chocolatey_1","title":"win_chocolatey","text":"<p>Install API Deployment</p> <pre><code>- name: Ensure Chocolatey installed from internal repo\n  win_chocolatey:\n    name: chocolatey\n    state: present\n    # source: URL-\u0430\u0434\u0440\u0435\u0441 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0433\u043e \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f\n    source: https://community.chocolatey.org/api/v2/ChocolateyInstall.ps1\n</code></pre>"},{"location":"COM/","title":"Component Object Model","text":""},{"location":"COM/#shell","title":"Shell","text":"<p><code>$wshell = New-Object -ComObject Wscript.Shell</code> <code>$wshell | Get-Member</code> <code>$link = $wshell.CreateShortcut(\"$Home\\Desktop\\Yandex.lnk\")</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u044f\u0440\u043b\u044b\u043a  <code>$link | Get-Member</code> <code>$link.TargetPath = \"https://yandex.ru\"</code> \u043a\u0443\u0434\u0430 \u0441\u0441\u044b\u043b\u0430\u0435\u0442\u0441\u044f (\u043c\u0435\u0442\u043e\u0434 TargetPath \u043e\u0431\u044a\u0435\u043a\u0442\u0430 $link \u0433\u0434\u0435 \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u043e\u0431\u044a\u0435\u043a\u0442 CreateShortcut)  <code>$link.Save()</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c</p> <p><code>Set-WinUserLanguageList -LanguageList en-us,ru -Force</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u044f\u0437\u044b\u043a\u043e\u0432\u0443\u044e \u0440\u0430\u0441\u043a\u043b\u0430\u0434\u043a\u0443 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b</p>"},{"location":"COM/#sendkeys","title":"SendKeys","text":"<p><code>(New-Object -ComObject Wscript.shell).SendKeys([char]173)</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c/\u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0437\u0432\u0443\u043a  <code>$wshell.Exec(\"notepad.exe\")</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435  <code>$wshell.AppActivate(\"\u0411\u043b\u043e\u043a\u043d\u043e\u0442\")</code> \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u043e\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435</p> <p><code>$wshell.SendKeys(\"Login\")</code> \u0442\u0435\u043a\u0441\u0442  <code>$wshell.SendKeys(\"{A 5}\")</code> \u043d\u0430\u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u0431\u0443\u043a\u0432\u0443 5 \u0440\u0430\u0437 \u043f\u043e\u0434\u0440\u044f\u0434  <code>$wshell.SendKeys(\"%{TAB}\")</code> ALT+TAB  <code>$wshell.SendKeys(\"^\")</code> CTRL  <code>$wshell.SendKeys(\"%\")</code> ALT  <code>$wshell.SendKeys(\"+\")</code> SHIFT  <code>$wshell.SendKeys(\"{DOWN}\")</code> \u0432\u043d\u0438\u0437  <code>$wshell.SendKeys(\"{UP}\")</code> \u0432\u0432\u0435\u0440\u0445  <code>$wshell.SendKeys(\"{LEFT}\")</code> \u0432\u043b\u0435\u0432\u043e  <code>$wshell.SendKeys(\"{RIGHT}\")</code> \u0432\u043f\u0440\u0430\u0432\u043e  <code>$wshell.SendKeys(\"{PGUP}\")</code> PAGE UP  <code>$wshell.SendKeys(\"{PGDN}\")</code> PAGE DOWN  <code>$wshell.SendKeys(\"{BACKSPACE}\")</code> BACKSPACE/BKSP/BS  <code>$wshell.SendKeys(\"{DEL}\")</code> DEL/DELETE  <code>$wshell.SendKeys(\"{INS}\")</code> INS/INSERT  <code>$wshell.SendKeys(\"{PRTSC}\")</code> PRINT SCREEN  <code>$wshell.SendKeys(\"{ENTER}\")</code> <code>$wshell.SendKeys(\"{ESC}\")</code> <code>$wshell.SendKeys(\"{TAB}\")</code> <code>$wshell.SendKeys(\"{END}\")</code> <code>$wshell.SendKeys(\"{HOME}\")</code> <code>$wshell.SendKeys(\"{BREAK}\")</code> <code>$wshell.SendKeys(\"{SCROLLLOCK}\")</code> <code>$wshell.SendKeys(\"{CAPSLOCK}\")</code> <code>$wshell.SendKeys(\"{NUMLOCK}\")</code> <code>$wshell.SendKeys(\"{F1}\")</code> <code>$wshell.SendKeys(\"{F12}\")</code> <code>$wshell.SendKeys(\"{+}{^}{%}{~}{(}{)}{[}{]}{{}{}}\")</code></p> <pre><code>function Get-AltTab {\n    (New-Object -ComObject wscript.shell).SendKeys(\"%{Tab}\")\n    Start-Sleep $(Get-Random -Minimum 30 -Maximum 180)\n    Get-AltTab\n}\n</code></pre> <p><code>Get-AltTab</code></p>"},{"location":"COM/#popup","title":"Popup","text":"<p><code>$wshell = New-Object -ComObject Wscript.Shell</code> <code>$output = $wshell.Popup(\"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435?\",0,\"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a\",4)</code> <code>if ($output -eq 6) {\"yes\"} elseif ($output -eq 7) {\"no\"} else {\"no good\"}</code></p> <pre><code>Type:\n0 \u041e\u041a\n1 \u041e\u041a \u0438 \u041e\u0442\u043c\u0435\u043d\u0430\n2 \u0421\u0442\u043e\u043f, \u041f\u043e\u0432\u0442\u043e\u0440, \u041f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c\n3 \u0414\u0430, \u041d\u0435\u0442, \u041e\u0442\u043c\u0435\u043d\u0430\n4 \u0414\u0430 \u0438 \u041d\u0435\u0442\n5 \u041f\u043e\u0432\u0442\u043e\u0440 \u0438 \u041e\u0442\u043c\u0435\u043d\u0430\n16 Stop\n32 Question\n48 Exclamation\n64 Information\n\nOutput:\n-1 Timeout\n1 \u041e\u041a\n2 \u041e\u0442\u043c\u0435\u043d\u0430\n3 \u0421\u0442\u043e\u043f\n4 \u041f\u043e\u0432\u0442\u043e\u0440\n5 \u041f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c\n6 \u0414\u0430\n7 \u041d\u0435\u0442\n</code></pre>"},{"location":"COM/#internet-explorer","title":"Internet Explorer","text":"<p><code>$ie.document.IHTMLDocument3_getElementsByTagName(\"input\")  | select name</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043c\u0435\u043d\u0430 \u0432\u0441\u0435\u0445 Input Box  <code>$ie.document.IHTMLDocument3_getElementsByTagName(\"button\") | select innerText</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043c\u0435\u043d\u0430 \u0432\u0441\u0435\u0445 Button  <code>$ie.Document.documentElement.innerHTML</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0441\u044b\u0440\u043e\u0439 Web Content (&lt;input name=\"login\" tabindex=\"100\" class=\"input__control input__input\" id=\"uniq32005644019429136\" spellcheck=\"false\" placeholder=\"\u041b\u043e\u0433\u0438\u043d\")  <code>$All_Elements = $ie.document.IHTMLDocument3_getElementsByTagName(\"*\")</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u0432\u0441\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b  <code>$Go_Button = $All_Elements | ? innerText -like \"go\"</code> \u043f\u043e\u0438\u0441\u043a \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u043f\u043e \u0438\u043c\u0435\u043d\u0438  <code>$Go_Button | select ie9_tagName</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c TagName (SPAN) \u0434\u043b\u044f \u0431\u044b\u0441\u0442\u0440\u043e\u0433\u043e \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0435\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430  <code>$SPAN_Elements = $ie.document.IHTMLDocument3_getElementsByTagName(\"SPAN\")</code></p> <pre><code>$ie = New-Object -ComObject InternetExplorer.Application\n$ie.navigate(\"https://yandex.ru\")\n$ie.visible = $true\n$ie.document.IHTMLDocument3_getElementByID(\"login\").value = \"Login\"\n$ie.document.IHTMLDocument3_getElementByID(\"passwd\").value = \"Password\"\n$Button_Auth = ($ie.document.IHTMLDocument3_getElementsByTagName(\"button\")) | ? innerText -match \"\u0412\u043e\u0439\u0442\u0438\"\n$Button_Auth.Click()\n$Result = $ie.Document.documentElement.innerHTML\n$ie.Quit()\n</code></pre>"},{"location":"COM/#excel","title":"Excel","text":"<pre><code>$path = \"$home\\Desktop\\Services-to-Excel.xlsx\"\n$Excel = New-Object -ComObject Excel.Application\n$Excel.Visible = $false` \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u0435 GUI\n$ExcelWorkBook = $Excel.Workbooks.Add()` \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043d\u0438\u0433\u0443\n$ExcelWorkSheet = $ExcelWorkBook.Worksheets.Item(1)` \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043b\u0438\u0441\u0442\n$ExcelWorkSheet.Name = \"Services\"` \u0437\u0430\u0434\u0430\u0442\u044c \u0438\u043c\u044f \u043b\u0438\u0441\u0442\u0430\n$ExcelWorkSheet.Cells.Item(1,1) = \"Name service\"\n# \u0417\u0430\u0434\u0430\u0442\u044c \u0438\u043c\u0435\u043d\u0430 \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432:\n$ExcelWorkSheet.Cells.Item(1,2) = \"Description\"\n$ExcelWorkSheet.Cells.Item(1,3) = \"Status\"\n$ExcelWorkSheet.Cells.Item(1,4) = \"Startup type\"\n$ExcelWorkSheet.Rows.Item(1).Font.Bold = $true` \u0432\u044b\u0434\u0435\u043b\u0438\u0442\u044c \u0436\u0438\u0440\u043d\u044b\u043c \u0448\u0440\u0438\u0444\u0442\u043e\u043c\n$ExcelWorkSheet.Rows.Item(1).Font.size=14\n# \u0417\u0430\u0434\u0430\u0442\u044c \u0448\u0438\u0440\u0438\u043d\u0443 \u043a\u043e\u043b\u043e\u043d\u043e\u043a:\n$ExcelWorkSheet.Columns.Item(1).ColumnWidth=30\n$ExcelWorkSheet.Columns.Item(2).ColumnWidth=80\n$ExcelWorkSheet.Columns.Item(3).ColumnWidth=15\n$ExcelWorkSheet.Columns.Item(4).ColumnWidth=25\n$services =  Get-Service\n$counter = 2` \u0437\u0430\u0434\u0430\u0442\u044c \u043d\u0430\u0447\u0430\u043b\u044c\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0441\u0442\u0440\u043e\u043a\u0438 \u0434\u043b\u044f \u0437\u0430\u043f\u0438\u0441\u0438\nforeach ($service in $services) {\n    $status = $service.Status\n    if ($status -eq 1) {\n        $status_type = \"Stopped\"\n    } elseif ($status -eq 4) {\n        $status_type = \"Running\"\n    }\n    $Start = $service.StartType\n    if ($Start -eq 1) {\n        $start_type = \"Delayed start\"\n    } elseif ($Start -eq 2) {\n        $start_type = \"Automatic\"\n    } elseif ($Start -eq 3) {\n        $start_type = \"Manually\"\n    } elseif ($Start -eq 4) {\n        $start_type = \"Disabled\"\n    }\n    $ExcelWorkSheet.Columns.Item(1).Rows.Item($counter) = $service.Name\n    $ExcelWorkSheet.Columns.Item(2).Rows.Item($counter) = $service.DisplayName\n    $ExcelWorkSheet.Columns.Item(3).Rows.Item($counter) = $status_type\n    $ExcelWorkSheet.Columns.Item(4).Rows.Item($counter) = $start_type\n    if ($status_type -eq \"Running\") {\n        $ExcelWorkSheet.Columns.Item(3).Rows.Item($counter).Font.Bold = $true\n    }\n    # +1 \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0434\u043b\u044f \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0430 \u0441\u0442\u0440\u043e\u043a\u0438 Rows\n    $counter++\n}\n$ExcelWorkBook.SaveAs($path)\n$ExcelWorkBook.close($true)\n$Excel.Quit()\n</code></pre>"},{"location":"COM/#excelapplicationopen","title":"Excel.Application.Open","text":"<pre><code>$path = \"$home\\Desktop\\Services-to-Excel.xlsx\"\n$Excel = New-Object -ComObject Excel.Application\n$Excel.Visible = $false\n$ExcelWorkBook = $excel.Workbooks.Open($path)` \u043e\u0442\u043a\u0440\u044b\u0442\u044c xlsx-\u0444\u0430\u0439\u043b\n$ExcelWorkBook.Sheets | select Name,Index` \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043b\u0438\u0441\u0442\u044b\n$ExcelWorkSheet = $ExcelWorkBook.Sheets.Item(1)` \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u043b\u0438\u0441\u0442 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 Index\n1..100 | %{$ExcelWorkSheet.Range(\"A$_\").Text}` \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0438\u0437 \u0441\u0442\u043e\u043b\u0431\u0446\u0430 \u0410 \u0441\u0442\u0440\u043e\u043a\u0438 c 1 \u043f\u043e 100\n$Excel.Quit()\n</code></pre>"},{"location":"COM/#network","title":"Network","text":"<p><code>$wshell = New-Object -ComObject WScript.Network</code> <code>$wshell | Get-Member</code> <code>$wshell.UserName</code> <code>$wshell.ComputerName</code> <code>$wshell.UserDomain</code></p>"},{"location":"COM/#application","title":"Application","text":"<p><code>$wshell = New-Object -ComObject Shell.Application</code> <code>$wshell | Get-Member</code> <code>$wshell.Explore(\"C:\\\")</code> <code>$wshell.Windows() | Get-Member</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u043c \u0432 \u043f\u0440\u043e\u0432\u043e\u0434\u043d\u0438\u043a\u0435 \u0438\u043b\u0438 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 Internet Explorer \u043e\u043a\u043e\u043d</p> <p><code>$shell = New-Object -Com Shell.Application</code> <code>$RecycleBin = $shell.Namespace(10)</code> <code>$RecycleBin.Items()</code></p>"},{"location":"COM/#outlook","title":"Outlook","text":"<p><code>$Outlook = New-Object -ComObject Outlook.Application</code> <code>$Outlook | Get-Member</code> <code>$Outlook.Version</code></p> <pre><code>$Outlook = New-Object -ComObject Outlook.Application\n$Namespace = $Outlook.GetNamespace(\"MAPI\")\n$Folder = $namespace.GetDefaultFolder(4)` \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0435\n$Folder = $namespace.GetDefaultFolder(6)` \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435\n$Explorer = $Folder.GetExplorer()\n$Explorer.Display() \n$Outlook.Quit()\n</code></pre>"},{"location":"COM/#update","title":"Update","text":"<p><code>(New-Object -com 'Microsoft.Update.AutoUpdate').Settings</code> <code>(New-Object -com 'Microsoft.Update.AutoUpdate').Results</code> <code>(New-Timespan -Start ((New-Object -com 'Microsoft.Update.AutoUpdate').Results|Select -ExpandProperty LastInstallationSuccessDate) -End (Get-Date)).hours</code> \u043a\u043e\u043b-\u0432\u043e \u0447\u0430\u0441\u043e\u0432, \u043f\u0440\u043e\u0448\u0435\u0434\u0448\u0438\u0445 \u0441 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0434\u0430\u0442\u044b \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0432 Windows.</p>"},{"location":"Database/","title":"Database","text":""},{"location":"Database/#influxdb","title":"InfluxDB","text":"<p>Download InfluxDB 1.x Open Source InfluxDB-Studio</p>"},{"location":"Database/#install-windows","title":"Install Windows","text":"<pre><code>Invoke-RestMethod \"https://dl.influxdata.com/influxdb/releases/influxdb-1.8.10_windows_amd64.zip\" -OutFile \"$home\\Downloads\\influxdb-1.8.10_windows_amd64.zip\"\nExpand-Archive \"$home\\Downloads\\influxdb-1.8.10_windows_amd64.zip\" -DestinationPath \"$home\\Documents\\\"\nRemove-Item \"$home\\Downloads\\influxdb-1.8.10_windows_amd64.zip\"\n&amp; \"$home\\Downloads\\influxdb-1.8.10-1\\influxd.exe\"\n</code></pre>"},{"location":"Database/#install-ubuntu","title":"Install Ubuntu","text":"<pre><code>wget https://dl.influxdata.com/influxdb/releases/influxdb_1.8.10_amd64.deb\nsudo dpkg -i influxdb_1.8.10_amd64.deb\nsystemctl start influxdb\nsystemctl status influxdb\n\nps aux | grep influxdb | grep -Ev \"grep\"\nnetstat -natpl | grep 80[8-9][3-9]\n</code></pre>"},{"location":"Database/#api","title":"API","text":"<pre><code>nano /etc/influxdb/influxdb.conf\n\n[http]\n  enabled = true\n  bind-address = \":8086\"\n  auth-enabled = false\n\nsystemctl restart influxdb\n</code></pre>"},{"location":"Database/#chronograf","title":"Chronograf","text":"<pre><code>wget https://dl.influxdata.com/chronograf/releases/chronograf-1.10.2_windows_amd64.zip -UseBasicParsing -OutFile chronograf-1.10.2_windows_amd64.zip\nExpand-Archive .\\chronograf-1.10.2_windows_amd64.zip -DestinationPath 'C:\\Program Files\\InfluxData\\chronograf\\'\n\nwget https://dl.influxdata.com/chronograf/releases/chronograf_1.10.2_amd64.deb\nsudo dpkg -i chronograf_1.10.2_amd64.deb\nsystemctl status influxdb\nhttp://192.168.3.102:8888\n</code></pre>"},{"location":"Database/#grafana","title":"Grafana","text":"<p>Download</p> <p><code>invoke-RestMethod https://dl.grafana.com/enterprise/release/grafana-enterprise-10.3.1.windows-amd64.msi -OutFile \"$home\\Download\\grafana.msi\"</code></p> <pre><code>apt-get install -y adduser libfontconfig1 musl\nwget https://dl.grafana.com/enterprise/release/grafana-enterprise_10.3.1_amd64.deb\ndpkg -i grafana-enterprise_10.3.1_amd64.deb\nsystemctl start grafana-server\nsystemctl status grafana-server\n</code></pre>"},{"location":"Database/#cli-client","title":"CLI Client","text":"<p><code>apt install influxdb-client</code> <code>influx</code> <code>influx --host 192.168.3.102 --username admin --password password</code></p> <pre><code>$influx_client_exec = \"$home\\Documents\\influxdb-1.8.10-1\\influx.exe\"\n&amp; $influx_client_exec -host 192.168.3.102 -port 8086\nhelp\nshow databases\nuse PowerShell\nSELECT * FROM \"HardwareMonitor\" WHERE time &gt; now() - 5m\n</code></pre>"},{"location":"Database/#users","title":"USERS","text":"<p><code>SHOW USERS</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0438 \u0438\u0445 \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430  <code>CREATE USER admin WITH PASSWORD 'password' WITH ALL PRIVILEGES</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>GRANT ALL PRIVILEGES TO \"admin\"</code> \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430  <code>GRANT READ ON \"database\" TO \"admin\"</code> \u0434\u043e\u0441\u0442\u0443\u043f \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0411\u0414 \u0438\u043b\u0438 \u0437\u0430\u043f\u0438\u0441\u044c (WRITE)  <code>REVOKE ALL PRIVILEGES FROM \"admin\"</code> \u043e\u0442\u043e\u0437\u0432\u0430\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430  <code>SHOW GRANTS FOR \"admin\"</code> \u0411\u0414 \u0438 \u043f\u0440\u0438\u0432\u0435\u043b\u0435\u0433\u0438\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0434\u043b\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>SET PASSWORD FOR \"admin\" = 'new_password'</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c  <code>DROP USER \"admin\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</p>"},{"location":"Database/#database","title":"DATABASE","text":"<p><code>CREATE DATABASE powershell</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0411\u0414  <code>SHOW DATABASES</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0411\u0414  <code>DROP DATABASE powershell</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0411\u0414  <code>USE powershell</code> <code>SHOW measurements</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0442\u0430\u0431\u043b\u0438\u0446\u044b  <code>INSERT performance,host=console,counter=CPU value=0.88</code> \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0443 performance</p>"},{"location":"Database/#measurement","title":"MEASUREMENT","text":"<p><code>SHOW TAG KEYS FROM \"HardwareMonitor\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0442\u044d\u0433\u0438 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435  <code>SHOW TAG VALUES FROM \"HardwareMonitor\" WITH KEY = \"HardwareName\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u044d\u0433\u0430  <code>SHOW FIELD KEYS FROM \"HardwareMonitor\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 Field Tags \u0438 \u0438\u0445 \u0442\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445  <code>SHOW SERIES FROM \"HardwareMonitor\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u0441\u0435\u0440\u0438\u0439 \u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u0435. \u0421\u0435\u0440\u0438\u044f - \u044d\u0442\u043e \u043d\u0430\u0431\u043e\u0440 \u0442\u043e\u0447\u0435\u043a \u0434\u0430\u043d\u043d\u044b\u0445, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u043c\u0435\u044e\u0442 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0442\u0435\u0433\u043e\u0432, \u0437\u0430 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438.  <code>DROP SERIES FROM \"HardwareMonitor\"</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0432\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435  <code>DROP MEASUREMENT \"HardwareMonitor\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443</p>"},{"location":"Database/#selectwhere","title":"SELECT/WHERE","text":"<p><code>SELECT * FROM performance</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435  <code>SELECT value FROM performance</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0441\u0442\u043e\u043b\u0431\u0446\u0443 value (\u0442\u043e\u043b\u044c\u043a\u043e Field Keys)  <code>SELECT * FROM performance limit 10</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c 10 \u0435\u0434\u0438\u043d\u0438\u0446 \u0434\u0430\u043d\u043d\u044b\u0445  <code>SELECT * FROM performance WHERE time &gt; now() -2d</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 2 \u0434\u043d\u044f  <code>SELECT * FROM performance WHERE time &gt; now() +3h -5m</code> \u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 5 \u043c\u0438\u043d\u0443\u0442 (+3 \u0447\u0430\u0441\u0430 \u043e\u0442 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043f\u043e UTC 0 -5 \u043c\u0438\u043d\u0443\u0442)  <code>SELECT * FROM performance WHERE counter = 'CPU'</code> \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u0442\u044d\u0433\u0443  <code>SELECT upload/1000 FROM speedtest WHERE upload/1000 &lt;= 250</code> \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043f\u043e \u0441\u0442\u043e\u043b\u0431\u0446\u0443 upload \u0438 \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043d\u0430 1000, \u0432\u044b\u0432\u0435\u0441\u0442\u0438 upload \u043c\u0435\u043d\u044c\u0448\u0435 250  <code>DELETE FROM performance WHERE time &gt; now() -1h</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 1/4 \u0447\u0430\u0441\u0430  <code>DELETE FROM performance WHERE time &lt; now() -24h</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0441\u0442\u0430\u0440\u0448\u0435 24 \u0447\u0430\u0441\u043e\u0432</p>"},{"location":"Database/#regex","title":"REGEX","text":"<p><code>SELECT * FROM \"win_pdisk\" WHERE instance =~/.*C:/ and time &gt; now() - 5m</code> \u0438  <code>SELECT * FROM \"win_pdisk\" WHERE instance =~/.*E:/ or instance =~ /.*F:/</code> \u0438\u043b\u0438  <code>SELECT * FROM \"win_pdisk\" WHERE instance !~ /.*Total/</code> \u043d\u0435 \u0440\u0430\u0432\u043d\u043e (\u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c)  <code>SELECT * FROM \"HardwareMonitor\" WHERE time &gt; now() - 5m and HardwareName =~ /Intel/</code> \u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0440\u0430\u0432\u043d\u043e  <code>SELECT * FROM \"HardwareMonitor\" WHERE time &gt; now() - 5m and HardwareName =~ /Intel.+i7/</code> \u044d\u043a\u0432\u0438\u0432\u0430\u043b\u0435\u043d\u0442 12th_Gen_Intel_Core_i7-1260P  <code>SELECT * FROM \"HardwareMonitor\" WHERE time &gt; now() - 5m and HardwareName =~ /^Intel/</code> \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u043d\u0430 Intel  <code>SELECT * FROM \"HardwareMonitor\" WHERE time &gt; now() - 5m and HardwareName =~ /00$/</code> \u0437\u0430\u043a\u0430\u043d\u0447\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 00</p>"},{"location":"Database/#group-by-tag_key","title":"GROUP BY tag_key","text":"<p><code>SELECT * FROM \"HardwareMonitor\" WHERE time &gt; now() - 5m and SensorName = 'Temperature' GROUP BY HardwareName</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0433\u0440\u0443\u043f\u043f\u044b \u043f\u043e \u0442\u044d\u0433\u0443 HardwareName  <code>SELECT * FROM \"HardwareMonitor\" WHERE time &gt; now() - 5m and SensorName = 'Temperature' GROUP BY Host,HardwareName</code> \u0431\u043e\u043b\u044c\u0448\u0435 \u0433\u0440\u0443\u043f\u043f \u043f\u043e \u0434\u0432\u0443\u043c \u0442\u044d\u0433\u0430\u0430\u043c</p>"},{"location":"Database/#functionsfield_key","title":"Functions(field_key)","text":"<p>Functions</p> <p><code>SELECT instance,LAST(Avg._Disk_Read_Queue_Length) FROM \"win_pdisk\" GROUP BY instance</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043f\u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c\u0443/\u0442\u0435\u043a\u0443\u0449\u0435\u043c\u0443 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e  <code>SELECT instance,FIRST(Avg._Disk_Read_Queue_Length) FROM \"win_pdisk\" GROUP BY instance</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043f\u043e \u043f\u0435\u0440\u0432\u043e\u043c\u0443 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e \u0437\u0430 \u0432\u0435\u0441\u044c \u0438\u043b\u0438 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u043e\u0442\u0440\u0435\u0437\u043e\u043a \u0432\u0440\u0435\u043c\u0435\u043d\u0438  <code>SELECT instance,MIN(Avg._Disk_Read_Queue_Length) FROM \"win_pdisk\" GROUP BY instance</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u0441 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435\u043c \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f  <code>SELECT instance,MAX(Avg._Disk_Read_Queue_Length) FROM \"win_pdisk\" GROUP BY instance</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u0441 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435\u043c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f  <code>SELECT SUM(Bytes_Received_persec) FROM \"win_net\" GROUP BY instance</code> \u0441\u0443\u043c\u043c\u0430\u0445 \u0432\u0441\u0435\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439  <code>SELECT COUNT(Bytes_Received_persec) FROM \"win_net\" WHERE Bytes_Received_persec &gt;= 0 GROUP BY instance</code> \u043a\u043e\u043b-\u0432\u043e \u0434\u0430\u043d\u043d\u044b\u0445, \u0433\u0434\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0432\u044b\u0448\u0435 \u0438\u043b\u0438 \u0440\u0430\u0432\u043d\u043e 0  <code>SELECT MEAN(Bytes_Received_persec) FROM \"win_net\" WHERE Bytes_Received_persec &lt; 1000 GROUP BY instance</code> \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u0435\u043c \u043e\u0442 0 \u0434\u043e 1000 (509)</p> <p><code>SELECT *,MAX(Value) FROM \"HardwareMonitor\" WHERE time &gt; now() -1h GROUP BY SensorName,Host</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u044b \u0434\u043b\u044f \u0432\u044b\u044f\u0432\u043b\u0435\u043d\u0438\u044f \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0441\u0442\u043e\u0431\u0446\u0430 Value \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0442\u044d\u0433\u0430 SensorName \u0438 \u0445\u043e\u0441\u0442\u0430 \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0447\u0430\u0441  <code>SELECT *,MAX(Value) FROM \"HardwareMonitor\" WHERE time &gt; now() -1h and SensorName = 'CPU_Package' GROUP BY Host</code> \u043c\u0430\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 CPU_Package \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0447\u0430\u0441 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0445\u043e\u0441\u0442\u0430  <code>SELECT MEAN(Value) FROM \"HardwareMonitor\" WHERE time &gt; now() -1h and SensorName = 'CPU_Package' GROUP BY Host</code> \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 CPU_Package \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0447\u0430\u0441</p>"},{"location":"Database/#policy","title":"POLICY","text":"<p><code>CREATE DATABASE powershell WITH DURATION 48h REPLICATION 1 NAME \"del2d\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0411\u0414 \u0441 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u043e\u0439 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f 2 \u0434\u043d\u044f  <code>CREATE RETENTION POLICY del2h ON powershell DURATION 2h REPLICATION 1</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0443 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0411\u0414  <code>CREATE RETENTION POLICY del6h ON powershell DURATION 6h REPLICATION 1 SHARD DURATION 2h</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0435\u0440\u0438\u043e\u0434 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f 6 \u0447\u0430\u0441\u043e\u0432 + 2 \u0447\u0430\u0441\u0430 \u0434\u043e \u043e\u0447\u0438\u0441\u0442\u043a\u0438 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e 1\u0447 \u0438\u043b\u0438 \u0431\u043e\u043b\u044c\u0448\u0435)  <code>ALTER RETENTION POLICY del6h ON powershell DEFAULT</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c (ALTER) \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0443 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0411\u0414 \u043d\u0430 del6h (DEFAULT)  <code>DROP RETENTION POLICY del2d ON powershell</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u0438\u0432\u043e\u0434\u0438\u0442 \u043a \u0431\u0435\u0437\u0432\u043e\u0437\u0432\u0440\u0430\u0442\u043d\u043e\u043c\u0443 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044e \u0432\u0441\u0435\u0445 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u0439 (\u0442\u0430\u0431\u043b\u0438\u0446) \u0438 \u0434\u0430\u043d\u043d\u044b\u0445, \u0445\u0440\u0430\u043d\u044f\u0449\u0438\u0445\u0441\u044f \u0432 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f  <code>SHOW RETENTION POLICIES ON PowerShell</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 PowerShell</p>"},{"location":"Database/#influxdb-api","title":"InfluxDB-api","text":"<pre><code>$data = Invoke-RestMethod http://192.168.3.102:8086/query?q=\"SHOW RETENTION POLICIES ON PowerShell\"\n$col = $data.results.series.columns\n$val = $data.results.series.values\n$mass    = @()\n$mass   += [string]$col\nforeach ($v in $val) {\n    $mass += [string]$v\n}\n$mass = $mass -replace '^','\"'\n$mass = $mass -replace '$','\"'\n$mass = $mass -replace '\\s','\",\"'\n$mass | ConvertFrom-Csv\n</code></pre>"},{"location":"Database/#api-post","title":"API POST","text":"<p>\u0412\u043c\u0435\u0441\u0442\u043e \u0442\u0430\u0431\u043b\u0438\u0446 \u0432 InfluxDB \u0438\u043c\u0435\u044e\u0442\u0441\u044f \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f. \u0412\u043c\u0435\u0441\u0442\u043e \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432 \u0432 \u043d\u0435\u0439 \u0435\u0441\u0442\u044c \u0442\u0435\u0433\u0438 \u0438 \u043f\u043e\u043b\u044f.</p> <pre><code>   Table                        Tag (string/int)                          Field (double/int)           TIMESTAMP\nmeasurement,Tag_Keys1=Tag_Values1,Tag_Keys2=Tag_Values2 Field_Keys1=\"Values\",Field_Keys2=\"Values\" 0000000000000000000\n           1                                           2                                         3\n\n$ip        = \"192.168.3.104\"\n$port      = \"8086\"\n$db        = \"powershell\"\n$table     = \"speedtest\"\n$ipp       = $ip+\":\"+$port\n$url       = \"http://$ipp/write?db=$db\"\n$user      = \"admin\"\n$pass      = \"password\" | ConvertTo-SecureString -AsPlainText -Force\n$cred      = [System.Management.Automation.PSCredential]::new($user,$pass)\n$unixtime  = (New-TimeSpan -Start (Get-Date \"01/01/1970\") -End (Get-Date)).TotalSeconds\n$timestamp = ([string]$unixtime -replace \"\\..+\") + \"000000000\"\n\nInvoke-RestMethod -Method POST -Uri $url -Body \"$table,host=$(hostname) download=200000,upload=300000,ping=3 $timestamp\"\n</code></pre>"},{"location":"Database/#api-get","title":"API GET","text":"<p><code>curl http://192.168.3.104:8086/query --data-urlencode \"q=SHOW DATABASES\"</code> pwsh7 (ConvertFrom-Json) and bash</p> <p><code>$dbs = irm \"http://192.168.3.104:8086/query?q=SHOW DATABASES\"</code> <code>$dbs = irm \"http://192.168.3.104:8086/query?epoch=ms&amp;u=admin&amp;p=password&amp;q=SHOW DATABASES\"</code> <code>$dbs.results.series.values</code></p> <pre><code>$ip    = \"192.168.3.104\"\n$port  = \"8086\"\n$db    = \"powershell\"\n$table = \"speedtest\"\n$query = \"SELECT * FROM $table\"\n$ipp   = $ip+\":\"+$port\n$url   = \"http://$ipp/query?db=$db&amp;q=$query\"\n$data  = Invoke-RestMethod -Method GET -Uri $url` -Credential $cred \n$data.results.series.name   ` \u0438\u043c\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u044b\n$data.results.series.columns` \u0441\u0442\u043e\u043b\u0431\u0446\u044b/\u043a\u043b\u044e\u0447\u0438\n$data.results.series.values ` \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u043e\n</code></pre>"},{"location":"Database/#endpoints","title":"Endpoints","text":"<p>API doc</p> <pre><code>$stats = irm http://192.168.3.104:8086/debug/vars` \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\n$stats.\"database:powershell\".values` \u043a\u043e\u043b-\u0432\u043e \u0442\u0430\u0431\u043b\u0438\u0446 \u043a \u0411\u0414\n$stats.queryExecutor.values` \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e query-\u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 (\u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0439 \u043a endpoint /query)\n$stats.write.values` \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e write-\u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432\n$stats.system.uptime\n</code></pre> <p><code>http://192.168.3.104:8086/debug/requests</code> \u043a\u043e\u043b-\u0432\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0445 HTTP-\u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043a \u043a\u043e\u043d\u0435\u0447\u043d\u044b\u043c \u0442\u043e\u0447\u043a\u0430\u043c /write\u0438 /query  <code>http://192.168.3.104:8086/debug/pprof</code> <code>http://192.168.3.104:8086/ping</code> <code>http://192.168.3.104:8086/query</code> <code>http://192.168.3.104:8086/write</code></p> <p><code>http://192.168.3.99:8086/api/v2/setup</code> <code>http://192.168.3.99:8086/api/v2/config</code> <code>http://192.168.3.99:8086/api/v2/write</code></p>"},{"location":"Database/#pingto-influxdb","title":"PingTo-InfluxDB","text":"<pre><code>while ($true) {\n    $tz = (Get-TimeZone).BaseUtcOffset.TotalMinutes\n    $unixtime  = (New-TimeSpan -Start (Get-Date \"01/01/1970\") -End ((Get-Date).AddMinutes(-$tz))).TotalSeconds` -3h UTC\n    $timestamp = ([string]$unixtime -replace \"\\..+\") + \"000000000\"\n    $tnc = tnc 8.8.8.8\n    $Status = $tnc.PingSucceeded\n    $RTime = $tnc.PingReplyDetails.RoundtripTime\n    Invoke-RestMethod -Method POST -Uri \"http://192.168.3.104:8086/write?db=powershell\" -Body \"ping,host=$(hostname) status=$status,rtime=$RTime $timestamp\"\n    sleep 1\n}\n</code></pre> <p><code>SELECT * FROM ping WHERE status = false</code></p>"},{"location":"Database/#performanceto-influxdb","title":"PerformanceTo-InfluxDB","text":"<pre><code>function ConvertTo-Encoding ([string]$From, [string]$To) {\n    Begin {\n        $encFrom = [System.Text.Encoding]::GetEncoding($from)\n        $encTo = [System.Text.Encoding]::GetEncoding($to)\n    }\n    Process {\n        $bytes = $encTo.GetBytes($_)\n        $bytes = [System.Text.Encoding]::Convert($encFrom, $encTo, $bytes)\n        $encTo.GetString($bytes)\n    }\n}\n\n$localization = (Get-Culture).LCID` \u0442\u0435\u043a\u0443\u0449\u0430\u044f \u043b\u043e\u043a\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f\nif ($localization -eq 1049) {\n    $performance = \"\\\\$(hostname)\\\u041f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440(_Total)\\% \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430\" | ConvertTo-Encoding UTF-8 windows-1251` \u0434\u0435\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043a\u0438\u0440\u0438\u043b\u043b\u0438\u0446\u0443\n} else {\n    $performance = \"\\Processor(_Total)\\% Processor Time\"\n}\n\n$tz = (Get-TimeZone).BaseUtcOffset.TotalMinutes\nwhile ($true) {\n    $unixtime  = (New-TimeSpan -Start (Get-Date \"01/01/1970\") -End ((Get-Date).AddMinutes(-$tz))).TotalSeconds` -3h UTC\n    $timestamp = ([string]$unixtime -replace \"\\..+\") + \"000000000\"\n    [double]$value = (Get-Counter $performance).CounterSamples.CookedValue.ToString(\"0.00\").replace(\",\",\".\")` \u043e\u043a\u0440\u0443\u0433\u043b\u0438\u0442\u044c \u0432 \u0442\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445 Double\n    Invoke-RestMethod -Method POST -Uri \"http://192.168.3.104:8086/write?db=powershell\" -Body \"performance,host=$(hostname),counter=CPU value=$value $timestamp\"\n    sleep 5\n}\n</code></pre>"},{"location":"Database/#service","title":"Service","text":"<pre><code>$powershell_Path = (Get-Command powershell).Source\n$NSSM_Path = \"C:\\NSSM\\NSSM-2.24.exe\"\n$Script_Path = \"C:\\NSSM\\PerformanceTo-InfluxDB.ps1\"\n$Service_Name = \"PerformanceTo-InfluxDB\"\n&amp; $NSSM_Path install $Service_Name $powershell_Path -ExecutionPolicy Bypass -NoProfile -f $Script_Path\nGet-Service $Service_Name | Start-Service\nGet-Service $Service_Name | Set-Service -StartupType Automatic\n</code></pre>"},{"location":"Database/#psinfluxdb","title":"PSInfluxDB","text":"<p><code>Install-Module psinfluxdb -Repository NuGet</code> <code>Get-InfluxUsers -server 192.168.3.102</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043d\u0430 \u0441\u0435\u043d\u0432\u0435\u0440\u0435 InfluxDB \u0438 \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430  <code>Get-InfluxDatabases -server 192.168.3.102</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0431\u0430\u0437 \u0434\u0430\u043d\u043d\u044b\u0445  <code>Get-InfluxDatabases -server 192.168.3.102 -creat -database test</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445  <code>Get-InfluxDatabases -server 192.168.3.102 -delete -database test</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445  <code>Get-InfluxPolicy -server 192.168.3.102 -database PowerShell</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u0438\u0442\u0438\u043a \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445  <code>Get-InfluxPolicy -server 192.168.3.102 -database PowerShell -creat -policyName del2d -hours 48</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0443 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f  <code>Get-InfluxPolicy -server 192.168.3.102 -database PowerShell -policyName del2d -default</code> \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0443 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e  <code>Get-InfluxTables -server 192.168.3.102 -database PowerShell</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0442\u0430\u0431\u043b\u0438\u0446/\u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u0439 \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445  <code>$Data = Get-InfluxData -server 192.168.3.102 -database PowerShell -table ping | Format-Table</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435  <code>$Data | Where-Object {$_.SensorName -match \"CPU_Package\" -and $_.Value -gt 90} | Format-Table</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e \u0434\u0432\u0443\u043c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c (\u0441\u0435\u043d\u0441\u043e\u0440\u044b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430 \u0441 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u0435\u043c \u0432\u044b\u0448\u0435 90)  <code>$influx = Get-InfluxData -server 192.168.3.104 -database PowerShell -table speedtest</code> <code>Get-InfluxChart -time ($influx.time) -data ($influx.download) -title \"SpeedTest Download\" -path \"C:\\Users\\Lifailon\\Desktop\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0430\u0444\u0438\u043a (WinForms Chart) \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u0439 \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432 jpeg-\u0444\u0430\u0439\u043b</p>"},{"location":"Database/#telegraf","title":"Telegraf","text":"<p>Plugins</p> <p><code>iwr https://dl.influxdata.com/telegraf/releases/telegraf-1.27.1_windows_amd64.zip -UseBasicParsing -OutFile telegraf-1.27.1_windows_amd64.zip</code> <code>Expand-Archive .\\telegraf-1.27.1_windows_amd64.zip -DestinationPath \"C:\\Telegraf\"</code> <code>rm telegraf-1.27.1_windows_amd64.zip</code> <code>cd C:\\Telegraf</code> <code>.\\telegraf.exe -sample-config --input-filter cpu:mem:dns_query --output-filter influxdb &gt; telegraf_nt.conf</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0441 \u0432\u044b\u0431\u0430\u0440\u043d\u043d\u044b\u043c\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c\u0438 \u0434\u043b\u044f \u0441\u0431\u043e\u0440\u0430 \u043c\u0435\u0442\u0440\u0438\u043a  <code>Start-Process notepad++ C:\\Telegraf\\telegraf_nt.conf</code></p> <pre><code>[[outputs.influxdb]]\n  urls = [\"http://192.168.3.104:8086\"]\n  database = \"telegraf_nt\"\n  username = \"user\"\n  password = \"pass\"\n[[inputs.cpu]]\n  percpu = false\n  totalcpu = true\n[[inputs.dns_query]]\n  servers = [\"8.8.8.8\"]\n  network = \"udp\"\n  domains = [\".\"]\n  record_type = \"A\"\n  port = 53\n  timeout = \"2s\"\n</code></pre> <p><code>.\\telegraf.exe --test -config C:\\Telegraf\\telegraf_nt.conf</code> \u0442\u0435\u0441\u0442 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 (\u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0442\u0440\u0438\u043a \u0441 \u0432\u044b\u0432\u043e\u0434\u043e\u043c \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c)  <code>C:\\Telegraf\\telegraf.exe -config C:\\Telegraf\\telegraf_nt.conf</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c telegraf (\u0442\u0435\u0441\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445)  <code>.\\telegraf.exe --config \"C:\\Telegraf\\telegraf_nt.conf\" --service install</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443  <code>Get-Service telegraf | Start-Service</code> <code>.\\telegraf.exe --service uninstall</code></p> <p><code>USE telegraf</code> <code>SELECT usage_idle,usage_system,usage_user FROM cpu</code></p>"},{"location":"Database/#sqlite","title":"SQLite","text":"<pre><code>$path = \"$home\\Documents\\Get-Service.db\"\n$Module = Get-Module MySQLite\nif ($Module -eq $null) {\n    Install-Module MySQLite -Repository PSGallery -Scope CurrentUser\n}\nImport-Module MySQLite\nNew-MySQLiteDB -Path $path # \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0411\u0414\nInvoke-MySQLiteQuery -Path $path -Query \"CREATE TABLE Service (Name TEXT NOT NULL, DisplayName TEXT NOT NULL, Status TEXT NOT NULL);\" # \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443\n\n$Service = Get-Service | select Name,DisplayName,Status\nforeach ($S in $Service) {\n    $Name = $S.Name\n    $DName = $S.DisplayName\n    $Status = $S.Status\n    Invoke-MySQLiteQuery -Path $path -Query \"INSERT INTO Service (Name, DisplayName, Status) VALUES ('$Name', '$DName', '$Status');\"\n}\n</code></pre> <p><code>(Get-MySQLiteDB $path).Tables</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0442\u0430\u0431\u043b\u0438\u0446 \u0432 \u0431\u0430\u0437\u0435  <code>Invoke-MySQLiteQuery -Path $path -Query \"SELECT name FROM sqlite_master WHERE type='table';\"</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0442\u0430\u0431\u043b\u0438\u0446 \u0432 \u0431\u0430\u0437\u0435  <code>Invoke-MySQLiteQuery -Path $path -Query \"DROP TABLE Service;\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443</p> <pre><code>$TableName = \"Service\"\nInvoke-MySQLiteQuery -Path $path -Query \"SELECT * FROM $TableName\" # \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0442\u0430\u0431\u043b\u0438\u0446\u044b (\u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430)\n</code></pre> <p><code>Get-Service | select  Name,DisplayName,Status | ConvertTo-MySQLiteDB -Path $path -TableName Service -force</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0443</p>"},{"location":"Database/#database-password","title":"Database password","text":"<pre><code>$Connection = New-SQLiteConnection -DataSource $path\n$Connection.ChangePassword(\"password\")\n$Connection.Close()\nInvoke-SqliteQuery -Query \"SELECT * FROM Service\" -DataSource \"$path;Password=password\"\n</code></pre>"},{"location":"Database/#mysql","title":"MySQL","text":"<p><code>apt -y install mysql-server mysql-client</code> <code>mysql -V</code> <code>systemctl status mysql</code> <code>mysqladmin -u root password</code> \u0437\u0430\u0434\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c root</p> <p><code>nano /etc/mysql/mysql.conf.d/mysqld.cnf</code></p> <pre><code>[mysqld]\nuser                    = mysql\n# pid-file              = /var/run/mysqld/mysqld.pid\n# socket                = /var/run/mysqld/mysqld.sock\n# port                  = 3306\n# datadir               = /var/lib/mysql\n# tmpdir                = /tmp\nbind-address            = 0.0.0.0\nmysqlx-bind-address     = 0.0.0.0\nlog_error = /var/log/mysql/error.log\n</code></pre> <p><code>systemctl restart mysql</code> <code>ss -tulnp | grep 3306</code> <code>ufw allow 3306/tcp</code> <code>nc -zv 192.168.1.253 3306</code> <code>tnc 192.168.1.253 -p 3306</code></p> <p><code>mysql -u root -p</code> <code>SELECT user(), now(), version();</code> <code>quit;</code></p> <p><code>mysql -u root -p -e 'SHOW TABLES FROM db_aduser;'</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0442\u0430\u0431\u043b\u0438\u0446 \u0431\u0435\u0437 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u043a\u043e\u043d\u0441\u043e\u043b\u0438 MySQL</p> <p><code>CREATE</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0411\u0414, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0442\u0430\u0431\u043b\u0438\u0446\u0443  <code>ALTER</code>  \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0442\u043e\u043b\u0431\u0446\u0430\u043c\u0438 \u0442\u0430\u0431\u043b\u0438\u0446\u0435  <code>DROP</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0411\u0414, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0442\u0430\u0431\u043b\u0438\u0446\u0443  <code>USE</code> \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0411\u0414  <code>SHOW</code> \u0432\u044b\u0432\u0435\u0441\u043b\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0411\u0414, \u043f\u0440\u0430\u0432 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (GRANTS), \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432 \u0438 \u0438\u0445 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430  <code>GRANT</code> \u0434\u0430\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u043a \u0411\u0414  <code>REVOKE</code>  \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043a \u0411\u0414  <code>UPDATE</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430, \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0441 \u0442\u0430\u0431\u043b\u0438\u0446\u0435  <code>FLUSH</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430  <code>SELECT</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u0411\u0414, \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435  <code>INSERT</code> \u0432\u043d\u0435\u0441\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0435  <code>DELETE</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 (FROM) \u0442\u0430\u0431\u043b\u0438\u0446\u0435</p>"},{"location":"Database/#data-type","title":"DATA TYPE","text":"<p><code>VARCHAR(N)</code> \u0441\u0442\u0440\u043e\u043a\u0430 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u0434\u043b\u0438\u043d\u044b, \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 ASCII, \u0433\u0434\u0435 \u043e\u0434\u0438\u043d \u0441\u0438\u043c\u0432\u043e\u043b \u0437\u0430\u043d\u0438\u043c\u0430\u0435\u0442 1 \u0431\u0430\u0439\u0442, \u0447\u0438\u0441\u043b\u043e\u043c N \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430 \u0441\u0442\u0440\u043e\u043a\u0438  <code>NVARCHAR(N)</code> \u0441\u0442\u0440\u043e\u043a\u0430 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u0434\u043b\u0438\u043d\u044b, \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 Unicode, \u0433\u0434\u0435 \u043e\u0434\u0438\u043d \u0441\u0438\u043c\u0432\u043e\u043b \u0437\u0430\u043d\u0438\u043c\u0430\u0435\u0442 2 \u0431\u0430\u0439\u0442\u0430  <code>CHAR(N)/nchar(N)</code> \u0441\u0442\u0440\u043e\u043a\u0430 \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0434\u043b\u0438\u043d\u044b, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0432\u0441\u0435\u0433\u0434\u0430 \u0434\u043e\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0441\u043f\u0440\u0430\u0432\u0430 \u043f\u0440\u043e\u0431\u0435\u043b\u0430\u043c\u0438 \u0434\u043e \u0434\u043b\u0438\u043d\u044b N \u0438 \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e\u043d\u0430 \u0437\u0430\u043d\u0438\u043c\u0430\u0435\u0442 \u0440\u043e\u0432\u043d\u043e N \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432  <code>INT</code> \u0446\u0435\u043b\u043e\u0435 \u0447\u0438\u0441\u043b\u043e, \u043e\u0442 -2147483648 \u0434\u043e 2147483647, \u0437\u0430\u043d\u0438\u043c\u0430\u0435\u0442 4 \u0431\u0430\u0439\u0442\u0430  <code>FLOAT</code> \u0447\u0438\u0441\u043b\u043e, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043c\u043e\u0436\u0435\u0442 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0434\u0435\u0441\u044f\u0442\u0438\u0447\u043d\u0430\u044f \u0442\u043e\u0447\u043a\u0430 (\u0437\u0430\u043f\u044f\u0442\u0430\u044f)  <code>BIT</code> \u0444\u043b\u0430\u0433, \u0414\u0430 - 1 \u0438\u043b\u0438 \u041d\u0435\u0442 - 0  <code>DATE</code> \u0444\u043e\u0440\u043c\u0430\u0442 \u0434\u0430\u0442\u044b, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 25.05.2023  <code>TIME</code> 23:30:55.1234567  <code>DATETIME</code> 25.05.2023 23:30:55.1234567</p>"},{"location":"Database/#database_1","title":"DATABASE","text":"<pre><code>SHOW databases;                                                                     # \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0411\u0414\nCREATE DATABASE db_aduser;                                                          # \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0411\u0414\nCREATE DATABASE db_rep DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;  # \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0411\u0414 \u0441 \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u043a\u043e\u0439 UTF-8\nDROP DATABASE db_rep;                                                               # \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0411\u0414\nUSE db_aduser;                                                                      # \u0432\u044b\u0431\u0440\u0430\u0442\u044c/\u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u0411\u0414\nSELECT database();                                                                  # \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u0411\u0414\n</code></pre>"},{"location":"Database/#user","title":"USER","text":"<pre><code>SELECT USER,HOST FROM mysql.user;                                     # \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0423\u0417\nCREATE USER posh@localhost IDENTIFIED BY '1qaz!QAZ';                  # \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0423\u0417, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c\u0441\u044f \u0441 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430\nCREATE USER posh@localhost IDENTIFIED BY '1qaz!QAZ';                  # \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0423\u0417, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c\u0441\u044f \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430\nCREATE USER posh@'192.168.3.99' IDENTIFIED BY '1qaz!QAZ';             # \u0423\u0417 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0441 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430\nCREATE USER 'admin'@'%' IDENTIFIED BY 'Admin12#';                     # \u0423\u0417 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0441 \u043b\u044e\u0431\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 (% - wildcard)\nDROP USER posh@localhost;                                             # \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\nSHOW GRANTS FOR posh@'%';                                             # \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\nGRANT ALL PRIVILEGES ON db_aduser.* TO posh@'192.168.3.99';           # \u043f\u043e\u043b\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u0434\u043b\u044f posh \u043a \u0411\u0414 db_aduser\nGRANT ALL PRIVILEGES ON *.* TO posh@'%';                              # \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0432\u0441\u0435\u043c \u0411\u0414 c \u043b\u044e\u0431\u043e\u0433\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0445\u043e\u0441\u0442\u0430\nGRANT SELECT,DELETE ON mysql.* TO posh@'%';                           # \u043f\u0440\u0430\u0432\u0430 SELECT \u0438 DELETE \u043d\u0430 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u0443\u044e \u0411\u0414 mysql\nREVOKE DELETE ON mysql.* FROM posh@'%';                               # \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f DELETE\nUPDATE mysql.user SET super_priv='Y' WHERE USER='posh' AND host='%';  # \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0440\u0438\u0432\u0435\u043b\u0435\u0433\u0438\u0438 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\nSELECT USER,HOST,super_priv FROM mysql.user;                          # \u0441\u043f\u0438\u0441\u043e\u043a \u0423\u0417 \u0438 \u0442\u0430\u0431\u043b\u0438\u0446\u0430 \u0441 \u043f\u0440\u0430\u0432\u0430\u043c\u0438 SUPER privilege\nFLUSH PRIVILEGES;                                                     # \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430\n</code></pre>"},{"location":"Database/#table","title":"TABLE","text":"<pre><code>SHOW TABLES;               # \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0442\u0430\u0431\u043b\u0438\u0446\nSHOW TABLES LIKE '%user';  # \u043f\u043e\u0438\u0441\u043a \u0442\u0430\u0431\u043b\u0438\u0446\u044b \u043f\u043e wildcard-\u0438\u043c\u0435\u043d\u0438\nCREATE TABLE table_aduser (id INT NOT NULL AUTO_INCREMENT, Name VARCHAR(100), email VARCHAR(100), PRIMARY KEY (ID));  # \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443\nDROP TABLE table_aduser;   # \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443\n</code></pre>"},{"location":"Database/#column","title":"COLUMN","text":"<pre><code>SHOW COLUMNS FROM table_aduser;                                                         # \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0441\u0442\u043e\u0431\u0446\u043e\u0432 \u0438 \u0438\u0445 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430\nALTER TABLE table_aduser DROP COLUMN id;                                                # \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0442\u043e\u043b\u0431\u0435\u0446 id\nALTER TABLE table_aduser ADD COLUMN info VARCHAR(10);                                   # \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0442\u043e\u043b\u0431\u0435\u0446 info\nALTER TABLE table_aduser CHANGE info new_info VARCHAR(100);                             # \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u043c\u044f \u0441\u0442\u043e\u043b\u0431\u0446\u0430 info \u043d\u0430 new_info \u0438 \u0435\u0433\u043e \u0442\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445\nALTER TABLE table_aduser ADD COLUMN (id INT NOT NULL AUTO_INCREMENT, PRIMARY KEY (ID)); # \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0442\u043e\u043b\u0431\u0435\u0446 id\n</code></pre>"},{"location":"Database/#insert","title":"INSERT","text":"<pre><code>INSERT table_aduser (Name,email) VALUES ('Alex','no-email');\nINSERT table_aduser (Name,email) VALUES ('Alex','no-email');\nINSERT table_aduser (Name) VALUES ('Support');\nINSERT table_aduser (Name) VALUES ('Jack');\n</code></pre>"},{"location":"Database/#select","title":"SELECT","text":"<pre><code>SELECT * FROM table_aduser;                     # \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0432\u0441\u0435\u0445 \u0441\u0442\u043e\u0431\u0446\u043e\u0432 \u0432 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 (FROM) \u0442\u0430\u0431\u043b\u0438\u0446\u0435\nSELECT Name,email FROM table_aduser;            # \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0441\u0442\u043e\u0431\u0446\u043e\u0432\nSELECT DISTINCT Name,Email FROM table_aduser;   # \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0437\u0430\u043f\u0438\u0441\u0438 (\u0431\u0435\u0437 \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439)\nSELECT * FROM table_aduser ORDER BY Name;       # \u043e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e Name\nSELECT * FROM table_aduser ORDER BY Name DESC;  # \u043e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430\nSELECT COUNT(*) FROM table_aduser;              # \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0442\u0440\u043e\u043a \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435\nSELECT COUNT(new_info) FROM table_aduser;       # \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0442\u0440\u043e\u043a \u0432 \u0441\u0442\u043e\u043b\u0431\u0446\u0435\n</code></pre>"},{"location":"Database/#where","title":"WHERE","text":"<pre><code>NOT; AND; OR                                                  # \u043f\u043e \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u0430\u043c \u0443\u0441\u043b\u043e\u0432\u0438\u0439\nSELECT * FROM table_aduser WHERE Name = 'Alex';               # \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u043c\u0443\nSELECT * FROM table_aduser WHERE NOT Name != 'Alex';          # \u0443\u0441\u043b\u043e\u0432\u0438\u0435 NOT \u0433\u0434\u0435 Name \u043d\u0435 \u0440\u0430\u0432\u0435\u043d \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e\nSELECT * FROM table_aduser WHERE email != '';                 # \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u0442\u0440\u043e\u043a\u0438, \u0433\u0434\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 email \u043d\u0435 \u0440\u0430\u043d\u043e null\nSELECT * FROM table_aduser WHERE email != '' OR id &gt; 1000;    # \u0438\u043b\u0438 id \u0432\u044b\u0448\u0435 1000\nSELECT * FROM table_aduser WHERE Name RLIKE \"support\";        # \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u043e\u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0435\u043c\u044b\u0439 (RLIKE) \u043f\u043e\u0438\u0441\u043a\nSELECT * FROM table_aduser WHERE Name RLIKE \"^support\";       # \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0441 \u044d\u0442\u043e\u0433\u043e \u0441\u043b\u043e\u0432\u043e\u0441\u043e\u0447\u0435\u0442\u0430\u043d\u0438\u044f\n</code></pre>"},{"location":"Database/#delete","title":"DELETE","text":"<pre><code>SELECT * FROM table_aduser WHERE Name RLIKE \"alex\";   # \u043d\u0430\u0439\u0442\u0438 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u0435\u0440\u0435\u0434 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435\u043c\nDELETE FROM table_aduser WHERE Name RLIKE \"alex\";     # Query OK, 2 rows affected # \u0443\u0434\u0430\u043b\u0435\u043d\u043e \u0434\u0432\u0435 \u0441\u0442\u0440\u043e\u043a\u0438\nDELETE FROM table_aduser;                             # \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0412\u0421\u0415 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\n</code></pre>"},{"location":"Database/#update","title":"UPDATE","text":"<pre><code>SELECT * FROM table_aduser WHERE Name = 'Jack';             # \u043d\u0430\u0439\u0442\u0438 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u0434 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435\u043c\nUPDATE table_aduser SET Name = 'Alex' WHERE Name = 'Jack';  # \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 'Jack' \u043d\u0430 'Alex'\nUPDATE db_aduser.table_aduser SET Name='BCA' WHERE id=1;    # \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0432 \u0441\u0442\u0440\u043e\u043a\u0435 \u0441 ID 1\n</code></pre>"},{"location":"Database/#check","title":"CHECK","text":"<pre><code>CHECK TABLE db_aduser.table_aduser;     # \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c\nANALYZE TABLE db_aduser.table_aduser;   # \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c\nOPTIMIZE TABLE db_aduser.table_aduser;  # \u043e\u043f\u0442\u0438\u043c\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c\nREPAIR TABLE db_aduser.table_aduser;    # \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c\nTRUNCATE TABLE db_aduser.table_aduser;  # \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c\n</code></pre>"},{"location":"Database/#dump","title":"DUMP","text":"<pre><code>mysqldump -u root -p --databases db_aduser &gt; /bak/db_aduser.sql\nmysql -u root -p db_aduser &lt; /bak/db_aduser.sql\n\ncrontab -e\n00 22 * * * /usr/bin/mysqldump -uroot -p1qaz!QAZ db_zabbix | /bin/bzip2 &gt; `date +/dump/zabbix/zabbix-\\%d-\\%m-\\%Y-\\%H:\\%M.bz2`\n00 23 * * * /usr/bin/mysqldump -uroot -p1qaz!QAZ db_zabbix &gt; `date +/dump/smb/zabbix-\\%d-\\%m-\\%Y-\\%H:\\%M.sql`\n0 0 * * * find /dump/zabbix -mtime +7 -exec rm {} \\;\n\nmysqldump -u root --single-transaction db_zabbix &gt; /dump/zabbix/db_zabbix.sql\nmysql -u user_zabbix -p -e 'CREATE DATABASE db_zabbix;'\nmysql -u user_zabbix -p db_zabbix &lt; /root/db_zabbix.sql\n</code></pre>"},{"location":"Database/#innodb_force_recovery","title":"innodb_force_recovery","text":"<pre><code>sed -i '/innodb_force_recovery/d' /etc/mysql/my.cnf # \u0443\u0434\u0430\u043b\u0438\u0442\u044c\nmode=6; sed -i \"/^\\[mysqld\\]/{N;s/$/\\ninnodb_force_recovery=$mode/}\" /etc/mysql/my.cnf # \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c mode 6\nsystemctl restart mysql\n\n[mysqld]\ninnodb_force_recovery=1 # \u0441\u0435\u0440\u0432\u0435\u0440 \u043f\u044b\u0442\u0430\u0435\u0442\u0441\u044f \u043d\u0430\u0447\u0430\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0443 \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e \u043e\u0442 \u0442\u043e\u0433\u043e, \u0435\u0441\u0442\u044c \u043b\u0438 \u043f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 InnoDB \u0438\u043b\u0438 \u043d\u0435\u0442\ninnodb_force_recovery=2 # \u0443\u0434\u0430\u0435\u0442\u0441\u044f \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0443 \u0437\u0430 \u0441\u0447\u0435\u0442 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043f\u043e\u0442\u043e\u043a\u0430 \u043a\u043e\u043c\u0430\u043d\u0434, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u044b\u043b\u0438 \u0447\u0430\u0441\u0442\u0438\u0447\u043d\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b \u0438\u043b\u0438 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b (\u043d\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0444\u043e\u043d\u043e\u0432\u044b\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438)\ninnodb_force_recovery=3 # \u043e\u0442\u043c\u0435\u043d\u044f\u0435\u0442 \u043e\u0442\u043a\u0430\u0442 \u043f\u043e\u0441\u043b\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 (\u043d\u0435 \u043f\u044b\u0442\u0430\u0435\u0442\u0441\u044f \u043e\u0442\u043a\u0430\u0442\u0438\u0442\u044c \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438)\ninnodb_force_recovery=6 # \u0437\u0430\u043f\u0443\u0441\u043a \u0421\u0423\u0411\u0414 \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 read only\n</code></pre>"},{"location":"Database/#mysql-connector-net","title":"MySQL Connector NET","text":""},{"location":"Database/#add-aduser","title":"Add-ADUser","text":"<pre><code>$ip = \"192.168.1.253\"\n$user = \"posh\"\n$pass = \"1qaz!QAZ\"\n$db = \"db_aduser\"\nAdd-Type \u2013Path \"$home\\Documents\\MySQL-Connector-NET\\8.0.31-4.8\\MySql.Data.dll\"\n$Connection = [MySql.Data.MySqlClient.MySqlConnection]@{\n    ConnectionString=\"server=$ip;uid=$user;pwd=$pass;database=$db\"\n}\n$Connection.Open()\n$Command = New-Object MySql.Data.MySqlClient.MySqlCommand\n$Command.Connection = $Connection\n$UserList = Get-ADUser -filter * -properties name,EmailAddress\nforeach ($user in $UserList) {\n    $uname=$user.Name\n    $uemail=$user.EmailAddress\n    $Command.CommandText = \"INSERT INTO table_aduser (Name,Email) VALUES ('$uname','$uemail')\"\n    $Command.ExecuteNonQuery()\n}\n$Connection.Close()\n</code></pre>"},{"location":"Database/#get-aduser","title":"Get-ADUser","text":"<pre><code>$ip = \"192.168.1.253\"\n$user = \"posh\"\n$pass = \"1qaz!QAZ\"\n$db = \"db_aduser\"\nAdd-Type \u2013Path \"$home\\Documents\\MySQL-Connector-NET\\8.0.31-4.8\\MySql.Data.dll\"\n$Connection = [MySql.Data.MySqlClient.MySqlConnection]@{\n    ConnectionString = \"server=$ip;uid=$user;pwd=$pass;database=$db\"\n}\n$Connection.Open()\n$Command = New-Object MySql.Data.MySqlClient.MySqlCommand\n$Command.Connection = $Connection\n$MYSQLDataAdapter = New-Object MySql.Data.MySqlClient.MySqlDataAdapter\n$MYSQLDataSet = New-Object System.Data.DataSet\n$Command.CommandText = \"SELECT * FROM table_aduser\"\n$MYSQLDataAdapter.SelectCommand = $Command\n$NumberOfDataSets = $MYSQLDataAdapter.Fill($MYSQLDataSet, \"data\")\n$Collections = New-Object System.Collections.Generic.List[System.Object]\nforeach($DataSet in $MYSQLDataSet.tables[0]) {\n    $Collections.Add([PSCustomObject]@{\n    Name = $DataSet.name;\n    Mail = $DataSet.email\n})\n}\n$Connection.Close()\n$Collections\n</code></pre>"},{"location":"Database/#mssql","title":"MSSQL","text":"<p><code>wget -qO- https://packages.microsoft.com/keys/microsoft.asc | apt-key add -</code> \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c GPG-\u043a\u043b\u044e\u0447 \u0434\u043b\u044f \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f  <code>https://packages.microsoft.com/config/ubuntu/</code> \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u0438 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c URL  <code>add-apt-repository \"$(wget -qO- https://packages.microsoft.com/config/ubuntu/20.04/mssql-server-2019.list)\"</code> <code>apt-get update</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0430\u043a\u0435\u0442\u043e\u0432  <code>apt-get install mssql-server</code> <code>/opt/mssql/bin/mssql-conf setup</code> \u0441\u043a\u0440\u0438\u043f\u0442 \u043d\u0430\u0447\u0430\u043b\u044c\u043d\u043e\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 (\u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0446\u0438\u044e, 3 - express \u0438 \u0440\u0443\u0441\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a 9 \u0438\u0437 11)  <code>systemctl status mssql-server</code> <code>curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442  <code>curl https://packages.microsoft.com/config/ubuntu/20.04/prod.list | tee /etc/apt/sources.list.d/msprod.list</code> <code>apt-get update</code> <code>apt-get install mssql-tools</code> <code>echo 'export PATH=\"$PATH:/opt/mssql-tools/bin\"' &gt;&gt; ~/.bashrc</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u0444\u0430\u0439\u043b\u0430 bashrc, \u0447\u0442\u043e \u0431\u044b \u043d\u0435 \u043f\u0438\u0441\u0430\u0442\u044c \u043f\u0443\u0442\u044c \u043a \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u043e\u043c\u0443 \u0444\u0430\u0439\u043b\u0443  <code>export PATH=\"$PATH:/opt/mssql-tools/bin\"</code> <code>iptables -I INPUT 1 -p tcp --dport 1433 -j ACCEPT</code></p> <pre><code>sqlcmd -S localhost -U SA\nCREATE DATABASE itinvent\ngo\nSELECT name FROM master.dbo.sysdatabases\ngo\n</code></pre>"},{"location":"Database/#systemdatasqlclient","title":"System.Data.SqlClient","text":"<pre><code>$user = \"itinvent\"\n$pass = \"itinvent\"\n$db   = \"itinvent\"\n$srv  = \"192.168.3.103\"\n$SqlConnection = New-Object System.Data.SqlClient.SqlConnection\n$SqlConnection.ConnectionString = \"server=$srv;database=$db;user id=$user;password=$pass;Integrated Security=false\"\n\n$SqlCommand = New-Object System.Data.SqlClient.SqlCommand` \u043a\u043b\u0430\u0441\u0441 \u0444\u043e\u0440\u043c\u0430\u0442\u0430 \u043a\u043e\u043c\u0430\u043d\u0434\u044b\n$SqlCommand.CommandText = \"SELECT * FROM ITINVENT.dbo.USERS\"` \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0442\u0430\u0431\u043b\u0438\u0446\u044b\n#$SqlCommand.CommandText = \"SELECT LICENCE_DATE,DESCR,MODEL_NO,TYPE_NO FROM ITINVENT.dbo.ITEMS where LICENCE_DATE IS NOT NULL\"\n$SqlCommand.Connection = $SqlConnection` \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0444\u043e\u0440\u043c\u0430\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f\n$SqlAdapter = New-Object System.Data.SqlClient.SqlDataAdapter` \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0430\u0434\u0430\u043f\u0442\u0435\u0440 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f SELECT \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043a \u0411\u0414\n$SqlAdapter.SelectCommand = $SqlCommand` \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443\n\n$DataSet = New-Object System.Data.DataSet` \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442 \u043f\u0440\u0438\u0435\u043c\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0444\u043e\u0440\u043c\u0430\u0442\u0430 XML\n$SqlAdapter.Fill($DataSet)` \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0435 \u043e\u0442 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0430 (\u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043a\u043e\u043b-\u0432\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432)\n$SqlConnection.Close()\n$Data = $DataSet.Tables\n$Data[0] | ft\n</code></pre>"},{"location":"Database/#sqlclient-insert","title":"SqlClient INSERT","text":"<pre><code>$user = \"itinvent\"\n$pass = \"itinvent\"\n$db   = \"db_test\"\n$srv  = \"192.168.3.103\"\n$sql = \"INSERT INTO table_test (column_user) VALUES ('lifailon')\"` \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0443 table_test \u0432 \u043a\u043e\u043b\u043e\u043d\u043a\u0443 column_user\n$SqlConnection = New-Object System.Data.SqlClient.SqlConnection\n$SqlConnection.ConnectionString = \"server=$srv;database=$db;user id=$user;password=$pass;Integrated Security=false\"\n$SqlCommand = New-Object System.Data.SqlClient.SqlCommand\n$SqlCommand.CommandText = $sql\n$SqlCommand.Connection = $SqlConnection\n$SqlConnection.Open()\n$rowsAffected = $SqlCommand.ExecuteNonQuery();` \u0434\u043b\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 INSERT/UPDATE/DELETE \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f SqlDataAdapter\n$SqlConnection.Close()\n</code></pre>"},{"location":"Database/#ssms-insert","title":"SSMS INSERT","text":"<pre><code>USE [db_test]\nGO\nINSERT INTO [dbo].[table_test]\n           ([column_user])\n     VALUES\n           ('lifailon')\nGO\nSELECT TOP (1000) [column_user]\nFROM [db_test].[dbo].[table_test]\n</code></pre>"},{"location":"Database/#t-sql","title":"T-SQL","text":"<ul> <li> <p>DDL (Data Definition Language / \u042f\u0437\u044b\u043a \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445). \u041a \u044d\u0442\u043e\u043c\u0443 \u0442\u0438\u043f\u0443 \u043e\u0442\u043d\u043e\u0441\u044f\u0442\u0441\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u043e\u0437\u0434\u0430\u044e\u0442 \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445, \u0442\u0430\u0431\u043b\u0438\u0446\u044b, \u0438\u043d\u0434\u0435\u043a\u0441\u044b, \u0445\u0440\u0430\u043d\u0438\u043c\u044b\u0435 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b.  <code>CREATE</code> \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 (\u0441\u0430\u043c\u0443 \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u044b\u0445, \u0442\u0430\u0431\u043b\u0438\u0446\u044b, \u0438\u043d\u0434\u0435\u043a\u0441\u044b \u0438 \u0442.\u0434.)  <code>ALTER</code> \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445  <code>DROP</code> \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445  <code>TRUNCATE</code> \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0432\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0442\u0430\u0431\u043b\u0438\u0446</p> </li> <li> <p>DML (Data Manipulation Language / \u042f\u0437\u044b\u043a \u043c\u0430\u043d\u0438\u043f\u0443\u043b\u044f\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438). \u041a \u044d\u0442\u043e\u043c\u0443 \u0442\u0438\u043f\u0443 \u043e\u0442\u043d\u043e\u0441\u044f\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043f\u043e \u0432\u044b\u0431\u043e\u0440\u0443, \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044e, \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044e \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044e \u0434\u0430\u043d\u043d\u044b\u0445.  <code>SELECT</code> \u0438\u0437\u0432\u043b\u0435\u043a\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0411\u0414  <code>UPDATE</code> \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435  <code>INSERT</code> \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u043e\u0432\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435  <code>DELETE</code> \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435</p> </li> <li> <p>DCL (Data Control Language / \u042f\u0437\u044b\u043a \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0434\u0430\u043d\u043d\u044b\u043c). \u041a \u044d\u0442\u043e\u043c\u0443 \u0442\u0438\u043f\u0443 \u043e\u0442\u043d\u043e\u0441\u044f\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0442 \u043f\u0440\u0430\u0432\u0430\u043c\u0438 \u043f\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0443 \u043a \u0434\u0430\u043d\u043d\u044b\u043c.  <code>GRANT</code> \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u043f\u0440\u0430\u0432\u0430 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0434\u0430\u043d\u043d\u044b\u043c  <code>REVOKE</code> \u043e\u0442\u0437\u044b\u0432\u0430\u0435\u0442 \u043f\u0440\u0430\u0432\u0430 \u043d\u0430 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0434\u0430\u043d\u043d\u044b\u043c</p> </li> </ul> <pre><code>-- \u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435\nDECLARE @text NVARCHAR(20), @int INT;\nSET @text='Test';\nSET @int = 21;\nselect @text,@int\n\n-- \u0418\u043c\u0435\u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 \nSelect @@SERVERNAME as [Server\\Instance]; \n\n-- \u0432\u0435\u0440\u0441\u0438\u044f SQL Server \nSelect @@VERSION as SQLServerVersion; \n\n-- \u0422\u0435\u043a\u0443\u0449\u0430\u044f \u0411\u0414 (\u0411\u0414, \u0432 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0435 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0437\u0430\u043f\u0440\u043e\u0441)\nSelect DB_NAME() AS CurrentDB_Name;\n\n-- \u0412\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\nSELECT  @@Servername AS ServerName ,\n        create_date AS  ServerStarted ,\n        DATEDIFF(s, create_date, GETDATE()) / 86400.0 AS DaysRunning ,\n        DATEDIFF(s, create_date, GETDATE()) AS SecondsRunnig\nFROM    sys.databases\nWHERE   name = 'tempdb';\n\n-- \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439\nSELECT  @@Servername AS Server ,\n        DB_NAME(database_id) AS DatabaseName ,\n        COUNT(database_id) AS Connections ,\n        Login_name AS  LoginName ,\n        MIN(Login_Time) AS Login_Time ,\n        MIN(COALESCE(last_request_end_time, last_request_start_time))\n                                                         AS  Last_Batch\nFROM    sys.dm_exec_sessions\nWHERE   database_id &gt; 0\n        AND DB_NAME(database_id) NOT IN ( 'master', 'msdb' )\nGROUP BY database_id ,\n         login_name\nORDER BY DatabaseName;\n\n-- \u0421\u0442\u0430\u0442\u0443\u0441 Backup\nSELECT  @@Servername AS ServerName ,\n        d.Name AS DBName ,\n        MAX(b.backup_finish_date) AS LastBackupCompleted\nFROM    sys.databases d\n        LEFT OUTER JOIN msdb..backupset b\n                    ON b.database_name = d.name\n                       AND b.[type] = 'D'\nGROUP BY d.Name\nORDER BY d.Name;\n\n-- \u041f\u0443\u0442\u044c \u043a Backup\nSELECT  @@Servername AS ServerName ,\n        d.Name AS DBName ,\n        b.Backup_finish_date ,\n        bmf.Physical_Device_name\nFROM    sys.databases d\n        INNER JOIN msdb..backupset b ON b.database_name = d.name\n                                        AND b.[type] = 'D'\n        INNER JOIN msdb.dbo.backupmediafamily bmf ON b.media_set_id = bmf.media_set_id\nORDER BY d.NAME ,\n        b.Backup_finish_date DESC; \n\n-- \u0412\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0411\u0414, \u043c\u043e\u0434\u0435\u043b\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0438 \u043f\u0443\u0442\u044c \u043a mdf/ldf\nEXEC sp_helpdb; \nSELECT  @@SERVERNAME AS Server ,\n        d.name AS DBName ,\n        create_date ,\n        recovery_model_Desc AS RecoveryModel ,\n        m.physical_name AS FileName\nFROM    sys.databases d\n        JOIN sys.master_files m ON d.database_id = m.database_id\nORDER BY d.name;\n\n-- \u0420\u0430\u0437\u043c\u0435\u0440 \u0411\u0414\nwith fs\nas\n(\n    select database_id, type, size * 8.0 / 1024 size\n    from sys.master_files\n)\nselect \n    name,\n    (select sum(size) from fs where type = 0 and fs.database_id = db.database_id) DataFileSizeMB,\n    (select sum(size) from fs where type = 1 and fs.database_id = db.database_id) LogFileSizeMB\nfrom sys.databases \n\n-- \u041f\u043e\u0438\u0441\u043a \u0442\u0430\u0431\u043b\u0438\u0446\u044b \u043f\u043e \u043c\u0430\u0441\u043a\u0435 \u0438\u043c\u0435\u043d\u0438 (\u0432\u044b\u0432\u043e\u0434: \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u0441\u0445\u0435\u043c\u044b \u0433\u0434\u0435 \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0433\u0430\u0435\u0442\u0441\u044f \u043e\u0431\u044a\u0435\u043a\u0442, \u0442\u0438\u043f \u043e\u0431\u044a\u0435\u043a\u0442\u0430, \u0434\u0430\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u043c\u043e\u0434\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438):\nselect [object_id], [schema_id],\n       schema_name([schema_id]) as [schema_name], \n       [name], \n       [type], \n       [type_desc], \n       [create_date], \n       [modify_date]\nfrom sys.all_objects\n-- where [name]='INVENT';\nwhere [name] like '%INVENT%';\n\n-- \u041a\u043e\u043b-\u0432\u043e \u0441\u0442\u0440\u043e\u043a \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0430\u0445\nSELECT  @@ServerName AS Server ,\n        DB_NAME() AS DBName ,\n        OBJECT_SCHEMA_NAME(p.object_id) AS SchemaName ,\n        OBJECT_NAME(p.object_id) AS TableName ,\n        i.Type_Desc ,\n        i.Name AS IndexUsedForCounts ,\n        SUM(p.Rows) AS Rows\nFROM    sys.partitions p\n        JOIN sys.indexes i ON i.object_id = p.object_id\n                              AND i.index_id = p.index_id\nWHERE   i.type_desc IN ( 'CLUSTERED', 'HEAP' )\n                             -- This is key (1 index per table) \n        AND OBJECT_SCHEMA_NAME(p.object_id) &lt;&gt; 'sys'\nGROUP BY p.object_id ,\n        i.type_desc ,\n        i.Name\nORDER BY SchemaName ,\n        TableName; \n\n-- \u041d\u0430\u0439\u0442\u0438 \u0441\u0442\u0440\u043e\u043a\u043e\u0432\u043e\u0435 (nvarchar) \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 2023 \u043f\u043e \u0432\u0441\u0435\u043c \u0442\u0430\u0431\u043b\u0438\u0446\u0430\u043c \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445\n-- \u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442\u0441\u044f \u0432 \u043a\u0430\u043a\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 \u0438 \u0441\u0442\u043e\u043b\u0431\u0446\u0435 \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u0430 \u0442\u0430\u043a\u0436\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u0445 \u043f\u0430\u0440\u044b \u0442\u0430\u0431\u043b\u0438\u0446\u0430-\u043a\u043e\u043b\u043e\u043d\u043a\u0430\nset nocount on\ndeclare @name varchar(128), @substr nvarchar(4000), @column varchar(128)\nset @substr = '%2023%'\ndeclare @sql nvarchar(max);\ncreate table`rslt \n(table_name varchar(128), field_name varchar(128), [value] nvarchar(max))\ndeclare s cursor for select table_name as table_name from information_schema.tables where table_type = 'BASE TABLE' order by table_name\nopen s\nfetch next from s into @name\nwhile @@fetch_status = 0\nbegin\ndeclare c cursor for \nselect quotename(column_name) as column_name from information_schema.columns \nwhere data_type in ('text', 'ntext', 'varchar', 'char', 'nvarchar', 'char', 'sysname', 'int', 'tinyint') and table_name  = @name\nset @name = quotename(@name)\nopen c\nfetch next from c into @column\nwhile @@fetch_status = 0\nbegin\n--print 'Processing table - ' + @name + ', column - ' + @column\nset @sql='insert into`rslt select ''' + @name + ''' as Table_name, ''' + @column + ''', cast(' + @column + \n' as nvarchar(max)) from' + @name + ' where cast(' + @column + ' as nvarchar(max)) like ''' + @substr + '''';\nprint @sql;\nexec(@sql);\nfetch next from c into @column;\nend\nclose c\ndeallocate c\nfetch next from s into @name\nend\nselect table_name as [Table Name], field_name as [Field Name], count(*) as [Found Mathes] from`rslt\ngroup by table_name, field_name\norder by table_name, field_name\ndrop table`rslt\nclose s\ndeallocate s\n\n-- \u041f\u043e\u0438\u0441\u043a \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 [CI_HISTORY] \u0438 \u0441\u0442\u043e\u043b\u0431\u0446\u0443 [HIST_ID]:\nSELECT * FROM ITINVENT.dbo.CI_HISTORY where [HIST_ID] like '%2023%';\n\n-- \u0423\u0437\u043d\u0430\u0442\u044c \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u0432\nDECLARE @db_id SMALLINT;\nSET @db_id = DB_ID(N'itinvent');\nIF @db_id IS NULL\nBEGIN;\n    PRINT N'\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0435 \u0438\u043c\u044f \u0431\u0430\u0437\u044b';\nEND;\nELSE\nBEGIN;\n    SELECT\n        object_id AS [ID \u043e\u0431\u044a\u0435\u043a\u0442\u0430],\n        index_id AS [ID \u0438\u043d\u0434\u0435\u043a\u0441\u0430],\n        index_type_desc AS [\u0422\u0438\u043f \u0438\u043d\u0434\u0435\u043a\u0441\u0430],\n        avg_fragmentation_in_percent AS [\u0424\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u0432 %]\n\n    FROM sys.dm_db_index_physical_stats(@db_id, NULL, NULL, NULL , 'LIMITED')\n\n    ORDER BY [avg_fragmentation_in_percent] DESC;\nEND;\nGO\n\n-- TempDB\n-- Initial size - \u043d\u0430\u0447\u0430\u043b\u044c\u043d\u044b\u0439/\u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0411\u0414 (1024 MB)\n-- Autogrowh - \u043f\u0440\u0438\u0440\u043e\u0441\u0442 (512MB)\n-- \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e tempdb \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u0430 \u043d\u0430 \u0430\u0432\u0442\u043e-\u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 (Autogrow) \u0438 \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u0439 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 SQL Server \u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0451\u0442 \u0444\u0430\u0439\u043b\u044b \u044d\u0442\u043e\u0439 \u0411\u0414 \u0441 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u043c \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438.\n-- \u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0432 \u0440\u0430\u0437\u043c\u0435\u0440 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0444\u0430\u0439\u043b\u043e\u0432 tempdb, \u043c\u043e\u0436\u043d\u043e \u0441\u0432\u0435\u0441\u0442\u0438 \u043a \u043c\u0438\u043d\u0438\u043c\u0443\u043c\u0443 \u0437\u0430\u0442\u0440\u0430\u0442\u044b \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u043d\u0430 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0430\u0432\u0442\u043e-\u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f.\n\n-- \u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0443\u0442\u044c \u043a \u0411\u0414:\nUSE master;\nGO\nALTER DATABASE tempdb\nMODIFY FILE (NAME = tempdev, FILENAME = 'F:\\tempdb.mdf');\nGO\nALTER DATABASE tempdb\nMODIFY FILE (NAME = temp2, FILENAME = 'F:\\tempdb_mssql_2.ndf');\nGO\nALTER DATABASE tempdb\nMODIFY FILE (NAME = temp3, FILENAME = 'F:\\tempdb_mssql_3.ndf');\nGO\nALTER DATABASE tempdb\nMODIFY FILE (NAME = temp4, FILENAME = 'F:\\tempdb_mssql_4.ndf');\nGO\nALTER DATABASE tempdb\nMODIFY FILE (NAME = temp5, FILENAME = 'F:\\tempdb_mssql_5.ndf');\nGO\nALTER DATABASE tempdb\nMODIFY FILE (NAME = temp6, FILENAME = 'F:\\tempdb_mssql_6.ndf');\nGO\nALTER DATABASE tempdb\nMODIFY FILE (NAME = temp7, FILENAME = 'F:\\tempdb_mssql_7.ndf');\nGO\nALTER DATABASE tempdb\nMODIFY FILE (NAME = temp8, FILENAME = 'F:\\tempdb_mssql_8.ndf');\nGO\nALTER DATABASE tempdb\nMODIFY FILE (NAME = templog, FILENAME = 'F:\\templog.ldf');\nGO\n\n-- \u0423\u043a\u0430\u0437\u0430\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430:\nMODIFY FILE (NAME = temp2, FILENAME = 'F:\\tempdb_mssql_2.ndf' , SIZE = 1048576KB , FILEGROWTH = 524288KB);\n</code></pre>"},{"location":"Database/#_1","title":"\u0422\u0438\u043f \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0439 \u043a\u043e\u043f\u0438\u0438","text":"<ul> <li>Full (\u041f\u043e\u043b\u043d\u0430\u044f \u043a\u043e\u043f\u0438\u044f). \u041a\u043e\u0433\u0434\u0430 \u0441\u0442\u0430\u0440\u0442\u0443\u0435\u0442 \u043f\u043e\u043b\u043d\u043e\u0435 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435, \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f Log Sequence Number (LSN - \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0436\u0443\u0440\u043d\u0430\u043b\u0430), \u0430 \u0442\u0430\u043a \u0436\u0435 LSN \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0438 \u043f\u0440\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438 \u043f\u043e\u043b\u043d\u043e\u0433\u043e \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. \u042d\u0442\u043e\u0442 LSN \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u043c, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u043c SQL Server, \u0447\u0442\u043e\u0431\u044b \u0437\u043d\u0430\u0442\u044c, \u0432 \u043a\u0430\u043a\u043e\u043c \u043f\u043e\u0440\u044f\u0434\u043a\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u043b\u0438\u0441\u044c \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u044b INSERT, UPDATE \u0438\u043b\u0438 DELETE. \u041f\u0440\u0438 \u044d\u0442\u043e\u043c \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u0437\u0430\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0445 LSN \u043d\u0430\u0447\u0430\u043b\u0430 \u0438 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f, \u043a\u0430\u043a \u0447\u0430\u0441\u0442\u0438 \u043f\u043e\u043b\u043d\u043e\u0433\u043e \u0431\u044d\u043a\u0430\u043f\u0430, \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0441\u043e\u0433\u043b\u0430\u0441\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0441 \u0442\u043e\u0447\u043a\u0438 \u0437\u0440\u0435\u043d\u0438\u044f \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0435 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435, \u043f\u043e\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u043f\u0440\u0438 \u043f\u043e\u043b\u043d\u043e\u043c \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u043c \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f, \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u0435\u0434\u0448\u0438\u0435 \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. \u042d\u0442\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443 \u0442\u0430\u043a\u0438\u0445 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0431\u044d\u043a\u0430\u043f\u0430.</li> <li>Differential (\u0434\u0438\u0444\u0444\u0435\u0440\u0435\u043d\u0446\u0438\u0430\u043b\u044c\u043d\u0430\u044f/\u0440\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u043a\u043e\u043f\u0438\u044f). \u0425\u0440\u0430\u043d\u0438\u0442 \u0434\u0430\u043d\u043d\u044b\u0445, \u0438\u0437\u043c\u0435\u043d\u0438\u0432\u0448\u0438\u0435\u0441\u044f \u0441 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u041f\u043e\u043b\u043d\u043e\u0439 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0439 \u043a\u043e\u043f\u0438\u0438. \u041f\u0440\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043d\u0443\u0436\u043d\u043e \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u041f\u043e\u043b\u043d\u0443\u044e \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 NORECOVERY, \u043f\u043e\u0442\u043e\u043c \u043c\u043e\u0436\u043d\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043b\u044e\u0431\u0443\u044e \u0438\u0437 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u0420\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u044b\u0445 \u043a\u043e\u043f\u0438\u0439, \u0431\u0435\u0437 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0439 \u041f\u043e\u043b\u043d\u043e\u0439 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0439 \u043a\u043e\u043f\u0438\u0438 \u0420\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u043a\u043e\u043f\u0438\u044f \u0431\u0435\u0441\u043f\u043e\u043b\u0435\u0437\u043d\u0430. \u041a\u0430\u0436\u0434\u0430\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u0420\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u043a\u043e\u043f\u0438\u044f \u0431\u0443\u0434\u0435\u0442 \u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0435, \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0432 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0443\u044e \u0420\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u0443\u044e \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e, \u0441\u0434\u0435\u043b\u0430\u043d\u043d\u0443\u044e \u043f\u043e\u0441\u043b\u0435 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0439 \u041f\u043e\u043b\u043d\u043e\u0439 \u043a\u043e\u043f\u0438\u0438.</li> <li>Incremental (\u0438\u043d\u043a\u0440\u0435\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u0430\u044f/\u043a\u043e\u043f\u0438\u044f \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439). \u0420\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0435 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u043a\u043e\u043f\u0438\u0440\u0443\u0435\u0442 \u0432\u0441\u0435 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0438 \u0441 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u0430 \u0437\u0430\u0442\u0435\u043c \u0443\u0440\u0435\u0437\u0430\u0435\u0442 \u0436\u0443\u0440\u043d\u0430\u043b \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u0434\u043b\u044f \u043e\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0435\u043d\u0438\u044f \u0434\u0438\u0441\u043a\u043e\u0432\u043e\u0433\u043e \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0430. \u0422\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u044f\u0442 \u0432 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u043c \u043f\u043e\u0440\u044f\u0434\u043a\u0435 (LSN), \u0431\u044d\u043a\u0430\u043f \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u044d\u0442\u043e\u0442 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439. \u0411\u044d\u043a\u0430\u043f\u044b \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u0434\u043e\u043b\u0436\u043d\u044b \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0442\u044c\u0441\u044f \u043f\u043e \u043f\u043e\u0440\u044f\u0434\u043a\u0443. \u0414\u043b\u044f \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0432\u0441\u044f \u0446\u0435\u043f\u043e\u0447\u043a\u0430 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u044b\u0445 \u043a\u043e\u043f\u0438\u0439: \u043f\u043e\u043b\u043d\u0430\u044f \u0438 \u0432\u0441\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0438\u043d\u043a\u0440\u0435\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439.</li> </ul>"},{"location":"Database/#_2","title":"\u041c\u043e\u0434\u0435\u043b\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f","text":"<ul> <li>Simple (\u041f\u0440\u043e\u0441\u0442\u0430\u044f). \u0425\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0439 \u0434\u043b\u044f \u0436\u0438\u0437\u043d\u0438 \u043e\u0441\u0442\u0430\u0442\u043e\u043a \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439. \u0416\u0443\u0440\u043d\u0430\u043b \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 (\u043b\u043e\u0433) \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043e\u0447\u0438\u0449\u0430\u0435\u0442\u0441\u044f. \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u044b\u0445 \u043a\u043e\u043f\u0438\u0439 \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u0430, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043e\u0441\u0442\u0430\u0435\u0442\u0441\u044f \u0441\u0430\u043c\u043e\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043e\u043f\u0446\u0438\u0439 \u043f\u043e \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044e. \u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b: Always On, Point-In-Time \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435, \u0420\u0435\u0437\u0435\u0440\u0432\u043d\u044b\u0435 \u043a\u043e\u043f\u0438\u0438 \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439.</li> <li>Full (\u041f\u043e\u043b\u043d\u0430\u044f). \u0425\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u0436\u0443\u0440\u043d\u0430\u043b \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u0432\u0441\u0435\u0445 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0432 \u0411\u0414 \u0441 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439. \u0416\u0443\u0440\u043d\u0430\u043b \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u043e\u0447\u0438\u0449\u0430\u0442\u044c\u0441\u044f \u0434\u043e \u0442\u0435\u0445 \u043f\u043e\u0440, \u043f\u043e\u043a\u0430 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0441\u0434\u0435\u043b\u0430\u043d\u0430 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0430\u044f \u043a\u043e\u043f\u0438\u044f \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439.</li> <li>Bulk logged (\u0421 \u043d\u0435\u043f\u043e\u043b\u043d\u044b\u043c \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c). \u0418\u0434\u0435\u043d\u0442\u0438\u0447\u043d\u0430 Full, \u0437\u0430 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435: SELECT INTO, BULK INSERT \u0438 BCP, INSERT INTO SELECT, \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0441 \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u043c\u0438 (CREATE INDEX, ALTER INDEX REBUILD, DROP INDEX)</li> </ul>"},{"location":"Database/#_3","title":"\u0421\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435 \u0411\u0414","text":"<ul> <li>master. \u0425\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0432\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f (\u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b, \u0441\u0432\u0435\u0434\u0435\u043d\u044c\u044f \u043e\u0431 \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0437\u0430\u043f\u0438\u0441\u044f\u0445 \u0432\u0445\u043e\u0434\u0430, \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431\u043e \u0432\u0441\u0435\u0445 \u0434\u0440\u0443\u0433\u0438\u0445 \u0431\u0430\u0437\u0430\u0445 \u0434\u0430\u043d\u043d\u044b\u0445) \u0434\u043b\u044f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 SQL Server.</li> <li>tempdb. \u0420\u0430\u0431\u043e\u0447\u0435\u0435 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e \u0434\u043b\u044f \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432, \u0442\u0430\u043a\u0438\u0445 \u043a\u0430\u043a \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u0438\u043b\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0442\u0430\u0431\u043b\u0438\u0446\u044b, \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0445\u0440\u0430\u043d\u0438\u043c\u044b\u0435 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b, \u0442\u0430\u0431\u043b\u0438\u0447\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0438 \u043a\u0443\u0440\u0441\u043e\u0440\u044b. \u041f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u0437\u0430\u043f\u0443\u0441\u043a\u0435 SQL Server.</li> <li>model. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0448\u0430\u0431\u043b\u043e\u043d\u0430 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0431\u0430\u0437 \u0434\u0430\u043d\u043d\u044b\u0445, \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0435\u043c\u044b\u0445 \u0432 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0435 SQL Server, \u0432\u0441\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 model, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445, \u043a\u043e\u043f\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0435\u043c\u0443\u044e \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445. \u0422\u0430\u043a \u043a\u0430\u043a \u0431\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 tempdb \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u0436\u0434\u044b\u0439 \u0440\u0430\u0437 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 SQL Server, \u0431\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 model \u0432\u0441\u0435\u0433\u0434\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 SQL Server. </li> <li>msdb. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0430\u0433\u0435\u043d\u0442\u043e\u043c SQL Server \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u043f\u0440\u0435\u0434\u0443\u043f\u0440\u0435\u0436\u0434\u0435\u043d\u0438\u0439 (\u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440) \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u0439, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438. SQL Server \u0445\u0440\u0430\u043d\u0438\u0442 \u043f\u043e\u043b\u043d\u044b\u0439 \u0436\u0443\u0440\u043d\u0430\u043b \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 msdb. \u0414\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u043f\u043e\u0447\u0442\u044b \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0443 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f: USE [msdb].</li> <li>resource. \u0414\u043e\u0441\u0442\u0443\u043f\u043d\u0430\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f \u0431\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0432\u0441\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 sys.objects, \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 resource, \u043d\u043e \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0432 \u0441\u0445\u0435\u043c\u0435 sys \u043a\u0430\u0436\u0434\u043e\u0439 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445.</li> </ul>"},{"location":"Database/#_4","title":"\u0420\u0435\u0433\u043b\u0430\u043c\u0435\u043d\u0442\u043d\u044b\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438","text":"<ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u0438 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445</li> </ul> <p><code>DBCC CHECKDB</code></p> <ul> <li> <p>\u0418\u043d\u0434\u0435\u043a\u0441\u044b. \u0418\u043d\u0434\u0435\u043a\u0441\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0434\u043b\u044f \u0431\u044b\u0441\u0442\u0440\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0431\u0435\u0437 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043f\u043e\u0438\u0441\u043a\u0430/\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0432\u0441\u0435\u0445 \u0441\u0442\u0440\u043e\u043a \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a \u0442\u0430\u0431\u043b\u0438\u0446\u0435 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445. \u0418\u043d\u0434\u0435\u043a\u0441 \u0443\u0441\u043a\u043e\u0440\u044f\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0437\u0430\u043f\u0440\u043e\u0441\u0430, \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u044f \u0431\u044b\u0441\u0442\u0440\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u0442\u0440\u043e\u043a\u0430\u043c \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435, \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e \u0442\u043e\u043c\u0443, \u043a\u0430\u043a \u0443\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u044c \u0432 \u043a\u043d\u0438\u0433\u0435 \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u0432\u0430\u043c \u0431\u044b\u0441\u0442\u0440\u043e \u043d\u0430\u0439\u0442\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e. \u0418\u043d\u0434\u0435\u043a\u0441\u044b \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0442 \u043f\u0443\u0442\u044c \u0434\u043b\u044f \u0431\u044b\u0441\u0442\u0440\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u0432 \u044d\u0442\u0438\u0445 \u0441\u0442\u043e\u043b\u0431\u0446\u0430\u0445. \u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0438\u043d\u0434\u0435\u043a\u0441\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u0435\u0433\u043e \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430. MS SQL Server \u0441\u0430\u043c\u043e\u0441\u0442\u043e\u044f\u0442\u0435\u043b\u044c\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0438 \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442 \u0438\u043d\u0434\u0435\u043a\u0441\u044b \u043f\u0440\u0438 \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u0431\u0430\u0437\u043e\u0439. \u0421 \u0442\u0435\u0447\u0435\u043d\u0438\u0435\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0438\u043d\u0434\u0435\u043a\u0441\u0435 \u0441\u0442\u0430\u043d\u043e\u0432\u044f\u0442\u0441\u044f \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c\u0438, \u0442.\u0435. \u0440\u0430\u0437\u0431\u0440\u043e\u0441\u0430\u043d\u043d\u044b\u043c\u0438 \u043f\u043e \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445, \u0447\u0442\u043e \u0441\u0435\u0440\u044c\u0435\u0437\u043d\u043e \u0441\u043d\u0438\u0436\u0430\u0435\u0442 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432. \u0415\u0441\u043b\u0438 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u0441\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u043e\u0442 5 \u0434\u043e 30% (\u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e \u0432 \u0437\u0430\u0434\u0430\u043d\u0438\u0438 15%), \u0442\u043e \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442\u0441\u044f \u0435\u0435 \u0443\u0441\u0442\u0440\u0430\u043d\u0438\u0442\u044c \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0440\u0435\u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438, \u043f\u0440\u0438 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0432\u044b\u0448\u0435 30% (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0432 \u0437\u0430\u0434\u0430\u0447\u0435 &gt; 30% \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0438 \u0447\u0438\u0441\u043b\u043e \u0441\u0442\u0440\u0430\u043d\u0438\u0446 &gt; 1000) \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u043e\u043b\u043d\u043e\u0435 \u043f\u0435\u0440\u0435\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u0435 \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u0432. \u041f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u043d\u043e\u0432\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0440\u0435\u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f.</p> </li> <li> <p>\u0420\u0435\u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f (Reorganize) \u0438\u043b\u0438 \u0434\u0435\u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u0438\u043d\u0434\u0435\u043a\u0441\u0430 \u2014 \u044d\u0442\u043e \u0441\u0435\u0440\u0438\u044f \u043d\u0435\u0431\u043e\u043b\u044c\u0448\u0438\u0445 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446 \u0442\u0430\u043a, \u0447\u0442\u043e\u0431\u044b \u0438\u043d\u0434\u0435\u043a\u0441 \u043d\u0435 \u0431\u044b\u043b \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d. \u041f\u043e\u0441\u043b\u0435 \u0440\u0435\u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043d\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f. \u0412\u043e \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u0447\u0442\u0438 \u0432\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u0441\u043c\u043e\u0433\u0443\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c.</p> </li> </ul> <p><code>sp_msforeachtable N'DBCC INDEXDEFRAG (&lt;\u0438\u043c\u044f \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445&gt;, ''?'')'</code></p> <ul> <li>\u041f\u0435\u0440\u0435\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u0435 (Rebuild) \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u0432 (\u0438\u043b\u0438 \u0437\u0430\u0434\u0430\u0447\u0430 \u0432 \u043c\u0430\u0441\u0442\u0435\u0440\u0435 \u043f\u043b\u0430\u043d\u043e\u0432 \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u044f: \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u043d\u0434\u0435\u043a\u0441) \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u043e\u043b\u043d\u043e\u0433\u043e \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u044f \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u0432. \u0412 \u0432\u0435\u0440\u0441\u0438\u0438 MS SQL Server Standard \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432 \u043e\u0442 \u0431\u0430\u0437\u044b \u043d\u0430 \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438. \u041f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430.</li> </ul> <p><code>sp_msforeachtable N'DBCC DBREINDEX (''?'')'</code></p> <ul> <li>\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438. \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u2014 \u043d\u0435\u0431\u043e\u043b\u044c\u0448\u0430\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0430 (\u043e\u0431\u044b\u0447\u043d\u043e \u0434\u043e 200 \u0441\u0442\u0440\u043e\u043a), \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u043e\u0431\u043e\u0431\u0449\u0435\u043d\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0442\u043e\u043c, \u043a\u0430\u043a\u0438\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0438 \u043a\u0430\u043a \u0447\u0430\u0441\u0442\u043e \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u044e\u0442\u0441\u044f \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435. \u041d\u0430 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438 \u0441\u0435\u0440\u0432\u0435\u0440 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u0440\u0435\u0448\u0435\u043d\u0438\u0435, \u043a\u0430\u043a \u043b\u0443\u0447\u0448\u0435 \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441. \u041a\u043e\u0433\u0434\u0430 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u044f\u0442 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u0411\u0414 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, SELECT) \u0432\u044b \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442\u0435 \u0434\u0430\u043d\u043d\u044b\u0435, \u043d\u043e \u043d\u0435 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442\u0435 \u0442\u043e, \u043a\u0430\u043a \u044d\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0438\u0437\u0432\u043b\u0435\u0447\u0435\u043d\u044b. \u0412 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430. \u0412\u043e \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0435 \u0431\u043b\u043e\u043a\u0438\u0440\u0443\u044e\u0442\u0441\u044f.</li> </ul> <p><code>exec sp_msforeachtable N'UPDATE STATISTICS ? WITH FULLSCAN'</code></p> <ul> <li>\u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u043d\u043e\u0433\u043e \u043a\u044d\u0448\u0430, \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u043f\u043e\u0441\u043b\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438. \u041e\u043f\u0442\u0438\u043c\u0438\u0437\u0430\u0442\u043e\u0440 MS SQL Server \u043a\u044d\u0448\u0438\u0440\u0443\u0435\u0442 \u043f\u043b\u0430\u043d\u044b \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0434\u043b\u044f \u0438\u0445 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0433\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f. \u042d\u0442\u043e \u0434\u0435\u043b\u0430\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b \u044d\u043a\u043e\u043d\u043e\u043c\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u044f, \u0437\u0430\u0442\u0440\u0430\u0447\u0438\u0432\u0430\u0435\u043c\u043e\u0435 \u043d\u0430 \u043a\u043e\u043c\u043f\u0438\u043b\u044f\u0446\u0438\u044e \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0432 \u0442\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u0442\u0430\u043a\u043e\u0439 \u0436\u0435 \u0437\u0430\u043f\u0440\u043e\u0441 \u0443\u0436\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u043b\u0441\u044f \u0438 \u0435\u0433\u043e \u043f\u043b\u0430\u043d \u0438\u0437\u0432\u0435\u0441\u0442\u0435\u043d. \u041f\u043e\u0441\u043b\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438, \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u043e\u0447\u0438\u0449\u0435\u043d \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u043d\u044b\u0439 \u043a\u044d\u0448, \u0442\u043e SQL Server \u043c\u043e\u0436\u0435\u0442 \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0441\u0442\u0430\u0440\u044b\u0439 (\u043d\u0435\u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439) \u043f\u043b\u0430\u043d \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0438\u0437 \u043a\u044d\u0448\u0430 \u0432\u043c\u0435\u0441\u0442\u043e \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 (\u0431\u043e\u043b\u0435\u0435 \u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439) \u043f\u043b\u0430\u043d.</li> </ul> <p><code>DBCC FREEPROCCACHE</code></p>"},{"location":"Database/#elasticsearch","title":"Elasticsearch","text":"<p><code>Install-Module -Name Elastic.Console -AllowPrerelease</code> github source <code>Get-Command -Module Elastic.Console</code> <code>Get-ElasticsearchVersion</code> <code>Set-ElasticsearchVersion 7.3.0</code> <code>Invoke-Elasticsearch</code> REST API \u0437\u0430\u043f\u0440\u043e\u0441\u044b</p>"},{"location":"Database/#cdata","title":"CData","text":"<p>PowerShell Gallery CData Automate Elasticsearch Integration Tasks from PowerShell</p> <p><code>Install-Module ElasticsearchCmdlets</code> \u043f\u0430\u043a\u0435\u0442 \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u0430 \u0432 psgallery <code>Import-Module ElasticsearchCmdlets</code> <code>Get-Command -Module ElasticsearchCmdlets</code></p> <pre><code>$elasticsearch = Connect-Elasticsearch  -Server \"$Server\" -Port \"$Port\" -User \"$User\" -Password \"$Password\"\n$shipcity = \"New York\"\n$orders = Select-Elasticsearch -Connection $elasticsearch -Table \"Orders\" -Where \"ShipCity = `'$ShipCity`'\"` \u043f\u043e\u0438\u0441\u043a \u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445\n$orders = Invoke-Elasticsearch -Connection $elasticsearch -Query 'SELECT * FROM Orders WHERE ShipCity = @ShipCity' -Params @{'@ShipCity'='New York'}` SQL \u0437\u0430\u043f\u0440\u043e\u0441\u044b\n</code></pre>"},{"location":"Database/#adonet-assembly","title":"ADO.NET Assembly","text":"<p><code>Install-Package CData.Elasticsearch</code> \u043f\u0430\u043a\u0435\u0442 \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u0430 \u0432 nuget <code>[Reflection.Assembly]::LoadFile(\"C:\\Program Files\\PackageManagement\\NuGet\\Packages\\CData.Elasticsearch.23.0.8565\\lib\\net40\\System.Data.CData.Elasticsearch.dll\")</code></p> <pre><code>$connect = New-Object System.Data.CData.Elasticsearch.ElasticsearchConnection(\"Server=127.0.0.1;Port=9200;User=admin;Password=123456;\")\n$connect.Open()\n$sql = \"SELECT OrderName, Freight from Orders\"\n$da = New-Object System.Data.CData.Elasticsearch.ElasticsearchDataAdapter($sql, $conn)\n$dt = New-Object System.Data.DataTable\n$da.Fill($dt)\n$dt.Rows | foreach {\nWrite-Host $_.ordername $_.freight\n}\n</code></pre>"},{"location":"Database/#update_1","title":"UPDATE","text":"<pre><code>Update-Elasticsearch -Connection $Elasticsearch -Columns @('OrderName','Freight') -Values @('MyOrderName', 'MyFreight') -Table Orders -Id \"MyId\"\n\n$cmd =  New-Object System.Data.CData.Elasticsearch.ElasticsearchCommand(\"UPDATE Orders SET ShipCity='New York' WHERE Id = @myId\", $conn)\n$cmd.Parameters.Add(new System.Data.CData.Elasticsearch.ElasticsearchParameter(\"@myId\",\"10456255-0015501366\"))\n$cmd.ExecuteNonQuery()\n</code></pre>"},{"location":"Database/#insert_1","title":"INSERT","text":"<pre><code>Add-Elasticsearch -Connection $Elasticsearch -Table Orders -Columns @(\"OrderName\", \"Freight\") -Values @(\"MyOrderName\", \"MyFreight\")\n\n$cmd =  New-Object System.Data.CData.Elasticsearch.ElasticsearchCommand(\"INSERT INTO Orders (ShipCity) VALUES (@myShipCity)\", $conn)\n$cmd.Parameters.Add(new System.Data.CData.Elasticsearch.ElasticsearchParameter(\"@myShipCity\",\"New York\"))\n$cmd.ExecuteNonQuery()\n</code></pre>"},{"location":"Database/#delete_1","title":"DELETE","text":"<pre><code>Remove-Elasticsearch -Connection $Elasticsearch -Table \"Orders\" -Id \"MyId\"\n\n$cmd =  New-Object System.Data.CData.Elasticsearch.ElasticsearchCommand(\"DELETE FROM Orders WHERE Id=@myId\", $conn)\n$cmd.Parameters.Add(new System.Data.CData.Elasticsearch.ElasticsearchParameter(\"@myId\",\"001d000000YBRseAAH\"))\n$cmd.ExecuteNonQuery()\n</code></pre>"},{"location":"Database/#odbc","title":"ODBC","text":"<p><code>Get-Command -Module Wdac</code> <code>Get-OdbcDriver | ft</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u043e\u0432</p> <p>Elasticsearch ODBC \u0434\u0440\u0430\u0439\u0432\u0435\u0440 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0434\u0430\u043d\u043d\u044b\u043c Elasticsearch \u0438\u0437 Microsoft PowerShell</p> <pre><code>$connectstring = \"DSN=Local Elasticsearch;\"\n$sql = \"SELECT * FROM library\"\n$conn = New-Object System.Data.Odbc.OdbcConnection($connectstring)\n$conn.open()\n$cmd = New-Object system.Data.Odbc.OdbcCommand($sql,$conn)\n$da = New-Object system.Data.Odbc.OdbcDataAdapter($cmd)\n$dt = New-Object system.Data.datatable\n$null = $da.fill($dt)\n$conn.close()\n$dt\n</code></pre>"},{"location":"Database/#postgresql","title":"PostgreSQL","text":""},{"location":"Database/#odbc-driver","title":"ODBC Driver","text":"<p>\u0421\u043a\u0430\u0447\u0430\u0442\u044c \u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0440\u0430\u0439\u0432\u0435\u0440</p> <pre><code>$dbServer = \"192.168.3.101\"\n$port = \"5432\"\n$dbName = \"test\"\n$dbUser = \"admin\"\n$dbPass = \"admin\"\n$szConnect = \"Driver={PostgreSQL Unicode(x64)};Server=$dbServer;Port=$port;Database=$dbName;Uid=$dbUser;Pwd=$dbPass;\" \n\n$cnDB = New-Object System.Data.Odbc.OdbcConnection($szConnect)\n$dsDB = New-Object System.Data.DataSet\ntry {\n    $cnDB.Open()\n    $adDB = New-Object System.Data.Odbc.OdbcDataAdapter\n    $adDB.SelectCommand = New-Object System.Data.Odbc.OdbcCommand(\"SELECT id, name, age, login FROM public.users\" , $cnDB)\n    $adDB.Fill($dsDB)\n    $cnDB.Close()\n}\ncatch [System.Data.Odbc.OdbcException] {\n    $_.Exception\n    $_.Exception.Message\n    $_.Exception.ItemName\n}\nforeach ($row in $dsDB[0].Tables[0].Rows) {\n    $row.login\n    $row.age\n}\n</code></pre>"},{"location":"Database/#npgsql","title":"npgsql","text":"<p>Source Package</p> <pre><code># \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u0441\u0431\u043e\u0440\u043a\u0443 Npgsql\nAdd-Type -Path \"$home\\Documents\\Npgsql.PostgreSQL\\8.0.4\\net8.0\\Npgsql.EntityFrameworkCore.PostgreSQL.dll\"\n# \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c \u0441\u0442\u0440\u043e\u043a\u0443 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 PostgreSQL\n$connString = \"Host=myserver;Username=mylogin;Password=mypass;Database=mydatabase\"\n# \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043e\u0431\u044a\u0435\u043a\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f\n$conn = New-Object Npgsql.NpgsqlConnection($connString)\n# \u041e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0431\u0430\u0437\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445\n$conn.Open()\ntry {\n    # \u0421\u043e\u0437\u0434\u0430\u0435\u043c SQL \u043a\u043e\u043c\u0430\u043d\u0434\u0443\n    $cmd = $conn.CreateCommand()\n    $cmd.CommandText = \"INSERT INTO data (some_field) VALUES (@p)\"\n    # \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0438 \u0435\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\n    $param = $cmd.Parameters.Add(\"p\", [NpgsqlTypes.NpgsqlDbType]::Text)\n    $param.Value = \"Hello world\"\n    # \u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u043a\u043e\u043c\u0430\u043d\u0434\u0443\n    $cmd.ExecuteNonQuery() | Out-Null\n} finally {\n    $cmd.Dispose()\n}\n# \u0418\u0437\u0432\u043b\u0435\u043a\u0430\u0435\u043c \u0432\u0441\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 \u0438\u0437 \u0442\u0430\u0431\u043b\u0438\u0446\u044b\ntry {\n    # \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043a\u043e\u043c\u0430\u043d\u0434\u0443 SQL \u0434\u043b\u044f \u0438\u0437\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445\n    $cmd = $conn.CreateCommand()\n    $cmd.CommandText = \"SELECT some_field FROM data\"\n    # \u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0438 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u043e\u0431\u044a\u0435\u043a\u0442 \u0447\u0442\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445\n    $reader = $cmd.ExecuteReader()\n    # \u0427\u0438\u0442\u0430\u0435\u043c \u0438 \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u043e\n    while ($reader.Read()) {\n        Write-Host $reader.GetString(0)\n    }\n} finally {\n    # \u041e\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0430\u0435\u043c \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u0447\u0442\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043a\u043e\u043c\u0430\u043d\u0434\u044b\n    $reader.Dispose()\n    $cmd.Dispose()\n}\n# \u0417\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0431\u0430\u0437\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445\n$conn.Close()\n$conn.Dispose()\n</code></pre>"},{"location":"DevOps/","title":"DevOps","text":""},{"location":"DevOps/#dsc","title":"DSC","text":"<p><code>Import-Module PSDesiredStateConfiguration</code> <code>Get-Command -Module PSDesiredStateConfiguration</code> <code>(Get-Module PSDesiredStateConfiguration).ExportedCommands</code> <code>Get-DscLocalConfigurationManager</code></p> <p><code>Get-DscResource</code> <code>Get-DscResource -Name File -Syntax</code> \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0441</p> <p><code>Ensure = Present</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0430 (\u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c, \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u0443\u0449\u0435\u043d, \u0435\u0441\u043b\u0438 \u043d\u0435\u0442 \u2013 \u0441\u043e\u0437\u0434\u0430\u0442\u044c, \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c)  <code>Ensure = Absent</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u0430 (\u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 \u0431\u044b\u0442\u044c \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u043e, \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u0443\u0449\u0435\u043d, \u0435\u0441\u043b\u0438 \u043d\u0435\u0442 \u2013 \u0443\u0434\u0430\u043b\u0438\u0442\u044c, \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c)</p> <pre><code>Configuration TestConfiguraion\n{\n    Ctrl+Space\n}\n\nConfiguration DSConfigurationProxy \n{\n    Node vproxy-01 \n    {\n        File CreateDir\n        {\n            Ensure = \"Present\"\n            Type = \"Directory\"\n            DestinationPath = \"C:\\Temp\"\n        }\n        Service StopW32time\n        {\n            Name = \"w32time\"\n            State = \"Stopped\"` Running\n        }\n        WindowsProcess RunCalc\n        {\n            Ensure = \"Present\"\n            Path = \"C:\\WINDOWS\\system32\\calc.exe\"\n            Arguments = \"\"\n        }\n        Registry RegSettings\n        {\n            Ensure = \"Present\"\n            Key = \"HKEY_LOCAL_MACHINE\\SOFTWARE\\MySoft\"\n            ValueName = \"TestName\"\n            ValueData = \"TestValue\"\n            ValueType = \"String\"\n        }\n#       WindowsFeature IIS\n#       {\n#            Ensure = \"Present\"\n#            Name = \"Web-Server\"\n#       }\n    }\n}\n</code></pre> <p><code>$Path = (DSConfigurationProxy).DirectoryName</code> <code>Test-DscConfiguration -Path $Path | select *</code> ResourcesInDesiredState - \u0443\u0436\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043e, ResourcesNotInDesiredState - \u043d\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043e (\u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442)  <code>Start-DscConfiguration -Path $Path</code> <code>Get-Job</code> <code>$srv = \"vproxy-01\"</code> <code>Get-Service -ComputerName $srv | ? name -match w32time # Start-Service</code> <code>icm $srv {Get-Process | ? ProcessName -match calc} | ft # Stop-Process -Force</code> <code>icm $srv {ls C:\\ | ? name -match Temp} | ft</code> rm`</p> <pre><code>Configuration InstallPowerShellCore {\n    Import-DscResource -ModuleName PSDesiredStateConfiguration\n    Node localhost {\n        Script InstallPowerShellCore {\n            GetScript = {\n                return @{\n                    GetScript = $GetScript\n                }\n            }\n            SetScript = {\n                [string]$url = $(Invoke-RestMethod https://api.github.com/repos/PowerShell/PowerShell/releases/latest).assets.browser_download_url -match \"win-x64.zip\"\n                $downloadPath = \"$home\\Downloads\\PowerShell.zip\"\n                $installPath = \"$env:ProgramFiles\\PowerShell\\7\"\n                Invoke-WebRequest -Uri $url -OutFile $downloadPath\n                Expand-Archive -Path $downloadPath -DestinationPath $installPath -Force\n            }\n            TestScript = {\n                return Test-Path \"$env:ProgramFiles\\PowerShell\\7\\pwsh.exe\"\n            }\n        }\n    }\n}\n</code></pre> <p><code>$Path = (InstallPowerShellCore).DirectoryName</code> <code>Test-DscConfiguration -Path $Path</code> <code>Start-DscConfiguration -Path $path -Wait -Verbose</code> <code>Get-Job</code></p>"},{"location":"DevOps/#github-actions","title":"GitHub-Actions","text":""},{"location":"DevOps/#runner-agent","title":"Runner (Agent)","text":"<p><code>mkdir actions-runner; cd actions-runner</code> <code>Invoke-WebRequest -Uri https://github.com/actions/runner/releases/download/v2.316.1/actions-runner-win-x64-2.316.1.zip -OutFile actions-runner-win-x64-2.316.1.zip</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 \u0441 Runner \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0432\u0435\u0440\u0441\u0438\u0438  <code>if((Get-FileHash -Path actions-runner-win-x64-2.316.1.zip -Algorithm SHA256).Hash.ToUpper() -ne 'e41debe4f0a83f66b28993eaf84dad944c8c82e2c9da81f56a850bc27fedd76b'.ToUpper()){ throw 'Computed checksum did not match' }</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0432\u0430\u043b\u0438\u0434\u043d\u043e\u0441\u0442\u044c \u043f\u0430\u043a\u0435\u0442\u0430 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e hash-\u0441\u0443\u043c\u043c\u044b  <code>Add-Type -AssemblyName System.IO.Compression.FileSystem ; [System.IO.Compression.ZipFile]::ExtractToDirectory(\"$PWD/actions-runner-win-x64-2.316.1.zip\", \"$PWD\")</code> \u0440\u0430\u0437\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c  <code>Remove-Item *.zip</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u0440\u0445\u0438\u0432  <code>./config.cmd --url https://github.com/Lifailon/egapi --token XXXXXXXXXXXXXXXXXXXXXXXXXXXXX</code> \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0438 \u0441\u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0431\u043e\u0440\u0449\u0438\u043a\u0430 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0441\u043a\u0440\u0438\u043f\u0442\u0430 (\u0447\u0442\u043e \u0431\u044b \u043d\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c \u043f\u0443\u043d\u043a\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443 \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0431\u043e\u0440\u0449\u0438\u043a\u043e\u043c, \u043d\u0443\u0436\u043d\u043e \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043a\u043e\u043d\u0441\u043e\u043b\u044c \u0441 \u043f\u0440\u0430\u0432\u0430\u043c\u0438 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430)  <code>./run.cmd</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441 (\u0435\u0441\u043b\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u043b\u0443\u0436\u0431\u0430)  <code>Get-Service *actions* | Start-Service</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443  <code>Get-Process *Runner.Listener*</code> <code>./config.cmd remove --token XXXXXXXXXXXXXXXXXXXXXXXXXXXXX</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e</p>"},{"location":"DevOps/#build-pipeline","title":"Build (Pipeline)","text":"<pre><code>name: build-game-list\n\non:\n  # \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0440\u0443\u0447\u043d\u043e\u0439 \u0437\u0430\u043f\u0443\u0441\u043a workflow \u0447\u0435\u0440\u0435\u0437 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 GitHub\n  workflow_dispatch:\n\n  # \u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c workflow \u043f\u043e \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044e \u043a\u0430\u0436\u0434\u044b\u0439 \u0447\u0430\u0441 \u0432 00 \u043c\u0438\u043d\u0443\u0442\n  schedule:\n  - cron: '00 * * * *'\n\njobs:\n  Job_01:\n    # \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c, \u0447\u0442\u043e job \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c\u0441\u044f \u043d\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 Ubuntu\n    runs-on: ubuntu-latest\n\n    steps:\n    # \u0428\u0430\u0433\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u044d\u0442\u043e\u0433\u043e job\n    - name: Checkout repository\n      # \u041a\u043b\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439\n      uses: actions/checkout@v2\n\n    - name: Get content and write to file\n      # \u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u0441\u043a\u0440\u0438\u043f\u0442 PowerShell, \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0439 \u0432 ./scripts/Get-GameList.ps1\n      run: pwsh -File ./scripts/Get-GameList.ps1\n      # \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c, \u0447\u0442\u043e \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c\u0441\u044f \u0432 \u043e\u0431\u043e\u043b\u043e\u0447\u043a\u0435 bash\n      shell: bash \n\n    - name: Commit and push changes\n      run: |\n        # \u0417\u0430\u0434\u0430\u0435\u043c \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 email \u0434\u043b\u044f \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432\n        git config --global user.name 'GitHub Actions'\n        git config --global user.email 'actions@github.com'\n        # \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0432\u0441\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0438\u043d\u0434\u0435\u043a\u0441\n        git add .\n        # \u0414\u0435\u043b\u0430\u0435\u043c \u043a\u043e\u043c\u043c\u0438\u0442 \u0441 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0435\u043c\n        git commit -m \"update game list\"\n        # \u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c \u043a\u043e\u043c\u043c\u0438\u0442 \u0432 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439\n        git push\n</code></pre>"},{"location":"DevOps/#psappdeploytoolkit","title":"PSAppDeployToolkit","text":""},{"location":"DevOps/#install-deploytoolkit","title":"Install-DeployToolkit","text":"<pre><code>$githubRepository = \"psappdeploytoolkit/psappdeploytoolkit\"\n$filenamePatternMatch = \"PSAppDeployToolkit*.zip\"\n$psadtReleaseUri = \"https://api.github.com/repos/$githubRepository/releases/latest\"\n$psadtDownloadUri = ((Invoke-RestMethod -Method GET -Uri $psadtReleaseUri).assets | Where-Object name -like $filenamePatternMatch ).browser_download_url\n$zipExtractionPath = Join-Path $env:USERPROFILE \"Downloads\" \"PSAppDeployToolkit\"\n$zipTempDownloadPath = Join-Path -Path $([System.IO.Path]::GetTempPath()) -ChildPath $(Split-Path -Path $psadtDownloadUri -Leaf)\n### Download to a temporary folder\nInvoke-WebRequest -Uri $psadtDownloadUri -Out $zipTempDownloadPath\n### Remove any Zone.Identifier alternate data streams to unblock the file (if required)\nUnblock-File -Path $zipTempDownloadPath\nNew-Item -Type Directory $zipExtractionPath\nExpand-Archive -Path $zipTempDownloadPath -OutputPath $zipExtractionPath -Force\nWrite-Host (\"File: {0} extracted to Path: {1}\" -f $psadtDownloadUri, $zipExtractionPath) -ForegroundColor Yellow\nRemove-Item $zipTempDownloadPath\n</code></pre>"},{"location":"DevOps/#deploy-notepad-plus-plus","title":"Deploy-Notepad-Plus-Plus","text":"<p><code>$url_notepad = \"https://github.com/notepad-plus-plus/notepad-plus-plus/releases/download/v8.6.6/npp.8.6.6.Installer.x64.exe\"</code> <code>Invoke-RestMethod $url_notepad -OutFile \"$home\\Downloads\\PSAppDeployToolkit\\Toolkit\\Files\\npp.8.6.6.Installer.x64.exe\"</code></p> <pre><code>'# \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u043c\u043e\u0434\u0443\u043b\u044c PSAppDeployToolkit\nImport-Module \"$PSScriptRoot\\AppDeployToolkit\\AppDeployToolkitMain.ps1\"\n# \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\n$AppName = \"Notepad++\"\n# \u0412\u0435\u0440\u0441\u0438\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\n$AppVersion = \"8.6.6\"\n# \u041f\u0443\u0442\u044c \u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0449\u0438\u043a\u0443 Notepad++\n$InstallerPath = \"$PSScriptRoot\\Files\\npp.$AppVersion.Installer.x64.exe\"\n# \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043e\u0432\u0430\u043d\u0438\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0449\u0438\u043a\u0430\nIf (-not (Test-Path $InstallerPath)) {\n    Write-Host \"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0449\u0438\u043a Notepad++ \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d: $InstallerPath\"\n    Exit-Script -ExitCode 1\n}\n# \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 Notepad++\n$InstallerArguments = \"/S /D=$ProgramFiles\\Notepad++\"\nFunction Install-Application {\n    # \u0412\u044b\u0432\u043e\u0434\u0438\u043c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043e \u043d\u0430\u0447\u0430\u043b\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438\n    Show-InstallationWelcome -CloseApps \"iexplore\" -CheckDiskSpace -PersistPrompt\n    # \u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0443\n    Execute-Process -Path $InstallerPath -Parameters $InstallerArguments -WindowStyle Hidden -IgnoreExitCodes \"3010\"\n    # \u0412\u044b\u0432\u043e\u0434\u0438\u043c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043e\u0431 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0439 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0435\n    Show-InstallationPrompt -Message \"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 $AppName \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430.\" -ButtonRightText \"\u0417\u0430\u043a\u0440\u044b\u0442\u044c\" -Icon Information -NoWait\n    # \u0417\u0430\u0432\u0435\u0440\u0448\u0430\u0435\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438\n    Exit-Script -ExitCode $AppDependentExitCode\n}\nInstall-Application' | Out-File \"$home\\Downloads\\PSAppDeployToolkit\\Toolkit\\Deploy-Application.ps1\" -Encoding unicode\n</code></pre> <p><code>powershell -File \"$home\\Downloads\\PSAppDeployToolkit\\Toolkit\\Deploy-Application.ps1\"</code></p>"},{"location":"DevOps/#uninstall-notepad-plus-plus","title":"Uninstall-Notepad-Plus-Plus","text":"<pre><code>'Import-Module \"$PSScriptRoot\\AppDeployToolkit\\AppDeployToolkitMain.ps1\"\n$AppName = \"Notepad++\"\n$UninstallerPath = \"C:\\Program Files\\Notepad++\\uninstall.exe\"\nIf (-not (Test-Path $UninstallerPath)) {\n    Write-Host \"\u0414\u0435\u0438\u043d\u0441\u0442\u0430\u043b\u043b\u044f\u0442\u043e\u0440 Notepad++ \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d: $UninstallerPath\"\n    Exit-Script -ExitCode 1\n}\nFunction Uninstall-Application {\n    Show-InstallationWelcome -CloseApps \"iexplore\" -CheckDiskSpace -PersistPrompt\n    Execute-Process -Path $UninstallerPath -Parameters \"/S\" -WindowStyle Hidden -IgnoreExitCodes \"3010\"\n    Show-InstallationPrompt -Message \"\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430 $AppName \u0443\u0434\u0430\u043b\u0435\u043d\u0430.\" -ButtonRightText \"\u0417\u0430\u043a\u0440\u044b\u0442\u044c\" -Icon Information -NoWait\n    Exit-Script -ExitCode $AppDependentExitCode\n}\nUninstall-Application' | Out-File \"$home\\Downloads\\PSAppDeployToolkit\\Toolkit\\Deploy-Application.ps1\" -Encoding unicode\n</code></pre> <p><code>powershell -File \"$home\\Downloads\\PSAppDeployToolkit\\Toolkit\\Deploy-Application.ps1\"</code></p>"},{"location":"DevOps/#deploy-winscp","title":"Deploy-WinSCP","text":"<pre><code>$PSAppDeployToolkit = \"$home\\Downloads\\PSAppDeployToolkit\\\"\n$version = \"6.3.3\"\n$url_winscp = \"https://cdn.winscp.net/files/WinSCP-$version.msi?secure=P2HLWGKaMDigpDQw-H9BgA==,1716466173\"\n$WinSCP_Template = Get-Content \"$PSAppDeployToolkit\\Examples\\WinSCP\\Deploy-Application.ps1\" # \u0447\u0438\u0442\u0430\u0435\u043c \u043f\u0440\u0438\u043c\u0435\u0440 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0434\u043b\u044f WinSCP\n$WinSCP_Template_Latest = $WinSCP_Template -replace \"6.3.2\",\"$version\" # \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u043c \u0432\u0435\u0440\u0441\u0438\u044e \u043d\u0430 \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e\n$WinSCP_Template_Latest &gt; \"$PSAppDeployToolkit\\Toolkit\\Deploy-Application.ps1\" # \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u043c \u0441\u043a\u0440\u0438\u043f\u0442 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \nInvoke-RestMethod $url_winscp -OutFile \"$PSAppDeployToolkit\\Toolkit\\Files\\WinSCP-$version.msi\" # \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c msi-\u043f\u0430\u043a\u0435\u0442\npowershell -File \"$PSAppDeployToolkit\\Toolkit\\Deploy-Application.ps1\" # \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0443\n</code></pre>"},{"location":"DevOps/#pester","title":"Pester","text":"<p>Source</p> <p><code>Install-Module -Name Pester -Repository PSGallery -Force -AllowClobber</code> <code>Import-Module Pester</code> <code>$(Get-Module Pester -ListAvailable).Version</code></p> <p><code>.Tests.ps1</code></p> <pre><code>function Add-Numbers {\n    param (\n        [int]$a,\n        [int]$b\n    )\n    $a + $b\n}\nDescribe \"Add-Numbers\" {\n    Context \"\u041f\u0440\u0438 \u0441\u043b\u043e\u0436\u0435\u043d\u0438\u0438 \u0434\u0432\u0443\u0445 \u0447\u0438\u0441\u0435\u043b\" {\n        It \"\u0414\u043e\u043b\u0436\u043d\u0430 \u0432\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0430\u044f \u0441\u0443\u043c\u043c\u0430\" {\n            $result = Add-Numbers -a 3 -b 4\n            $result | Should -Be 7\n        }\n    }\n    Context \"\u041f\u0440\u0438 \u0441\u043b\u043e\u0436\u0435\u043d\u0438\u0438 \u0434\u0432\u0443\u0445 \u0447\u0438\u0441\u0435\u043b\" {\n        It \"\u0414\u043e\u043b\u0436\u043d\u0430 \u0432\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043e\u0448\u0438\u0431\u043a\u0430 (5+0 -ne 4)\" {\n            $result = Add-Numbers -a 5 -b 0\n            $result | Should -Be 4\n        }\n    }\n}\n\nfunction Get-RunningProcess {\n    return Get-Process | Select-Object -ExpandProperty Name\n}\nDescribe \"Get-RunningProcess\" {\n    Context \"\u041f\u0440\u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432\" {\n        It \"\u0414\u043e\u043b\u0436\u0435\u043d \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u043c\u0435\u043d \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432\" {\n            $result = Get-RunningProcess\n            $result | Should -Contain \"svchost\"\n            $result | Should -Contain \"explorer\"\n        }\n    }\n    Context \"\u041a\u043e\u0433\u0434\u0430 \u043d\u0435\u0442 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432\" {\n        It \"\u0414\u043e\u043b\u0436\u0435\u043d \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u043f\u0443\u0441\u0442\u043e\u0439 \u0441\u043f\u0438\u0441\u043e\u043a\" {\n            # \u0417\u0430\u043c\u043e\u043a\u0430\u0442\u044c \u0444\u0443\u043d\u043a\u0446\u0438\u044e Get-Process, \u0447\u0442\u043e\u0431\u044b \u043e\u043d\u0430 \u0432\u0441\u0435\u0433\u0434\u0430 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u043b\u0430 \u043f\u0443\u0441\u0442\u043e\u0439 \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432\n            Mock Get-Process { return @() }\n            $result = Get-RunningProcess\n            $result | Should -BeEmpty\n        }\n    }\n}\n</code></pre>"},{"location":"Docker/","title":"Docker","text":""},{"location":"Docker/#wsl","title":"WSL","text":"<p><code>wsl --list</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0434\u0438\u0441\u0442\u0440\u0438\u0431\u0443\u0442\u0438\u0432\u043e\u0432 Linux  <code>wsl --list --online</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0434\u0438\u0441\u0442\u0440\u0438\u0431\u0443\u0442\u0438\u0432\u043e\u0432  <code>wsl --install -d Ubuntu</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c Ubuntu \u0432 Windows Subsystem for Linux  <code>wsl --status</code> <code>wsl --exec \"htop\"</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0432 \u043f\u043e\u0434\u0441\u0438\u0441\u0442\u0435\u043c\u0435 Linux \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e  <code>wsl -e bash -c \"docker -v\"</code> <code>wsl -e bash -c \"systemctl status docker\"</code></p>"},{"location":"Docker/#install","title":"Install","text":"<p><code>apt update &amp;&amp; apt upgrade -y</code> <code>apt install docker.io</code> <code>systemctl status docker</code> <code>systemctl start docker</code> <code>systemctl enable docker</code> <code>iptables -t nat -N DOCKER</code> <code>docker -v</code> <code>docker -h</code> <code>curl https://registry-1.docker.io/v2/</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a Docker Hub  <code>curl -s -X POST -H \"Content-Type: application/json\" -d '{\"username\": \"lifailon\", \"password\": \"password\"}' https://hub.docker.com/v2/users/login | jq -r .token &gt; dockerToken.txt</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438  <code>sudo docker login</code> \u0432\u0445\u043e\u0434 \u0432 \u0440\u0435\u0435\u0441\u0442\u0440 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f hub.docker.com  <code>cat dockerToken.txt | sudo docker login --username lifailon --password-stdin</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0442\u043e\u043a\u0435\u043d \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 (https://hub.docker.com/settings/security) \u0438\u0437 \u0444\u0430\u0439\u043b\u0430 \u0447\u0435\u0440\u0435\u0437 stdin  <code>cat /root/.docker/config.json | jq -r .auths[].auth</code> \u043c\u0435\u0441\u0442\u043e \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0442\u043e\u043a\u0435\u043d\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435  <code>cat /root/.docker/config.json | python3 -m json.tool</code></p>"},{"location":"Docker/#mirror","title":"Mirror","text":"<p><code>echo '{\u00a0\"registry-mirrors\": [\"https://dockerhub.timeweb.cloud\"] }' &gt; \"/etc/docker/daemon.json\"</code> <code>echo '{\u00a0\"registry-mirrors\": [\"https://huecker.io\"] }' &gt; \"/etc/docker/daemon.json\"</code> <code>echo '{\u00a0\"registry-mirrors\": [\"https://mirror.gcr.io\"] }' &gt; \"/etc/docker/daemon.json\"</code> <code>echo '{\u00a0\"registry-mirrors\": [\"https://daocloud.io\"] }' &gt; \"/etc/docker/daemon.json\"</code> <code>echo '{\u00a0\"registry-mirrors\": [\"https://c.163.com\"] }' &gt; \"/etc/docker/daemon.json\"</code></p> <p><code>systemctl restart docker</code></p>"},{"location":"Docker/#proxy","title":"Proxy","text":"<pre><code>mkdir -p /etc/systemd/system/docker.service.d\n\n'[Service]\nEnvironment=\"HTTP_PROXY=http://docker:password@192.168.3.100:9090\"\nEnvironment=\"HTTPS_PROXY=http://docker:password@192.168.3.100:9090\"' &gt; /etc/systemd/system/docker.service.d/http-proxy.conf\n</code></pre> <p><code>systemctl daemon-reload</code> <code>systemctl restart docker</code></p>"},{"location":"Docker/#commands","title":"Commands","text":""},{"location":"Docker/#run","title":"Run","text":"<p>Commands: <code>search/pull/images/creat/start/ps/restart/pause/unpause/rename/stop/kill/rm/rmi</code></p> <p><code>docker search speedtest</code> \u043f\u043e\u0438\u0441\u043a \u043e\u0431\u0440\u0430\u0437\u0430 \u0432 \u0440\u0435\u0435\u0441\u0442\u0440\u0435  <code>docker pull adolfintel/speedtest</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0437 LibreSpeed \u0438\u0437 \u0440\u0435\u0435\u0441\u0442\u0440\u0430 Docker Hub (https://hub.docker.com/r/adolfintel/speedtest)  <code>docker images (docker image ls)</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0435 (\u0443\u0436\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0435) \u043e\u0431\u0440\u0430\u0437\u044b docker (image ls)  <code>docker images --format \"table {{.ID}}\\t{{.Repository}}\\t{{.Tag}}\"</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 (json-\u0444\u043e\u0440\u043c\u0430\u0442)  <code>docker create -it --name speedtest -p 8080:80 adolfintel/speedtest</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0438\u0437 \u043e\u0431\u0440\u0430\u0437\u0430 adolfintel/speedtest \u0441 \u0438\u043c\u0435\u043d\u0435\u043c speedtest \u0438 \u043f\u0440\u043e\u0431\u0440\u043e\u0441 80 \u043f\u043e\u0440\u0442\u0430 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u043d\u0430 8080 \u043f\u043e\u0440\u0442 \u0445\u043e\u0441\u0442\u0430  <code>docker start speedtest</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440  <code>ss -ltp | grep 8080</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u0447\u0442\u043e \u043f\u043e\u0440\u0442 \u043e\u0442\u043a\u0440\u044b\u0442  <code>docker ps</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0435 \u0434\u043e\u043a\u0435\u0440 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u044b  <code>docker ps -a</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 (\u0434\u043b\u044f \u0438\u0445 \u0437\u0430\u043f\u0443\u0441\u043a\u0430/\u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043f\u043e NAMES/ID \u0438 \u043a\u043e\u0434 \u0432\u044b\u0445\u043e\u0434\u0430 Exited 0 - \u0443\u0441\u043f\u0435\u0448\u043d\u0430\u044f \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430)  <code>docker ps -s</code> \u0440\u0430\u0437\u043c\u0435\u0440 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 (--size)  <code>docker restart speedtest</code> \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440  <code>docker pause speedtest</code> \u043f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440  <code>docker unpause uptime-kuma</code> \u0432\u043e\u0437\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0443 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430  <code>docker rename speedtest speedtest-2</code> \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0432\u0430\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 (docker rename old_name new_name)  <code>docker stop speedtest-2</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0441 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u043e\u0439 \u0433\u043b\u0430\u0432\u043d\u043e\u043c\u0443 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0443 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0441\u0438\u0433\u043d\u0430\u043b SIGTERM, \u0438 \u0447\u0435\u0440\u0435\u0437 \u0432\u0440\u0435\u043c\u044f SIGKILL  <code>docker kill uptime-kuma</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0441 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u043e\u0439 \u0433\u043b\u0430\u0432\u043d\u043e\u043c\u0443 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0443 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0441\u0438\u0433\u043d\u0430\u043b SIGKILL  <code>docker kill $(docker ps -q)</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0441\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u044b  <code>docker rm speedtest-2</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440  <code>docker rmi adolfintel/speedtest</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043e\u0431\u0440\u0430\u0437  <code>docker run -d --restart=unless-stopped --name openspeedtest -p 3000:3000 -p 3001:3001 openspeedtest/latest</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043e\u0431\u0440\u0430\u0437 OpenSpeedTest (https://hub.docker.com/r/openspeedtest/latest), \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0438 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0432 \u043e\u0434\u043d\u0443 \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0432 \u0444\u043e\u043d\u043e\u0432\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 (-d/--detach, \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430, \u0435\u0441\u043b\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f, \u043c\u043e\u0436\u043d\u043e \u0432\u0438\u0434\u0435\u0442\u044c \u043b\u043e\u0433\u0438, \u043d\u043e \u043f\u0440\u0438\u0434\u0435\u0442\u0441\u044f \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0434\u043b\u044f \u0432\u044b\u0445\u043e\u0434\u0430)  <code>docker rm openspeedtest &amp;&amp; docker rmi openspeedtest/latest</code> \u0443\u0434\u0430\u043b\u044f\u0435\u043c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0438 \u043e\u0431\u0440\u0430\u0437 \u0432 \u043e\u0434\u043d\u0443 \u043a\u043e\u043c\u0430\u043d\u0434\u0443  <code>docker run --name pg1 -p 5433:5432 -e POSTGRES_PASSWORD=PassWord -d postgres</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 postgres (https://hub.docker.com/_/postgres) \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 (-e)  <code>docker run -d --restart=always --name uptime-kuma -p 8080:3001 louislam/uptime-kuma:1</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 Uptime-Kuma (https://hub.docker.com/r/elestio/uptime-kuma) \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 always, \u043f\u0440\u0438 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438, \u0435\u0441\u043b\u0438 \u043e\u043d \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u0438\u043b\u0438 \u0435\u0441\u043b\u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0441\u044f Docker (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0445\u043e\u0441\u0442\u0430)</p>"},{"location":"Docker/#update","title":"Update","text":"<p><code>docker update --restart unless-stopped uptime-kuma</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0435\u0436\u0438\u043c \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u043f\u043e\u0441\u043b\u0435 \u0435\u0433\u043e \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043d\u0430 unless-stopped (\u0440\u0435\u0436\u0438\u043c \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u0435\u043d always, \u043d\u043e \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0449\u0435\u043d, \u0435\u0441\u043b\u0438 \u043e\u043d \u0431\u044b\u043b \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e docker stop)  <code>docker update --restart on-failure uptime-kuma</code> \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0449\u0435\u043d \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0435\u0433\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439, \u043a\u043e\u0433\u0434\u0430 \u043a\u043e\u0434 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u043e\u0442\u043b\u0438\u0447\u0430\u0435\u0442\u0441\u044f \u043e\u0442 0, \u0447\u0435\u0440\u0435\u0437 \u0434\u0432\u043e\u0435\u0442\u043e\u0447\u0438\u0435 \u043c\u043e\u0436\u043d\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u043f\u044b\u0442\u043e\u043a \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, on-failure:3)  <code>docker update --cpu-shares 512 --memory 500M uptime-kuma</code> \u0437\u0430\u0434\u0430\u0442\u044c \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f \u043f\u043e CPU, \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0431\u0443\u0434\u0435\u0442 \u0438\u043c\u0435\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0434\u043e\u043b\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043d\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0432 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d\u0435 \u043e\u0442 2 \u0434\u043e 262,144 (2^18) \u0438\u043b\u0438 --cpus (\u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043e\u0432), --memory/--memory-swap \u0438 --blkio-weight \u0434\u043b\u044f IOps (\u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0432\u0435\u0441 \u043e\u0442 10 \u0434\u043e 1000)</p>"},{"location":"Docker/#stats","title":"Stats","text":"<p><code>docker stats</code> \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u043f\u043e\u0442\u0440\u0435\u0431\u043b\u044f\u0435\u043c\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u043c\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430\u043c\u0438 (top)  <code>docker stats --no-stream --format json</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 json</p>"},{"location":"Docker/#logs","title":"Logs","text":"<p><code>docker logs uptime-kuma --tail 100</code> \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043b\u043e\u0433\u0438 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0432 \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b\u0435 (\u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 100 \u0441\u0442\u0440\u043e\u043a)  <code>docker system events</code> \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0442 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u043e\u0442 \u0434\u0435\u043c\u043e\u043d\u0430 dockerd \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438  <code>journalctl -xeu docker.service</code> <code>docker system df</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u0432\u043e\u0434\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u0437\u0430\u043d\u044f\u0442\u043e\u0433\u043e \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0430 \u043e\u0431\u0440\u0430\u0437\u0430\u043c\u0438 \u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430\u043c\u0438  <code>du -h --max-depth=1 /var/lib/docker</code> <code>du -h --max-depth=2 /var/lib/docker/containers</code></p>"},{"location":"Docker/#volume","title":"Volume","text":"<p><code>docker volume ls</code> \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0442\u043e\u043c\u043e\u0432 \u0438 \u043c\u0435\u0441\u0442\u043e \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f (\u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u044b \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u044b\u043c\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u043d\u0430 \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044e\u0442\u0441\u044f \u043c\u0435\u0436\u0434\u0443 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u043c\u0438 \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f\u043c\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432)  <code>docker volume inspect uptime-kuma</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0442\u043e\u043c\u0430 (\u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0443\u0442\u044c \u043a \u0434\u0430\u043d\u043d\u044b\u043c \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435, Mountpoint: /var/lib/docker/volumes/uptime-kuma/_data)  <code>docker volume create test</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0442\u043e\u043c  <code>docker volume rm test</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u043e\u043c  <code>docker run -d --restart=always --name uptime-kuma -p 8080:3001 -v uptime-kuma:/app/data louislam/uptime-kuma:1</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c \u0442\u043e\u043c\u0435 (\u0442\u043e\u043c \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438, \u0432 \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0435\u043c \u0435\u0433\u043e \u043c\u043e\u0436\u043d\u043e \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430, \u0435\u0441\u043b\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0442\u044c \u0438\u0437 \u043d\u0435\u0433\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435)</p>"},{"location":"Docker/#network","title":"Network","text":"<p><code>docker network ls</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0442\u0435\u0439  <code>docker network inspect bridge</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0435\u0442\u0438 bridge  <code>docker inspect uptime-kuma | jq .[].NetworkSettings.Networks</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430  <code>docker run -d --name uptime-kuma --network host nginx louislam/uptime-kuma:1</code> \u0437\u0430\u043f\u0443\u0441\u043a \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c host \u0441\u0435\u0442\u0438, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0443 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u0442\u044c \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b  <code>docker network create network_test</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0441\u0435\u0442\u044c  <code>docker network connect network_test uptime-kuma</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043a \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0441\u0435\u0442\u0438  <code>docker network disconnect network_test uptime-kuma</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043e\u0442 \u0441\u0435\u0442\u0438</p>"},{"location":"Docker/#inspect","title":"Inspect","text":"<p><code>docker inspect uptime-kuma</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f NetworkSettings)  <code>docker inspect uptime-kuma --format='{{.LogPath}}'</code> \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c, \u0433\u0434\u0435 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u043b\u043e\u0433\u0438 \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435  <code>docker inspect uptime-kuma | grep LogPath</code> <code>docker inspect $(docker ps -q) --format='{{.NetworkSettings.Ports}}'</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c TCP \u043f\u043e\u0440\u0442\u044b \u0432\u0441\u0435\u0445 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432  <code>docker inspect $(docker ps -q) --format='{{.NetworkSettings.Ports}}' | grep -Po \"[0-9]+(?=}])\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u043e\u0440\u0442\u044b \u0445\u043e\u0441\u0442\u0430 (\u0432\u043d\u0435\u0448\u043d\u0438\u0435)  <code>docker port uptime-kuma</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u0440\u043e\u0448\u0435\u043d\u043d\u044b\u0435 \u043f\u043e\u0440\u0442\u044b \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430  <code>for ps in $(docker ps -q); do docker port $ps | sed -n 2p | awk -F \":\" '{print $NF}'; done</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u043d\u0435\u0448\u043d\u0438\u0435 \u043f\u043e\u0440\u0442\u044b \u0432\u0441\u0435\u0445 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432  <code>id=$(docker inspect uptime-kuma | jq -r .[].Id)</code> \u0443\u0437\u043d\u0430\u0442\u044c ID \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u043f\u043e \u0435\u0433\u043e \u0438\u043c\u0435\u043d\u0438 \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438  <code>cat /var/lib/docker/containers/$id/config.v2.json | jq .</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430</p>"},{"location":"Docker/#exec","title":"Exec","text":"<p><code>docker exec -it uptime-kuma /bin/bash</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0435\u043c\u0443 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0443 (\u043f\u0440\u0438 \u0432\u044b\u0445\u043e\u0434\u0435 \u0438\u0437 \u043e\u0431\u043e\u043b\u043e\u0447\u043a\u0438, \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c), \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0438\u043d\u0442\u0435\u0440\u043f\u0440\u0438\u0442\u0430\u0442\u043e\u0440 bash  <code>docker top uptime-kuma</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430  <code>docker exec -it --user root uptime-kuma bash apt-get install -y procps</code> \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043f\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c root \u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c procps  <code>docker exec -it uptime-kuma ps -aux</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430  <code>docker exec uptime-kuma kill -9 25055</code> \u0443\u0431\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430  <code>docker exec -it uptime-kuma ping 8.8.8.8</code> <code>docker exec -it uptime-kuma pwd</code> <code>docker cp ./Console-Performance.sh uptime-kuma:/app</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u0437 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440  <code>docker exec -it uptime-kuma ls</code> <code>docker cp uptime-kuma:/app/db/ backup/db</code> \u0441\u043e\u043a\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u0437 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443  <code>ls backup/db</code></p>"},{"location":"Docker/#prune","title":"Prune","text":"<p><code>docker network prune &amp;&amp; docker image prune &amp;&amp; docker volume prune &amp;&amp; docker container prune</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u043d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0441\u0435\u0442\u0438, \u0432\u0438\u0441\u044f\u0449\u0438\u0435 \u043e\u0431\u0440\u0430\u0437\u0430, \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u044b, \u0432\u0441\u0435 \u043d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0442\u043e\u043c\u0430  <code>system prune \u2013volumes</code> \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0432\u0441\u0435 \u0447\u0435\u0442\u044b\u0440\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0434\u043b\u044f \u043e\u0447\u0438\u0441\u0442\u043a\u0438 \u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u0447\u0438\u0449\u0430\u0435\u0442 \u043a\u0435\u0448 \u0441\u0431\u043e\u0440\u043a\u0438</p>"},{"location":"Docker/#remove","title":"Remove","text":"<p><code>systemctl stop docker.service</code> <code>systemctl stop docker.socket</code> <code>pkill -f docker</code> <code>pkill -f containerd</code> <code>apt purge docker.io -y || dpkg --purge docker.io</code> <code>dpkg -l | grep docker</code> <code>rm -rf /var/lib/docker</code> <code>rm -rf /run/docker</code> <code>rm -rf /run/docker.sock</code></p>"},{"location":"Docker/#api","title":"API","text":""},{"location":"Docker/#docker-socket-api","title":"Docker Socket API","text":"<p><code>curl --silent -XGET --unix-socket /run/docker.sock http://localhost/version | jq .</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u043e\u043a\u0435\u0442 (/run/docker.sock) \u0434\u043b\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441 Docker daemon \u0447\u0435\u0440\u0435\u0437 \u0435\u0433\u043e API  <code>curl --silent -XGET --unix-socket /run/docker.sock http://localhost/info | jq .</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0431\u0440\u0430\u0437\u043e\u0432, \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 \u0438 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u041e\u0421  <code>curl --silent -XGET --unix-socket /run/docker.sock http://localhost/events</code> \u043b\u043e\u0433\u0438 Docker daemon  <code>curl --silent -XGET --unix-socket /run/docker.sock -H \"Content-Type: application/json\" http://localhost/containers/json | jq .</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0445 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 \u0438 \u0438\u0445 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438  <code>curl --silent -XGET --unix-socket /run/docker.sock http://localhost/containers/uptime-kuma/json | jq .</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0435 \u0441\u0432\u0435\u0434\u0435\u043d\u0438\u044f (\u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f) \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430  <code>curl --silent -XPOST --unix-socket /run/docker.sock -d \"{\"Image\":\"nginx:latest\"}\" http://localhost/containers/create?name=nginx</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u0432 \u0442\u0435\u043b\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 (\u0434\u043e\u043b\u0436\u0435\u043d \u0443\u0436\u0435 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0437)  <code>curl --silent -XPOST --unix-socket /run/docker.sock http://localhost/containers/17fab06a820debf452fe685d1522a9dd1611daa3a5087ff006c2dabbe25e52a1/start</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043f\u043e Id  <code>curl --silent -XPOST --unix-socket /run/docker.sock http://localhost/containers/17fab06a820debf452fe685d1522a9dd1611daa3a5087ff006c2dabbe25e52a1/stop</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440  <code>curl --silent -XDELETE --unix-socket /run/docker.sock http://localhost/containers/17fab06a820debf452fe685d1522a9dd1611daa3a5087ff006c2dabbe25e52a1</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440</p>"},{"location":"Docker/#docker-tcp-api","title":"Docker TCP API","text":"<pre><code>echo '{\n    \"hosts\": [\"tcp://0.0.0.0:2375\", \"unix:///var/run/docker.sock\"]\n}' &gt; \"/etc/docker/daemon.json\"\nservice=$(cat /lib/systemd/system/docker.service | sed \"s/ -H fd:\\/\\///\")\nprintf \"%s\\n\" \"$service\" &gt; /lib/systemd/system/docker.service\nsystemctl daemon-reload\nsystemctl restart docker\n</code></pre> <p>curl --silent -XGET http://192.168.3.102:2375/version | jq .</p>"},{"location":"Docker/#context","title":"Context","text":"<p><code>docker context create devops-01 --docker \"host=tcp://192.168.3.101:2375\"</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c\u0443 \u0441\u043e\u043a\u0435\u0442\u0443 <code>docker context ls</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043e\u0432 <code>docker context inspect devops-01</code> \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 <code>docker context use devops-01</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e (\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043d\u0430 \u043f\u0440\u044f\u043c\u0443\u044e \u0432\u0437\u0430\u0438\u043c\u043e\u0441\u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0441 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u043c Docker Engine \u0447\u0435\u0440\u0435\u0437 cli) <code>docker context rm devops-01</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442</p>"},{"location":"Docker/#ctop","title":"ctop","text":"<p><code>scoop install ctop</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0432 Windows</p> <pre><code>wget https://github.com/bcicen/ctop/releases/download/v0.7.7/ctop-0.7.7-linux-amd64 -O /usr/local/bin/ctop\nchmod +x /usr/local/bin/ctop\n</code></pre> <p><code>ctop</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u0432\u043e\u0434\u043d\u0443\u044e \u0442\u0430\u0431\u043b\u0438\u0446\u0443 (top) CPU, MEM, NET RX/TX, IO R/W  <code>o</code> - \u0433\u0440\u0430\u0444\u0438\u043a\u0438  <code>l</code> - \u043b\u043e\u0433\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438  <code>s</code> - stop/start  <code>R</code> - remove \u043f\u043e\u0441\u043b\u0435 stop  <code>p</code> - pause/unpause  <code>r</code> - restart  <code>e</code> - exec shell</p>"},{"location":"Docker/#lazydocker","title":"LazyDocker","text":"<p><code>scoop install lazydocker || choco install lazydocker</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0432 Windows (https://github.com/jesseduffield/lazydocker)</p> <pre><code>wget https://github.com/jesseduffield/lazydocker/releases/download/v0.23.1/lazydocker_0.23.1_Linux_x86.tar.gz -O ~/lazydocker.tar.gz\ntar -xzf ~/lazydocker.tar.gz lazydocker\nrm ~/lazydocker.tar.gz\nmv lazydocker /usr/local/bin/lazydocker\nchmod +x /usr/local/bin/lazydocker\n</code></pre> <p>lazydocker</p>"},{"location":"Docker/#dockerfile","title":"Dockerfile","text":"<p><code>git clone https://github.com/Lifailon/TorAPI</code> <code>cd TorAPI</code> <code>nano Dockerfile</code></p> <pre><code># \u0423\u043a\u0430\u0437\u0430\u0442\u044c \u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u043e\u0431\u0440\u0430\u0437, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044e\u044e \u0432\u0435\u0440\u0441\u0438\u044e Node.js \u0438 npm \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430\nFROM node:latest\n# \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0447\u0443\u044e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u0434\u043b\u044f \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 (\u0432\u0441\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0431\u0443\u0434\u0443\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c\u0441\u044f \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u044d\u0442\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438)\nWORKDIR /torapi\n# \u041a\u043e\u043f\u0438\u0440\u0443\u0435\u0442 \u0444\u0430\u0439\u043b package.json \u0438\u0437 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u043d\u0430 \u0445\u043e\u0441\u0442\u0435 \u0432 \u0440\u0430\u0431\u043e\u0447\u0443\u044e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430\nCOPY package.json ./\n# \u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u0443 (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043e\u0431\u043e\u043b\u043e\u0447\u043a\u0443 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e) \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 package.json\nRUN npm install\n# \u041a\u043e\u043f\u0438\u0440\u0443\u0435\u0442 \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u043d\u0430 \u0445\u043e\u0441\u0442\u0435 \u0432 \u0440\u0430\u0431\u043e\u0447\u0443\u044e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430\nCOPY . .\n# \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e\nENV PORT=8443\n# \u041e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u043f\u043e\u0440\u0442 8443 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044e \u0438\u0437 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430\nEXPOSE $PORT\n# \u0423\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0434\u043b\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043f\u0440\u0438 \u0441\u0442\u0430\u0440\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e npm start\nCMD [\"npm\", \"start\"]\n</code></pre> <p><code>docker build -t torapi .</code> \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0437 \u0438\u0437 dockerfile  <code>docker run -d --name TorAPI -p 8443:8443 torapi</code></p>"},{"location":"Docker/#push","title":"Push","text":"<p><code>docker login</code> <code>git clone https://github.com/Lifailon/TorAPI</code> <code>cd TorAPI</code> <code>docker build -t lifailon/torapi .</code> \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0437 \u0434\u043b\u044f \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u043d\u0430 Docker Hub  <code>docker push lifailon/torapi</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043e\u0431\u0440\u0430\u0437 \u043d\u0430 Docker Hub</p> <p><code>docker pull lifailon/torapi:latest</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043e\u0431\u0440\u0430\u0437 \u0438\u0437 Docker Hub  <code>docker run -d --name TorAPI -p 8443:8443 lifailon/torapi:latest</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043e\u0431\u0440\u0430\u0437 \u0438 \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440</p>"},{"location":"Docker/#docker-compose","title":"Docker-Compose","text":"<pre><code>curl -L \"https://github.com/docker/compose/releases/download/1.27.0/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\nchmod +x /usr/local/bin/docker-compose\ndocker-compose --version\n</code></pre> <p><code>nano docker-compose.yml</code></p> <pre><code>version: \"3.8\"\nservices:\n  torapi:\n    image: lifailon/torapi:latest\n    container_name: TorAPI\n    volumes:\n      - torapi:/rotapi\n    ports:\n      - \"8443:8443\"\n    restart: unless-stopped\nvolumes:\n  torapi:\n</code></pre> <p><code>docker-compose up -d</code> \u043f\u0440\u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u043c \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0441\u0442 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0441 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f\u043c\u0438</p>"},{"location":"Docker/#uptime-kuma","title":"Uptime-Kuma","text":"<p><code>nano docker-compose.yml</code></p> <pre><code>version: \"3.8\"\nservices:\n  uptime-kuma:\n    image: louislam/uptime-kuma:1\n    container_name: uptime-kuma\n    volumes:\n      - uptime-kuma:/app/data\n    ports:\n      - \"8080:3001\"\n    restart: unless-stopped\nvolumes:\n  uptime-kuma:\n</code></pre> <p><code>docker-compose up -d</code></p>"},{"location":"Docker/#uptime-kuma-api","title":"Uptime-Kuma-Api","text":"<p><code>nano docker-compose.yml</code></p> <pre><code>version: \"3.9\"\nservices:\n  kuma:\n    container_name: uptime-kuma-frontend\n    image: louislam/uptime-kuma:latest\n    ports:\n      - \"8080:3001\"\n    restart: unless-stopped\n    volumes:\n      - uptime-kuma:/app/data\n  api:\n    container_name: uptime-kuma-backend-api\n    image: medaziz11/uptimekuma_restapi\n    volumes:\n      - api:/db\n    restart: unless-stopped\n    environment:\n      - KUMA_SERVER=http://kuma:3001\n      - KUMA_USERNAME=admin\n      - KUMA_PASSWORD=KumaAdmin\n      - ADMIN_PASSWORD=KumaApiAdmin\n    depends_on:\n      - kuma\n    ports:\n      - \"8081:8000\"\nvolumes:\n  uptime-kuma:\n  api:\n</code></pre> <p><code>docker-compose up -d</code></p> <p>OpenAPI doc: http://192.168.3.102:8081/docs  <code>TOKEN=$(curl -s -X POST http://192.168.3.102:8081/login/access-token --data \"username=admin\" --data \"password=KumaApiAdmin\" | jq -r .access_token)</code> <code>curl -s -X GET -H \"Authorization: Bearer ${TOKEN}\" http://127.0.0.1:8081/monitors | jq .</code> <code>curl -s -X GET -H \"Authorization: Bearer ${TOKEN}\" http://127.0.0.1:8081/monitors/1 | jq '.monitor | \"\\(.name) - \\(.active)\"'</code></p>"},{"location":"Docker/#swarm","title":"Swarm","text":"<p><code>docker swarm init</code> \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c manager node \u0438 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u043e\u043a\u0435\u043d \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f worker node (\u0441\u0435\u0440\u0432\u0435\u0440)  <code>docker swarm join-token manager</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0442\u043e\u043a\u0435\u043d \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f  <code>docker swarm join --token SWMTKN-1-1a078rm7vuenefp6me84t4swqtvdoveu6dh2pw34xjcf2gyw33-81f8r32jt3kkpk4dqnt0oort9 192.168.3.101:2377</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 worker node (\u043a\u043b\u0438\u0435\u043d\u0442)  <code>docker node ls</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a node \u043d\u0430 manager node  <code>docker node inspect u4u897mxb1oo39pbj5oezd3um</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f (\u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f) \u043e node \u043f\u043e id  <code>docker swarm leave --force</code> \u0432\u044b\u0439\u0442\u0438 \u0438\u0437 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043d\u0430 worker node (\u043d\u0430 manager node \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u0441\u044f \u0441\u0442\u0430\u0442\u0443\u0441 \u0441 Ready \u043d\u0430 Down)  <code>docker node rm u4u897mxb1oo39pbj5oezd3um</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c node (\u0441\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u043c Down) \u043d\u0430 manager node  <code>docker pull lifailon/torapi:latest</code> <code>nano docker-compose-stack.yml</code></p> <pre><code>version: \"3.8\"\nservices:\n  torapi:\n    image: lifailon/torapi:latest\n    deploy:\n      replicas: 2\n      restart_policy:\n        condition: on-failure\n      update_config:\n        order: start-first\n      # \u0420\u0435\u0436\u0438\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e IP \u0434\u043b\u044f \u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u043a\u0438 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438\n      endpoint_mode: vip\n    volumes:\n      - torapi:/rotapi\n    ports:\n      # \u041f\u043e\u0440\u0442 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430\n      - target: 8443\n        published: 8443\n        protocol: tcp\n        # \u0420\u0435\u0436\u0438\u043c \u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u043a\u0438 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e\n        mode: ingress\nvolumes:\n  torapi:\n</code></pre> <p><code>docker stack deploy -c docker-compose-stack.yml TorAPI</code> \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u0441\u0442\u044d\u043a \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432, \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 \u0432 docker-compose (\u043d\u0430 worker node \u043f\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 TorAPI_torapi.1.ug5ngdlqkl76dt)  <code>docker stack ls</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0442\u044d\u043a\u043e\u0432  <code>docker service ls</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 \u0432\u0441\u0435\u0445 \u0441\u0442\u044d\u043a\u043e\u0432  <code>docker stack ps TorAPI</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u0434\u0430\u0447 \u0432 \u0441\u0442\u0435\u043a\u0435  <code>docker stack services TorAPI</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 \u0432\u043d\u0443\u0442\u0440\u0438 \u0441\u0442\u044d\u043a\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0442\u044d\u043a\u0430 \u043f\u043e \u0438\u043c\u0435\u043d\u0438  <code>docker service ps TorAPI_torapi</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0435 \u043f\u043e \u0435\u0433\u043e \u0438\u043c\u0435\u043d\u0438 (TorAPI \u0438\u043c\u044f \u0441\u0442\u044d\u043a\u0430 \u0438 _torapi \u0438\u043c\u044f \u0441\u0435\u0440\u0432\u0438\u0441\u0430)  <code>docker service inspect --pretty TorAPI_torapi</code> \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0440\u0432\u0438\u0441\u0430  <code>docker service inspect TorAPI_torapi</code> \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0440\u0432\u0438\u0441\u0430 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 JSON  <code>docker service logs TorAPI_torapi</code> \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0430 \u043f\u043e \u0432\u0441\u0435\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430  <code>docker service scale TorAPI_torapi=3</code> \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u0442 \u0441\u0435\u0440\u0432\u0438\u0441 \u0434\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0447\u0438\u0441\u043b\u0430 \u0440\u0435\u043f\u043b\u0438\u043a  <code>docker stack rm TorAPI</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0442\u044d\u043a (\u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432)</p>"},{"location":"Docker/#dozzle","title":"Dozzle","text":"<p><code>docker run -d --name dozzle -v /var/run/docker.sock:/var/run/docker.sock -p 9999:8080 amir20/dozzle:latest</code> <code>docker run -d --name dozzle -v /var/run/docker.sock:/var/run/docker.sock -p 9999:8080 amir20/dozzle:latest --remote-host tcp://192.168.3.102:2375|mon-01</code> \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c\u0443 \u0445\u043e\u0441\u0442\u0443 \u0447\u0435\u0440\u0435\u0437 Docker-tcp-api  http://192.168.3.102:9999</p>"},{"location":"Docker/#dozzle-auth","title":"Dozzle-Auth","text":"<p><code>echo -n DozzleAdmin | shasum -a 256</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 sha-256  <code>mkdir dozzle &amp;&amp; nano ./dozzle/users.yml</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b</p> <pre><code>users:\n  admin:\n    name: \"admin\"\n    password: \"a800c3ee4dac5102ed13ba673589077cf0a87a7ddaff59882bb3c08f275a516e\"\n</code></pre> <p><code>nano docker-compose.yml</code></p> <pre><code>version: \"3.8\"\nservices:\n  dozzle:\n    image: amir20/dozzle:latest\n    container_name: dozzle\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - ./dozzle:/data\n    ports:\n      - 9999:8080\n    environment:\n      DOZZLE_AUTH_PROVIDER: simple\n      DOZZLE_HOSTNAME: dozzle\n      DOZZLE_REMOTE_HOST: tcp://192.168.3.102:2375|mon-01\n</code></pre> <p><code>docker-compose up -d</code></p>"},{"location":"Docker/#portainer","title":"Portainer","text":"<p><code>curl -L https://downloads.portainer.io/portainer-agent-stack.yml -o portainer-agent-stack.yml</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c yaml \u0444\u0430\u0439\u043b  <code>version_update=$(cat portainer-agent-stack.yml | sed \"s/2.11.1/latest/g\")</code> <code>printf \"%s\\n\" \"$version_update\" &gt; portainer-agent-stack.yml</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0435\u0440\u0441\u0438\u044e \u0432 yaml \u0444\u0430\u0439\u043b\u0435 \u043d\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044e\u044e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0443\u044e \u0432 Docker Hub (2.19.5)  <code>docker stack deploy -c portainer-agent-stack.yml portainer</code> \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 swarm (\u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u043c node \u0431\u0443\u0434\u0435\u0442 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u0430\u0433\u0435\u043d\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u0443\u0434\u0435\u0442 \u0441\u043e\u0431\u0438\u0440\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435, \u0430 \u043d\u0430 manager \u0431\u0443\u0434\u0435\u0442 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u0441\u0435\u0440\u0432\u0435\u0440 \u0441 web \u043f\u0430\u043d\u0435\u043b\u044c\u044e)  https://192.168.3.101:9443</p> <p><code>docker run -d --name portainer_agent -p 9001:9001 --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v /var/lib/docker/volumes:/var/lib/docker/volumes portainer/agent:2.19.5</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0433\u0435\u043d\u0442 \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u0445\u043e\u0441\u0442  https://192.168.3.101:9443/#!/endpoints \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u0445\u043e\u0441\u0442 \u043f\u043e URL 192.168.3.102:9001</p> <p><code>docker volume create portainer_data</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c volume \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 (\u043d\u0435 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440 swarm)  <code>docker create -it --name=portainer -p 9000:9000 --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440  <code>docker start portainer</code>  http://192.168.3.101:9000</p>"},{"location":"Docker/#dockerdotnet","title":"Docker.DotNet","text":"<pre><code># \u0418\u043c\u043f\u043e\u0440\u0442 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 Docker.DotNet (https://nuget.info/packages/Docker.DotNet/3.125.15)\nAdd-Type -Path \"$home\\Documents\\Docker.DotNet-3.125.15\\lib\\netstandard2.1\\Docker.DotNet.dll\"\n# \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u0430\u0434\u0440\u0435\u0441 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 Docker, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0441\u043b\u0443\u0448\u0430\u0435\u0442 \u0441\u043e\u043a\u0435\u0442 Docker API\n$config = [Docker.DotNet.DockerClientConfiguration]::new(\"http://192.168.3.102:2375\")\n# \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u0441\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c\n$client = $config.CreateClient()\n# \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043c\u0435\u0442\u043e\u0434\u043e\u0432 \u043a\u043b\u0430\u0441\u0441\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0430\n$client | Get-Member\n# \u0412\u044b\u0432\u043e\u0434\u0438\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432\n$containers = $client.Containers.ListContainersAsync([Docker.DotNet.Models.ContainersListParameters]::new()).GetAwaiter().GetResult()\n# \u0417\u0430\u0431\u0438\u0440\u0430\u0435\u043c id \u043f\u043e \u0438\u043c\u0435\u043d\u0438\n$kuma_id = $($containers | Where-Object names -match \"uptime-kuma-front\").id\n# \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 \u043c\u0435\u0442\u043e\u0434\u043e\u0432\n$client.Containers | Get-Member\n# \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043f\u043e \u0435\u0433\u043e id\n$StopParameters = [Docker.DotNet.Models.ContainerStopParameters]::new()\n$client.Containers.StopContainerAsync($kuma_id, $StopParameters)\n# \u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\n$StartParameters = [Docker.DotNet.Models.ContainerStartParameters]::new()\n$client.Containers.StartContainerAsync($kuma_id, $StartParameters)\n</code></pre>"},{"location":"Exchange/","title":"Microsoft Exchange","text":""},{"location":"Exchange/#connect","title":"Connect","text":"<p><code>$srv_cas = \"exchange-cas\"</code> <code>$session_exchange = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://$srv_cas/PowerShell/</code> -Credential $Cred -Authentication Kerberos  <code>Get-PSSession</code> <code>Import-PSSession $session_exchange -DisableNameChecking</code> \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0441\u0435\u0441\u0441\u0438\u044e</p>"},{"location":"Exchange/#settings","title":"Settings","text":"<p><code>Get-ExchangeServer | select name,serverrole,admindisplayversion,Edition,OriginatingServer,WhenCreated,WhenChanged,DataPath | ft</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 <code>Get-ImapSettings</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 IMAP  <code>Get-ExchangeCertificate</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432  <code>Get-ExchangeCertificate -Thumbprint \"5CEC8544D4743BC279E5FEA1679F79F5BD0C2B3A\" | Enable-ExchangeCertificate -Services  IMAP, POP, IIS, SMTP</code> <code>iisreset</code> <code>Get-ClientAccessService | fl identity, *uri*</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441\u043b\u0443\u0436\u0431\u044b \u0430\u0432\u0442\u043e\u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u0432 Exchange 2016  <code>Get-ClientAccessService -Identity $srv | Set-ClientAccessService -AutoDiscoverServiceInternalUri https://mail.domain.ru/Autodiscover/Autodiscover.xml</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430 \u0432\u043d\u0435\u0448\u043d\u0438\u0439 \u0430\u0434\u0440\u0435\u0441  <code>Get-OutlookAnywhere</code> OA \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0430\u043c Outlook \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c\u0441\u044f \u043a \u0441\u0432\u043e\u0438\u043c \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u043c \u044f\u0449\u0438\u043a\u0430\u043c \u0437\u0430 \u043f\u0440\u0435\u0434\u0435\u043b\u0430\u043c\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438 (\u0431\u0435\u0437 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f VPN)  <code>Get-WebServicesVirtualDirectory</code> <code>Get-OwaVirtualDirectory</code> <code>Get-ActiveSyncVirtualDirectory</code> <code>Get-OabVirtualDirectory</code> \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0430\u0432\u0442\u043e\u043d\u043e\u043c\u043d\u043e\u0439 \u0430\u0434\u0440\u0435\u0441\u043d\u043e\u0439 \u043a\u043d\u0438\u0433\u0438  <code>Get-OabVirtualDirectory -Server $srv | Set-OabVirtualDirectory -InternalUrl \"https://mail.domain.ru/OAB\" -ExternalUrl \"https://mail.domain.ru/OAB\"</code></p>"},{"location":"Exchange/#roles","title":"Roles","text":"<p>MS (Mailbox) - \u0441\u0435\u0440\u0432\u0435\u0440 \u0441 \u0411\u0414 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0445 \u044f\u0449\u0438\u043a\u043e\u0432 \u0438 \u043e\u0431\u0449\u0438\u0445 \u043f\u0430\u043f\u043e\u043a, \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0437\u0430 \u0438\u0445 \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u0438 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u044e \u043d\u0438\u043a\u0430\u043a\u0438\u0445 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439.  CAS (Client Access Server) - \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0445 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043a \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u043c \u044f\u0449\u0438\u043a\u0430\u043c, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u043e\u0437\u0434\u0430\u044e\u0442\u0441\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u0430\u043c\u0438 Outlook Web Access (HTTP \u0434\u043b\u044f Outlook Web App), Outlook Anywhere, ActiveSync (\u0434\u043b\u044f \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u044b\u0445 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432), \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442 \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u044b POP3 \u0438 IMAP4, MAPI \u0434\u043b\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432 Microsoft Outlook.  Hub Transort - \u043e\u0442\u0432\u0435\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u044e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0430 \u0438 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043e\u0439 Exchange, \u0430 \u0442\u0430\u043a\u0436\u0435 \u043c\u0435\u0436\u0434\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c\u0438 Exchange. \u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0432\u0441\u0435\u0433\u0434\u0430 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0440\u043e\u043b\u0438 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430-\u043a\u043e\u043d\u0446\u0435\u043d\u0442\u0440\u0430\u0442\u043e\u0440\u0430, \u0434\u0430\u0436\u0435 \u0435\u0441\u043b\u0438 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0435 \u044f\u0449\u0438\u043a\u0438 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 \u0438 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043d\u0430\u0445\u043e\u0434\u044f\u0442\u0441\u044f \u0432 \u043e\u0434\u043d\u043e\u0439 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0445 \u044f\u0449\u0438\u043a\u043e\u0432.  Relay - \u0440\u043e\u043b\u044c \u043f\u043e\u0433\u0440\u0430\u043d\u0438\u0447\u043d\u043e\u0433\u043e \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 (\u0448\u043b\u044e\u0437 SMTP \u0432 \u043f\u0435\u0440\u0438\u043c\u0435\u0442\u0440\u0435 \u0441\u0435\u0442\u0438).</p> <p>SCP (Service Connection Point) - \u0437\u0430\u043f\u0438\u0441\u044c \u043f\u0440\u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0432 AD, \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 CAS. Outlook \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 SCP, \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u0442 \u0442\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0430\u0445\u043e\u0434\u044f\u0442\u0441\u044f \u0432 \u043e\u0434\u043d\u043e\u043c \u0441\u0430\u0439\u0442\u0435 \u0441 \u043d\u0438\u043c \u0438 \u043f\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0443 WhenCreated \u2013 \u043f\u043e \u0434\u0430\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f, \u0432\u044b\u0431\u0438\u0440\u0430\u044f \u0441\u0430\u043c\u044b\u0439 \u0441\u0442\u0430\u0440\u044b\u0439.  Autodiscover. Outlook \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u0442 \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 Client Access \u0442\u043e\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u043e\u043f\u0438\u0441\u0430\u043d \u0432 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0435 RPCClientAccessServer \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u0421\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043e \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 mailbox, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043e\u043d\u0430 \u043b\u0435\u0436\u0438\u0442, \u0431\u0435\u0440\u0443\u0442\u0441\u044f \u0438\u0437 AD.</p>"},{"location":"Exchange/#messagetrackinglog","title":"MessageTrackingLog","text":"<p><code>Get-MessageTrackingLog -ResultSize Unlimited | select Timestamp,Sender,Recipients,RecipientCount,MessageSubject,Source,EventID,ClientHostname,ServerHostname,ConnectorId, @{Name=\"MessageSize\"; Expression={[string]([int]($_.TotalBytes / 1024))+\" KB\"}},@{Name=\"MessageLatency\"; Expression={$_.MessageLatency -replace \"\\.\\d+$\"}}</code> <code>Get-MessageTrackingLog -Start (Get-Date).AddHours(-24) -ResultSize Unlimited | where {[string]$_.recipients -like \"*@yandex.ru\"}</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 24 \u0447\u0430\u0441\u0430, \u0433\u0434\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u0435\u043c \u0431\u044b\u043b \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u0434\u043e\u043c\u0435\u043d  -Start \"04/01/2023 09:00:00\" -End \"04/01/2023 18:00:00\" - \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c\u0443 \u043f\u0440\u043e\u043c\u0435\u0436\u0443\u0442\u043a\u0443 \u0432\u0440\u0435\u043c\u0435\u043d\u0438  -MessageSubject \"\u0422\u0435\u0441\u0442\" - \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0442\u0435\u043c\u0435 \u043f\u0438\u0441\u044c\u043c\u0430  -Recipients \"support4@domain.ru\" - \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044e  -Sender - \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u044e  -EventID \u2013 \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u043a\u043e\u0434\u0443 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 (RECEIVE, SEND, FAIL, DSN, DELIVER, BADMAIL, RESOLVE, EXPAND, REDIRECT, TRANSFER, SUBMIT, POISONMESSAGE, DEFER)  -Server \u2013 \u043f\u043e\u0438\u0441\u043a \u043d\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u043c \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u043d\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0435  -messageID \u2013 \u0442\u0440\u0435\u043a\u0438\u043d\u0433 \u043f\u0438\u0441\u044c\u043c\u0430 \u043f\u043e \u0435\u0433\u043e ID</p>"},{"location":"Exchange/#mailbox","title":"Mailbox","text":"<p><code>Get-Mailbox -Database \"it2\"</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445  <code>Get-Mailbox -resultsize unlimited | ? Emailaddresses -like \"support4\" | format-list name,emailaddresses,database,servername</code> \u043a\u0430\u043a\u0443\u044e \u0411\u0414, \u0441\u0435\u0440\u0432\u0435\u0440 \u0438 smtp-\u0430\u0434\u0440\u0435\u0441\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a  <code>Get-Mailbox -Database $db_name -Archive</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0430\u0440\u0445\u0438\u0432\u043d\u044b\u0435 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0435 \u044f\u0449\u0438\u043a\u0438</p> <p><code>Get-MailboxFolderStatistics -Identity \"support4\" -FolderScope All | select Name,ItemsInFolder,FolderSize</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u043e\u043b-\u0432\u043e \u043f\u0438\u0441\u0435\u043c \u0438 \u0440\u0430\u0437\u043c\u0435\u0440 \u0432 \u043a\u0430\u0436\u0434\u043e\u0439 \u043f\u0430\u043f\u043a\u0435  <code>Get-MailboxStatistics \"support4\" | select DisplayName,LastLoggedOnUserAccount,LastLogonTime,LastLogoffTime,ItemCount,TotalItemSize,DeletedItemCount,TotalDeletedItemSize,Database,ServerName</code> \u043e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b-\u0432\u043e \u043f\u0438\u0441\u0435\u043c, \u0438\u0445 \u0440\u0430\u0437\u043c\u0435\u0440, \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0432\u0445\u043e\u0434\u0430 \u0438 \u0432\u044b\u0445\u043e\u0434\u0430, \u0438\u043c\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0438 \u0411\u0414  <code>Get-Mailbox -Server s2 | Get-MailboxStatistics | where {$_.Lastlogontime -lt (get-date).AddDays(-30)} | Sort Lastlogontime -desc | ft displayname,Lastlogontime,totalitemsize</code> \u044f\u0449\u0438\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0438\u0441\u044c 30 \u0438 \u0431\u043e\u043b\u0435\u0435 \u0434\u043d\u0435\u0439</p> <p><code>Enable-Mailbox -Identity support9 -Database test_base</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a \u0434\u043b\u044f \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 AD  <code>New-Mailbox -Name $login -UserPrincipalName \"$login@$domain\" -Database $select_db -OrganizationalUnit $path -Password (ConvertTo-SecureString -String \"$password\" -AsPlainText -Force)</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a \u0431\u0435\u0437 \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0438 \u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e AD  <code>Get-MailboxDatabase -Database $db_name | Remove-MailboxDatabase</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0411\u0414</p> <p><code>Set-MailBox \"support4\" -PrimarySmtpAddress support24@domain.ru -EmailAddressPolicyEnabled $false</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0438 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 SMTP-\u0430\u0434\u0440\u0435\u0441 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Set-Mailbox -Identity \"support4\" -DeliverToMailboxAndForward $true -ForwardingSMTPAddress \"username@outlook.com\"</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u0430\u0434\u0440\u0435\u0441\u0430\u0446\u0438\u044e \u043f\u043e\u0447\u0442\u044b (\u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430 \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0432 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f support4 \u0438 \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e \u043f\u0435\u0440\u0435\u0441\u044b\u043b\u0430\u0435\u0442\u0441\u044f \u043f\u043e \u0430\u0434\u0440\u0435\u0441\u0443 username@outlook.com)</p>"},{"location":"Exchange/#moverequest","title":"MoveRequest","text":"<p><code>Get-Mailbox -Database $db_in | New-MoveRequest -TargetDatabase $db_out</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0435 \u044f\u0449\u0438\u043a\u0438 \u0438\u0437 \u043e\u0434\u043d\u043e\u0439 \u0411\u0414 \u0432 \u0434\u0440\u0443\u0433\u0443\u044e  <code>New-MoveRequest -Identity $db_in -TargetDatabase $db_out</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u043e\u0434\u0438\u043d \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a  <code>Get-MoveRequest | Suspend-MoveRequest</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u044f  <code>Get-MoveRequest | Remove-MoveRequest</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043d\u0430 \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435  <code>Get-MoveRequest | Get-MoveRequestStatistics</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u044f</p> <p>Status:  Cleanup - \u043d\u0443\u0436\u043d\u043e \u043f\u043e\u0434\u043e\u0436\u0434\u0430\u0442\u044c  Queued - \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u0438  InProgress - \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435  Percent Complete - \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f  CompletionInProgress - \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430  Completed - \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043e</p> <p><code>Remove-MoveRequest -Identity $db_name</code> \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u044f (\u0443\u0431\u0440\u0430\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u044f \u0441 \u043f\u043e\u0447\u0442\u043e\u0432\u043e\u0433\u043e \u044f\u0449\u0438\u043a\u0430 \u0438 \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0439)  <code>Get-MailboxDatabase | Select Name, MailboxRetention</code> \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u044f \u044f\u0449\u0438\u043a\u043e\u0432, \u0440\u0430\u0437\u043c\u0435\u0440 \u0431\u0430\u0437\u044b \u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u0441\u044f, \u043f\u043e\u043b\u043d\u043e\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0438\u0437 \u0431\u0430\u0437\u044b \u043f\u0440\u043e\u0438\u0437\u043e\u0439\u0434\u0435\u0442, \u043a\u0430\u043a \u043f\u0440\u043e\u0439\u0434\u0435\u0442 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043d\u0435\u0439, \u0432\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043d\u043e\u0435 \u0432 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0435 MailboxRetention  <code>Set-MailboxDatabase -MailboxRetention '0.00:00:00' -Identity $db_name</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435</p>"},{"location":"Exchange/#archive","title":"Archive","text":"<p><code>Enable-Mailbox -Identity $name -Archive</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0440\u0445\u0438\u0432 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Get-Mailbox $name | New-MoveReques \u2013ArchiveOnly \u2013ArchiveTargetDatabase DBArch</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0430\u0440\u0445\u0438\u0432\u043d\u044b\u0439 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a \u0432 \u0434\u0440\u0443\u0433\u0443\u044e \u0411\u0414  <code>Get-Mailbox $name | fl Name,Database,ArchiveDatabase</code> \u043c\u0435\u0441\u0442\u043e \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0411\u0414 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 \u0411\u0414 \u0435\u0433\u043e \u0430\u0440\u0445\u0438\u0432\u0430  <code>Disable-Mailbox -Identity $name -Archive</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0440\u0445\u0438\u0432  <code>Connect-Mailbox -Identity \"8734c04e-981e-4ccf-a547-1c1ac7ebf3e2\" -Archive -User $name -Database it2</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0430\u0440\u0445\u0438\u0432\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043a \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c\u0443 \u043f\u043e\u0447\u0442\u043e\u0432\u043e\u043c\u0443 \u044f\u0449\u0438\u043a\u0443  <code>Get-Mailbox $name | Set-Mailbox -ArchiveQuota 20GB -ArchiveWarningQuota 19GB</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043a\u0432\u043e\u0442\u044b \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0430\u0440\u0445\u0438\u0432\u0430</p>"},{"location":"Exchange/#quota","title":"Quota","text":"<p><code>Get-Mailbox -Identity $mailbox | fl IssueWarningQuota, ProhibitSendQuota, ProhibitSendReceiveQuota, UseDatabaseQuotaDefaults</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u0432\u043e\u0442\u044b \u043f\u043e\u0447\u0442\u043e\u0432\u043e\u0433\u043e \u044f\u0449\u0438\u043a\u0430  IssueWarningQuota \u2014 \u043a\u0432\u043e\u0442\u0430, \u043f\u0440\u0438 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 Exchange \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435  ProhibitSendQuota \u2014 \u043f\u0440\u0438 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0430  ProhibitSendReceiveQuota \u2014 \u043f\u0440\u0438 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435  UseDatabaseQuotaDefaults \u2014 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043b\u0438 \u043a\u0432\u043e\u0442\u0430 \u0411\u0414 \u0438\u043b\u0438 false - \u0438\u043d\u0434\u0432\u0438\u0434\u0438\u0443\u0430\u043b\u044c\u043d\u044b\u0435  <code>Set-Mailbox -Identity $mailbox -UseDatabaseQuotaDefaults $false -IssueWarningQuota \"3 GB\" -ProhibitSendQuota \"4 GB\" -ProhibitSendReceiveQuota \"5 GB\"</code> \u0437\u0430\u0434\u0430\u0442\u044c \u043a\u0432\u043e\u0442\u0443 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</p> <p><code>Get-MailboxDatabase $db_name | fl Name, *Quota</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u0432\u043e\u0442\u044b \u043d\u0430\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0435 \u043d\u0430 \u0411\u0414  <code>Set-MailboxDatabase $db -ProhibitSendReceiveQuota \"5 GB\" -ProhibitSendQuota \"4 GB\" -IssueWarningQuota \"3 GB\"</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043a\u0432\u043e\u0442\u044b \u043d\u0430 \u0411\u0414</p>"},{"location":"Exchange/#database","title":"Database","text":"<p><code>Get-MailboxDatabase -Status | select ServerName,Name,DatabaseSize</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0438 \u0440\u0430\u0437\u043c\u0435\u0440 \u0432\u0441\u0435\u0445 \u0411\u0414 \u043d\u0430 \u0432\u0441\u0435\u0445 MX-\u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445  <code>New-MailboxDatabase -Name it_2022 -EdbFilePath E:\\Bases\\it_2022\\it_2022.edb -LogFolderPath G:\\Logs\\it_2022 -OfflineAddressBook \"Default Offline Address List\" -server exch-mx-01</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0411\u0414  <code>Restart-Service MSExchangeIS</code> <code>Get-Service | Where {$_ -match \"exchange\"} | Restart-Service</code> <code>Get-MailboxDatabase -Server exch-01</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0431\u0430\u0437 \u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0430 MX-\u0441\u0435\u0440\u0432\u0435\u0440\u0435  <code>New-MoveRequest -Identity \"support4\" -TargetDatabase it_2022</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a \u0432 \u043d\u043e\u0432\u0443\u044e \u0411\u0414  <code>Move-Databasepath $db_name \u2013EdbFilepath \"F:\\DB\\$db_name\\$db_name.edb\" \u2013LogFolderpath \"E:\\DB\\$db_name\\logs\\\"</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0411\u0414 \u0438 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u043b\u043e\u0433\u0438 \u043d\u0430 \u0434\u0440\u0443\u0433\u043e\u0439 \u0434\u0438\u0441\u043a  <code>Set-MailboxDatabase -CircularLoggingEnabled $true -Identity $db_name</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0446\u0438\u043a\u043b\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u0430 (Circular Logging), \u0433\u0434\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043f\u0438\u0448\u0443\u0442\u0441\u044f 4 \u0444\u0430\u0439\u043b\u0430 \u043b\u043e\u0433\u043e\u0432 \u043f\u043e 5 \u041c\u0411, \u043f\u043e\u0441\u043b\u0435 \u0447\u0435\u0433\u043e \u043f\u0435\u0440\u0432\u044b\u0439 \u043b\u043e\u0433-\u0444\u0430\u0439\u043b \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f  <code>Set-MailboxDatabase -CircularLoggingEnabled $false -Identity $db_name</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0446\u0438\u043a\u043b\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u0430  <code>Get-MailboxDatabase -Server \"exch-mx-01\" -Status | select EdbFilePath,LogFolderPath,LogFilePrefix</code> \u043f\u0443\u0442\u044c \u043a \u0411\u0414, \u043b\u043e\u0433\u0430\u043c, \u0438\u043c\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043b\u043e\u0433-\u0444\u0430\u0439\u043b\u0430</p>"},{"location":"Exchange/#mailboxrepairrequest","title":"MailboxRepairRequest","text":"<p><code>New-MailboxRepairRequest -Database it2 -CorruptionType ProvisionedFolder, SearchFolder, AggregateCounts, Folderview</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0442\u0435\u0441\u0442 (\u0432 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043d\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u043e\u0434\u0438\u043d \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a) \u0438 \u0438\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a \u043d\u0430 \u043f\u0440\u0438\u043a\u043b\u0430\u0434\u043d\u043e\u043c \u0443\u0440\u043e\u0432\u043d\u0435  <code>Get-MailboxRepairRequest -Database it2</code> \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f  \u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c:  ProvisionedFolder \u2013 \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u044f \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u043f\u0430\u043f\u043e\u043a  SearchFolder \u2013 \u043e\u0448\u0438\u0431\u043a\u0438 \u0432 \u043f\u0430\u043f\u043a\u0430\u0445 \u043f\u043e\u0438\u0441\u043a\u0430  AggregateCounts \u2013 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0438 \u0438\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0432 \u043f\u0430\u043f\u043a\u0430\u0445 \u0438 \u0438\u0445 \u0440\u0430\u0437\u043c\u0435\u0440\u0435  FolderView \u2013 \u043d\u0435\u0432\u0435\u0440\u043d\u043e\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435, \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u043c\u043e\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f\u043c\u0438 \u043f\u0430\u043f\u043e\u043a</p>"},{"location":"Exchange/#eseutil","title":"eseutil","text":"<p>\u041f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435/\u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043b\u044e\u0431\u043e\u0433\u043e \u043f\u0438\u0441\u044c\u043c\u0430 Exchange \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u0432\u043d\u043e\u0441\u0438\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u0432 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u043b\u043e\u0433, \u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0442\u043e\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u043d\u0435\u043f\u043e\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0432 \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445. \u0420\u0430\u0437\u043c\u0435\u0440 \u043e\u0434\u043d\u043e\u0433\u043e \u043b\u043e\u0433 \u0444\u0430\u0439\u043b\u0430 - 1 \u041c\u0431. \u0415\u0441\u0442\u044c \u0442\u0440\u0438 \u0441\u043f\u043e\u0441\u043e\u0431\u0430 \u0443\u0440\u0435\u0437\u0430\u043d\u0438\u044f \u043b\u043e\u0433\u043e\u0432: DAG, Backup \u043d\u0430 \u0431\u0430\u0437\u0435 Volume Shadow Copy, Circular Logging.</p> <p>\u0420\u0443\u0447\u043d\u043e\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439:  <code>cd E:\\MS_Exchange_2010\\MailBox\\Reg_v1_MailBoxes\\</code> \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u0441 \u043b\u043e\u0433\u0430\u043c\u0438  <code>ls E*.chk</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0438\u043c\u044f \u0444\u0430\u0439\u043b\u0430, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0438\u0437 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u043e\u0439 \u0442\u043e\u0447\u043a\u0438 \u0444\u0438\u043a\u0441\u0430\u0446\u0438\u0438 \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432  <code>eseutil /mk .\\E18.chk</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0444\u0430\u0439\u043b \u0436\u0443\u0440\u043d\u0430\u043b\u0430, \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0438\u0437 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0431\u044b\u043b\u0438 \u0437\u0430\u043d\u0435\u0441\u0435\u043d\u044b \u0432 \u0411\u0414 Exchange  <code>Checkpoint: (0x561299,8,16)</code> 561299 \u0438\u043c\u044f \u0444\u0430\u0439\u043b\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u044b\u043b \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u043c \u0437\u0430\u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d (\u0435\u0433\u043e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0443\u0436\u0435 \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445)  \u041d\u0430\u0445\u043e\u0434\u0438\u043c \u0432 \u043f\u0440\u043e\u0432\u043e\u0434\u043d\u0438\u043a\u0435 \u0444\u0430\u0439\u043b E0500561299.txt, \u043c\u043e\u0436\u043d\u043e \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u0442\u0430\u0440\u0448\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430</p> <p>\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0411\u0414 (\u0435\u0441\u043b\u0438 \u0434\u0432\u0435 \u043a\u043e\u043f\u0438\u0438 \u0411\u0414 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439):  <code>Get-MailboxDatabaseCopyStatus -Identity db_name\\* | Format-List Name,Status,ContentIndexState</code>  Status            : FailedAndSuspended  ContentIndexState : Failed  Status            : Dismounted  ContentIndexState : Failed</p> <p><code>Get-MailboxDatabase -Server exch-mx-01 -Status | fl Name,EdbFilePath,LogFolderPath</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0431\u0430\u0437\u044b \u0438 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u043e\u043d\u043d\u044b\u0445 \u043b\u043e\u0433\u043e\u0432  LogFolderPath - \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u043b\u043e\u0433\u043e\u0432  E18 - \u0438\u043c\u044f \u0442\u0440\u0430\u043d\u043a\u0437\u0430\u043a\u0446\u0438\u043e\u043d\u043d\u043e\u0433\u043e \u043b\u043e\u0433\u0430 (\u0438\u0437 \u043d\u0435\u0433\u043e \u0447\u0438\u0442\u0430\u044e\u0442\u0441\u044f \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u043b\u043e\u0433\u0438)  <code>dismount-Database db_name</code> \u043e\u0442\u043c\u0430\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0411\u0414  <code>eseutil /mh D:\\MS_Exchange_2010\\Mailbox\\db_name\\db_name.edb</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0431\u0430\u0437\u0443  State: Dirty Shutdown - \u043d\u0435\u0441\u043e\u0433\u043b\u0430\u0441\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435, \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442, \u0447\u0442\u043e \u0447\u0430\u0441\u0442\u044c \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u043d\u0435 \u043f\u0435\u0440\u0435\u043d\u0435\u0441\u0435\u043d\u0430 \u0432 \u0431\u0430\u0437\u0443, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043f\u043e\u0441\u043b\u0435 \u0442\u043e\u0433\u043e, \u043a\u0430\u043a \u0431\u044b\u043b\u0430 \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u0435\u043d\u0430 \u0430\u0432\u0430\u0440\u0438\u0439\u043d\u0430\u044f \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430.  <code>eseutil /ml E:\\MS_Exchange_2010\\MailBox\\db_name\\E18</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u0438 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u043e\u043d\u043d\u044b\u0445 \u043b\u043e\u0433\u0438, \u0435\u0441\u043b\u0438 \u0435\u0441\u0442\u044c \u043b\u043e\u0433\u0438 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u0438 \u043e\u043d\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u0440\u0447\u0435\u043d\u044b, \u0442\u043e \u043c\u043e\u0436\u043d\u043e \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u0437 \u043d\u0438\u0445, \u0438\u0437 \u0444\u0430\u0439\u043b\u0430 E18 \u0441\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0432\u0441\u0435 \u043b\u043e\u0433\u0438, \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 - \u041e\u041a</p> <p>Soft Recovery (\u043c\u044f\u0433\u043a\u043e\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435) - \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0435\u0440\u0435\u0432\u0435\u0441\u0442\u0438 \u0431\u0430\u0437\u0443 \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f (Clear shutdown) \u043f\u0443\u0442\u0435\u043c \u0437\u0430\u043f\u0438\u0441\u0438 \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u044e\u0449\u0438\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u0432 \u0411\u0414.  <code>eseutil /R E18 /l E:\\MS_Exchange_2010\\MailBox\\db_name\\ /d D:\\MS_Exchange_2010\\Mailbox\\db_name\\db_name.edb</code> <code>eseutil /R E18 /a /i /l E:\\MS_Exchange_2010\\MailBox\\db_name\\ /d D:\\MS_Exchange_2010\\Mailbox\\db_name\\db_name.edb</code> \u0435\u0441\u043b\u0438 \u0441 \u043b\u043e\u0433\u0430\u043c\u0438 \u0447\u0442\u043e-\u0442\u043e \u043d\u0435 \u0442\u0430\u043a, \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0431\u0430\u0437\u0443 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u0443\u044f \u043e\u0448\u0438\u0431\u043a\u0443 \u0432 \u043b\u043e\u0433\u0430\u0445  <code>eseutil /mk D:\\MS_Exchange_2010\\Mailbox\\db_name\\db_name.edb</code> c\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438 \u0444\u0430\u0439\u043b\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u044b\u0445 \u0442\u043e\u0447\u0435\u043a  <code>eseutil /g D:\\MS_Exchange_2010\\Mailbox\\db_name\\db_name.edb</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u0438 \u0411\u0414  <code>eseutil /k D:\\MS_Exchange_2010\\Mailbox\\db_name\\db_name.edb</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u044b\u0445 \u0441\u0443\u043c\u043c \u0431\u0430\u0437\u044b (CRC)</p> <p>Hard Recovery - \u0435\u0441\u043b\u0438 \u043b\u043e\u0433\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442 \u043e\u0448\u0438\u0431\u043a\u0438 \u0438 \u0431\u0430\u0437\u0430 \u043d\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f, \u0442\u043e \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u0431\u0430\u0437\u0443 \u0431\u0435\u0437 \u043b\u043e\u0433\u043e\u0432.  <code>eseutil /p D:\\MS_Exchange_2010\\Mailbox\\db_name\\db_name.edb</code>  /p - \u0443\u0434\u0430\u043b\u0438\u0442 \u043f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d\u043d\u044b\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b, \u044d\u0442\u0430 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0431\u0443\u0434\u0435\u0442 \u0443\u0434\u0430\u043b\u0435\u043d\u0430 \u0438\u0437 \u0411\u0414 \u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442 \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u044c  <code>esetuil /d D:\\MS_Exchange_2010\\Mailbox\\db_name\\db_name.edb</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0434\u0435\u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e (\u0435\u0441\u043b\u0438 \u0431\u044b\u043b \u043f\u043e\u0442\u0435\u0440\u044f\u043d \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u043e\u0431\u044a\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0445, \u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u0441\u0438\u043b\u044c\u043d\u043e \u0441\u043d\u0438\u0437\u0438\u0442\u044c\u0441\u044f \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c)  \u041f\u043e\u0441\u043b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043c\u0430\u043d\u0434 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u0441 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435\u043c log \u0432 \u043f\u0430\u043f\u043a\u0435 MDBDATA, \u043f\u0435\u0440\u0435\u0434 \u043f\u043e\u043f\u044b\u0442\u043a\u043e\u0439 \u0441\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445.  <code>isinteg -s \"db_name.edb\" -test alltests</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u044c \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445  <code>isinteg -s \"server_name\" -fix -test -alltests</code> \u0435\u0441\u043b\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u0430. \u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0434\u043e \u0442\u0435\u0445 \u043f\u043e\u0440, \u043f\u043e\u043a\u0430 \u0443 \u0432\u0441\u0435\u0445 \u043e\u0448\u0438\u0431\u043e\u043a \u043d\u0435 \u0441\u0442\u0430\u043d\u0435\u0442 \u0441\u0442\u0430\u0442\u0443\u0441 0 \u0438\u043b\u0438 \u0441\u0442\u0430\u0442\u0443\u0441 \u043d\u0435 \u043f\u0435\u0440\u0435\u0441\u0442\u0430\u043d\u0435\u0442 \u043c\u0435\u043d\u044f\u0442\u044c\u0441\u044f, \u0438\u043d\u043e\u0433\u0434\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e 3 \u043f\u0440\u043e\u0445\u043e\u0434\u0430 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430.  <code>eseutil /mh D:\\MS_Exchange_2010\\Mailbox\\db_name\\db_name.edb | Select-String -Pattern \"State:\",\"Log Required:\"</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441  State: Clear shutdown - \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0439 \u0441\u0442\u0430\u0442\u0443\u0441  <code>Log Required</code> \u0442\u0440\u0435\u0431\u0443\u044e\u0442\u0441\u044f \u043b\u0438 \u0444\u0430\u0439\u043b\u044b \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0431\u0430\u0437\u0435, \u0447\u0442\u043e\u0431\u044b \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u0441\u043e\u0433\u043b\u0430\u0441\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435. \u0415\u0441\u043b\u0438 \u0431\u0430\u0437\u0430 \u0440\u0430\u0437\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e, \u0442\u043e \u044d\u0442\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u0432\u043d\u044f\u0442\u044c\u0441\u044f 0.  <code>mount-Database -force db_name</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0411\u0414  <code>Get-MailboxDatabase \u2013Status db_name | fl Mounted</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0411\u0414  <code>New-MailboxRepairRequest -Database db_name -CorruptionType SearchFolder,AggregateCounts,ProvisionedFolder,FolderView</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0445  \u041f\u043e\u0441\u043b\u0435 \u044d\u0442\u043e\u0433\u043e \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c Index.  \u0415\u0441\u043b\u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u044b \u043d\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u044e\u0442\u0441\u044f, \u043d\u043e \u0411\u0414 \u043c\u043e\u043d\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f, \u0442\u043e \u043f\u0435\u0440\u0435\u043d\u0435\u0441\u0442\u0438 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0435 \u044f\u0449\u0438\u043a\u0438 \u0432 \u043d\u043e\u0432\u0443\u044e \u0411\u0414.</p> <p>\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0411\u0414 \u0438\u0437 Backup:</p> <p>1-\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442: 1. \u041e\u0442\u043c\u0430\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0411\u0414 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u0441 \u0444\u0430\u0439\u043b\u0430\u043c\u0438 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0411\u0414. 3. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432 \u0442\u0443 \u0436\u0435 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u0438\u0437 Backup \u0431\u0430\u0437\u0443 \u0441 \u043b\u043e\u0433\u0430\u043c\u0438. 4. \u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043c\u044f\u0433\u043a\u043e\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0411\u0414 (Soft Recovery). 5. \u041f\u0440\u0438\u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0432\u0430\u0442\u044c.</p> <p>2-\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442: 1. \u041e\u0442\u043c\u0430\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0411\u0414. 2. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0411\u0414 \u0441 \u043b\u043e\u0433\u0430\u043c\u0438 \u0438\u0437 Backup \u0432 \u043b\u044e\u0431\u043e\u0435 \u043c\u0435\u0441\u0442\u043e. 3. \u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043c\u044f\u0433\u043a\u043e\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0411\u0414 (Soft Recovery). 4. \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0411\u0414. 5. \u0421\u043e\u0437\u0434\u0430\u0442\u044c Recovery Database \u0438 \u0441\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u043d\u0435\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u0443\u044e \u0438\u0437 \u0431\u044d\u043a\u0430\u043f\u0430 \u0411\u0414, \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u0437 \u043d\u0435\u0451 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0435 \u044f\u0449\u0438\u043a\u0438 \u0432 \u043d\u043e\u0432\u0443\u044e \u0411\u0414 \u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043d\u0430 \u043d\u0438\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439. 6. \u0415\u0441\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c Dial Tone Recovery, \u0442\u043e \u0442\u0430\u043a \u0436\u0435 \u043f\u0435\u0440\u0435\u043d\u0435\u0441\u0442\u0438 \u0438\u0437 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u0411\u0414 \u043f\u0440\u043e\u043c\u0435\u0436\u0443\u0442\u043e\u0447\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0445 \u044f\u0449\u0438\u043a\u043e\u0432.</p> <p>3-\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442: 1. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u044c Soft Repair \u0438\u043b\u0438 Hard Recovery. 2. \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0411\u0414. \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0432 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430\u0445: \u00ab\u0431\u0430\u0437\u0430 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u0430\u043d\u0430 \u043f\u0440\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438\u00bb. 3. \u0415\u0441\u043b\u0438 \u0431\u0430\u0437\u0430 \u0431\u044b\u043b\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u043e \u043e\u0437\u0434\u0430\u043d\u0430 \u0438 \u0435\u0449\u0435 \u043d\u0435 \u0431\u044b\u043b\u0430 \u043f\u043e\u0434\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0430, \u0442\u043e \u044d\u0442\u0430 \u043f\u0430\u043f\u043a\u0430 \u0431\u0443\u0434\u0435\u0442 \u043f\u0443\u0441\u0442\u0430, \u0442\u0443\u0434\u0430 \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0430\u0435\u043c \u0431\u0430\u0437\u0443 \u0438\u0437 Backup, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0431\u044b\u043b\u0430 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u0430 ESEUTIL \u0432\u043c\u0435\u0441\u0442\u0435 \u0441\u043e \u0432\u0441\u0435\u043c\u0438 \u0444\u0430\u0439\u043b\u0430\u043c\u0438. \u0423\u043a\u0430\u0437\u0430\u0442\u044c \u0438\u043c\u044f .edb \u0442\u0430\u043a\u043e\u0435 \u0436\u0435, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0431\u044b\u043b\u043e \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043d\u043e\u0432\u043e\u0439 \u0431\u0430\u0437\u044b. 4. \u041c\u043e\u043d\u0442\u0438\u0440\u0443\u0435\u043c \u0431\u0430\u0437\u0443. 5. \u041f\u0435\u0440\u0435\u043d\u0430\u0446\u0435\u043b\u0438\u0432\u0430\u0435\u043c \u044f\u0449\u0438\u043a\u0438 \u0441\u043e \u0441\u0442\u0430\u0440\u043e\u0439 (Mailbox_DB_02), \u043d\u0435\u0438\u0441\u043f\u0440\u0430\u0432\u043d\u043e\u0439 \u0431\u0430\u0437\u044b, \u043d\u0430 \u043d\u043e\u0432\u0443\u044e \u0431\u0430\u0437\u0443 (Mailbox_DB_02_02): <code>Get-Mailbox -Database Mailbox_DB_02 | where {$_.ObjectClass -NotMatch '(SystemAttendantMailbox|ExOleDbSystemMailbox)'} | Set-Mailbox -Database Mailbox_DB_02_02</code> 6. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0445: <code>New-MailboxRepairRequest -Database \"Mailbox_DB_02_02\" -CorruptionType ProvisionedFolder, SearchFolder, AggregateCounts, Folderview</code></p>"},{"location":"Exchange/#dial-tone-recovery","title":"Dial Tone Recovery","text":"<p><code>Get-Mailbox -Database \"MailboxDB\" | Set-Mailbox -Database \"TempDB\"</code> \u043f\u0435\u0440\u0435\u043d\u0430\u0446\u0435\u043b\u0438\u0442\u044c \u044f\u0449\u0438\u043a\u0438 \u0441 \u043e\u0434\u043d\u043e\u0439 \u0411\u0414 (\u043d\u0435\u0440\u0430\u0431\u043e\u0447\u0435\u0439) \u043d\u0430 \u0434\u0440\u0443\u0433\u0443\u044e (\u043f\u0443\u0441\u0442\u0443\u044e)  <code>Get-Mailbox -Database TempDB</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0435 \u044f\u0449\u0438\u043a\u0438 \u0432 \u0411\u0414 TempDB  <code>Restart-Service MSExchangeIS</code> \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443 Mailbox Information Store (\u0431\u0430\u043d\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445), \u0438\u043d\u0430\u0447\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u0431\u0443\u0434\u0443\u0442 \u043f\u043e-\u043f\u0440\u0435\u0436\u043d\u0435\u043c\u0443 \u043f\u044b\u0442\u0430\u0442\u044c\u0441\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u0442\u0430\u0440\u043e\u0439 \u0411\u0414  <code>iisreset</code> <code>Get-Mailbox -Database \"TempDB\" | Set-Mailbox -Database \"MailboxDB\"</code> \u043f\u043e\u0441\u043b\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u0440\u043e\u0439 \u0411\u0414, \u043d\u0443\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0441 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u0411\u0414 \u043e\u0431\u0440\u0430\u0442\u043d\u043e  \u041f\u043e\u0441\u043b\u0435 \u044d\u0442\u043e\u0433\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0441\u043b\u0438\u044f\u043d\u0438\u0435 \u0441 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u0411\u0414 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e Recovery.</p>"},{"location":"Exchange/#recovery-database-rdb","title":"Recovery database (RDB)","text":"<p><code>New-MailboxDatabase \u2013Recovery \u2013Name RecoveryDB \u2013Server $exch_mx \u2013EdbFilePath \"D:\\TempDB\\TempDB.edb\" -LogFolderPath \"D:\\TempDB\"</code> \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0430 \u043d\u043e\u0432\u044b\u0445 \u043f\u0438\u0441\u0435\u043c \u0438\u0437 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u0411\u0414 \u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u0443\u044e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0430\u043c \u0444\u0430\u0439\u043b TempDB.edb \u0441\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u043c Clean Shutdown, \u0438\u0437 \u043d\u0435\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u043b\u0443\u0436\u0435\u0431\u043d\u0443\u044e \u0411\u0414 (\u043a\u043b\u044e\u0447 -Recovery)  <code>Mount-Database \"D:\\TempDB\\TempDB.edb\"</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0411\u0414  <code>Get-MailboxStatistics -Database RecoveryDB</code> <code>New-MailboxRestoreRequest \u2013SourceDatabase RecoveryDB \u2013SourceStoreMailbox support \u2013TargetMailbox support</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u0447\u0442\u043e\u0432\u043e\u0433\u043e \u044f\u0449\u0438\u043a\u0430 \u0441 DisplayName: support \u0438\u0437 RecoveryDB \u0432 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a \u0441 \u043f\u0441\u0435\u0432\u0434\u043e\u043d\u0438\u043c\u043e\u043c support \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0439 \u0431\u0430\u0437\u044b. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0438\u0449\u0435\u0442 \u0432 \u043f\u043e\u0447\u0442\u043e\u0432\u043e\u0439 \u0431\u0430\u0437\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0449\u0438\u0435 LegacyExchangeDN \u043b\u0438\u0431\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435 \u0430\u0434\u0440\u0435\u0441\u0430 X500, \u0435\u0441\u043b\u0438 \u043d\u0443\u0436\u043d\u043e \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0434\u0440\u0443\u0433\u043e\u0439 \u044f\u0449\u0438\u043a, \u043d\u0443\u0436\u043d\u043e \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u043a\u043b\u044e\u0447 -AllowLegacyDNMisMatch  <code>New-MailboxRestoreRequest \u2013SourceDatabase RecoveryDB \u2013SourceStoreMailbox support \u2013TargetMailbox support \u2013TargetRootFolder \"Restore\"</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0438\u0441\u044c\u043c\u0430 \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u0443\u044e \u043f\u0430\u043f\u043a\u0443 \u0432 \u044f\u0449\u0438\u043a\u0435 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f (\u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438), \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u043f\u0430\u043f\u043a\u0438 -IncludeFolders \"##Inbox##\"  <code>Get-MailboxRestoreRequest | Get-MailboxRestoreRequestStatistics</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f  <code>Get-MailboxRestoreRequestStatistics -Identity support</code> <code>Get-MailboxRestoreRequest -Status Completed | Remove-MailboxRestoreRequest</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b</p>"},{"location":"Exchange/#transport","title":"Transport","text":"<p><code>Get-TransportServer $srv_cas | select MaxConcurrentMailboxDeliveries,MaxConcurrentMailboxSubmissions,MaxConnectionRatePerMinute,MaxOutboundConnections,MaxPerDomainOutboundConnections,PickupDirectoryMaxMessagesPerMinute</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u043d\u043e\u0439 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430  MaxConcurrentMailboxDeliveries \u2014 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043f\u043e\u0442\u043e\u043a\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043c\u043e\u0436\u0435\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440 \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u043f\u0438\u0441\u0435\u043c.  MaxConcurrentMailboxSubmissions \u2014 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043f\u043e\u0442\u043e\u043a\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043c\u043e\u0436\u0435\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u043f\u0438\u0441\u0435\u043c.  MaxConnectionRatePerMinute \u2014 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u0430\u044f \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 \u0432 \u043c\u0438\u043d\u0443\u0442\u0443.  MaxOutboundConnections \u2014 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043c\u043e\u0436\u0435\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u044c Exchange \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438.  MaxPerDomainOutboundConnections \u2014 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043c\u043e\u0436\u0435\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u044c Exchange \u0434\u043b\u044f \u043e\u0434\u043d\u043e\u0433\u043e \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0434\u043e\u043c\u0435\u043d\u0430.  PickupDirectoryMaxMessagesPerMinute \u2014 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u0432 \u043c\u0438\u043d\u0443\u0442\u0443 (\u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043f\u0438\u0441\u0435\u043c \u043f\u043e \u043f\u0430\u043f\u043a\u0430\u043c).  <code>Set-TransportServer exchange-cas -MaxConcurrentMailboxDeliveries 21 -MaxConcurrentMailboxSubmissions 21 -MaxConnectionRatePerMinute 1201 -MaxOutboundConnections 1001 -MaxPerDomainOutboundConnections 21 -PickupDirectoryMaxMessagesPerMinute 101</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f</p> <p><code>Get-TransportConfig | select MaxSendSize, MaxReceiveSize</code> \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u0442\u0440\u0430\u0441\u043f\u043e\u0440\u0442\u0430 (\u043d\u0430\u0438\u043c\u0435\u043d\u044c\u0448\u0438\u0439 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442, \u043f\u043e\u0441\u043b\u0435 \u043a\u043e\u043d\u043d\u0435\u043a\u0442\u043e\u0440\u0430 \u0438 \u043f\u043e\u0447\u0442\u043e\u0432\u043e\u0433\u043e \u044f\u0449\u0438\u043a\u0430).  <code>New-TransportRule -Name AttachmentLimit -AttachmentSizeOver 15MB -RejectMessageReasonText \"Sorry, messages with attachments over 15 MB are not accepted\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u043d\u043e\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u043e \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u044f</p>"},{"location":"Exchange/#connector","title":"Connector","text":"<p><code>Get-ReceiveConnector | select Name,MaxMessageSize,RemoteIPRanges,WhenChanged</code> \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u043a\u043e\u043d\u043d\u0435\u043a\u0442\u043e\u0440\u0430 (\u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 \u043d\u0438\u0436\u0435, \u0447\u0435\u043c \u0443 \u043f\u043e\u0447\u0442\u043e\u0432\u043e\u0433\u043e \u044f\u0449\u0438\u043a\u0430)  <code>Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MaxMessageSize 30Mb</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0443 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043a\u043e\u043d\u043d\u0435\u043a\u0442\u043e\u0440\u0430 \u0432 \u0441\u043f\u0438\u0441\u043a\u0435 (\u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 \u0432\u044b\u0448\u0435, \u0447\u0435\u043c \u0443 \u0442\u0440\u0430\u0441\u043f\u043e\u0440\u0442\u0430)  <code>Get-Mailbox \"support4\" | select MaxSendSize, MaxReceiveSize</code> \u043d\u0430\u0438\u0432\u044b\u0441\u0448\u0438\u0439 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442  <code>Set-Mailbox \"support4\" -MaxSendSize 30MB -MaxReceiveSize 30MB</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440</p> <p><code>Set-SendConnector -Identity \"ConnectorName\" -Port 26</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0440\u0442 \u043a\u043e\u043d\u043d\u0435\u043a\u0442\u043e\u0440\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438  <code>Get-SendConnector \"proxmox\" | select port</code></p> <p><code>Get-ReceiveConnector | select Name,MaxRecipientsPerMessage</code> \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e Exchange \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0430\u0434\u0440\u0435\u0441\u0430\u0442\u043e\u0432 \u0432 \u043e\u0434\u043d\u043e\u043c \u043f\u0438\u0441\u044c\u043c\u0435 (200)  <code>Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MaxRecipientsPerMessage 50</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435  <code>Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MessageRateLimit 1000</code> \u0437\u0430\u0434\u0430\u0442\u044c \u043b\u0438\u043c\u0438\u0442 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u0432 \u043c\u0438\u043d\u0443\u0442\u0443 \u0434\u043b\u044f \u043a\u043e\u043d\u043d\u0435\u043a\u0442\u043e\u0440\u0430</p> <p><code>Get-OfflineAddressbook | Update-OfflineAddressbook</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c OAB  <code>Get-ClientAccessServer | Update-FileDistributionService</code></p>"},{"location":"Exchange/#pst","title":"PST","text":"<p><code>New-MailboxExportRequest -Mailbox $name -filepath \"\\\\$srv\\pst\\$name.PST\" ## -ContentFilter {(Received -lt \"01/01/2021\")} -Priority Highest/Lower ## -IsArchive</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u044d\u043a\u0441\u043f\u043e\u0440\u0442 \u0438\u0437 \u0430\u0440\u0445\u0438\u0432\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>New-MailboxExportRequest -Mailbox $name -IncludeFolders \"##Inbox##\" -FilePath \"\\\\$srv\\pst\\$name.PST\"</code> \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0430\u043f\u043a\u0443 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435  <code>New-MailboxImportRequest -Mailbox $name \"\\\\$srv\\pst\\$name.PST\"</code> \u0438\u043c\u043f\u043e\u0440\u0442 \u0438\u0437 PST  <code>Get-MailboxExportRequest</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432  <code>Get-MailboxExportRequest -Status Completed | Remove-MailboxExportRequest</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u044b\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b  <code>Remove-MailboxExportRequest -RequestQueue MBXDB01 -RequestGuid 25e0eaf2-6cc2-4353-b83e-5cb7b72d441f</code> \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u044d\u043a\u0441\u043f\u043e\u0440\u0442</p>"},{"location":"Exchange/#distributiongroup","title":"DistributionGroup","text":"<p><code>Get-DistributionGroup</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0438  <code>Get-DistributionGroupMember \"!_\u041e\u0444\u0438\u0441\"</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0432 \u0433\u0440\u0443\u043f\u043f\u0435  <code>Add-DistributionGroupMember -Identity \"!_\u041e\u0444\u0438\u0441\" -Member \"$name@$domain\"</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0433\u0440\u0443\u043f\u043f\u0443 \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0438  <code>Remove-DistributionGroupMember -Identity \"!_\u041e\u0444\u0438\u0441\" -Member \"$name@$domain\"</code> <code>New-DistributionGroup -Name \"!_\u0422\u0435\u0441\u0442\" -Members \"$name@$domain\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443  <code>Set-DistributionGroup -Identity \"support4\" -HiddenFromAddressListsEnabled $true (\u0438\u043b\u0438 Set-Mailbox)</code> \u0441\u043a\u0440\u044b\u0442\u044c \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430 \u0430\u0434\u0440\u0435\u0441\u043e\u0432 Exchange</p>"},{"location":"Exchange/#search","title":"Search","text":"<p><code>Search-Mailbox -Identity \"support4\" -SearchQuery '\u0422\u0435\u043c\u0430:\"Mikrotik DOWN\"'</code> \u043f\u043e\u0438\u0441\u043a \u043f\u0438\u0441\u0435\u043c \u043f\u043e \u0442\u0435\u043c\u0435  <code>Search-Mailbox -Identity \"support4\" -SearchQuery 'Subject:\"Mikrotik DOWN\"'</code> <code>Search-Mailbox -Identity \"support4\" -SearchQuery 'attachment -like:\"*.rar\"'</code> <code>Search-Mailbox -Identity \"support4\" -SearchQuery \"\u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e: &lt; 01/01/2020\" -DeleteContent -Force</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043f\u0438\u0441\u0435\u043c \u043f\u043e \u0434\u0430\u0442\u0435</p> <p>\u0424\u043e\u0440\u043c\u0430\u0442 \u0434\u0430\u0442\u044b \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0440\u0435\u0433\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0445 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0430:  <code>20/07/2018</code> <code>07/20/2018</code> <code>20-Jul-2018</code> <code>20/July/2018</code></p>"},{"location":"Exchange/#auditlog","title":"AuditLog","text":"<p><code>Get-AdminAuditLogConfig</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0430\u0443\u0434\u0438\u0442\u0430  <code>Set-Mailbox -Identity \"support4\" -AuditOwner HardDelete</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 HardDelete \u043f\u0438\u0441\u0435\u043c  <code>Set-mailbox -identity \"support4\" -AuditlogAgelimit 120</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f  <code>Get-mailbox -identity \"support4\" | Format-list Audit*</code> \u0434\u0430\u043d\u043d\u044b\u0435 \u0430\u0443\u0434\u0438\u0442\u0430  <code>Search-MailboxAuditLog -Identity \"support4\" -LogonTypes Delegate -ShowDetails -Start \"2022-02-22 18:00\" -End \"2022-03-22 18:00\"</code> \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043b\u043e\u0433\u043e\u0432  <code>Search-AdminAuditLog -StartDate \"02/20/2022\" | ft CmdLetName,Caller,RunDate,ObjectModified -Autosize</code> \u043f\u043e\u0438\u0441\u043a \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \u0438\u0441\u0442\u043e\u0440\u0438\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b\u0445 \u043a\u043e\u043c\u0430\u043d\u0434 \u0432 \u0436\u0443\u0440\u043d\u0430\u043b\u0435 \u0430\u0443\u0434\u0438\u0442\u0430 Exchange</p>"},{"location":"Exchange/#test","title":"Test","text":"<p><code>Test-ServiceHealth</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u0440\u043e\u043b\u0435\u0439 \u0441\u0435\u0440\u0432\u0435\u0440\u0430: \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0445 \u044f\u0449\u0438\u043a\u043e\u0432, \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430, \u0435\u0434\u0438\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043e\u0431\u043c\u0435\u043d\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f\u043c\u0438, \u0442\u0440\u0430\u0441\u043f\u043e\u0440\u0442\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>$mx_srv_list | %{Test-MapiConnectivity -Server $_}</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f MX-\u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u043a \u0411\u0414  <code>Test-MAPIConnectivity -Database $db</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043b\u043e\u0433\u0438\u043d\u0430 \u0432 \u0431\u0430\u0437\u0443  <code>Test-MAPIConnectivity \u2013Identity $user@$domain</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043b\u043e\u0433\u0438\u043d\u0430 \u0432 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u044f\u0449\u0438\u043a  <code>Test-ComputerSecureChannel</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441\u043b\u0443\u0436\u0431\u044b AD  <code>Test-MailFlow</code> \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u0442\u043e\u043a\u0430 \u043f\u043e\u0447\u0442\u044b</p>"},{"location":"Exchange/#queue","title":"Queue","text":"<p><code>Get-TransportServer | %{Get-Queue -Server $_.Name}</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u043d\u0430 \u0432\u0441\u0435\u0445 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u043d\u044b\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445  <code>Get-Queue -Identity EXCHANGE-CAS\\155530 | Format-List</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431 \u043e\u0447\u0435\u0440\u0435\u0434\u0438  <code>Get-Queue -Identity EXCHANGE-CAS\\155530 | Get-Message -ResultSize Unlimited | Select FromAddress,Recipients</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u0435\u0439 (FromAddress) \u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u0435\u0439 \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 (Recipients)  <code>Get-Message -Queue EXCHANGE-CAS\\155530</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0438\u043d\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u0432 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 (\u0441\u0435\u0440\u0432\u0435\u0440\\\u043e\u0447\u0435\u0440\u0435\u0434\u044c\\\u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u043f\u0438\u0441\u044c\u043c\u0430)  <code>Resume-Message EXCHANGE-CAS\\155530\\444010</code> \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0443 \u043f\u0438\u0441\u044c\u043c\u0430 \u0438\u0437 \u043e\u0447\u0435\u0440\u0435\u0434\u0438  <code>Retry-Queue -Filter {Status -eq \"Retry\"}</code> \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0443 \u0432\u0441\u0435\u0445 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 c \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u043c \"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c\"  <code>Get-Queue -Identity EXCHANGE-CAS\\155530 | Get-Message -ResultSize unlimited | Remove-Message -WithNDR $False</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043e\u0447\u0435\u0440\u0435\u0434\u044c  <code>Get-transportserver EXCHANGE-CAS | Select MessageExpirationTimeout</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0436\u0438\u0437\u043d\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, 2 \u0434\u043d\u044f)</p> <p>Error Exchange 452 4.3.1 Insufficient system resources - \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0435 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u0430 \u043d\u0430 \u0434\u0438\u0441\u043a\u0435, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043d\u0430\u0445\u043e\u0434\u044f\u0442\u0441\u044f \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u0441\u043b\u0443\u0436\u0431\u044b Exchange Hub Transport, \u0437\u0430 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 Back Pressure, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432 \u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0435 \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0435\u0442 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u043d\u0430 \u0434\u0438\u0441\u043a\u0435  \u041f\u043e\u0440\u043e\u0433 Medium (90%) \u2014 \u043f\u0435\u0440\u0435\u0441\u0442\u0430\u0442\u044c \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u043f\u043e SMTP \u043f\u043e\u0447\u0442\u0443 \u043e\u0442 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u0435\u0439 (\u043f\u043e\u0447\u0442\u0430 \u043e\u0442 MAPI \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432 \u043f\u0440\u0438 \u044d\u0442\u043e\u043c \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442\u0441\u044f)  \u041f\u043e\u0440\u043e\u0433 High (99%) \u2014 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043f\u043e\u0442\u043e\u043a\u0430 \u043f\u043e\u0447\u0442\u044b \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u043f\u0440\u0435\u043a\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f  \u0420\u0435\u0448\u0435\u043d\u0438\u0435: \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u043b\u043e\u0433\u0438 IIS (C:\\inetpub\\logs\\LogFiles\\W3SVC1), \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0434\u0438\u0441\u043a\u0430, \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 Back Pressure (\u043f\u043b\u043e\u0445\u043e\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442) \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u043d\u0435\u0441\u0442\u0438 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u043d\u044b\u0435 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u043d\u0430 \u0434\u0440\u0443\u0433\u043e\u0439 \u0434\u0438\u0441\u043a \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e\u0433\u043e \u043e\u0431\u044a\u0451\u043c\u0430.</p> <p><code>Get-Service | ? name -like \"MSExchangeTransport\" | Stop-Service</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0443 \u043e\u0447\u0435\u0440\u0435\u0434\u0438  <code>Rename-Item \"C:\\Program Files\\Microsoft\\Exchange Server\\V15\\TransportRoles\\data\\Queue\" \"C:\\Program Files\\Microsoft\\Exchange Server\\V15\\TransportRoles\\data\\Queue_old\"</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0431\u0430\u0437\u0443 \u043e\u0447\u0435\u0440\u0435\u0434\u0438  <code>C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Bin\\EdgeTransport.exe.config</code> \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043f\u0443\u0442\u044c \u043a \u0431\u0434 \u0441 \u043e\u0447\u0435\u0440\u0435\u0434\u044c\u044e (\u0431\u043b\u043e\u043a  \u043a\u043b\u044e\u0447\u0438  \u0438 QueueDatabaseLoggingPath)  \u0414\u043b\u044f \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0430 \u0411\u0414, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u0444\u0430\u0439\u043b\u044b \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 Mail.que \u0438 Trn.chk (\u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u0434\u043b\u044f \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u044f \u0437\u0430\u043f\u0438\u0441\u0438 \u0432 \u043b\u043e\u0433\u0430\u0445) \u0438\u0437 \u0438\u0441\u0445\u043e\u0434\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0432 \u043d\u043e\u0432\u043e\u0435. \u041f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u0444\u0430\u0439\u043b\u044b \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 Trn.log, Trntmp.log, Trn nnnn.log , Trnres00001.jrs, Trnres00002.jrs \u0438 Temp.edb \u0438\u0437 \u0441\u0442\u0430\u0440\u043e\u0433\u043e \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0432 \u043d\u043e\u0432\u043e\u0435. tmp.edb \u2014 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0441\u0445\u0435\u043c\u044b \u0441\u0430\u043c\u043e\u0439 \u0431\u0430\u0437\u044b, \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0442\u0438 \u043d\u0435 \u043d\u0443\u0436\u043d\u043e.  \u041f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0441\u043b\u0443\u0436\u0431\u044b \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u0430 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0442\u0430\u0440\u0443\u044e \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u0438 \u0444\u0430\u0439\u043b\u044b \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u0438\u0437 \u0441\u0442\u0430\u0440\u043e\u0433\u043e \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f."},{"location":"Exchange/#defrag","title":"Defrag","text":"<p><code>Get-MailboxDatabase -Status | ft Name, DatabaseSize, AvailableNewMailboxSpace</code>  DatabaseSize - \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0431\u0430\u0437\u044b  AvailableNewMailboxSpace - \u043e\u0431\u044a\u0451\u043c \u043f\u0443\u0441\u0442\u044b\u0445 \u0441\u0442\u0440\u0430\u043d\u0438\u0446, \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043c\u043e\u0436\u043d\u043e \u043e\u0441\u0432\u043e\u0431\u043e\u0434\u0438\u0442\u044c \u043f\u0440\u0438 \u0434\u0435\u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438  (DatabaseSize \u2014 AvailableNewMailboxSpace) x 1,1 - \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u043c\u0435\u0442\u044c \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u0430 \u043d\u0435 \u043c\u0435\u043d\u0435\u0435 110% \u043e\u0442 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0431\u0430\u0437\u044b (\u0431\u0435\u0437 \u0443\u0447\u0435\u0442\u0430 \u043f\u0443\u0441\u0442\u044b\u0445 \u0441\u0442\u0440\u0430\u043d\u0438\u0446)  <code>cd $path</code> <code>Dismount-Database \"$path\\$db_name\"</code> \u043e\u0442\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0411\u0414  <code>eseutil /d \"$path\\$db_name.edb\"</code> <code>Mount-Database \"$path\\$db\"</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0411\u0414</p>"},{"location":"Exchange/#dag-database-availability-group","title":"DAG (Database Availability Group)","text":"<p><code>Install-WindowsFeature -Name Failover-Clustering -ComputerName EXCH-MX-01</code> \u043e\u0441\u043d\u043e\u0432\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438 Windows Server Failover Cluster  <code>New-DatabaseAvailabilityGroup -Name dag-01 -WitnessServer fs-05 -WitnessDirectory C:\\witness_exchange1</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0433\u043e \u0441\u0432\u0438\u0434\u0435\u0442\u0435\u043b\u044f \u0434\u043b\u044f \u043a\u0432\u043e\u0440\u0443\u043c\u0430  Quorum - \u044d\u0442\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0433\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u043d\u0438\u044f, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0434\u043b\u044f \u043f\u0440\u0438\u043d\u044f\u0442\u0438\u044f \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043d\u0443\u0436\u043d\u043e \u0438\u043c\u0435\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0438\u043d\u0441\u0442\u0432\u043e \u0433\u043e\u043b\u043e\u0441\u043e\u0432, \u0447\u0442\u043e \u0431\u044b \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u043a\u043e\u043f\u0438\u044e \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0439.  WitnessDirectory \u2014 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0433\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u0430-\u0441\u0432\u0438\u0434\u0435\u0442\u0435\u043b\u044f.  <code>Set-DatabaseAvailabilityGroup dag-01 \u2013DatabaseAvailabilityGroupIPAdress $ip</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c ip-\u0430\u0434\u0440\u0435\u0441 \u0433\u0440\u0443\u043f\u043f\u044b  <code>Get-DatabaseAvailabilityGroup</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0433\u0440\u0443\u043f\u043f  <code>Get-DatabaseAvailabilityGroup -Identity dag-01</code> <code>Add-DatabaseAvailabilityGroupServer -Identity dag-01 -MailboxServer EXCH-MX-01</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0435\u0440\u0432\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 (\u0432\u0441\u0435 \u0411\u0414 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445 \u0432 DAG \u0434\u043e\u043b\u0436\u043d\u044b \u0445\u0440\u0430\u043d\u0438\u0442\u044c\u0441\u044f \u043f\u043e \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u043e\u043c\u0443 \u043f\u0443\u0442\u0438)  <code>Add-MailboxDatabaseCopy -Identity db_name -MailboxServer EXCH-MX-04</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043f\u0438\u044e \u0411\u0414  <code>Get-MailboxDatabaseCopyStatus -Identity db_name\\* | select Name,Status,LastInspectedLogTime</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0438 \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0438\u0439</p> <p>Status:  Mounted - \u0440\u0430\u0431\u043e\u0447\u0430\u044f \u0431\u0430\u0437\u0430  Suspended - \u043f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435  Healthy - \u0440\u0430\u0431\u043e\u0447\u0430\u044f \u043f\u0430\u0441\u0441\u0438\u0432\u043d\u0430\u044f \u043a\u043e\u043f\u0438\u044f  ServiceDown - \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430 (\u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d \u0441\u0435\u0440\u0432\u0435\u0440)  Dismounted - \u043e\u0442\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0430  FailedAndSuspended - \u043e\u0448\u0438\u0431\u043a\u0430 \u0438 \u043f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f  Resynchronizing - \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f, \u0433\u0434\u0435 \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0441\u0442\u0435\u043f\u0435\u043d\u043d\u043e \u0443\u043c\u0435\u043d\u044c\u0448\u0430\u0442\u044c\u0441\u044f \u0434\u043b\u0438\u043d\u0430 \u043e\u0447\u0435\u0440\u0435\u0434\u0438  CopyQueue Length - \u0434\u043b\u0438\u043d\u0430 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (0 - \u0437\u043d\u0430\u0447\u0438\u0442 \u0432\u0441\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u0437 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0439 \u0431\u0430\u0437\u044b \u0440\u0435\u043f\u043b\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u0432 \u043f\u0430\u0441\u0441\u0438\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e)</p> <p><code>Resume-MailboxDatabaseCopy -Identity db_name\\EXCH-MX-04</code> \u0432\u043e\u0437\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c (Resume) \u0438\u043b\u0438 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0431\u0434 \u043d\u0430 EXCH-MX-04 (\u0438\u0437 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 Suspended \u0432 Healthy)  <code>Suspend-MailboxDatabaseCopy -Identity db_name\\EXCH-MX-04</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 (\u0432 \u0441\u0442\u0430\u0442\u0443\u0441 Suspended)  <code>Update-MailboxDatabaseCopy -Identity db_name\\EXCH-MX-04 -DeleteExistingFiles</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043f\u0438\u044e \u0411\u0414 (\u0441\u0434\u0435\u043b\u0430\u0442\u044c Full Backup)  <code>Set-MailboxDatabaseCopy -Identity db_name\\EXCH-MX-04 -ActivationPreference 1</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 \u0434\u043b\u044f \u0430\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043a\u043e\u043f\u0438\u0439 \u0411\u0414 (\u043a\u0430\u043a\u0443\u044e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c, 1 \u2013 \u0441\u0430\u043c\u043e\u0435 \u0432\u044b\u0441\u043e\u043a\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435)  <code>Move-ActiveMailboxDatabase db_name -ActivateOnServer EXCH-MX-04 -MountDialOverride:None -Confirm:$false</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043a\u043e\u043f\u0438\u044e \u0411\u0414 \u0432 DAG (\u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u0430\u043a\u0442\u0438\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e)  <code>Remove-MailboxDatabaseCopy -Identity db_name\\EXCH-MX-04 -Confirm:$False</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u043e\u043f\u0438\u0438 \u043f\u0430\u0441\u0441\u0438\u0432\u043d\u043e\u0439 \u0431\u0430\u0437\u044b \u0432 DAG-\u0433\u0440\u0443\u043f\u043f\u0435 (\u0443 \u0411\u0414 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u043e \u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0446\u0438\u043a\u043b\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0436\u0443\u0440\u043d\u0430\u043b\u0430)  <code>Remove-DatabaseAvailabilityGroupServer -Identity dag-01 -MailboxServer EXCH-MX-04 -ConfigurationOnly</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c MX \u0441\u0435\u0440\u0432\u0435\u0440 \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b DAG  <code>Import-Module FailoverClusters</code> <code>Get-ClusterNode EXCH-MX-04 | Remove-ClusterNode -Force</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043e\u0442\u043a\u0430\u0437\u0430\u0432\u0448\u0438\u0439 \u0443\u0437\u0435\u043b \u0438\u0437 Windows Failover Cluster</p> <p><code>Get-DatabaseAvailabilityGroup | Get-DatabaseAvailabilityGroupHealth</code> \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433</p>"},{"location":"Exchange/#index","title":"Index","text":"<p><code>Get-MailboxDatabaseCopyStatus * | select name,status,ContentIndexState,ContentIndexErrorMessage,ActiveDatabaseCopy,LatestCopyBackupTime,CopyQueueLength</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0440\u0430\u0431\u043e\u0442\u044b \u0438\u043d\u0434\u043a\u0441\u043e\u0432 \u0411\u0414 \u0438 \u0442\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438, \u043d\u0430 \u043a\u0430\u043a\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u0430\u044f \u043a\u043e\u043f\u0438\u044f \u0411\u0414, \u0434\u0430\u0442\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u043a\u043e\u043f\u0438\u0438 \u0438 \u0442\u0435\u043a\u0443\u0449\u0430\u044f \u043e\u0447\u0435\u0440\u0435\u0434\u044c  <code>Get-MailboxDatabaseCopyStatus -Identity $db_name\\* | Format-List Name,ContentIndexState</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043a\u043e\u043f\u0438\u0439 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0411\u0414 \u043d\u0430 \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445, \u0438 \u0441\u0442\u0430\u0442\u0443\u0441 \u0438\u0445 \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u0432, \u0435\u0441\u043b\u0438 \u0443 \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0441\u0442\u0430\u0442\u0443\u0441 Healthy, \u043c\u043e\u0436\u043d\u043e \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u0437 \u043d\u0435\u0433\u043e  <code>Get-MailboxDatabaseCopyStatus -Identity $db_name\\EXCH-MX-04 | Update-MailboxDatabaseCopy -SourceServer EXCH-MX-01 -CatalogOnly</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0411\u0414 \u0438\u0437 \u043a\u043e\u043f\u0438\u0438  <code>cd %PROGRAMFILES%\\Microsoft\\Exchange Server\\V14\\Scripts</code> \u0438\u043b\u0438 v15 \u0434\u043b\u044f Exchange 2016  <code>.\\ResetSearchIndex.ps1 $db_name</code> \u0441\u043a\u0440\u0438\u043f\u0442 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0438\u043d\u0434\u0435\u043a\u0441\u0430</p> <p><code>Get-MailboxDatabaseCopyStatus * | where {$_.ContentIndexState -eq \"Failed\" -or $_.ContentIndexState -eq \"FailedAndSuspended\"}</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0443 \u043a\u0430\u043a\u043e\u0439 \u0411\u0414 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u0435\u043b \u0441\u0431\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b (FailedAndSuspended) \u0438\u043b\u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0430 (ContentIndexState)</p>"},{"location":"FileSystem/","title":"File System","text":""},{"location":"FileSystem/#items","title":"Items","text":"<p><code>Get-Content $home/desktop\\test.txt -Wait</code> \u0430\u043d\u0430\u043b\u043e\u0433 tail  <code>Test-Path $path</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u043f\u0443\u0442\u0438  <code>Get-FileHash -Algorithm SHA256 \"$path\"</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0445\u044d\u0448 \u0444\u0430\u0439\u043b\u0430 \u043f\u043e \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0443 sha256  <code>Get-ChildItem $path -Filter *.txt -Recurse</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 (Alias: ls/gci/dir) \u0438 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u0432 (-Recurse) \u0438 \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434  <code>Get-Location</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u043c\u0435\u0441\u0442\u043e\u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 (Alias: pwd/gl)  <code>Set-Location $path</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u043f\u043e \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430\u043c (Alias: cd/sl)  <code>Invoke-Item $path</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0444\u0430\u0439\u043b (Alias: ii/start)  <code>Get-ItemProperty $env:userprofile\\Documents\\dns-list.txt | select FullName,Directory,Name,BaseName,Extension</code> \u0441\u0432\u043e\u0439\u0442\u0441\u0432\u0430 \u0444\u0430\u0439\u043b\u0430  <code>Get-ItemProperty -Path $path\\* | select FullName,CreationTime,LastWriteTime</code> \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430 \u0444\u0430\u0439\u043b\u043e\u0432 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438, \u0434\u0430\u0442\u0430 \u0438\u0445 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f  <code>New-Item -Path \"C:\\test\\\" -ItemType \"Directory\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e (Alias: mkdir/md)  <code>New-Item -Path \"C:\\test\\file.txt\" -ItemType \"File\" -Value \"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u0435\u043a\u0441\u0442 \u0432 \u0444\u0430\u0439\u043b\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0430\u0439\u043b  <code>\"test\" &gt; \"C:\\test\\file.txt\"</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435  <code>\"test\" &gt;&gt; \"C:\\test\\file.txt\"</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443 \u0432 \u0444\u0430\u0439\u043b  <code>New-Item -Path \"C:\\test\\test\\file.txt\" -Force</code> \u043a\u043b\u044e\u0447 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u0432 \u043f\u0443\u0442\u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439 \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u0438 \u0444\u0430\u0439\u043b\u0430 \u0435\u0441\u043b\u0438 \u043e\u043d \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442  <code>Move-Item</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 (Alias: mv/move)  <code>Remove-Item \"$path\\\" -Recurse</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430, \u0431\u0435\u0437 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043f\u043e\u0434\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f (Alias: rm/del)  <code>Remove-Item $path -Recurse -Include \"*.txt\",\"*.temp\" -Exclude \"log.txt\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u0441 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435\u043c txt \u0438 temp ([Array]), \u043a\u0440\u043e\u043c\u0435 log.txt  <code>Rename-Item \"C:\\test\\*.*\" \"*.jpg\"</code> \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c \u0444\u0430\u0439\u043b\u044b \u043f\u043e \u043c\u0430\u0441\u043a\u0435 (Alias: ren)  <code>Copy-Item</code> \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u043e\u0432 \u0438 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u0432 (Alias: cp/copy)  <code>Copy-Item -Path \"\\\\server-01\\test\" -Destination \"C:\\\" -Recurse</code> \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u0441 \u0435\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u044b\u043c (-Recurse)  <code>Copy-Item -Path \"C:\\*.txt\" -Destination \"C:\\test\\\"</code> \u0437\u043d\u0430\u043a '\\' \u0432 \u043a\u043e\u043d\u0446\u0435 Destination \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0430 \u043f\u0430\u043f\u043a\u0438 \u0432\u043d\u0443\u0442\u0440\u044c \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439, \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0435, \u0447\u0442\u043e \u044d\u0442\u043e \u043d\u043e\u0432\u043e\u0435 \u0438\u043c\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438  <code>Copy-Item -Path \"C:\\*\" -Destination \"C:\\test\\\" -Include '*.txt','*.jpg'</code> \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435\u043c (Include)  <code>Copy-Item -Path \"C:\\*\" -Destination \"C:\\test\\\" -Exclude '*.jpeg'</code> \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442\u044b, \u0437\u0430 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c \u0444\u0430\u0439\u043b\u043e\u0432 \u0441 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435\u043c (Exclude)  <code>$log = Copy-Item \"C:\\*.txt\" \"C:\\test\\\" -PassThru</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (\u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435) \u0432 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e, \u043c\u043e\u0436\u043d\u043e \u0437\u0430\u0431\u0438\u0440\u0430\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0438 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u0432 $log[0].FullName  <code>Unblock-File \"script.ps1\"</code> \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u0443\u0435\u0442 \u0444\u0430\u0439\u043b\u044b \u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0432 PowerShell \u0441\u043a\u0430\u0447\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0430, \u0447\u0442\u043e\u0431\u044b \u0438\u0445 \u043c\u043e\u0436\u043d\u043e \u0431\u044b\u043b\u043e \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c, \u0434\u0430\u0436\u0435 \u0435\u0441\u043b\u0438 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f PowerShell \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 RemoteSigned</p>"},{"location":"FileSystem/#clear-env-temp-14-days","title":"Clear-env-Temp-14-days","text":"<pre><code>$ls = Get-Item $env:TEMP\\*.tmp # \u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435\u043c\n$date = (Get-Date).AddDays(-14)\nforeach ($l in $ls) {\n    if ($l.LastWriteTime -le $date) {\n        $l.FullName\n        Remove-Item $l.FullName -Recurse\n    }\n}\n</code></pre>"},{"location":"FileSystem/#systemiofile","title":"System.IO.File","text":"<p><code>$file = [System.IO.File]::Create(\"$home\\desktop\\test.txt\")</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0430\u0439\u043b  <code>$file.Close()</code> \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u0444\u0430\u0439\u043b  <code>[System.IO.File]::ReadAllLines(\"$home\\desktop\\test.txt\")</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0444\u0430\u0439\u043b  <code>$file = New-Object System.IO.StreamReader(\"$home\\desktop\\test.txt\")</code> \u0444\u0430\u0439\u043b \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043d\u044f\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c PowerShell  <code>$file | Get-Member</code> <code>$file.ReadLine()</code> \u043f\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434  <code>$file.ReadToEnd()</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0446\u0435\u043b\u0438\u043a\u043e\u043c</p>"},{"location":"FileSystem/#readwrite-bytes","title":"Read/Write Bytes","text":"<p><code>$file = [io.file]::ReadAllBytes(\"$home\\desktop\\powershell.jpg\")</code> \u043c\u0435\u0442\u043e\u0434 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0434\u0432\u043e\u0438\u0447\u043d\u044b\u0439 \u0444\u0430\u0439\u043b, \u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u0442 \u0435\u0433\u043e \u0432 \u043c\u0430\u0441\u0441\u0438\u0432 \u0431\u0430\u0439\u0442 \u0438 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0444\u0430\u0439\u043b  <code>[io.file]::WriteAllBytes(\"$home\\desktop\\tloztotk-2.jpg\",$file)</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0431\u0430\u0439\u0442\u044b \u0432 \u0444\u0430\u0439\u043b (\u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u043b\u044f \u0432\u044b\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0432\u043e\u0438\u0447\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u0438\u0437 \u0411\u0414)</p>"},{"location":"FileSystem/#archive","title":"Archive","text":""},{"location":"FileSystem/#microsoftpowershellarchive","title":"Microsoft.PowerShell.Archive","text":"<p><code>Compress-Archive -Path $srcPath -DestinationPath \"$($srcPath).zip\" -CompressionLevel Optimal</code> \u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c (\u043f\u043e \u0438\u0441\u0445\u043e\u0434\u043d\u043e\u043c\u0443 \u043f\u0443\u0442\u0438 \u0438 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0441 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f)  <code>Expand-Archive -Path $zip</code> \u0440\u0430\u0437\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c  <code>Expand-Archive -Path $zip -DestinationPath $dstPath</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0443\u0442\u044c \u0438\u0437\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u044f  <code>Expand-Archive -Path $zip -OutputPath $dstPath</code></p>"},{"location":"FileSystem/#systemiocompressionfilesystem","title":"System.IO.Compression.FileSystem","text":"<pre><code>function Expand-ArchiveFile {\n    param (\n        # \u041f\u0443\u0442\u044c \u043a \u0430\u0440\u0445\u0438\u0432\u0443\n        $Path,\n        # \u041f\u0443\u0442\u044c, \u043a\u0443\u0434\u0430 \u0438\u0437\u0432\u043b\u0435\u0447\u044c \u0444\u0430\u0439\u043b\n        $DestinationPath,\n        # \u0418\u043c\u044f \u0444\u0430\u0439\u043b\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0443\u0436\u043d\u043e \u0438\u0437\u0432\u043b\u0435\u0447\u044c\n        $FileName\n    )\n    Add-Type -AssemblyName System.IO.Compression.FileSystem\n    try {\n        # \u041e\u0442\u043a\u0440\u044b\u0442\u044c \u0430\u0440\u0445\u0438\u0432 \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f\n        $zipArchive = [System.IO.Compression.ZipFile]::OpenRead($Path)\n        # \u041d\u0430\u0439\u0442\u0438 \u0444\u0430\u0439\u043b \u0432 \u0430\u0440\u0445\u0438\u0432\u0435\n        $fileEntry = $zipArchive.Entries | Where-Object { $_.FullName -eq $fileName }\n        if ($fileEntry) {\n            # \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u043e\u0442\u043e\u043a\u0430 \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430\n            $stream = $fileEntry.Open()\n            # \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u0430 \u0438 \u0437\u0430\u043f\u0438\u0441\u044c \u0432 \u043d\u0435\u0433\u043e \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u043f\u043e\u0442\u043e\u043a\u0430\n            $DestinationPathFileName = \"$DestinationPath\\$FileName\"\n            $fileStream = [System.IO.File]::Create($DestinationPathFileName)\n            $stream.CopyTo($fileStream)\n            # \u0417\u0430\u043a\u0440\u044b\u0442\u0438\u0435 \u043f\u043e\u0442\u043e\u043a\u043e\u0432\n            $stream.Close()\n            $fileStream.Close()\n        } else {\n            Write-Output \"\u0424\u0430\u0439\u043b $fileName \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 \u0430\u0440\u0445\u0438\u0432\u0435\"\n        }\n    } catch {\n        Write-Error \"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u0437\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u0438 \u0444\u0430\u0439\u043b\u0430 \u0438\u0437 \u0430\u0440\u0445\u0438\u0432\u0430\"\n    } finally {\n        # \u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0430\u0440\u0445\u0438\u0432\n        $zipArchive.Dispose()\n    }\n}\n</code></pre>"},{"location":"FileSystem/#winrar","title":"WinRAR","text":"<pre><code>function Expand-ArchivePassword {\n    param (\n        $Path,\n        $Password\n    )\n    $winrar =  \"C:\\Program Files\\WinRAR\\WinRAR.exe\"\n    &amp; $winrar x -p\"$Password\" $Path\n}\n</code></pre> <p><code>cd \"$home\\Downloads\"</code> <code>Expand-ArchivePassword archive.rar qwe123</code></p>"},{"location":"FileSystem/#handle","title":"Handle","text":"<p><code>$url = \"https://download.sysinternals.com/files/Handle.zip\"</code> <code>Invoke-RestMethod $url -OutFile \"$env:TEMP\\handle.zip\"</code> <code>Expand-ArchiveFile -Path \"$env:TEMP\\handle.zip\" -DestinationPath \"$home\\Documents\" -FileName \"handle.exe\"</code> \u0438\u0437\u0432\u043b\u0435\u043a\u0430\u0435\u043c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u0438\u0437 \u0430\u0440\u0445\u0438\u0432\u0430  <code>Remove-Item \"$env:TEMP\\handle.zip\"</code> <code>$handle = \"$home\\Documents\\handle.exe\"</code> <code>$test = New-Object System.IO.StreamReader(\"$home\\desktop\\test.txt\")</code> \u0437\u0430\u043d\u044f\u0442\u044c \u0444\u0430\u0439\u043b \u0442\u0435\u043a\u0443\u0449\u0438\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c pwsh ($pid)  <code>$SearchProcess = &amp; $handle \"C:\\Users\\Lifailon\\Desktop\\test.txt\" -nobanner -u -v | ConvertFrom-Csv</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u043e\u0432 \u043f\u043e \u043f\u0443\u0442\u0438 \u043a \u0444\u0430\u0439\u043b\u0443 (\u0438\u043c\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430, \u0435\u0433\u043e PID \u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u043b)  <code>Stop-Process $SearchProcess.PID</code> \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0443\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u043b \u0444\u0430\u0439\u043b</p>"},{"location":"FileSystem/#pseverything","title":"PSEverything","text":"<p><code>Install-Module PSEverything -Repository NuGet</code> <code>Find-Everything pingui</code> \u043d\u0430\u0439\u0442\u0438 \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 (\u043d\u0430 \u0432\u0441\u0435\u0445 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u0434\u0438\u0441\u043a\u0430\u0445) \u0441 \u0438\u043c\u0435\u043d\u0435\u043c pingui \u0447\u0435\u0440\u0435\u0437 dll csharp \u0432\u0435\u0440\u0441\u0438\u0438 Everything (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e)  <code>Find-Everything pingui-0.1.py | Format-List</code> <code>Find-Everything pingui -es</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c cli \u0432\u0435\u0440\u0441\u0438\u044e Everything \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430 (\u043f\u0440\u0438 \u043f\u0435\u0440\u0432\u043e\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 \u0432\u0435\u0440\u0441\u0438\u0438, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0434\u043e\u0436\u0434\u0430\u0442\u044c\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0444\u0430\u0439\u043b\u043e\u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439)  <code>Find-Everything pingui-0.1 -ComputerName localhost</code> \u043f\u043e\u0438\u0441\u043a \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0435 \u0447\u0435\u0440\u0435\u0437 REST API, \u0435\u0441\u043b\u0438 \u0437\u0430\u043f\u0443\u0449\u0435\u043d HTTP-\u0441\u0435\u0440\u0432\u0435\u0440 Everything</p>"},{"location":"FileSystem/#console-menu","title":"Console-Menu","text":"<pre><code># \u0418\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u043c \u043c\u043e\u0434\u0443\u043b\u044c PS-Menu \u0432 \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0441\u0435\u0441\u0441\u0438\u044e \u0438\u0437 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f GitHub\n$module = \"https://raw.githubusercontent.com/chrisseroka/ps-menu/master/ps-menu.psm1\"\nInvoke-Expression $(Invoke-RestMethod $module)\n</code></pre> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u0438 \u043f\u043e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f\u043c \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043c\u0435\u043d\u044e:</p> <pre><code>function ls-menu {\n    param (\n        $startDir = \"C:\\\"\n    )\n    clear\n    # \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c, \u0447\u0442\u043e \u043c\u044b \u043d\u0435 \u043d\u0430\u0445\u043e\u0434\u0438\u043c\u0441\u044f \u0432 root \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 (\u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0432\u043e\u0437\u0432\u0440\u0430\u0442 \u043d\u0430\u0437\u0430\u0434)\n    if ([System.IO.Path]::GetPathRoot($startDir) -eq $startDir) {\n        $select = menu @(\n            @($(Get-ChildItem $startDir).name)\n        )\n    }\n    else {\n        $select = menu @(\n            @(\"..\")+@($(Get-ChildItem $startDir).name)\n        )\n    }\n    # \u0415\u0441\u043b\u0438 \u0432\u044b\u0431\u0440\u0430\u043b\u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0442 \u043d\u0430\u0437\u0430\u0434, \u0442\u043e \u0437\u0430\u0431\u0438\u0440\u0430\u0435\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0443\u0442\u044c \u0443 \u0441\u0442\u0430\u0440\u0442\u043e\u0432\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438\n    if ($select -eq \"..\") {\n        $backPath = [System.IO.Path]::GetDirectoryName($startDir)\n        ls-menu $backPath\n    }\n    else {\n        # \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c, \u0447\u0442\u043e \u0432\u044b\u0431\u0440\u0430\u043b\u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e\n        if ($(Test-Path \"$startDir\\$select\" -PathType Container)) {\n            # \u0415\u0441\u043b\u0438 \u0432\u044b\u0431\u0440\u0430\u043b\u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e, \u043a \u0441\u0442\u0430\u0440\u0442\u043e\u0432\u043e\u043c\u0443 \u043f\u0443\u0442\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0435 \u0438\u043c\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438\n            ls-menu \"$startDir\\$select\"\n        }\n        else {\n            ls-menu $startDir\n        }\n    }\n}\n</code></pre> <p><code>ls-menu</code> <code>ls-menu $home</code> <code>ls-menu \"D:\\\"</code></p>"},{"location":"FileSystem/#smb","title":"SMB","text":"<p><code>Get-SmbServerConfiguration</code> <code>Set-SmbServerConfiguration -EnableSMB1Protocol $false -Force</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b SMB v1  <code>Get-WindowsFeature | Where-Object {$_.name -eq \"FS-SMB1\"} | ft Name,Installstate</code> \u043c\u043e\u0434\u0443\u043b\u044c ServerManager, \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u043b\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 SMB1  <code>Install-WindowsFeature FS-SMB1</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c SMB1  <code>Uninstall-WindowsFeature \u2013Name FS-SMB1 \u2013Remove</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c SMB1 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 (\u043f\u043e\u043d\u0430\u0434\u043e\u0431\u0438\u0442\u0441\u044f \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430)  <code>Get-WindowsOptionalFeature -Online</code> \u043c\u043e\u0434\u0443\u043b\u044c DISM, \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438 Windows  <code>Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol -Remove</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c SMB1  <code>Set-SmbServerConfiguration \u2013AuditSmb1Access $true</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0443\u0434\u0438\u0442 SMB1  <code>Get-SmbConnection</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0441\u0435\u0441\u0441\u0438\u0439 \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f SMB (Dialect)  <code>Get-SmbOpenFile | select ClientUserName,ClientComputerName,Path,SessionID</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432  <code>Get-SmbShare</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u043f\u0430\u043f\u043e\u043a  <code>New-SmbShare -Name xl-share -Path E:\\test</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u043e\u0431\u0449\u0443\u044e \u0441\u0435\u0442\u0435\u0432\u0443\u044e \u043f\u0430\u043f\u043a\u0443 (\u0440\u0430\u0441\u0448\u0430\u0440\u0438\u0442\u044c)  <code>-EncryptData $True</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u0435 SMB  <code>-Description</code> \u0438\u043c\u044f \u0432 \u0441\u0435\u0442\u0435\u0432\u043e\u043c \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0438  <code>-ReadAccess \"domain\\username\"</code> \u0434\u043e\u0441\u0442\u0443\u043f \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435  <code>-ChangeAccess</code> \u0434\u043e\u0441\u0442\u0443\u043f \u043d\u0430 \u0437\u0430\u043f\u0438\u0441\u044c  <code>-FullAccess</code> \u043f\u043e\u043b\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f  <code>-NoAccess ALL</code> \u043d\u0435\u0442 \u043f\u0440\u0430\u0432  <code>-FolderEnumerationMode [AccessBased | Unrestricted]</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u043a\u0440\u044b\u0442\u044c \u0432 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u043f\u0430\u043f\u043a\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e Access-Based Enumeration (ABE)  <code>Get-SmbShare xl-share | Set-SmbShare -FolderEnumerationMode AccessBased</code> \u043a\u043b\u044e\u0447\u0438\u0442\u044c ABE \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0440\u0430\u0441\u0448\u0430\u0440\u0435\u043d\u043d\u044b\u0445 \u043f\u0430\u043f\u043e\u043a  <code>Remove-SmbShare xl-share -force</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0434\u043e\u0441\u0442\u0443\u043f (\u0448\u0430\u0440\u0443)  <code>Get-SmbShareAccess xl-share</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u0432 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u043a \u0448\u0430\u0440\u0435  <code>Revoke-SmbShareAccess xl-share -AccountName Everyone \u2013Force</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u0432  <code>Grant-SmbShareAccess -Name xl-share -AccountName \"domain\\XL-Share\" -AccessRight Change \u2013force</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c/\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043d\u0430 \u0437\u0430\u043f\u0438\u0441\u044c (Full,Read)  <code>Grant-SmbShareAccess -Name xl-share -AccountName \"\u0432\u0441\u0435\" -AccessRight Change \u2013force</code> <code>Block-SmbShareAccess -Name xl-share -AccountName \"domain\\noAccess\" -Force</code> \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0437\u0430\u043f\u0440\u0435\u0442  <code>New-SmbMapping -LocalPath X: -RemotePath \\\\$srv\\xl-share -UserName support4 -Password password \u2013Persistent $true</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0434\u0438\u0441\u043a  <code>-Persistent</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u0441\u043b\u0435 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0438\u043b\u0438 \u0441\u0435\u0442\u0438  <code>-SaveCredential</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0443\u0447\u0435\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0432 \u0434\u0438\u0441\u043f\u0435\u0442\u0447\u0435\u0440 \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 Windows Credential Manager  <code>Stop-Process -Name \"explorer\" | Start-Process -FilePath \"C:\\Windows\\explorer.exe\"</code> \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0432 \u043f\u0440\u043e\u0432\u043e\u0434\u043d\u0438\u043a\u0435  <code>Get-SmbMapping</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0434\u0438\u0441\u043a\u043e\u0432  <code>Remove-SmbMapping X: -force</code> \u043e\u0442\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0434\u0438\u0441\u043a  <code>$CIMSession = New-CIMSession \u2013Computername $srv</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0435\u0430\u043d\u0441 CIM (\u0430\u0443\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u043d\u0430 SMB)  <code>Get-SmbOpenFile -CIMSession $CIMSession | select ClientUserName,ClientComputerName,Path | Out-GridView -PassThru | Close-SmbOpenFile -CIMSession $CIMSession -Confirm:$false \u2013Force</code> \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u0444\u0430\u0439\u043b\u044b (\u043e\u0442\u043a\u0440\u044b\u0442\u044c \u043a \u043d\u0438\u043c \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0434\u043e\u0441\u0442\u0443\u043f)</p>"},{"location":"FileSystem/#acl","title":"ACL","text":"<p><code>(Get-Acl \\\\$srv\\xl-share).access</code> \u0434\u043e\u0441\u0442\u0443\u043f ACL \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 NTFS  <code>Get-Acl C:\\Drivers | Set-Acl C:\\Distr</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c NTFS \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0441 \u043e\u0434\u043d\u043e\u0439 \u043f\u0430\u043f\u043a\u0438 \u0438 \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u0445 \u043d\u0430 \u0434\u0440\u0443\u0433\u0443\u044e</p>"},{"location":"FileSystem/#ntfs","title":"NTFS","text":"<p><code>Install-Module -Name NTFSSecurity -force</code> <code>Get-Item \"\\\\$srv\\xl-share\" | Get-NTFSAccess</code> <code>Add-NTFSAccess -Path \"\\\\$srv\\xl-share\" -Account \"domain\\xl-share\" -AccessRights Fullcontrol -PassThru</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c  <code>Remove-NTFSAccess -Path \"\\\\$srv\\xl-share\" -Account \"domain\\xl-share\" -AccessRights FullControl -PassThru</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c  <code>Get-ChildItem -Path \"\\\\$srv\\xl-share\" -Recurse -Force | Clear-NTFSAccess</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f, \u0431\u0435\u0437 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0443\u043d\u0430\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439  <code>Get-ChildItem -Path \"\\\\$srv\\xl-share\" -Recurse -Force | Enable-NTFSAccessInheritance</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c NTFS \u043d\u0430\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435</p>"},{"location":"FileSystem/#storage","title":"Storage","text":"<p><code>Get-Command -Module Storage</code> <code>Get-Disk</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0434\u0438\u0441\u043a\u043e\u0432  <code>Get-Partition</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b\u044b \u043d\u0430 \u0432\u0441\u0435\u0445 \u0434\u0438\u0441\u043a\u0430\u0445  <code>Get-Volume</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043b\u043e\u0433\u0438\u0447\u043a\u0438\u0445 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432  <code>Get-PhysicalDisk</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0434\u0438\u0441\u043a\u043e\u0432  <code>Initialize-Disk 1 \u2013PartitionStyle MBR</code> \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0438\u0441\u043a  <code>New-Partition -DriveLetter D \u2013DiskNumber 1 -Size 500gb</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b (\u0432\u044b\u0434\u0435\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u043c\u0435\u0441\u0442\u043e -UseMaximumSize)  <code>Format-Volume -DriveLetter D -FileSystem NTFS -NewFileSystemLabel Disk-D</code> \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b  <code>Set-Partition -DriveLetter D -IsActive $True</code> \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u043c  <code>Remove-Partition -DriveLetter D \u2013DiskNumber 1</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b  <code>Clear-Disk -Number 1 -RemoveData</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0434\u0438\u0441\u043a  <code>Repair-Volume \u2013driveletter C \u2013Scan</code> Check disk  <code>Repair-Volume \u2013driveletter C \u2013SpotFix</code> <code>Repair-Volume \u2013driverletter C -Scan \u2013Cimsession $CIMSession</code></p>"},{"location":"FileSystem/#iscsi","title":"iSCSI","text":"<p><code>New-IscsiVirtualDisk -Path D:\\iSCSIVirtualDisks\\iSCSI2.vhdx -Size 20GB</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0439 vhdx-\u0434\u0438\u0441\u043a (\u0434\u043b\u044f \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430 -UseFixed)  <code>New-IscsiServerTarget -TargetName iscsi-target-2 -InitiatorIds \"IQN:iqn.1991-05.com.microsoft:srv3.contoso.com\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c Target  <code>Get-IscsiServerTarget | fl TargetName, LunMappings</code> <code>Connect-IscsiTarget -NodeAddress \"iqn.1995-05.com.microsoft:srv2-iscsi-target-2-target\" -IsPersistent $true</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u0438\u043d\u0438\u0446\u0438\u0430\u0442\u043e\u0440\u043e\u043c \u043a \u0442\u0430\u0440\u0433\u0435\u0442\u0443  <code>Get-IscsiTarget | fl</code> <code>Disconnect-IscsiTarget -NodeAddress \"iqn.1995-05.com.microsoft:srv2-iscsi-target-2-target\" -Confirm:$false</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f</p>"},{"location":"FileSystem/#base64","title":"Base64","text":""},{"location":"FileSystem/#utf8","title":"UTF8","text":"<p><code>$loginPassword = \"login:password\"</code> <code>$Base64 = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($loginPassword))</code> \u0437\u0430\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043b\u043e\u0433\u0438\u043d \u0438 \u043f\u0430\u0440\u043e\u043b\u044c \u0432 \u0441\u0442\u0440\u043e\u043a\u0443 Base64  <code>[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($Base64))</code> \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u0432 \u0431\u0430\u0439\u0442\u044b \u0438 \u043e\u0431\u0440\u0430\u0442\u043d\u043e \u0434\u0435\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0438\u0441\u0445\u043e\u0434\u043d\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e UTF-8 \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u043a\u0438</p>"},{"location":"FileSystem/#unicode","title":"Unicode","text":"<pre><code>$text = \"password\"\n$byte = [System.Text.Encoding]::Unicode.GetBytes($text) # \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u0442 \u0441\u0442\u0440\u043e\u043a\u0443 $text \u0432 \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u0430\u0439\u0442\u043e\u0432, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u043a\u0443 Unicode\n$base64 = [System.Convert]::ToBase64String($byte) # \u0431\u0430\u0439\u0442\u044b \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0432 \u0441\u0442\u0440\u043e\u043a\u0443 Base64 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043c\u0435\u0442\u043e\u0434\u0430 ToBase64String\n$decode_base64 = [System.Convert]::FromBase64String($base64) # \u0434\u0435\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443 Base64 \u043e\u0431\u0440\u0430\u0442\u043d\u043e \u0432 \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u0430\u0439\u0442\u043e\u0432 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043c\u0435\u0442\u043e\u0434\u0430 FromBase64String\n$decode_string = [System.Text.Encoding]::Unicode.GetString($decode_base64) # \u0437\u0430\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0431\u0430\u0439\u0442\u044b \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u044e\u0442\u0441\u044f \u043e\u0431\u0440\u0430\u0442\u043d\u043e \u0432 \u0441\u0442\u0440\u043e\u043a\u0443 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u043a\u0438 Unicode \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043c\u0435\u0442\u043e\u0434\u0430 GetString\n</code></pre>"},{"location":"FileSystem/#image","title":"Image","text":"<pre><code>$path_image = \"$home\\Documents\\1200x800.jpg\"\n$BBase64 = [System.Convert]::ToBase64String((Get-Content $path_image -Encoding Byte))\nAdd-Type -assembly System.Drawing\n$Image = [System.Drawing.Bitmap]::FromStream([IO.MemoryStream][Convert]::FromBase64String($BBase64))\n$Image.Save(\"$home\\Desktop\\1200x800.jpg\")\n</code></pre>"},{"location":"FileSystem/#veeam","title":"Veeam","text":"<p>VeeamHub (https://github.com/VeeamHub/powershell)</p>"},{"location":"FileSystem/#get-vbrcommand","title":"Get-VBRCommand","text":"<p><code>Set-ExecutionPolicy AllSigned</code> <code>Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c choco  <code>choco install veeam-backup-and-replication-console</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u0441\u043e\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f (https://community.chocolatey.org/packages/veeam-backup-and-replication-console)  <code>Get-Module Veeam.Backup.PowerShell</code> \u043c\u043e\u0434\u0443\u043b\u044c, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0439 \u043a\u043e\u043d\u0441\u043e\u043b\u044c\u044e \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e  <code>Get-Command -Module Veeam.Backup.PowerShell</code> <code>Get-Command -Module Get-VBRCommand</code> <code>Connect-VBRServer -Server $srv -Credential $cred -Port 9392</code> <code>Get-VBRJob</code> <code>Get-VBRCommand *get*backup*</code> <code>Get-VBRComputerBackupJob</code> <code>Get-VBRBackup</code> <code>Get-VBRBackupRepository</code> <code>Get-VBRBackupSession</code> <code>Get-VBRBackupServerCertificate</code> <code>Get-VBRRestorePoint</code> <code>Get-VBRViProxy</code></p>"},{"location":"FileSystem/#veeam-restat","title":"Veeam-REStat","text":"<pre><code>$path = ($env:PSModulePath.Split(\";\")[0])+\"\\Veeam-REStat\\Veeam-REStat.psm1\"\nif (!(Test-Path $path)) {\n    New-Item $path -ItemType \"File\" -Force\n}\n$(iwr https://raw.githubusercontent.com/Lifailon/Veeam-REStat/rsa/Veeam-REStat/Veeam-REStat.psm1).Content | Out-File $path -Force\n</code></pre> <p><code>Veeam-REStat -Server srv-veeam-11 -Port 9419</code> \u043f\u0440\u0438 \u043f\u0435\u0440\u0432\u043e\u043c \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c Credential \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 VBR, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044e\u0442\u0441\u044f \u0432 \u0444\u0430\u0439\u043b \u0441 \u0438\u043c\u0435\u043d\u0435\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 xml \u0441 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435\u043c \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u044f PSCredential \u0434\u043b\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0433\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f  <code>Veeam-REStat -Reset</code> \u0441\u0431\u0440\u043e\u0441 \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 VBR  <code>Veeam-REStat -Statistic</code> \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0432\u0441\u0435\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439 \u0441 \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u043e\u0439 \u043f\u043e \u0434\u0430\u0442\u0435 (\u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0432\u0440\u0435\u043c\u044f \u043d\u0430\u0447\u0430\u043b\u0430, \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0438 \u0441\u0442\u0430\u0442\u0443\u0441 \u0440\u0430\u0431\u043e\u0442\u044b, \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430, \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0439 \u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0441 \u043f\u0440\u0438\u0447\u0438\u043d\u043e\u0439 \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u043e\u0448\u0438\u0431\u043a\u0438: Warning \u0438\u043b\u0438 Failed)  <code>Veeam-REStat -Jobs</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u0432\u0441\u0435\u043c \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u044f\u043c \u0440\u0435\u0437\u0435\u0432\u0440\u043d\u043e\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f: \u0441\u0442\u0430\u0442\u0443\u0441 \u0440\u0430\u0431\u043e\u0442\u044b (In Active/disabled), \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0437\u0430\u0434\u0430\u043d\u0438\u044f (LastResult), \u0442\u0438\u043f \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 (Standard/Linux), \u0438\u043c\u044f \u0438 \u0440\u0430\u0437\u043c\u0435\u0440 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b, \u0442\u0438\u043f \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, Incremental), \u0434\u0430\u0442\u0443 \u0438 \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0438 \u0441\u043b\u0435\u0434\u0443\u0449\u0435\u0433\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f  <code>Veeam-REStat -ConfigBackup</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u0442\u0430\u0442\u0443\u0441 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 VBR, \u043a\u043e\u043b-\u0432\u043e \u0442\u043e\u0447\u0435\u043a \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f, \u0434\u0430\u0442\u0443 \u0438 \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u043a\u043e\u043f\u0438\u0438  <code>Veeam-REStat -Repositories</code> \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u043c \u0434\u0430\u043d\u043d\u044b\u043c \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0435\u0432: \u0442\u0438\u043f \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430, \u043f\u0443\u0442\u044c \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0434\u043e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f, \u043e\u0431\u0449\u0438\u0439 (capacityGB), \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u044b\u0439 (freeGB) \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0439 (usedSpaceGB) \u0440\u0430\u0437\u043c\u0435\u0440 \u0434\u0438\u0441\u043a\u0430 \u043f\u043e\u0434 \u0434\u0430\u043d\u043d\u044b\u0435  <code>Veeam-REStat -Backup</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u0434\u0430\u043d\u0438\u0439 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u0442\u0438\u043f \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (VM/Directory) \u0438 \u043a\u043e\u043b-\u0432\u043e \u0442\u043e\u0447\u0435\u043a \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f  <code>Veeam-REStat -Points</code> \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438 \u0432\u0441\u0435\u0445 \u0442\u043e\u0447\u0435\u043a \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441 \u0434\u0430\u0442\u043e\u0439 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f  <code>Veeam-REStat -Hosts</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438 (\u0432 \u0440\u0443\u0447\u043d\u0443\u044e) \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0445\u043e\u0441\u0442\u043e\u0432 \u0432 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 VBR  <code>Veeam-REStat -Proxy</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0441 \u0440\u043e\u043b\u044c\u044e Proxy  <code>Veeam-REStat -Users</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0423\u0417, \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c  <code>Veeam-REStat -Service</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0445 \u0441\u043b\u0443\u0436\u0431\u0430\u0445, \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u044d\u0442\u0438\u043c \u0441\u043b\u0443\u0436\u0431\u0430\u043c \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u0442\u0440\u0435\u0431\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441 VBR</p>"},{"location":"FileSystem/#nas","title":"NAS","text":""},{"location":"FileSystem/#truenas","title":"TrueNAS","text":"<p>PowerTrueNas</p> <p><code>Install-Module TrueNas</code> <code>Import-Module TrueNas</code> <code>$(Get-Module TrueNas).ExportedCommands</code> <code>Connect-TrueNasServer -Server tnas-01 -SkipCertificateCheck</code> <code>Get-TrueNasCertificate</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430  <code>Get-TrueNasSetting</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u044f\u0437\u044b\u043a\u0430, time zone, syslog level \u0438 server, https port  <code>Get-TrueNasUser</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439  <code>Get-TrueNasSystemVersion</code> \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438 (Physical Memory, Model, Cores) \u0438 Uptime  <code>Get-TrueNasSystemAlert</code> snmp \u0434\u043b\u044f \u043e\u043f\u043e\u0432\u0435\u0449\u0435\u043d\u0438\u0439  <code>Get-TrueNasSystemNTP</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 NTP \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432  <code>Get-TrueNasDisk</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430  <code>Get-TrueNasInterface</code> \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u044b  <code>Get-TrueNasGlobalConfig</code> \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438  <code>Get-TrueNasDnsServer</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 DNS-\u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>Get-TrueNasIscsiTarget</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c ID \u0433\u0440\u0443\u043f\u043f\u044b \u0438\u043d\u0438\u0446\u0438\u0430\u0442\u043e\u0440\u043e\u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0449\u0438\u0445 \u0442\u0430\u0440\u0433\u0435\u0442, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0439 portal, authentification \u0438 authen-method  <code>Get-TrueNasIscsiInitiator</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u044b \u0438\u043d\u0438\u0446\u0438\u0430\u0442\u043e\u0440\u043e\u0432  <code>Get-TrueNasIscsiPortal</code> \u0441\u043b\u0443\u0448\u0430\u0442\u0435\u043b\u044c (Listen) \u0438 \u043f\u043e\u0440\u0442  <code>Get-TrueNasIscsiExtent</code> \u0441\u043f\u0438\u0441\u043e\u043a ISCSi Target (\u0441\u0442\u0430\u0442\u0443\u0441 \u0440\u0430\u0431\u043e\u0442\u044b, \u043f\u0443\u0442\u044c)  <code>Get-TrueNasPool</code> \u0441\u043f\u0438\u0441\u043e\u043a pool (Id, Path, Status, Healthy)  <code>Get-TrueNasVolume -Type FILESYSTEM</code> \u0441\u043f\u0438\u0441\u043e\u043a pool \u0444\u0430\u0439\u043b\u043e\u0432\u044b\u0445 \u0441\u0438\u0441\u0442\u0435\u043c  <code>Get-TrueNasVolume -Type VOLUME</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 \u0432 pool \u0438 \u0438\u0445 \u0440\u0430\u0437\u043c\u0435\u0440  <code>Get-TrueNasService | ft</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u043b\u0443\u0436\u0431 \u0438 \u0438\u0445 \u0441\u0442\u0430\u0442\u0443\u0441  <code>Start-TrueNasService ssh</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443  <code>Stop-TrueNasService ssh</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443</p>"},{"location":"FileSystem/#synology","title":"Synology","text":"<p>pSynology</p> <p><code>New-SYNOSession</code> \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u043d\u0430 Synology Diskstation \u0438 \u0437\u0430\u043f\u0443\u0441\u043a \u043d\u043e\u0432\u043e\u0433\u043e \u0441\u0435\u0430\u043d\u0441\u0430 API  <code>Close-SYNOSession</code> \u0432\u044b\u0445\u043e\u0434 \u0438\u0437 \u0441\u0435\u0430\u043d\u0441\u0430 API  <code>Get-SYNOInfo</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 API DiskStation  <code>Add-SYNOFSFAvorite</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0430\u043f\u043a\u0443 \u0432 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Add-SYNOFSFile</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b  <code>Clear-SYNOFSBackgroundTask</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u044b\u0435 \u0444\u043e\u043d\u043e\u0432\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438  <code>Clear-SYNOFSFavoriteStatus</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435 \u0441 \u043d\u0435\u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u043c \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u043c  <code>Clear-SYNOFSSharingLink</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0440\u043e\u0441\u0440\u043e\u0447\u0435\u043d\u043d\u044b\u0435 \u0438 \u043d\u0435\u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 \u0434\u043b\u044f \u043e\u0431\u043c\u0435\u043d\u0430  <code>Get-SYNOFSArchiveCompress</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u0434\u0430\u0447\u0438 \u0441\u0436\u0430\u0442\u0438\u044f  <code>Get-SYNOFSArchiveContent</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0430\u0440\u0445\u0438\u0432\u0430  <code>Get-SYNOFSArchiveExtract</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438\u0437\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u044f  <code>Get-SYNOFSBackgroundTask</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0444\u043e\u043d\u043e\u0432\u044b\u0445 \u0437\u0430\u0434\u0430\u0447, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435  <code>Get-SYNOFSCopy</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f  <code>Get-SYNOFSDeleteItem</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u0434\u0430\u0447\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f  <code>Get-SYNOFSDirSize</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u0434\u0430\u0447\u0438 \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u0440\u0430\u0437\u043c\u0435\u0440\u0430  <code>Get-SYNOFSFavorite</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Get-SYNOFSFile</code> \u043f\u0435\u0440\u0435\u0447\u0438\u0441\u043b\u0438\u0442\u044c \u0444\u0430\u0439\u043b\u044b \u0432 \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0439 \u043f\u0430\u043f\u043a\u0435  <code>Get-SYNOFSFileInfo</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0444\u0430\u0439\u043b\u0430\u0445 \u0438\u043b\u0438 \u0444\u0430\u0439\u043b\u0435  <code>Get-SYNOFSInfo</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0442\u0430\u043d\u0446\u0438\u0438  <code>Get-SYNOFSMD5</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0432\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438 MD5  <code>Get-SYNOFSSearch</code> \u043f\u0435\u0440\u0435\u0447\u0438\u0441\u043b\u0438\u0442\u044c \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0449\u0438\u0435 \u0444\u0430\u0439\u043b\u044b \u0432\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u0438\u0441\u043a\u0430  <code>Get-SYNOFSShare</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043e\u0431\u0449\u0438\u0445 \u043f\u0430\u043f\u043e\u043a  <code>Get-SYNOFSSharingLink</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0441\u044b\u043b\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043d\u0430 \u043e\u0431\u0449\u0438\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0444\u0430\u0439\u043b\u0430\u043c  <code>Get-SYNOFSSharingLinkInfo</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0441\u0441\u044b\u043b\u043a\u0435 \u043e\u0431\u0449\u0435\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043f\u043e \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u0443 \u0441\u0441\u044b\u043b\u043a\u0438 \u043e\u0431\u0449\u0435\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430  <code>Get-SYNOFSThumbnail</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043c\u0438\u043d\u0438\u0430\u0442\u044e\u0440\u0443 \u0444\u0430\u0439\u043b\u0430  <code>Get-SYNOFSVirtualFolder</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043f\u0430\u043f\u043e\u043a \u0442\u043e\u0447\u0435\u043a \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0438\u043f\u0430 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b  <code>New-SYNOFSFolder</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0430\u043f\u043a\u0443  <code>New-SYNOFSSharingLink</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043e\u0434\u043d\u0443 \u0438\u043b\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0441\u0441\u044b\u043b\u043e\u043a \u0434\u043b\u044f \u043e\u0431\u0449\u0435\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043f\u043e \u043f\u0443\u0442\u0438 \u043a \u0444\u0430\u0439\u043b \u0438\u043b\u0438 \u043f\u0430\u043f\u043a\u0443  <code>Remove-SYNOFSFAvorite</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0438\u0437 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Remove-SYNOFSItem</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0444\u0430\u0439\u043b \u0438\u043b\u0438 \u043f\u0430\u043f\u043a\u0443  <code>Remove-SYNOFSSearch</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u0438\u0441\u043a\u0430  <code>Remove-SYNOFSSharingLink</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043e\u0434\u043d\u0443 \u0438\u043b\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0441\u0441\u044b\u043b\u043e\u043a \u043e\u0431\u0449\u0435\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430  <code>Rename-SYNOFSItem</code> \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u044b\u0432\u0430\u0435\u043c \u0444\u0430\u0439\u043b \u0438\u043b\u0438 \u043f\u0430\u043f\u043a\u0443  <code>Save-SYNOFSFile</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b \u0438\u043b\u0438 \u043f\u0430\u043f\u043a\u0443  <code>Set-SYNOFSFAvorite</code> \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435 \u0438\u043c\u044f  <code>Set-SYNOFSSharingLink</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443 \u0434\u043b\u044f \u043e\u0431\u0449\u0435\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430  <code>Start-SYNOFSArchiveCompress</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u0441\u0436\u0430\u0442\u0438\u044f \u0444\u0430\u0439\u043b\u0430 \u0438\u043b\u0438 \u043f\u0430\u043f\u043a\u0438  <code>Start-SYNOFSArchiveExtract</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u0440\u0430\u0441\u043f\u0430\u043a\u043e\u0432\u043a\u0438 \u0430\u0440\u0445\u0438\u0432\u0430  <code>Start-SYNOFSCopy</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432  <code>Start-SYNOFSDeleteItem</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0438\u043b\u0438 \u043f\u0430\u043f\u043e\u043a  <code>Start-SYNOFSDirSize</code> \u0440\u0430\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0434\u043b\u044f \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u043b\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u043f\u0443\u0442\u0435\u0439 \u043a \u0444\u0430\u0439\u043b\u0430\u043c \u0438\u043b\u0438 \u043f\u0430\u043f\u043a\u0430\u043c  <code>Start-SYNOFSMD5</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c MD5 \u0444\u0430\u0439\u043b\u0430  <code>Start-SYNOFSSearch</code> \u043f\u043e\u0438\u0441\u043a \u0444\u0430\u0439\u043b\u043e\u0432 \u043f\u043e \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u043c \u043a\u0440\u0438\u0442\u0435\u0440\u0438\u044f\u043c  <code>Stop-SYNOFSArchiveCompress</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 \u0441\u0436\u0430\u0442\u0438\u044f  <code>Stop-SYNOFSArchiveExtract</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 \u0438\u0437\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u044f  <code>Stop-SYNOFSCopy</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f  <code>Stop-SYNOFSDeleteItem</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f  <code>Stop-SYNOFSDirSize</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u0430\u0441\u0447\u0435\u0442 \u0440\u0430\u0437\u043c\u0435\u0440\u0430  <code>Stop-SYNOFSMD5</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0435 MD5 \u0444\u0430\u0439\u043b\u0430  <code>Stop-SYNOFSSearch</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 \u043f\u043e\u0438\u0441\u043a\u0430  <code>Test-SYNOFSPermission</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u0438\u043c\u0435\u0435\u0442 \u043b\u0438 \u0432\u043e\u0448\u0435\u0434\u0448\u0438\u0439 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043d\u0430 \u0437\u0430\u043f\u0438\u0441\u044c \u0432 \u0434\u0430\u043d\u043d\u0443\u044e \u043f\u0430\u043f\u043a\u0443  <code>Update-SYNOFSFAvorite</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u044b\u0445 \u043f\u0430\u043f\u043e\u043a \u0432 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</p>"},{"location":"Linux/","title":"\ud83d\udc27 Linux Commands","text":"<p>\u0417\u0430\u043c\u0435\u0442\u043a\u0438 \u043f\u043e \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u043c\u0438 \u043a\u043e\u043c\u0430\u043d\u0434\u0430\u043c\u0438 \u0438 \u043a\u043e\u043d\u0441\u043e\u043b\u044c\u043d\u044b\u043c\u0438 \u0443\u0442\u0438\u043b\u0438\u0442\u0430\u043c\u0438 \ud83d\udc27 Linux.</p>"},{"location":"Linux/#filesystem","title":"filesystem","text":"<p><code>file Console-Performance.sh</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0442\u0438\u043f \u0444\u0430\u0439\u043b\u0430 (\u0442\u0435\u043a\u0441\u0442\u043e\u0432\u044b\u0439, \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u044b\u0439 \u0444\u0430\u0439\u043b, \u0430\u0440\u0445\u0438\u0432 \u0438\u043b\u0438 \u0434\u0440\u0443\u0433\u043e\u0439) <code>stat Console-Performance.sh</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430, \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0431\u043b\u043e\u043a\u043e\u0432, \u0437\u0430\u043d\u044f\u0442\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u043c \u043d\u0430 \u0434\u0438\u0441\u043a\u0435, \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0436\u0435\u0441\u0442\u043a\u0438\u0445 \u0441\u0441\u044b\u043b\u043e\u043a, \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043c\u0435\u0442\u043a\u0438  <code>pwd</code> \u0442\u0435\u043a\u0443\u0449\u0430\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f <code>ls -lh *</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u0434\u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e <code>ls -lhaF</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043a\u0440\u044b\u0442\u044b\u0435 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 (-a) \u0441 \u0442\u043e\u0447\u043a\u043e\u0439 \u0438 \u0432\u044b\u0434\u0435\u043b\u0438\u0442 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 (/) <code>which top</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043f\u0443\u0442\u044c \u0434\u043e \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 <code>stat $(which top)</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0434\u0430\u0442\u0443 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0444\u0430\u0439\u043b\u0443  <code>cat -n /etc/passwd</code> \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 \u0441 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435\u043c \u043d\u043e\u043c\u0435\u0440\u043e\u0432 \u0441\u0442\u0440\u043e\u043a <code>mkdir</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e <code>mktemp -d</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b/\u043a\u0430\u0442\u0430\u043b\u043e\u0433 (-d) <code>touch -t 202106222200.15 test.file</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0438 \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0434\u0430\u0442\u0443 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f <code>cp test.file test.file2</code> \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0444\u0430\u0439\u043b\u0430/\u043a\u0430\u0442\u0430\u043b\u043e\u0433 <code>mv test.file2 test.file3</code> \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c/\u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0444\u0430\u0439\u043b/\u043a\u0430\u0442\u0430\u043b\u043e\u0433 <code>rm -r test.file</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u0441 \u0444\u0430\u0439\u043b\u0430\u043c\u0438 (-r)</p>"},{"location":"Linux/#ln","title":"ln","text":"<p><code>echo \"test\" &gt; testfile</code> <code>ln /test/testfile /test/testlink</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0436\u0435\u0441\u0442\u043a\u0443 (hard) \u0441\u0441\u044b\u043b\u043a\u0443, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043d\u0430 \u043e\u0434\u0438\u043d \u0438 \u0442\u043e\u0442 \u0436\u0435 inode, \u0442.\u0435. \u043e\u043d\u0438 \u0434\u0435\u043b\u044f\u0442 \u043e\u0434\u043d\u043e \u0438 \u0442\u043e \u0436\u0435 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043d\u0430 \u0434\u0438\u0441\u043a\u0435 <code>rm testfile</code> \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u0437 \u0444\u0430\u0439\u043b\u043e\u0432 \u043d\u0435 \u043f\u0440\u0438\u0432\u043e\u0434\u0438\u0442 \u043a \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e, \u043f\u043e\u043a\u0430 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0434\u043d\u0430 \u0436\u0435\u0441\u0442\u043a\u0430\u044f \u0441\u0441\u044b\u043b\u043a\u0430 <code>ln -s /test/testfile /test/testlink</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0438\u043c\u0432\u043e\u043b\u0438\u0447\u0435\u0441\u043a\u0443\u044e (-s - soft) \u0441\u0441\u044b\u043b\u043a\u0443, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0441\u0441\u044b\u043b\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u0444\u0430\u0439\u043b testfile <code>echo \"test\" &gt;&gt; testfile</code> \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u0432 \u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b, \u0432\u0441\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0431\u0443\u0434\u0443\u0442 \u043e\u0442\u0440\u0430\u0436\u0435\u043d\u044b \u0432 testlink <code>rm testfile</code> \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u0438\u0441\u0445\u043e\u0434\u043d\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 \u0443 \u0441\u0441\u044b\u043b\u043a\u0438 \u0431\u0443\u0434\u0435\u0442 \u043e\u0448\u0438\u0431\u043a\u0430 (No such file or directory)</p>"},{"location":"Linux/#zip","title":"zip","text":"<p><code>rar a test.rar filename filename2</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0430\u0440\u0445\u0438\u0432 test.rar \u0438 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u0443\u0434\u0430 \u0434\u0432\u0430 \u0444\u0430\u0439\u043b\u0430 (\u0444\u0430\u0439\u043b\u044b \u043a\u043e\u043f\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0432 \u0430\u0440\u0445\u0438\u0432) <code>unrar x test.rar</code> \u0440\u0430\u0437\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c <code>zip -r test.zip filename</code> \u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c (\u0444\u0430\u0439\u043b\u044b \u043a\u043e\u043f\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0432 \u0430\u0440\u0445\u0438\u0432) <code>unzip test.zip</code> \u0440\u0430\u0437\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c <code>bzip2 filename</code> \u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 filename.bz2 (\u0444\u0430\u0439\u043b\u044b \u043f\u0435\u0440\u0435\u043f\u0435\u0449\u0430\u044e\u0442\u0441\u044f \u0432 \u0430\u0440\u0445\u0438\u0432) <code>bunzip2 filename.bz2</code> \u0440\u0430\u0437\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c <code>gzip filename</code> \u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 filename.gz (\u0444\u0430\u0439\u043b\u044b \u043f\u0435\u0440\u0435\u043f\u0435\u0449\u0430\u044e\u0442\u0441\u044f \u0432 \u0430\u0440\u0445\u0438\u0432) <code>tar --totals -cvf archive.tar file1 file2 file3</code> \u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0440\u0438 \u0444\u0430\u0439\u043b\u0430 <code>wget https://github.com/librespeed/speedtest-cli/releases/download/v1.0.10/librespeed-cli_1.0.10_linux_amd64.tar.gz</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0430\u0440\u0445\u0438\u0432 <code>gunzip librespeed-cli_1.0.10_linux_amd64.tar.gz</code> \u0438\u0437\u0432\u043b\u0435\u0447\u044c \u0438\u0437 gz \u0432 tar <code>tar -tf librespeed-cli_1.0.10_linux_amd64.tar</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0430\u0440\u0445\u0438\u0432\u0430 <code>tar -xvf librespeed-cli_1.0.10_linux_amd64.tar</code> \u0440\u0430\u0437\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c <code>./librespeed-cli --help</code> <code>./librespeed-cli --json</code></p>"},{"location":"Linux/#gpg","title":"gpg","text":"<p><code>gpg -c filename</code> \u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 <code>gpg filename.gpg</code> \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 <code>gpg --gen-key</code> \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u043f\u0430\u0440\u0443 \u043a\u043b\u044e\u0447\u0435\u0439 (\u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439 \u0438 \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0439 \u043a\u043b\u044e\u0447\u0438) <code>gpg --export -a 'User Name' &gt; publickey.asc</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430 <code>gpg --import publickey.asc</code> \u0438\u043c\u043f\u043e\u0440\u0442 \u043d\u0430 \u0432\u0442\u043e\u0440\u043e\u0439 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 <code>gpg --encrypt --recipient 'Recipient Name' filename</code> \u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f, \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u043b\u0430\u0434\u0435\u043b\u0435\u0446 \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430 \u0441\u043c\u043e\u0436\u0435\u0442 \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u044d\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 <code>gpg --decrypt encryptedfile.gpg</code> \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043c\u043e\u0436\u043d\u043e \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430 <code>gpg --sign filename</code> \u043f\u043e\u0434\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0438\u0445 \u043f\u043e\u0434\u043b\u0438\u043d\u043d\u043e\u0441\u0442\u0438 \u0438 \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u0438 <code>gpg --verify signedfile.gpg</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0434\u043f\u0438\u0441\u0438 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u044f</p>"},{"location":"Linux/#curl","title":"curl","text":"<p><code>curl ifconfig.me</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0432\u043d\u0435\u0448\u043d\u0438\u0439 ip <code>curl -v telnet://192.168.3.100:22</code> \u043f\u0440\u0432\u043e\u0435\u0440\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0440\u0442\u0430 \u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u043e\u043c\u0443 \u043e\u043d \u043f\u0440\u0438\u043d\u0430\u0434\u043b\u0435\u0436\u0438\u0442 <code>curl -s -o /dev/null http://google.com</code> \u043f\u043e\u0434\u0430\u0432\u0438\u0442\u044c \u0432\u0435\u0441\u044c \u0432\u044b\u0432\u043e\u0434 (\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 --silent \u0438 --output) <code>curl -s -o /dev/null --show-error --fail http://google.com</code> \u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043e\u0448\u0438\u0431\u043e\u043a <code>curl http://192.168.3.101:8081/api/ --connect-timeout 5</code> \u0437\u0430\u0434\u0430\u0442\u044c timeout \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f \u043e\u0442\u0432\u0435\u0442\u0430 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445 <code>curl -IL https://github.com/Lifailon/hwstat/archive/refs/tags/hwstat-0.0.8.zip</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0444\u0430\u0439\u043b\u0435 \u043f\u0435\u0440\u0435\u0434 \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0435\u043c (--head/--location) <code>curl -O https://raw.githubusercontent.com/Lifailon/hwstat/rsa/hwstat.sh</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0444\u0430\u0439\u043b <code>curl -o /tmp/hwstat.sh https://raw.githubusercontent.com/Lifailon/hwstat/rsa/hwstat.sh</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0443\u0442\u044c <code>curl -Ik https://192.168.3.104:9443/</code> \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0448\u0438\u0431\u043a\u0443 \u0441\u0430\u043c\u043e\u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 SSL (--insecure) <code>curl -u &lt;user:password&gt; https://test.com/endpoint</code> \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f <code>curl -x \"http://Proxy:Proxy@192.168.3.100:9090\" \"https://kinozal.tv/rss.xml\"</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c Proxy-\u0441\u0435\u0440\u0432\u0435\u0440 <code>curl --insecure --ssl-reqd \"smtps://smtp.yandex.ru\" --mail-from \"src@yandex.ru\" --mail-rcpt \"dst@yandex.ru\" --user \"src@yandex.ru\" --upload-file out.txt</code> \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 email \u0447\u0435\u0440\u0435\u0437 SMTPS (SMTP over SSL/TLS) \u0441\u0435\u0440\u0432\u0435\u0440 </p>"},{"location":"Linux/#influxdb","title":"influxdb","text":"<pre><code>ip=\"192.168.3.104\"\ndb=\"dbash\"\ntable=\"icmp_metrics_table\"\nserver=\"google.com\"\nhost=$(hostname)\ndate=$(echo $EPOCHREALTIME | sed -E \"s/\\..+//\")\"000000000\"\nping=$(ping $server -c 1)\nloss=$(printf \"%s\\n\" \"${ping[@]}\" | grep -Eo \"[0-9]+%\" | sed \"s/%//\")\nif (( $(echo \"$loss != 100\" | bc) )); then\n    status=\"true\"\n    rtt=$(printf \"%s\\n\" \"${ping[@]}\" | grep rtt | awk -F\"/\" '{print $5}')\nelse\n    status=\"false\"\n    rtt=\"0\"\nfi\ncurl -i -XPOST \"http://$ip:8086/write?db=$db\" --data-binary \"$table,host=$host,server=$server status=$status,rtt=$rtt $date\"\n</code></pre>"},{"location":"Linux/#wget","title":"wget","text":"<p><code>wget --spider https://download.nextcloud.com/server/releases/nextcloud-21.0.1.tar.bz2</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c (--spider) \u0440\u0430\u0431\u043e\u0442\u043e\u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c URL \u0438 \u0443\u0437\u043d\u0430\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430 (Length) <code>wget -O nextcloud.tar.bz2 https://download.nextcloud.com/server/releases/nextcloud-21.0.1.tar.bz2</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c \u0438\u043c\u0435\u043d\u0435\u043c (-O)  <code>wget -P /tmp https://download.nextcloud.com/server/releases/nextcloud-21.0.1.tar.bz2</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u0443\u044e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e (-P) <code>wget -b -o ~/wget.log https://download.nextcloud.com/server/releases/nextcloud-21.0.1.tar.bz2</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432 \u0444\u043e\u043d\u043e\u0432\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 (-b) \u0438 \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u0432 \u043b\u043e\u0433-\u0444\u0430\u0439\u043b (-o)</p>"},{"location":"Linux/#json","title":"json","text":""},{"location":"Linux/#jq","title":"jq","text":"<p><code>apt install jq</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c jq (https://github.com/jqlang/jq) <code>nodes=$(curl -s -H \"Accept: application/json\" https://check-host.net/nodes/ips)</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a node <code>echo $nodes | jq</code> \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0432\u0445\u043e\u0434\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a\u043e\u043c\u0430\u043d\u0434\u043e\u0439 jq (\u0432\u044b\u0432\u043e\u0434 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442\u0441\u044f \u0432 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435, \u0430 \u0432\u0441\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u043f\u043e\u0434\u0441\u0432\u0435\u0447\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u043c \u0446\u0432\u0435\u0442\u043e\u043c) <code>echo $nodes | jq '.nodes | length'</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0432 \u0431\u043b\u043e\u043a\u0435 node[] <code>echo $nodes | jq -r .nodes[1]</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043c\u0430\u0441\u0441\u0438\u0432\u0430 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 raw string (not JSON) <code>echo $nodes | jq -r .nodes[-1]</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043c\u0430\u0441\u0441\u0438\u0432\u0430 <code>hosts=$(curl -s -H \"Accept: application/json\" https://check-host.net/nodes/hosts)</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0445\u043e\u0441\u0442\u043e\u0432 <code>echo $hosts | jq -r '.nodes | to_entries[].key'</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0445 \u043a\u043b\u044e\u0447\u0435\u0439 (\u0430\u0434\u0440\u0435\u0441\u0430 \u0445\u043e\u0441\u0442\u043e\u0432) \u0438\u0437 \u043e\u0431\u044a\u0435\u043a\u0430 (\u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043c\u0430\u0441\u0441\u0438\u0432\u043e\u043c) <code>echo $hosts | jq -r '.nodes | to_entries[].value'</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0432\u0441\u0435\u0445 \u0432\u043b\u043e\u0436\u0430\u043d\u043d\u044b\u0445 \u043a\u043b\u044e\u0447\u0435\u0439 <code>echo $hosts | jq '.nodes.\"bg1.node.check-host.net\"'</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u0447\u0435\u0440\u043d\u0435\u0433\u043e \u043a\u043b\u044e\u0447\u0430 nodes \u043f\u043e \u0438\u043c\u0435\u043d\u0438 <code>echo $hosts | jq '.nodes | [.[]] | last'</code> \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0432\u043d\u0443\u0442\u0440\u0438 nodes \u0432 \u043c\u0430\u0441\u0441\u0438\u0432, \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434 \u0432 \u0444\u0443\u043d\u043a\u0446\u0438\u044e last \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430 <code>echo $hosts | jq '.nodes | to_entries[].value.location[0] == \"ru\"'</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043a\u0430\u0436\u0434\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0432 \u0443\u0441\u043b\u043e\u0432\u0438\u0438 \u043d\u0430 true/false (\u0432\u0435\u0440\u043d\u0435\u0442 \u043c\u0430\u0441\u0441\u0438\u0432) <code>echo $hosts | jq '.nodes | to_entries[] | {Host: .key, Country: .value.location[1], City: .value.location[2]}'</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 key-value \u0438\u0437 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 nodes \u0438 \u043f\u0435\u0440\u0435\u0441\u043e\u0431\u0440\u0430\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432 \u0441 \u043d\u043e\u0432\u044b\u043c\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u043c\u0438 \u043a\u043b\u044e\u0447\u0435\u0439 <code>echo $hosts | jq -r '.nodes | to_entries[] | \"\\(.key) (\\(.value.location[1]), \\(.value.location[2]))\"'</code> \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432 \u0441\u0442\u0440\u043e\u043a\u0438 \u0438\u0437 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0435\u0439 <code>var=\"-\" &amp;&amp; echo $hosts | jq --arg v \"$var\" -r '.nodes | to_entries[] | \"\\(.key) \\($v) \\(.value.location[1]) \\($v) \\(.value.location[2])\"'</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0432\u043d\u0435\u0448\u043d\u044e\u044e \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 <code>echo $hosts | jq -r '.nodes | to_entries[] | select(.value.location[0] == \"ru\") | .key'</code> \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0441\u0442\u0438 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044e (select), \u0447\u0442\u043e \u0431\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0443\u0436\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b <code>echo $hosts | jq '.nodes | to_entries[] | select(.value.location[0] != \"ru\") | .key'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u0440\u0430\u0432\u043d\u044b \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e <code>echo $hosts | jq '.nodes | length'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 <code>echo $hosts | jq '.nodes | to_entries | map(select(.value.location[0] != \"ru\")) | length'</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432 \u0444\u0443\u043d\u043a\u0446\u0438\u0435\u0439 map() (\u043e\u0431\u044a\u0435\u0434\u0435\u043d\u044f\u0435\u0442 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b {}{} \u0433\u0440\u0443\u043f\u043f\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0432 \u043e\u0434\u0438\u043d \u043c\u0430\u0441\u0441\u0438\u0432 [{},{}]) \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 \u0442\u0435\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0443\u0441\u043b\u043e\u0432\u0438\u044e select() \u0438 \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 <code>echo $hosts | jq -r '.nodes | to_entries[] | select(.value.location[0] == \"ru\" or .value.location[0] == \"tr\") | .key'</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0434\u0432\u0430 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0447\u0435\u0440\u0435\u0437 or \u0438\u043b\u0438 and (\u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c\u043e\u0433\u043e \u0442\u0438\u043f\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 int \u043a\u0430\u0432\u044b\u0447\u043a\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f) <code>echo $hosts | jq -r '.nodes | to_entries[] | select(.key | index(\"jp\")) | .key'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0445\u043e\u0441\u0442\u043e\u0432 \u0440\u0435\u0433\u0438\u043e\u043d\u0430 Japan, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0432 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0438 \u043a\u043b\u044e\u0447\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442 \u043a\u043b\u044e\u0447\u0435\u0432\u043e\u0435 \u0441\u043b\u043e\u0432\u043e jp (\u0447\u0430\u0441\u0442\u0438\u0447\u043d\u043e\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435 \u0432 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0438)</p> <pre><code>host=\"yandex.ru\"\nprotocol=\"ping\"\nhost=\"yandex.ru:443\"\nprotocol=\"tcp\" # udp/http/dns\n# \u0417\u0430\u0431\u0440\u0430\u0442\u044c id \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432\ncheck_id=$(curl -s -H \"Accept: application/json\" \"https://check-host.net/check-$protocol?host=$host&amp;max_nodes=3\" | jq -r .request_id)\n# \u0424\u0443\u043d\u043a\u0446\u0438\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043f\u043e id\nfunction check-result {\n    curl -s -H \"Accept: application/json\" https://check-host.net/check-result/$1 | jq .\n}\n# \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u0443\u043c\u043c\u0430\u0440\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0445\u043e\u0441\u0442\u043e\u0432, \u0441 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430\nhosts_length=$(check-result $check_id | jq length)\nwhile true; do\n    check_result=$(check-result $check_id)\n    # \u0417\u0430\u0431\u0438\u0440\u0430\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u0435\u043c, \u0447\u0442\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0432\u0441\u0435\u0445 \u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a \u043d\u0435 \u0440\u0430\u0432\u043d\u044b null\n    check_values_not_null=$(echo $check_result | jq -e 'to_entries | map(select(.value != null)) | length')\n    if [[ $check_values_not_null == $hosts_length ]]; then\n        echo $check_result | jq\n        break\n    fi\n    sleep 1\ndone\n</code></pre> <p><code>echo '{\"iso\": [{\"name\": \"Ubuntu\", \"size\": 4253212899}, {\"name\": \"Debian\", \"size\": 3221225472}]}' | jq '.iso[] | {name: .name, size: (.size / 1024 / 1024 / 1024 | tonumber * 100 | floor / 100 | tostring + \" GB\")}'</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0413\u0411 \u0438\u0437 \u0431\u0430\u0439\u0442 \u0438 \u043e\u043a\u0440\u0443\u0433\u043b\u0438\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u0434\u043e 2 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u043c \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u044f\u0442\u043e\u0439 <code>echo '{\"iso\": [{\"name\": \"Ubuntu\", \"progress\": 0.333}]}' | jq '.iso[] | {name: .name, progress: (.progress * 100 | floor / 100 * 100 | tostring + \" %\")}'</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0438\u0437 \u0434\u0440\u043e\u0431\u043d\u043e\u0439 \u0447\u0430\u0441\u0442\u0438 (33%) <code>echo '[{\"name\": \"Ubuntu\", \"added_on\": 1625072400}, {\"name\": \"Debian\", \"added_on\": 1625158800}]' | jq '.[] | {name: .name, date: (.added_on + 3 * 3600 | strftime(\"%H:%M:%S %d.%m.%Y\"))}'</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u0430\u0442\u0443</p>"},{"location":"Linux/#netcheck","title":"netcheck","text":"<pre><code>sudo curl -s https://raw.githubusercontent.com/Lifailon/Check-Host/rsa/netcheck/netcheck.sh -o /usr/bin/netcheck\nsudo chmod +x /usr/bin/netcheck\n</code></pre> <p><code>netcheck -t ping yandex.ru</code> <code>netcheck -n</code> <code>netcheck -t ping yandex.ru ru1.node.check-host.net</code> <code>netcheck -t dns yandex.ru</code> <code>netcheck -t http yandex.ru:443 5</code> <code>netcheck -t tcp yandex.ru:443</code></p>"},{"location":"Linux/#brew","title":"brew","text":"<p><code>/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 brew (https://github.com/Homebrew/brew) \u0434\u043b\u044f macOS/Linux <code>echo 'eval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"' &gt;&gt; ~/.profile</code> <code>eval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"</code> <code>brew --version</code></p>"},{"location":"Linux/#fx","title":"fx","text":"<p><code>brew install fx || snap install fx</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c fx (https://github.com/antonmedv/fx) TUI \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0434\u043b\u044f JSON \u043d\u0430 GoLang <code>hosts=$(curl -s -H \"Accept: application/json\" https://check-host.net/nodes/hosts)</code> <code>echo $hosts | fx</code> \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430 \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u044f \u0441 \u0440\u0430\u0441\u043a\u0440\u044b\u0442\u0438\u0435\u043c \u0431\u043b\u043e\u043a\u043e\u0432 \u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043a\u043b\u044e\u0447\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0434\u043b\u044f jq <code>source &lt;(fx --comp bash)</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c autocomplete \u0432 \u0438\u043d\u0442\u0435\u0440\u043f\u0440\u0438\u0442\u0430\u0442\u043e\u0440 bash <code>echo $hosts &gt; hosts.json</code> <code>fx hosts.json .nodes .\\[\\\"ru1.node.check-host.net\\\"\\] .ip</code> \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0432\u044b\u0432\u043e\u0434 \u043a\u043b\u044e\u0447\u0435\u0439 \u0438 \u043f\u043e\u0434\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430</p>"},{"location":"Linux/#jid","title":"jid","text":"<p><code>brew install jid</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c jid (https://github.com/simeji/jid) \u0434\u043b\u044f \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0439 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 JSON \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0430\u0432\u0442\u043e\u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u043d\u0430 GoLang <code>echo '{\"info\":{\"date\":\"2016-10-23\",\"version\":1.0},\"users\":[{\"name\":\"simeji\",\"uri\":\"https://github.com/simeji\",\"id\":1},{\"name\":\"simeji2\",\"uri\":\"https://example.com/simeji\",\"id\":2},{\"name\":\"simeji3\",\"uri\":\"https://example.com/simeji3\",\"id\":3}],\"userCount\":3}}' | jid</code> .users[1].uri</p>"},{"location":"Linux/#jqp","title":"jqp","text":"<p><code>brew install noahgorstein/tap/jqp</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c jqp (https://github.com/noahgorstein/jqp) TUI \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f jq \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043d\u0430 GoLang <code>curl -s https://api.github.com/repos/Lifailon/PS-Commands/contents | jqp</code> \u0441\u043b\u0435\u0432\u0430 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442\u0441\u044f \u0438\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u0444\u0430\u0439\u043b, \u0441\u043f\u0440\u0430\u0432\u0430 \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434 <code>curl -s https://check-host.net/nodes/hosts | jqp</code> # \u043f\u0440\u0438\u043c\u0435\u0440 \u0434\u043b\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438: <code>.nodes | to_entries[] | select(.value.location[0] == \"ru\") | .key</code></p>"},{"location":"Linux/#xmllint","title":"xmllint","text":"<p><code>apt-get install libxml2-utils || snap install libxml2 || brew install libxml2</code> <code>curl -s https://kinozal.tv/rss.xml -x kinozal:proxy@192.168.3.100:9090 | xmllint --xpath '//rss/channel/item/link/text()' -</code> <code>curl -s https://kinozal.tv/rss.xml -x kinozal:proxy@192.168.3.100:9090 | xmllint --xpath '//rss/channel/item[1]/link/text()' -</code></p>"},{"location":"Linux/#dasel","title":"dasel","text":"<p><code>brew install dasel</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c dasel (https://github.com/TomWright/dasel) \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 JSON, YAML, TOML, XML \u0438 CSV (\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0436\u0434\u0443 \u0444\u043e\u0440\u043c\u0430\u0442\u0430\u043c\u0438) \u043d\u0430 GoLang <code>echo '{\"name\": \"Tom\"}' | dasel -r json 'name'</code> <code>echo '{\"name\": \"Tom\"}' | dasel -r json -w yaml</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c json \u0432 yaml <code>echo '{\"name\": \"Tom\"}' | dasel -r json -w xml</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c json \u0432 xml <code>echo '{\"name\": \"Tom\"}' | dasel put -r json -t string -v 'contact@tomwright.me' 'email'</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u043e <code>echo '{\"email\": \"contact@tomwright.me\",\"name\": \"Tom\"}' | dasel delete -r json '.email'</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u043e</p> <pre><code>tee users.json &lt;&lt;EOF\n{\n    \"users\": [\n      {\n        \"name\": \"\u0418\u0432\u0430\u043d \u0418\u0432\u0430\u043d\u043e\u0432\",\n        \"email\": \"ivan.ivanov@example.com\"\n      },\n      {\n        \"name\": \"\u041c\u0430\u0440\u0438\u044f \u041f\u0435\u0442\u0440\u043e\u0432\u0430\",\n        \"email\": \"maria.petrova@example.com\"\n      }\n    ]\n}\nEOF\n</code></pre> <p><code>dasel -f users.json -r json \".users.[0].email\"</code></p> <pre><code>tee users.yaml &lt;&lt;EOF\nusers:\n  - name: \u0418\u0432\u0430\u043d \u0418\u0432\u0430\u043d\u043e\u0432\n    email: ivan.ivanov@example.com\n  - name: \u041c\u0430\u0440\u0438\u044f \u041f\u0435\u0442\u0440\u043e\u0432\u0430\n    email: maria.petrova@example.com\nEOF\n</code></pre> <p><code>dasel -f users.yaml -r yaml \".users.[1].email\"</code></p> <pre><code>tee users.toml &lt;&lt;EOF\n[[users]]\nname = \"\u0418\u0432\u0430\u043d \u0418\u0432\u0430\u043d\u043e\u0432\"\nemail = \"ivan.ivanov@example.com\"\n[[users]]\nname = \"\u041c\u0430\u0440\u0438\u044f \u041f\u0435\u0442\u0440\u043e\u0432\u0430\"\nemail = \"maria.petrova@example.com\"\nEOF\n</code></pre> <p><code>dasel -f users.toml -r toml \".users.[1].email\"</code></p> <pre><code>tee users.xml &lt;&lt;EOF\n&lt;users&gt;\n  &lt;user&gt;\n    &lt;name&gt;\u0418\u0432\u0430\u043d \u0418\u0432\u0430\u043d\u043e\u0432&lt;/name&gt;\n    &lt;email&gt;ivan.ivanov@example.com&lt;/email&gt;\n  &lt;/user&gt;\n  &lt;user&gt;\n    &lt;name&gt;\u041c\u0430\u0440\u0438\u044f \u041f\u0435\u0442\u0440\u043e\u0432\u0430&lt;/name&gt;\n    &lt;email&gt;maria.petrova@example.com&lt;/email&gt;\n  &lt;/user&gt;\n&lt;/users&gt;\nEOF\n</code></pre> <p><code>dasel -f users.xml -r xml \".users.user.[0].email\"</code></p>"},{"location":"Linux/#xq","title":"xq","text":"<p><code>apt-get install xq || brew install xq</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c xq (https://github.com/sibprogrammer/xq) \u0434\u043b\u044f XML \u0438 HTML \u043d\u0430 GoLang <code>curl -s https://kinozal.tv/rss.xml -x kinozal:proxy@192.168.3.100:9090 | xq -nx /rss/channel/item</code> \u0432\u044b\u0432\u043e\u0434 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0441 \u0442\u0435\u0433\u0430\u043c\u0438 <code>curl -s https://kinozal.tv/rss.xml -x kinozal:proxy@192.168.3.100:9090 | xq -x /rss/channel/item/link</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 (\u043c\u0430\u0441\u0441\u0438\u0432 \u0441\u0441\u044b\u043b\u043e\u043a) <code>curl -s https://kinozal.tv -x kinozal:proxy@192.168.3.100:9090 | xq -nq \"head\"</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0431\u043b\u043e\u043a head \u0446\u0435\u043b\u0438\u043a\u043e\u043c (\u0441 \u0442\u0435\u0433\u0430\u043c\u0438) <code>curl -s https://kinozal.tv -x kinozal:proxy@192.168.3.100:9090 | xq -q \"head\"</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0435\u043a\u0441\u0442 \u0438\u0437 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0435\u0433\u0430 (\u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 title) <code>curl -s https://kinozal.tv/browse.php?s=the+rookie -x kinozal:proxy@192.168.3.100:9090 | xq -nq \"body &gt; div &gt; div &gt; div &gt; div &gt; table &gt; tbody &gt; tr &gt; td\"</code> <code>curl -s -X POST -u \"Login:Password\" \"http://localhost:9091/transmission/rpc\" | xq -q a -a href</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c X-Transmission-Session-Id \u0434\u043b\u044f \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0438\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043a API (\u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u043a \u0442\u044d\u0433\u0443 a \u0438 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0443 href)</p>"},{"location":"Linux/#htmlq","title":"htmlq","text":"<p><code>brew install htmlq</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c htmlq (https://github.com/mgdm/htmlq) like jq for HTML <code>curl -s https://kinozal.tv/browse.php?s=the+rookie -x kinozal:proxy@192.168.3.100:9090 | htmlq table tr td a -t</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0442\u0430\u0431\u043b\u0438\u0446\u044b (\u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e) <code>curl -s https://kinozal.tv/browse.php?s=the+rookie -x kinozal:proxy@192.168.3.100:9090 | htmlq table tr td a -a href</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0441\u044b\u043b\u043a\u0438 <code>curl -s -X POST -u \"Login:Password\" \"http://localhost:9091/transmission/rpc\" | htmlq a -a href</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c X-Transmission-Session-Id \u0434\u043b\u044f \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0438\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043a API (\u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u043a \u0442\u044d\u0433\u0443 a \u0438 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0443 href)</p>"},{"location":"Linux/#yq","title":"yq","text":"<p><code>snap install yq || pip install yq</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c yq (https://github.com/kislyuk/yq) \u0434\u043b\u044f YAML/XML/TOML \u043d\u0430 Python <code>cat /etc/netplan/*.yaml | yq .network.ethernets</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u043e\u0432 netplan <code>cat /etc/netplan/*.yaml | yq .network.ethernets.eth0.nameservers.addresses[]</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043c\u0430\u0441\u0441\u0438\u0432 dns \u0430\u0434\u0440\u0435\u0441\u043e\u0432, \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u043d\u0430 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0435 <code>curl -s https://kinozal.tv/rss.xml -x kinozal:proxy@192.168.3.100:9090 | yq -p xml .rss.channel.item[1].link</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u0441\u044b\u043b\u043a\u0443 \u0438\u0437 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 <code>curl -s https://raw.githubusercontent.com/JingWangTW/dark-theme-editor/main/hugo.toml | yq -p toml .params.footer.socialLink</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e Hugo</p>"},{"location":"Linux/#yamllint","title":"yamllint","text":"<p><code>apt install yamllint</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c yamllint (https://github.com/adrienverge/yamllint) \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u043e\u0448\u0438\u0431\u043a\u0438 YAML-\u0444\u0430\u0439\u043b\u0430 <code>yamllint /etc/netplan/*.yaml</code></p>"},{"location":"Linux/#jsonlint","title":"jsonlint","text":"<p><code>apt-get install -y nodejs</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c Node.js <code>npm install jsonlint -g</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c jsonlint (https://github.com/zaach/jsonlint) \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u043e\u0448\u0438\u0431\u043e\u043a JSON <code>echo '{\"name\":\"example\",\"value\":\"test\",}' | jsonlint</code> <code>echo '{\"name\":\"example\",\"value\":\"test\"}' | jsonlint</code></p>"},{"location":"Linux/#csv","title":"csv","text":"<p><code>brew install csvlens</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c csvlens (https://github.com/YS-L/csvlens) \u0434\u043b\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0441\u0442\u0438\u044f \u0432 csv \u0447\u0435\u0440\u0435\u0437 TUR \u043d\u0430 Rust <code>pwsh -Command \"Get-Process | ConvertTo-Csv | Out-File process.csv\"</code> <code>csvlens process.csv</code></p>"},{"location":"Linux/#sttr","title":"sttr","text":"<p><code>snap install sttr</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c sttr (https://github.com/abhimanyu003/sttr) \u0434\u043b\u044f \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u0438 \u0438 \u0440\u0430\u0431\u043e\u0442\u044b \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043d\u0430 GoLang <code>curl -s curl -s -H \"Accept: application/json\" https://check-host.net/nodes/hosts | sttr json-yaml</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c JSON \u0432 YAML <code>cat /etc/netplan/*.yaml | sttr yaml-json | jq</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c YAML \u0432 JSON <code>curl -s https://raw.githubusercontent.com/Lifailon/hwstat/rsa/README.md | sttr markdown-html</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c Markdown \u0432 HTML <code>echo \"test\" | sttr hex-encode</code> \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 HEX \u0444\u043e\u0440\u043c\u0430\u0442 <code>echo \"74657374\" | sttr hex-decode</code> \u0434\u0435\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u0442\u044c HEX <code>echo \"Test\" | sttr upper</code> \u043f\u043e\u0434\u043d\u044f\u0442\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440 (TEST) <code>echo \"Test\" | sttr lower</code> \u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440 (test) <code>echo -e \"test1\\ntest1\\ntest2\" | sttr unique-lines</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 <code>echo -e \"a\\nz\\nb\" | sttr sort-lines</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0438 \u043f\u043e \u0430\u043b\u0444\u0430\u0432\u0438\u0442\u0443 <code>echo -e \"test1 \\ntest2\" | sttr remove-newlines</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 <code>echo -e \"test1\\ntest2\" | sttr count-chars</code> \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 <code>echo -e \"test1\\ntest2\" | sttr count-lines</code> \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0442\u0440\u043e\u043a</p>"},{"location":"Linux/#grep","title":"grep","text":"<p><code>cat /var/log/auth.log | grep sshd</code> \u043b\u043e\u0433\u0438 \u0432\u0441\u0435\u0445 SSH-\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 <code>cat /etc/passwd | grep -w sys</code> \u043f\u043e\u0438\u0441\u043a \u0446\u0435\u043b\u043e\u0433\u043e \u0441\u043b\u043e\u0432\u0430, \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u043d\u043e\u0435 \u043f\u0440\u043e\u0431\u0435\u043b\u0430\u043c\u0438 (-w) <code>cat /etc/ssh/sshd_config | grep -win port</code> \u043d\u0435 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440 (-i) \u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043d\u043e\u043c\u0435\u0440\u0430 \u0441\u0442\u0440\u043e\u043a (-n) <code>ss -n | grep -P \":22|:80|:443|:8080\"</code> \u0438\u0441\u043a\u0430\u0442\u044c \u043f\u043e \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u043c \u0448\u0430\u0431\u043b\u043e\u043d\u0430\u043c, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c Regex (-E) <code>ss -n | grep -Pc \":22|:80\"</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043a\u043e\u043b-\u0432\u043e (--count) \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 <code>ss -n | grep \"192.168.3...:\"</code> \u043f\u043e\u0438\u0441\u043a \u043b\u044e\u0431\u044b\u0445 \u0434\u0432\u0443\u0445 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 (.) <code>ss -n | grep \"192.168.3.*:\"</code> \u043f\u043e\u0438\u0441\u043a \u043b\u044e\u0431\u043e\u0433\u043e \u043a\u043e\u043b-\u0432\u0430 () <code>cat /etc/ssh/sshd_config | grep -v \"#\"</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u043d\u0435 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u043f\u043e\u0434 \u043a\u0440\u0438\u0442\u0435\u0440\u0438\u0438 \u043f\u043e\u0438\u0441\u043a\u0430 (-v) <code>cat /etc/zabbix/zabbix_agentd.conf | grep -v \"^#\"</code> \u043e\u0442\u0441\u0435\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u043d\u0430\u0447\u0430\u043b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 (^) <code>cat /etc/zabbix/zabbix_agentd.conf | grep \"=$\"</code> \u043d\u0430\u0439\u0442\u0438 \u0441\u0442\u0440\u043e\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043a\u043e\u043d\u0447\u0430\u044e\u0442\u0441\u044f <code>$</code> \u043d\u0430 \u0441\u0438\u043c\u0432\u043e\u043b \"=\" (\u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b) <code>cat /etc/zabbix/zabbix_agentd.conf | grep -Pv \"^$|^#\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 <code>^$</code> \u0438 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438 (^#) <code>cat /etc/zabbix/zabbix_agentd.conf | grep -E \"#+{5}\"</code> \u0440\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u043e\u0435 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0435 (-E), \u0433\u0434\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0441\u0438\u043c\u0432\u043e\u043b \"#\" \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u0442\u0441\u044f 5 \u0438\u043b\u0438 \u0431\u043e\u043b\u0435\u0435 \u0440\u0430\u0437 <code>echo -e \"Test\\ntest\\n123-45\" | grep -E \"[a-zA-Z\\-]\"</code> \u0438\u0441\u043a\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0435\u043a\u0441\u0442 (\u0433\u0434\u0435 \u0435\u0441\u0442\u044c \u0431\u0443\u043a\u0432\u044b \u0438 \u0442\u0438\u0440\u0435) <code>echo 'test&lt;version&gt;1.2.3&lt;/version&gt;test' | grep -P -o \"(?&lt;=&lt;version&gt;).*(?=&lt;/version&gt;)\"</code> \u043d\u0430\u0439\u0442\u0438 \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 (.) \u043c\u0435\u0436\u0434\u0443 \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u043c\u0438 \u0438 \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u043e\u0435 (-o) <code>echo \"test&lt;version&gt;3.6.4&lt;/version&gt;test\" | grep -Eo '[0-9.]+'</code> \u043d\u0430\u0439\u0442\u0438 \u043b\u044e\u0431\u0443\u044e \u0446\u0438\u0444\u0440\u0443 \u0438 \u0442\u043e\u0447\u043a\u0443 \u043d\u0430 \u043a\u043e\u043d\u0446\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u044e\u0442\u0441\u044f \u043b\u044e\u0431\u043e\u0435 \u043a\u043e\u043b-\u0432\u043e \u0440\u0430\u0437 \u043f\u043e\u0434\u0440\u044f\u0434 <code>echo $(lshw -class bus) | grep -P -o \"(?&lt;=Motherboard product: ).*(?=serial)\"</code> \u0441 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u0438\u0440\u043e\u0432\u043a\u0438 (-P) <code>zabbix_path=$(systemctl status zabbix-agent | grep -Po \"(?&lt;=-c ).*(?=.conf)\" | sed \"s/$/.conf/\")</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u043f\u0443\u0442\u044c \u0434\u043e \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 Zabbix \u0430\u0433\u0435\u043d\u0442\u0430 <code>cat $zabbix_path | grep -E \"^Server=|^ServerActive=\"</code> \u043d\u0430\u0439\u0442\u0438 \u0438\u043c\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>cat $zabbix_path | grep -Po \"(?&lt;=^Server=).+\"</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u043c\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>resolvectl | grep \"DNS Servers\" -m 1</code> \u043d\u0430\u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0435\u0440\u0432\u043e\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435 (-m int) <code>networkctl status | grep -A 3 \"DNS:\"</code> \u043d\u0430\u0439\u0442\u0438 \u0441\u0442\u0440\u043e\u043a\u0443 \u0438 \u043d\u0430\u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u0442\u0440\u0438 \u0441\u0442\u0440\u043e\u043a\u0438 \u043f\u043e\u0441\u043b\u0435 \u043d\u0435\u0435 (-A) <code>networkctl status | grep -B 3 \"DNS:\"</code> \u043d\u0430\u0439\u0442\u0438 \u0441\u0442\u0440\u043e\u043a\u0443 \u0438 \u043d\u0430\u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u0442\u0440\u0438 \u0441\u0442\u0440\u043e\u043a\u0438 \u0434\u043e \u043d\u0435\u0435 (-B) <code>networkctl status | grep -C 1 \"DNS:\"</code> \u043d\u0430\u0439\u0442\u0438 \u0441\u0442\u0440\u043e\u043a\u0443 \u0438 \u043d\u0430\u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u043e\u0434\u043d\u0443 \u0441\u0442\u0440\u043e\u043a\u0438 \u0434\u043e \u043d\u0435\u0435 \u0438 \u043e\u0434\u043d\u0443 \u043f\u043e\u0441\u043b\u0435 (-C) <code>resolvectl | grep -Ex \".+DNS Servers:.+\"</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u0442\u0440\u043e\u043a\u0438 \u0441 \u0442\u043e\u0447\u043d\u044b\u043c \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435 (-x/like), \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0446\u0435\u043b\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 <code>if echo \"GET\" | grep -Eq \"^GET\"; then echo da; else echo net; fi</code> \u043f\u043e\u0434\u0430\u0432\u043b\u044f\u0442\u044c \u0432\u044b\u0432\u043e\u0434 (-q) \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u044f <code>curl https://api.github.com/repos/PowerShell/PowerShell/releases/latest | grep -Eom 1 \"https://.+.deb\"</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0435\u0440\u0432\u044b\u0439 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u043f\u043e\u0434 \u043f\u043e\u0438\u0441\u043a</p>"},{"location":"Linux/#sig","title":"sig","text":"<p><code>brew install ynqa/tap/sigrs</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c sig (https://github.com/ynqa/sig) \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439 grep \u043d\u0430 Rust <code>curl -s https://raw.githubusercontent.com/Lifailon/hwstat/rsa/README.md &gt; README.md</code> <code>cat README.md |&amp; sig -a</code></p>"},{"location":"Linux/#sed","title":"sed","text":"<p><code>cat /etc/passwd | sed -n \"1,5p\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441 \u043f\u0435\u0440\u0432\u043e\u0439 \u043f\u043e \u043f\u044f\u0442\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 (p) <code>cat /etc/passwd | sed \"$ d\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c (d) \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044e\u044e \u0441\u0442\u0440\u043e\u043a\u0443 <code>cat /etc/passwd | sed \"1,3d\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c c \u043f\u0435\u0440\u0432\u043e\u0439 \u043f\u043e \u0442\u0440\u0435\u0442\u044c\u044e \u0441\u0442\u0440\u043e\u043a\u0443 (2,3d) <code>echo \"One 1\" | sed \"s/One/Two/; s/1/2/\"</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c One \u043d\u0430 Two \u0438 1 \u043d\u0430 2 <code>cat /etc/zabbix/zabbix_agentd.conf | sed \"s/127.0.0.1/192.168.3.102/\" #  &gt; /etc/zabbix/zabbix_agentd.conf</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c (s) ip-\u0430\u0434\u0440\u0435\u0441 <code>cat /etc/zabbix/zabbix_agentd.conf | sed \"/^#\\|^$/d\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 <code>^$</code> \u0438 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438 <code>^#</code> <code>timedatectl | grep zone | sed -E \"s/.+zone: //\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043b\u044e\u0431\u043e\u0435 \u043a\u043e\u043b-\u0432\u043e \u043b\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0434\u043e \u0441\u043b\u043e\u0432\u0430 \"zone: \" \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f Regex (-E/-r) <code>echo -e \"test\\ntest\" | sed \"2s/test/test2/\"</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u043e \u0432\u0442\u043e\u0440\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0435 (2s) <code>echo -e \"test\\ntest\\ntest\\ntest\" | sed \"2,3s/test/test2/\"</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u043e \u0432\u0442\u043e\u0440\u043e\u0439 \u0438 \u0442\u0440\u0435\u0442\u0435\u0439 \u0441\u0442\u0440\u043e\u043a\u0435 (2,3s) <code>echo -e \"test\\ntest\\ntest\\ntest\" | sed \"2ctest2\"</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u0442\u043e\u0440\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 (2c) <code>echo \"The test and test\" | sed \"s/test/test2/g\"</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u044f (/global) <code>echo \"The test and test\" | sed \"s/test/test2/2\"</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u043b\u044f \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u044f (/2) <code>echo \"line2\" | sed \"i\\line1\"</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443 \u0432 \u043d\u0430\u0447\u0430\u043b\u043e (i) <code>echo \"line1\" | sed \"a\\line2\"</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443 \u0432 \u043a\u043e\u043d\u0435\u0446 (a) \u0438\u043b\u0438 \u0432 \u043f\u043e\u0441\u043b\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 (2a) <code>echo \"11 22 33 34\" | sed \"y/123/234/\"</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c 1 \u043d\u0430 2, 2 \u043d\u0430 3, 3 \u043d\u0430 4 (y) <code>ls -R | grep ':' | sed \"s/:$//; s/[^\\/]*\\// - /g\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \":\" \u0432 \u043a\u043e\u043d\u0446\u0435 \u0438 \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u043d\u0430\u0447\u0430\u043b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 \"/\u043b\u044e\u0431\u043e\u0435 \u043a\u043e\u043b-\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u043c\u0435\u0436\u0434\u0443/\" \u043d\u0430 \" - \" \u0434\u043b\u044f \u0432\u0441\u0435\u0445 (/g global) <code>echo \"test&lt;version&gt;3.6.4&lt;/version&gt;test\" | sed -r 's/[^&lt;]*&lt;(.*)&gt;.*/\\1/;s/&lt;.*//;s/.*&gt;//'</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c regex (-r) <code>ps aux | grep -E \"^zabbix .+ -c\" | sed -E \"s/^zabbix.+-c //\"</code> \u043d\u0430\u0439\u0442\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 zabbix \u0441 \u043a\u043b\u044e\u0447\u0435\u043c -c \u0438 \u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043f\u0443\u0442\u044c conf <code>echo \"MPEG-H HEVC, 88.5 \u041c\u0431\u0438\u0442/\u0441, 3840x2160, 23.976 \u043a\u0430\u0434\u0440/\u0441, 10 \u0431\u0438\u0442\" | sed -nr 's/.* ([0-9]+x[0-9]+).*/\\1/p'</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 (-n) \u0441 \u0437\u0430\u043c\u0435\u043d\u043e\u0439 (s/), \u0438\u0449\u0435\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u0446\u0438\u0444\u0440\u044b [0-9] \u0433\u0434\u0435 \u043e\u0434\u043d\u043e \u0438\u043b\u0438 \u0431\u043e\u043b\u0435\u0435 \u0432\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0439 (+) \u0438 \u043c\u0435\u0436\u0434\u0443 \u043d\u0438\u043c\u0438 \"x\", \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0435\u0440\u0432\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443 \u043f\u043e\u0438\u0441\u043a\u0430 (\u0442\u043e, \u0447\u0442\u043e \u0432 \u0441\u043a\u043e\u0431\u043a\u0430\u0445) \u043d\u0430 \u043f\u0435\u0447\u0430\u0442\u044c (/p)</p>"},{"location":"Linux/#awk","title":"awk","text":"<p><code>cat /etc/passwd | awk -F: '{print \"name: \" $1 \" \\t Dir: \" $NF}'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0438 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e <code>$NF</code> \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0432 \u0441\u0442\u0440\u043e\u043a\u0435, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c \":\" \u0438 \u0442\u0430\u0431\u0443\u043b\u044f\u0446\u0438\u044e (\\t) <code>echo 'one two three four' | awk '{print $(NF-1)}'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043f\u0440\u0435\u043f\u043e\u0434\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 <code>echo 'one two three four five' | awk '{print $((NF/2)+1)}'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0438\u0437 \u0441\u0435\u0440\u0435\u0434\u0438\u043d\u044b <code>echo \"One Two Three\" | awk '{$3=\"Four\"; print $0}'</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0442\u0440\u0435\u0442\u044c\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435/\u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u0432 \u0441\u0442\u0440\u043e\u043a\u0435 <code>cat /etc/passwd | awk 'BEGIN{FS=\":\"; OFS=\" - \"} {print $1,$7}'</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c \u043f\u043e\u0441\u043b\u0435\u0439 (\u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432) \u043d\u0430 \u0432\u0445\u043e\u0434 (FS) \u0438 \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0435\u0433\u043e \u043d\u0430 \u0432\u044b\u0445\u043e\u0434\u0435 (OFS) <code>uptime | awk 'BEGIN{RS=\" \"; ORS=\"\\n\"} {print $0}'</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c \u0437\u0430\u043f\u0438\u0441\u0435\u0439 (\u0441\u0442\u0440\u043e\u043a) \u043d\u0430 \u0432\u0445\u043e\u0434\u0435 (RS) \u0438 \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0435\u0433\u043e \u043d\u0430 \u0432\u044b\u0445\u043e\u0434\u0435 (ORS) <code>echo -e \"12345\\n54321\" | awk 'BEGIN{FIELDWIDTHS=\"2 3\"}{print $1,$2}'</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u043a\u043e\u043b-\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0434\u043b\u044f \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u044f <code>lsof | awk '{if($7==\"REG\")print $0}'</code> \u0443\u0441\u043b\u043e\u0432\u0438\u0435 \u0434\u043b\u044f \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u043f\u043e \u0441\u0442\u043e\u043b\u0431\u0446\u0443 <code>cat /etc/ssh/sshd_config | awk '/Port / {print $2}'</code> \u0443\u0441\u043b\u043e\u0432\u0438\u0435 \u043f\u043e\u0438\u0441\u043a\u0430 \u0434\u043b\u044f \u0432\u044b\u0432\u043e\u0434\u0430 <code>cat /etc/ssh/sshd_config | awk 'length $0 &gt; 1'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u0442\u0440\u043e\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0434\u043b\u0438\u043d\u043d\u0435\u0435, \u0447\u0435\u043c 1 \u0441\u0438\u043c\u0432\u043e\u043b (\u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438) <code>cat /var/log/syslog | grep \"$date\" | awk '{print length($6)}'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0434\u043b\u0438\u043d\u043d\u0443 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f <code>awk 'BEGIN{x = \"low\"; print toupper(x)}'</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0430 \u0432 \u0432\u0432\u0435\u0440\u0445\u043d\u0438\u0439 \u0440\u0435\u0433\u0438\u0441\u0442\u0440 <code>awk 'BEGIN{x = \"LOW\"; print tolower(x)}'</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0430 \u0432 \u043d\u0438\u0436\u043d\u0438\u0439 \u0440\u0435\u0433\u0438\u0441\u0442\u0440 <code>echo \"1 2 3 4:5:6\" | awk '{item=$4; split(item,array,\":\"); print array[2]}'</code> \u0440\u0430\u0437\u0431\u0438\u0442\u044c 4 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 \u043c\u0430\u0441\u0441\u0438\u0432 (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044e split) \u0438 \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e 2-\u043c\u0443 \u0438\u043d\u0434\u0435\u043a\u0441\u0443 <code>free | awk '{if (NR == 2) print $0}'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u0442\u043e\u0440\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 <code>free | awk '{if (NR &gt;= 2) print $0}'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0432\u0442\u0440\u043e\u0443\u044e \u0438 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 <code>free | awk '{if (NF &gt;= 5) print $0}'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u0442\u0440\u043e\u043a\u0438, \u0433\u0434\u0435 5 \u0438\u043b\u0438 \u0431\u043e\u043b\u044c\u0448\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 <code>cat /etc/passwd | awk '{ if (NR &gt;= 10 &amp;&amp; NR &lt;= 20) print $0}'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441 10 \u043f\u043e 20 \u0441\u0442\u0440\u043e\u043a\u0438 <code>last | sed -n 1p | awk '$2=\" \",$4=\" \"{print $0}'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0435, \u043a\u0440\u043e\u043c\u0435 2 \u0438 4 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f (\u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c) <code>ps -A | awk '{sum=\"\"; for(i=1;i&lt;=NF;i++) { if (i != 2) {sum=sum\" \"$i} } print sum}'</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0435, \u043a\u0440\u043e\u043c\u0435 2-\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f</p>"},{"location":"Linux/#printf","title":"printf","text":"<p><code>top=$(top -bn1)</code> <code>printf \"%s\\n\" \"${top[@]}\"</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0432\u044b\u0432\u043e\u0434 \u043c\u0430\u0441\u0441\u0438\u0432\u0430 \u043f\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u043e <code>printf \"%.2f \\n\" 1.1111</code> \u043e\u043a\u0440\u0443\u0433\u043b\u0438\u0442\u044c \u0434\u043e 2 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u044f\u0442\u043e\u0439 <code>printf \"%.0f \\n\" 1.6</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0447\u0430\u0441\u0442\u044c (\u043e\u043a\u0440\u0443\u0433\u043b\u0438\u0442\u044c \u0434\u043e 2) <code>printf \"Arg1: %s\\nArg2: %s\\n\" \"10\" \"20\"</code> \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u0438 \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b (%s) \u0432 \u0432\u0438\u0434\u0435 \u0441\u0442\u0440\u043e\u043a\u0438</p>"},{"location":"Linux/#cut","title":"cut","text":"<p><code>echo \"1 2 3\" | cut -c 1,5</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043f\u0435\u0440\u0432\u044b\u0439 \u0438 \u043f\u044f\u0442\u044b\u0439 \u0441\u0438\u043c\u043e\u0432 (--bytes/--characters) <code>echo \"1 2 3\" | cut -c 1-3</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441 \u043f\u0435\u0440\u0432\u043e\u0439 \u043f\u043e \u0442\u0440\u0435\u0442\u0438\u0439 \u0441\u0438\u043c\u0432\u043e\u043b <code>echo \"1 2 3\" | cut -c3-</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0435\u0440\u0432\u044b\u0435 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0430 <code>echo -e \"test1,test2,test3\\ntest1,test2,test3\" | cut -d , -f 2-100</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c \u043f\u043e\u043b\u0435\u0439/\u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432 (--delimiter) \u0438 \u043a\u0430\u043a\u0438\u0435 \u0441\u0442\u043e\u043b\u0431\u0446\u044b \u0432\u044b\u0432\u0435\u0441\u0442\u0438 (--fields) \u0441 2 \u043f\u043e 100 <code>echo -e \"test1,test2,test3\\ntest1,test2,test3\" | cut -d , -f 1,3 | sed \"s/,/ /\"</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 1 \u0438 3 <code>echo -e \"test1,test2,test3\\ntest1 test2 test3\" | cut -d , -f 1,3 -s</code> \u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0438, \u0433\u0434\u0435 \u0435\u0441\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c (-s)</p>"},{"location":"Linux/#rev","title":"rev","text":"<p><code>echo \"D:\\plex-content\\Rick.and.Morty.S07.2023.WEBDLRip.MegaPeer\" | rev | cut -d \\\\ -f 1 | rev</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u0432 \u043f\u0443\u0442\u0438 (\u0432\u043d\u0430\u0447\u0430\u043b\u0435 \u0440\u0430\u0437\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u0435\u0442 \u0432\u0441\u044e \u0441\u0442\u0440\u043e\u043a\u0443, \u0437\u0430\u0431\u0438\u0440\u0430\u0435\u0442 \u043f\u0435\u0440\u0432\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u0438 \u0440\u0430\u0437\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u0435\u0442 \u0441\u0442\u0440\u043e\u043a\u0443 \u043e\u0431\u0440\u0430\u0442\u043d\u043e) <code>echo \"D:\\plex-content\\Rick.and.Morty.S07.2023.WEBDLRip.MegaPeer\" | sed -r 's/.+\\\\//'</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0434\u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0441\u043b\u0435\u0448\u0430 <code>echo \"D:\\plex-content\\Rick.and.Morty.S07.2023.WEBDLRip.MegaPeer\" | sed 's/.*\\\\\\(.*\\)/\\1/'</code> \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0432\u0441\u0435 \u0434\u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0441\u043b\u0435\u0448\u0430 \u0438 \u0437\u0430\u0431\u0438\u0440\u0430\u0435\u0442 \u043e\u0434\u043d\u0443 \u0433\u0440\u0443\u043f\u043f\u0443 \u0437\u0430\u0445\u0432\u0430\u0442\u0430, \u0447\u0442\u043e \u043e\u0441\u0442\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u0441\u043b\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f, \u0438 \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0432\u044b\u0432\u043e\u0434 \u043d\u0430 \u043f\u0435\u0440\u0432\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443 (1) <code>echo \"D:\\plex-content\\Rick.and.Morty.S07.2023.WEBDLRip.MegaPeer\" | awk -F '\\\\' '{print $NF}'</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u043c\u0430\u0441\u0441\u0438\u0432\u0430 (NF)</p>"},{"location":"Linux/#tr","title":"tr","text":"<p><code>echo \"10 20 100 200\" | tr 1 2</code> translate \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u0442 1 \u043d\u0430 2 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0441\u043e\u043c\u0432\u043e\u043b\u043e\u0432 (20 20 200 200) <code>echo \"1 2 3\" | tr \" \" \",\"</code> \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u0435\u043b\u044b \u043d\u0430 \u0437\u0430\u043f\u044f\u0442\u044b\u0435 (1,2,3) <code>echo \"1 2 3\" | tr -d \" \"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u0435\u043b\u044b (123)</p>"},{"location":"Linux/#man","title":"man","text":""},{"location":"Linux/#cheatsh","title":"cheat.sh","text":"<p><code>curl cheat.sh/curl</code> <code>curl cheat.sh/grep</code> <code>curl cheat.sh/sed</code> <code>curl cheat.sh/awk</code> <code>curl cheat.sh/jq</code> <code>curl cheat.sh/iptables</code> <code>curl cheat.sh/find</code></p>"},{"location":"Linux/#tldr","title":"tldr","text":"<p><code>pip3 install tldr</code> \u0443\u043f\u0440\u043e\u0449\u0435\u043d\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 man \u0441 \u043f\u0440\u0438\u043c\u0435\u0440\u0430\u043c\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f <code>tldr curl</code> \u0432\u0435\u0431-\u0432\u0435\u0440\u0441\u0438\u044f: https://manned.org/man/curl</p>"},{"location":"Linux/#debug","title":"debug","text":"<p><code>trap 'echo \"$BASH_COMMAND\"' DEBUG</code> \u043f\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u0430\u044f \u043e\u0442\u043b\u0430\u0434\u043a\u0430 \u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0432 bash, \u043a\u043e\u043c\u0430\u043d\u0434\u0430 trap \u043f\u0435\u0440\u0435\u0445\u0432\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0441\u0438\u0433\u043d\u0430\u043b DEBUG, \u043f\u043e\u0441\u044b\u043b\u0430\u0435\u043c\u044b\u0439 \u043f\u0435\u0440\u0435\u0434 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\u043c \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0438 \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u043d\u0430 \u044d\u043a\u0440\u0430\u043d <code>trap 'echo \"$BASH_COMMAND\";read' DEBUG</code> read \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u0432\u0432\u043e\u0434\u0430 \u0441 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b (Enter \u0438\u043b\u0438 Ctrl+C) \u043f\u0435\u0440\u0435\u0434 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\u043c \u043a\u0430\u0436\u0434\u043e\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u043e\u0439 <code>bash -x script.sh</code> \u043e\u0442\u043b\u0430\u0434\u043a\u0430 (\u043f\u0435\u0447\u0430\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434 \u0438 \u0438\u0445 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u043f\u043e \u043c\u0435\u0440\u0435 \u0438\u0445 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f) <code>bash -x -c \"ls -l\" | grep *.sh | awk '{print $5,$NF}'</code> \u0437\u0430\u043f\u0443\u0441\u043a \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0447\u0435\u0440\u0435\u0437 \u0438\u043d\u0442\u0435\u0440\u043f\u0440\u0438\u0442\u0430\u0442\u043e\u0440 bash \u0438 \u0432\u044b\u0432\u043e\u0434 \u043e\u0442\u043b\u0430\u0434\u043a\u0438 <code>bash --debug script.sh</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0430 \u043e\u0448\u0438\u0431\u043a\u0438 <code>apt-get install shellcheck</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c shellcheck <code>shellcheck -S error hwstat.sh</code> error/warning/info/style <code>pip3 install thefuck</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c thefuck <code>bas hwstat.sh</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439 <code>fuck</code> \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0438\u0441\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044e\u044e \u043e\u0448\u0438\u0431\u043e\u0447\u043d\u0443\u044e \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0438\u0437 \u0432\u044b\u043f\u0430\u0434\u0430\u044e\u0449\u0435\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430 (up/down)</p>"},{"location":"Linux/#tools","title":"tools","text":"<p><code>apt install fzf</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c fzf <code>history | fzf</code> \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u043f\u043e\u0438\u0441\u043a \u0441 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0435\u0439 <code>eval $(history | fzf | awk '{print $2}')</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c (eval) \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430 (\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043c\u0430\u043a\u0440\u043e\u0441) <code>ls *.json | fzf | xargs cat | jq .</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e json \u0444\u0430\u0439\u043b\u0430 \u0447\u0435\u0440\u0435\u0437 fzf <code>find / -name \"*.yaml\" | fzf | xargs cat</code> \u043d\u0430\u0439\u0442\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b yaml \u0438 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043f\u043e \u043d\u0438\u043c \u043f\u043e\u0438\u0441\u043a</p> <p><code>pip install toolong</code> <code>tl /var/log/auth.log</code> \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043b\u043e\u0433\u043e\u0432 \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u0438 \u0441 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0435\u0439 <code>tl access.log* --merge</code> \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0444\u0430\u0439\u043b\u043e\u0432</p> <p><code>tree /var/log/</code> \u0434\u0440\u0435\u0432\u043e\u0432\u0438\u0434\u043d\u044b\u0439 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439 \u0438 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 \u0444\u0430\u0439\u043b\u043e\u0432</p> <p><code>echo 'deb http://cz.archive.ubuntu.com/ubuntu jammy main universe' &gt;&gt; /etc/apt/sources.list &amp;&amp; apt update</code> <code>apt install exa</code> <code>exa $(pwd) -l --icons</code> \u0430\u043d\u0430\u043b\u043e\u0433 ls</p> <p><code>column /etc/passwd -t -s \":\"</code> <code>netcheck -t ping yandex.ru us1.node.check-host.net | sed -r 's/\"//g; s/,$//; s/\\{|\\}|\\[|\\]//' | column -t -s \":\"</code> \u0440\u0430\u0441\u043f\u0430\u0440\u0441\u0438\u0442\u044c JSON \u0438 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0442\u0441\u0442\u0443\u043f (\u0442\u0430\u0431\u0443\u043b\u044f\u0446\u0438\u044e) \u0434\u043b\u044f \u043a\u043e\u043b\u043e\u043d\u043e\u043a</p> <p><code>ls /home | wc -l</code> word count \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0442\u0440\u043e\u043a (--line) <code>ls /home | wc -w</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u043b\u043e\u0432 (--words) <code>ls /home | wc -m</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u043c (--chars) <code>ls /home | wc -c</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432/\u0431\u0430\u0439\u0442 (--bytes)</p> <p><code>echo \"(5.5-2.2)\" | bc</code> \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f <code>echo \"(5.5-2.2)\" | bc | sed -E \"s/\\..+//\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0447\u0430\u0441\u0442\u044c <code>echo \"1 &lt; 2\" | bc</code> \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0431\u0443\u043b\u0435\u0432\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 (1 - \u0434\u0430 \u0438\u043b\u0438 0 - \u043d\u0435\u0442) <code>echo \"1 &gt; 2\" | bc</code> false (0) <code>icmp_ignore=$(cat /proc/sys/net/ipv4/icmp_echo_ignore_all)</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>if (( $(echo \"$icmp_ignore == 1\" | bc) )); then echo \"true\"; else echo \"false\"; fi</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0432 \u0443\u0441\u043b\u043e\u0432\u0438\u0438 \u0430\u0440\u0435\u0444\u043c\u0435\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 \u0440\u0430\u0432\u0435\u043d\u0441\u0442\u0432\u043e (\u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 0 - false \u0438\u043b\u0438 1 - true)</p> <p><code>a=1</code> <code>b=0.55</code> <code>echo $(bc &lt;&lt;&lt; \"scale=2; $a+$b\")</code> <code>echo \"print $a+$b\" | perl</code> <code>echo \"print($a+$b)\" | python3</code> <code>echo \"print($a+$b)\" | lua</code> <code>echo \"puts $a+$b\" | ruby</code> <code>pwsh -Command $a+$b</code></p> <p><code>echo -e \"key1\\nkey2\\nkey3\" &gt; 1.txt</code> <code>echo -e \"value1\\nvalue2\\nvalue3\" &gt; 2.txt</code> <code>paste 1.txt 2.txt -d :</code> \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0435\u0442 \u0434\u0432\u0430 \u0444\u0430\u0439\u043b\u0430 \u0432 \u043e\u0434\u0438\u043d \u043c\u043d\u043e\u0433\u043e\u043a\u043e\u043b\u043e\u043d\u043e\u0447\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434 <code>cat /etc/passwd | paste -s -d +</code> \u043e\u0431\u044a\u0435\u0434\u0435\u043d\u0438\u0442\u044c (join) \u043c\u043d\u043e\u0433\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u044b\u0439 \u0444\u0430\u0439\u043b, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 delimiter</p> <p><code>echo -e \"test1\\ntest2\" &gt; 1.txt</code>echo -e \"test\\ntest2\\ntest3\" &gt; 2.txt <code>diff 1.txt 2.txt -c</code> ! \u0435\u0441\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f, + \u0435\u0441\u0442\u044c \u043d\u043e\u0432\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 <code>diff 1.txt 2.txt -yi</code> \u0441\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u0435\u0442 \u0432 \u0434\u0432\u0435 \u043a\u043e\u043b\u043e\u043d\u043a\u0438 (| \u0435\u0441\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f, + \u0435\u0441\u0442\u044c \u043d\u043e\u0432\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430) \u0438 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440 (-i) <code>diff 1.txt 2.txt -u</code> \u043e\u0431\u044a\u0435\u0434\u0435\u043d\u044f\u0435\u0442 \u0434\u0432\u0430 \u0444\u0430\u0439\u043b\u0430 \u0432 \u043e\u0434\u0438\u043d \u0432\u044b\u0432\u043e\u0434 \u0441 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435\u043c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 (+/) <code>diff 1.txt 2.txt -ibBEt</code> \u043d\u0435 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0431\u0435\u043b\u044b (-b) \u0438 \u043f\u0443\u0441\u0442\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 (-B), \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0442\u0430\u0431\u0443\u043b\u044f\u0446\u0438\u044f\u0445 (-E) \u0438 \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0442\u0430\u0431\u0443\u043b\u044f\u0446\u0438\u0438 \u043d\u0430 \u043f\u0440\u043e\u0431\u0435\u043b\u044b \u0432 \u0432\u044b\u0432\u043e\u0434\u0435 (-t) <code>diff -c &lt;(echo \"$predu\") &lt;(echo \"$du\")</code> \u0441\u0440\u0430\u0432\u043d\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445</p> <p><code>snap install diff-so-fancy</code> <code>diff -u file-1.txt file-2.txt | diff-so-fancy</code></p> <p><code>apt install jdupes</code> <code>jdupes .</code> \u043f\u043e\u0438\u0441\u043a \u0434\u0443\u0431\u043b\u0438\u043a\u0430\u0442\u043e\u0432</p> <p><code>cat /etc/passwd | sort -r</code> \u043e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043f\u043e \u0430\u043b\u0444\u043e\u0432\u0438\u0442\u0443 \u0432 \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u043c \u043f\u043e\u0440\u044f\u0434\u043a\u0435 (-r) <code>du -h ~ | sort -n</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0430\u0440\u0438\u0444\u043c\u0435\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u043c\u0443 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044e (-n) \u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u043e\u0432 \u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439 <code>ls -l | sed 1d | sort -nk5</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u043e \u043f\u044f\u0442\u043e\u0439 \u043a\u043e\u043b\u043e\u043d\u043a\u0435 (-k) <code>cat $tmp | sort -t \".\" -nk4</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0447\u0435\u0442\u0432\u0435\u0440\u0442\u043e\u0439 \u043a\u043e\u043b\u043e\u043d\u043a\u0435, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c (-t) \u0442\u043e\u0447\u043a\u0443</p> <p><code>echo -e \"1 2\\n1 2\\n2 1\\n1 2\" | uniq</code> \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0441\u043e\u0441\u0435\u0434\u043d\u0438\u0435 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 <code>echo -e \"1 2\\n1 2\\n2 1\\n1 2\" | sort | uniq</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0434\u0443\u0431\u043b\u0438\u043a\u0430\u0442\u044b <code>echo -e \"1 2\\n1 2\\n2 1\\n1 2\" | sort | uniq -c</code> \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0432 \u043d\u0430\u0447\u0430\u043b\u043e \u043a\u0430\u0436\u0434\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u043a\u043e\u043b-\u0432\u043e \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439 <code>echo -e \"1 2\\n1 2\\n2 1\\n1 2\" | sort | uniq -u</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438, \u0431\u0435\u0437 \u0441\u0442\u0440\u043e\u043a \u0441 \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u044f\u043c\u0438</p> <p><code>ls -l | fold -w 50</code> \u0437\u0430\u0434\u0430\u0442\u044c \u0448\u0438\u0440\u0438\u043d\u0443 \u0432\u044b\u0432\u043e\u0434\u0430 \u043a\u0430\u0436\u0434\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438, \u0432\u044b\u043f\u0430\u0434\u0430\u044e\u0449\u0435\u0435 \u0437\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u043f\u0440\u0435\u0434\u0435\u043b \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0438\u0442\u0441\u044f \u043d\u0430 \u043d\u043e\u0432\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 <code>ls -l | fold -w 50 -s</code> \u0440\u0430\u0437\u0431\u0438\u0432\u0430\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0441\u0438\u043c\u0432\u043e\u043b\u0430\u0445 \u043f\u0440\u043e\u0431\u0435\u043b\u0430 (--space)</p> <p><code>cat /var/log/syslog | head -n 5</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u043f\u0435\u0440\u0432\u044b\u0435 5 \u0441\u0442\u0440\u043e\u043a \u0444\u0430\u0439\u043b\u0430</p> <p><code>cat /var/log/syslog | tail -n 5</code> \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 5 \u0441\u0442\u0440\u043e\u043a \u0444\u0430\u0439\u043b\u0430 <code>tail -f /var/log/syslog</code> \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438</p> <p><code>apt install multitail</code> <code>multitail -f /var/log/auth.log -f /var/log/kern.log</code> <code>multitail -l \"journalctl -fu ssh\" -l \"journalctl -fu cron\"</code></p> <p><code>less /var/log/dmesg</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043b\u043e\u0433 \u044f\u0434\u0440\u0430 \u0441 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u043f\u0440\u043e\u043b\u0438\u0441\u0442\u044b\u0432\u0430\u043d\u0438\u044f</p> <p><code>watch df -h</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u043d\u0430 \u044d\u043a\u0440\u0430\u043d \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432 \u043a\u0430\u0436\u0434\u044b\u0435 2 \u0441\u0435\u043a\u0443\u043d\u0434\u044b</p> <p><code>echo \"line1\" | tee test.txt</code> \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0444\u0430\u0439\u043b (&gt;) <code>ls &gt; /dev/null</code> \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u0432 null <code>echo \"line2\" | tee -a test.txt</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c (&gt;&gt;) \u0442\u0435\u043a\u0441\u0442 \u043d\u043e\u0432\u043e\u0439 \u0441\u0442\u0440\u043e\u0439\u043e\u043a\u0439 \u0432 \u043a\u043e\u043d\u0435\u0446 \u0444\u0430\u0439\u043b\u0430 <code>echo -e \"line3\\nline4\" &gt;&gt; test.txt</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0434\u0432\u0435 \u043d\u043e\u0432\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438</p> <p><code>du -a /var/log | awk '{print $2}' | xargs fincore</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043f\u0435\u0440\u0432\u043e\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043f\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u043e \u0432 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439</p> <p><code>split -l 100 input_file.txt output_prefix</code> \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u044c \u0444\u0430\u0439\u043b \u043d\u0430 \u0447\u0430\u0441\u0442\u0438 \u043f\u043e 100 \u0441\u0442\u0440\u043e\u043a \u0432 \u043a\u0430\u0436\u0434\u043e\u0439 <code>split -b 10M input_file.txt output_prefix</code> \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u044c \u0444\u0430\u0439\u043b \u043d\u0430 \u0447\u0430\u0441\u0442\u0438 \u043f\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c\u0443 \u0440\u0430\u0437\u043c\u0435\u0440\u0443 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, 10MB)</p>"},{"location":"Linux/#find","title":"find","text":"<p><code>find / -name \"*.sql\"</code> \u043d\u0430\u0439\u0442\u0438 \u0444\u0430\u0439\u043b\u044b, \u043d\u0430\u0447\u0430\u0442\u044c \u043f\u043e\u0438\u0441\u043a \u0441 \u043a\u043e\u0440\u043d\u044f (/) <code>find / -iname \"mysql\"</code> \u043d\u0430\u0439\u0442\u0438 \u0444\u0430\u0439\u043b\u044b \u043d\u0435 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440 (-i) <code>find ~ -name \"test.*\" -not -name \"*.conf\"</code> \u043d\u0430\u0439\u0442\u0438 \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u0441 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 test, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u043c\u0435\u044e\u0442 \u043b\u044e\u0431\u043e\u0435 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435, \u0437\u0430 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c (-not) \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f .conf <code>find ~ -amin -10</code> \u043f\u043e\u0438\u0441\u043a \u0444\u0430\u0439\u043b\u043e\u0432 \u043f\u043e \u0434\u0430\u0442\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0447\u0442\u0435\u043d\u0438\u044f (-amin) \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0440\u043e\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u043b\u0438\u0441\u044c (cat/nano) \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 10 \u043c\u0438\u043d\u0443\u0442 <code>find ~ -type f -mmin -10</code> \u043d\u0430\u0439\u0442\u0438 \u0444\u0430\u0439\u043b\u044b (-type f), \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u044b\u043b\u0438 \u043c\u043e\u0434\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 10 \u043c\u0438\u043d\u0443\u0442 (-nmin) <code>find ~ -type f -mtime +1 -mtime -7</code> \u043d\u0430\u0439\u0442\u0438 \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b, \u043c\u043e\u0434\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043c\u0435\u0436\u0434\u0443 1 \u0438 7 \u0434\u043d\u044f\u043c\u0438 \u043d\u0430\u0437\u0430\u0434 <code>find ~ -type d -mtime +1 -mtime -7</code> \u043f\u043e\u0438\u0441\u043a \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439 <code>find ~ -size +50M -size -100M</code> \u043f\u043e\u0438\u0441\u043a \u0444\u0430\u0439\u043b\u043e\u0432 \u0432 Linux \u043f\u043e \u0438\u0445 \u0440\u0430\u0437\u043c\u0435\u0440\u0443, \u043e\u0442 50 \u0434\u043e 100 \u043c\u0435\u0433\u0430\u0431\u0430\u0439\u0442 <code>find / -perm 444</code> \u043f\u043e\u0438\u0441\u043a \u0444\u0430\u0439\u043b\u043e\u0432 \u043f\u043e \u0440\u0435\u0436\u0438\u043c\u0443 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 (\u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0432\u0441\u0435\u0445) <code>find /home/lifailon/ -user root</code> \u043f\u043e\u0438\u0441\u043a \u0444\u0430\u0439\u043b\u043e\u0432 \u043f\u043e \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0443 <code>find /home/lifailon/ -group root</code> \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0433\u0440\u0443\u043f\u043f\u0435 <code>find /root/ -empty</code> \u043f\u043e\u0438\u0441\u043a \u043f\u0443\u0441\u0442\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u0438\u043b\u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439</p>"},{"location":"Linux/#exec","title":"exec","text":"<p><code>touch -t 202306222200.15 /tmp/test.txt</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0434\u0430\u0442\u043e\u0439 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f <code>find /tmp -type f -mtime +30 -exec rm -f {} \\;</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b, \u043a\u043e\u0442\u043e\u044b\u0440\u0435 \u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u044f\u043b\u0438\u0441\u044c \u0431\u043e\u043b\u044c\u0448\u0435 30 \u0434\u043d\u0435\u0439 <code>find /tmp -type f -name \"*.txt\" -exec rm -f {} \\;</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 tmp <code>dd if=/dev/zero of=/var/log/test.log count=11 bs=1M</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0439 \u043d\u0443\u043b\u044f\u043c\u0438 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430 <code>find /var/log -type f -name \"*.log\" -size +10M -exec rm -f {} \\;</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u043b\u043e\u0433-\u0444\u0430\u0439\u043b\u044b, \u043e\u0431\u044a\u0451\u043c\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u0435 10 \u041c\u0431\u0430\u0439\u0442</p>"},{"location":"Linux/#locate","title":"locate","text":"<p><code>cargo install locate</code> <code>updatedb</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u043d\u0434\u0435\u043a\u0441\u044b \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 <code>locate filename.txt</code> \u043d\u0430\u0439\u0442\u0438 \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u0444\u0430\u0439\u043b\u0430 <code>locate -i filename.txt</code> \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440 <code>locate '*.jpg'</code> \u043d\u0430\u0439\u0442\u0438 \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u043f\u043e \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044e <code>locate -n 10 filename.txt</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 10 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 <code>locate -d /path/to/directory filename.txt</code> <code>locate -r 'pattern.*\\.txt$'</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0440\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f</p>"},{"location":"Linux/#cron","title":"cron","text":"<p><code>ls /etc/cron.d/</code> \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 (atop, sysstat) <code>ls -l /etc/cron.hourly &amp;&amp; ls -l /etc/cron.daily &amp;&amp; ls -l /etc/cron.weekly &amp;&amp; ls -l /etc/cron.monthly</code> \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0434\u043b\u044f \u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0430\u0434\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0440\u0430\u0437 \u0432 \u0447\u0430\u0441, \u0434\u0435\u043d\u044c, \u043d\u0435\u0434\u0435\u043b\u044e \u0438 \u043c\u0435\u0441\u044f\u0446 <code>crontab -l</code> \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0437\u0430\u0434\u0430\u0447 <code>crontab -l | grep -Pv \"^$|^#\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u044f <code>crontab -u lifailon -l</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f root <code>crontab -e</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 \u043e\u0442 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>sudo crontab -u root -e</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 \u043e\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f root <code>crontab -r</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0432\u0441\u0435 \u0437\u0430\u0434\u0430\u0447\u0438</p> <p><code>cat /etc/crontab</code></p> <pre><code>#### # .---------------- \u043c\u0438\u043d\u0443\u0442\u0430 (0 - 59)\n#### # |  .------------- \u0447\u0430\u0441 (0 - 23)\n#### # |  |  .---------- \u043c\u0435\u043d\u044c \u043c\u0435\u0441\u044f\u0446\u0430 (1 - 31)\n#### # |  |  |  .------- \u043c\u0435\u0441\u044f\u0446 (1 - 12) \u0438\u043b\u0438 jan,feb,mar,apr...\n#### # |  |  |  |  .---- \u0434\u0435\u043d\u044c \u043d\u0435\u0434\u0435\u043b\u0438 (0 - 6) (\u0412\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c 0 \u0438\u043b\u0438 7) \u0438\u043b\u0438 sun,mon,tue,wed,thu,fri,sat\n#### # |  |  |  |  |\n#### # *  *  *  *  * user-name command to be executed\n####  17  *  *  *  *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly\n####  25  6  *  *  *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )\n####  47  6  *  *  7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )\n####  52  6  1  *  *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )\n</code></pre> <p><code>0,14,29,44 * * * *</code> \u043a\u0430\u0436\u0434\u044b\u0435 15 \u043c\u0438\u043d\u0443\u0442 <code>*/15 * * * *</code> \u043a\u0430\u0436\u0434\u044b\u0435 15 \u043c\u0438\u043d\u0443\u0442</p> <p><code>00 23 * * * systemctl restart zabbix-agent &amp;&amp; echo $(date): Reboot Zabbix Agent use cron &gt;&gt; /var/log/reboot.log</code> \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a \u0441\u043b\u0443\u0436\u0431\u044b \u043a\u0430\u0436\u0434\u044b\u0439 \u0434\u0435\u043d\u044c \u0432 23:00 \u0438 \u043f\u0438\u0441\u0430\u0442\u044c \u0432 \u043b\u043e\u0433 <code>00 03 * * 6 echo $(date): Reboot Operating System use cron &gt;&gt; /var/log/reboot.log &amp;&amp; /sbin/reboot</code> \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u0432 \u0441\u0443\u0431\u0431\u043e\u0442\u0443 \u0432 3 \u0447\u0430\u0441\u0430 \u043d\u043e\u0447\u0438 <code>@reboot date &gt;&gt; ~/date-reboot.log</code> \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438</p> <p><code>journalctl -eu cron</code> <code>cat /var/log/syslog | grep -i cron</code></p> <pre><code>#!/bin/bash\naddr=\"google.com\"\npath=\"/var/log/icmp-test.log\"\ndate=$(date | awk '{print $3,$2,$4}')\nloss=$(ping -c 2 $addr | grep -Ewo \"[0-9]+%\")\nif [ $loss = \"100%\" ]; then\n    echo \"$date: $addr - unavailable\" &gt;&gt; $path\nelse\n    echo \"$date: $addr - available\" &gt;&gt; $path\nfi\n</code></pre> <p><code>echo \"*/1 * * * * bash /root/google-icmp-test.sh\" &gt;&gt; /var/spool/cron/crontabs/root</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0449\u0438\u043a \u043d\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0441\u043a\u0440\u0438\u043f\u0442\u0430 \u043a\u0430\u0436\u0434\u0443\u044e \u043c\u0438\u043d\u0443\u0442\u0443</p> <p><code>cp /etc/hosts /etc/hosts.bak</code> backup \u0444\u0430\u0439\u043b\u0430 <code>echo \"11.11.11.11 google.com\" &gt;&gt; /etc/hosts</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0434\u0440\u0435\u0441 \u0434\u043b\u044f \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u0445\u043e\u0441\u0442\u0430 <code>cp /etc/hosts.bak /etc/hosts</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0444\u0430\u0439\u043b <code>cat /var/log/icmp-test.log | grep unavailable</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043b\u043e\u0433 \u043f\u043e unavailable</p>"},{"location":"Linux/#systemctl","title":"systemctl","text":"<p><code>systemctl reload ssh</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0441\u0435\u0440\u0432\u0438\u0441\u0430 \u0438\u0437 \u0444\u0430\u0439\u043b\u0430 \u044e\u043d\u0438\u0442\u0430 (\u0435\u0441\u043b\u0438 \u0443 \u044e\u043d\u0438\u0442\u0430 \u0435\u0441\u0442\u044c \u044d\u0442\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u044f) <code>systemctl status ssh</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b, \u044e\u043d\u0438\u0442\u043e\u0432 (\u0432 \u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0435 Failed) \u0438 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 <code>systemctl status sshd | grep -P \"Active.+;\" | sed -r \"s/.+; | ago//g\"</code> \u0432\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441\u043b\u0443\u0436\u0431\u044b <code>systemctl start ssh</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u044e\u043d\u0438\u0442 (\u0434\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438) <code>systemctl stop ssh</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u044e\u043d\u0438\u0442 (\u0434\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438) <code>systemctl restart ssh</code> \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0438\u0441 <code>systemctl enable ssh</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0430\u0432\u0442\u043e\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443 <code>systemctl disable ssh</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437 \u0430\u0432\u0442\u043e\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 <code>systemctl mask ssh</code> \u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u044e\u043d\u0438\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435\u043b\u044c\u0437\u044f \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0438\u043b\u0438 \u043a\u0430\u043a \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044c (\u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0441\u0438\u043c\u043b\u0438\u043d\u043a \u043d\u0430 /dev/null) <code>systemctl unmask ssh</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u044e\u043d\u0438\u0442 (\u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0438\u043c\u043b\u0438\u043d\u043a) <code>systemctl daemon-reload</code> \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u044e\u043d\u0438\u0442 systemd <code>systemctl cat ssh</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u0443\u0442\u044c \u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 unit-\u0444\u0430\u0439\u043b\u0430 <code>systemctl edit --full ssh</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0444\u0430\u0439\u043b \u044e\u043d\u0438\u0442\u0430 <code>systemctl list-dependencies ssh</code> \u0434\u0435\u0440\u0435\u0432\u043e \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439 <code>systemctl list-dependencies ssh --reverse</code> \u0437\u0430\u0432\u0438\u0441\u044f\u0449\u0438\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u044b \u043e\u0442 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u044e\u043d\u0438\u0442\u0430 <code>systemctl list-units --type service --all</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 <code>systemctl list-unit-files | sed \"1d;$ d\" | sed \"$ d\" | wc</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u043e\u043b-\u0432\u043e \u0432\u0441\u0435\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 \u043d\u0430 \u0434\u0438\u0441\u043a\u0435 <code>systemctl list-unit-files | grep zabbix</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0438\u043c\u0435\u043d\u0438 <code>systemctl list-unit-files --type=service</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 <code>systemctl list-unit-files --type=service --state=enabled</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432, \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0432 \u0430\u0432\u0442\u043e\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443 <code>systemctl list-units --all --type=service --plain --no-legend --no-pager --output=json</code> <code>--all</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u0432\u0441\u0435 \u0442\u0438\u043f\u044b \u044e\u043d\u0438\u0442\u043e\u0432, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435, \u043d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0435 <code>--type=service</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435 \u0441\u043b\u0443\u0436\u0431\u044b \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u0435 systemd (\u043d\u0435 \u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432 \u0432\u044b\u0432\u043e\u0434 \u0434\u0440\u0443\u0433\u0438\u0435 \u0442\u0438\u043f\u044b \u044e\u043d\u0438\u0442\u043e\u0432, \u0442\u0430\u043a\u0438\u0435 \u043a\u0430\u043a socket \u0438\u043b\u0438 device) <code>--plain</code> \u0432\u044b\u0432\u043e\u0434 \u0432 \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u0431\u0435\u0437 \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f <code>--no-legend</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432\u044b\u0432\u043e\u0434 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u043e\u0432 \u0434\u043b\u044f \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432 <code>--no-pager</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0441\u0442\u0440\u0430\u043d\u0438\u0447\u043d\u043e\u0433\u043e \u0432\u044b\u0432\u043e\u0434\u0430 (less) <code>ls /usr/lib/systemd/system</code> \u044e\u043d\u0438\u0442\u044b \u043f\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u0435 \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 \u0438 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c\u044b\u043c\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\u043c\u0438 <code>ls /run/systemd/system</code> \u044e\u043d\u0438\u0442\u044b \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438 \u0432 runtime <code>ls /etc/systemd/system</code> \u044e\u043d\u0438\u0442\u044b \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u0433\u043e \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430</p>"},{"location":"Linux/#unit","title":"unit","text":"<pre><code>#!/bin/bash\nwhile true; do\n    addr=\"google.com\"\n    path=\"/var/log/icmp-test.log\"\n    date=$(date | awk '{print $3,$2,$4}')\n    loss=$(ping -c 2 $addr | grep -Ewo \"[0-9]+%\")\n    if [ $loss = \"100%\" ]; then\n        echo \"$date: $addr - unavailable\" &gt;&gt; $path\n    else\n        echo \"$date: $addr - available\" &gt;&gt; $path\n        tail -n 1 $path\n    fi\n    sleep 5\ndone\n</code></pre> <p><code>nano /etc/systemd/system/icmp-test-log.service</code></p> <pre><code>[Unit]\nDescription=icmp test output to log\nAfter=network.target\n\n[Service]\nExecStart=/bin/bash \"/root/google-icmp-test.sh\"\nExecReload=/bin/kill -HUP $MAINPID\nKillMode=process\nRestart=on-failure\nType=simple\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <p><code>systemctl daemon-reload</code> <code>systemctl enable icmp-test-log.service</code> <code>systemctl start icmp-test-log</code> <code>systemctl status icmp-test-log</code> <code>tail -f /var/log/icmp-test.log</code></p>"},{"location":"Linux/#journalctl","title":"journalctl","text":"<p><code>journalctl -eu ssh</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0441 \u043a\u043e\u043d\u0446\u0430 (-e) \u043e\u0442 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0430 (-u) <code>journalctl _PID=3972315</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043f\u043e PID \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 <code>journalctl --since today</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0437\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f <code>journalctl -fu ssh</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438 (-f) <code>ournalctl -p 3</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0448\u0438\u0431\u043a\u0438 \u0438 \u0432\u044b\u0448\u0435 \u043f\u043e \u0432\u0430\u0436\u043d\u043e\u0441\u0442\u0438: \u043d\u0435\u0440\u0430\u0431\u043e\u0442\u043e\u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c(0)/alerts(1)/critical(2)/errors(3)/warning(4)/notice(5)/info(6)/debug(7) <code>journalctl -ek</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u044f\u0434\u0440\u0430 (kernel) <code>journalctl -S \"2023-09-01 12:00:00\" -U \"2023-09-01 15:00:00\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043e\u0442 (-S) 1 \u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f 12:00 \u043f\u043e (-U) 15:00 <code>journalctl -b</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0441 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b (boot) <code>journalctl --list-boots</code> \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0445 \u0437\u0430\u0433\u0440\u0443\u0437\u043e\u043a \u0441\u0438\u0441\u0442\u0435\u043c\u044b <code>journalctl -b ba6b2292a0e84d83a81cedfaa221926f</code> \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0441 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b <code>journalctl --disk-usage</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043e\u0431\u0449\u0438\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u043b\u043e\u0433 \u0444\u0430\u0439\u043b\u043e\u0432 \u043d\u0430 \u0434\u0438\u0441\u043a\u0435 <code>journalctl --vacuum-time=1month</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043b\u043e\u0433\u0438, \u0434\u0430\u0432\u043d\u043e\u0441\u0442\u044c\u044e \u0431\u043e\u043b\u044c\u0448\u0435 1-\u0433\u043e \u043c\u0435\u0441\u044f\u0446\u0430 <code>journalctl --vacuum-size=100M</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043b\u043e\u0433\u0438, \u0447\u0442\u043e\u0431\u044b \u0440\u0430\u0437\u043c\u0435\u0440 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u043b \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c\u0443 <code>g</code> \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043d\u0430\u0447\u0430\u043b\u043e \u043b\u0438\u0441\u0442\u0438\u043d\u0433\u0430 <code>G</code> \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043a\u043e\u043d\u0435\u0446 <code>nano /etc/systemd/journald.conf</code> <code>SystemMaxUse=400M</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043b\u0438\u043c\u0438\u0442 \u0437\u0430\u043f\u0438\u0441\u0438</p>"},{"location":"Linux/#dmesg","title":"dmesg","text":"<p><code>dmesg -Tx</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u043b\u043e\u0433\u0438 \u0431\u0443\u0444\u0435\u0440\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u044f\u0434\u0440\u0430 (/var/log/dmesg), \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0437\u0430\u043f\u0438\u0441\u0438 \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043f\u043e\u043a\u0430 \u0441\u0435\u0440\u0432\u0438\u0441 Syslog \u0435\u0449\u0451 \u043d\u0435 \u0437\u0430\u043f\u0443\u0449\u0435\u043d <code>dmesg -Tx -l crit,err</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 <code>dmesg -E</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043b\u043e\u0433\u0438\u0440\u0432\u043e\u0430\u043d\u0438\u0435 \u044f\u0434\u0440\u0430 \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c (--console-on) <code>dmesg -D</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c (--console-off)  <code>dmesg -n 1</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u043b\u044f \u043f\u0435\u0447\u0430\u0442\u0438 \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c <code>dmesg -u</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u0438\u0437 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>dmesg -w</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u0436\u0443\u0440\u043d\u0430\u043b \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438 (\u0436\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0445 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439)</p>"},{"location":"Linux/#hardware","title":"hardware","text":"<p><code>systemd-analyze</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u041e\u0421 (Kernel - \u0432\u0440\u0435\u043c\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u044f\u0434\u0440\u0430) \u0438 userspace <code>systemd-analyze blame</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0438 \u043e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 <code>systemd-analyze blame | grep zabbix</code> <code>systemd-analyze plot &gt; graph.svg</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0435\u043a\u0442\u043e\u0440\u043d\u044b\u0439 \u043e\u0442\u0447\u0435\u0442 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 Scalable Vector Graphics \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0439 XML</p> <p><code>history</code> \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u043a\u043e\u043c\u0430\u043d\u0434 <code>history -c</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e</p> <p><code>who -b</code> \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f <code>last</code> \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 <code>last -n 5 reboot</code> \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 <code>last shutdown</code> \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439</p> <p><code>arch</code> \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u044b <code>lsb_release -a</code> \u0432\u0435\u0440\u0441\u0438\u044f \u0434\u0438\u0441\u0442\u0440\u0438\u0431\u0443\u0442\u0438\u0432\u0430 <code>uname -srv</code> \u0432\u0435\u0440\u0441\u0438\u044f \u044f\u0434\u0440\u0430 <code>cat /proc/version</code> \u0432\u0435\u0440\u0441\u0438\u044f \u044f\u0434\u0440\u0430 \u0438 \u0434\u0438\u0441\u0442\u0440\u0438\u0431\u0443\u0442\u0438\u0432\u0430 <code>cat /etc/os-release</code> \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0434\u0438\u0441\u0442\u0440\u0438\u0431\u0443\u0442\u0438\u0432\u0430 \u0438 \u0432\u0435\u0440\u0441\u0438\u044f \u041e\u0421 <code>hostnamectl</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f (Operating System, Kernel, Architecture, Hardware Vendor/Model)</p> <p><code>uptime</code> \u0432\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441\u0438\u0441\u0442\u0435\u043c\u044b, \u043a\u043e\u043b-\u0432\u043e \u0437\u0430\u043b\u043e\u0433\u0438\u043d\u0435\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, Load average - \u0441\u0440\u0435\u0434\u043d\u044f\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 1, 5 \u0438 15 \u043c\u0438\u043d\u0443\u0442 (2.00 - \u044d\u0442\u043e 100% \u043d\u0430 \u0434\u0432\u0430 \u044f\u0434\u0440\u0430) <code>dmidecode -t bios</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0438\u0441\u0442\u0435\u043c\u0435 (system/baseboard/processor/memory) <code>dmidecode -s bios-vendor</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0438\u0441\u0442\u0435\u043c\u0435 (bios-version/bios-release-date/baseboard-manufacturer/system-manufacturer/processor-version) <code>dmidecode -t baseboard</code> \u0432\u0435\u0440\u0441\u0438\u044f \u043c\u0430\u0442\u0435\u0440\u0438\u043d\u0441\u043a\u043e\u0439 \u043f\u043b\u0430\u0442\u044b, Video \u0438 Sound \u0438 \u0438\u0445 \u0441\u0442\u0430\u0442\u0443\u0441</p> <p><code>nproc</code> \u043a\u043e\u043b-\u0432\u043e \u044f\u0434\u0435\u0440 <code>lscpu</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0435 <code>cat /proc/cpuinfo</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0435 <code>cat /proc/cpuinfo | grep \"core id\" | wc -l</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u044f\u0434\u0435\u0440 (\u0431\u0435\u0437 \u0443\u0447\u0435\u0442\u0430 \u043f\u043e\u0442\u043e\u043a\u043e\u0432) <code>cat /proc/partitions</code> \u043f\u0435\u0440\u0435\u0447\u0438\u0441\u043b\u044f\u0435\u0442 \u0432\u0441\u0435 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0438 \u0440\u0430\u0437\u0434\u0435\u043b\u044b \u043d\u0430 \u044d\u0442\u0438\u0445 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430\u0445 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f <code>cat /proc/asound/cards</code> Audio PCI <code>cat /proc/cmdline</code> \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0438\u043c\u044f \u0444\u0430\u0439\u043b\u0430 \u043e\u0431\u0440\u0430\u0437\u0430 \u044f\u0434\u0440\u0430 \u0438 \u0435\u0433\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u044b\u043b\u0438 \u0443\u043a\u0430\u0437\u0430\u043d\u044b \u0432 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u0447\u0438\u043a\u0430 GRUB (\u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u044b\u043b\u0438 \u0432\u0432\u0435\u0434\u0435\u043d\u044b \u0432\u0440\u0443\u0447\u043d\u0443\u044e) <code>cat /etc/default/grub</code> \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u0430 update-grub \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u0430 /boot/grub/grub.cfg <code>cat /boot/grub/grub.cfg</code> \u043a\u043e\u043c\u0430\u043d\u0434\u0430 update-grub \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u0442 \u044d\u0442\u043e\u0442 \u0444\u0430\u0439\u043b \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u043c\u0438, \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u0432 \u0444\u0430\u0439\u043b\u0435 /etc/default/grub <code>cat /proc/loadavg</code> \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0438\u043b\u0438 \u043f\u043e\u0442\u043e\u043a\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0442\u0441\u044f, \u043d\u0430\u0445\u043e\u0434\u044f\u0442\u0441\u044f \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u043d\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0438\u043b\u0438 \u0436\u0434\u0443\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439 \u0432\u0432\u043e\u0434\u0430/\u0432\u044b\u0432\u043e\u0434\u0430 \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 1, 5 \u0438 15 \u043c\u0438\u043d\u0443\u0442. 4-\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u044d\u0442\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u044b\u0445 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442/\u043e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435. \u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u044d\u0442\u043e PID \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430.</p> <p><code>lspci</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430\u0445, \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0435 \u043a \u043c\u0430\u0442\u0435\u0440\u0438\u043d\u0441\u043a\u043e\u0439 \u043f\u043b\u0430\u0442\u0435 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u043f\u043e \u0448\u0438\u043d\u0435 PCIe <code>lspci | grep -i vga</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043a\u0430\u043a\u0430\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0432\u0438\u0434\u0435\u043e\u043a\u0430\u0440\u0442\u0430 (VGA controller) <code>lspci | grep -i audio</code> Audio controller <code>lspci | grep -i ethernet</code> Ethernet controller <code>lspci | grep -i scsi</code> SCSI storage controller <code>lspci | grep -i sata</code> SATA storage controller <code>lspci | grep \"USB controller\"</code> <code>lspci | grep 02:00.0</code> \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043f\u043e \u0441\u043b\u043e\u0442\u0443 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 <code>lspci -vv | grep -iE \"driver\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0445 \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u043e\u0432 \u044f\u0434\u0440\u0430 \u0434\u043b\u044f \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432 <code>lsusb -vt</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e USB \u0443\u0441\u0442\u043e\u0439\u0441\u0442\u0432\u0430\u0445 (\u043f\u0440\u0438\u043d\u0442\u0435\u0440\u044b, Bluetooth \u0430\u0434\u0430\u043f\u0442\u0435\u0440, \u043c\u044b\u0448\u043a\u0430, \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u0430)</p> <p><code>lshw -short</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043f\u043e \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0443 <code>lshw -class bus</code> Motherboard/USB <code>lshw -class display</code> VGA controller <code>lshw -class network</code> <code>lshw -class disk</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0436\u0435\u0441\u0442\u043a\u043e\u043c \u0434\u0438\u0441\u043a\u0435 (product, vendor, size, capabilities: 7200rpm) <code>lshw | grep product</code></p> <p><code>ls /sys/class/net</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 <code>cat /proc/net/dev</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 \u0438 \u0438\u0445 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 (bytes, packets, errs, drop) \u0434\u043b\u044f Receive (\u041f\u0440\u0438\u0435\u043c) \u0438 Transmit (\u041f\u0435\u0440\u0435\u0434\u0430\u0447\u0430) <code>ethtool -S ens33</code> \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 (\u0434\u043b\u044f \u0441\u0431\u0440\u043e\u0441\u0430 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438 \u043d\u0443\u0436\u043d\u043e ip down \u0438 \u0432\u044b\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u044f\u0434\u0440\u0430 \u0441 \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u043e\u0432 modprobe -r module \u0438 \u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043e\u0431\u0440\u0430\u0442\u043d\u043e) <code>ethtool ens33 | grep -Ei \"wake-on|speed\"</code> \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 Wake-on-Lan \u0438 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 <code>ethtool -i ens33</code> \u0434\u0440\u0430\u0439\u0432\u0435\u0440 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u043a\u0430\u0440\u0442\u044b <code>ethtool ens33 -p 100</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u0432\u0435\u0442\u043e\u0434\u0438\u043e\u0434 \u043d\u0430 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u043a\u0430\u0440\u0442\u0435 \u043d\u0430 100 \u0441\u0435\u043a\u0443\u043d\u0434</p> <p><code>cat /sys/block/sda/stat</code> \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0434\u0438\u0441\u043a\u0430 sda <code>lsmod</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u044f\u0434\u0440\u0430 \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044f\u043c\u0438 <code>/proc/modules</code> \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442\u0441\u044f \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u044f\u0434\u0440\u0430 <code>modinfo ip_tables</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u043c \u043c\u043e\u0434\u0443\u043b\u0435 <code>ls /etc/*modprobe*</code> \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0441\u043e \u0441\u043f\u0438\u0441\u043a\u0430\u043c\u0438 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u044f\u0434\u0440\u0430 <code>cat /etc/modprobe.d/mdadm.conf</code>/etc/modules-load.d/` \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0444\u0430\u0439\u043b\u044b \u0441\u043e \u0441\u043f\u0438\u0441\u043a\u0430\u043c\u0438 \u043c\u043e\u0434\u0443\u043b\u0435\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b</p> <p><code>ls -l /var/lib/apt/periodic/update-success-stamp</code> \u0434\u0430\u0442\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f apt update <code>ls -l /var/cache/apt/pkgcache.bin</code> \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043a\u044d\u0448\u0430 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 apt <code>HISTTIMEFORMAT=\"%d/%m/%y %T \" history | grep \"apt update\"</code> \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441 \u0442\u043e\u0447\u043a\u043e\u0439 \u0432\u0440\u0435\u043c\u0435\u043d\u0438</p> <p><code>cat /etc/hostname</code> \u0438\u043c\u044f \u0445\u043e\u0441\u0442\u0430 <code>cat /etc/services | grep -iE \"ntp|zabbix\"</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 \u0438 \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0438\u043c \u043f\u043e\u0440\u0442\u043e\u0432 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 <code>cat /etc/mime.types | grep -Ew \"json|csv\"</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u043b\u0432\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0438 \u0438\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c \u0434\u043b\u044f \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435</p> <p><code>cat /etc/hosts</code> \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u0430\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0430 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438 ip \u0432 \u0438\u043c\u044f <code>cat /etc/hosts.allow &amp;&amp; cat /etc/hosts.deny</code> \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0432\u043d\u0435\u0448\u043d\u0438\u043c \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c <code>cat /etc/hosts.{allow,deny} | grep -Pv \"^$|^#\"</code> <code>echo \"in.telnetd: 192.168.3., .domain.ru\" &gt;&gt; /etc/hosts.allow</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u043f\u043e\u0434\u0441\u0435\u0442\u0438 \u0438 \u0434\u043e\u043c\u0435\u043d\u0430</p> <p><code>ls -l /dev | grep sd</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0434\u0438\u0441\u043a\u043e\u0432 \u0438 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 \u0432 \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 <code>ls -l /dev | grep -wo sd.</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u0438\u0441\u043a\u043e\u0432 <code>cat /proc/diskstats</code> \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0434\u0438\u0441\u043a\u043e\u0432 <code>cat /proc/stat</code> cpu user/nice/system/idle/iowait/irq/softirq/steal_time, ctxt - \u043e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u043d\u0430 \u0432\u0441\u0435\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430\u0445, btime - \u0432\u0440\u0435\u043c\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445 \u0441 \u043d\u0430\u0447\u0430\u043b\u0430 \u044d\u043f\u043e\u0445\u0438 unix, processes -  \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0438 \u043f\u043e\u0442\u043e\u043a\u043e\u0432, \u0432\u043a\u043b\u044e\u0447\u0430\u044f (\u043d\u043e \u043d\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u044f\u0441\u044c \u0438\u043c\u0438) \u0442\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u044b \u0432\u044b\u0437\u043e\u0432\u0430\u043c\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u0432\u044b\u0437\u043e\u0432\u043e\u0432 fork() \u0438 clone(), procs_blocked - \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432, \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0438 \u043e\u0436\u0438\u0434\u0430\u044e\u0449\u0438\u0445 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0432\u0432\u043e\u0434\u0430-\u0432\u044b\u0432\u043e\u0434\u0430 <code>stat -f /dev/sda</code> <code>cat /proc/buddyinfo</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u043f\u0430\u043c\u044f\u0442\u0438 \u0432 \u044f\u0434\u0440\u0435 Linux, \u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0434\u0438\u0430\u0433\u043d\u043e\u0441\u0442\u0438\u043a\u0438 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u0441 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0435\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 <code>cat /proc/cgroups</code> \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043c\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u043c\u0438 \u0434\u043b\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 cgroups, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043b\u044e\u0431\u044b\u043c \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043c \u0434\u043b\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430, \u0430 \u0442\u0430\u043a\u0436\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0435\u0433\u043e \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435</p>"},{"location":"Linux/#sysctl","title":"sysctl","text":"<p><code>sysctl -a</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b/\u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u044f\u0434\u0440\u0430 Linux (Kernel), \u0433\u0434\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043d\u044b \u0432\u0441\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0432 \u0432\u0438\u0434\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445, \u0438\u043c\u0435\u043d\u0430 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u043f\u0443\u0442\u0438 \u0444\u0430\u0439\u043b\u0430 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 /proc/sys (\u0432\u043c\u0435\u0441\u0442\u043e \u0441\u043b\u0435\u0448\u0430 \u0432 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u0447\u043a\u0430) <code>sysctl net.ipv6.conf.all</code> <code>sysctl net.ipv6.conf.all.disable_ipv6=1</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b IPv6 (&gt; /proc/sys/net/ipv6/conf/ens33/disable_ipv6) <code>sysctl net.ipv6.conf.ens33.disable_ipv6=1</code> \u0434\u043b\u044f \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 ens33 <code>sysctl --system</code> \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u0438\u0437 \u0444\u0430\u0439\u043b\u043e\u0432/\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0434\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u0432 \u0444\u0430\u0439\u043b\u0430\u0445 (\u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u0437 sysctl) <code>sysctl -w net.ipv6.conf.ens33.disable_ipv6=1</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0443 \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 (-w \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0432 \u0444\u0430\u0439\u043b) <code>sysctl fs.file-nr</code> \u043a\u043e\u043b-\u0432\u043e \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432\u044b\u0445 \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u043e\u0432 \u0432 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043c\u043e\u043c\u0435\u043d\u0442, \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u0435\u0439\u0447\u0430\u0441 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f, \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043b\u044f \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f <code>sysctl -a | grep fs.file-max</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 (\u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u043e\u0432), \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u043e\u0442\u043a\u0440\u044b\u0442\u044b \u0432 \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0432\u0441\u0435\u043c\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430\u043c\u0438 \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u044f\u0434\u0440\u0430 \u041e\u0421 <code>nano /proc/sys/fs/file-max</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043b-\u0432\u0430 \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u043e\u0432 <code>echo \"fs.file-max=500000\" &gt;&gt; /etc/sysctl.conf</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e sysctl.conf <code>sysctl -p</code> \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 <code>sysctl fs.nr_open</code> \u043b\u0438\u043c\u0438\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e <code>ls /proc/1/fd/ | wc -l</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043a\u043e\u043b-\u0432\u043e \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u043e\u0432 \u0443 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430 \u0441 PID 1 <code>sysctl fs.aio-nr</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439 \u0432\u0432\u043e\u0434\u0430 \u0438 \u0432\u044b\u0432\u043e\u0434\u0430 \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0432 \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0435 \u0432\u0441\u0435\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b (Asynchronous IO number requests) <code>sysctl fs.aio-max-nr</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439 \u0432\u0432\u043e\u0434\u0430-\u0432\u044b\u0432\u043e\u0434\u0430, \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c\u043e\u0435 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043b\u044f fs.aio-max-nr \u2014 1048576, \u043d\u043e \u0432 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u043e\u0439 \u0441\u0440\u0435\u0434\u0435 ASE \u0441\u043e \u043c\u043d\u043e\u0433\u0438\u043c\u0438 \u044f\u0434\u0440\u0430\u043c\u0438 \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u0442\u0440\u0435\u0431\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435\u0435 \u0447\u0438\u0441\u043b\u043e <code>sysctl fs.inotify.max_queued_events</code> \u043f\u043e\u0434\u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u044f\u0434\u0440\u0430 inotify \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u043b\u0435\u0434\u0438\u0442\u044c \u0437\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f\u043c\u0438 \u0432 \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435, \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0433\u0443\u0442 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u0438, \u043f\u0435\u0440\u0435\u0434 \u0442\u0435\u043c \u043a\u0430\u043a \u0438\u0445 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430 <code>sysctl fs.inotify.max_user_watches</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0444\u0430\u0439\u043b\u043e\u0432 \u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439, \u0437\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u043c\u0438 \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0431\u043b\u044e\u0434\u0430\u0442\u044c \u043e\u0434\u0438\u043d \u043e\u0431\u044a\u0435\u043a\u0442 inotify <code>sysctl fs.inotify.max_user_instances</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 inotify, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043e\u0434\u0438\u043d \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c <code>sysctl fs.mqueue.queues_max</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 POSIX, \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043d\u044b\u0445 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430\u043c (\u0438 \u0438\u0445 \u043f\u043e\u0442\u043e\u043a\u0430\u043c) \u043e\u0431\u043c\u0435\u043d\u0438\u0432\u0430\u0442\u044c\u0441\u044f \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u0432 \u0432\u0438\u0434\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 (\u0441\u043e\u0437\u0434\u0430\u044e\u0442\u0441\u044f \u0438 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0444\u0443\u043d\u043a\u0446\u0438\u0438 mq_open) <code>sysctl fs.mqueue.msg_max</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u0432 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0438 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 <code>sysctl fs.mqueue.msgsize_max</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f <code>sysctl vm.min_free_kbytes</code> \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0439 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0442\u044c <code>sysctl vm.swappiness</code> \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438, \u043f\u043e \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0442 \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0438\u0442\u044c\u0441\u044f \u043d\u0430 SWAP \u0440\u0430\u0437\u0434\u0435\u043b <code>sysctl -w vm.swappiness=80</code> \u043f\u0440\u0438 80% \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 (\u0441\u0432\u044b\u0448\u0435 20% \u0437\u0430\u043d\u044f\u0442\u043e\u0439 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438) \u043d\u0430\u0447\u043d\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f SWAP, \u0432 \u043a\u043e\u0442\u043e\u044b\u0439 \u043f\u043e\u043c\u0435\u0449\u044f\u044e\u0442\u0441\u044f \u043d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430\u043c\u0438 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u043f\u0430\u043c\u044f\u0442\u0438 \u043d\u0430 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043c\u043e\u043c\u0435\u043d\u0442, \u0435\u0441\u043b\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044e \u043f\u043e\u0442\u0440\u0435\u0431\u0443\u044e\u0442\u0441\u044f \u044d\u0442\u0438 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b, \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0438\u0445 \u043f\u0435\u0440\u0435\u043d\u0435\u0441\u0435\u043d\u0438\u044f \u0438\u0437 \u0440\u0430\u0437\u0434\u0435\u043b\u0430 \u043f\u043e\u0434\u043a\u0430\u0447\u043a\u0438 \u043e\u0431\u0440\u0430\u0442\u043d\u043e \u0432 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u0443\u044e \u043f\u0430\u043c\u044f\u0442\u044c (\u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0443\u0436\u043d\u043e \u043e\u0431\u0440\u0430\u0442\u043d\u043e \u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0441 \u0434\u0438\u0441\u043a\u0430 \u0432 \u043f\u0430\u043c\u044f\u0442\u044c) <code>sysctl -w vm.swappiness=10</code> \u0444\u0430\u0439\u043b \u043f\u043e\u0434\u043a\u0430\u0447\u043a\u0438 (\u0432\u044b\u0433\u0440\u0443\u0437\u043a\u0430 \u0432 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043f\u0430\u043c\u044f\u0442\u044c) \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u0442\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e 10% \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 <code>sysctl vm.vfs_cache_pressure</code> \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f dentry \u0438 inode \u0438\u0437 \u043a\u044d\u0448\u0430 (100 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e) <code>sysctl vm.dirty_background_ratio</code> \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u043e\u0442 \u043e\u0431\u0449\u0435\u0439 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d \u0441\u0442\u0440\u0430\u043d\u0438\u0447\u043d\u044b\u043c \u043a\u044d\u0448\u0435\u043c, \u043f\u043e \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0434\u0435\u043c\u043e\u043d pdflush (dirty page flush) \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442 \u0441\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u043a\u044d\u0448\u0430 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 \u043d\u0430 \u0434\u0438\u0441\u043a. \u041a\u043e\u0433\u0434\u0430 \u043e\u0431\u044a\u0435\u043c \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u043c\u0435\u043d\u044c\u0448\u0435 \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u0440\u043e\u0433\u0430, \u044f\u0434\u0440\u043e \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u044e wakeup_bdflush() \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0430 \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u0442\u043e\u043a\u0430 pdflush, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u043d\u044b\u0445 \u0441\u0442\u0440\u0430\u043d\u0438\u0446 \u043f\u0430\u043c\u044f\u0442\u0438 background_writeout() \u043d\u0430 \u0434\u0438\u0441\u043a, \u044d\u0442\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u043e\u0434\u0438\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0434\u043e\u043b\u0436\u043d\u0430 \u043f\u043e\u043f\u044b\u0442\u0430\u0442\u044c\u0441\u044f \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u043d\u0430 \u0434\u0438\u0441\u043a. <code>sysctl -w vm.dirty_background_ratio=5</code> <code>sysctl vm.dirty_ratio</code> \u0432\u0435\u0440\u043d\u0445\u043d\u0438\u0439 \u043f\u0440\u0435\u0434\u0435\u043b \u043e\u0431\u044a\u0435\u043c\u0430 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 \u0432 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u0430\u0445 \u043e\u0442 free Available \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d \u043f\u043e\u0434 PageCache \u0434\u043e \u0438\u0445 \u0437\u0430\u043f\u0438\u0441\u0438 \u043d\u0430 \u0434\u0438\u0441\u043a, \u043d\u0430 \u044d\u0442\u043e\u043c \u0443\u0440\u043e\u0432\u043d\u0435 \u0432\u0441\u0435 \u043d\u043e\u0432\u044b\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0432\u0432\u043e\u0434\u0430-\u0432\u044b\u0432\u043e\u0434\u0430 \u043f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0434\u043e \u0442\u0435\u0445 \u043f\u043e\u0440, \u043f\u043e\u043a\u0430 \u043d\u0430 \u0434\u0438\u0441\u043a \u043d\u0435 \u0431\u0443\u0434\u0443\u0442 \u0437\u0430\u043f\u0438\u0441\u0430\u043d\u044b \u0433\u0440\u044f\u0437\u043d\u044b\u0435 (Dirty) \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b, \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0432\u044b\u0448\u0435 \u0447\u0435\u043c dirty_background_ratio <code>sysctl vm.dirty_expire_centisecs</code> \u0432\u0440\u0435\u043c\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0433\u0440\u044f\u0437\u043d\u044b\u0445 (Dirty) \u0441\u0442\u0440\u0430\u043d\u0438\u0446 \u0432 \u043a\u044d\u0448\u0435 \u0432 \u0441\u043e\u0442\u044b\u0445 \u0434\u043e\u043b\u044f\u0445 \u0441\u0435\u043a\u0443\u043d\u0434 (3000 = 30 \u0441\u0435\u043a\u0443\u043d\u0434) \u0434\u043b\u044f \u0438\u0445 \u0437\u0430\u043f\u0438\u0441\u0438 \u043d\u0430 \u0434\u0438\u0441\u043a \u0441 \u0446\u0435\u043b\u044c\u044e. \u0424\u0443\u043d\u043a\u0446\u0438\u044f wb_kupdate() \u0434\u0435\u043c\u043e\u043d\u0430 pdflush \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u043e\u0431\u0440\u0430\u0442\u043d\u0443\u044e \u0437\u0430\u043f\u0438\u0441\u044c \u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0430 \u0434\u0438\u0441\u043a, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u044b\u043b\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u044b \u0431\u043e\u043b\u0435\u0435 \u0447\u0435\u043c dirty_expire_centisecs \u0434\u043b\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0441\u0442\u0440\u0430\u043d\u0438\u0447\u043d\u043e\u0433\u043e \u043a\u044d\u0448\u0430 \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043d\u0430 \u0434\u0438\u0441\u043a\u0435, \u0442.\u043a. \u043f\u0440\u0438 \u0441\u0431\u043e\u0435, \u0442.\u043a. \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043f\u0430\u043c\u044f\u0442\u0438 \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0433\u0440\u0443\u0437\u043a\u0438 \u043d\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f. <code>sysctl vm.dirty_writeback_centisecs</code> \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u0434\u043b\u0435\u0436\u0430\u0442 \u0437\u0430\u043f\u0438\u0441\u0438 \u043d\u0430 \u0434\u0438\u0441\u043a (500 - 5 \u0441\u0435\u043a\u0443\u043d\u0434) <code>sysctl abi.vsyscall32</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 32 \u0431\u0438\u0442\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c \u0432 64 \u0431\u0438\u0442\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e 1 - \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u0442) <code>sysctl kernel.hostname</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u043c\u044f \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 <code>sysctl kernel.printk</code> \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f <code>sysctl -w kernel.printk=\"2 4 1 7\"</code> <code>sysctl net.ipv4.ip_default_ttl</code> \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e-\u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0434\u043b\u044f \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u044b Time To Live \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 (\u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0436\u0438\u0437\u043d\u0438 \u043f\u0430\u043a\u0435\u0442\u0430 \u0432 Internet - \u043a\u0430\u0436\u0434\u044b\u0439 \u0440\u0430\u0437, \u043a\u043e\u0433\u0434\u0430 \u043f\u0430\u043a\u0435\u0442 \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u043d\u0430 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0439 \u0440\u043e\u0443\u0442\u0435\u0440, \u0431\u0440\u0430\u043d\u0434\u043c\u0430\u0443\u044d\u0440 \u0438 \u0442.\u043f. \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u0430 TTL \u043f\u0430\u043a\u0435\u0442\u0430 \u0443\u043c\u0435\u043d\u044c\u0448\u0430\u0435\u0442\u0441\u044f \u043d\u0430 1) <code>sysctl net.ipv4.ip_no_pmtu_disc</code> \u0437\u0430\u043f\u0440\u0435\u0449\u0430\u0435\u0442 \u043f\u043e\u0438\u0441\u043a Path Maximum Transfer Unit (\u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u0430\u043a\u0435\u0442\u0430 \u0434\u043b\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u0443\u0442\u0438, \u044d\u0442\u043e \u043d\u0435 MTU), \u043a\u043e\u0433\u0434\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0431\u0443\u0434\u0435\u0442 \u043f\u044b\u0442\u0430\u0442\u044c\u0441\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u0430\u043a\u0435\u0442\u0430, \u043f\u0440\u0438 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043d\u0435 \u043f\u043e\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0438\u0445 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e, \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u0439 \u0445\u043e\u0441\u0442 <code>sysctl net.ipv4.tcp_mem</code> \u0432\u0435\u043a\u0442\u043e\u0440\u043d\u0430\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f (\u043c\u0438\u043d\u0438\u043c\u0443\u043c, \u0440\u0435\u0436\u0438\u043c \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438, \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c), \u043a\u043e\u0442\u043e\u0440\u0430\u044f c\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043e\u0431\u0449\u0438\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u044f \u043f\u0430\u043c\u044f\u0442\u0438 \u0434\u043b\u044f \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430 TCP, \u0438\u0437\u043c\u0435\u0440\u044f\u0435\u0442\u0441\u044f \u0432 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430\u0445 (\u043e\u0431\u044b\u0447\u043d\u043e 4\u041a\u0431), \u0430 \u043d\u0435 \u0431\u0430\u0439\u0442\u0430\u0445. \u041f\u043e\u043a\u0430 \u043e\u0431\u0449\u0438\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u0430\u043c\u044f\u0442\u0438 \u0434\u043b\u044f \u0446\u0435\u043b\u0435\u0439 \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430 TCP \u043d\u0438\u0436\u0435 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446, \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u0434\u0435\u043b\u0430\u0435\u0442 \u0441 \u043f\u0430\u043c\u044f\u0442\u044c\u044e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u043e\u0439 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u043c\u0438 TCP \u0441\u043e\u043a\u0435\u0442\u0430\u043c\u0438, \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 TCP \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442 \u0431\u044b\u0441\u0442\u0440\u043e \u043e\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0430\u0442\u044c \u043f\u0430\u043c\u044f\u0442\u044c, \u0438 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 - \u043e\u0431\u044a\u0435\u043c \u043f\u0430\u043c\u044f\u0442\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u043e\u0436\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0434\u043b\u044f \u043d\u0443\u0436\u0434 TCP \u0438 \u043f\u0440\u0438 \u0435\u0433\u043e \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438, \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0442\u0441\u044f \u043f\u043e\u0442\u0435\u0440\u0438 \u043f\u0430\u043a\u0435\u0442\u043e\u0432. <code>sysctl net.ipv4.tcp_rmem</code> \u0432\u0435\u043a\u0442\u043e\u0440\u043d\u0430\u044f \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u0430 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0431\u0443\u0444\u0435\u0440\u0430 \u0441\u043e\u043a\u0435\u0442\u043e\u0432 TCP \u0434\u043b\u044f \u043f\u0440\u0438\u0435\u043c\u0430. \u041a\u0430\u0436\u0434\u044b\u0439 \u0441\u043e\u043a\u0435\u0442 TCP \u0438\u043c\u0435\u0435\u0442 \u043f\u0440\u0430\u0432\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0443\u044e \u043f\u0430\u043c\u044f\u0442\u044c \u043f\u043e \u0444\u0430\u043a\u0442\u0443 \u0441\u0432\u043e\u0435\u0433\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u2013 4096 \u0431\u0430\u0439\u0442, 4 \u041a\u0431) \u0438 \u0435\u0433\u043e \u043d\u0435 \u0441\u0442\u043e\u0438\u0442 \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0442\u044c, \u0442.\u043a. \u043f\u0440\u0438 \u0432\u044b\u0441\u043e\u043a\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0437\u0430\u0439\u043c\u0443\u0442 \u043c\u043d\u043e\u0433\u043e \u043f\u0430\u043c\u044f\u0442\u0438. \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u0432\u0437\u0430\u043c\u0435\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 rmem_default (\u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u0440\u0443\u0433\u0438\u043c\u0438 \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430\u043c\u0438), \u0432\u0442\u043e\u0440\u043e\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 - \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0438\u043c\u0435\u0435\u0442 \u0443\u0434\u0432\u043e\u0435\u043d\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, 87380 * 2 bytes, \u0438\u043b\u0438 174760 \u0431\u0430\u0439\u0442 (170 \u041a\u0431). \u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u0440\u0438\u0435\u043c\u043d\u043e\u0433\u043e \u0431\u0443\u0444\u0435\u0440\u0430, \u044d\u0442\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043d\u0435 \u043e\u0442\u043c\u0435\u043d\u044f\u0435\u0442 \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c\u0430, \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0432 rmem_max <code>sysctl net.ipv4.tcp_wmem</code> \u0432\u0435\u043a\u0442\u043e\u0440\u043d\u0430\u044f \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u0430 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0431\u0443\u0444\u0435\u0440\u0430 \u0441\u043e\u043a\u0435\u0442\u043e\u0432 TCP \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 <code>sysctl net.core.rmem_default</code> \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e (\u0438\u043c\u0435\u0435\u0442 \u043d\u0438\u0436\u0435 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442, \u0447\u0435\u043c tcp_rmem) <code>sysctl net.core.wmem_default</code> \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e <code>sysctl net.core.rmem_max</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0431\u0443\u0444\u0435\u0440\u0430 \u043d\u0430 \u0441\u043e\u043a\u0435\u0442\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0431\u0430\u0439\u0442\u0430\u0445 (\u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440, \u0438\u043c\u0435\u0435\u0442 \u0432\u044b\u0448\u0435 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442, \u0447\u0435\u043c tcp_rmem) <code>sysctl net.core.wmem_max</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0431\u0443\u0444\u0435\u0440\u0430 \u043d\u0430 \u0441\u043e\u043a\u0435\u0442\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0431\u0430\u0439\u0442\u0430\u0445 <code>sysctl net.core.optmem_max</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043e\u0431\u044a\u0451\u043c \u043e\u043f\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0445 \u0431\u0443\u0444\u0435\u0440\u043e\u0432 \u043f\u0430\u043c\u044f\u0442\u0438 <code>sysctl -w net.core.rmem_max=26214400 &amp;&amp; sysctl -w net.core.rmem_default=26214400</code> \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0434\u043e 25 \u041c\u0411\u0430\u0439\u0442 <code>sysctl -w net.core.wmem_max=26214400 &amp;&amp; sysctl -w net.core.wmem_default=26214400</code> \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0434\u043e 25 \u041c\u0411\u0430\u0439\u0442 <code>sysctl net.ipv4.tcp_no_metrics_save</code> \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e (0) TCP \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0432 \u043a\u044d\u0448\u0435 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0430 \u043f\u0440\u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u0438 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f, \u043f\u0440\u0438 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 (1) TCP \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u043a\u044d\u0448\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043f\u0440\u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u0438 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 <code>sysctl net.ipv4.icmp_echo_ignore_all</code> \u0435\u0441\u043b\u0438 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043e, \u044f\u0434\u0440\u043e \u0431\u0443\u0434\u0435\u0442 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0441\u0435 icmp \u0437\u0430\u043f\u0440\u043e\u0441\u044b (\u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0437\u0430\u0449\u0438\u0442\u044b \u043e\u0442 DOS \u0430\u0442\u0430\u043a) <code>sysctl net.ipv4.icmp_echo_ignore_broadcasts</code> \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b ICMP ECHO, \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u044b\u0435 \u0448\u0438\u0440\u043e\u043a\u043e\u0432\u0435\u0449\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c\u0438 \u043f\u0430\u043a\u0435\u0442\u0430\u043c\u0438 <code>sysctl net.ipv4.icmp_ignore_bogus_error_responses</code> \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0448\u0438\u0431\u043e\u0447\u043d\u044b\u0435 ICMP \u0437\u0430\u043f\u0440\u043e\u0441\u044b <code>sysctl net.ipv4.conf.all.accept_source_route</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u0442\u044c \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u044e \u043e\u0442 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432, \u043f\u0440\u0438 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u044e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043f\u0443\u0442\u044c, \u043f\u043e \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u043f\u0430\u043a\u0435\u0442 \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u0440\u043e\u0439\u0442\u0438 \u043f\u043e \u0441\u0435\u0442\u0438 Internet, \u0447\u0442\u043e\u0431\u044b \u0434\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442\u044c \u043f\u0443\u043d\u043a\u0442\u0430 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f. \u042d\u0442\u043e \u0443\u0434\u043e\u0431\u043d\u043e \u0434\u043b\u044f \u0438\u0437\u0443\u0447\u0435\u043d\u0438\u044f \u0438 \u043e\u0442\u043b\u0430\u0434\u043a\u0438 \u0440\u0430\u0431\u043e\u0442\u044b \u0441\u0435\u0442\u0438, \u043d\u043e \u043d\u0430\u0440\u0443\u0448\u0438\u0442\u0435\u043b\u044c \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0434\u043c\u0435\u043d\u044b \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043e\u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438 \u0438 \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u043f\u044b\u0442\u0430\u0442\u044c\u0441\u044f \u043f\u043e\u0434\u0441\u0443\u043d\u0443\u0442\u044c \u043f\u043e\u0434\u0434\u0435\u043b\u044c\u043d\u044b\u0435 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u044b \u0434\u043b\u044f \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432\u0435\u0441\u0442\u044c \u0442\u0440\u0430\u0444\u0438\u043a \u0447\u0435\u0440\u0435\u0437 \u0443\u0437\u0435\u043b, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u043d \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0438\u0440\u0443\u0435\u0442 (\u0430\u0442\u0430\u043a\u0430 Man In The Middle). <code>sysctl net.ipv4.conf.all.accept_redirects</code> \u0437\u0430\u043f\u0440\u0435\u0442\u0438\u0442\u044c(0)/\u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c(1) \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c ICMP \u043f\u0430\u043a\u0435\u0442\u044b \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f <code>sysctl net.ipv4.conf.all.send_redirects</code> <code>sysctl net.ipv4.conf.all.secure_redirects</code> <code>sysctl net.ipv4.ip_forward</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u0442 (1) \u0438\u043b\u0438 \u0437\u0430\u043f\u0440\u0435\u0449\u0430\u0435\u0442 (0) \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0447\u0435\u0440\u0435\u0437 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0445\u043e\u0441\u0442 <code>sysctl net.ipv4.conf.default.forwarding</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0444\u043e\u0440\u0432\u0430\u0440\u0434\u0438\u043d\u0433 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 - \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u044f\u0434\u0440\u0443 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043e\u0441\u0443\u0449\u0435\u0442\u0441\u0432\u043b\u044f\u0442\u044c \u043f\u0440\u043e\u0431\u0440\u043e\u0441 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u0441 \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 \u043d\u0430 \u0434\u0440\u0443\u0433\u043e\u0439 <code>sysctl net.ipv4.ip_local_port_range</code> \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u0440\u0442\u043e\u0432, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 (\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0445 \u0441\u043e\u043a\u0435\u0442\u043e\u0432) <code>sysctl net.ipv4.tcp_max_tw_buckets</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u0441\u043e\u043a\u0435\u0442\u043e\u0432, \u043d\u0430\u0445\u043e\u0434\u044f\u0449\u0438\u0445\u0441\u044f \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438 TIME-WAIT \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e, \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0441\u0442\u0435\u0439\u0448\u0438\u0445 \u0440\u0430\u0437\u043d\u043e\u0432\u0438\u0434\u043d\u043e\u0441\u0442\u0435\u0439 DoS-\u0430\u0442\u0430\u043a <code>sysctl net.ipv4.tcp_tw_recycle</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u0442/\u0437\u0430\u043f\u0440\u0435\u0449\u0430\u0435\u0442 \u0431\u044b\u0441\u0442\u0440\u0443\u044e \u0443\u0442\u0438\u043b\u0438\u0437\u0430\u0446\u0438\u044e \u0441\u043e\u043a\u0435\u0442\u043e\u0432, \u043d\u0430\u0445\u043e\u0434\u044f\u0449\u0438\u0445\u0441\u044f \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438 TIME-WAIT <code>sysctl net.ipv4.tcp_tw_reuse</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0442\u044c \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 TIME-WAIT \u0441\u043e\u043a\u0435\u0442\u043e\u0432 \u0432 \u0441\u043b\u0443\u0447\u0430\u044f\u0445, \u0435\u0441\u043b\u0438 \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b \u0441\u0447\u0438\u0442\u0430\u0435\u0442 \u044d\u0442\u043e \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u043c <code>sysctl net.ipv4.tcp_rfc1337</code> \u0437\u0430\u0449\u0438\u0442\u0430 \u043e\u0442 TIME-WAIT \u0430\u0442\u0430\u043a <code>sysctl net.ipv4.tcp_max_orphans</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \"\u043e\u0441\u0438\u0440\u043e\u0442\u0435\u0432\u0448\u0438\u0445\" TCP \u0441\u043e\u043a\u0435\u0442\u043e\u0432, \u043d\u0435 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u043a\u0430\u043a\u0438\u043c-\u043b\u0438\u0431\u043e \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u043e\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 (user file handle), \u043f\u0440\u0438 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0435 \u044d\u0442\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0441\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u044e\u0442\u0441\u044f. \u042d\u0442\u043e\u0442 \u043f\u043e\u0440\u043e\u0433 \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u044b\u0435 \u0430\u0442\u0430\u043a\u0438 DoS \u0438 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 \u0432\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u041e\u0417\u0423, \u043a\u0430\u0436\u0434\u043e\u0435 orphan-\u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u043f\u043e\u0433\u043b\u043e\u0449\u0430\u0435\u0442 \u043e\u043a\u043e\u043b\u043e 64 \u041a\u0431\u0430\u0439\u0442 \u043d\u0435 \u0441\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u043c\u043e\u0439 \u043d\u0430 \u0434\u0438\u0441\u043a (unswappable) \u043f\u0430\u043c\u044f\u0442\u0438 \u0438 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0441\u0431\u0440\u043e\u0448\u0435\u043d\u0430 \u0432 SWAP. \u041f\u0440\u0438 \u0432\u043e\u0437\u043d\u0438\u043a\u043d\u043e\u0432\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0431\u043b\u0435\u043c, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 \u044d\u0442\u0438\u043c \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435\u043c \u2013 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0439 \u0436\u0443\u0440\u043d\u0430\u043b \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0434\u043e\u0431\u043d\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435: TCP: too many of orphaned sockets, \u0438 \u044d\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u0441\u043b\u0443\u0436\u0438\u0442\u044c \u043f\u043e\u0432\u043e\u0434\u043e\u043c \u043f\u0435\u0440\u0435\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f tcp_fin_timeout \u0438\u043b\u0438 tcp_orphan_retries. <code>sysctl -w net.ipv4.tcp_max_orphans=65536</code> <code>sysctl net.ipv4.tcp_orphan_retries</code> \u0447\u0438\u0441\u043b\u043e \u043f\u043e\u043f\u044b\u0442\u043e\u043a \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u0434 \u0442\u0435\u043c \u043a\u0430\u043a \u043e\u043d\u043e \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u0437\u043e\u0440\u0432\u0430\u043d\u043e \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0438 \u0443\u043d\u0438\u0447\u0442\u043e\u0436\u0430\u0435\u0442\u0441\u044f TCP \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435, \u0437\u0430\u043a\u0440\u044b\u0442\u043e\u0435 \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 7, \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0435 \u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043f\u0435\u0440\u0438\u043e\u0434\u0443 \u043e\u0442 50 \u0441\u0435\u043a\u0443\u043d\u0434 \u0434\u043e 16 \u043c\u0438\u043d\u0443\u0442 \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 RTO (Retransmission Timeout). <code>sysctl net.ipv4.tcp_fin_timeout</code> \u0437\u0430\u0434\u0430\u0435\u0442 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f \u043f\u0440\u0435\u0431\u044b\u0432\u0430\u043d\u0438\u044f \u0441\u043e\u043a\u0435\u0442\u0430 \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438 FIN-WAIT-2 \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0435\u0441\u043b\u0438 \u0434\u0440\u0443\u0433\u0430\u044f \u0441\u0442\u043e\u0440\u043e\u043d\u0430 \u043d\u0435 \u0437\u0430\u043a\u0440\u044b\u043b\u0430 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441\u043e \u0441\u0432\u043e\u0435\u0439 \u0441\u0442\u043e\u0440\u043e\u043d\u044b. \u041a\u0430\u0436\u0434\u044b\u0439 \u0441\u043e\u043a\u0435\u0442 \u0437\u0430\u043d\u0438\u043c\u0430\u0435\u0442 \u0432 \u043f\u0430\u043c\u044f\u0442\u0438 1.5 \u041a\u0431, \u0447\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u043f\u0440\u0438\u0432\u0435\u0441\u0442\u0438 \u043a \u0437\u043d\u0430\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0443\u0442\u0435\u0447\u043a\u0430\u043c \u043f\u0430\u043c\u044f\u0442\u0438 \u0432 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043b\u0443\u0447\u0430\u044f\u0445. <code>sysctl net.ipv4.tcp_syncookies</code> \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u0437\u0430\u0449\u0438\u0442\u0438\u0442\u044c\u0441\u044f \u043e\u0442 \u0430\u0442\u0430\u043a SYN flood, \u0441\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0438 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f net.ipv4.tcp_max_syn_backlog, \u0435\u0441\u043b\u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e SYN \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0437\u0430\u0431\u0438\u0432\u0430\u0435\u0442 \u0432\u0441\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c, \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c Syn cookies. SYN cookies \u0432\u043e\u043e\u0431\u0449\u0435 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043e\u0447\u0435\u0440\u0435\u0434\u044c SYN, \u0432\u043c\u0435\u0441\u0442\u043e \u044d\u0442\u043e\u0433\u043e \u044f\u0434\u0440\u043e \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u043d\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 SYN \u043f\u0430\u043a\u0435\u0442, \u043a\u0430\u043a \u043e\u0431\u044b\u0447\u043d\u043e SYN/ACK, \u043d\u043e \u0442\u0443\u0434\u0430 \u0431\u0443\u0434\u0435\u0442 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043e \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u043e \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 IP \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u0438 \u043f\u043e\u0440\u0442\u043e\u0432 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 \u0438 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043f\u043e\u0441\u044b\u043b\u043a\u0438 \u043f\u0430\u043a\u0435\u0442\u0430. \u0410\u0442\u0430\u043a\u0443\u044e\u0449\u0438\u0439 \u043d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u0442 \u044d\u0442\u0438 \u043f\u0430\u043a\u0435\u0442\u044b, \u0430 \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0438 \u043d\u0435 \u043e\u0442\u0432\u0435\u0442\u0438\u0442 \u043d\u0430 \u043d\u0438\u0445. \u041f\u0440\u0438 \u043d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u043e\u043c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0438, \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0441\u043b\u0430\u043d \u0442\u0440\u0435\u0442\u0438\u0439 \u043f\u0430\u043a\u0435\u0442, \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0438\u0439 \u0447\u0438\u0441\u043b\u043e, \u0430 \u0441\u0435\u0440\u0432\u0435\u0440 \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442 \u0431\u044b\u043b \u043b\u0438 \u044d\u0442\u043e \u043e\u0442\u0432\u0435\u0442 \u043d\u0430 SYN cookie \u0438, \u0435\u0441\u043b\u0438 \u0434\u0430, \u0442\u043e \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0434\u0430\u0436\u0435 \u0432 \u0442\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 SYN \u043d\u0435\u0442 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0439 \u0437\u0430\u043f\u0438\u0441\u0438. <code>sysctl net.ipv4.tcp_fastopen</code> \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0438 \u0432 \u0441\u0435\u0442\u0438, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044f \u043d\u0430\u0447\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0443 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0440\u0430\u0437\u0443 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c \u043f\u0435\u0440\u0432\u043e\u0433\u043e TCP SYN (3 - \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0438 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0445) <code>sysctl net.ipv4.tcp_max_syn_backlog</code> \u0440\u0430\u0437\u043c\u0435\u0440 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 (\u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e) \u0437\u0430\u043f\u043e\u043c\u0438\u043d\u0430\u0435\u043c\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043d\u0430 \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 TCP \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 (SYN-\u043f\u0430\u043a\u0435\u0442\u0430 \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438 Waiting Acknowledgment) \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c TCP SYN \u043f\u0430\u043a\u0435\u0442\u0430, \u0434\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0435 \u0431\u044b\u043b\u043e \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u043e\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 (\u043f\u043e\u043b\u0443\u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439) <code>sysctl -w net.ipv4.tcp_max_syn_backlog=4096</code> \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c, \u0435\u0441\u043b\u0438 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0432\u043e\u0437\u043d\u0438\u043a\u0430\u044e\u0442 \u043f\u0435\u0440\u0435\u0433\u0440\u0443\u0437\u043a\u0438 <code>sysctl net.core.somaxconn</code> \u0440\u0430\u0437\u043c\u0435\u0440 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 (\u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e) \u043f\u043e\u043b\u0443\u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 (\u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0441\u043e\u043a\u0435\u0442\u043e\u0432) \u043e\u0436\u0438\u0434\u0430\u044e\u0449\u0438\u0445 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f. \u0415\u0441\u043b\u0438 \u0432 \u043e\u0442\u0432\u0435\u0442 \u043d\u0430 SYN-\u043f\u0430\u043a\u0435\u0442\u0430 (synchronize) \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c \u0431\u044b\u043b \u043f\u043e\u043b\u0443\u0447\u0435\u043d \u043e\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043f\u0430\u043a\u0435\u0442 SYN-ACK (acknowledges), \u0441\u0435\u0440\u0432\u0435\u0440 \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u043e\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 ACK \u043f\u0430\u043a\u0435\u0442\u0430, \u043f\u043e\u0441\u043b\u0435 \u0447\u0435\u0433\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u043c. <code>sysctl net.ipv4.tcp_syn_retries</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u043f\u044b\u0442\u043e\u043a \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 SYN-\u043f\u0430\u043a\u0435\u0442\u0430 \u043f\u0440\u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043d\u043e\u0432\u043e\u0433\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f, \u043d\u0430 \u043a\u0430\u0436\u0434\u0443\u044e \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043e\u0442\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043f\u0440\u0438\u043c\u0435\u0440\u043d\u043e 30-40 \u0441\u0435\u043a\u0443\u043d\u0434. \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e-\u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e 5 = 180 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u043c. <code>sysctl net.ipv4.tcp_synack_retries</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u043f\u044b\u0442\u043e\u043a \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 SYN-ACK-\u043f\u0430\u043a\u0435\u0442\u0430 \u0432 \u043e\u0442\u0432\u0435\u0442 \u043d\u0430 SYN-\u0437\u0430\u043f\u0440\u043e\u0441 \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043f\u0430\u0441\u0441\u0438\u0432\u043d\u043e\u0433\u043e TCP-\u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435, \u0438\u043d\u0438\u0446\u0438\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0434\u0440\u0443\u0433\u0438\u043c \u0445\u043e\u0441\u0442\u043e\u043c, \u0435\u0441\u043b\u0438 \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c \u0434\u043e \u043e\u0434\u043d\u043e\u0433\u043e, \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u043c\u0435\u0440\u043d\u043e 9 \u0441\u0435\u043a\u0443\u043d\u0434 <code>sysctl net.core.netdev_max_backlog</code> \u0440\u0435\u0433\u0443\u043b\u0438\u0440\u0443\u0435\u0442 \u0440\u0430\u0437\u043c\u0435\u0440 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u043c\u0435\u0436\u0434\u0443 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u043a\u0430\u0440\u0442\u043e\u0439 \u0438 \u044f\u0434\u0440\u043e\u043c, \u0435\u0441\u043b\u0438 \u044f\u0434\u0440\u043e \u043d\u0435 \u0443\u0441\u043f\u0435\u0432\u0430\u0435\u0442 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u043f\u0430\u043a\u0435\u0442\u044b (\u0435\u0441\u043b\u0438 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u043f\u0430\u043a\u0435\u0442\u044b \u0431\u044b\u0441\u0442\u0440\u0435\u0435, \u0447\u0435\u043c \u044f\u0434\u0440\u043e \u043c\u043e\u0436\u0435\u0442 \u0438\u0445 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c) \u0438 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u043f\u0435\u0440\u0435\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f, \u0442\u043e \u043d\u043e\u0432\u044b\u0435 \u043f\u0430\u043a\u0435\u0442\u044b \u043e\u0442\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u044e\u0442\u0441\u044f, \u0435\u0441\u043b\u0438 \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u043c\u043e\u0436\u043d\u043e \u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c\u0441\u044f \u0441 \u043f\u0438\u043a\u043e\u0432\u044b\u043c\u0438 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430\u043c\u0438 <code>sysctl -a | grep net.ipv4.tcp_keepalive</code> \u043f\u043e\u0441\u043b\u0435 \u043d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0441\u043e\u043a\u0435\u0442\u0430 \u043f\u043e\u0441\u044b\u043b\u0430\u0435\u0442 \u043f\u0430\u043a\u0435\u0442 keepalive \u043d\u0430 \u0432\u0442\u043e\u0440\u043e\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u043d\u0443, \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0438\u0439 \u043d\u0443\u043b\u0435\u0432\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435, \u043f\u043e\u0441\u043b\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u043f\u0430\u043a\u0435\u0442\u0430 \u0447\u0435\u0440\u0435\u0437 \u0432\u0440\u0435\u043c\u044f, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0435 \u0432 tcp_keepalive_time \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u043f\u0430\u043a\u0435\u0442\u044b \u0447\u0435\u0440\u0435\u0437 \u043a\u0430\u0436\u0434\u044b\u0435 tcp_keepalive_intvl \u0441\u0435\u043a\u0443\u043d\u0434 tcp_keepalive_probes \u0440\u0430\u0437, \u0435\u0441\u043b\u0438 \u0434\u0440\u0443\u0433\u0430\u044f \u0441\u0442\u043e\u0440\u043e\u043d\u0430 \u043d\u0435 \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442, \u0441\u043e\u043a\u0435\u0442 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f <code>tcp_keepalive=$(sysctl -a | grep net.ipv4.tcp_keepalive | grep -Po \"(?&lt;=\\=\\s)[0-9]+\")</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 <code>echo $tcp_keepalive | awk '{print $3+($1*$2)}'</code> 7200+(75*7) <code>sysctl net.ipv4.conf.all.rp_filter</code> 1 - \u0441\u0442\u0440\u043e\u0433\u0438\u0439 \u0440\u0435\u0436\u0438\u043c \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0438 2 - \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438, \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0444\u0438\u043b\u044c\u0442\u0440 \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0433\u043e \u043f\u0443\u0442\u0438 (reverse path filter) \u0438\u043b\u0438 \u0437\u0430\u0449\u0438\u0442\u0430 \u043e\u0442 \u043f\u043e\u0434\u043c\u0435\u043d\u044b \u0430\u0434\u0440\u0435\u0441\u043e\u0432 (\u0441\u043f\u0443\u0444\u0438\u043d\u0433\u0430), \u0432\u0441\u0435 \u0447\u0442\u043e \u043f\u043e\u0441\u0442\u0443\u043f\u0430\u0435\u0442 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440, \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u043d\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0435\u0433\u043e \u0430\u0434\u0440\u0435\u0441\u0430 \u0441 \u0442\u0430\u0431\u043b\u0438\u0446\u0435\u0439 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0438 \u0442\u0430\u043a\u0430\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0439, \u0435\u0441\u043b\u0438 \u043f\u0440\u0438\u043d\u044f\u0442\u044b\u0439 \u043f\u0430\u043a\u0435\u0442 \u043f\u0440\u0435\u0434\u043f\u043e\u043b\u0430\u0433\u0430\u0435\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0443 \u043e\u0442\u0432\u0435\u0442\u0430 \u0447\u0435\u0440\u0435\u0437 \u0442\u043e\u0442 \u0436\u0435 \u0441\u0430\u043c\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043a\u043e\u0433\u0434\u0430 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0442\u0440\u0430\u0444\u0438\u043a \u0438\u0434\u0435\u0442 \u0447\u0435\u0440\u0435\u0437 \u043e\u0434\u0438\u043d \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0442\u043e\u0440, \u0430 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0447\u0435\u0440\u0435\u0437 \u0434\u0440\u0443\u0433\u043e\u0439, \u043c\u043e\u0433\u0443\u0442 \u0442\u0435\u0440\u044f\u0442\u044c\u0441\u044f \u043f\u0430\u043a\u0435\u0442\u044b, \u043f\u043e\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u043e\u0431\u0440\u0430\u0442\u043d\u044b\u0439 \u043c\u0430\u0440\u0448\u0440\u0443\u0442 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u0438, \u0437\u0430\u0434\u0430\u043d \u0447\u0435\u0440\u0435\u0437 \u0434\u0440\u0443\u0433\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441. <code>sysctl -w net.ipv4.conf.ens33.rp_filter=1</code> \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0441\u0442\u0440\u043e\u0433\u0443\u044e \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u043d\u0430 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435 ens33 <code>sysctl net.ipv4.conf.all.log_martians</code> \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442/\u043e\u0442\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 <code>sysctl net.ipv4.tcp_window_scaling</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u0442/\u0437\u0430\u043f\u0440\u0435\u0449\u0430\u0435\u0442 \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 TCP-\u043e\u043a\u043d\u0430, \u043a\u0430\u043a \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043e \u0432 RFC 1323. \u041f\u0440\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0435 TCP-\u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u043f\u043e \u0442\u043e\u043b\u0441\u0442\u044b\u043c \u043a\u0430\u043d\u0430\u043b\u0430\u043c \u0432\u043e\u0437\u043d\u0438\u043a\u0430\u044e\u0442 \u043f\u043e\u0442\u0435\u0440\u0438 \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u043d\u043e\u0439 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u0438\u0437-\u0437\u0430 \u0442\u043e\u0433\u043e, \u0447\u0442\u043e \u043e\u043d\u0438 \u043d\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u043e \u043f\u0440\u0438\u0435\u043c\u0435 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e TCP-\u043e\u043a\u043d\u0430. \u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0432 \u0442\u043e\u043c, \u0447\u0442\u043e \u043e\u043a\u043d\u043e \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0438\u043c\u0435\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0431\u043e\u043b\u044c\u0448\u0435, \u0447\u0435\u043c 216 \u0431\u0430\u0439\u0442 (65 \u041a\u0431). \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u044f \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 TCP-\u043e\u043a\u043d\u0430 \u043c\u043e\u0436\u043d\u043e \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0435\u0433\u043e \u0440\u0430\u0437\u043c\u0435\u0440 \u0438 \u0442\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c \u043f\u043e\u0442\u0435\u0440\u0438 \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u043d\u043e\u0439 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438. <code>sysctl net.ipv4.tcp_retries2</code> <code>sysctl net.ipv4.tcp_abort_on_overflow</code> \u0437\u0430\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u044f\u0434\u0440\u043e \u043e\u0442\u0432\u0435\u0440\u0433\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f, \u0435\u0441\u043b\u0438 \u0438\u0445 \u043f\u043e\u0441\u0442\u0443\u043f\u0430\u0435\u043c\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u044b\u0448\u0435, \u0441 \u0447\u0435\u043c \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438 \u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c\u0441\u044f <code>sysctl net.ipv4.ip_nonlocal_bind</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u043c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430\u043c \u0432\u044b\u0441\u0442\u0443\u043f\u0430\u0442\u044c \u043e\u0442 \u0438\u043c\u0435\u043d\u0438 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e (\u0447\u0443\u0436\u043e\u0433\u043e) IP \u0430\u0434\u0440\u0435\u0441\u0430, \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u0442\u0440\u0435\u0431\u043e\u0432\u0430\u0442\u044c\u0441\u044f, \u043a\u043e\u0433\u0434\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0440\u043e\u0441\u043b\u0443\u0448\u0438\u0432\u0430\u0442\u044c \u0432\u043d\u0435\u0448\u043d\u0438\u0435 IP \u0430\u0434\u0440\u0435\u0441\u0430, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0441\u043d\u0438\u0444\u0444\u0438\u043d\u0433 \u0447\u0443\u0436\u043e\u0433\u043e \u0442\u0440\u0430\u0444\u0444\u0438\u043a\u0430 <code>net.ipv4.ipfrag_low_thresh</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043c \u043f\u0430\u043c\u044f\u0442\u0438, \u0432\u044b\u0434\u0435\u043b\u044f\u0435\u043c\u044b\u0439 \u043f\u043e\u0434 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0432 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d\u0435 \u043e\u0442 0 \u0434\u043e 2147483647, \u043a\u043e\u0433\u0434\u0430 \u0434\u043b\u0438\u043d\u0430 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u0434\u043e\u0441\u0442\u0438\u0433\u0430\u0435\u0442 \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u0440\u043e\u0433\u0430, \u0442\u043e \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u043e\u0432 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u0432\u0435\u0440\u0433\u0430\u0442\u044c \u0432\u0441\u0435 \u0444\u0440\u0430\u0433\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043f\u0430\u043a\u0435\u0442\u044b \u0438 \u043f\u043e\u0441\u043b\u0435 \u0443\u043c\u0435\u043d\u044c\u0448\u0435\u043d\u0438\u044f \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u043e\u043d\u0438 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u044b \u0443\u0437\u043b\u043e\u043c-\u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u0435\u043c. <code>sysctl net.ipv4.netfilter.ip_conntrack_max</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u0430 connection tracking (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0432 iptables)</p>"},{"location":"Linux/#limits","title":"limits","text":"<p><code>cat /etc/security/limits.conf | grep -Ev \"^$|^#\"</code></p> <pre><code>&lt;user/@group&gt;  &lt;soft/hard&gt;  &lt;core/rss/as/nproc/cpu&gt;  &lt;value&gt;\n@zabbix           soft              nofile          65535 # \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c soft \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 \u043a\u043e\u043b-\u0432\u043e \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 (nofile) \u0434\u043b\u044f \u0433\u0440\u0443\u043f\u043f\u044b zabbix (\u043c\u043e\u0436\u043d\u043e \u043c\u0435\u043d\u044f\u0442\u044c \u0432 \u043b\u044e\u0431\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u043d\u0443, \u043f\u043e\u043a\u0430 \u043e\u043d\u043e \u043d\u0435 \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0435\u0442 hard)\n@zabbix           hard              nofile          65535 # \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 hard \u043c\u043e\u0436\u043d\u043e \u043c\u0435\u043d\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u043c\u0435\u043d\u044c\u0448\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u043d\u0443 \u043e\u0442 \u0438\u043c\u0435\u043d\u0438 \u043e\u0431\u044b\u0447\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\n*                 soft              nofile          2048 # \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 (-n)\n*                 hard              nofile          8192\nzabbix            soft              as              100 # \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b-\u0432\u043e \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 \u0432 \u041a\u0411 (-m)\nzabbix            hard              as              100\n*                 soft              msgqueue        unlimited # \u0441\u043d\u044f\u0442\u0438\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 (-q)\n*                 hard              msgqueue        unlimited\n*                 soft              nproc           unlimited # \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 (-u)\n*                 hard              nproc           unlimited\nuser              hard              maxlogins       1 # \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e SSH-\u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439/\u0441\u0435\u0441\u0441\u0438\u0439 \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0435\u0430\u043d\u0441\u043e\u0432 SSH \u043f\u043e\u0434 \u043e\u0434\u043d\u0438\u043c \u0438 \u0442\u0435\u043c \u0436\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c)\n*                 hard              maxsyslogins    1 # \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0442\u044c \u043e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0435\u0430\u043d\u0441\u043e\u0432/\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 SSH (\u0437\u0430 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c root)\n</code></pre> <p><code>ulimit -a</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0439</p> <pre><code>core file size              (blocks, -c) 0\ndata seg size               (kbytes, -d) unlimited\nscheduling priority                 (-e) 0\nfile size                   (blocks, -f) unlimited\npending signals                     (-i) 15052\nmax locked memory           (kbytes, -l) 496180\nmax memory size             (kbytes, -m) unlimited\nopen files                          (-n) 1024\npipe size                (512 bytes, -p) 8\nPOSIX message queues         (bytes, -q) 819200\nreal-time priority                  (-r) 0\nstack size                  (kbytes, -s) 8192\ncpu time                   (seconds, -t) unlimited\nmax user processes                  (-u) 15052\nvirtual memory              (kbytes, -v) unlimited\nfile locks                          (-x) unlimited\n</code></pre> <p><code>ulimit -Sn</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f Soft (-S) \u0434\u043b\u044f nofile (-n) <code>ulimit -Hn</code> \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 Hard (-H) <code>ulimit -n 3000</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u0434\u043b\u044f \u043e\u0434\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 (\u0434\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438) <code>ulimit -Sm 1500000</code> \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 soft (-S) \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 (-m) \u0432 1500 \u041c\u0431 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>ulimit -u 5000</code> \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 (-u) <code>ulimit -s</code> \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043c\u0435\u0441\u0442\u0430 \u0434\u043b\u044f \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432 (stack size) \u043a\u043e\u043c\u0430\u043d\u0434\u044b/\u0441\u043a\u0440\u0438\u043f\u0442\u0430 (bash: /usr/bin/diff: Argument list too long) <code>ulimit -m</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043c \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 <code>ulimit -v</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 <code>ulimit -f</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0435\u043c\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 <code>ulimit -t</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043d\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438</p> <p><code>systemctl edit rsyslog</code> \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 Unit \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0430</p> <pre><code>[Service]\nLimitNOFILE=1617596\nLimitNOFILESoft=1617596\n</code></pre> <p><code>systemctl restart rsyslog</code> <code>pid=$(ps -A | grep rsyslogd | awk '{print $1}')</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c pid \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 <code>cat /proc/$pid/limits</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0439 \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\u0430</p>"},{"location":"Linux/#quota","title":"quota","text":"<p><code>nano /etc/fstab</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u0432\u043e\u0442\u0443 \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c\u0438 \u043e\u043f\u0446\u0438\u044f\u043c\u0438</p> <pre><code>/dev/sda  /  ext4  defaults,usrquota,grpquota  0 0\n</code></pre> <p><code>mount -o remount,rw /</code> \u043f\u0435\u0440\u0435\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0444\u0430\u0439\u043b\u043e\u0432\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 read and write <code>mount | grep quota</code> <code>quotacheck -favugm</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u043d\u0430\u043b\u0438\u0447\u0438\u044f \u0441\u043b\u0443\u0436\u0435\u0431\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 aquota.user \u0438 aquota.group \u2014 \u0435\u0441\u043b\u0438 \u0438\u0445 \u043d\u0435\u0442, \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u0438\u0445 \u0441\u043e\u0437\u0434\u0430\u0441\u0442 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 <code>quotaon -avug</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043a\u0432\u043e\u0442\u0443 <code>edquota -u lifailon</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u0432\u043e\u0442\u0443 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u043b\u0438 \u0434\u043b\u044f \u0433\u0440\u0443\u043f\u043f\u044b (-g) \u043d\u0430 \u0440\u0430\u0437\u043c\u0435\u0440 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043a\u043e\u043b-\u0432\u043e \u0444\u0430\u0439\u043b\u043e\u0432</p> <pre><code>Disk quotas for user lifailon (uid 1000):\n  Filesystem                            blocks       soft       hard     inodes     soft     hard\n  /dev/mapper/ubuntu--vg-ubuntu--lv     397112       400M       500M      3004       0        0\n</code></pre> <p><code>edquota -p lifailon user</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043a\u0432\u043e\u0442\u0443 \u043d\u0430 \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>edquota -t</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0435\u0440\u0438\u043e\u0434 \u043e\u0442\u0441\u0440\u043e\u0447\u043a\u0438 soft \u043a\u0432\u043e\u0442\u044b \u0434\u043e \u043c\u043e\u043c\u0435\u043d\u0442\u0430, \u043a\u043e\u0433\u0434\u0430 \u043e\u043d\u0430 \u0441\u0442\u0430\u043d\u0435\u0442 hard (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e 7 \u0434\u043d\u0435\u0439) <code>quota lifailon -s</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u0432\u043e\u0442\u044b \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>repquota -us /</code> \u043e\u0442\u0447\u0435\u0442 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0438 \u0433\u0440\u0443\u043f\u043f (-u/-g), \u0442\u0435\u043a\u0443\u0449\u0438\u0439 used \u0438 soft/hard \u0434\u043b\u044f Space limits \u0438 File limits, +-/-+/++ \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442, \u0447\u0442\u043e \u043e\u0434\u0438\u043d \u0438\u0437 \u043f\u0440\u0435\u0434\u0435\u043b\u043e\u0432 \u0434\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442 \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c\u0430</p> <pre><code>lifailon  --     388M     400M     500M     3004     0     0\n</code></pre> <p><code>su lifailon</code> <code>dd if=/dev/zero of=/tmp/test.file bs=1024000 count=400</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c 400MB</p> <pre><code>dd: error writing '/tmp/test.file': Disk quota exceeded\n117645312 bytes (118 MB, 112 MiB) copied, 0.158031 s, 744 MB/s\n</code></pre> <p><code>ls -lh /tmp/test.file</code></p> <pre><code>-rw-rw-r-- 1 lifailon lifailon 113M Sep 26 14:37 /tmp/test.file\n</code></pre>"},{"location":"Linux/#networkmanager","title":"networkmanager","text":"<p><code>apt install network-manager</code> <code>systemctl status NetworkManager</code> <code>nmcli device status</code> \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 <code>nmcli general status</code> <code>nmcli connection show</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 (ethernet, vpn \u0438 WiFi-\u0441\u0435\u0442\u0435\u0439) <code>nmcli device wifi list</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 Wi-Fi-\u0441\u0435\u0442\u0435\u0439 <code>nmcli connection show \"\u041f\u0440\u043e\u0432\u043e\u0434\u043d\u043e\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 2\"</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0435\u0442\u0438 <code>nmcli connection up \"\u041f\u0440\u043e\u0432\u043e\u0434\u043d\u043e\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 2\"</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f <code>nmcli conn down \"\u041f\u0440\u043e\u0432\u043e\u0434\u043d\u043e\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 2\"</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f <code>nmcli radio wifi</code> \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 Wi-Fi <code>nmcli connection add con-name \"dhcp\" type ethernet ifname ens33</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435, \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0442\u0438\u043f \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 ethernet (\u041f\u0440\u043e\u0432\u043e\u0434\u043d\u043e\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435) \u0438 ifname, \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 <code>nmcli conn modify \"dhcp\" ipv4.dns 8.8.8.8</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f (modify) <code>nmcli radio wifi on</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0438\u043b\u0438 \u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c (off) Wi-Fi <code>nmcli device wifi connect \"TP-Link\" password 12345678 name \"TP-Link Wifi\"</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a Wi-Fi \u0441\u0435\u0442\u0438 <code>nmcli networking off</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u0435\u0442\u044c \u0447\u0435\u0440\u0435\u0437 (\u0435\u0441\u043b\u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 Network Manager, \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0432 \u0431\u043b\u043e\u043a\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 renderer \u0434\u043b\u044f netplan) <code>nmcli networking on</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u0435\u0442\u044c <code>systemctl restart NetworkManager</code></p>"},{"location":"Linux/#wireless","title":"wireless","text":"<p><code>apt install wireless-tools</code> <code>iwconfig</code> <code>apt install iw</code> <code>iw list</code> <code>apt install wavemon</code> <code>wavemon</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0438 \u043c\u043e\u0449\u043d\u043e\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u0447\u0438\u043a\u0430</p>"},{"location":"Linux/#networking","title":"networking","text":"<p><code>nano /etc/network/interfaces</code></p> <p><code>auto ens33</code> \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 <code>iface ens33 inet static</code> \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 <code>address 192.168.1.50/24</code> <code>#netmask 255.255.255.0</code> <code>gateway 192.168.1.254</code> <code>dns-nameservers 8.8.8.8 1.1.1.1</code></p> <p><code>auto ens33</code> <code>iface ens33 inet dhcp</code> \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0439</p> <p><code>service networking restart</code> \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u0435\u0442\u0438 <code>systemctl restart networking.service</code></p>"},{"location":"Linux/#netplan","title":"netplan","text":"<p><code>netplan --debug generate</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u043d\u0430 \u043e\u0448\u0438\u0431\u043a\u0438 <code>netplan apply</code> \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f (\u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0441\u0435\u0442\u044c) <code>netplan get</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e</p> <p><code>nano /etc/netplan/*.yaml</code></p> <ul> <li>\u0414\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0430\u0434\u0440\u0435\u0441 (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0432\u0430 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430):</li> </ul> <pre><code>network:\n  version: 2\n  ethernets:\n    ens33:\n      dhcp4: yes\n    ens36:\n      dhcp4: yes\n</code></pre> <ul> <li>\u0421\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0430\u0434\u0440\u0435\u0441:</li> </ul> <pre><code>network:\n  version: 2\n  renderer: networkd\n  ethernets:\n    ens33:\n      dhcp4: no\n      addresses: [192.168.3.105/24]\n      routes:\n        - to: default\n          via: 192.168.3.1\n      nameservers:\n        addresses: [192.168.3.101, 8.8.8.8, 1.1.1.1]\n        search: [domain.local]\n</code></pre> <p>renderer \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442, \u043a\u043e\u043c\u0443 \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u0442\u044c\u044e NetworkManager (nmcli) \u0432 \u0441\u0440\u0435\u0434\u0430\u0445 \u0441 \u0433\u0440\u0430\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u043c \u0438\u043b\u0438 networkd (networkctl)</p> <p><code>netplan status</code> \u0432 \u0440\u0435\u043b\u0438\u0437\u0435 netplan 0.106 \u043e\u0442 \u0444\u0435\u0432\u0440\u0430\u043b\u044f 2023 (Ubuntu 23.04) \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u043e\u0433\u043e renderer</p> <ul> <li>MAC \u0438 MTU:</li> </ul> <pre><code>network:\n  ethernets:\n    ens33:\n      dhcp4: no\n      match:\n        macaddress: 54:43:32:21:10:09\n        mtu: 1500\n</code></pre> <ul> <li>\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a WiFi:</li> </ul> <pre><code>network:\n  version: 2\n  wifis:\n    wlp33:\n      dhcp4: yes\n      dhcp6: no\n      nameservers:\n        addresses: [8.8.8.8]\n      access-points:\n        \"wifi-ssid\":\n          password: \"12345678\"\n</code></pre> <ul> <li>Bonding \u0434\u043b\u044f \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 \u0432 \u043e\u0434\u0438\u043d \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439:</li> </ul> <pre><code>network:\n  version: 2\n  ethernets:\n    ens33: {}\n    ens36: {}\n  bonds:\n    bond0:\n      dhcp4: no\n        interfaces:\n          - ens33\n          - ens36\n          parameters:\n            mode: active-backup # \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0434\u0438\u043d \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441, \u0432\u0442\u043e\u0440\u043e\u0439 \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u043d\u0435\u0440\u0430\u0431\u043e\u0442\u043e\u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u043f\u0435\u0440\u0432\u043e\u0433\u043e\n            mode: broadcast # \u0437\u0430\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0442\u0441\u044f \u043e\u0431\u0430 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e, \u043f\u0430\u043a\u0435\u0442\u044b \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442 \u0432\u0441\u0435 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u044b\n            mode: balance-rr # \u0437\u0430\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0442\u0441\u044f \u043e\u0431\u0430 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 \u043f\u043e \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u0441 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435\u043c \u043f\u0430\u043a\u0435\u0442\u043e\u0432\n            mode: balance-tlb # \u0437\u0430\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0442\u0441\u044f \u043e\u0431\u0430 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 \u043f\u043e \u043e\u0447\u0435\u0440\u0435\u0434\u0438, \u043f\u0430\u043a\u0435\u0442\u044b \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442\u0441\u044f \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u043e\u0439\n            mode: balance-xor # \u0437\u0430\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0442\u0441\u044f \u043e\u0431\u0430 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 \u043f\u043e \u043e\u0447\u0435\u0440\u0435\u0434\u0438, \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 \u0445\u0435\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\n          addresses:\n            - 192.168.1.150/24\n          gateway4: 192.168.1.1\n          mtu: 1500\n          nameservers:\n            addresses:\n              - 8.8.8.8\n</code></pre>"},{"location":"Linux/#ip","title":"ip","text":"<p><code>ip a</code> ip addr show <code>ip -s link</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u0442\u0438\u0442\u0441\u0442\u0438\u043a\u0443 \u0432\u0441\u0435\u0445 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 <code>ip -br a show</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430, \u0441\u0442\u0430\u0442\u0443\u0441 \u0440\u0430\u0431\u043e\u0442\u044b \u0438 ip-\u0430\u0434\u0440\u0435\u0441 <code>ip link set dev ens33 up</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 <code>ip link set dev ens33 down</code> \u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441  <code>ip link set mtu 1550 dev ens33</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c mtu <code>ip link set dev ens33 address AA:BB:CC:DD:EE:FF</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c mac-\u0430\u0434\u0440\u0435\u0441 (\u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0443\u0436\u043d\u043e \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441, \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0434\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438) <code>ip addr add 192.168.3.106/24 broadcast 192.168.3.255 dev ens33</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0430\u0434\u0440\u0435\u0441 <code>ip addr del 192.168.3.106/24 dev ens33</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u0434\u0440\u0435\u0441 <code>ip route show</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u0438 <code>ip route add 192.168.4.0 via 192.168.3.100</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0430\u0440\u0448\u0440\u0443\u0442 <code>ip route del 192.168.4.0 via 192.168.3.100</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u0430\u0440\u0448\u0440\u0443\u0442 <code>ip route add 192.168.4.0 dev ens33</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441, \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u043f\u0430\u043a\u0435\u0442\u044b \u0432 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u0443\u044e \u043f\u043e\u0434\u0441\u0435\u0442\u044c <code>ip neigh show</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c ARP-\u0442\u0430\u0431\u043b\u0438\u0446\u0443 <code>ip neigh add 192.168.3.110 lladdr b0:be:76:43:21:41 dev ens33</code> <code>ip neigh del dev end33 192.168.3.110</code> <code>ip neigh flush</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c ARP-\u0442\u0430\u0431\u043b\u0438\u0446\u0443</p>"},{"location":"Linux/#net-tools","title":"net-tools","text":"<p><code>ifconfig ens33</code> up/down <code>ifdown -a</code> \u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0432\u0441\u0435 \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u044b (\u043f\u0440\u043e\u043f\u0430\u0434\u0443\u0442 \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430 ifconfig) \u0438 \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c (ifup -a) <code>ifconfig ens33 192.168.3.106 netmask 255.255.255.0 broadcast 192.168.3.255</code> <code>ifconfig -s || netstat -i</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 <code>netstat -atu</code> ALL (-a) tcp (-t) \u0438 udp (-u) <code>netstat -lntup</code> LISTEN (-l) dont resolve names (-n) \u0438 \u0441\u043a\u0430\u043d\u0438\u0440\u0443\u0435\u0442 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e /proc \u0434\u043b\u044f \u0432\u044b\u0432\u043e\u0434\u0430 PID/Program name (-p) <code>arp -a</code> \u0442\u0430\u0431\u043b\u0438\u0446\u0430 \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f ip \u0438 mac \u0430\u0434\u0440\u0435\u0441\u043e\u0432 <code>route -e</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u0438 <code>route add -net 192.168.4.0 netmask 255.255.255.0 gw 192.168.3.100</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0430\u0440\u0448\u0440\u0443\u0442 \u0432 \u043f\u043e\u0434\u0441\u0435\u0442\u044c 192.168.4.0 \u0447\u0435\u0440\u0435\u0437 \u0448\u043b\u044e\u0437 192.168.3.100 <code>route del -net 192.168.4.0 netmask 255.255.255.0</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u0430\u0440\u0448\u0440\u0443\u0442</p>"},{"location":"Linux/#networkd","title":"networkd","text":"<p><code>systemctl status systemd-networkd</code> <code>networkctl list</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u043e\u0432, \u0442\u0438\u043f \u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f <code>networkctl status</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0441\u043b\u0443\u0436\u0431\u044b, Address \u0438 Gateway \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0430, DNS-\u0430\u0434\u0440\u0435\u0441\u0430 \u0438 \u043b\u043e\u0433 systemd-networkd <code>networkctl status ens33</code> \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0430 (Network File, Driver, Vendor, Model, MTU, Speed)</p>"},{"location":"Linux/#ss","title":"ss","text":"<p><code>ss -a</code> All \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0441\u043e\u043a\u0435\u0442\u044b <code>ss -l</code> \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u043e\u0441\u043b\u0443\u0448\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u0441\u043e\u043a\u0435\u0442\u044b (LISTEN) <code>ss -t</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0435 TCP \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f (ESTAB/ESTABLISHED) <code>ss -ua</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 UDP \u0441\u043e\u043a\u0435\u0442\u044b <code>ss -da</code> DHCP \u0441\u043e\u043a\u0435\u0442\u044b <code>ss -x</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0435 UNIX \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f <code>ss -r</code> Resolve, \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u0438\u043c\u0435\u043d\u0430 \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e DNS <code>ss -p</code> Processes, \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0449\u0438\u0435 \u0441\u043e\u043a\u0435\u0442 <code>ss -n</code> Numeric \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0442\u044c \u0438\u043c\u0435\u043d\u0430 \u0441\u043b\u0443\u0436\u0431 (\u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u043e\u043c\u0435\u0440 \u043f\u043e\u0440\u0442\u0430 \u0432 \u0447\u0438\u0441\u043b\u043e\u0432\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435) <code>ss -ltp | grep 8080</code> <code>ss -tna | grep 22</code></p>"},{"location":"Linux/#dns","title":"dns","text":""},{"location":"Linux/#resolv","title":"resolv","text":"<p><code>cat /etc/resolv.conf | grep nameserver</code> <code>nano /etc/resolv.conf</code> \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0434\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 <code>domain domain.local</code> <code>search domain.local</code> <code>nameserver 8.8.8.8</code> <code>nameserver 1.1.1.1</code></p>"},{"location":"Linux/#resolved","title":"resolved","text":"<p><code>networkctl status</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 DNS-\u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0447\u0435\u0440\u0435\u0437 netplan (\u0438\u043b\u0438 \u0434\u0440\u0443\u0433\u043e\u0435) \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u043e\u0432 <code>resolvectl status</code> \u0432 systemd 239 (ubuntu 22.04) systemd-resolve \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d \u0432 resolvectl, \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0434\u043b\u044f global \u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435 \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 Link (ens33) <code>resolvectl status | grep \"Current DNS\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 DNS-\u0441\u0435\u0440\u0432\u0435\u0440 <code>systemd-resolve --status</code> \u0441\u043b\u0443\u0436\u0431\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e DNS \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>resolvectl flush-caches &amp;&amp; systemd-resolve --flush-caches</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u044d\u0448 DNS <code>journalctl -u systemd-resolved | grep -E \"IN A|IN PTR|IN AAAA|IN PTR|IN MX\"</code> \u043b\u043e\u0433\u0438 \u043a\u044d\u0448\u0430 DNS <code>systemctl status systemd-resolved</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0441\u043b\u0443\u0436\u0431\u044b \u0438 \u0435\u0433\u043e \u043b\u043e\u0433 <code>cat /run/systemd/resolve/stub-resolv.conf</code> \u0444\u0430\u0439\u043b-\u0437\u0430\u0433\u043b\u0443\u0448\u043a\u0430 \u0434\u043b\u044f \u0434\u0435\u043c\u043e\u043d\u0430 systemd-resolved, \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e nameserver 127.0.0.53, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043a \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u043c\u0443 DNS \u0441\u0435\u0440\u0432\u0435\u0440\u0443, \u0430 \u043e\u043d, \u0432 \u0441\u0432\u043e\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0443\u0436\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0432 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0435</p> <p><code>nano /etc/systemd/resolved.conf</code> \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b, \u043e\u0442\u0432\u0435\u0447\u0430\u044e\u0449\u0438\u0439 \u0437\u0430 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0443 DNS-\u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432</p> <p>\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043a\u044d\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435:</p> <pre><code>[Resolve]\nDNS=8.8.8.8, 192.168.3.101\nCache=yes\n</code></pre> <p><code>ln -svi /run/systemd/resolve/resolv.conf /etc/resolv.conf</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0438\u043c\u043b\u0438\u043d\u043a \u0434\u043b\u044f \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0441\u0442\u0438 \u0441 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\u043c\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u0447\u043d\u044b\u0435 \u0432\u044b\u0437\u043e\u0432\u044b, \u0430 \u043e\u0431\u0440\u0430\u0449\u0430\u044e\u0442\u0441\u044f \u043a DNS \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e, \u043f\u043e\u043b\u0443\u0447\u0430\u044f \u0438\u0445 \u0438\u0437 <code>/etc/resolv.conf</code> <code>ls -la /etc/resolv.conf</code></p> <p><code>nano /etc/resolv.conf</code> \u043d\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0441\u043b\u0443\u0436\u0431\u043e\u0439 systemd-resolved, \u0430 \u0438\u043d\u043e\u0433\u0434\u0430 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f initscripts \u0438\u043b\u0438 NetworkManager, \u0438 \u043b\u044e\u0431\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u044b \u0447\u0435\u0440\u0435\u0437 \u0432\u0440\u0435\u043c\u044f \u0438\u043b\u0438 \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438</p> <pre><code>nameserver 8.8.8.8\n</code></pre> <p><code>apt install resolvconf</code> \u0441\u0435\u0440\u0432\u0438\u0441 \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u043f\u0438\u0441\u0430 \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u0432 /etc/resolv.conf (\u0447\u0442\u043e \u0431\u044b \u043e\u043d \u043d\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u043b\u0441\u044f) <code>systemctl status resolvconf</code></p> <p><code>nano /etc/resolvconf/resolv.conf.d/head</code></p> <pre><code>nameserver 8.8.8.8\nnameserver 1.1.1.1\n</code></pre>"},{"location":"Linux/#dig","title":"dig","text":"<p><code>dig</code> <code>dig google.com</code> <code>dig @1.1.1.1 google.com a</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c DNS \u0441\u0435\u0440\u0432\u0435\u0440 Cloudflare \u0434\u043b\u044f \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0438\u043c\u0435\u043d\u0438 <code>dig @9.9.9.9 google.com mx</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c DNS \u0441\u0435\u0440\u0432\u0435\u0440 Quad9 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f MX \u0437\u0430\u043f\u0438\u0441\u0438 (A, NS, TXT) <code>dig -x 8.8.8.8 @9.9.9.9</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c ip \u0432 \u0438\u043c\u044f</p>"},{"location":"Linux/#mtr","title":"mtr","text":"<p><code>mtr google.com</code> \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0435\u0442 traceroute \u0438 ping \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0432 \u0442\u0440\u0430\u0441\u0441\u0435\u0440\u043e\u0432\u043a\u0435 <code>mtr -I ens33 google.com</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 <code>mtr -b google.com</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c \u0438\u043c\u044f \u0438 ip <code>mtr --tcp google.com</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c TCP SYN-\u043f\u0430\u043a\u0435\u0442\u044b \u0438\u043b\u0438 UDP-\u0434\u0435\u0439\u0442\u0430\u0433\u0440\u0430\u043c\u043c\u044b (--udp) <code>mtr -s 1000 google.com</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u0430\u043a\u0435\u0442\u0430 <code>mtr -r -c 1 google.com --json</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043a\u043e\u043b-\u0432\u043e ping \u043f\u0430\u043a\u0435\u0442\u043e\u0432 (-c 1 \u0438 -i 2 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b) \u0438 \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0432 \u0432\u0438\u0434\u0435 \u043e\u0442\u0447\u0435\u0442\u0430 (--report) \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 json/xml/csv/raw</p>"},{"location":"Linux/#vnstat","title":"vnstat","text":"<p><code>apt install vnstat</code> \u0436\u0443\u0440\u043d\u0430\u043b \u0447\u0430\u0441\u043e\u0432\u043e\u0433\u043e, \u0435\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u043e\u0433\u043e \u0438 \u0435\u0436\u0435\u043c\u0435\u0441\u044f\u0447\u043d\u043e\u0433\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0442\u0440\u0430\u0444\u0438\u043a\u0430 <code>systemctl status vnstat</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443 <code>vnstat -l</code> \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 <code>vnstat -h</code> \u0435\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u0430\u044f \u043f\u043e\u0447\u0430\u0441\u043e\u0432\u0430\u044f \u0438\u0441\u0442\u043e\u0440\u0438\u044f</p>"},{"location":"Linux/#netcat","title":"netcat","text":"<p><code>nc -zv 192.168.3.100 5985</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043f\u043e\u0440\u0442 \u0431\u0435\u0437 \u043f\u043e\u043f\u044b\u0442\u043a\u0438 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f (-z) \u0432 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 (-v) <code>nc -zvn 192.168.3.100 1-1000</code> \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 tcp-\u043f\u043e\u0440\u0442\u043e\u0432, \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0435 DNS (-n) <code>nc -zvn 192.168.3.100 1-1000 2&gt;&amp;1 | grep succeeded</code> \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043e\u0448\u0438\u0431\u043e\u043a \u0432 stdout \u0438 \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 <code>nc -zvnu 192.168.3.100 5550-5560</code> \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 udp-\u043f\u043e\u0440\u0442\u043e\u0432 (-u) <code>nc -lp 8081</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0441\u043e\u043a\u0435\u0442 (\u0447\u0430\u0442 \u0441\u0435\u0440\u0432\u0435\u0440) \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u043f\u0440\u043e\u0441\u043b\u0443\u0448\u0438\u0432\u0430\u043d\u0438\u044f (-listen) \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u043d\u043e\u043c\u0435\u0440\u0430 \u043f\u043e\u0440\u0442\u0430 (-p) <code>nc 192.168.3.101 8081</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u043e\u043a\u0435\u0442\u0443 (\u0447\u0430\u0442-\u043a\u043b\u0438\u0435\u043d\u0442) <code>nc -lp 8081 &gt; out.txt</code> \u0432\u0441\u0435 \u043f\u043e\u0441\u0442\u0443\u043f\u0438\u0432\u0448\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u0441\u043e\u043a\u0435\u0442 \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0432 \u0444\u0430\u0439\u043b (\u0432\u043c\u0435\u0441\u0442\u043e \u0432\u044b\u0432\u043e\u0434\u0430 \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c) <code>cat /etc/passwd | nc -N 192.168.3.101 8081</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0444\u0430\u0439\u043b\u0430 \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u0441\u043e\u043a\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e\u0449\u0435\u0439 \u0441\u0442\u043e\u0440\u043e\u043d\u044b (\u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 /etc/passwd \u0437\u0430\u043f\u0438\u0448\u0435\u0442\u0441\u044f \u0432 out.txt) \u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u0441\u043e\u043a\u0435\u0442 (-N) <code>nc -l -w 1 -p 8081</code> \u0437\u0430\u0434\u0430\u0442\u044c timeout (-w) \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f, \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0438 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440 \u0441\u043b\u0443\u0448\u0430\u0435\u0442 \u0437\u0430\u043f\u0440\u043e\u0441, \u0435\u0441\u043b\u0438 \u0431\u0443\u0434\u0435\u0442 0, \u043c\u043e\u0436\u0435\u0442 \u043d\u0435 \u0443\u0441\u043f\u0435\u0442\u044c \u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441, \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 timeout \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043d\u0435 \u043d\u0438\u0436\u0435 <code>nc -w 5 -Uvl server.sock &gt; out.txt</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c UNIX-\u0441\u043e\u043a\u0435\u0442 \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u0432 \u0444\u0430\u0439\u043b, \u0441\u043e\u043a\u0435\u0442 \u0437\u0430\u043a\u0440\u043e\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 5 \u0441\u0435\u043a\u0443\u043d\u0434 (-w 5) \u0438\u043b\u0438 \u0435\u0441\u043b\u0438 \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u0434\u0430\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 -N \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 <code>lsblk | nc -Uv server.sock</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u0441\u043e\u043a\u0435\u0442\u0443 \u0441 \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b\u0430 \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0432 \u0444\u0430\u0439\u043b \u0441\u043e\u043a\u0435\u0442\u0430 \u043f\u0440\u0438\u0435\u043c\u0430 <code>while true; do echo -e \"HTTP/1.1 200 OK\\n\\n$(systemd-analyze plot)\" | nc -l -w 1 -p 8085; done</code> HTTP-\u0441\u0435\u0440\u0432\u0435\u0440 \u0441 \u0432\u044b\u0432\u043e\u0434\u043e\u043c \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b</p>"},{"location":"Linux/#api","title":"api","text":"<pre><code>port=8085\nwhile true\ndo\n    request=$(nc -l -w 1 -p $port)\n    request=$(echo \"$request\" | head -n 1)\n    method=$(echo \"$request\" | cut -d \" \" -f 1)\n    endpoint=$(echo \"$request\" | cut -d \" \" -f 2)\n    if [[ $endpoint == \"/api/date\" ]]\n        then\n        response=\"HTTP/1.1 200 OK\\nContent-Type: application/text\\n\\n$(date)\"\n    elif [[ $endpoint == \"/api/disk\" ]]\n        then\n        response=\"HTTP/1.1 200 OK\\nContent-Type: application/json\\n\\n$(lsblk -e7 --json)\"\n    else\n        response=\"HTTP/1.1 404 Not Found\\n\\n404 Not Found\\n\"\n    fi\n    echo -e \"$response\" | nc -l -w 1 -p $port\ndone\n</code></pre> <p>curl -s http://192.168.3.101:8085/api/date curl -s http://192.168.3.101:8085/api/disk | jq .blockdevices[]</p>"},{"location":"Linux/#proxy","title":"proxy","text":"<p><code>ncat -l 8080 -k --sh-exec \"ncat 192.168.3.101 80\"</code> <code>socat TCP-LISTEN:8080,fork,reuseaddr TCP:192.168.3.101:80</code></p>"},{"location":"Linux/#nmap","title":"nmap","text":"<p><code>nmap localhost</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043a\u0430\u043a\u0438\u0435 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u0440\u0442\u044b \u043f\u0440\u043e\u0441\u043b\u0443\u0448\u0438\u0432\u0430\u044e\u0442\u0441\u044f <code>nmap -sV localhost</code> \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043a\u0430\u043a\u043e\u0435 \u043a\u0430\u043a\u0430\u044f \u041e\u0421 \u0438 \u041f\u041e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043d\u0430 \u043f\u043e\u0440\u0442\u0430\u0445 \u0438 \u0438\u0445 \u0432\u0435\u0440\u0441\u0438\u044f <code>nmap -sL 192.168.3.0/24</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0445\u043e\u0441\u0442\u043e\u0432 \u0441 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435\u043c \u0438\u043c\u0435\u043d \u0431\u0435\u0437 \u043f\u0438\u043d\u0433\u0430 <code>nmap -sP 192.168.3.0/24</code> ping \u043c\u0435\u0442\u043e\u0434 host discovery (TCP ACK SYN \u043f\u0430\u043a\u0435\u0442, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435\u0439 \u0432\u044b\u0437\u043e\u0432 connect) \u0441 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435\u043c \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u043f\u043b\u0430\u0442\u044b <code>nmap -F 192.168.3.0/24</code> fast mode port <code>nmap -A 192.168.3.100</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0435 \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u041e\u0421 \u0438 \u041f\u041e (ssh \u043d\u0430 \u0434\u0440\u0443\u0433\u043e\u043c \u043f\u043e\u0440\u0442\u0443, version, ad sites, rdp-ntlm-info) <code>nmap -sA 192.168.3.100</code> \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044e \u043f\u0430\u043a\u0435\u0442\u043e\u0432 fw (filtered/unfiltered) \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e TCP ACK <code>nmap -PN 192.168.3.100</code> \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0437\u0430\u0449\u0438\u0449\u0435\u043d\u043d\u043e\u0433\u043e \u0445\u043e\u0441\u0442\u0430 \u0431\u0435\u0437 ping <code>nmap -sO 192.168.3.100</code> \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043a\u0430\u043a\u0438\u0435 \u0438\u043c\u0435\u043d\u043d\u043e IP-\u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u044b \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0438 \u0438\u0445 \u0441\u0442\u0430\u0442\u0443\u0441, \u0435\u0441\u043b\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442, \u0437\u043d\u0430\u0447\u0438\u0442 \u0444\u0438\u043b\u044c\u0442\u0440\u0443\u0435\u0442\u0441\u044f <code>nmap -PU 192.168.3.100</code> \u043e\u0431\u043e\u0439\u0442\u0438 \u043c\u0435\u0436\u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u044d\u043a\u0440\u0430\u043d \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e UDP-\u043f\u0438\u043d\u0433\u0430 <code>nmap -sS 192.168.3.100</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043f\u043e\u043b\u0443\u043e\u0442\u043a\u0440\u044b\u0442\u043e\u0435 \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 (TCP SYN) \u0431\u0435\u0437 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f <code>nmap -sU 192.168.3.100</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0442\u043e\u043b\u044c\u043a\u043e UDP-\u043f\u043e\u0440\u0442\u043e\u0432</p>"},{"location":"Linux/#rustscan","title":"rustscan","text":"<p><code>wget https://github.com/RustScan/RustScan/releases/download/2.0.1/rustscan_2.0.1_amd64.deb</code>snap install nmap<code>\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438</code>apt-get install -f<code>\u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438</code>dpkg --install rustscan_2.0.1_amd64.deb<code></code>rustscan -a 127.0.0.1<code></code>rustscan -a 192.168.3.100` 32400/tcp open plex</p>"},{"location":"Linux/#tcpdump","title":"tcpdump","text":"<p><code>tcpdump -D</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 <code>tcpdump -n -i ens33 icmp</code> \u0441\u043b\u0443\u0448\u0430\u0442\u044c icmp-\u043f\u0430\u043a\u0435\u0442\u044b \u043e\u0442 \u0432\u0441\u0435\u0445 \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435 (-i) \u0431\u0435\u0437 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u0445 \u0438\u043c\u0435\u043d (-n) <code>tcpdump -n -i ens33 udp -e</code> \u0441\u043b\u0443\u0448\u0430\u0442\u044c udp-\u043f\u0430\u043a\u0435\u0442\u044b \u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c MAC-\u0430\u0434\u0440\u0435\u0441\u0430 (-e) <code>tcpdump -n -i ens33 port 8080</code> \u0441\u043b\u0443\u0448\u0430\u0442\u044c \u0442\u0440\u0430\u0444\u0438\u043a 8080 \u043f\u043e\u0440\u0442\u0430 <code>tcpdump -n -i ens33 port 80 or 443</code> <code>tcpdump -n -i ens33 portrange 21-80</code> <code>tcpdump -n -i ens33 ip src 192.168.3.99 and dst 192.168.3.103</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c ip \u043f\u0430\u043a\u0435\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e (src) ip-\u0430\u0434\u0440\u0435\u0441\u0430 \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 (dst) ip-\u0430\u0434\u0440\u0435\u0441 <code>tcpdump -n -i ens33 -X host 192.168.3.100 and port 32400</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 (-X) \u0434\u043b\u044f \u0445\u043e\u0441\u0442\u0430 \u0438 \u043f\u043e\u0440\u0442\u0430</p>"},{"location":"Linux/#tshark","title":"tshark","text":"<p><code>apt install tshark</code> <code>apt install termshark</code> terminal UI for tshark (https://github.com/gcla/termshark) <code>tshark -D</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 <code>tshark -i 1</code> <code>disown</code> <code>tshark -i 1 -Y \"syslog\"</code> \u0437\u0430\u0445\u0432\u0430\u0442 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 syslog (udp.port == 514) <code>tshark -i 1 host 192.168.3.104</code> \u0437\u0430\u0445\u0432\u0430\u0442 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e IP-\u0430\u0434\u0440\u0435\u0441\u0430 <code>tshark -i 1 net 192.168.3.0/24</code> \u0437\u0430\u0445\u0432\u0430\u0442 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u043f\u043e\u0434\u0441\u0435\u0442\u0438 <code>tshark -i 1 src host 192.168.3.104</code> \u0437\u0430\u0445\u0432\u0430\u0442 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 <code>tshark -i 1 dst host 192.168.3.104</code> \u0437\u0430\u0445\u0432\u0430\u0442 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 <code>tshark -i 1 dst host 192.168.3.104 and port 8086</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0432\u0445\u043e\u0434\u044f\u0449\u0435\u043c\u0443 \u0445\u043e\u0441\u0442\u0443 \u0438 \u043f\u043e\u0440\u0442\u0443 <code>tshark -i 1 dst host 192.168.3.104 and port 8086 and src host 192.168.3.99</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0435\u043c\u0443 \u0445\u043e\u0441\u0442\u0443 <code>tshark -i 1 -x dst host 192.168.3.104 and port 8086 and src host 192.168.3.101</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u043f\u0430\u043a\u0435\u0442\u044b \u0432 \u0448\u0435\u0441\u0442\u043d\u0430\u0434\u0446\u0430\u0442\u0435\u0440\u0438\u0447\u043d\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435 (-x) <code>tshark -i 1 -O TCP dst host 192.168.3.104 and port 8086 and src host 192.168.3.101</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c TCP-\u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0438 <code>tshark -i 1 -a duration:10 -w ~/192.168.3.0.pcap</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0437\u0430\u0445\u0432\u0430\u0442 <code>tshark -Y 'ip.addr == 192.168.3.106' -r ~/192.168.3.0.pcap</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0437\u0430\u0445\u0432\u0430\u0442\u0430 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0444\u0438\u043b\u044c\u0442\u0440\u0430 <code>tshark -Y \"(ip.addr == 192.168.3.106) or (ip.addr == 192.168.3.107)\" -r ~/192.168.3.0.pcap</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0434\u0432\u0443\u043c \u0430\u0434\u0440\u0435\u0441\u0430\u043c (\u0438\u043b\u0438) <code>tshark -Y \"(ip.addr == 192.168.3.104) and (tcp.port == 8086)\" -r ~/192.168.3.0.pcap</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0434\u0432\u0443\u043c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c (\u0438) <code>tshark -Y \"!(ip.addr == 192.168.3.104)\" -r ~/192.168.3.0.pcap</code> \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c <code>tshark -Y \"not arp and not (udp.port == 53)\" -r ~/192.168.3.0.pcap</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0435\u0441\u044c udp-\u0442\u0440\u0430\u0444\u0438\u043a, \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0432 ping \u0438 dns \u043f\u0430\u043a\u0435\u0442\u044b</p>"},{"location":"Linux/#ping","title":"ping","text":""},{"location":"Linux/#fping","title":"fping","text":"<p><code>fping yandex.ru google.com</code> \u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u0430\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u0434\u0432\u0443\u0445 \u0445\u043e\u0441\u0442\u043e\u0432 <code>fping -p 5 yandex.ru google.com</code> 5 \u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043a \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u0445\u043e\u0441\u0442\u0443 <code>fping -ag 192.168.3.0/24</code> icmp \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u0441\u0435 \u043f\u043e\u0434\u0441\u0435\u0442\u0438 <code>fping &lt; hosts.txt</code> \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0441\u0442\u0438 ping \u0432\u0441\u0435\u0445 \u0445\u043e\u0441\u0442\u043e\u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 \u0444\u0430\u0439\u043b\u0435 \u0441 \u043d\u043e\u0432\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438</p>"},{"location":"Linux/#netping","title":"netping","text":"<p><code>sudo curl -s https://raw.githubusercontent.com/Lifailon/net-tools/rsa/netping.sh -o /usr/bin/netping</code> <code>sudo chmod +x /usr/bin/netping</code> <code>netping 192.168.3.0</code></p>"},{"location":"Linux/#firewall","title":"firewall","text":""},{"location":"Linux/#ufw","title":"ufw","text":"<p><code>systemctl status ufw</code> <code>ufw status</code> <code>ufw enable</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c ufw (Uncomplicated Firewall) <code>ufw disable</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c <code>ufw reload</code> \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c/\u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 <code>ufw reset</code> \u0441\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 (\u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c ufw \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430) <code>ufw default deny incoming</code> \u0432\u0441\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u043f\u0430\u043a\u0435\u0442\u044b \u043e\u0442\u043a\u043b\u043e\u043d\u044f\u0442\u044c (\u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0430 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, \u043a\u0430\u043a\u0438\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0442\u044c\u0441\u044f \u043a \u043f\u0430\u043a\u0435\u0442\u0430\u043c, \u0435\u0441\u043b\u0438 \u043e\u043d\u0438 \u043d\u0435 \u043f\u043e\u0434\u043f\u0430\u0434\u0430\u044e\u0442 \u043f\u043e\u0434 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430) <code>ufw default allow outgoing</code> \u0432\u0441\u0435 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u0442\u044c <code>ufw allow in 22</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0442\u0440\u0430\u0444\u0438\u043a \u043d\u0430 \u043f\u043e\u0440\u0442 22 <code>ufw allow out 22</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0442\u0440\u0430\u0444\u0438\u043a \u043d\u0430 \u043f\u043e\u0440\u0442 22 <code>ufw deny in 80/tcp</code> \u0437\u0430\u043f\u0440\u0435\u0442\u0438\u0442\u044c \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 TCP-\u0442\u0440\u0430\u0444\u0438\u043a \u043d\u0430 80 \u043f\u043e\u0440\u0442 <code>ufw delete deny in 80/tcp</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u043e <code>ufw allow 161,10050,10051/tcp</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0440\u0442\u043e\u0432 <code>ufw allow proto tcp from 0.0.0.0/24 to 192.168.3.100 port 3389</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u0441\u043e \u0432\u0441\u0435\u0445 IP-\u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u043f\u043e TCP-\u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0443 \u043a IP-\u0430\u0434\u0440\u0435\u0441\u0443 \u0438 \u043f\u043e\u0440\u0442\u0443 3389 <code>ufw allow from 192.168.3.0/24 to 192.168.3.110</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u043c \u0441 \u043f\u043e\u0434\u0441\u0435\u0442\u0438 192.168.1.0 \u043a \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0443 192.168.1.2 (\u0434\u043b\u044f Proxmox MGW) <code>ufw allow 25/tcp</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0439 25 \u043f\u043e\u0440\u0442 <code>ufw limit ssh</code> \u043b\u0438\u043c\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043a \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u043c\u0443 \u043f\u043e\u0440\u0442\u0443 \u0441 \u043e\u0434\u043d\u043e\u0433\u043e IP-\u0430\u0434\u0440\u0435\u0441\u0430 (\u0434\u043b\u044f \u0437\u0430\u0449\u0438\u0442\u044b \u043e\u0442 \u043f\u0435\u0440\u0435\u0431\u043e\u0440\u0430), \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0431\u043b\u043e\u043a\u0438\u0440\u0443\u044e\u0442\u0441\u044f, \u0435\u0441\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043f\u044b\u0442\u0430\u0435\u0442\u0441\u044f \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0448\u0435\u0441\u0442\u044c \u0438 \u0431\u043e\u043b\u044c\u0448\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0437\u0430 30 \u0441\u0435\u043a\u0443\u043d\u0434 (\u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0435\u0440\u0435\u0437 iptables) <code>ufw logging on</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 <code>ufw logging medium</code> \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (low/medium/high) <code>cat /var/log/ufw</code> \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043b\u043e\u0433\u043e\u0432. \u0421\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0441: [UFW ALLOW/BLOCK/AUDIT] IN=\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 OUT=\u0438\u0442\u0435\u0440\u0444\u0435\u0439\u0441 SRC=ip_\u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 DST=ip_\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f LEN=\u0440\u0430\u0437\u043c\u0435\u0440_\u043f\u0430\u043a\u0435\u0442\u0430 TOS=0x10 PREC=0x00 TTL=64 ID=728 DF PROTO=\u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b SPT=\u043f\u043e\u0440\u0442_\u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 DPT=\u043f\u043e\u0440\u0442 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f LEN=\u0440\u0430\u0437\u043c\u0435\u0440_\u043f\u0430\u043a\u0435\u0442\u0430</p>"},{"location":"Linux/#show","title":"show","text":"<p><code>ufw show listening</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0432\u0441\u0435 \u043f\u0440\u043e\u0441\u043b\u0443\u0448\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u043f\u043e\u0440\u0442\u044b \u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0434\u043b\u044f \u043d\u0438\u0445 (\u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0433\u043e \u043d\u043e\u043c\u0435\u0440\u0430 \u0432 \u0441\u043f\u0438\u0441\u043a\u0435: [20] allow 161,10050,10051/tcp) <code>ufw show raw</code> \u0432\u0441\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 iptables <code>ufw show added</code> \u043d\u0435\u0434\u0430\u0432\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 <code>ufw show builtins</code> \u043f\u0440\u0430\u0432\u0438\u043b\u0430, \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e <code>ufw show user-rules</code> \u043f\u0440\u0430\u0432\u0438\u043b\u0430, \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c <code>ufw show before-rules</code> \u043f\u0440\u0430\u0432\u0438\u043b\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0442\u0441\u044f \u043f\u0435\u0440\u0435\u0434 \u043f\u0440\u0438\u043d\u044f\u0442\u0438\u0435\u043c \u043f\u0430\u043a\u0435\u0442\u0430 <code>ufw show after-rules</code> \u043f\u0440\u0430\u0432\u0438\u043b\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0442\u0441\u044f \u043f\u043e\u0441\u043b\u0435 \u043f\u0440\u0438\u043d\u044f\u0442\u0438\u044f \u043f\u0430\u043a\u0435\u0442\u0430 <code>ufw show logging-rules</code> \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u043b\u043e\u0433\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0430\u043a\u0435\u0442\u043e\u0432</p>"},{"location":"Linux/#firewalld","title":"firewalld","text":"<p><code>apt install firewalld</code> <code>systemctl status firewalld</code> <code>systemctl start firewalld</code> <code>pkill -f firewalld</code> \u0443\u0431\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441, \u0435\u0441\u043b\u0438 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 failed <code>firewall-cmd --state</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0440\u0430\u0431\u043e\u0442\u044b <code>firewall-cmd --reload</code> \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 (\u043f\u0435\u0440\u0435\u0447\u0438\u0442\u0430\u0442\u044c) <code>firewall-cmd --list-all</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0430\u0432\u0438\u043b (\u0434\u043b\u044f services \u0438 ports) <code>firewall-cmd --list-port</code> \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u043f\u043e\u0440\u0442\u044b <code>firewall-cmd --list-service</code> \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u0441\u043b\u0443\u0436\u0431\u044b <code>firewall-cmd --list-all-zones</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u043e\u043d <code>firewall-cmd --get-active-zones</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 \u0437\u043e\u043d <code>firewall-cmd --list-all --zone=public</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0437\u043e\u043d\u0435 <code>firewall-cmd --permanent --add-port=22/tcp</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c 22 \u043f\u043e\u0440\u0442 <code>firewall-cmd --permanent --add-port=8000-8080/udp</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u043f\u043e\u0440\u0442\u043e\u0432 <code>firewall-cmd --get-services | grep ssh</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0441\u043b\u0443\u0436\u0431 <code>firewall-cmd --permanent --add-service=ssh</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u043f\u043e\u0440\u0442\u044b \u0434\u043b\u044f \u0441\u0435\u0440\u0432\u0438\u0441\u0430 ssh <code>firewall-cmd --permanent --new-service=speedtest</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443 <code>firewall-cmd --permanent --service=speedtest --add-port=80/tcp</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0440\u0442 \u043a \u0441\u043b\u0443\u0436\u0431\u0435 <code>firewall-cmd --info-service=speedtest</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u043b\u0443\u0436\u0431\u0435 <code>firewall-cmd --permanent --add-rich-rule 'rule family=\"ipv4\" source address=\"192.168.3.0/24\" service name=\"speedtest\" accept'</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u0434\u043b\u044f \u043f\u043e\u0434\u0441\u0435\u0442\u0438 <code>firewall-cmd --permanent --add-rich-rule 'rule family=\"ipv4\" source address=\"192.168.3.0/24\" port port=\"22\" protocol=\"tcp\" accept'</code> <code>firewall-cmd --permanent --add-rich-rule=\"rule family='ipv4' source address='192.168.21.0/24' reject\"</code> \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u0434\u043b\u044f \u043f\u043e\u0434\u0441\u0435\u0442\u0438 <code>firewall-cmd --list-rich-rules</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0440\u0430\u0432\u0438\u043b \u0441 \u0443\u0441\u043b\u043e\u0432\u0438\u044f\u043c\u0438 <code>firewall-cmd --permanent --remove-port=22/tcp</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u043e</p>"},{"location":"Linux/#iptables","title":"iptables","text":"<p><code>iptables -L -v</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0432\u0441\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u0446\u0435\u043f\u043e\u0447\u043a\u0438 <code>iptables -L | grep -E \"tcp|udp\"</code> <code>if (( $(iptables -L | wc -l | bc) == 8)); then echo active; else echo inactive; fi</code> <code>iptables -A INPUT -p tcp --dport 22 -j ACCEPT</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u043f\u043e\u0440\u0442 ssh <code>iptables -A INPUT -p tcp -s !192.168.3.99 --dport 22 -j DROP</code> \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u043f\u043e\u0440\u0442 ssh, \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c 192.168.3.99 <code>iptables-save</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438, \u0447\u0442\u043e \u0431\u044b \u043e\u043d\u0438 \u0431\u044b\u043b\u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u044b \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 <code>iptables -F</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u044b</p>"},{"location":"Linux/#nftables","title":"nftables","text":"<p><code>nft -a list ruleset</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u043f\u0440\u0430\u0432\u0438\u043b <code>nft list tables</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u0442\u0430\u0431\u043b\u0438\u0446 <code>nft flush ruleset</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u0430 <code>nft add table inet filter</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443 filter <code>nft add chain inet filter input { type filter hook input priority 0\\; }</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0446\u0435\u043f\u043e\u0447\u043a\u0443 input <code>nft add rule inet filter input ct state related,established counter accept</code> <code>nft add rule inet filter input iifname \"lo\" counter accept</code> <code>nft add rule inet filter input ip protocol icmp counter accept</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c icmp <code>nft add rule inet filter input tcp dport {80, 443} counter accept</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u0440\u0442\u044b <code>nft add rule inet filter input ip saddr { 192.168.100.0/24, 1.1.1.1/32 } tcp dport 22 counter accept</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c 22 \u043f\u043e\u0440\u0442 \u0434\u043b\u044f \u043f\u043e\u0434\u0441\u0435\u0442\u0435\u0439 <code>nft chain inet filter input { policy drop \\; }</code> \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0435 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c <code>echo \"flush ruleset\" &gt; /etc/nftables.conf</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 <code>nft -s list ruleset &gt;&gt; /etc/nftables.conf</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e <code>systemctl enable nftables.service</code> <code>nft delete rule inet filter input handle 5</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u043e \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 <code>nft add rule inet filter input position 5 tcp dport 22 counter accept</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u043e \u0432 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u0441 \u043d\u043e\u043c\u0435\u0440\u043e\u043c \u0432 \u0441\u043f\u0438\u0441\u043a\u0435</p>"},{"location":"Linux/#ssh","title":"ssh","text":"<p><code>w</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0441\u0435\u0441\u0441\u0438\u0438 \u0438 \u0438\u0445 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c (\u0432\u0440\u0435\u043c\u044f/\u0434\u0430\u0442\u0430 \u0432\u0445\u043e\u0434\u0430, IDLE \u0432\u0440\u0435\u043c\u044f \u043f\u0440\u043e\u0441\u0442\u043e\u044f \u0438 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430) <code>who</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0441\u0435\u0441\u0441\u0438\u0438, \u0432\u0440\u0435\u043c\u044f/\u0434\u0430\u0442\u0430 \u0432\u0445\u043e\u0434\u0430 \u0438 ip \u0441 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c <code>last -a</code> \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 \u0432\u0445\u043e\u0434\u043e\u0432 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 <code>lastlog</code> \u0434\u0430\u0442\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0432\u0445\u043e\u0434\u0430 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 <code>last reboot</code> \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 <code>id -G</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a id \u043a\u0440\u0443\u043f\u043f \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c</p> <p><code>apt install xclip xsel</code> \u0431\u0443\u0444\u0435\u0440 \u043e\u0431\u043c\u0435\u043d\u0430 <code>cat /etc/ssh/sshd_config | xclip</code> <code>xsel &gt; sshd_config.bak</code> <code>nano /etc/ssh/sshd_config</code> <code>Port 2121</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0440\u0442 <code>PermitRootLogin yes</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c root <code>PasswordAuthentication no</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0443\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044e \u043f\u043e \u043f\u0430\u0440\u043e\u043b\u044e <code>X11Forwarding yes</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c X11 <code>TCPKeepAlive yes</code> \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f (\u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u043f\u0443\u0441\u0442\u044b\u0445 keep-alive \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0434\u043b\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f) <code>ClientAliveInterval 60</code> \u0437\u0430\u0434\u0430\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445, \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 sshd \u0437\u0430\u043f\u0440\u043e\u0441\u0438\u0442 \u043e\u0442\u0432\u0435\u0442 \u043e\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 <code>ClientAliveCountMax 3</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0431\u0435\u0437 \u043e\u0442\u0432\u0435\u0442\u0430 \u0434\u043e \u0437\u0430\u0432\u0435\u0448\u0440\u0435\u043d\u0438\u044f \u0441\u0435\u0430\u043d\u0441\u0430 (ClientAliveInterval * ClientAliveCountMax = 180 \u0441\u0435\u043a\u0443\u043d\u0434) <code>systemctl restart sshd</code> <code>systemctl status sshd</code></p>"},{"location":"Linux/#keygen","title":"keygen","text":"<p><code>ssh-keygen -t rsa -b 4096</code> \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0430\u0440\u0443 \u043a\u043b\u044e\u0447\u0435\u0439 <code>id_rsa</code> \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0439/\u0437\u0430\u043a\u0440\u044b\u0442\u044b\u0439 \u043a\u043b\u044e\u0447 \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u043d\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0435, \u043e\u0442 \u043a\u043e\u0433\u043e \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 (\u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0431\u0435\u0437 \u043f\u0430\u0440\u043e\u043b\u044f \u0438\u043c\u044f \u0444\u0430\u0439\u043b\u0430 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e) <code>cat ~/.ssh/id_rsa.pub | xclip</code> \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439/\u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0439 \u043a\u043b\u044e\u0447, \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u0443\u0434\u0430 \u0431\u0443\u0434\u0435\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c\u0441\u044f3 <code>xsel &gt; ~/.ssh/authorized_keys</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430 (id_rsa.pub) \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u0443\u0434\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c\u0441\u044f</p>"},{"location":"Linux/#x11","title":"x11","text":"<p><code>apt-get install virt-manager ssh-askpass</code> <code>virt-manager</code> <code>export DISPLAY=username-VirtualBox:10.0 &amp;&amp; firefox</code></p>"},{"location":"Linux/#scp","title":"scp","text":"<p><code>ssh-copy-id root@192.168.3.105 -p 2121</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439 \u043a\u043b\u044e\u0447 \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 (\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u043e\u0439), \u0443\u0442\u0438\u043b\u0438\u0442\u0430 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043a\u0430\u0442\u044c \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0444\u0430\u0439\u043b \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430 \u0438 \u0441\u043a\u043e\u043f\u0438\u0440\u0443\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0444\u0430\u0439\u043b\u0430 \u043a\u043b\u044e\u0447\u0430 ~/.ssh/id_rsa.pub \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c\u0443 \u043f\u0440\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u0432 \u0444\u0430\u0439\u043b authorized_keys <code>scp -P 2121 /home/lifailon/files/* lifailon@192.168.3.105:/home/lifailon/downaload/</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 files \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e downaload <code>scp -P 2121 -r kup@192.168.3.105:/home/lifailon/downaload /home/lifailon/files/</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c (-r) \u0434\u0430\u043d\u043d\u044b\u0435 \u0441 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439</p>"},{"location":"Linux/#sshpass","title":"sshpass","text":"<pre><code>hosts=(192.168.3.101 192.168.3.102 192.168.3.103 192.168.3.104)\nusername=\"lifailon\"\nport=2121\nread -s -p \"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f $username: \" password\necho\nfor host in ${hosts[@]}; do\n    sshpass -p $password ssh -p $port $username@$host \"echo $(uname -n) $(free -m | grep Mem: | awk '{print $3\"/\"$2}')\"\ndone\n</code></pre>"},{"location":"Linux/#sudoers","title":"sudoers","text":"<p><code>cat /etc/sudoers</code> \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0440\u0430\u0432 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0443\u0442\u0438\u043b\u0438\u0442\u044b sudo <code>visudo</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c sudoers \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0441\u0430 <code>Defaults env_reset, timestamp_timeout=10</code> \u0437\u0430\u0434\u0430\u0442\u044c \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u043b\u044f sudo \u043d\u0430 10 \u043c\u0438\u043d\u0443\u0442 <code>echo \"lifailon ALL=(ALL) NOPASSWD:ALL\" &gt; /etc/sudoers.d/lifailon</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f sudo \u0431\u0435\u0437 \u043f\u0430\u0440\u043e\u043b\u044f <code>chmod 644 /etc/sudoers.d/lifailon</code> <code>lifailon ALL=NOPASSWD: /usr/bin/service memcahched restart, /usr/bin/apt-get update, /usr/bin/apt-get upgrade</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0430, \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0443 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b <code>%powerusers ALL=NOPASSWD: /usr/bin/service memcahched restart</code> \u0434\u043e\u0441\u0442\u0443\u043f \u043d\u0430 \u0433\u0440\u0443\u043f\u043f\u0443 <code>visudo --check</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0441\u0430 \u0438 \u0432\u0441\u0435\u0445 \u043f\u0440\u0430\u0432 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 (0440)</p>"},{"location":"Linux/#strace","title":"strace","text":"<p><code>strace -c top -n 1 &gt; /dev/null</code> \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u0432\u044b\u0437\u043e\u0432\u043e\u0432 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b (time - \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u043e\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043e\u0431\u0449\u0435\u0433\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f, call - \u043a\u043e\u043b-\u0432\u043e \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0439 \u0438 \u043e\u0448\u0438\u0431\u043a\u0438) <code>pid=$(pidof dd)</code> \u0443\u0437\u043d\u0430\u0442\u044c pid \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u043f\u043e \u0438\u043c\u0435\u043d\u0438 <code>strace -p $pid</code> \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435 \u0432\u044b\u0437\u043e\u0432\u044b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 (\u0447\u0438\u0442\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u043e\u0434\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u0430 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0432\u044b\u0437\u043e\u0432\u0430 read \u0438 \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0432 \u0434\u0440\u0443\u0433\u043e\u0435 \u0447\u0435\u0440\u0435\u0437 write) <code>strace -f -p $(pgrep -o sshd) -o ~/passwd.txt -v -e trace=write -s 64</code> \u0441\u043b\u0435\u0434\u0438\u043c \u0437\u0430 \u0432\u0441\u0435\u043c\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430\u043c\u0438 sshd (-f), \u0438\u0449\u0435\u043c \u0432\u0441\u0435 PID sshd \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 (-p), \u0442\u0440\u0438\u0433\u0433\u0435\u0440 \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0437\u0430\u043f\u0438\u0441\u044c \u0434\u0430\u043d\u043d\u044b\u0445 (-e) \u0438 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0435\u043c \u0432\u044b\u0432\u043e\u0434 64 \u0431\u0430\u0439\u0442\u0430\u043c\u0438 <code>cat ~/passwd.txt | grep \"[1-32][1-32]) = [1-32][1-32]\"</code></p>"},{"location":"Linux/#apt","title":"apt","text":"<p><code>apt-mark showauto</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 <code>apt-mark showmanual</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0432\u0440\u0443\u0447\u043d\u0443\u044e <code>echo $(($(apt-mark showauto | wc -l) + $(apt-mark showmanual | wc -l)))</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u0441\u0435\u0445 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 <code>apt list --installed</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 apt (Advanced Package Tool) <code>apt update</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0438\u0437 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 \u0444\u0430\u0439\u043b\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 /etc/apt/sources.list <code>cat /etc/apt/sources.list | grep -Ev \"^#\"</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 <code>apt list --upgradable</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a, \u0434\u043b\u044f \u043a\u0430\u043a\u0438\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f <code>apt list --upgradable -a</code> upgradable from, installed \u0438 \u0432\u0441\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0432\u0435\u0440\u0441\u0438\u0438 <code>apt install --only-upgrade powershell</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043e\u0434\u0438\u043d \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u043f\u0430\u043a\u0435\u0442 <code>apt --fix-broken install</code> \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0438 \u043e\u0448\u0438\u0431\u043a\u0438 \u0441 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044f\u043c\u0438 <code>apt full-upgrade</code> \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0432\u0441\u0435 \u043f\u0430\u043a\u0435\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u0436\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435, \u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u043e\u0432\u044b\u0435 \u043f\u0430\u043a\u0435\u0442\u044b \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u0438 \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u043f\u0430\u043a\u0435\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u043b\u0438\u0441\u044c \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0438 \u0443\u0436\u0435 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f <code>apt install net-tools</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 <code>apt download net-tools</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u043f\u0430\u043a\u0435\u0442 \u0431\u0435\u0437 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 <code>apt install net-tools --reinstall</code> \u043f\u0435\u0440\u0435\u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 <code>apt remove net-tools</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 (\u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u044b\u043b\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u044b \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u044b \u043d\u0435 \u0431\u0443\u0434\u0443\u0442) <code>apt purge net-tools</code> \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442, \u0432\u043c\u0435\u0441\u0442\u0435 \u0441\u043e \u0432\u0441\u0435\u043c\u0438 \u0435\u0433\u043e \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u043c\u0438 \u0444\u0430\u0439\u043b\u0430\u043c\u0438 <code>apt policy net-tools</code> \u043a\u0430\u043a\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u0430 \u0438 \u043a\u0430\u043a\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b <code>apt install net-tools=number ver.</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u0443\u044e \u0432\u0435\u0440\u0441\u0438\u044e <code>apt autoremove</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043d\u0435\u043d\u0443\u0436\u043d\u044b\u0435 \u043f\u0430\u043a\u0435\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 <code>apt autoclean</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043a\u044d\u0448 \u043f\u0430\u043a\u0435\u0442\u043e\u0432</p>"},{"location":"Linux/#snap","title":"snap","text":"<p>\u0421\u043e\u0434\u0435\u0440\u0436\u0430\u0442 \u0441\u0430\u043c\u0443 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0443 (deb-\u043f\u0430\u043a\u0435\u0442), \u0430 \u0442\u0430\u043a\u0436\u0435 \u0432\u0441\u0435 \u0435\u0451 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u0438 \u0431\u0438\u0431\u043b\u0438\u0442\u043e\u0442\u0435\u043a\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0445 \u0432\u0435\u0440\u0441\u0438\u0439 \u0434\u043b\u044f \u0434\u0430\u043d\u043d\u043e\u0439 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b. <code>ls /snap</code> \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u043f\u0430\u043a\u0435\u0442\u043e\u0432 <code>ls /var/lib/snapd/snaps</code> \u0440\u0430\u0441\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 .snap <code>snap install snap-store</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439 <code>snap find nmap</code> \u043f\u043e\u0438\u0441\u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0432 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0435 snap <code>snap info nmap</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u0430\u043a\u0435\u0442\u0435 (\u0435\u0433\u043e \u043d\u0430\u043b\u0438\u0447\u0438\u0438, \u0432\u0435\u0440\u0441\u0438\u044f, \u0434\u0430\u0442\u0430 \u0440\u0435\u043b\u0438\u0437\u0430 \u0438 \u0440\u0430\u0437\u043c\u0435\u0440) <code>snap list</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 <code>snap list | sed 1d | wc -l</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 <code>snap list --all nmap</code> \u0432\u0441\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0432\u0435\u0440\u0441\u0438\u0438 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u0430\u043a\u0435\u0442\u0430 <code>snap refresh nmap</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 \u0434\u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 <code>snap revert nmap</code> \u043e\u0442\u043a\u0430\u0442\u0438\u0442\u044c \u0432\u0435\u0440\u0441\u0438\u044e \u0434\u043e \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0439 <code>snap install nmap --stable</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u0443\u044e \u0432\u0435\u0440\u0441\u0438\u044e \u043f\u0430\u043a\u0435\u0442\u0430 <code>snap connections nmap</code> \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043a \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430\u043c \u0441\u0438\u0441\u0442\u0435\u043c\u044b <code>snap remove nmap</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442</p>"},{"location":"Linux/#dpkg","title":"dpkg","text":"<p><code>dpkg -i spark.deb</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 <code>dpkg -l</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 deb-\u043f\u0430\u043a\u0435\u0442\u043e\u0432 <code>dpkg -l | wc -l</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 <code>dpkg -l spark</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u043b\u0438 \u043f\u0430\u043a\u0435\u0442 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0438 \u0435\u0433\u043e \u0432\u0435\u0440\u0441\u0438\u044e <code>dpkg -s spark</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u043f\u0430\u043a\u0435\u0442\u0430 <code>dpkg -r spark</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c (--remove) .deb \u043f\u0430\u043a\u0435\u0442 <code>dpkg -P spark</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 \u0444\u0430\u0438\u043b\u0430\u043c\u0438 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 <code>dpkg -L spark</code> \u043a\u0443\u0434\u0430 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u043f\u0430\u043a\u0435\u0442 (opt/Spark)</p>"},{"location":"Linux/#ntp","title":"ntp","text":""},{"location":"Linux/#time","title":"time","text":"<p><code>timedatectl</code> \u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f <code>timedatectl set-timezone 'Europe/Moscow'</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u0437\u043e\u043d\u0443 \u043d\u0430 MSK, +0300 (\u0438\u0437\u043c\u0435\u043d\u0438\u0442\u0441\u044f Local time) <code>timedatectl list-timezones</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0447\u0430\u0441\u043e\u0432\u044b\u0445 \u043f\u043e\u044f\u0441\u043e\u0432 <code>timedatectl set-ntp no</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c NTP service <code>timedatectl set-time \"13:00:00\"</code> \u043f\u043e\u0441\u043b\u0435 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f NTP \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0432 \u0440\u0443\u0447\u043d\u0443\u044e <code>timedatectl set-ntp yes</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c NTP service (NTP service: active)</p>"},{"location":"Linux/#language","title":"language","text":"<p><code>locale</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u043b\u043e\u043a\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 <code>update-locale LANG=en_US.UTF-8</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e <code>apt-get install language-pack-en language-pack-en-base</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 \u043b\u043e\u043a\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0439 <code>nano /etc/default/locale</code> <code>LANG=en_US.UTF-8</code> <code>dpkg-reconfigure locales</code></p>"},{"location":"Linux/#timesyncd","title":"timesyncd","text":"<p><code>systemctl status systemd-timesyncd</code> <code>systemctl status systemd-timesyncd | grep \"Status\": | sed -E \"s/^.+server //; \"s/.\\\"//\"\"</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0430\u0434\u0440\u0435\u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 <code>apt install systemd-timesyncd</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443, \u0435\u0441\u043b\u0438 unit \u043d\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f <code>apt-get remove ntp ntpstat --purge &amp;&amp; apt autoremove</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c ntpd (\u0435\u0441\u043b\u0438 \u0431\u044b\u043b \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d) <code>nano /etc/systemd/timesyncd.conf</code> <code>NTP=192.168.3.233</code> DC (Domain Controller) <code>NTP=0.debian.pool.ntp.org 1.debian.pool.ntp.org 2.debian.pool.ntp.org 3.debian.pool.ntp.org</code> <code>FallbackNTP=ntp.ubuntu.com</code> \u0440\u0435\u0437\u0435\u0440\u0432 <code>systemctl restart systemd-timesyncd</code> <code>timedatectl set-ntp true</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 systemd-timesyncd \u0434\u043b\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 (\u0432\u043c\u0435\u0441\u0442\u043e ntpd) <code>timedatectl status</code></p>"},{"location":"Linux/#ntpd","title":"ntpd","text":"<p><code>apt install ntp</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c NTP-\u0441\u0435\u0440\u0432\u0435\u0440/\u043a\u043b\u0438\u0435\u043d\u0442, \u043f\u0440\u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0435 \u0431\u0443\u0434\u0435\u0442 \u0443\u0434\u0430\u043b\u0435\u043d \u043f\u0430\u043a\u0435\u0442 systemd-timesyncd <code>systemctl status ntp</code> <code>sntp --version</code> <code>ufw allow 123/udp &amp;&amp; ufw reload</code> <code>timedatectl set-ntp false</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044e \u0447\u0435\u0440\u0435\u0437 systemd-timesyncd \u043d\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0435 <code>nano /etc/ntp.conf</code> <code>pool 0.ubuntu.pool.ntp.org</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0443\u043b \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 <code>server 0.ru.pool.ntp.org</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043d\u0430 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 (\u0435\u0441\u043b\u0438 \u044d\u0442\u043e pool, \u0432\u043e\u0437\u044c\u043c\u0435\u0442 \u043e\u0434\u0438\u043d) <code>restrict default kod notrap nomodify nopeer noquery limited</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438/\u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e NTP \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>systemctl restart ntp</code> <code>systemctl status ntp</code> <code>timedatectl status</code> <code>ntpq -p</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 (+ \u0441\u0435\u0440\u0432\u0435\u0440 \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u043b\u044f \u0441\u0432\u0435\u0440\u043a\u0438 \u0447\u0430\u0441\u043e\u0432, * \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0441\u0435\u0439\u0447\u0430\u0441, - \u043d\u0435 \u0440\u0435\u043a\u043e\u043c\u0430\u043d\u0434\u043e\u0432\u0430\u043d, st - \u0443\u0440\u043e\u0432\u0435\u043d\u044c stratum, when \u2014 \u043a\u043e\u0433\u0434\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0440\u0430\u0437 \u0441\u0432\u0435\u0440\u044f\u043b\u043e\u0441\u044c \u0432\u0440\u0435\u043c\u044f, delay - \u0432\u0440\u0435\u043c\u044f \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0438, offset - \u0440\u0430\u0437\u043d\u0438\u0446\u0430 \u043c\u0435\u0436\u0434\u0443 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0435\u043c \u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0435\u043c \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 - \u043e\u0442\u0441\u0442\u0430\u044e\u0442 \u043e\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0438\u043b\u0438 \u0441\u043f\u0435\u0448\u0430\u0442)</p>"},{"location":"Linux/#top","title":"top","text":"<p><code>top -c</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u043f\u043e\u043b\u043d\u044b\u0439 \u043f\u0443\u0442\u044c \u043a \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u044b\u043c \u0444\u0430\u0439\u043b\u0430\u043c \u0441 \u043a\u043b\u044e\u0447\u0430\u043c\u0438, \u0432\u043c\u0435\u0441\u0442\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f <code>top -H</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u043f\u043e\u0442\u043e\u043a\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 <code>top -i</code> \u043d\u0435 \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430 <code>top -o %CPU</code> \u043e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e CPU <code>top -o %MEM</code> \u043e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e Memory</p>"},{"location":"Linux/#htop","title":"htop","text":"<p><code>space</code> \u0432\u044b\u0434\u0435\u043b\u0438\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 (\u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c Shift+U) <code>u</code> \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>l</code> \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0444\u0430\u0439\u043b\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 <code>s</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u0432\u044b\u0437\u043e\u0432\u043e\u0432 (strace PID attached) F8 - AutoScroll, F4 - Filter, F9 - Stop/Start Tracing <code>F4</code> \u0444\u0438\u043b\u044c\u0442\u0440 \u043f\u043e \u043a\u043b\u044e\u0447\u0435\u0432\u043e\u043c\u0443 \u0441\u043b\u043e\u0432\u0443 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, cron) <code>F5</code> \u0434\u0440\u0435\u0432\u043e\u0432\u0438\u0434\u043d\u0430\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 <code>F6</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 (PERCENT_CPU/PERCENT_MEM/USER/PRIORITY/TIME) <code>F7</code> \u043f\u043e\u0432\u044b\u0441\u0438\u0442\u044c \u043f\u0440\u0438\u043e\u0440\u0442\u0438\u0442\u0435 (\u0434\u043e -20), \u0447\u0435\u043c \u043c\u0435\u043d\u044c\u0448\u0435 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442, \u0442\u0435\u043c \u0431\u043e\u043b\u044c\u0448\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043d\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043e\u0442\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0443 <code>F8</code> \u043f\u043e\u043d\u0438\u0437\u0438\u0442\u044c \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 (\u0434\u043e 19) <code>F9/K</code> \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c (\u0441\u0438\u0433\u043d\u0430\u043b\u044b), \u0434\u043b\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430: 15, 2, 3, 9 \u0438\u043b\u0438 19 <code>S (STATE)</code> \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 <code>R</code> [running or runnable] \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0435 \u0438\u043b\u0438 \u043d\u0430\u0445\u043e\u0434\u044f\u0442\u0441\u044f \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u043d\u0430 \u0437\u0430\u043f\u0443\u0441\u043a <code>S</code> [interruptible sleep] \u043f\u0440\u0435\u0440\u044b\u0432\u0430\u0435\u043c\u044b\u0439 \u0441\u043e\u043d (\u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043e\u043c \u0438 \u0436\u0434\u0435\u0442 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0438\u043b\u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0434\u043b\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430) <code>D</code> [uninterruptible sleep] \u043d\u0435\u043f\u0440\u0435\u0440\u044b\u0432\u0430\u0435\u043c\u044b\u0439 \u0441\u043e\u043d (\u043a\u0440\u0430\u0442\u043a\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0438\u0433\u043d\u0430\u043b\u043e\u043c, \u0442.\u043a. \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u043d\u0430 \u043d\u0435\u0433\u043e \u043e\u0442\u0432\u0435\u0442\u0438\u0442\u044c) <code>Z</code> [zombie] \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u044b\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441, \u043e\u0436\u0438\u0434\u0430\u044e\u0449\u0438\u0439 \u043f\u043e\u043a\u0430 \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u0440\u0438\u043c\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 <code>T</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0441\u0438\u0433\u043d\u0430\u043b\u043e\u043c SIGSTOP (-19/CTRL+Z) <code>X</code> \u043c\u0435\u0440\u0442\u0432\u044b\u0439 (\u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c\u0441\u044f)</p>"},{"location":"Linux/#bpytop","title":"bpytop","text":"<p><code>sudo apt install bpytop</code> <code>pip3 list | grep psutil</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 <code>pip3 install psutil --break-system-packages</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 \u0432 \u043e\u0431\u0445\u043e\u0434 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0439 <code>python3 -m venv myenv</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435 <code>source myenv/bin/activate</code> \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435 <code>pip install psutil</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0441\u0438\u0441\u0442\u0435\u043c\u0435 <code>bpytop</code> <code>deactivate</code></p>"},{"location":"Linux/#atop","title":"atop","text":"<p><code>apt install atop</code> <code>nano /etc/default/atop</code> <code>LOGINTERVAL=10</code> <code>systemctl restart atop</code> <code>atop -g</code> \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043e\u0431\u0449\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e) <code>atop -m</code> \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430\u0445, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 \u043f\u0430\u043c\u044f\u0442\u044c\u044e <code>atop -d</code> \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430\u0445, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 \u0434\u0438\u0441\u043a\u0430\u043c\u0438 <code>atop -n</code> \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430\u0445, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 \u0441\u0435\u0442\u044c\u044e <code>atop -v</code> \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430\u0445 (PPID \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044f, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c/\u0433\u0440\u0443\u043f\u043f\u0430, \u0434\u0430\u0442\u0430/\u0432\u0440\u0435\u043c\u044f) <code>atop -c</code> \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 <code>atop -A</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435 \u043d\u0430\u0438\u0431\u043e\u043b\u044c\u0448\u0435\u0439 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 (\u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0440\u0435\u0436\u0438\u043c) <code>atop -C</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435 \u043f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e) <code>atop -M</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435 \u043f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u044f \u043f\u0430\u043c\u044f\u0442\u0438 <code>atop -D</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435 \u0434\u0438\u0441\u043a\u043e\u0432\u043e\u0439 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 <code>atop -N</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 <code>atop -E</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 GPU</p>"},{"location":"Linux/#iftop","title":"iftop","text":"<p><code>apt install iftop</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 <code>iftop -ti ens33</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0431\u0435\u0437 ncurses <code>iftop -ts 1 -i ens33</code> \u043f\u0435\u0447\u0430\u0442\u044c \u043e\u0434\u043d\u043e\u0433\u043e \u0435\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u0433\u043e \u0432\u044b\u0432\u043e\u0434\u0430 (-s) \u0447\u0435\u0440\u0435\u0437 1 \u0441\u0435\u043a\u0443\u043d\u0434, \u0437\u0430\u0442\u0435\u043c \u0432\u044b\u0445\u043e\u0434 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b <code>iftop -tL 0 -s 1 -i ens33</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0442\u0440\u043e\u043a (-L) \u0434\u043b\u044f \u043f\u0435\u0447\u0430\u0442\u0438 <code>iftop -ni ens33</code> \u043d\u0435 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u044b\u0432\u0430\u0442\u044c \u0438\u043c\u0435\u043d\u0430 \u0445\u043e\u0441\u0442\u043e\u0432 <code>iftop -Ni ens33</code> \u043d\u0435 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u044b\u0432\u0430\u0442\u044c \u043d\u043e\u043c\u0435\u0440\u0430 \u043f\u043e\u0440\u0442\u043e\u0432 \u0432 \u0441\u0435\u0440\u0432\u0438\u0441\u044b <code>iftop -pi ens33</code> \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 promiscuous (\u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0442\u0440\u0430\u0444\u0438\u043a \u043c\u0435\u0436\u0434\u0443 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 \u0445\u043e\u0441\u0442\u0430\u043c\u0438 \u0432 \u043e\u0434\u043d\u043e\u043c \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0435 \u0441\u0435\u0442\u0438) <code>iftop -bi ens33</code> \u043d\u0435 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c \u0433\u0438\u0441\u0442\u043e\u0433\u0440\u0430\u043c\u043c\u0443 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 <code>iftop -Bi ens33</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u043d\u0443\u044e \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c \u0432 \u0431\u0430\u0439\u0442\u0430\u0445 <code>iftop -o 10si ens33</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u043e \u0432\u0442\u043e\u0440\u043e\u043c\u0443 \u0441\u0442\u043e\u043b\u0431\u0446\u0443 (\u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u0437\u0430 10 \u0441\u0435\u043a\u0443\u043d\u0434, \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e)</p>"},{"location":"Linux/#iotop","title":"iotop","text":"<p><code>apt install iotop</code> <code>iotop -o</code> \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0438\u043b\u0438 \u043f\u043e\u0442\u043e\u043a\u0438, \u0444\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0449\u0438\u0435 \u0432\u0432\u043e\u0434-\u0432\u044b\u0432\u043e\u0434 <code>iotop -ou mysql</code> \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u043e\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>iotop -P</code> \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b, \u0431\u0435\u0437 \u043f\u043e\u0442\u043e\u043a\u043e\u0432 <code>iotop -p PID</code></p>"},{"location":"Linux/#ps","title":"ps","text":"<p><code>apt-get install -y procps</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 procps <code>pstree -a</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 (-a) \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b (\u0434\u0435\u043c\u043e\u043d\u044b) \u0438 \u0438\u0445 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0435 \u0432 \u0432\u0438\u0434\u0435 \u0434\u0435\u0440\u0435\u0432\u0430 <code>ps -FA</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434 (-F, PPID - \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441) \u0432\u0441\u0435\u0445 (-A) \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 <code>ps -LFC mysqld</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u043e\u0442\u043e\u043a\u0438 (-L) \u0432 \u043a\u043e\u043b\u043e\u043d\u043a\u0430\u0445 LWP \u0438 NLWP \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u043f\u043e \u0438\u043c\u0435\u043d\u0438 (-C) <code>ps -Fl</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b (\u0444\u043e\u043d\u043e\u0432\u044b\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u044f &amp;) <code>ps f -F</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>ps f -u root</code> \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>ps -o pid -u lifailon</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0442\u043e\u043b\u044c\u043a\u043e pid \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c <code>ps -p 3618275</code> \u043d\u0430\u0439\u0442\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u043e \u0435\u0433\u043e PID (-p/-s) <code>ps -aux --sort -rss</code> \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0441\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b, \u043a\u0440\u043e\u043c\u0435 \u0444\u043e\u043d\u043e\u0432\u044b\u0445 (-a), \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u0441 \u0438\u043c\u0435\u043d\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (-u), \u0432\u0441\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0432\u043d\u0435 \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b\u0430 (-x) \u0438 \u043e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e RSS, \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f %CPU \u0438 %MEM <code>ps -lax</code> \u043d\u0435 \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u044b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0441 \u0438\u043c\u0435\u043d\u0430\u043c\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043a \u0432\u044b\u0432\u043e\u0434\u0443 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f WCHAN - \u0440\u0435\u0441\u0443\u0440\u0441, \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 <code>ps -FA --sort time</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 <code>ps -Ao comm,user,rss,vsz,command</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043f\u043e \u043f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u044e \u043f\u0430\u043c\u044f\u0442\u0438, \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u043a\u043e\u043c\u0430\u043d\u0434\u044b/\u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0438 \u043f\u043e\u043b\u043d\u043e\u043c\u0443 \u0432\u044b\u0437\u043e\u0432\u0443 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0441 \u043a\u043b\u044e\u0447\u0430\u043c\u0438 <code>PRI</code> \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 <code>NI</code> \u0443\u0441\u0442\u0443\u043f\u0447\u0438\u0432\u043e\u0441\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 (nice value \u043e\u0442 19 \u0434\u043e -20) <code>(($PRI+$NI))=((39+-20))=19</code> <code>TTY</code> \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b, \u0438\u0437 \u043f\u043e\u0434 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u043f\u0440\u043e\u0446\u0435\u0441\u0441 <code>TIME</code> \u043e\u0431\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430, \u0437\u0430\u0442\u0440\u0430\u0447\u0435\u043d\u043d\u043e\u0435 \u043d\u0430 \u0440\u0430\u0431\u043e\u0442\u0443 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 (bsdtime/cputime/time) \u0438\u043b\u0438 \u043d\u0430\u043a\u043e\u043f\u043b\u0435\u043d\u043d\u043e\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f (\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0435 + \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u0435) <code>STIME</code> \u0432\u0440\u0435\u043c\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043a\u043e\u043c\u0430\u043d\u0434\u044b (bsdstart), \u0435\u0441\u043b\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0431\u044b\u043b \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u043c\u0435\u043d\u0435\u0435 24 \u0447\u0430\u0441\u043e\u0432 \u043d\u0430\u0437\u0430\u0434, \u0442\u043e \u0444\u043e\u0440\u043c\u0430\u0442 \u0432\u044b\u0432\u043e\u0434\u0430 \u0431\u0443\u0434\u0435\u0442 HH:MM, \u0435\u0441\u043b\u0438 \u0431\u043e\u043b\u044c\u0448\u0435, \u0442\u043e Mmm:SS (Sep 18) <code>C</code> \u0446\u0435\u043b\u043e\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u0430 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430 (%CPU) \u0437\u0430 \u0432\u0440\u0435\u043c\u044f \u0436\u0438\u0437\u043d\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 <code>%CPU</code> \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0446\u0435\u043d\u0442\u0440\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0443 \u0438\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043d\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0435 \u043d\u0430 \u0432\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 (pcpu) <code>%MEM</code> \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u043e\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c \u0438\u043b\u0438 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0440\u0435\u0437\u0438\u0434\u0435\u043d\u0442\u043d\u043e\u0433\u043e \u043d\u0430\u0431\u043e\u0440\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u043a \u043e\u0431\u044a\u0435\u043c\u0443 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 \u043d\u0430 \u043c\u0430\u0448\u0438\u043d\u0435 (pmem) <code>SZ</code> \u0440\u0430\u0437\u043c\u0435\u0440 \u0432 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430\u0445 \u043e\u0431\u0440\u0430\u0437\u0430 \u044f\u0434\u0440\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430.  \u0421\u044e\u0434\u0430 \u0432\u0445\u043e\u0434\u044f\u0442 \u0442\u0435\u043a\u0441\u0442, \u0434\u0430\u043d\u043d\u044b\u0435 \u0438 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e \u0441\u0442\u0435\u043a\u0430 <code>RSS</code> \u043f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u043e\u0435 \u043f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u0435 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 (Resident Set Size non-swapped), \u0440\u0435\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0432 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0437\u0430\u043d\u044f\u043b (\u0442\u043e \u0435\u0441\u0442\u044c \u0447\u0442\u043e-\u0442\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u043b \u0432 \u043f\u0430\u043c\u044f\u0442\u044c) <code>VSZ</code> \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0430\u044f \u043f\u0430\u043c\u044f\u0442\u044c (Virtual Memory Size) \u0432 \u043a\u0438\u043b\u043e\u0431\u0430\u0439\u0442\u0430\u0445 (1024-\u0431\u0430\u0439\u0442\u043d\u044b\u0445 \u0435\u0434\u0438\u043d\u0438\u0446\u0430\u0445), \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0432\u044b\u0434\u0435\u043b\u0438\u043b\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0443, \u043d\u043e \u044d\u0442\u043e \u043d\u0435 \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442, \u0447\u0442\u043e \u043e\u043d \u0443\u0441\u043f\u0435\u043b \u0432 \u044d\u0442\u0443 \u043f\u0430\u043c\u044f\u0442\u044c \u0447\u0442\u043e-\u0442\u043e \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c <code>LWP</code> \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0434\u043e\u0447\u0435\u0440\u043d\u0435\u0433\u043e \u043f\u043e\u0442\u043e\u043a\u0430 (Light-Weight Process), \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0432\u0435\u0434\u0435\u043d \u0442\u0435\u043a\u0443\u0449\u0438\u0439 ID \u0435\u0441\u043b\u0438 \u043e\u0434\u0438\u043d \u0438\u043b\u0438 \u043f\u0435\u0440\u0432\u044b\u0439 \u043f\u043e\u0442\u043e\u043a <code>NLWP</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e (Number) \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 \u043f\u043e\u0442\u043e\u043a\u043e\u0432 (ps -LFC mysqld | sed 1d | wc -l) <code>PSR</code> \u044f\u0434\u0440\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441 <code>STAT</code> R - \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f, D - \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u0437\u0430\u043f\u0438\u0441\u0438 \u043d\u0430 \u0434\u0438\u0441\u043a, S - \u043d\u0435\u0430\u043a\u0442\u0438\u0432\u0435\u043d (&lt;20 \u0441), T - \u043f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d, Z - \u0437\u043e\u043c\u0431\u0438, \u0441 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c\u0438 \u0444\u043b\u0430\u0433\u0430\u043c\u0438 (W - \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0432\u044b\u0433\u0440\u0443\u0436\u0435\u043d \u043d\u0430 \u0434\u0438\u0441\u043a, &lt; - \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0438\u043c\u0435\u0435\u0442 \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u044b\u0439 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442, N - \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0438\u043c\u0435\u0435\u0442 \u043f\u043e\u043d\u0438\u0436\u0435\u043d\u043d\u044b\u0439 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442, L - \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u0432 \u044f\u0434\u0440\u0435, s - \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043b\u0438\u0434\u0435\u0440\u043e\u043c \u0441\u0435\u0430\u043d\u0441\u0430) <code>maj_flt</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043a\u0440\u0443\u043f\u043d\u044b\u0445 \u0441\u0442\u0440\u0430\u043d\u0438\u0447\u043d\u044b\u0445 \u043e\u0448\u0438\u0431\u043e\u043a, \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u0435\u0434\u0448\u0438\u0445 \u0441 \u0434\u0430\u043d\u043d\u044b\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c <code>min_flt</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0435\u043b\u043a\u0438\u0445 \u043e\u0448\u0438\u0431\u043e\u043a \u0441\u0442\u0440\u0430\u043d\u0438\u0446 <code>ps -Ao comm,user,cputime,pcpu,pmem,sz,rss,vsz,nlwp,psr,pri,ni --sort cputime</code></p>"},{"location":"Linux/#kill","title":"kill","text":"<p><code>kill -INT (-2) PID</code> \u043f\u0440\u0435\u0440\u044b\u0432\u0430\u043d\u0438\u044f \u0441 \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b\u0430, bash \u043f\u043e\u0448\u043b\u0451\u0442 \u0441\u0438\u0433\u043d\u0430\u043b SIGINT \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0443 (\u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e CTRL+C) <code>kill -KILL (-9) PID</code> \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441 <code>kill -STOP (-19) PID</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441, bash \u043f\u043e\u0448\u043b\u0451\u0442 \u0441\u0438\u0433\u043d\u0430\u043b SIGSTOP \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0443 (\u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e CTRL+Z) <code>kill -CONT (-18) PID</code> \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441</p>"},{"location":"Linux/#jobs","title":"jobs","text":"<p><code>(ping google.com) &amp;</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 \u0444\u043e\u043d\u0435 (\u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442\u0441\u044f [job] - \u043d\u043e\u043c\u0435\u0440 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 PID \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430) <code>jobs</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u043e\u043d\u043e\u0432\u044b\u0445 \u0437\u0430\u0434\u0430\u0447 (+ \u0437\u0430\u0434\u0430\u0447\u0430 \u0430\u043a\u0442\u0438\u0432\u043d\u0430) <code>jobs -l | wc -l</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439 <code>fg 1</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 <code>disown</code> \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0432\u0441\u0435 \u0444\u043e\u043d\u043e\u0432\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 (\u0443\u0434\u0430\u043b\u0438\u0442\u044c/\u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0432\u0441\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0439) <code>disown %1</code> \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u044e (\u0435\u0441\u043b\u0438 \u043e\u043d\u0430 \u043f\u0435\u0440\u0432\u0430\u044f) \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u0443\u044e \u0437\u0430\u0434\u0430\u0447\u0443 <code>kill %1</code> \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u044e \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u0443\u044e \u0437\u0430\u0434\u0430\u0447\u0443</p>"},{"location":"Linux/#mem","title":"mem","text":"<p><code>free -m</code> \u043e\u0431\u044a\u0435\u043c \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 \u0438 SWAP \u0432 \u041c\u0411\u0430\u0439\u0442 <code>swapon</code> \u0442\u043e\u0447\u043a\u0430 \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f SWAP, type, size, used, priority (\u0431\u0435\u0440\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u0438\u0437 /proc/swaps) <code>ipcs -lm</code> \u043e\u0431\u044a\u0435\u043c \u0441\u0442\u0440\u0430\u043d\u0438\u0446 \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u043c\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 (shared memory) <code>cat /proc/meminfo | grep Dirty</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043e\u0431\u044a\u0435\u043c \u0433\u0440\u044f\u0437\u043d\u044b\u0445 (Dirty) \u0441\u0442\u0440\u0430\u043d\u0438\u0446 \u0432 \u043a\u044d\u0448\u0435 (\u0435\u0449\u0435 \u043d\u0435 \u0437\u0430\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0445 \u043d\u0430 \u0434\u0438\u0441\u043a) <code>sync</code> \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0432\u0441\u0435 \u043a\u044d\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435, \u043d\u043e \u0435\u0449\u0435 \u043d\u0435 \u0437\u0430\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u0434\u0438\u0441\u043a (\u0432\u043c\u0435\u0441\u0442\u043e \u043a\u044d\u0448\u0430 \u0434\u0430\u043d\u043d\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0447\u0438\u0442\u0430\u0442\u044c\u0441\u044f \u0438\u0437 \u0434\u0438\u0441\u043a\u0430) <code>cat /proc/meminfo | grep -iE \"^cache|^buff\"</code> \u043e\u0431\u044a\u0435\u043c \u043a\u044d\u0448\u0430 \u0438 \u0431\u0443\u0444\u0435\u0440\u0430 <code>echo 1 &gt; /proc/sys/vm/drop_caches</code> \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u0438\u0433\u043d\u0430\u043b \u043d\u0430 \u0432\u0445\u043e\u0434 drop_caches \u0434\u043b\u044f \u043e\u0447\u0438\u0441\u0442\u043a\u0438 \u0441\u0442\u0440\u0430\u043d\u0438\u0447\u043d\u043e\u0433\u043e \u043a\u044d\u0448\u0430 (free buff/cache) - PageCache (\u0441\u0438\u0433\u043d\u0430\u043b 1) <code>echo 2 &gt; /proc/sys/vm/drop_caches</code> \u043e\u0447\u0438\u0441\u0442\u043a\u0430 \u043a\u044d\u0448\u0430 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b - inode, dentrie (\u0441\u0438\u0433\u043d\u0430\u043b 2)</p>"},{"location":"Linux/#fincore","title":"fincore","text":"<p><code>fincore /var/log/*</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0430\u0445\u043e\u0434\u044f\u0442\u0441\u044f \u0432 \u043a\u044d\u0448\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 (page cache) <code>fincore /var/log/syslog</code> 4.3M (\u0434\u0430\u043d\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u0430, \u0445\u0440\u0430\u043d\u044f\u0449\u0438\u0435\u0441\u044f \u0432 \u043f\u0430\u043c\u044f\u0442\u0438) 1100 (\u043a\u043e\u043b-\u0432\u043e \u0441\u0442\u0440\u0430\u043d\u0438\u0446 \u0445\u0440\u0430\u043d\u044f\u0449\u0438\u0435\u0441\u044f \u0432 \u043f\u0430\u043c\u044f\u0442\u0438 PageCache) 199.7M (\u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430) <code>fincore /var/log/syslog -J</code> \u0432\u044b\u0432\u043e\u0434 \u0432 JSON (--raw \u0432\u044b\u0432\u043e\u0434 \u0431\u0435\u0437 \u0442\u0430\u0431\u0443\u043b\u0438\u044f\u0446\u0438\u0438, --noheadings \u0431\u0435\u0437 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u043e\u0432, --byte \u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430 \u0432 \u0431\u0430\u0439\u0442\u0430\u0445) <code>apt install vmtouch</code> <code>vmtouch /var/log/syslog</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043a\u0430\u043a\u043e\u0439 \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0432 \u0441\u0442\u0440\u0430\u043d\u0438\u0447\u043d\u043e\u043c \u043a\u0435\u0448\u0435 (Resident Pages: 1100/51119  4M/199M  2.15%)</p>"},{"location":"Linux/#lspage","title":"lspage","text":"<p><code>fc=$(du -a $1 2&gt; /dev/null | awk '{print $2}' | xargs fincore 2&gt; /dev/null)</code> <code>echo -e \"PAGE\\tSIZE\\tPATH\"</code> <code>printf \"%s\\n\" \"${fc[@]}\" | grep -wvE \"0B|SIZE\" | awk 'BEGIN {OFS=\"\\t\"}; {print $1,$3,$4}'</code></p>"},{"location":"Linux/#lsof","title":"lsof","text":"<p><code>PID</code> \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0442\u043a\u0440\u044b\u043b \u0444\u0430\u0439\u043b <code>TID</code> \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0437\u0430\u0434\u0430\u0447\u0438/\u043f\u043e\u0442\u043e\u043a\u0430, \u043f\u0443\u0441\u0442\u043e\u0439 \u0441\u0442\u043e\u043b\u0431\u0435\u0446 \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442, \u0447\u0442\u043e \u044d\u0442\u043e \u043d\u0435 \u0437\u0430\u0434\u0430\u0447\u0430 \u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 <code>FD</code> \u0444\u0430\u0439\u043b\u043e\u0432\u044b\u0439 \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440 \u0444\u0430\u0439\u043b\u0430 (r - \u0434\u043e\u0441\u0442\u0443\u043f \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f, w - \u0434\u043e\u0441\u0442\u0443\u043f \u0434\u043b\u044f \u0437\u0430\u043f\u0438\u0441\u0438, u - \u0434\u043e\u0441\u0442\u0443\u043f \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f \u0438 \u0437\u0430\u043f\u0438\u0441\u0438, -r - \u0440\u0435\u0436\u0438\u043c \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u0435\u043d \u0438 \u0435\u0441\u0442\u044c \u0441\u0438\u043c\u0432\u043e\u043b \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438 \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435 \u0447\u0430\u0441\u0442\u044c \u0444\u0430\u0439\u043b\u0430, R - \u043d\u0430 \u0432\u0435\u0441\u044c \u0444\u0430\u0439\u043b) <code>TYPE</code> \u0442\u0438\u043f \u0443\u0437\u043b\u0430, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0441 \u0444\u0430\u0439\u043b\u043e\u043c (REG - \u043e\u0431\u044b\u0447\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b, DIR - \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f, CHR - \u0441\u0438\u043c\u0432\u043e\u043b\u044c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b, BLK - \u0431\u043b\u043e\u0447\u043d\u044b\u0439 \u0444\u0430\u0439\u043b, INET - \u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442-\u0441\u043e\u043a\u0435\u0442, unix - \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u0439 \u0441\u043e\u043a\u0435\u0442 UNIX, IPv4 - IPv4 \u0441\u043e\u043a\u0435\u0442, sock - \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0441\u043e\u043a\u0435\u0442, DEL - \u0443\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u044c Linux \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0451\u043d\u043d\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430, LINK - \u0444\u0430\u0439\u043b \u0441\u0438\u043c\u0432\u043e\u043b\u044c\u043d\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0438, PIPE: \u2014 \u0441\u043f\u043e\u0441\u043e\u0431 \u043e\u0431\u043c\u0435\u043d\u0430 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043c\u0435\u0436\u0434\u0443 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430\u043c\u0438) <code>SIZE/OFF</code> \u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430 \u0438\u043b\u0438 \u0441\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u0430 \u0432 \u0431\u0430\u0439\u0442\u0430\u0445 <code>lsof | sed 1d | wc -l</code> \u043a\u043e\u043b-\u0432\u043e \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432/\u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u043e\u0432 <code>cat /proc/sys/fs/file-nr</code> \u043a\u043e\u043b-\u0432\u043e \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432\u044b\u0445 \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u043e\u0432 \u0432 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043c\u043e\u043c\u0435\u043d\u0442, \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u0435\u0439\u0447\u0430\u0441 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f, \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043b\u044f \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f <code>lsof +D /var/log/</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u0430\u043a\u0438\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c \u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435 (+D dir) FD: r/w/u <code>dd if=/dev/zero of=~/dd-zero-file</code> \u0437\u0430\u043d\u044f\u0442\u044c \u0444\u0430\u0439\u043b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c dd \u0438 Ctrl+Z \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441 (\u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432 jobs) <code>ls -lh ~/dd*</code> <code>lsof ~/dd-zero-file</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u0430\u043a\u0438\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c \u0437\u0430\u043d\u044f\u0442 \u0444\u0430\u0439\u043b (List Open Files) <code>lsof -c dd</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0435 \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430/\u043a\u043e\u043c\u0430\u043d\u0434\u044b (\u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 wildcard) <code>lsof -p 1832509</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 PID-\u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 (-p) <code>lsof -c mysql</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0434\u0435\u0440\u0436\u0438\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u043c\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 (-c) <code>lsof -c bash | grep \"\\.sh\"</code> \u043d\u0430\u0439\u0442\u0438 \u0432\u0441\u0435 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0435 \u0441\u043a\u0440\u0438\u043f\u0442\u044b <code>kill -9 $(lsof -t ~/dd-zero-file)</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u043b\u044f \u0432\u044b\u0432\u043e\u0434\u0430 \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043d\u043e\u043c\u0435\u0440\u043e\u0432 PID-\u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 (-t) \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0449\u0438\u0435 \u0444\u0430\u0439\u043b, \u0434\u043b\u044f \u0438\u0445 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f (kill) <code>kill -9 $(lsof -t +D /smb/backup)</code> \u0443\u0431\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0449\u0438\u0435 \u0444\u0430\u0439\u043b\u044b \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0434\u043b\u044f \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0435\u0433\u043e umount /smb/backup <code>lsof -u root</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c  <code>lsof -u^root | wc -l</code> \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (^) \u0438\u0437 \u043f\u043e\u0438\u0441\u043a\u0430 \u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u043e\u043b-\u0432\u043e \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 <code>lsof -i:8080</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043e\u0442\u043a\u0440\u044b\u0442 \u043b\u0438 \u043f\u043e\u0440\u0442 (-i:)</p>"},{"location":"Linux/#descriptor","title":"descriptor","text":"<p><code>lsof -a -p $$ -d 0,1,2</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u044b \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u043f\u0440\u0438\u0442\u0430\u0442\u043e\u0440\u0430 <code>ps $$</code> <code>0u</code> STDIN \u2014 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u043f\u043e\u0442\u043e\u043a \u0432\u0432\u043e\u0434\u0430 (\u0441 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b) <code>1u</code> STDOUT \u2014 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u043f\u043e\u0442\u043e\u043a \u0432\u044b\u0432\u043e\u0434\u0430 (\u043d\u0430 \u044d\u043a\u0440\u0430\u043d/\u0432 \u0444\u0430\u0439\u043b) <code>2u</code> STDERR \u2014 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u043f\u043e\u0442\u043e\u043a \u043e\u0448\u0438\u0431\u043e\u043a <code>cat test.txt 1&gt; out.txt 2&gt; error.txt</code> \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434 (\u0435\u0441\u043b\u0438 \u0444\u0430\u0439\u043b \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442) \u0432 out.txt, \u0435\u0441\u043b\u0438 \u043e\u0448\u0438\u0431\u043a\u0430 \u0432 error.txt <code>cat test2.txt 2&gt; /dev/null</code> \u043d\u0435 \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u043e\u0448\u0438\u0431\u043a\u0438 <code>cat=$(cat test 2&gt;&amp;1)</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0433\u043e \u0432\u044b\u0432\u043e\u0434\u0430 \u043e\u0448\u0438\u0431\u043e\u043a (stderr - standard error) \u0432 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434 (stdout - standard output) \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0433\u043e \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u0430 (&amp;) \u0432\u043c\u0435\u0441\u0442\u043e \u0444\u0430\u0439\u043b\u0430</p>"},{"location":"Linux/#vmstat","title":"vmstat","text":"<p><code>cat /proc/vmstat</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 nr_free_pages, inactive/active anon, file <code>cat /proc/zoneinfo</code> \u0441 \u0440\u0430\u0437\u0431\u0438\u0435\u043d\u0438\u0435\u043c \u043d\u0430 \u0437\u043e\u043d\u044b \u043f\u0430\u043c\u044f\u0442\u0438 \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0435\u0435 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f <code>vmstat -V</code> procps-ng 3.3.17 (\u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a top) <code>vmstat -s</code> \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 memory/swap/io/system/cpu <code>vmstat -d | grep sda</code> \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0434\u0438\u0441\u043a\u0430 <code>vmstat -D</code> \u0441\u0443\u043c\u043c\u0430\u0440\u043d\u0430\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0434\u0438\u0441\u043a\u043e\u0432 <code>vmstat -t 1 2</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c 2 \u043e\u0442\u0447\u0435\u0442\u0430 (\u0441\u0443\u043c\u043c\u0430\u0440\u043d\u044b\u0439 \u0438 \u0442\u0435\u043a\u0443\u0449\u0438\u0439) \u0441 \u0447\u0430\u0441\u0442\u0430\u0442\u043e\u0439 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f 1 \u0441\u0435\u043a\u0443\u043d\u0434\u0430 \u0438 timestamp (-t) <code>r</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 (\u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0445 \u0438\u043b\u0438 \u043e\u0436\u0438\u0434\u0430\u044e\u0449\u0438\u0445 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f) <code>b</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u043f\u044f\u0449\u0438\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 <code>swpd</code> \u043e\u0431\u044a\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u043e\u0439 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 <code>free</code> \u043e\u0431\u044a\u0435\u043c \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 <code>buff</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0430\u043c\u044f\u0442\u0438, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u043e\u0439 \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0431\u0443\u0444\u0435\u0440\u043e\u0432 <code>cache</code> \u043e\u0431\u044a\u0435\u043c \u043f\u0430\u043c\u044f\u0442\u0438, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u043e\u0439 \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043a\u0435\u0448\u0430 <code>inact</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 (-a) <code>active</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 (-a) <code>si</code> \u043e\u0431\u044a\u0435\u043c \u043f\u0430\u043c\u044f\u0442\u0438, \u0432\u044b\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0439 \u0441 \u0434\u0438\u0441\u043a\u0430 (/s) <code>so</code> \u043e\u0431\u044a\u0435\u043c \u043f\u0430\u043c\u044f\u0442\u0438, \u043f\u0435\u0440\u0435\u043d\u0435\u0441\u0435\u043d\u043d\u044b\u0439 \u043d\u0430 \u0434\u0438\u0441\u043a (/s) <code>bi</code> IOPS (Input/Output Operations Per Second) \u0431\u043b\u043e\u043a\u0438, \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0435 \u043e\u0442 \u0431\u043b\u043e\u0447\u043d\u043e\u0433\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 (block input/sec) <code>bo</code> IOPS \u0431\u043b\u043e\u043a\u0438, \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043d\u0430 \u0431\u043b\u043e\u0447\u043d\u043e\u0435 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e (block output/sec) <code>in</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u0435\u0440\u044b\u0432\u0430\u043d\u0438\u0439 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0443, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0447\u0430\u0441\u044b <code>cs</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0443 <code>us</code> \u0432\u0440\u0435\u043c\u044f, \u043f\u043e\u0442\u0440\u0430\u0447\u0435\u043d\u043d\u043e\u0435 \u043d\u0430 \u0437\u0430\u043f\u0443\u0441\u043a \u043a\u043e\u0434\u0430, \u043d\u0435 \u043e\u0442\u043d\u043e\u0441\u044f\u0449\u0435\u0433\u043e\u0441\u044f \u043a \u044f\u0434\u0440\u0443 (\u0432\u0440\u0435\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f) <code>sy</code> \u0432\u0440\u0435\u043c\u044f, \u043f\u043e\u0442\u0440\u0430\u0447\u0435\u043d\u043d\u043e\u0435 \u043d\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043a\u043e\u0434\u0430 \u044f\u0434\u0440\u0430 (\u0441\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f) <code>id</code> \u0432\u0440\u0435\u043c\u044f \u0431\u0435\u0437\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f <code>wa</code> \u0432\u0440\u0435\u043c\u044f, \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u043d\u043e\u0435 \u0432 \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u0438 \u0432\u0432\u043e\u0434\u0430/\u0432\u044b\u0432\u043e\u0434\u0430 <code>st</code> \u0432\u0440\u0435\u043c\u044f, \u0443\u043a\u0440\u0430\u0434\u0435\u043d\u043d\u043e\u0435 \u0438\u0437 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b</p>"},{"location":"Linux/#sysstat","title":"sysstat","text":"<p><code>apt install sysstat</code></p>"},{"location":"Linux/#iostat","title":"iostat","text":"<p><code>iostat -h</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 kb/mb/gb (avg-cpu: %user %system %idle, tps - \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435 \u0438 \u0437\u0430\u043f\u0438\u0441\u044c \u043a \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0443 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0443) <code>iostat -hp</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u043f\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0443 \u0438 \u0432\u0441\u0435\u0445 \u0435\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0430\u043c (-p) <code>iostat -ky /dev/sd* 1 1 | grep -w sd.</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u0432 \u041a\u0411\u0430\u0439\u0442 (-k), \u043f\u0440\u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u0441 \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u043c \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b\u043e\u043c \u043f\u0435\u0440\u0432\u044b\u0439 \u043e\u0442\u0447\u0435\u0442 \u0441\u043e \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u043e\u0439 \u0441 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043e\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f (-y) <code>iostat -h /dev/sda3 -o JSON</code> \u0432\u044b\u0432\u043e\u0434 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 JSON</p>"},{"location":"Linux/#mpstat","title":"mpstat","text":"<p><code>mpstat</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u043f\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430 \u043f\u043e \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u044f\u0434\u0440\u0443, \u0438 \u043a\u0443\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0440\u0435\u0441\u0443\u0440\u0441\u044b <code>mpstat -P ALL</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u044f\u0434\u0440\u0430. <code>mpstat 2 10</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c 10 \u0440\u0430\u0437 \u0441 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u043a\u0430\u0436\u0434\u044b\u0435 2 \u0441\u0435\u043a\u0443\u043d\u0434\u044b <code>%user</code> \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430\u043c\u0438, \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u043c\u0438 \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>%nice</code> \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430\u043c\u0438 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u043c\u0438 \u0432 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0441 \u0438\u0437\u043c\u0435\u043d\u0451\u043d\u043d\u044b\u043c \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u043e\u043c <code>%system</code> \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430 \u044f\u0434\u0440\u043e\u043c <code>%iowait</code> \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0437\u0430\u0442\u0440\u0430\u0447\u0435\u043d\u043d\u043e\u0433\u043e \u043d\u0430 \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439 \u0432\u0432\u043e\u0434\u0430/\u0432\u044b\u0432\u043e\u0434\u0430, \u0435\u0441\u043b\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u043e\u0435, \u0437\u043d\u0430\u0447\u0438\u0442 \u043c\u043d\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0442\u0440\u0430\u0442\u0438\u0442\u0441\u044f \u043d\u0430 \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0432\u0432\u043e\u0434\u0430/\u0432\u044b\u0432\u043e\u0434\u0430 <code>%steal</code> \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u043f\u0440\u043e\u0441\u0442\u043e\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430, \u043f\u043e\u043a\u0430 \u0433\u0438\u043f\u0435\u0440\u0432\u0438\u0437\u043e\u0440 \u043e\u0442\u0434\u0430\u0451\u0442 \u043c\u043e\u0449\u043d\u043e\u0441\u0442\u044c \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0443 <code>%idle</code> \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043f\u043e\u043a\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440 \u043d\u0435 \u0437\u0430\u043d\u044f\u0442 \u043d\u0438\u0447\u0435\u043c</p>"},{"location":"Linux/#pidstat","title":"pidstat","text":"<p><code>pidstat</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0445 \u0438 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0438 \u0442\u0435\u043a\u0443\u0449\u0438\u0445 \u043f\u043e\u0442\u043e\u043a\u043e\u0432 <code>pidstat -p ALL</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0438 \u043d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438</p>"},{"location":"Linux/#stress","title":"stress","text":"<p><code>stress --cpu 2 --timeout 10</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u044f\u0434\u0435\u0440 \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0438 10 \u0441\u0435\u043a\u0443\u043d\u0434 <code>stress -v N</code> \u043d\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043f\u0430\u043c\u044f\u0442\u044c <code>stress --io 100 &amp;</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043d\u0430 \u0432\u0432\u043e\u0434-\u0432\u044b\u0432\u043e\u0434 <code>iostat -d /dev/sda 1</code> <code>stress --hdd 100 &amp;</code> \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043d\u0430 \u0434\u0438\u0441\u043a <code>vmstat 1 100</code></p>"},{"location":"Linux/#stress-ng","title":"stress-ng","text":"<p><code>apt-get install stress-ng</code> <code>stress-ng --sequential 0 --class io --timeout 60s --metrics-brie</code> \u0442\u0435\u0441\u0442 \u0432\u0432\u043e\u0434\u0430 \u0432\u044b\u0432\u043e\u0434\u0430 <code>stress-ng --hdd 5 --hdd-ops 100000</code> \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043e 5 \u0441\u0442\u0440\u0435\u0441\u0441\u043e\u0440\u043e\u0432 \u0434\u043b\u044f \u0436\u0451\u0441\u0442\u043a\u0438\u0445 \u0434\u0438\u0441\u043a\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u043f\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438 100 \u0442\u044b\u0441. bogo-\u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439 <code>stress-ng --cpu 1 --cpu-method matrixprod --metrics --timeout 60</code> <code>stress-ng --sequential 0 --class memory --timeout 60s --metrics-brief</code> <code>stress-ng --cpu 2 --io 4 --vm 1 --vm-bytes 1G --timeout 60s --metrics-brief</code></p>"},{"location":"Linux/#smart","title":"smart","text":""},{"location":"Linux/#smartmontools","title":"smartmontools","text":"<p><code>apt install smartmontools</code> <code>smartctl -a /dev/sda</code> \u0442\u0435\u0441\u0442 \u0434\u0438\u0441\u043a\u0430 \u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u0442\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u0435 <code>smartctl -H /dev/sda</code> SMART Health Status</p>"},{"location":"Linux/#sensors","title":"sensors","text":"<p><code>apt install lm-sensors</code> <code>sensors-detect</code> \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u0442\u0447\u0438\u043a\u0438 \u0442\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u044b <code>sensors</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0434\u0430\u0442\u0447\u0438\u043a\u0438</p>"},{"location":"Linux/#badblocks","title":"badblocks","text":"<p><code>badblocks -s /dev/sda</code> \u0442\u0435\u0441\u0442 \u043d\u0430 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u043d\u0435\u0447\u0438\u0442\u0430\u0435\u043c\u044b\u0445/\u0431\u0438\u0442\u044b\u0445 \u0431\u043b\u043e\u043a\u043e\u0432/\u0441\u0435\u043a\u0442\u043e\u0440\u043e\u0432 \u043d\u0430 \u0434\u0438\u0441\u043a\u0435</p>"},{"location":"Linux/#hdparm","title":"hdparm","text":"<p><code>hdparm -I /dev/sda | grep -i model</code> \u043c\u043e\u0434\u0435\u043b\u044c \u0436\u0435\u0441\u0442\u043a\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430 (Model Number, Serial Number, Firmware Revision) <code>hdparm -v /dev/sda</code> \u043a\u043e\u043b-\u0432\u043e \u0441\u0435\u043a\u0442\u043e\u0440\u043e\u0432 \u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 <code>hdparm -tT /dev/sda</code> \u0442\u0435\u0441\u0442 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u0440\u0430\u0431\u043e\u0442\u044b \u0431\u0435\u0437 \u043a\u044d\u0448\u0430 (-t) \u0438 \u0441 \u043a\u044d\u0448\u0435\u043c (-T) <code>hdparm -D /dev/sda</code> \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435/\u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u0435\u0444\u0435\u043a\u0442\u0430\u043c\u0438 \u0434\u0438\u0441\u043a\u043e\u0432 <code>hdparm -r /dev/sda</code> \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0440\u0435\u0436\u0438\u043c read only \u0434\u043b\u044f \u0434\u0438\u0441\u043a\u0430 <code>hdparm -A /dev/sda</code> \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0440\u0435\u0436\u0438\u043c read-look-ahead, \u043a\u043e\u0433\u0434\u0430 \u0434\u0438\u0441\u043a \u043f\u0440\u043e\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u0435\u0440\u0435\u0434 \u0447\u0442\u0435\u043d\u0438\u0435\u043c, \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0430 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e <code>hdparm -a /dev/sda</code> \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0440\u0435\u0436\u0438\u043c read-ahead, \u043a\u043e\u0433\u0434\u0430 \u0447\u0442\u0435\u043d\u0438\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0432 \u043f\u0435\u0440\u0432\u0443\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0443\u043b\u0443\u0447\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0447\u0442\u0435\u043d\u0438\u044f \u0431\u043e\u043b\u044c\u0448\u0438\u0445 \u043e\u0431\u044a\u0435\u043c\u043e\u0432 \u0434\u0430\u043d\u043d\u044b\u0445 <code>hdparm -b /dev/sda</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0436\u0435\u0441\u0442\u043a\u0438\u0439 \u0434\u0438\u0441\u043a \u0434\u043e \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0433\u043e \u043a \u043d\u0435\u043c\u0443 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f <code>hdparm -S 1 /dev/sda</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0440\u0430\u0449\u0435\u043d\u0438\u0435 \u043c\u043e\u0442\u043e\u0440\u0430 \u0434\u0438\u0441\u043a\u0430 \u0434\u043e \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0433\u043e \u043a \u043d\u0435\u043c\u0443 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f <code>hdparm -B 120 /dev/sda</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0438\u0442\u0430\u043d\u0438\u0435\u043c Advanced Power Management (APM), \u0447\u0435\u043c \u043d\u0438\u0436\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u0442\u0435\u043c \u043b\u0443\u0447\u0448\u0435 \u044d\u043d\u0435\u0440\u0433\u043e\u0441\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u0438\u0435 (255 - \u0434\u043b\u044f \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f) <code>hdparm -Z /dev/sda</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0440\u0435\u0436\u0438\u043c \u044d\u043d\u0435\u0440\u0433\u043e\u0441\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u0438\u044f <code>hdparm -M 128 /dev/sda</code> \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0443\u0440\u043e\u0432\u043d\u0435\u043c \u0448\u0443\u043c\u0430 (\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043e\u0442 128 - \u0431\u043e\u043b\u0435\u0435 \u0442\u0438\u0445\u0443\u044e \u0440\u0430\u0431\u043e\u0442\u0443, \u0434\u043e 254 - \u0432\u044b\u0441\u043e\u043a\u0443\u044e)</p>"},{"location":"Linux/#disk","title":"disk","text":"<p><code>du -sh /home</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043e\u0431\u0449\u0438\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 (-s) <code>du -Sh /home</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043e\u0431\u0449\u0438\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0432\u0441\u0435\u0445 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 (-S) \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439 \u043f\u043e \u043f\u0443\u0442\u0438 <code>du -h /home</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043e\u0431\u0449\u0438\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0438 \u043f\u043e\u0434\u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u0432 \u0432\u043d\u0443\u0442\u0440\u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 <code>du -ah /home</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043e\u0431\u0449\u0438\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0438 \u0432\u0441\u0435\u0445 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 (-a) \u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439</p> <p><code>lsblk</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u0431\u043b\u043e\u0447\u043d\u044b\u0445 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432 (/dev), \u0438\u0445 SIZE, TYPE (disk/part/lvm) \u0438 \u0442\u043e\u0447\u043a\u0443 \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (MOUNTPOINTS) <code>lsblk -e7</code> \u0432\u044b\u0432\u043e\u0434 \u0431\u0435\u0437 loop <code>lsblk -f</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u0443\u044e FSTYPE, UUID, FSAVAIL - \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e \u043d\u0430 \u0434\u0438\u0441\u043a\u0435 \u0438 FSUSE - \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0437\u0430\u043d\u044f\u0442\u043e \u043d\u0430 \u0434\u0438\u0441\u043a\u0435 \u0432 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u0430\u0445 <code>lsblk -o NAME,MODEL,SERIAL,SIZE,STATE --nodeps | grep running</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043c\u043e\u0434\u0435\u043b\u044c, \u0440\u0430\u0437\u043c\u0435\u0440 \u0438 \u0441\u0442\u0430\u0442\u0443\u0441 \u0431\u0435\u0437 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432/lvm (--nodeps) <code>lsblk -E NAME</code> \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0432\u044b\u0432\u043e\u0434\u0430 \u043f\u043e \u043a\u043e\u043b\u043e\u043d\u043a\u0435 <code>lsblk -S</code> \u0432\u044b\u0432\u043e\u0434 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e SCSI-\u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430\u0445 (--scsi) <code>lsblk -b</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c SIZE \u0432 \u0431\u0430\u0439\u0442\u0430\u0445 (--bytes) <code>lsblk -J</code> \u0432\u044b\u0432\u043e\u0434 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 JSON (--json) <code>lsblk -P</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0444\u043e\u0440\u043c\u0430\u0442 \u0432\u044b\u0432\u043e\u0434\u0430 key=\"value\" <code>lsblk -m</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u0440\u0430\u0432\u0430\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u0430</p> <p><code>df -h</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432\u044b\u0445 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u0445. \u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043e\u0431\u0449\u0438\u0439 \u043e\u0431\u044a\u0451\u043c (Size), \u0437\u0430\u043d\u044f\u0442\u043e\u0433\u043e (Used) \u0438 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e (Avail) \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0430 <code>df -h -T</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c Type \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b (ext4/cifs)</p> <p><code>apt install duf</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c duf <code>duf</code> \u0430\u043d\u0430\u043b\u043e\u0433 df</p> <p><code>mount | grep /dev/</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u043e\u0432\u044b\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b <code>mount | grep -P \"mapper|lv|vg\"</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 lvm</p> <p><code>findmnt</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432\u044b\u0445 \u0441\u0438\u0441\u0442\u0435\u043c \u0432 \u0434\u0440\u0435\u0432\u043e\u0432\u0438\u0434\u043d\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435 <code>findmnt -l</code> \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 <code>findmnt -t ext4</code></p> <p><code>e2label /dev/sda3</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043c\u0435\u0442\u043a\u0443 \u0434\u0438\u0441\u043a\u0430 <code>blkid</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0451\u043d\u043d\u044b\u0445 \u0434\u0438\u0441\u043a\u043e\u0432, \u0438\u0445 UUID \u0438 TYPE <code>lsscsi</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b SCSI \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u043a \u0441\u0438\u0441\u0442\u0435\u043c\u0435</p>"},{"location":"Linux/#parted","title":"parted","text":"<p><code>parted -l</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 \u043d\u0430 \u0434\u0438\u0441\u043a\u0430\u0445 <code>parted -l | grep -i model</code> <code>dd if=/dev/zero of=/tmp/disk.img count=1000 bs=1M</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0437 \u0434\u0438\u0441\u043a\u0430 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0439 \u043d\u0443\u043b\u044f\u043c\u0438 \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c 1\u0413\u0431 <code>parted /tmp/disk.img</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c parted \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b-\u043e\u0431\u0440\u0430\u0437 \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0424\u0421 <code>parted /dev/sdc</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c parted \u0434\u0438\u0441\u043a <code>mktable gpt</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 GPT <code>print</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0442\u0438\u043f \u0442\u0430\u0431\u043b\u0438\u0446\u044b (Partition Table: GPT) \u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 \u043d\u0430 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435, \u0435\u0441\u043b\u0438 \u043e\u043d\u0438 \u0431\u044b\u043b\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u044b <code>print free</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u0438 \u0432\u0441\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u044b <code>mkpart primary ext4 0 500M</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0435\u0440\u0432\u044b\u0439, \u043f\u0435\u0440\u0432\u0438\u0447\u043d\u044b\u0439 (primary) \u0440\u0430\u0437\u0434\u0435\u043b \u0441 \u0424\u0421 ext4 \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c 500\u041c\u0431. <code>mkpart primary ext4 500 1000M</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0442\u043e\u0440\u043e\u0439 \u0440\u0430\u0437\u0434\u0435\u043b (\u043d\u0430\u0447\u0430\u043b\u043e \u0438 \u043a\u043e\u043d\u0435\u0446) <code>resizepart 2 600M</code> \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c 2-\u0439 \u0440\u0430\u0437\u0434\u0435\u043b \u0434\u043e 100\u041c\u0411 (\u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f end-\u043a\u043e\u043d\u0435\u0446) <code>resizepart 2 100%</code> \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0434\u043e \u0432\u0441\u0435\u0433\u043e \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0433\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430 <code>rm 2</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b</p>"},{"location":"Linux/#fdisk","title":"fdisk","text":"<p><code>fdisk -l</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432 \u043f\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u043e \u0441 \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c \u0441\u0435\u043a\u0442\u043e\u0440\u043e\u0432 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0430 <code>fdisk -x</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434 (\u0443\u0437\u043d\u0430\u0442\u044c UUID \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432) <code>fdisk -l | grep /dev/sd</code> <code>fdisk -l | grep -E \"/dev/sd.[1-9]\"</code> <code>fdisk -l | grep -E \"lv|vg\"</code> <code>fdisk /dev/sdc</code> <code>m</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u0430\u043d\u0434 <code>p</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0434\u0438\u0441\u043a\u0430 \u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 (/dev/sdc1) <code>n</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0440\u0430\u0437\u0434\u0435\u043b (p), \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043d\u043e\u043c\u0435\u0440 \u0440\u0430\u0437\u0434\u0435\u043b\u0430 - partition number (4-128, default 4), \u043d\u0430\u0447\u0430\u043b\u043e \u0438 \u043a\u043e\u043d\u0446\u0435 \u0441\u0435\u043a\u0442\u043e\u0440\u0430 - enter (\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e) <code>i</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u0435 (\u043d\u0430\u0447\u0430\u043b\u043e, \u043a\u043e\u043d\u0435\u0446, \u043e\u0431\u0449\u0438\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0441\u0435\u043a\u0442\u043e\u0440\u0430 \u0438 \u0440\u0430\u0437\u043c\u0435\u0440 \u0434\u0438\u0441\u043a\u0430) <code>t</code> \u0437\u0430\u0434\u0430\u0442\u044c \u0442\u0438\u043f \u0440\u0430\u0437\u0434\u0435\u043b\u0430 - 30/8E (Linux LVM) \u0438\u043b\u0438 20/83 (Linux filesystem) <code>l</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0442\u0438\u043f\u043e\u0432 <code>w</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c <code>q</code> \u0432\u044b\u0445\u043e\u0434 <code>partprobe /dev/sdc</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442 \u044f\u0434\u0440\u043e \u041e\u0421 \u043e\u0431 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f\u0445 \u0442\u0430\u0431\u043b\u0438\u0446\u044b \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432, \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u044f \u0443 \u0441\u0438\u0441\u0442\u0435\u043c\u044b, \u0447\u0442\u043e\u0431\u044b \u043e\u043d\u0430 \u043f\u0435\u0440\u0435\u0447\u0438\u0442\u0430\u043b\u0430 \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432</p>"},{"location":"Linux/#sfdisk","title":"sfdisk","text":"<p><code>sfdisk -d /dev/sdc &gt; sdc.partition.table.txt</code> backup (\u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e dump cfdisk) <code>sfdisk -f /dev/sdc &lt; sdc.partition.table.txt</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c</p> <p><code>sfdisk -d /dev/sda | sfdisk -f /dev/sdd</code> \u0434\u043b\u044f \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f MD RAID1 (sda \u0432 sdd) <code>mdadm --manage /dev/md1 --add /dev/sdd1</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f <code>watch cat /proc/mdstat</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438</p> <ul> <li>\u041d\u043e\u0432\u044b\u0439 \u0434\u0438\u0441\u043a \u0434\u043b\u044f \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f LVM:</li> </ul> <p><code>ls /dev/sd*</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0434\u0438\u0441\u043a\u0438 \u0432 \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 <code>fdisk -l</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0434\u0438\u0441\u043a\u0438 \u0447\u0435\u0440\u0435\u0437 fdisk <code>cfdisk /dev/sda</code> \u0440\u0430\u0437\u043c\u0435\u0442\u043a\u0430 \u0434\u0438\u0441\u043a\u0430 \u043d\u0430 \u0440\u0430\u0437\u0434\u0435\u043b\u044b (\u043d\u043e\u0432\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442) <code>cfdisk /dev/sdb</code> \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0434\u0438\u0441\u043a, \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 (gpt) <code>new - sda4</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0440\u0430\u0437\u0434\u0435\u043b sda4 \u0438\u043b\u0438 sdb1 <code>Free space - Partition size: 100G</code> <code>write - yes</code> <code>pvcreate /dev/sda4</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0442\u043e\u043c \u0438\u0437 \u0440\u0430\u0437\u0434\u0435\u043b\u0430 <code>vgextend ubuntu-vg /dev/sda4</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0440\u0430\u0437\u0434\u0435\u043b \u0432 \u0433\u0440\u0443\u043f\u043f\u0443 <code>lvextend -l +100%FREE /dev/ubuntu-vg/ubuntu-lv</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u0432 \u0433\u0440\u0443\u043f\u043f\u0435 \u0434\u043b\u044f \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0430 ubuntu-lv <code>lsblk</code> <code>df -h</code> \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0431\u0443\u0434\u0435\u0442 \u0432\u0438\u0434\u0435\u0442\u044c \u0441\u0442\u0430\u0440\u044b\u0439 \u043e\u0431\u044a\u0435\u043c \u0434\u0438\u0441\u043a\u0430, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u043f\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044e \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b <code>df -T -h</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0442\u0438\u043f \u0424\u0421 <code>resize2fs -f /dev/ubuntu-vg/ubuntu-lv</code> \u0434\u043b\u044f ext* <code>btrfs filesystem resize +100g /</code> \u0434\u043b\u044f btrfs</p> <ul> <li>\u041d\u043e\u0432\u044b\u0439 \u0434\u0438\u0441\u043a \u0434\u043b\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0430:</li> </ul> <p><code>cfdisk /dev/sd\u0441</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b (cfdisk/fdisk/parted) <code>mkfs.ext4 /dev/sdc1</code> \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b <code>mkdir /mnt/sdc1 &amp;&amp; mount /dev/sdc1 /mnt/sdc1</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b, -o -r - \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435 (--options --read-only) <code>df -h &amp;&amp; lsblk</code> \u0440\u0430\u0437\u0434\u0435\u043b \u043d\u043e\u0432\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0432 \u0441\u0442\u0430\u0442\u0443\u0441\u0435 Mounted on \u0438\u043b\u0438 MOUNTPOINTS <code>chmod 0777 /mnt/sdc1</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u0441\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0434\u0438\u0441\u043a\u0443 <code>df -h -T</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0442\u0438\u043f \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 <code>nano /etc/fstab</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438\u044b <code>/dev/sdc1 /mnt/sdc1 ext4 rw,relatime 0 0</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044e \u0438\u043b\u0438 UUID \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 <code>umount /dev/sdc1</code> \u043e\u0442\u043c\u0430\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b</p>"},{"location":"Linux/#swap","title":"swap","text":"<p><code>fallocate -l 4G /swapfile.img</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0434\u043b\u044f swap <code>dd if=/dev/zero of=/swapfile.img count=1024 bs=1M</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0434\u043b\u044f swap <code>chmod 600 /swapfile.img</code> \u0434\u0430\u0442\u044c \u043f\u0440\u0430\u0432\u0430 <code>mkswap /swapfile.img</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c swap-\u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e \u0438\u0437 \u0444\u0430\u0439\u043b\u0430 \u0438\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0432\u0435\u0441\u044c \u043e\u0431\u044a\u0451\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0430 (mkswap /dev/sda4) <code>swapon /swapfile.img</code> \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c swap-\u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e <code>echo '/swapfile.img none swap sw 0 0' | sudo tee -a /etc/fstab</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c <code>free -m</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043e\u0431\u044a\u0451\u043c <code>swapoff -a</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c <code>rm /swapfile.img</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0444\u0430\u0439\u043b</p>"},{"location":"Linux/#lvm","title":"lvm","text":"<p>Logical Volume Management - \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u043c\u0438 \u0442\u043e\u043c\u0430\u043c\u0438, \u044d\u0442\u043e \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0441\u043b\u043e\u0439 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0446\u0438\u0438 \u043e\u0442 \u0436\u0435\u043b\u0435\u0437\u0430, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0439 \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0440\u0430\u0437\u043d\u044b\u0445 \u0434\u0438\u0441\u043a\u043e\u0432 \u0432 \u043e\u0434\u0438\u043d, \u0438 \u0437\u0430\u0442\u0435\u043c \u0440\u0430\u0437\u0431\u0438\u0442\u044c \u0435\u0433\u043e \u043d\u0430 \u0433\u0440\u0443\u043f\u043f\u044b \u0438 \u0440\u0430\u0437\u0434\u0435\u043b\u044b. \u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u044b\u0439 RAID 0 \u0438 1 (\u0437\u0435\u0440\u043a\u0430\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435) \u0441 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u043c \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e\u043c, \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u0430\u043c\u0438 \u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0442\u043e\u043c\u043e\u0432 \u0432 \u0434\u0440\u0443\u0433\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443.</p> <ul> <li>PV (Physical Volume) \u2014 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0442\u043e\u043c\u0430</li> </ul> <p><code>pvs</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a Physical Volume <code>pvdisplay</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f <code>pvcreate /dev/sdb</code> \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0434\u0438\u0441\u043a\u0430 \u0432 LVM \u043a\u0430\u043a \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0442\u043e\u043c</p> <ul> <li>VG (Volume Group) \u2014 \u0433\u0440\u0443\u043f\u043f\u044b \u0442\u043e\u043c\u043e\u0432, \u0434\u043b\u044f \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0442\u043e\u043c\u043e\u0432 \u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043e\u0431\u0449\u0435\u0433\u043e \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u0437\u0431\u0438\u0432\u0430\u0442\u0441\u044c\u044f \u043d\u0430 \u0440\u0430\u0437\u0434\u0435\u043b\u044b</li> </ul> <p><code>vgs</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a Volume Group <code>vgdisplay</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f <code>vgcreate vg21 /dev/sdb</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0442\u043e\u043c\u043e\u0432 \u0441 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0442\u043e\u043c\u0430 \u043d\u0430 \u0434\u0438\u0441\u043a\u0435 sdb</p> <ul> <li>LV (Logical Volume) \u2014 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u044b</li> </ul> <p><code>lvs</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a Logic Volume \u0438 \u0438\u0445 \u043e\u0431\u044a\u0451\u043c <code>lvdisplay</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f <code>lvcreate -n boot -L 1G vg21</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0435\u0440\u0432\u044b\u0439 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0440\u0430\u0437\u0434\u0435\u043b \u0441 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435\u043c boot <code>lvcreate -n home -L 9G vg21</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0442\u043e\u0440\u043e\u0439 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0440\u0430\u0437\u0434\u0435\u043b \u0441 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435\u043c home <code>lvcreate -n lv21 -l+100%FREE vg21</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043e\u0434\u0438\u043d \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0440\u0430\u0437\u0434\u0435\u043b lv21 \u0434\u043b\u044f \u0433\u0440\u0443\u043f\u043f\u044b \u0442\u043e\u043c\u043e\u0432 vg21 \u0438 \u043d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u0435\u043c\u0443 \u0432\u0435\u0441\u044c \u043e\u0431\u044a\u0435\u043c \u0434\u0438\u0441\u043a\u0430 <code>mkfs -t ext4 /dev/vg21/lv21</code> \u043d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u0444\u0430\u0439\u043b\u043e\u0432\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c ext4 <code>mkdir /mnt/lv21</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0430\u043f\u043a\u0443 \u0434\u043b\u044f \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f <code>mount /dev/vg21/lv21 /mnt/lv21</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b \u043a \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u043e\u0439 \u043f\u0430\u043f\u043a\u0435 <code>echo \"/dev/vg21/lv21 /mnt/lv21 ext4 defaults 0 0\" &gt;&gt; /etc/fstab</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0432 \u0430\u0432\u0442\u043e\u0437\u0430\u0433\u0440\u0443\u043a\u0443</p> <ul> <li>\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c</li> </ul> <p>\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0430 \u043c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0437\u0430 \u0441\u0447\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430 \u043f\u0443\u0442\u0451\u043c \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432 \u0433\u0440\u0443\u043f\u043f\u0443 \u0438\u043b\u0438 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0435\u043c \u0438\u043c\u0435\u044e\u0449\u0435\u0433\u043e\u0441\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430. <code>pvcreate /dev/sdc</code> e\u0441\u043b\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u043d\u043e\u0432\u044b\u0439 \u0434\u0438\u0441\u043a, \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c (\u043c\u0438\u043d\u0443\u0441: \u0435\u0441\u043b\u0438 \u043e\u0434\u0438\u043d \u0438\u0437 \u0434\u0438\u0441\u043a\u043e\u0432 \u0432\u044b\u0445\u043e\u0434\u0438\u0442 \u0438\u0437 \u0441\u0442\u0440\u043e\u044f, \u0434\u0430\u043d\u043d\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u043d\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b, \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e \u0440\u0430\u0431\u043e\u0442\u0435 RAID 0) <code>pvresize /dev/sdb</code> \u0435\u0441\u043b\u0438 \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u043d \u043e\u0431\u044a\u0435\u043c \u0434\u0438\u0441\u043a\u043e\u0432\u043e\u0433\u043e \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0430 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430 (resize - \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0442\u043e\u043c\u0430) <code>vgextend vg21 /dev/sdc</code> \u0440\u0430\u0441\u0448\u0438\u0440\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 vg21 \u0437\u0430 \u0441\u0447\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430 sdc (\u0438\u043b\u0438 vgdisplay) <code>vgs</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442 \u0443 \u043a\u0430\u043a\u043e\u0439 \u0438\u0437 \u0433\u0440\u0443\u043f\u043f \u0432\u0441\u0435\u0433\u043e \u043f\u0430\u043c\u044f\u0442\u0438 VSize \u0438 \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u043f\u0430\u043c\u044f\u0442\u0438 VFree \u0434\u043b\u044f \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0438\u043b\u0435\u043d\u0438\u044f \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0430\u043c \u043f\u0430\u043c\u044f\u0442\u0438, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0440\u0430\u0441\u0448\u0438\u0440\u0438\u043b\u0438 <code>lvextend -l +100%FREE /dev/vg21/lv21</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432\u0441\u0435 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0435 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u0441\u0442\u0432\u043e \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u043c\u0443 \u0440\u0430\u0437\u0434\u0435\u043b\u0443 <code>vgs</code> VFree \u0431\u0443\u0434\u0435\u0442=0 \u0430 \u0432 lsblk \u043e\u0431\u044a\u0451\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0430 \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u0441\u044f <code>lvextend -L+1G /dev/vg21/lv21</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c 1\u0413\u0431 \u043e\u0442 \u0433\u0440\u0443\u043f\u043f\u044b \u0442\u043e\u043c\u043e\u0432 vg21 \u0440\u0430\u0437\u0434\u0435\u043b\u0443 lv21 <code>lvextend -L500G /dev/vg21/lv21</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0434\u043e \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0434\u0438\u0441\u043a\u0430 500\u0413\u0431 <code>lvs</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c <code>df -T</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u0443\u044e \u0424\u0421 <code>resize2fs /dev/vg01/lv01</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0434\u043b\u044f \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b ext4</p> <ul> <li>\u0423\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c</li> </ul> <p><code>e2fsck -fy /dev/vg21/lv21</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0434\u0438\u0441\u043a\u0430 <code>resize2fs /dev/vg21/lv21 500M</code> \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0424\u0421 \u043d\u0430 500\u041c\u0431\u0430\u0439\u0442 <code>lvreduce -L-500 /dev/vg21/lv21</code> \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0442\u043e\u043c\u0430 \u043d\u0430 500\u041c\u0431\u0430\u0439\u0442 <code>vgs</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u0441\u044f VFree 500m \u0434\u043b\u044f \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0434\u0440\u0443\u0433\u043e\u0439 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u0435</p> <p><code>resize2fs /dev/ubuntu-vg/ubuntu-lv 1G</code> \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0424\u0421 \u043d\u0430 500\u041c\u0431\u0430\u0439\u0442 <code>lvreduce -L-1000 /dev/ubuntu-vg/ubuntu-lv</code> \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0442\u043e\u043c\u0430 \u043d\u0430 1000\u041c\u0431\u0430\u0439\u0442 (Logical volume ubuntu-vg/ubuntu-lv successfully resized) <code>vgs</code> VFree 1000.00m</p> <ul> <li>\u0423\u0434\u0430\u043b\u0438\u0442\u044c</li> </ul> <p><code>umount /dev/vg21/lv21</code> \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u0442\u043c\u0430\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c <code>lvremove /dev/vg21/lv21</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0442\u043e\u043c <code>lvs</code> \u043d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f <code>vgs</code> VSize \u0438 VFree \u043e\u0431\u044a\u0451\u043c \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 <code>vgremove vg21</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0442\u043e\u043c\u043e\u0432 <code>pvremove /dev/sdb</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u0438\u0441\u043a sdb \u0438\u0437 LVM</p> <ul> <li>RAID 1</li> </ul> <p>\u041d\u043e\u0432\u044b\u0439 \u0434\u0438\u0441\u043a sdc \u0440\u0430\u0437\u0431\u0438\u0442\u044c \u043d\u0430 2 \u0440\u0430\u0437\u0434\u0435\u043b\u0430 (\u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 sdc1, \u043d\u0435\u043c\u043d\u043e\u0433\u043e \u0431\u043e\u043b\u044c\u0448\u0435 \u0447\u0435\u043c \u0443 \u0446\u0435\u043b\u0435\u0432\u043e\u0433\u043e \u0437\u0435\u0440\u043a\u0430\u043b\u0438\u0440\u0443\u0435\u043c\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0430 lv21 \u0438 sdc2 \u043e\u0441\u0442\u0430\u0432\u0448\u0438\u0439\u0441\u044f \u043e\u0431\u044a\u0435\u043c \u0434\u043b\u044f \u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u0430 \u0436\u0443\u0440\u043d\u0430\u043b\u0430) <code>pvcreate /dev/sdc1 /dev/sdc2</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0431\u0430 \u0440\u0430\u0437\u0434\u0435\u043b\u0430 \u0432 LVM <code>vgextend vg21 /dev/sdc1 /dev/sdc2</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0438\u043c\u0435\u044e\u0449\u0438\u044e\u0441\u044f \u0433\u0440\u0443\u043f\u043f\u0443 vg21 (\u0440\u0430\u0441\u0448\u0438\u0440\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 vg21) <code>vgs</code> \u0443 \u0433\u0440\u0443\u043f\u043f\u044b vg21 VFree \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u0441\u044f \u043e\u0431\u044a\u0451\u043c \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0442\u043e\u043c\u043e\u0432-\u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 <code>lvconvert -m1 /dev/vg21/lv21 /dev/sdb /dev/sdc1 /dev/sdc2</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u0443\u0435\u043c \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0442\u043e\u043c lv21, \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0432 \u0441\u043e\u0441\u0442\u0430\u0432 \u0433\u0440\u0443\u043f\u043f\u044b vg21 \u0432 \u0437\u0435\u0440\u043a\u0430\u043b\u0438\u0440\u0443\u0435\u043c\u044b\u0439 \u0442\u043e\u043c (-m1), \u0437\u0435\u0440\u043a\u0430\u043b\u0438\u0440\u0443\u0435\u0442\u0441\u044f /dev/sdb (\u0433\u0434\u0435 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f lv21) \u043d\u0430 sd\u04411, \u0430 /dev/sd\u04412 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u0430 \u0436\u0443\u0440\u043d\u0430\u043b\u0430.</p> <p><code>lvs -a -o +devices</code> \u0440\u0430\u0437\u0434\u0435\u043b lv21 \u043f\u0438\u0448\u0435\u0442 \u043d\u0430 2 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430</p> <pre><code>[lv21_rimage_0] /dev/sdb(0) # \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0442\u043e\u043c\n[lv21_rimage_1] /dev/sdc1(1) # \u0437\u0435\u0440\u043a\u0430\u043b\u043e\n</code></pre> <p><code>lsblk</code></p> <pre><code>sdb                     8:16    0    4G  0 disk\n+-vg21-lv21_rmeta_0    253:0    0    4M  0 lvm\n\u00a6 L-vg21-lv21          253:4    0    2G  0 lvm\nL-vg21-lv21_rimage_0   253:1    0    2G  0 lvm\n  L-vg21-lv21          253:4    0    2G  0 lvm\nsdc                     8:32    0    4G  0 disk\n+-sdc1                  8:33    0    3G  0 part\n\u00a6 +-vg21-lv21_rmeta_1  253:2    0    4M  0 lvm\n\u00a6 \u00a6 L-vg21-lv21        253:4    0    2G  0 lvm\n\u00a6 L-vg21-lv21_rimage_1 253:3    0    2G  0 lvm\n\u00a6   L-vg21-lv21        253:4    0    2G  0 lvm\n</code></pre> <p>\u0418\u0437\u0432\u043b\u0435\u043a\u0430\u0435\u043c (\u0443\u0434\u0430\u043b\u044f\u0435\u043c) <code>sdb</code> (\u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0434\u0438\u0441\u043a) <code>lsblk</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u0432\u0430 \u0440\u0430\u0437\u0434\u0435\u043b\u0430 (part) sdc1 \u0438 sdc2 \u0437\u0435\u0440\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430 \u0431\u0435\u0437 LVM, \u0442.\u043a. \u0433\u0440\u0443\u043f\u043f\u0430 \u043d\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u0430 \u041a\u043e\u043c\u0430\u043d\u0434\u043e\u0439 <code>lvs</code> \u0432\u0438\u0434\u0438\u043c \u0433\u0440\u0443\u043f\u043f\u0443 <code>vg21</code> \u0438 \u043e\u0448\u0438\u0431\u043a\u0438:</p> <pre><code>WARNING: Couldn't find device with uuid stBI99-6Qs3-B8lr-Ekaw-ahnD-oxPc-LsayLR.\nWARNING: VG vg21 is missing PV stBI99-6Qs3-B8lr-Ekaw-ahnD-oxPc-LsayLR (last written to /dev/sdb).\n</code></pre> <p><code>vgchange -ay vg21</code> \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 <code>mount /dev/vg21/lv21 /mnt/lv21</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 lv21</p> <ul> <li>Snapshot</li> </ul> <p><code>lvs</code> <code>lvcreate -L 1G -s -n snap-1 /dev/ubuntu-vg/ubuntu-lv</code> \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0443\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c VFree \u0432 Volume Group (Logical volume \"snap-1\" created) <code>lvcreate -L 1G -s -n snap-1 /dev/vg21/lv21</code> \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 -s \u043f\u043e\u043c\u0435\u0447\u0430\u0435\u0442, \u0447\u0442\u043e 1\u0413\u0431 \u0434\u0438\u0441\u043a\u043e\u0432\u043e\u0433\u043e \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0430 \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b vg21 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0434\u043b\u044f snapshot lv21  <code>lvs</code> Origin - \u043a \u043a\u0430\u043a\u043e\u043c\u0443 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u043c\u0443 \u0442\u043e\u043c\u0443 (lv) \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u044c\u0441\u044f snapshot, Data% \u2014 \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0438\u0441\u043f\u043e\u043b\u0437\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u043e\u0431\u044a\u0435\u043c\u0430 \u043e\u0442 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e. <code>lsblk</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0442\u043e\u043c\u0430\u0445 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 <code>mount /dev/vg21/snap-1 /mnt/snap</code> \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u0430 \u043c\u043e\u0436\u043d\u043e \u0441\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043a\u0430\u043a \u043e\u0431\u044b\u0447\u043d\u044b\u0439 \u0440\u0430\u0437\u0434\u0435\u043b, \u0435\u0441\u043b\u0438 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0432\u0430\u0440\u043e\u0442\u044c \u0441\u043d\u0430\u043f\u0448\u043e\u0442 \u0438 \u043e\u0442\u043a\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u043a \u043d\u0435\u043c\u0443, \u043c\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043c \u0442\u0435 \u0434\u0430\u043d\u043d\u044b\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043b\u0438 <code>lvconvert --merge /dev/vg21/snap-1</code> \u043e\u0442\u043a\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u0443 snap-1, \u043f\u043e\u043d\u0430\u0434\u043e\u0431\u0438\u0442\u0441\u044f \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u041e\u0421 (\u0434\u0430\u0436\u0435 \u0435\u0441\u043b\u0438 \u044d\u0442\u043e \u043d\u0435 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0434\u0438\u0441\u043a)</p> <ul> <li>Export/Import</li> </ul> <p><code>umount /dev/vg21/lv21</code> \u043e\u0442\u043c\u0430\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c <code>vgchange -an vg21</code> \u0434\u0435\u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0442\u043e\u043c\u043e\u0432 (0 logical volume \u0432 volume group \"vg21\") <code>vgexport vg21</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 (successfully exported) <code>pvdisplay</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f (VG Name vg21 (exported)) \u041f\u0435\u0440\u0435\u043d\u043e\u0441\u0438\u043c \u0434\u0438\u0441\u043a \u043d\u0430 \u043d\u043e\u0432\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440: <code>pvscan</code> \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u044b \u043d\u0430 \u043d\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 (PV /dev/sdb is in exported VG vg21) <code>vgimport vg21</code> \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 (successfully imported) <code>vgs \u0438 lvs</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u044b <code>vgchange -ay vg21</code> \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 (1+ lg \u0432 vg \"vg21\") <code>lsblk</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 LVM</p>"},{"location":"Linux/#md","title":"md","text":"<p>SOFT RAID</p> <p><code>mdadm --zero-superblock --force /dev/sd{b,c}</code> \u0437\u0430\u043d\u0443\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0441\u0443\u043f\u0435\u0440\u0431\u043b\u043e\u043a\u0438 \u043d\u0430 \u0434\u0438\u0441\u043a\u0430\u0445, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0432 RAID-\u043c\u0430\u0441\u0441\u0438\u0432, \u0442.\u043a. \u0434\u0438\u0441\u043a\u0438 \u043c\u043e\u0433\u0443\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0441\u043b\u0443\u0436\u0435\u0431\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0434\u0440\u0443\u0433\u0438\u0445 RAID (\u0432\u044b\u0432\u043e\u0434: unrecognised md component device - \u043d\u0438 \u043e\u0434\u0438\u043d \u0438\u0437 \u0434\u0438\u0441\u043a\u043e\u0432 \u0440\u0430\u043d\u0435\u0435 \u043d\u0435 \u0431\u044b\u043b \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0432 \u043c\u0430\u0441\u0441\u0438\u0432) <code>mdadm --create --verbose /dev/md0 -l 1 -n 2 /dev/sd{b,c}</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0435\u0440\u043a\u0430\u043b\u044c\u043d\u044b\u0439 RAID1 (-l/--leve 1) \u0438 \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043a\u043e\u043b-\u0432\u043e \u0434\u0438\u0441\u043a\u043e\u0432 (-n/--raid-devices) <code>mkfs.ext4 /dev/md0</code> \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 fs ext4 <code>mkdir /md0-sdb-sdc-raid1</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u0434\u043b\u044f \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f <code>mount /dev/md0 /md0-sdb-sdc-raid1</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0440\u0443\u0447\u043d\u0443\u044e <code>lsblk -o NAME,UUID | grep md*</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c UUID \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 <code>echo \"UUID=20482c47-fa11-462d-b7b8-93a342a7edf8 /md0-sdb-sdc-raid1 ext4 defaults 1 2\" &gt;&gt; /etc/fstab</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0430\u0432\u0442\u043e\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443 \u043f\u043e UUID, \u0442.\u043a. \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u041e\u0421 \u043d\u043e\u043c\u0435\u0440 \u043c\u043e\u0436\u0435\u0442 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c\u0441\u044f \u043d\u0430 md127 <code>mount -a</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u043e\u0432\u044b\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0438\u0437 fstab <code>cat /proc/mdstat</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 RAID-\u043c\u0430\u0441\u0441\u0438\u0432\u043e\u0432: md127 : active raid1 sdc[1] sdb[0] <code>mdadm -D /dev/md127</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0435 (--detail) \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043c\u0430\u0441\u0441\u0438\u0432\u0430. State: cleane (\u043f\u0440\u043e\u0431\u043b\u0435\u043c \u043d\u0435\u0442)/degraded (\u0434\u0438\u0441\u043a \u043d\u0435\u0438\u0441\u043f\u0440\u0430\u0432\u0435\u043d/\u043f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d). Active/Working/Failed/Spare Devices - \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 (\u0432 \u0440\u0430\u0431\u043e\u0442\u0435)/\u0440\u0430\u0431\u043e\u0447\u0438\u0445/\u043d\u0435\u0440\u0430\u0431\u043e\u0447\u0438\u0445/\u0437\u0430\u043f\u0430\u0441\u043d\u044b\u0445 \u0434\u0438\u0441\u043a\u043e\u0432 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435. Consistency Policy - \u0442\u0438\u043f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0441\u043b\u0435 \u0441\u0431\u043e\u044f \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435 (resync - \u043f\u043e\u043b\u043d\u0430\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u043e\u0441\u043b\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043c\u0430\u0441\u0441\u0438\u0432\u0430). <code>mdadm /dev/md127 --add /dev/sdd</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043f\u0430\u0441\u043d\u043e\u0439 \u0434\u0438\u0441\u043a (\u0432 Spare Device) \u0434\u043b\u044f \u0433\u043e\u0440\u0447\u0435\u0439 \u0437\u0430\u043c\u0435\u043d\u044b (Hot-Spare), \u0432 \u0441\u0442\u0430\u0442\u0443\u0441\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0434\u0438\u0441\u043a\u043e\u0432 \u0431\u0443\u0434\u0435\u0442 \u0443\u043a\u0430\u0437\u0430\u043d \u043a\u0430\u043a\u043e\u0439 \u0434\u0438\u0441\u043a (State - spare /dev/sdd) <code>mdadm -G /dev/md127 \u2014raid-devices=3</code> \u0440\u0430\u0441\u0448\u0438\u0440\u0438\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432 \u0434\u043e \u0442\u0440\u0435\u0445 \u0434\u0438\u0441\u043a\u043e\u0432 (\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u0441\u044f \u0438\u0437 \u0437\u0430\u043f\u0430\u0441\u043d\u044b\u0445 \u0434\u0438\u0441\u043a\u043e\u0432 \u0432 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432) <code>mdadm /dev/md127 --fail /dev/sdb</code> \u043f\u043e\u043c\u0435\u0442\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0447\u0438\u0439 \u0434\u0438\u0441\u043a \u043a\u0430\u043a \u043d\u0435\u0440\u0430\u0431\u043e\u0447\u0438\u0439 (\u043f\u0435\u0440\u0435\u0432\u0435\u0441\u0442\u0438 \u0434\u0438\u0441\u043a \u0432 Failed Device) \u0434\u043b\u044f \u0437\u0430\u043c\u0435\u043d\u044b \u043d\u0430 \u0437\u0430\u043f\u0430\u0441\u043d\u043e\u0439 \u0438\u0437 Spare Device, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0430\u0447\u043d\u0435\u0442 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044e \u0434\u043b\u044f \u0432\u0432\u043e\u0434\u0430 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432 (Rebuild Status : 50% complete) <code>mdadm /dev/md127 --remove /dev/sdb</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043d\u0435\u0440\u0430\u0431\u043e\u0447\u0438\u0439 \u0434\u0438\u0441\u043a \u0438\u0437 \u043c\u0430\u0441\u0441\u0438\u0432\u0430 <code>mdadm --stop /dev/md127</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c/\u0440\u0430\u0437\u043e\u0431\u0440\u0430\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432 (\u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e umount /md0-sdb-sdc-raid1). \u0412 \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u043e\u0434\u0438\u043d \u0438\u0437 \u0434\u0432\u0443\u0445 \u0434\u0438\u0441\u043a\u043e\u0432 \u0431\u044b\u043b \u0438\u0437\u0432\u043b\u0435\u0447\u0435\u043d \u0438 \u043d\u0435 \u0431\u044b\u043b\u043e \u0437\u0430\u043f\u0430\u0441\u043d\u044b\u0445 \u0434\u0438\u0441\u043a\u043e\u0432, \u043c\u0430\u0441\u0441\u0438\u0432 \u0431\u0443\u0434\u0435\u0442 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 (State : inactive) <code>mdadm --assemble --scan --verbose</code> \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u043f\u0440\u043e\u0441\u043a\u0430\u043d\u0438\u0440\u0443\u0435\u0442 \u0432\u0441\u0435 \u0434\u0438\u0441\u043a\u0438 \u043d\u0430 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u0440\u0430\u0437\u043e\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e/\u0440\u0430\u0437\u0432\u0430\u043b\u0438\u0432\u0448\u0435\u0433\u043e\u0441\u044f RAID-\u043c\u0430\u0441\u0441\u0438\u0432\u0430 \u0438 \u0441\u0430\u043c\u043e\u0441\u0442\u043e\u044f\u0442\u0435\u043b\u044c\u043d\u043e (\u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438) \u043f\u043e\u043f\u044b\u0442\u0430\u0435\u0442\u0441\u044f \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u0437 \u043d\u0438\u0445 \u043c\u0430\u0441\u0441\u0438\u0432 \u0441 \u0438\u0437\u043d\u0430\u0447\u0430\u043b\u044c\u043d\u044b\u043c \u0438\u043c\u0435\u043d\u0435\u043c (mdadm -D /dev/md0) <code>mdadm --stop /dev/md127 &amp;&amp; mdadm --assemble --scan &amp;&amp; mount -a &amp;&amp; mdadm -D /dev/md0</code> \u0435\u0441\u043b\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u043e\u0441\u0442\u0430\u043b\u0441\u044f \u043e\u0434\u0438\u043d \u0434\u0438\u0441\u043a (\u0432\u0442\u043e\u0440\u043e\u0439 \u0438\u0437\u0432\u043b\u0435\u0447\u0435\u043d), RAID-\u043c\u0430\u0441\u0441\u0438\u0432 \u0431\u0443\u0434\u0435\u0442 \u0432\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d (\u043f\u0435\u0440\u0435\u0441\u043e\u0431\u0440\u0430\u043d) \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0438\u0437 \u043e\u0434\u043d\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430 \u0441 \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u043c: clean, degraded, \u043c\u043e\u0436\u043d\u043e \u0441\u0440\u0430\u0437\u0443 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0434\u0438\u0441\u043a \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 <code>mdadm --assemble /dev/md127 /dev/sdb /dev/sdc</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0438\u0437 \u043a\u0430\u043a\u0438\u0445 \u0434\u0438\u0441\u043a\u043e\u0432 \u043f\u0435\u0440\u0435\u0441\u043e\u0431\u0440\u0430\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432 <code>echo 'check' &gt; /sys/block/md127/md/sync_action</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435 (mdadm -D /dev/md0 - Check Status : 80% complete) <code>cat /sys/block/md127/md/mismatch_cnt</code> \u0432\u044b\u0432\u043e\u0434 \u0444\u0430\u0439\u043b\u0430 (0 - \u0432\u0441\u0435 \u0432\u043f\u043e\u0440\u044f\u0434\u043a\u0435) <code>echo 'idle' &gt; /sys/block/md127/md/sync_action</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443</p>"},{"location":"Linux/#tgt","title":"tgt","text":"<p>iSCSI</p> <p><code>apt install tgt</code> \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u0430\u044f \u0447\u0430\u0441\u0442\u044c \u043d\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u0440\u0442\u0430\u043b\u043e\u043c, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0446\u0435\u043b\u0438 (Target), \u043a\u0430\u0436\u0434\u0430\u044f \u0438\u0437 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0443 - \u0438\u043d\u0438\u0446\u0438\u0430\u0442\u043e\u0440\u0443 (Initiator) \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0431\u043b\u043e\u0447\u043d\u044b\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430\u043c. <code>dd if=/dev/zero of=/storage/disk1.img bs=1 count=0 seek=200G</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430 (\u0440\u0430\u0437\u0440\u0435\u0436\u0435\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b) \u0441 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u043c \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c 200 \u0413\u0411, \u0433\u0434\u0435 \u0432\u043c\u0435\u0441\u0442\u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u043d\u0443\u043b\u0435\u0439 \u043d\u0430 \u0434\u0438\u0441\u043a\u0435 \u0445\u0440\u0430\u043d\u044f\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u044d\u0442\u0438\u0445 \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044f\u0445 \u0432 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 <code>dd if=/dev/zero of=/storage/disk1.img bs=1M count=2048</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0434\u0438\u0441\u043a <code>cp --sparse=always filename newfilename</code> \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u044b\u0447\u043d\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 \u0432 \u0440\u0430\u0437\u0440\u0435\u0436\u0435\u043d\u043d\u044b\u0439 <code>nano /etc/tgt/targets.conf</code> <code>nano /etc/tgt/conf.d/disk-1.conf</code></p> <pre><code>&lt;target iqn.2023-10.local.domain:ubuntu-target&gt; \n   backing-store /storage/disk1.img \n   initiator-address 192.168.3.101\n   incominguser user password1212\n&lt;/target&gt;\n</code></pre> <p><code>systemctl restart tgt</code> <code>tgtadm --mode target --op show</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442 \u0432\u0441\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0435 \u0446\u0435\u043b\u0438 \u0438 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u0435 \u0438\u043c\u0438 \u0431\u043b\u043e\u0447\u043d\u044b\u0435 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430.</p>"},{"location":"Linux/#dd","title":"dd","text":"<p><code>dd if=/dev/sr0 of=/tmp/cd.iso bs=2048</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043e\u0431\u0440\u0430\u0437 \u0434\u0438\u0441\u043a\u0430 (if=\u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a) \u0432 \u0444\u0430\u0439\u043b (of=\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435) \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u043a\u043e\u043b-\u0432\u0430 \u0431\u0430\u0439\u0442 \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f \u0438 \u0437\u0430\u043f\u0438\u0441\u0438 \u0437\u0430 \u043e\u0434\u0438\u043d \u0440\u0430\u0437 (2\u041c\u0411\u0430\u0439\u0442), \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0440\u0430\u0437\u043c\u0435\u0440 \u0431\u043b\u043e\u043a\u0430 - 512 \u0431\u0430\u0439\u0442 (2b \u0431\u043b\u043e\u043a\u0430 = 1024 \u0431\u0430\u0439\u0442, 1k = 1 \u041a\u0411\u0430\u0439\u0442/1024 \u0431\u0430\u0439\u0442, 1kB = 1000 \u0431\u0430\u0439\u0442, 1M = 1024 \u041a\u0411\u0430\u0439\u0442/1 \u041c\u0411\u0430\u0439\u0442) <code>dd if=/dev/mem bs=2048 count=100</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 \u043d\u0430 \u044d\u043a\u0440\u0430\u043d (\u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0444\u0430\u0439\u043b) <code>dd if=/dev/zero of=/tmp/md-01 bs=4M count=256</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0439 \u043d\u0443\u043b\u044f\u043c\u0438 (\u0438\u0437 /dev/zero) \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c 1\u0413\u0411 \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u043a\u043e\u043b-\u0432\u043e \u043a\u043e\u043f\u0438\u0440\u0443\u0435\u043c\u044b\u0445 \u0431\u043b\u043e\u043a\u043e\u0432 (bs*count) \u0438\u043b\u0438 \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0434\u0438\u0441\u043a <code>dd if=/dev/random of=/tmp/md-02 bs=4M count=256</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c 1\u0413\u0411 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0439 \u0440\u0430\u043d\u0434\u043e\u043c\u043d\u044b\u043c\u0438 \u0446\u0438\u0444\u0440\u0430\u043c\u0438 <code>dd if=/dev/sda of=/tmp/mbr.img bs=1b count=1</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0444\u0430\u0439\u043b \u043f\u0435\u0440\u0432\u044b\u0435 512 \u0431\u0430\u0439\u0442 \u0434\u0438\u0441\u043a\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0438\u0435 \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 MBR <code>dd if=/dev/sda of=/tmp/sda.img</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0437 \u0436\u0435\u0441\u0442\u043a\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0430\u0441\u044f \u0434\u043b\u044f \u043f\u043e\u043b\u043d\u043e\u0433\u043e backup \u0441\u0438\u0441\u0442\u0435\u043c\u044b (\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u0430 \u043d\u0430 \u0434\u0432\u043e\u0438\u0447\u043d\u043e\u043c \u0443\u0440\u043e\u0432\u043d\u0435,\u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0443 MBR \u0438 \u0432\u0441\u044e \u043f\u0443\u0441\u0442\u0443\u044e \u043e\u0431\u043b\u0430\u0441\u0442\u044c \u0434\u0438\u0441\u043a\u0430 \u0438 \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432)</p>"},{"location":"Linux/#backup","title":"backup","text":"<ul> <li>\u0421\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u043d\u0435\u0448\u043d\u0438\u0439 \u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043e\u0431\u0440\u0430\u0437\u0430: <code>mount /dev/sdb1 /mnt/disk_b</code></li> <li><code>dd if=/dev/sda of=/mnt/disk_b/disk.img bs=5M</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0437\u0430 \u0434\u0438\u0441\u043a\u0430 (.img) # \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u043e\u0431\u0440\u0430\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b</li> <li>\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0434\u0438\u0441\u043a \u0434\u043b\u044f \u0437\u0430\u043f\u0438\u0441\u0438 \u043e\u0431\u0440\u0430\u0437\u0430 \u043d\u0430 \u0434\u0438\u0441\u043a (<code>sdc</code>)</li> <li><code>dd if=/mnt/disk_b/disk.img of=/dev/sdc bs=5M</code> \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0437 \u043d\u0430 \u0434\u0438\u0441\u043a (\u0441 sdb1 \u043d\u0430 sdc):</li> <li>\u0418\u0437\u0432\u043b\u0435\u0447\u044c \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0416\u0414 \u0438\u043b\u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0434\u0438\u0441\u043a sda (\u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0439) \u0438 <code>sdb</code> (\u0441 \u0437\u0430\u043f\u0438\u0441\u044c\u044e \u043e\u0431\u0440\u0430\u0437\u0430). \u0414\u0438\u0441\u043a <code>sdc</code> \u0441 \u043a\u043e\u043f\u0438\u0435\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u0434\u0438\u0441\u043a <code>sda</code> \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</li> <li><code>gzip disk.img</code> \u0441\u0436\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0437 (\u0432\u0441\u0435 \u043d\u0443\u043b\u0438 \u0441\u043e\u0436\u043c\u0443\u0442\u0441\u044f \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e - \u0443\u0434\u043e\u0431\u043d\u043e \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f backup, \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e .img) <code>dd if=/dev/sda conv=sync,noerror bs=5M | gzip -c  &gt; /mnt/disk_b/disk.img.gz</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0436\u0430\u0442\u044b\u0439 \u043e\u0431\u0440\u0430\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b <code>gunzip -c /mnt/disk_b/disk.img.gz | dd of=/dev/sd\u0441</code> \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043e\u0431\u0440\u0430\u0437 \u043d\u0430 \u0434\u0438\u0441\u043a</li> </ul> <p><code>nc -lp 5000 | sudo dd of=/backup/sda.img.gz</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0441\u0436\u0430\u0442\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 \u043e\u0431\u0440\u0430\u0437\u0430 \u0436\u0435\u0441\u0442\u043a\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430 sdb \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0435 (\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e\u0449\u0430\u044f \u0441\u0442\u043e\u0440\u043e\u043d\u0430) <code>dd if=/dev/sda | gzip -c | nc 192.168.21.121 5000</code> \u043d\u0430 \u0443\u0437\u043b\u0435, \u0443 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u0436\u0435\u0441\u0442\u043a\u0438\u0439 \u0434\u0438\u0441\u043a (\u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0449\u0430\u044f \u0441\u0442\u043e\u0440\u043e\u043d\u0430) <code>nc -lp 5000 | gunzip -c | sudo dd of=/dev/sdb</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0436\u0435\u0441\u0442\u043a\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430 \u0438\u0437 \u0441\u0436\u0430\u0442\u043e\u0433\u043e \u043e\u0431\u0440\u0430\u0437\u0430 (\u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c \u043d\u0435 \u043d\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0439 \u0434\u0438\u0441\u043a), \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u043c \u0443\u0437\u043b\u0435 (\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e\u0449\u0430\u044f \u0441\u0442\u043e\u0440\u043e\u043d\u0430) <code>cat /backup/sda.img.gz | nc my_local_host.com 5000</code> \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0435, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d \u0444\u0430\u0439\u043b \u043e\u0431\u0440\u0430\u0437\u0430 \u0436\u0435\u0441\u0442\u043a\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0430 (\u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0449\u0430\u044f \u0441\u0442\u043e\u0440\u043e\u043d\u0430)</p>"},{"location":"Linux/#iso","title":"iso","text":"<p><code>dd if=/dev/sda3 status=progress of=/mnt/disk_b/disk.iso bs=5M</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c iso-\u043e\u0431\u0440\u0430\u0437 (\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043e\u0431\u0440\u0430\u0437 \u0440\u0430\u0437\u0434\u0435\u043b) <code>dd if=\u043f\u0443\u0442\u044c/\u043a/\u043e\u0431\u0440\u0430\u0437\u0443.iso of=/dev/sdb1</code> \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c ISO-\u043e\u0431\u0440\u0430\u0437 \u041e\u0421 \u043d\u0430 \u0432\u043d\u0435\u0448\u043d\u0435\u0435 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e <code>sync</code> \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c \u044d\u0442\u043e\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u043e\u0439 (\u0447\u0442\u043e \u0431\u044b \u043f\u0440\u0438 \u0438\u0437\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u0438 \u043d\u0435 \u043f\u043e\u0442\u0435\u0440\u044f\u0442\u044c \u0447\u0430\u0441\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0445) <code>mount -o loop /mnt/disk_b/disk.iso /mnt/iso</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u043e\u0431\u0440\u0430\u0437\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f (iso - \u044d\u0442\u043e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0443\u0436\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u044c), \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u043a /dev/loop6 <code>umount /mnt/iso</code> \u043e\u0442\u043c\u0430\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c</p>"},{"location":"Linux/#rdiff","title":"rdiff","text":"<p><code>apt install rdiff-backup</code> \u043d\u0430 \u0431\u0430\u0437\u0435 rsync \u0441 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u043e\u0439 \u0438\u043d\u043a\u0440\u0435\u043c\u0435\u043d\u0442\u043d\u044b\u0445 \u0430\u0440\u0445\u0438\u0432\u043e\u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u044e hard link, \u0447\u0442\u043e\u0431\u044b \u0432\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043d\u0430\u0437\u0430\u0434 \u043d\u0430 \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u0439 \u0434\u0435\u043d\u044c <code>rdiff-backup /usr/lifailon/ /backup/test/</code> <code>rdiff-backup user@hostname::/remote-dir local-dir -v5 --print-statistics</code> \u043f\u043e ssh \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u00a0\u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0431\u044d\u043a\u0430\u043f-\u0441\u0435\u0440\u0432\u0435\u0440, \u0432 \u043d\u0435\u0439 \u0436\u0435 \u0431\u0443\u0434\u0435\u0442 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f rdiff-backup-data, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0431\u0443\u0434\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u0438 \u043b\u043e\u0433\u0438 \u043e \u043f\u0440\u043e\u0432\u043e\u0434\u0438\u043c\u044b\u0445 \u0431\u044d\u043a\u0430\u043f\u0430\u0445, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0438\u043d\u043a\u0440\u0435\u043c\u0435\u043d\u0442\u044b, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0434\u043b\u044f \u043e\u0442\u043a\u0430\u0442\u0430 \u043d\u0430 \u043b\u044e\u0431\u043e\u0439 \u043f\u0440\u043e\u0448\u043b\u044b\u0439 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0439 \u0431\u044d\u043a\u0430\u043f <code>rdiff-backup list files --changed-since 5D local-dir</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c, \u043a\u0430\u043a\u0438\u0435 \u0444\u0430\u0439\u043b\u044b \u0438\u0437\u043c\u0435\u043d\u0438\u043b\u0438\u0441\u044c \u0437\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 5 \u0434\u043d\u0435\u0439 <code>rdiff-backup list files --at 5D local-dir</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u0430\u0439\u043b\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u043b\u0438 \u0432 \u0430\u0440\u0445\u0438\u0432\u0435 5 \u0434\u043d\u0435\u0439 \u043d\u0430\u0437\u0430\u0434 <code>rdiff-backup restore local-dir/rdiff-backup-data/increments.2023-10-29T21:03:37+03:00.dir /tmp/restore</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0444\u0430\u0439\u043b\u044b \u0438\u0437 \u0438\u043d\u043a\u0440\u0438\u043c\u0435\u043d\u0442\u0430</p>"},{"location":"Linux/#users","title":"users","text":"<p><code>sudo -u www-data</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u043e\u0442 \u0438\u043c\u0435\u043d\u0438 \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>su root</code> \u0432\u043e\u0439\u0442\u0438 \u043f\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c root <code>sudo su</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043d\u0430 root, \u043f\u0440\u0438 \u044d\u0442\u043e\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043e\u0441\u0442\u0430\u0435\u0442\u0441\u044f \u0432 \u0442\u043e\u0439 \u0436\u0435 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u043f\u043e\u0442\u043e\u043c\u0443, \u0447\u0442\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0432\u0430\u0448 .bashrc. \u0410 \u0442\u0430\u043a\u0436\u0435 .profile \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f root \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0432\u044b \u043e\u043a\u0430\u0436\u0435\u0442\u0435\u0441\u044c \u0432 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0438 root <code>sudo -i</code> \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0443\u0442\u0438\u043b\u0438\u0442\u0435 \u0447\u0442\u043e \u043d\u0443\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c \u043e\u0442 \u0438\u043c\u0435\u043d\u0438 root, \u043f\u0440\u0438 \u044d\u0442\u043e\u043c \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0430\u044f\u0441\u044c \u0432 \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 root, \u0438 \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d \u0435\u0433\u043e .bashrc \u0438 .profile <code>sudo /bin/bash</code> \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0435\u0449\u0435 \u043e\u0434\u043d\u0443 \u043e\u0431\u043e\u043b\u043e\u0447\u043a\u0443 bash \u043e\u0442 \u0438\u043c\u0435\u043d\u0438 \u0441\u0443\u043f\u0435\u0440\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u0424\u0430\u0439\u043b\u044b \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u043d\u0435 \u0447\u0438\u0442\u0430\u044e\u0442\u0441\u044f, \u043d\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e .bashrc \u0432\u0430\u0448\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \u0412\u044b \u043d\u0435 \u043e\u043a\u0430\u0436\u0435\u0442\u0435\u0441\u044c \u0432 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0438 root, \u0430 \u043f\u0440\u043e\u0441\u0442\u043e \u043e\u0441\u0442\u0430\u043d\u0435\u0442\u0435\u0441\u044c \u0432 \u0441\u0432\u043e\u0435\u043c \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0438 \u0441 \u043f\u0440\u0430\u0432\u0430\u043c\u0438 \u0441\u0443\u043f\u0435\u0440\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</p> <p><code>cat /etc/passwd</code> \u0441\u043f\u0438\u0441\u043e\u043a/\u0431\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 <code>cat /etc/group</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f <code>cat /etc/shadow | grep -Ev \"^.+:\\*:\"</code> \u043f\u0430\u0440\u043e\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0445\u0440\u0430\u043d\u044f\u0449\u0438\u0435\u0441\u044f \u0432 \u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u043c \u0432\u0438\u0434\u0435 (\u0437\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e /usr/bin/passwd), \u0435\u0441\u043b\u0438 * \u0438\u043b\u0438 ! \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0441\u043c\u043e\u0436\u0435\u0442 \u0432\u043e\u0439\u0442\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043f\u043e \u043f\u0430\u0440\u043e\u043b\u044e, \u0434\u0440\u0443\u0433\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u044b \u0432\u0445\u043e\u0434\u0430, \u043a\u0430\u043a \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043a\u043b\u044e\u0447\u0435\u0439 \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u044b. \u0421\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0441: \u043b\u043e\u0433\u0438\u043d:\u043f\u0430\u0440\u043e\u043b\u044c:\u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043f\u0430\u0440\u043e\u043b\u044f (\u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043d\u0435\u0439 \u0438\u0441\u0447\u0438\u0441\u043b\u044f\u0435\u0442\u0441\u044f \u0441 1 \u044f\u043d\u0432\u0430\u0440\u044f 1970 \u0433\u043e\u0434\u0430):\u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0440\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u0430\u0440\u043e\u043b\u044f:\u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0440\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f:\u043f\u0435\u0440\u0438\u043e\u0434 \u043f\u0440\u0435\u0434\u0443\u043f\u0440\u0435\u0436\u0434\u0435\u043d\u0438\u044f:\u043f\u0435\u0440\u0438\u043e\u0434 \u0431\u0435\u0437\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f:\u0441\u0440\u043e\u043a \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f</p> <p><code>cat /etc/login.defs | grep -Pv \"^$|^#\"</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0443\u0442\u0438\u043b\u0438\u0442\u044b \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438 \u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u0432\u0445\u043e\u0434\u0430 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 (\u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0438 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e id \u0434\u043b\u044f \u0432\u044b\u0434\u0430\u0447\u0438 \u043d\u043e\u0432\u043e\u043c\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e/\u0433\u0440\u0443\u043f\u043f\u0435, \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u043f\u044b\u0442\u043e\u043a \u0432\u0445\u043e\u0434\u0430, \u0442\u0430\u0439\u043c\u0430\u0443, \u0447\u0442\u043e \u0434\u0435\u043b\u0430\u0442\u044c \u0441 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0438\u043b\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u0438 \u0442.\u043f.) <code>cat /etc/login.defs | grep \"^PASS\"</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b-\u0432\u043e \u0434\u043d\u0435\u0439 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u0430\u0440\u043e\u043b\u044f (PASS_MAX_DAYS), \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043d\u0435\u0439 \u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u043c\u0435\u0436\u0434\u0443 \u0441\u043c\u0435\u043d\u0430\u043c\u0438 \u043f\u0430\u0440\u043e\u043b\u044f (PASS_MIN_DAYS), \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043d\u0435\u0439 \u043f\u0440\u0435\u0434\u0443\u043f\u0440\u0435\u0436\u0434\u0430\u044e\u0449\u0438\u0445 \u043e\u0431 \u0438\u0441\u0442\u0435\u0447\u0435\u043d\u0438\u0438 \u0441\u0440\u043e\u043a\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u0430\u0440\u043e\u043b\u044f (PASS_WARN_AGE), \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u0438\u043d\u044b \u043f\u0430\u0440\u043e\u043b\u0435\u0439 (PASS_MIN_LEN/PASS_MAX_LEN), \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b-\u0432\u043e \u043f\u043e\u043f\u044b\u0442\u043e\u043a \u0432\u0445\u043e\u0434\u0430 \u043f\u0440\u0438 \u0432\u0432\u043e\u0434\u0435 \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0430\u0440\u043e\u043b\u044f (LOGIN_RETRIES), \u0432\u0440\u0435\u043c\u044f \u043d\u0430 \u0432\u0445\u043e\u0434 (LOGIN_TIMEOUT), \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0445 \u0432\u0445\u043e\u0434\u043e\u0432 (LOG_OK_LOGINS), \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0435\u0438\u0437\u0432\u0435\u0442\u043d\u044b\u0445 \u0438\u043c\u0435\u043d \u0434\u043b\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u0440\u0438 \u043d\u0435\u0443\u0434\u0430\u0447\u043d\u044b\u0445 \u043f\u043e\u043f\u044b\u0442\u043a\u0430\u0445 \u0432\u0445\u043e\u0434\u0430 (LOG_UNKFAIL_ENAB)</p>"},{"location":"Linux/#passwd","title":"passwd","text":"<p><code>passwd</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0443\u0447\u0435\u0442\u043d\u0443\u044e \u0437\u0430\u043f\u0438\u0441\u044c root \u0438 \u0437\u0430\u0434\u0430\u0442\u044c \u0435\u0439 \u043f\u0430\u0440\u043e\u043b\u044c <code>passwd username</code> \u0441\u043c\u0435\u043d\u0430 \u043f\u0430\u0440\u043e\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>passwd -l username</code> \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0443\u0447. \u0437\u0430\u043f\u0438\u0441\u044c <code>passwd -u username</code> \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0443\u0447. \u0437\u0430\u043f\u0438\u0441\u044c</p>"},{"location":"Linux/#chage","title":"chage","text":"<p><code>chage -l root</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0441\u043c\u0435\u043d\u0435 \u043f\u0430\u0440\u043e\u043b\u044f \u0438 \u0441\u0440\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f (\u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0441\u043c\u0435\u043d\u0430 \u043f\u0430\u0440\u043e\u043b\u044f, \u0421\u0440\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u0430\u0440\u043e\u043b\u044f, \u041f\u0430\u0440\u043e\u043b\u044c \u043d\u0435\u0430\u043a\u0442\u0438\u0432\u0435\u043d, \u0421\u0440\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438, \u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043d\u0435\u0439 \u043c\u0435\u0436\u0434\u0443 \u0441\u043c\u0435\u043d\u043e\u0439 \u043f\u0430\u0440\u043e\u043b\u044f, \u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043d\u0435\u0439 \u043c\u0435\u0436\u0434\u0443 \u0441\u043c\u0435\u043d\u043e\u0439 \u043f\u0430\u0440\u043e\u043b\u044f, \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043d\u0435\u0439 \u043f\u0440\u0435\u0434\u0443\u043f\u0440\u0435\u0436\u0434\u0435\u043d\u0438\u044f \u0434\u043e \u0438\u0441\u0442\u0435\u0447\u0435\u043d\u0438\u044f \u0441\u0440\u043e\u043a\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u0430\u0440\u043e\u043b\u044f) <code>chage -E lifailon</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0430\u0442\u0443 \u0438\u0441\u0442\u0435\u0447\u0435\u043d\u0438\u044f \u0441\u0440\u043e\u043a\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0439 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 (-E) <code>chage lifailon -M 30</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e (-m) \u0438 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e (-M) \u0441\u0440\u043e\u043a\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u0430\u0440\u043e\u043b\u044f</p>"},{"location":"Linux/#id","title":"id","text":"<p><code>id lifailon</code> \u0443\u0437\u043d\u0430\u0442\u044c ID <code>uid=1000(lifailon) gid=1000(lifailon) groups=1000(lifailon),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),116(lxd)</code> <code>usermod -u 1022 kup</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c UID <code>groupmod -g 1022 kup</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c GID</p>"},{"location":"Linux/#usermod","title":"usermod","text":"<p><code>usermod -L lifailon</code> \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0445\u043e\u0434 \u043f\u043e \u043f\u0430\u0440\u043e\u043b\u044e (\u043f\u0435\u0440\u0435\u0434 \u043f\u0430\u0440\u043e\u043b\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0444\u0430\u0439\u043b\u0435 /etc/shadow \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432\u043e\u0441\u043a\u043b\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0437\u043d\u0430\u043a) <code>usermod --expiredate 1 -L lifailon</code> \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0447\u0435\u0440\u0435\u0437 su: Authentication failure) <code>usermod --expiredate 2023-10-25 lifailon</code> \u0437\u0430\u0434\u0430\u0442\u044c \u0434\u0430\u0442\u0443 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438 <code>usermod --expiredate \"\" -U lifailon</code> \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>usermod -g root lifailon</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043e\u0441\u043d\u043e\u0432\u043d\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>usermod -a -G plugdev lifailon</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443 (-G), \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0443\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 -a, \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u0441\u0442\u0430\u0440\u044b\u0435 <code>usermod -d /root lifailon</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u043e\u043c\u0430\u0448\u043d\u044e\u044e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (-d) <code>usermod -m -d /root lifailon</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0434\u043e\u043c\u0430\u0448\u043d\u044e\u044e \u043f\u0430\u043f\u043a\u0443 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0432 \u0432\u0441\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 (-m) <code>usermod -s /usr/bin/dash lifailon</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043e\u0431\u043e\u043b\u043e\u0447\u043a\u0443 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e (-s) <code>usermod -u 2002 lifailon</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c id \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (-u) <code>usermod -l lifailon failon</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (-l) <code>usermod --password \"NewPassword\" lifailon</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c</p>"},{"location":"Linux/#profile","title":"profile","text":"<p><code>nano /etc/bash.bashrc</code> \u0437\u0430\u0434\u0430\u0442\u044c timeout \u0434\u043b\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0431\u0435\u0437\u0434\u0435\u0439\u0441\u0442\u0443\u044e\u0449\u0438\u0445 (idle time) SSH \u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u0441\u0435\u0441\u0441\u0438\u0439 <code>nano /etc/profile</code> \u0437\u0430\u0434\u0430\u0442\u044c \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044f (\u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 \u043d\u0438\u0436\u0435)</p> <pre><code>TMOUT=1440\nreadonly TMOUT\nexport TMOUT\n</code></pre>"},{"location":"Linux/#bashrc","title":"bashrc","text":"<p><code>.bashrc</code> \u0444\u0430\u0439\u043b \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>.bash_profile</code> \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0432\u0441\u0442\u0443\u043f\u0430\u044e\u0442 \u0432 \u0441\u0438\u043b\u0443 \u043a\u0430\u0436\u0434\u044b\u0439 \u0440\u0430\u0437 \u043a\u043e\u0433\u0434\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e \u043f\u043e SSH. \u0415\u0441\u043b\u0438 \u044d\u0442\u043e\u0442 \u0444\u0430\u0439\u043b \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043a\u0430\u0442\u044c .bash_login \u0438\u043b\u0438 .profile <code>/etc/environment</code> \u0444\u0430\u0439\u043b \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f, \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u043a\u0438\u0445-\u043b\u0438\u0431\u043e \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u043c \u0443\u0440\u043e\u0432\u043d\u0435. \u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f, \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u044d\u0442\u043e\u043c \u0444\u0430\u0439\u043b\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0434\u043b\u044f \u0432\u0441\u0435\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b, \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 \u0434\u0430\u0436\u0435 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438. <code>/etc/bash.bashrc</code> \u0444\u0430\u0439\u043b \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043a\u0430\u0436\u0434\u044b\u0439 \u0440\u0430\u0437 \u043a\u043e\u0433\u0434\u0430 \u043e\u043d \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043d\u043e\u0432\u0443\u044e \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0435\u0441\u0441\u0438\u044e. \u042d\u0442\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043f\u0440\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u0447\u0435\u0440\u0435\u0437 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442, \u0442\u0430\u043a\u0438\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043d\u0435 \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b. <code>/etc/profile</code> \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b profile, \u0432\u0441\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0438\u0437 \u044d\u0442\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u043b\u044e\u0431\u043e\u043c\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435, \u0442\u043e\u043b\u044c\u043a\u043e \u0435\u0441\u043b\u0438 \u043e\u043d \u0432\u043e\u0448\u0435\u043b \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e. \u041d\u043e \u043e\u043d\u0438 \u043d\u0435 \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b, \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0441\u0441\u0438\u0438, \u0442\u043e \u0435\u0441\u0442\u044c \u0435\u0441\u043b\u0438 \u0432\u044b \u043f\u0440\u043e\u0441\u0442\u043e \u043e\u0442\u043a\u0440\u043e\u0435\u0442\u0435 \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b.</p>"},{"location":"Linux/#useradd","title":"useradd","text":"<p><code>useradd -D</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u044b \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e <code>useradd -o -u 0 -g 0 -s /bin/bash newroot</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u043f\u0440\u0430\u0432\u0430\u043c\u0438 root <code>useradd -G adm,wheel -p password -s /bin/bash test2</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u0447\u0438\u0442\u0430\u0442\u044c \u043b\u043e\u0433\u0438 \u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f sudo</p> <p><code>useradd username</code> <code>-s</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u0443\u044e \u043e\u0431\u043e\u043b\u043e\u0447\u043a\u0443 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e /bin/sh - \u0431\u0435\u0437 \u043e\u0431\u043e\u043b\u043e\u0447\u043a\u0438, \u043c\u043e\u0436\u043d\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c /bin/bash) <code>-b</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u0434\u043b\u044f \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u044f \u0434\u043e\u043c\u0430\u0448\u043d\u0435\u0433\u043e \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e /home) <code>-d</code> \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0431\u0443\u0434\u0443\u0442 \u0440\u0430\u0437\u043c\u0435\u0449\u0430\u0442\u044c\u0441\u044f \u0444\u0430\u0439\u043b\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>-m</code> \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0435\u0441\u043b\u0438 \u043e\u043d \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 <code>-c</code> \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439 \u043a \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 <code>-g</code> \u043e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>-G</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0433\u0440\u0443\u043f\u043f <code>-N</code> \u043d\u0435 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0441 \u0438\u043c\u0435\u043d\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>-p</code> \u0437\u0430\u0434\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>-l</code> \u043d\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0432\u0445\u043e\u0434\u0430\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 lastlog \u0438 faillog <code>-o</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f linux \u0441 \u043d\u0435\u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u043c \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u043e\u043c UID <code>-u</code> \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</p>"},{"location":"Linux/#adduser","title":"adduser","text":"<p><code>adduser username</code> \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0431\u0443\u0434\u0435\u0442 \u0441\u043e\u0437\u0434\u0430\u043d \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 (/home/username), \u043c\u043e\u0436\u043d\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435 \u0438\u043b\u0438 \u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0438 \u0437\u0430\u0434\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c <code>deluser username</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u043d\u0435 \u0443\u0434\u0430\u043b\u044f\u0435\u0442\u0441\u044f)</p>"},{"location":"Linux/#chmod","title":"chmod","text":"<pre><code>    -                    ---                          ---         ---\n    |                     |                            |           |\n\u0442\u0438\u043f \u0444\u0430\u0439\u043b\u0430   \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430)   \u0433\u0440\u0443\u043f\u043f\u044b   \u0432\u0441\u0435\u0445 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445\n</code></pre> <p><code>---</code> \u043d\u0435\u0442 \u043f\u0440\u0430\u0432 <code>--x</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u0430, \u043a\u0430\u043a \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b \u043d\u043e \u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0438 \u043d\u0435 \u0447\u0442\u0435\u043d\u0438\u0435 <code>-w-</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u0437\u0430\u043f\u0438\u0441\u044c \u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u0430 <code>-wx</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435, \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0441 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u043c \u043d\u0435\u043b\u044c\u0437\u044f \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0435\u0433\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 <code>r--</code> \u043f\u0440\u0430\u0432\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435 <code>r-x</code> \u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u0435\u043d\u0438\u0435 \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435, \u0431\u0435\u0437 \u043f\u0440\u0430\u0432\u0430 \u043d\u0430 \u0437\u0430\u043f\u0438\u0441\u044c <code>rw-</code> \u043f\u0440\u0430\u0432\u0430 \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435 \u0438 \u0437\u0430\u043f\u0438\u0441\u044c, \u043d\u043e \u0431\u0435\u0437 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f <code>rwx</code> \u0432\u0441\u0435 \u043f\u0440\u0430\u0432\u0430 <code>--s</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d SUID \u0438\u043b\u0438 SGID \u0431\u0438\u0442, \u043f\u0435\u0440\u0432\u044b\u0439 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442\u0441\u044f \u0432 \u043f\u043e\u043b\u0435 \u0434\u043b\u044f \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430, \u0432\u0442\u043e\u0440\u043e\u0439 \u0434\u043b\u044f \u0433\u0440\u0443\u043f\u043f\u044b <code>--t</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d sticky-bit, \u0437\u043d\u0430\u0447\u0438\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u043d\u0435 \u043c\u043e\u0433\u0443\u0442 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e\u0442 \u0444\u0430\u0439\u043b</p> <p><code>r</code> \u0447\u0442\u0435\u043d\u0438\u0435 <code>w</code> \u0437\u0430\u043f\u0438\u0441\u044c <code>x</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 <code>s</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435  \u043e\u0442 \u0438\u043c\u0435\u043d\u0438 \u0441\u0443\u043f\u0435\u0440\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439)</p> <p><code>u</code> \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c-\u0432\u043b\u0430\u0434\u0435\u043b\u0435\u0446 \u0444\u0430\u0439\u043b\u0430 <code>g</code> \u0433\u0440\u0443\u043f\u043f\u0430-\u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446 \u0444\u0430\u0439\u043b\u0430 <code>o</code> \u0432\u0441\u0435 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438</p> <p><code>+</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c <code>-</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c</p> <p><code>-R</code> \u043f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u043d\u0430 \u0432\u0441\u0435 \u043f\u043e\u0434\u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0438 \u0438 \u0444\u0430\u0439\u043b\u044b \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 <code>-v</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431\u043e \u0432\u0441\u0435\u0445 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f\u0445</p> <p><code>chmod u+x filename</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 (x) \u0434\u043b\u044f \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 (u) <code>chmod ugo+x filename</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 (x) \u0434\u043b\u044f \u0432\u0441\u0435\u0445 (ugo) <code>chmod ug+r filename</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0447\u0442\u0435\u043d\u0438\u0435 (r) \u0434\u043b\u044f \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 (u) \u0438 \u0433\u0440\u0443\u043f\u043f\u044b (g) <code>chmod o-w filename</code> \u0437\u0430\u043f\u0440\u0435\u0442\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c (w) \u0434\u043b\u044f \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 (o) <code>chmod -R g+rwx dir</code> \u0434\u0430\u0442\u044c \u043f\u043e\u043b\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f (rwx) \u0433\u0440\u0443\u043f\u043f\u0435 (g) \u043d\u0430 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u0438 \u0432\u0441\u0435\u043c \u0444\u0430\u0439\u043b\u0430\u043c \u0432 \u043d\u0435\u0439 (-R)</p> <p>\u041f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0432 \u0432\u043e\u0441\u044c\u043c\u0435\u0440\u0438\u0447\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u044b\u0432\u0430\u044e\u0442 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u043f\u0440\u0430\u0432\u0430 \u043d\u043e\u0432\u044b\u043c\u0438 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439:</p> <p><code>0</code> \u043d\u0438\u043a\u0430\u043a\u0438\u0445 \u043f\u0440\u0430\u0432 <code>1</code> \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 <code>2</code> \u0442\u043e\u043b\u044c\u043a\u043e \u0437\u0430\u043f\u0438\u0441\u044c <code>3</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0438 \u0437\u0430\u043f\u0438\u0441\u044c <code>4</code> \u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u0435\u043d\u0438\u0435 <code>5</code> \u0447\u0442\u0435\u043d\u0438\u0435 \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 <code>6</code> \u0447\u0442\u0435\u043d\u0438\u0435 \u0438 \u0437\u0430\u043f\u0438\u0441\u044c <code>7</code> \u0447\u0442\u0435\u043d\u0438\u0435, \u0437\u0430\u043f\u0438\u0441\u044c \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435</p> <p><code>chmod 744 filename</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u043f\u043e\u043b\u043d\u044b\u0435 \u043f\u0440\u0430\u0432\u0430 \u0434\u043b\u044f \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430, \u0430 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u0435\u043d\u0438\u0435 <code>chmod 664 filename</code> \u0447\u0442\u0435\u043d\u0438\u0435 \u0438 \u0437\u0430\u043f\u0438\u0441\u044c \u0434\u043b\u044f \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 \u0438 \u0433\u0440\u0443\u043f\u043f\u044b, \u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445</p>"},{"location":"Linux/#chown","title":"chown","text":"<p><code>chown lifailon tmp</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 \u043d\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f lifailon \u0434\u043b\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 tmp <code>chown lifailon:lifailon tmp</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 \u0438 \u0433\u0440\u0443\u043f\u043f\u0443 <code>chown -R lifailon:lifailon tmp</code> \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043a\u043e \u0432\u0441\u0435\u043c \u043f\u043e\u0434\u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430\u043c (-R) <code>chown --from=root:root lifailon:lifailon -R ./</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 \u0438 \u0433\u0440\u0443\u043f\u043f\u0443 \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0442\u0435\u0445 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u0432 \u0438 \u0444\u0430\u0439\u043b\u043e\u0432, \u0443 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0432\u043b\u0430\u0434\u0435\u043b\u0435\u0446 \u0438 \u0433\u0440\u0443\u043f\u043f\u0430 root \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u043c \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435</p>"},{"location":"Linux/#groups","title":"groups","text":"<p><code>groups lifailon</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432 \u043a\u0430\u043a\u0438\u0445 \u0433\u0440\u0443\u043f\u043f\u0430\u0445 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c <code>touch testdir</code> \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0444\u0430\u0439\u043b\u0430 \u0435\u043c\u0443 \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u0442\u0441\u044f \u043e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0435\u0433\u043e \u0441\u043e\u0437\u0434\u0430\u043b (ls -l testdir) <code>cat /etc/group</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f <code>chgrp testdir tmp</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u043d\u0430 testdir \u0434\u043b\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 tmp <code>groupadd testdir</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 <code>delgroup testdir</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443, \u0435\u0441\u043b\u0438 \u043e\u0448\u0438\u0431\u043a\u0430 'testdir' still has <code>testdir' as their primary group!</code> \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b \u0432\u0441\u0435\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439</p> <p>\u041e\u043f\u0446\u0438\u0438: <code>-g</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043e\u0441\u043d\u043e\u0432\u043d\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>-G</code> \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0433\u0440\u0443\u043f\u043f\u044b, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0443\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u0437\u0430\u0442\u0438\u0440\u0430\u0435\u0442 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0435) <code>-a</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0433\u0440\u0443\u043f\u043f\u044b c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c -G, \u0430 \u043d\u0435 \u0437\u0430\u043c\u0435\u043d\u044f\u0442\u044c \u0438\u043c \u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>-R</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b</p>"},{"location":"Linux/#usermod_1","title":"usermod","text":"<p><code>usermod -aG sudo lifailon</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443 (-aG, \u0431\u0435\u0437 \u0437\u0430\u0442\u0438\u0440\u0430\u043d\u0438\u044f \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0445 \u0433\u0440\u0443\u043f\u043f) sudo (\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0433\u0440\u0443\u043f\u043f\u0443 root) <code>usermod -aG disk lifailon</code> \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0431\u0443\u0434\u0435\u0442 \u0438\u043c\u0435\u0442\u044c \u043f\u0440\u044f\u043c\u043e\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0416\u0414 \u0431\u0435\u0437 \u043a\u043e\u043c\u0430\u043d\u0434\u044b sudo (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c) <code>usermod -g root lifailon</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043e\u0441\u043d\u043e\u0432\u043d\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443 (-g) \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043d\u0430 root <code>usermod -R ssh lifailon</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b</p>"},{"location":"Linux/#domain","title":"domain","text":""},{"location":"Linux/#realmd","title":"realmd","text":"<p><code>hostnamectl</code> <code>hostnamectl set-hostname srv-01.domain.local</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u043c\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 (/etc/hostname)</p> <p><code>nano /etc/resolv.conf</code> <code>nameserver 192.168.3.233</code> \u0430\u0434\u0440\u0435\u0441 DC <code>search domain.local</code></p> <p><code>apt -y install realmd libnss-sss libpam-sss sssd sssd-tools adcli samba-common-bin oddjob oddjob-mkhomedir packagekit</code> <code>nano /etc/realmd.conf</code> \u0437\u0430\u0434\u0430\u0442\u044c \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u044b \u0445\u043e\u0441\u0442\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b \u0432 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0432 AD (\u0430\u0442\u0440\u0438\u0431\u0443\u0442\u044b operatingSystem \u0438 operatingSystemVersion)</p> <pre><code>[active-directory]\nos-name = Ubuntu Server\nos-version = 20.04\n</code></pre> <p><code>realm discover domain.local --verbose</code> \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043f\u043e\u043b\u043d\u0443\u044e \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0434\u043e\u043c\u0435\u043d\u0430 \u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0430\u043a\u0435\u0442\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0434\u043b\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0432 \u0434\u043e\u043c\u0435\u043d\u0435 <code>realm join --help | grep pass</code> <code>realm join -U username domain.local</code> --one-time-password<code>\u0432\u0432\u0435\u0441\u0442\u0438 \u0432 \u0434\u043e\u043c\u0435\u043d</code>realm list<code>\u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043f\u043e\u0441\u043b\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f (server-software: active-directory)</code>id username@domain.local` \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435 \u0434\u043e\u043c\u0435\u043d\u0430</p>"},{"location":"Linux/#sssd","title":"sssd","text":"<p>\u041f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043d\u0430 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0432 Linux \u0438\u0437 \u043f\u043e\u0434 \u0423\u0417 \u0434\u043e\u043c\u0435\u043d\u0430 (sssd \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 Kerberos)</p> <p><code>realm permit -g 'ssh-connect-domain'</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442 \u0434\u043e\u043c\u0435\u043d\u043d\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443 (echo \"simple_allow_groups = ssh-connect-domain\" &gt;&gt; /etc/sssd/sssd.conf) <code>realm permit username@domain.local</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (echo \"simple_allow_users = username\" &gt;&gt; /etc/sssd/sssd.conf) <code>realm deny --all</code> \u0437\u0430\u043f\u0440\u0435\u0442\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u0432\u0441\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c (\u043e\u0447\u0438\u0449\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a simple_allow_* \u0432 sssd.conf) <code>systemctl restart sssd</code></p> <p>\u0421\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u0434\u043b\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u0434\u043e\u043c\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:</p> <pre><code>bash -c \"cat &gt; /usr/share/pam-configs/mkhomedir\" &lt;&lt;EOF\nName: activate mkhomedir\nDefault: yes\nPriority: 900\nSession-Type: Additional\nSession:\nrequired pam_mkhomedir.so umask=0022 skel=/etc/skel\nEOF\n</code></pre> <p><code>pam-auth-update</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e, \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u0443\u044e: activate mkhomedir</p> <p>\u041f\u0440\u0430\u0432\u0430 \u043d\u0430 sudo:</p> <p><code>nano /etc/sudoers.d/domain_admins</code> nano /etc/sudoers.d/linux-admins</p> <pre><code>username@domain.local               ALL=(ALL)       ALL\n%ssh-connect-domain@domain.local    ALL=(ALL)       ALL\n</code></pre> <p><code>ssh username@domain.local@hostname</code></p>"},{"location":"Linux/#syslog","title":"syslog","text":""},{"location":"Linux/#server","title":"server","text":"<p><code>systemctl status rsyslog</code></p> <p><code>nano /etc/rsyslog.conf</code></p> <pre><code># provides UDP syslog reception (input module udp)\nmodule(load=\"imudp\")\ninput(type=\"imudp\" port=\"514\")\n# provides TCP syslog reception\n#module(load=\"imtcp\")\n#input(type=\"imtcp\" port=\"514\")\n# Filter duplicated messages\n# \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044e \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0445 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439\n$RepeatedMsgReduction off\n# \u0428\u0430\u0431\u043b\u043e\u043d \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 IP \u0430\u0434\u0440\u0435\u0441\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438 \u0441\u0431\u043e\u0440 \u0432\u0441\u0435\u0445 \u043b\u043e\u0433\u043e\u0432 \u0432 \u043e\u0434\u0438\u043d \u0444\u0430\u0439\u043b:\n$template RemoteLogs,\"/var/log/remote/%fromhost-ip%/syslog.log\"\n# \u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043e\u0442 \u043b\u044e\u0431\u043e\u0433\u043e \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 (*) \u0441 \u043b\u044e\u0431\u044b\u043c \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u043e\u043c (*) \u0432 \u0444\u0430\u0439\u043b, \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u0439 \u0448\u0430\u0431\u043b\u043e\u043d\u043e\u043c (RemoteLogs):\n*.* ?RemoteLogs\n# \u0428\u0430\u0431\u043b\u043e\u043d \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0438\u043c\u0435\u043d\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438 \u043b\u043e\u0433-\u0444\u0430\u0439\u043b\u043e\u0432 \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b:\n# $template RemoteLogs,\"/var/log/remote/%HOSTNAME%/%PROGRAMNAME%.log\"\n# *.* ?RemoteLogs\n# Include all config files in /etc/rsyslog.d/\n$IncludeConfig /etc/rsyslog.d/*.conf\n</code></pre> <p><code>systemctl restart rsyslog</code></p>"},{"location":"Linux/#client","title":"client","text":"<p><code>nano /etc/rsyslog.d/all.conf</code></p> <pre><code># UDP:\n*.* @192.168.3.105:514\n# TCP:\n# *.* @@192.168.3.105:514\n# auth.* @@192.168.3.105:514\n# *.err @@192.168.3.105:514\n</code></pre> <p><code>systemctl restart rsyslog</code> <code>ls /var/log/remote</code> \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0434\u043e\u043b\u0436\u043d\u0430 \u043f\u043e\u044f\u0432\u0438\u0442\u044c\u0441\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0441 ip-\u0430\u0434\u0440\u0435\u0441\u043e\u043c/\u0438\u043c\u0435\u043d\u0435\u043c \u043a\u043b\u0438\u0435\u043d\u0442\u0430 <code>ls -lh /var/log/remote/*</code> <code>cat /var/log/remote/192.168.3.104/syslog.log | grep influxd</code> <code>systemctl restart zabbix-agent</code> <code>cat /var/log/remote/192.168.3.104/syslog.log | grep zabbix_agentd</code></p>"},{"location":"Linux/#zabbix-agent","title":"zabbix-agent","text":"<p><code>nano /etc/zabbix/zabbix_agentd.conf</code></p> <pre><code># LogType=file\nLogType=system\nDebugLevel=1\n</code></pre> <p><code>systemctl restart zabbix-agent</code></p>"},{"location":"Linux/#ommail","title":"ommail","text":"<p><code>nano /etc/rsyslog.conf</code></p> <pre><code># \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c:\nmodule(load=\"ommail\")\n$ActionMailSMTPServer m.domain.ru\n$ActionMailSMTPPort 25\n$ActionMailFrom zabbix@domain.ru\n$ActionMailTo lifailon@domain.ru\n# \u0428\u0430\u0431\u043b\u043e\u043d, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c\u0441\u044f \u043a\u0430\u043a \u0442\u0435\u043c\u0430 (Subject) \u0438 \u0442\u0435\u043b\u043e \u043f\u0438\u0441\u044c\u043c\u0430 (Body) - \u0438\u043c\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u0448\u0430\u0431\u043b\u043e\u043d\u0430,\"\u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0448\u0430\u0431\u043b\u043e\u043d\u0430\"\n$template mailSubject,\"rsyslog: disk problem on %hostname%\"\n$template mailBody,\"RSYSLOG Alert\\r\\nmsg='%msg%'\"\n$ActionMailSubject mailSubject\n$ActionMailBody mailBody\n# \u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0443 - \u043e\u0434\u043d\u043e \u043f\u0438\u0441\u044c\u043c\u043e \u0432 5 \u043c\u0438\u043d\u0443\u0442\n$ActionExecOnlyOnceEveryInterval 300\n</code></pre>"},{"location":"Linux/#logrotate","title":"logrotate","text":"<p><code>systemctl status logrotate.timer</code></p> <p><code>nano /etc/logrotate.conf</code></p> <pre><code># \u0420\u043e\u0442\u0430\u0446\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0435\u0436\u0435\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u043e\nweekly\n# \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0433\u0440\u0443\u043f\u043f\u0430 adm, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u043c \u0433\u0440\u0443\u043f\u043f\u044b ls -ld /var/log/syslog\nsu root adm\n# \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0444\u0430\u0439\u043b\u043e\u0432 (\u043d\u0435\u0434\u0435\u043b\u044c, \u0435\u0441\u043b\u0438 \u0440\u043e\u0442\u0430\u0446\u0438\u044f \u0435\u0436\u0435\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u043e) \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432\nrotate 4\n# \u0421\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0435 (\u043f\u0443\u0441\u0442\u044b\u0435) \u0444\u0430\u0439\u043b\u044b \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u0432 \u043f\u043e\u0441\u043b\u0435 \u0440\u043e\u0442\u0430\u0446\u0438\u0438 \u0441\u0442\u0430\u0440\u044b\u0445\ncreate\n# \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u0442\u0443 \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0441\u0443\u0444\u0444\u0438\u043a\u0441\u0430 \u0440\u043e\u0442\u0438\u0440\u0443\u0435\u043c\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430\ndateext\n# \u0421\u0436\u0438\u043c\u0430\u0442\u044c \u043b\u043e\u0433-\u0444\u0430\u0439\u043b\u044b\ncompress\n# \u041f\u0430\u043a\u0435\u0442\u044b \u0441\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u044e\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0440\u043e\u0442\u0430\u0446\u0438\u0438 \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0432 \u044d\u0442\u043e\u0442 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\ninclude /etc/logrotate.d\n</code></pre> <p><code>nano /etc/logrotate.d/logrotate_remote.conf</code></p> <pre><code>/var/log/remote/*/*.log {\nsu root root\ndaily\ncopytruncate\nsize 10M\nrotate 2\ncompress\ndateext\n}\n</code></pre> <p>\u0423\u0441\u043b\u043e\u0432\u0438\u044f:</p> <p><code>hourly</code> \u043a\u0430\u0436\u0434\u044b\u0439 \u0447\u0430\u0441 <code>daily</code> \u043a\u0430\u0436\u0434\u044b\u0439 \u0434\u0435\u043d\u044c <code>weekly</code> \u043a\u0430\u0436\u0434\u0443\u044e \u043d\u0435\u0434\u0435\u043b\u044e <code>monthly</code> \u043a\u0430\u0436\u0434\u044b\u0439 \u043c\u0435\u0441\u044f\u0446 <code>yearly</code> \u043a\u0430\u0436\u0434\u044b\u0439 \u0433\u043e\u0434 <code>size</code> \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u043b\u043e\u0433\u0430, \u043c\u0435\u043d\u044c\u0448\u0435 \u044d\u0442\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0440\u043e\u0442\u0430\u0446\u0438\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c\u0441\u044f \u043d\u0435 \u0431\u0443\u0434\u0435\u0442</p> <p>\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044f:</p> <p><code>rotate 2</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c, \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 \u0440\u043e\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043b\u043e\u0433-\u0444\u0430\u0439\u043b\u043e\u0432 \u043d\u0443\u0436\u043d\u043e \u0445\u0440\u0430\u043d\u0438\u0442\u044c, \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0443\u0434\u0430\u043b\u044f\u0442\u044c <code>maxage 30</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c, \u0437\u0430 \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 \u0434\u043d\u0435\u0439 \u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0440\u043e\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b, \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0443\u0434\u0430\u043b\u044f\u0442\u044c <code>copytruncate</code> \u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u043a\u043e\u043f\u0438\u044f \u0444\u0430\u0439\u043b\u0430 \u043b\u043e\u0433\u0430, \u043f\u043e\u0441\u043b\u0435 \u0443\u0436\u0435 \u043e\u0431\u0440\u0435\u0437\u0430\u0435\u0442\u0441\u044f \u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 (\u043d\u0443\u0436\u043d\u043e, \u043a\u043e\u0433\u0434\u0430 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u043f\u0438\u0441\u0430\u0442\u044c \u043b\u043e\u0433 \u043d\u0435\u043f\u0440\u0435\u0440\u044b\u0432\u043d\u043e, \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0442\u0435\u0440\u0438 \u0437\u0430\u043f\u0438\u0441\u0435\u0439, \u0435\u0441\u043b\u0438 \u043e\u043d\u0430 \u043f\u0440\u0438\u0434\u0435\u0442\u0441\u044f \u043d\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0443\u0441\u0435\u0447\u0435\u043d\u0438\u044f) <code>extension</code> \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0442\u044c \u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043b\u043e\u0433 \u0444\u0430\u0439\u043b \u043f\u043e\u0441\u043b\u0435 \u0440\u043e\u0442\u0430\u0446\u0438\u0438 <code>compress</code> \u0441\u0436\u0438\u043c\u0430\u0442\u044c \u0440\u043e\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043b\u043e\u0433 (gzip) <code>delaycompress</code> \u043d\u0435 \u0441\u0436\u0438\u043c\u0430\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0438 \u043f\u0440\u0435\u0434\u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0436\u0443\u0440\u043d\u0430\u043b (\u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0437\u0431\u0435\u0436\u0430\u0442\u044c \u043e\u0448\u0438\u0431\u043e\u043a, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0435\u043c \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u043e\u043c\u0443 \u0444\u0430\u0439\u043b\u0443) <code>create # 0644 root root</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0443\u0441\u0442\u043e\u0439 \u043b\u043e\u0433 \u0444\u0430\u0439\u043b \u043d\u0430 \u043c\u0435\u0441\u0442\u0435 \u0441\u0442\u0430\u0440\u043e\u0433\u043e <code>olddir /path</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0430\u0442\u044c \u043b\u043e\u0433\u0438 \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u0443\u044e \u043f\u0430\u043f\u043a\u0443 \u043f\u0440\u0438 \u0441\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u043d\u0438\u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u044f <code>dateext</code> \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0434\u0430\u0442\u0443 \u0440\u043e\u0442\u0430\u0446\u0438\u0438 \u043f\u0435\u0440\u0435\u0434 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u043e\u043c \u0441\u0442\u0430\u0440\u043e\u0433\u043e \u043b\u043e\u0433\u0430 <code>missingok</code> \u043d\u0435 \u0432\u044b\u0434\u0430\u0432\u0430\u0442\u044c \u043e\u0448\u0438\u0431\u043a\u0438, \u0435\u0441\u043b\u0438 \u043b\u043e\u0433 \u0444\u0430\u0439\u043b\u0430 \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 <code>notifempty</code> \u0435\u0441\u043b\u0438 \u0444\u0430\u0439\u043b \u043f\u0443\u0441\u0442\u043e\u0439, \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043d\u0438\u043a\u0430\u043a\u0438\u0445 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 <code>prerotate script.sh endscript</code> \u0441\u043a\u0440\u0438\u043f\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u0434 \u0447\u0438\u0441\u0442\u043a\u043e\u0439 \u043b\u043e\u0433\u0430 <code>postrotate script.sh endscript</code> \u0441\u043a\u0440\u0438\u043f\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043f\u043e\u0441\u043b\u0435 \u0447\u0438\u0441\u0442\u043a\u0438 \u043b\u043e\u0433\u0430 <code>sharedscripts</code> \u0435\u0441\u043b\u0438 \u0431\u044b\u043b \u0443\u043a\u0430\u0437\u0430\u043d \u043f\u0443\u0442\u044c \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 wildcard (*), \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0441\u043a\u0440\u0438\u043f\u0442 \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0440\u043e\u0442\u0430\u0446\u0438\u0438 \u0432\u0441\u0435\u0445 \u0444\u0430\u0439\u043b\u043e\u0432</p> <p><code>logrotate -d /etc/logrotate.d/logrotate_remote.conf</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0440\u043e\u0442\u0430\u0446\u0438\u044e (--debug) <code>logrotate -fv /etc/logrotate.d/logrotate_remote.conf</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0440\u043e\u0442\u0430\u0446\u0438\u044e \u0441\u0435\u0439\u0447\u0430\u0441 (--force) \u0441 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u043c \u0432\u044b\u0432\u043e\u0434\u043e\u043c (--verbose) <code>cat /etc/cron.daily/logrotate</code> \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u043d\u0430 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0437\u0430\u043f\u0443\u0441\u043a \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0447\u0438\u0442\u0430\u0435\u0442 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u0440\u043e\u0442\u0430\u0446\u0438\u0438 /etc/logrotate.conf, \u0432 \u043d\u0435\u043c \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0434\u0438\u0440\u0435\u043a\u0442\u0440\u0438\u044f: include /etc/logrotate.d \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u043b\u0435\u0436\u0430\u0442 \u0444\u0430\u0439\u043b\u044b \u0440\u043e\u0442\u0430\u0446\u0438\u0438 <code>which logrotate</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043f\u0443\u0442\u044c \u0434\u043e \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 <code>crontab -e</code> <code>00 3 * * * /usr/sbin/logrotate -f /etc/logrotate.d/logrotate_remote.conf</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0435 \u0440\u0443\u0447\u043d\u043e\u0435 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0441 \u0435\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u043c \u0437\u0430\u043f\u0443\u0441\u043a\u043e\u0432 \u0432 3:00</p>"},{"location":"Linux/#smb","title":"smb","text":""},{"location":"Linux/#cifs","title":"cifs","text":"<p><code>apt install cifs-utils</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c SMB Client</p> <p><code>nano /root/.smbclient</code></p> <pre><code>username=lifailon\npassword=password\n#domain=domain.local\n</code></pre> <p><code>mkdir /smb &amp;&amp; mkdir /smb/backup</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u0434\u043b\u044f \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f <code>nano /etc/fstab</code> <code>//192.168.3.100/Backup /smb/backup cifs user,rw,credentials=/root/.smbclient 0 0</code> rw \u043f\u0440\u0430\u0432\u0430 \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435 \u0438 \u0437\u0430\u043f\u0438\u0441\u044c <code>mount -a</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c (\u043e\u0442\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u0440\u0442\u044b \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435: 137/UDP; 138/UDP; 139/TCP; 445/TCP) <code>df -h</code></p> <p><code>//192.168.3.100/torrent-files /home/lifailon/torrent-files cifs user,rw,credentials=/root/.smbclient,perms=0666 0 0</code> <code>chmod 666 /home/lifailon/torrent-files</code> <code>chown -R lifailon:lifailon /home/lifailon/torrent-files</code> <code>smbclient $path_smb_qb --user=smb --password=kinozal</code></p>"},{"location":"Linux/#samba","title":"samba","text":"<p><code>iptables -I INPUT -p tcp --dport 445 -j ACCEPT</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f Samba <code>iptables -I INPUT -p tcp --dport 137 -j ACCEPT</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b NetBIOS (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0438\u043c\u0435\u043d\u0438 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430) <code>iptables -I INPUT -p tcp --dport 139 -j ACCEPT</code> <code>iptables -I INPUT -p udp --dport 137:138 -j ACCEPT</code> <code>iptables -L</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0440\u0430\u0432\u0438\u043b <code>iptables -F</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0440\u0430\u0432\u0438\u043b <code>apt install iptables-persistent</code> <code>netfilter-persistent save</code> \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438</p> <p><code>apt install samba</code> <code>systemctl status smbd</code> <code>mkdir -p /public/share</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043e\u0431\u0449\u0443\u044e \u043f\u0430\u043f\u043a\u0443 <code>chmod 777 /public/share</code> \u0432\u044b\u0434\u0430\u0442\u044c \u043f\u0440\u0430\u0432\u0430</p> <p><code>nano /etc/samba/smb.conf</code></p> <pre><code>[global]\nworkgroup = WORKGROUP # \u0440\u0430\u0431\u043e\u0447\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430 (\u0434\u043e\u043b\u0436\u043d\u0430 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u0430 \u043d\u0430 \u0432\u0441\u0435\u0445 \u043c\u0430\u0448\u0438\u043d\u0430\u0445)\n\n[share1]\n    comment = Public folder for all\n    path = /public/share\n    public = yes\n    writable = yes\n    read only = no\n    guest ok = yes\n    create mask = 0777\n    directory mask = 0777\n    force create mode = 0777\n    force directory mode = 0777\n</code></pre> <p><code>[\u041e\u0431\u0449\u0430\u044f \u043f\u0430\u043f\u043a\u0430]</code> \u0438\u043c\u044f \u043e\u0431\u0449\u0435\u0439 \u043f\u0430\u043f\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0443\u0432\u0438\u0434\u044f\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u043f\u0440\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 <code>path</code> \u043f\u0443\u0442\u044c \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435, \u0433\u0434\u0435 \u0431\u0443\u0434\u0443\u0442 \u0445\u0440\u0430\u043d\u0438\u0442\u044c\u0441\u044f \u0434\u0430\u043d\u043d\u044b\u0435 <code>public</code> \u0434\u043b\u044f \u043e\u0431\u0449\u0435\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430, \u0447\u0442\u043e\u0431\u044b \u0432\u0441\u0435 \u043c\u043e\u0433\u043b\u0438 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u043c <code>writable</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u0442 \u0437\u0430\u043f\u0438\u0441\u044c \u0432 \u0441\u0435\u0442\u0435\u0432\u0443\u044e \u043f\u0430\u043f\u043a\u0443 <code>read only = yes</code> \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f. no - \u0434\u043b\u044f \u043f\u043e\u043b\u043d\u043e\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u0424\u0421 <code>guest ok</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043f\u0430\u043f\u043a\u0435 \u0433\u043e\u0441\u0442\u0435\u0432\u043e\u0439 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 <code>create mask, directory mask, force create mode, force directory mode</code> \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043d\u043e\u0432\u043e\u0439 \u043f\u0430\u043f\u043a\u0438 \u0438\u043b\u0438 \u0444\u0430\u0439\u043b\u0430 \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u044e\u0442\u0441\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u0430\u0432\u0430. \u0412 \u043f\u0440\u0438\u043c\u0435\u0440\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u044b \u043f\u043e\u043b\u043d\u044b\u0435 \u043f\u0440\u0430\u0432\u0430.</p> <p><code>systemctl restart smbd</code> \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438</p> <p><code>useradd smb1</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f <code>passwd smb1</code> \u0437\u0430\u0434\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e <code>smbpasswd -a smb1</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0434\u043b\u044f Samba</p> <pre><code>public = no\nwritable = no\nread only = yes\nguest ok = yes # \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0430\u043d\u043e\u043d\u0438\u043c\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435 (read only) \u0431\u0435\u0437 \u043f\u0430\u0440\u043e\u043b\u044f\n; valid users = smb1 @smb-users # \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c\u0441\u044f \u043a \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0443 \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0432\u0445\u043e\u0434\u0449\u044f\u0445 \u0432 \u0433\u0440\u0443\u043f\u043f\u0443 smb-users\nwrite list = smb1 # \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u043c\u0435\u044e\u0442 \u043f\u043e\u043b\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438\nhosts allow = comp1, 192.168.160.0/255.255.252.0 # \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043d\u044b\u0445 \u0445\u043e\u0441\u0442\u043e\u0432 \u0438\u043b\u0438 \u0441\u0435\u0442\u0435\u0439, \u0441 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c\u0441\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443. \u0415\u0441\u043b\u0438 \u0435\u0433\u043e \u043f\u0440\u043e\u043f\u0438\u0441\u0430\u0442\u044c \u0432 \u0441\u0435\u043a\u0446\u0438\u044e \u0441 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u043e\u0439 \u0448\u0430\u0440\u044b, \u0442\u043e \u043e\u043d \u0431\u0443\u0434\u0435\u0442 \u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u043d\u0435\u0435, \u0435\u0441\u043b\u0438 \u043f\u0440\u043e\u043f\u0438\u0441\u0430\u0442\u044c \u0432 [global], \u0442\u043e \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043e\u0431\u0449\u0438\u0445 \u043f\u0430\u043f\u043e\u043a\nhosts deny = comp2, 192.168.164.0/255.255.252.0 # \u0437\u0430\u043f\u0440\u0435\u0442\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\n</code></pre>"},{"location":"Linux/#client-cifs","title":"client cifs","text":"<p><code>apt install cifs-utils</code> <code>mkdir /mnt/share1</code> <code>mount -t cifs \"//192.168.3.103/share1\" /mnt/share1 -o user=smb1</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u043d\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0435 Linux \u0441 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0435\u0439 <code>df -handle</code> <code>//192.168.3.103/share1  24G  23G  1.2G  96%  /mnt/share1</code></p>"},{"location":"Linux/#client-samba-client","title":"client samba-client","text":"<p><code>apt install samba-client</code> <code>smbclient -L 192.168.3.103 -U share1</code></p>"},{"location":"Linux/#recycle","title":"recycle","text":"<pre><code>[share1]\n    path = /public/share\n    public = yes\n    browseable = yes\n    writable = yes\n    read only = no\n    guest ok = yes\n    vfs objects = recycle\n    recycle:repository = .recycle/%U\n    recycle:keeptree = Yes\n    recycle:touch = Yes\n    recycle:versions = Yes\n    recycle:maxsize = 0\n    recycle:exclude = *.tmp\n    recycle:exclude_dir = /tmp\n</code></pre> <p><code>recycle:repository</code> \u0433\u0434\u0435 \u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b. \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u043f\u043e\u043f\u0430\u0434\u0443\u0442 \u0432 \u0441\u043a\u0440\u044b\u0442\u044b\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 .recycle \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0441\u043e\u0437\u0434\u0430\u0441\u0442\u0441\u044f \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u0441 \u0438\u043c\u0435\u043d\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0443\u0434\u0430\u043b\u0438\u0432\u0448\u0435\u0433\u043e \u0444\u0430\u0439\u043b \u0438\u043b\u0438 \u043f\u0430\u043f\u043a\u0443 <code>recycle:keeptree</code> \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0441 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435\u043c \u0434\u0435\u0440\u0435\u0432\u0430 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u0432 <code>recycle:touch</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0430\u0442\u0443 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u0430 \u043f\u0440\u0438 \u0435\u0433\u043e \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0438 \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443 <code>recycle:versions</code> \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u0444\u0430\u0439\u043b\u043e\u0432 \u0441 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0449\u0438\u043c\u0438 \u0438\u043c\u0435\u043d\u0430\u043c\u0438, \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0442\u044c \u043d\u043e\u043c\u0435\u0440 \u0432\u0435\u0440\u0441\u0438\u0438 <code>recycle:maxsize</code> \u043d\u0435 \u043f\u043e\u043c\u0435\u0449\u0430\u0442\u044c \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443 \u0444\u0430\u0439\u043b\u044b, \u0440\u0430\u0437\u043c\u0435\u0440 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0431\u043e\u043b\u044c\u0448\u0435 \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 (\u0432 \u0431\u0430\u0439\u0442\u0430\u0445). 0 - \u043f\u043e\u043c\u0435\u0449\u0430\u0442\u044c \u0444\u0430\u0439\u043b\u044b \u043b\u044e\u0431\u043e\u0433\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0430 <code>recycle:exclude</code> \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0444\u0430\u0439\u043b\u044b <code>recycle:exclude_dir</code> \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043a\u0430\u0442\u0430\u043b\u043e\u0433</p>"},{"location":"Linux/#nfs","title":"nfs","text":""},{"location":"Linux/#server_1","title":"server","text":"<p><code>apt install nfs-kernel-server</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440, \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u0435 \u0448\u0430\u0440\u044b. \u0421\u0435\u0440\u0432\u0438\u0441 NFS \u0441\u043b\u0443\u0448\u0430\u0435\u0442 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0434\u043b\u044f TCP \u0438 UDP \u043d\u0430 \u043f\u043e\u0440\u0442\u0443 2049. <code>apt install rpcbind</code> <code>rpcinfo -p | grep nfs</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u0441\u043b\u0443\u0448\u0430\u0435\u0442\u0441\u044f \u043b\u0438 \u043f\u043e\u0440\u0442 nfs <code>cat /proc/filesystems | grep nfs</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043b\u0438 NFS \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u044f\u0434\u0440\u0430 (\u0432\u044b\u0432\u043e\u0434: nodev nfsd) <code>modprobe nfs</code> \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u044f\u0434\u0440\u0430 nfs <code>systemctl status nfs-server</code> \u0441\u043b\u0443\u0436\u0431\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>ufw allow 111,2049 &amp;&amp; ufw reload</code> <code>mkdir nfs-folder</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0430\u043f\u043a\u0443 \u0434\u043b\u044f \u0448\u0430\u0440\u044b <code>adduser nfs-user</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f <code>chown nfs-user:nfs-user nfs-folder</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 \u0448\u0430\u0440\u044b <code>chmod 775 nfs-folder</code> \u0434\u0430\u0442\u044c \u043f\u043e\u043b\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u0432\u043b\u0430\u0434\u0443\u043b\u044c\u0446\u0443 \u0438 \u0433\u0440\u0443\u043f\u043f\u0435 <code>nano /etc/exports</code> \u0444\u0430\u0439\u043b \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0448\u0430\u0440\u044b <code>/nfs-folder 192.168.3.0/24(rw,sync,no_subtree_check)</code> /\u043f\u0443\u0442\u044c/\u043a/\u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 (\u0448\u0430\u0440\u0438\u043c), \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 IP-\u0430\u0434\u0440\u0435\u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438\u043b\u0438 \u043f\u043e\u0434\u0441\u0435\u0442\u044c (\u0447\u0442\u043e \u0431\u044b \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u0441\u0435 \u0430\u0434\u0440\u0435\u0441\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f 0.0.0.0/24 \u0438\u043b\u0438 \u0441\u0438\u043c\u0432\u043e\u043b *) \u0438 \u043e\u043f\u0446\u0438\u0438 \u0432 \u0441\u043a\u043e\u0431\u043a\u0430\u0445 <code>exportfs -a</code> \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 (\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0430 NFS)</p> <p>Options:</p> <p><code>rw</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0447\u0442\u0435\u043d\u0438\u0435 \u0438 \u0437\u0430\u043f\u0438\u0441\u044c \u0432 \u044d\u0442\u043e\u0439 \u043f\u0430\u043f\u043a\u0435 <code>ro</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u0435\u043d\u0438\u0435 <code>sync</code> \u043e\u0442\u0432\u0435\u0447\u0430\u0442\u044c \u043d\u0430 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u043e\u0433\u0434\u0430, \u043a\u043e\u0433\u0434\u0430 \u0434\u0430\u043d\u043d\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b \u043d\u0430 \u0434\u0438\u0441\u043a (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e) <code>async</code> \u043d\u0435 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043f\u043e\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u043d\u0430 \u0434\u0438\u0441\u043a <code>secure</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u043b\u044f \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0440\u0442\u044b \u043d\u0438\u0436\u0435 1024 <code>insecure</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043b\u044e\u0431\u044b\u0435 \u043f\u043e\u0440\u0442\u044b <code>nohide</code> \u043d\u0435 \u0441\u043a\u0440\u044b\u0432\u0430\u0442\u044c \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438, \u043f\u0440\u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u043c \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f\u043c <code>root_squash</code> \u043f\u043e\u0434\u043c\u0435\u043d\u044f\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 root \u043d\u0430 \u0430\u043d\u043e\u043d\u0438\u043c\u043d\u044b\u0435 (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e) <code>no_root_squash</code> \u043d\u0435 \u043f\u043e\u0434\u043c\u0435\u043d\u044f\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 root \u043d\u0430 \u0430\u043d\u043e\u043d\u0438\u043c\u043d\u044b\u0435 (\u0432\u0441\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043e\u0442 \u0438\u043c\u0435\u043d\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f root \u0441\u0447\u0438\u0442\u0430\u044e\u0442\u0441\u044f \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0430\u043d\u043e\u043d\u0438\u043c\u043d\u044b\u043c\u0438 nfsnobody, \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u044d\u0442\u043e\u0439 \u043e\u043f\u0446\u0438\u0438 \u043d\u0435 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e, \u043f\u043e\u0442\u043e\u043c\u0443 \u0447\u0442\u043e \u043b\u044e\u0431\u043e\u0439 root \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441\u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043d\u0430 \u0437\u0430\u043f\u0438\u0441\u044c \u043a\u043e \u0432\u0441\u0435\u043c \u0444\u0430\u0439\u043b\u0430\u043c) <code>all_squash</code> \u043f\u0440\u0435\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u0432\u0441\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u0432 \u0430\u043d\u043e\u043d\u0438\u043c\u043d\u044b\u0435 <code>subtree_check</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c \u043d\u0435 \u043f\u044b\u0442\u0430\u0435\u0442\u0441\u044f \u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0432\u044b\u0439\u0442\u0438 \u0437\u0430 \u043f\u0440\u0435\u0434\u0435\u043b\u044b \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u043f\u0430\u043f\u043a\u0438 <code>no_subtree_check</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043a \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u043f\u0430\u043f\u043a\u0435, \u0443\u043b\u0443\u0447\u0448\u0430\u0435\u0442 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c, \u043d\u043e \u0441\u043d\u0438\u0436\u0430\u0435\u0442 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c, \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u0433\u0434\u0430 \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0440\u0430\u0437\u0434\u0435\u043b \u0434\u0438\u0441\u043a\u0430 <code>anonuid \u0438 anongid</code> \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 uid \u0438 gid \u0434\u043b\u044f \u0430\u043d\u043e\u043d\u0438\u043c\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</p> <p>\u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 UNIX, \u043f\u043e\u044d\u0442\u043e\u043c\u0443, \u0435\u0441\u043b\u0438 \u043d\u0443\u0436\u043d\u043e \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0432\u0448\u0438\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u043c\u043e\u0433 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043f\u0430\u043f\u043a\u0435, \u0442\u043e \u043d\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0439 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0442\u0430\u043a\u0438\u043c \u0436\u0435 UID (\u0438\u043c\u0435\u043d\u0435\u043c \u0438 ID), \u0430 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0434\u043b\u044f \u0440\u0430\u0441\u0448\u0430\u0440\u0435\u043d\u043d\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0434\u043e\u043b\u0436\u043d\u0430 \u043f\u0440\u0438\u043d\u0430\u0434\u043b\u0435\u0436\u0430\u0442\u044c \u0442\u0430\u043a\u043e\u043c\u0443 \u0436\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u0438\u043b\u0438 \u0433\u0440\u0443\u043f\u043f\u0435 \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u043e\u043d \u0441\u043e\u0441\u0442\u043e\u0438\u0442 (GID). \u0418\u043b\u0438 \u0434\u0430\u0442\u044c \u043f\u043e\u043b\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 (chmod 777 nfs-folder), \u0442\u043e\u0433\u0434\u0430 \u0432\u0441\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0431\u0443\u0434\u0443\u0442 \u043e\u0442 \u0438\u043c\u0435\u043d\u0438: nobody nogroup</p> <p><code>/nfs-folder 192.168.3.0/24(rw,sync,all_squash,anonuid=1020,anongid=1020)</code> \u043b\u044e\u0431\u043e\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0432 \u0441\u0435\u0442\u0438 \u0441\u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u043e\u043b\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043a\u043e \u0432\u0441\u0435\u043c \u0444\u0430\u0439\u043b\u0430\u043c \u0440\u0430\u0441\u0448\u0430\u0440\u0435\u043d\u043d\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438, \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0443\u0436\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 UID 1020 \u0438 \u0443\u043a\u0430\u0437\u0430\u0442\u044c, \u0447\u0442\u043e \u0431\u044b \u0432\u0441\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u0430\u043c\u0438 \u043e\u0442 \u0430\u043d\u043e\u043d\u0438\u043c\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0430 \u0430\u043d\u043e\u043d\u0438\u043c\u043d\u043e\u043c\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u043f\u0440\u0438\u0441\u0432\u043e\u0438\u0442\u044c UID 1020. \u0415\u0441\u043b\u0438 \u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 id 1020 \u0435\u0441\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0440\u0430\u0441\u0448\u0430\u0440\u0435\u043d\u043d\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435, \u0442\u043e \u043f\u0440\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u043d\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0439 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u043e\u043d \u0431\u0443\u0434\u0435\u0442 \u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u043b\u044e\u0431\u044b\u043c UID. \u041f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0444\u0430\u0439\u043b\u043e\u0432 \u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439 \u043f\u043e\u0434 \u0434\u0440\u0443\u0433\u0438\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c, \u0431\u0443\u0434\u0435\u0442 \u0443\u043a\u0430\u0437\u0430\u043d \u0432\u043b\u0430\u0434\u0435\u043b\u0435\u0446 \u0441 \u043d\u043e\u043c\u0435\u0440\u043e\u043c UID \u0438 GID 1020. <code>usermod -u 1020 nfs-user</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c UID <code>groupmod -g 1020 nfs-user</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c GID <code>id nfs-user</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c ID</p>"},{"location":"Linux/#client_1","title":"client","text":"<p><code>apt install nfs-common</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043d\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u043c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0435, \u0447\u0442\u043e \u0431\u044b \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c c \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 <code>mkdir /mnt/nfs-folder &amp;&amp; mount 192.168.3.104:/nfs-folder/ /mnt/nfs-folder</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0448\u0430\u0440\u0443 \u0438 \u043f\u0440\u0432\u043e\u0435\u0440\u0438\u0442\u044c df -h (192.168.3.104:/nfs-folder  48G  20G  27G  43%  /mnt/nfs-folder) <code>umount /mnt/nfs-folder</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c <code>showmount -e 192.168.3.104</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432</p>"},{"location":"Linux/#ftp","title":"ftp","text":"<p><code>apt install vsftpd</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 vsFTPd Server (Very Secure File Transfer Protocol Daemon) <code>systemctl status vsftpd</code> <code>ufw allow 20:21/tcp</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u0440\u0442\u044b \u0432 Firewall <code>ufw allow 30000:31000/tcp</code> <code>cp /etc/vsftpd.conf /etc/vsftpd.conf.bak</code> \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0430\u044f \u043a\u043e\u043f\u0438\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a</p> <p><code>nano /etc/vsftpd.conf</code></p> <pre><code>listen=YES\nlisten_ipv6=NO\nanonymous_enable=NO` \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u043d\u0430\u043d\u0438\u043c\u043d\u044b\u0439 \u0432\u0445\u043e\u0434\nlocal_enable=YES` \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0438\u043c\u0435\u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u0430\nwrite_enable=YES` \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0435). \u041f\u0440\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043c\u043e\u0436\u0435\u0442 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0432\u0441\u0435\u043c\u0438 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430\u043c\u0438, \u043a\u0443\u0434\u0430 \u0443 \u043d\u0435\u0433\u043e \u0435\u0441\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\nchroot_local_user=NO` \u043a\u043e\u0433\u0434\u0430 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e \u0432 YES, \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0438\u0445 \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u043c\u0438 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430\u043c\u0438 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0447\u0430\u0441\u0442\u0438 \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b\nchroot_list_enable=YES` \u0437\u0430\u0434\u0430\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0438\u043b\u0438 \u043d\u0435 \u0431\u0443\u0434\u0443\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u044b \u0441\u0432\u043e\u0438\u043c\u0438 \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u043c\u0438 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430\u043c\u0438 \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 chroot_local_user\nchroot_list_file=/etc/vsftpd.chroot_list` \u043f\u0443\u0442\u044c \u043a \u0444\u0430\u0439\u043b\u0443, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0434\u043b\u044f chroot-\u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f\nuser_sub_token=$USER\nlocal_root=/home/$USER/ftp` \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u043f\u0440\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 \u043f\u043b\u0435\u0439\u0441\u0445\u043e\u043b\u0434\u0435\u0440\u043e\u043c)\nuserlist_enable=YES` \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0433\u0443\u0442 (\u0438\u043b\u0438 \u043d\u0435 \u043c\u043e\u0433\u0443\u0442) \u0432\u0445\u043e\u0434\u0438\u0442\u044c \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\nuserlist_file=/etc/vsftpd.user_list` \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043f\u0443\u0442\u044c \u043a \u0444\u0430\u0439\u043b\u0443 \u0441\u043e \u0441\u043f\u0438\u0441\u043a\u043e\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u044b \u0438\u043b\u0438 \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d\u044b\nuserlist_deny=NO` \u043f\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043a\u043e\u0433\u0434\u0430 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e \u0432 NO, \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430 userlist_file \u043c\u043e\u0433\u0443\u0442 \u0432\u0445\u043e\u0434\u0438\u0442\u044c \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 \u0438 \u043d\u0430\u043e\u0431\u043e\u0440\u043e\u0442\nconnect_from_port_20` YES - \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c 20 \u043f\u043e\u0440\u0442 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432\u043c\u0435\u0441\u0442\u043e \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e\u0433\u043e (\u043d\u0443\u0436\u043d\u043e \u0434\u043b\u044f \u043d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b firewall)\nxferlog_enable = YES` \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c \u0432 \u043b\u043e\u0433 \u0444\u0430\u0439\u043b \u0432\u0441\u0435 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438\n</code></pre> <p><code>systemctl restart vsftpd</code> <code>ss -ln | grep -w \"21\"</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u0447\u0442\u043e 21 \u043f\u043e\u0440\u0442 \u0441\u043b\u0443\u0448\u0430\u0435\u0442 (LISTEN) <code>ss -tn | grep -w \"21\"</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u043d\u0430 21 \u043f\u043e\u0440\u0442\u0443 (ESTAB) <code>cat /var/log/vsftpd.log</code> \u043b\u043e\u0433 \u0440\u0430\u0431\u043e\u0442\u044b (CONNECT/LOGIN/UPLOAD/DOWNLOAD/RENAME/DELETE)</p>"},{"location":"Linux/#ftp-client","title":"ftp client","text":"<p><code>ftp 192.168.3.104</code> \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0442\u043e\u043b\u044c\u043a\u043e \u0431\u0435\u0437 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f SSL <code>230 Login successful</code> \u0432\u0445\u043e\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0443\u0441\u043f\u0435\u0448\u0435\u043d <code>ls</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0435 <code>get test.json</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 <code>put out.txt</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 <code>bye</code> \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435</p>"},{"location":"Linux/#ftps","title":"ftps","text":"<p><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.key -out /etc/ssl/certs/vsftpd.crt</code> \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0430\u043c\u043e\u0437\u0430\u0432\u0435\u0440\u044f\u044e\u0449\u0438\u0439 SSL-\u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u044b\u0439 \u043a\u043b\u044e\u0447</p> <p><code>nano /etc/vsftpd.conf</code></p> <pre><code>ssl_enable=YES\nrsa_cert_file=/etc/ssl/certs/vsftpd.crt\nrsa_private_key_file=/etc/ssl/private/vsftpd.key\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\n</code></pre> <p><code>useradd -m -s /bin/bash ftpuser</code> \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u043c \u0438\u043c\u0435\u043d\u043d\u044b\u043c \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u043c \u0438 \u043e\u0431\u043e\u043b\u043e\u0447\u043a\u043e\u0439 bash <code>passwd ftpuser</code> \u0437\u0430\u0434\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e <code>echo \"ftpuser\" | tee -a /etc/vsftpd.chroot_list</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0441\u043f\u0438\u0441\u043e\u043a \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u044b\u0445 \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u043c \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u043c <code>echo \"ftpuser\" | tee -a /etc/vsftpd.user_list</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f <code>mkdir /home/ftpuser/ftp</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u044e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e <code>chown ftpuser:ftpuser ftp</code> \u043d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 \u0438 \u0433\u0440\u0443\u043f\u043f\u0443 \u0434\u043b\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 <code>chmod 555 ftp</code> \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435 \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 <code>mkdir /home/ftpuser/ftp/upload</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u043a\u0438 (\u0441 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u0437\u0430\u043f\u0438\u0441\u0438) <code>chown ftpuser:ftpuser upload</code> <code>chmod 775 upload</code> \u043f\u043e\u043b\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u0434\u043b\u044f \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 \u0438 \u0433\u0440\u0443\u043f\u043f\u044b</p>"},{"location":"Linux/#rsync","title":"rsync","text":"<p><code>rsync -options SRC DST</code></p> <p><code>-a</code> \u0440\u0435\u0436\u0438\u043c \u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u043a\u043e\u0433\u0434\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044e\u0442\u0441\u044f \u0432\u0441\u0435 \u0438\u0441\u0445\u043e\u0434\u043d\u044b\u0435 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u044b \u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 (\u0434\u0430\u0442\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f) <code>-b</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0439 \u043a\u043e\u043f\u0438\u0438 <code>-c</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u044b\u0445 \u0441\u0443\u043c\u043c \u0434\u043b\u044f \u0444\u0430\u0439\u043b\u043e\u0432 <code>-e</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0440\u0443\u0433\u043e\u0439 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 ssh) <code>-h</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0446\u0438\u0444\u0440\u044b \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435, \u043d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u043e\u043c \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f <code>-l</code> \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0438\u043c\u0432\u043e\u043b\u044c\u043d\u044b\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 <code>-L</code> \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0441\u0441\u044b\u043b\u043e\u043a <code>-p</code> \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u0434\u043b\u044f \u0444\u0430\u0439\u043b\u043e\u0432 <code>-q</code> \u043c\u0438\u043d\u0438\u043c\u0443\u043c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 <code>-u</code> \u043d\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c \u0431\u043e\u043b\u0435\u0435 \u043d\u043e\u0432\u044b\u0435 \u0444\u0430\u0439\u043b\u044b <code>-v</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f <code>-w</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043f\u043e\u043b\u043d\u043e\u0435 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0431\u0435\u0437 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 <code>-z</code> \u0441\u0436\u0438\u043c\u0430\u0442\u044c \u0444\u0430\u0439\u043b\u044b \u043f\u0435\u0440\u0435\u0434 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0435\u0439 <code>--delete</code> \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0443 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0435\u0442 \u0432 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u044f <code>--progress</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0444\u0430\u0439\u043b\u0430 (\u0432 %) <code>--stat</code> \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438</p> <p><code>rsync -zvh /home/lifailon /backup</code> \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0444\u0430\u0439\u043b\u043e\u0432 (skipping directory) \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 (\u0432 \u043f\u0440\u0435\u0434\u0435\u043b\u0430\u0445 \u043e\u0434\u043d\u043e\u0439 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u043d\u0430 \u0432\u043d\u0435\u0448\u043d\u0438\u0439 \u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c). \u041f\u0440\u0438 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0444\u0430\u0439\u043b\u043e\u0432 \u0432 \u0438\u0441\u0445\u043e\u0434\u043d\u043e\u0439 \u043f\u0430\u043f\u043a\u0435 \u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u043c \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u043c\u0435\u043d\u0438\u0442 \u0432\u0441\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 (\u0431\u0435\u0437 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438).</p> <p><code>nano /etc/rsyncd.conf</code></p> <pre><code>pid file = /var/run/rsyncd.pid\nlock file = /var/run/rsync.lock\nlog file = /var/log/rsync.log\n[share]\npath = /backup/\nhosts allow = 192.168.3.103\nhosts deny = *\nlist = true\nuid = lifailon\ngid = lifailon\nread only = false\n</code></pre> <p><code>chown kup:kup backup</code> \u0441\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 \u0438 \u0433\u0440\u0443\u043f\u043f\u0443 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 <code>chmod ug+rwx backup</code> \u0432\u044b\u0434\u0430\u0442\u044c \u0438\u043c \u043f\u043e\u043b\u043d\u044b\u0435 \u043f\u0440\u0430\u0432\u0430 (\u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f) <code>systemctl start rsync</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440</p> <p>\u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 (192.168.3.103) \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u043c \u043f\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438:</p> <p><code>rsync -avzh /backup/ kup@192.168.3.103:/tmp/backup/</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u043f\u0430\u043f\u043a\u0438 backup (\u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438) \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e Rsync \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442 SSH (\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439) \u0441 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u043c \u043f\u0430\u0440\u043e\u043b\u044f (\u0435\u0441\u043b\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043a\u043b\u044e\u0447). <code>rsync -avzhe \"ssh -p 2121\" /tmp/backup/ kup@192.168.21.121:/tmp/backup/</code> \u0435\u0441\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043d\u0435\u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u043f\u043e\u0440\u0442 <code>rsync -avzh /tmp/backup/ rsync://192.168.21.121:/share</code> \u044f\u0432\u043d\u043e \u0437\u0430\u0434\u0430\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u0430 Rsync \u041f\u0440\u0438 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0438\u0441\u0445\u043e\u0434\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432, \u0437\u0430\u043c\u0435\u043d\u0438\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0435\u0445 \u0444\u0430\u0439\u043b\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u044b\u043b\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u044b (sending incremental file list ./ test3) <code>rsync -avzh kup@192.168.3.103:/tmp/backup /tmp/backup/</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0441 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 <code>ssh-keygen -t rsa</code> \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u043f\u043e SSH \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0431\u0443\u0434\u0435\u0442 \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043b\u044e\u0447 \u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0433\u043e \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440, \u0447\u0442\u043e\u0431\u044b \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u043b\u0430 \u0431\u0435\u0437 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043f\u0430\u0440\u043e\u043b\u044f <code>ssh-copy-id -i /home/sk/.ssh/id_rsa.pub kup@192.168.21.10</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043a\u043b\u044e\u0447 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 \u0441 \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442\u044c \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f <code>00 03 * * * rsync -avzhe \"ssh -p 2121\" /tmp/backup/ kup@192.168.21.121:/tmp/backup/</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0449\u0438\u043a, \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u0432 \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c\u0441\u044f \u043a\u0430\u0436\u0434\u044b\u0439 \u0434\u0435\u043d\u044c \u0432 3 \u0447\u0430\u0441\u0430 \u043d\u043e\u0447\u0438</p>"},{"location":"Linux/#apache","title":"apache","text":"<p><code>apt install apache2</code> <code>cat /etc/apache2/apache2.conf</code> <code>cat /etc/apache2/ports.conf</code> <code>port=8443</code> <code>cat /etc/apache2/ports.conf | sed -r \"s/^Listen.+/Listen $port/\" &gt; /etc/apache2/ports.conf</code> <code>systemctl restart apache2</code> <code>systemctl status apache2</code> <code>ss -lpn | grep apache</code> <code>echo \"&lt;H1&gt;$(hostname)&lt;/H1&gt;\" &gt; /var/www/html/index.html</code></p>"},{"location":"Linux/#api_1","title":"api","text":"<p><code>mkdir /var/www/api &amp;&amp; touch /var/www/api/api.sh &amp;&amp; chmod +x /var/www/api/api.sh</code> <code>curl -s \"https://raw.githubusercontent.com/Lifailon/bash-api-server/rsa/www/api/api.sh\" &gt; /var/www/api/api.sh</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0440\u0438\u043c\u0435\u0440 \u0441 \u0448\u0430\u0431\u043b\u043e\u043d\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0430 api</p> <p><code>nano /var/www/api/api.sh</code></p> <pre><code>#!/bin/bash\nif [ \"$REQUEST_METHOD\" == \"GET\" ]\n    then\n    echo \"Content-type: application/json\"\n    echo\n    echo '{\"result\": \"ok\"}'\nelse\n    echo \"Content-type: text/plain\"\n    echo\n    echo \"Request method not supported\"\nfi\n</code></pre> <p><code>a2enmod auth_basic</code> \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u0431\u0430\u0437\u043e\u0432\u043e\u0439 HTTP \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 <code>htpasswd -b -c /etc/apache2/.htpasswd rest api</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c htpasswd \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 (\u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f rest \u0441 \u043f\u0430\u0440\u043e\u043b\u0435\u043c api)</p> <p><code>nano /etc/apache2/sites-available/api.conf</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c VirtualHost \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432</p> <pre><code>&lt;VirtualHost *:8443&gt;\n    DocumentRoot /var/www/html\n    # \u0421\u0432\u044f\u0437\u0430\u0442\u044c endpoint (\u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0432\u0441\u0435 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0438 \u0432 \u043f\u0443\u0442\u0438) \u0441 \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u044b\u043c \u0444\u0430\u0439\u043b\u043e\u043c\n    ScriptAlias /api /var/www/api/api.sh\n    # \u0412\u0441\u0435 \u043e\u043f\u0446\u0438\u0438, \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0435 \u0432\u043d\u0443\u0442\u0440\u044c \u0441\u0435\u043a\u0446\u0438\u0438 Directory, \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u044e\u0442\u0441\u044f \u043a \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438\n    &lt;Directory \"/var/www/api\"&gt;\n        # \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 CGI-\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0432\n        Options +ExecCGI\n        # \u041e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u0432\u0441\u0435 \u0444\u0430\u0439\u043b\u044b \u0441 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 sh \u043a\u0430\u043a CGI-\u0441\u043a\u0440\u0438\u043f\u0442\n        AddHandler cgi-script .sh\n        AllowOverride None\n        Require all granted\n    &lt;/Directory&gt;\n    # \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u0434\u043b\u044f endpoint\n    &lt;Location \"/api\"&gt;\n        AuthType Basic\n        AuthName \"Restricted Area\"\n        AuthUserFile /etc/apache2/.htpasswd\n        Require valid-user\n        SetHandler cgi-script\n        Options +ExecCGI\n    &lt;/Location&gt;\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n&lt;/VirtualHost&gt;\n</code></pre> <p><code>a2enmod cgi</code> \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c (en mod) Common Gateway Interface (CGI) <code>a2ensite api.conf</code> \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c VirtualHost (en site) <code>systemctl restart apache2</code> <code>tail -f /var/log/apache2/error.log</code> <code>tail -f /var/log/apache2/access.log</code></p> <p><code>curl -s -X GET http://127.0.0.1:8443/api -u rest:api | jq .result</code> <code>curl -s -X GET http://127.0.0.1:8443/api/info -u rest:api -H \"Content-Type: application/json\" | jq .content[]</code></p> <p><code>REQUEST_METHOD</code> \u043c\u0435\u0442\u043e\u0434 HTTP-\u0437\u0430\u043f\u0440\u043e\u0441\u0430 (GET, POST, HEAD \u0438 \u0442.\u0434.) <code>REQUEST_URI</code> \u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 URI \u0437\u0430\u043f\u0440\u043e\u0441\u0430 <code>QUERY_STRING</code> \u0441\u0442\u0440\u043e\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 URL <code>CONTENT_TYPE</code> \u0442\u0438\u043f \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0432 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, application/text) <code>CONTENT_LENGTH</code> \u0434\u043b\u0438\u043d\u0430 \u0442\u0435\u043b\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0432 \u0431\u0430\u0439\u0442\u0430\u0445 (\u0447\u0430\u0449\u0435, \u0434\u043b\u044f POST-\u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432) <code>read -n $CONTENT_LENGTH POST_DATA</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 Body \u0438\u0437 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0433\u043e \u0432\u0432\u043e\u0434\u0430 (stdin). <code>HTTP_STATUS</code> \u0447\u0438\u0442\u0430\u0435\u043c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \"Status: text\"), \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u0437\u0430\u0440\u0430\u043d\u0435\u0435 \u0438 \u0440\u0435\u0433\u043b\u0430\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432 \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0435\u043c <code>HTTP_USER_AGENT</code> \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0430\u0433\u0435\u043d\u0442\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438\u0437 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, curl/8.4.0) <code>REMOTE_ADDR</code> \u0430\u0434\u0440\u0435\u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 <code>REMOTE_PORT</code> \u043f\u043e\u0440\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 <code>SERVER_NAME</code> \u0430\u0434\u0440\u0435\u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>SERVER_PORT</code> \u043f\u043e\u0440\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>SCRIPT_NAME</code> \u043f\u0443\u0442\u044c \u0438 \u0438\u043c\u044f CGI-\u0441\u043a\u0440\u0438\u043f\u0442\u0430 <code>SERVER_SOFTWARE</code> \u0438\u043c\u044f \u0438 \u0432\u0435\u0440\u0441\u0438\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>SERVER_PROTOCOL</code> \u0432\u0435\u0440\u0441\u0438\u044f \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430 HTTP (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, HTTP/1.1) <code>HTTPS</code> \u0435\u0441\u043b\u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e, \u0442\u043e \u0437\u0430\u043f\u0440\u043e\u0441 \u0431\u044b\u043b \u0441\u0434\u0435\u043b\u0430\u043d \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c HTTPS <code>AUTH_TYPE</code> \u0442\u0438\u043f \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438, \u0435\u0441\u043b\u0438 \u043e\u043d \u0431\u044b\u043b \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d <code>REMOTE_USER</code> \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0435\u0441\u043b\u0438 \u0431\u044b\u043b\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0430 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f <code>DOCUMENT_ROOT</code> \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u0432\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440\u0430</p>"},{"location":"Linux/#status","title":"status","text":"<p><code>apachectl -M | grep status_module</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0439 \u043c\u043e\u0434\u0443\u043b\u044c \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438: status_module (shared) <code>nano /etc/apache2/mods-available/status.conf</code> <code>Require ip 192.168.3.0/24</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0434\u043b\u044f \u043a\u043e\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 http://127.0.0.1:8443/server-status <code>apachectl -t</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0441 (Syntax OK) <code>a2enmod status</code> \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c (Module status already enabled) <code>systemctl restart apache2</code> <code>netstat -tulpan | grep apache2</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043f\u043e\u0440\u0442 <code>curl http://127.0.0.1:8443/server-status?auto</code></p>"},{"location":"Linux/#webdav","title":"webdav","text":"<p><code>nano /etc/apache2/ports.conf</code></p> <pre><code>Listen 8443\nListen 2024\n</code></pre> <p><code>mkdir /var/www/webdav &amp;&amp; chown www-data:www-data /var/www/webdav</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u0430\u0442\u0430\u043b\u043e\u0433 \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0431\u0443\u0434\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u0447\u0435\u0440\u0435\u0437 WebDAV \u0438 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043d\u0435\u043c\u0443 \u0434\u043b\u044f www-data</p> <p><code>nano /etc/apache2/sites-available/webdav.conf</code></p> <pre><code>&lt;VirtualHost *:2024&gt;\n    ServerAdmin webmaster@localhost\n    DocumentRoot /var/www/webdav\n    Alias /webdav /var/www/webdav\n    &lt;Directory /var/www/webdav&gt;\n        Options Indexes FollowSymLinks\n        AllowOverride None\n        Require all granted\n        Dav On\n        AuthType Basic\n        AuthName \"WebDAV\"\n        AuthUserFile /etc/apache2/.htpasswd\n        Require valid-user\n    &lt;/Directory&gt;\n    ErrorLog ${APACHE_LOG_DIR}/webdav_error.log\n    CustomLog ${APACHE_LOG_DIR}/webdav_access.log combined\n&lt;/VirtualHost&gt;\n</code></pre> <p><code>a2enmod dav</code> <code>a2enmod dav_fs</code> <code>a2enmod auth_digest</code> <code>a2enmod authn_core</code> <code>a2enmod authn_file</code> <code>a2enmod authz_core</code> <code>a2enmod authz_user</code> <code>htpasswd /etc/apache2/.htpasswd admin</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f admin (\u043a\u043b\u044e\u0447 -\u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u0430) <code>a2ensite webdav</code> \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0441\u0430\u0439\u0442\u0430 <code>systemctl restart apache2</code></p>"},{"location":"Linux/#haproxy","title":"haproxy","text":"<p><code>apt install haproxy</code> <code>systemctl status haproxy</code></p> <p><code>/etc/default/haproxy</code></p> <pre><code>ENABLED=1\n</code></pre> <p><code>/etc/haproxy/haproxy.cfg</code></p> <pre><code>global\nlog 127.0.0.1 local0 notice\nmaxconn 10000\nnbproc 1\nuser haproxy\ngroup haproxy\ndaemon\n\ndefaults\nlog global\nmaxconn global\ntimeout client 5s\ntimeout server 5s\ntimeout connect 5s\n\nfrontend http_front\nmode http\nbind *:8081\n#bind *:443 ssl crt /etc/ssl/domain.ru/cert.pem \noption httplog\n###mode tcp\n###bind *:3389\n###option tcplog\nuse_backend http_back\n\nbackend http_back\nmode http\nbalance roundrobin\n###mode tcp\n###balance leastconn\noption httpchk GET / HTTP/1.1\\r\\nHost:\\ localhost\n###option tcp-check\n###tcp-check connect port 3389\n#server term1.domain.ru 192.168.55.30:443 ssl verify none weight 100 check inter 5s fall 5 rise 3\n#server term2.domain.ru 192.168.55.35:443 ssl verify none weight 100 check inter 5s fall 5 rise 3\nserver pi-hole-01 192.168.3.101:8081 weight 100 check inter 5s fall 5 rise 3\nserver netbox-01 192.168.3.104:8081 weight 100 check inter 5s fall 5 rise 3\n\nlisten stats\nbind *:8082\n#bind *:8080 ssl crt /etc/ssl/domain.ru/cert.pem \nmode http\nstats enable\nstats uri /\nstats auth admin:password\nstats show-legends\nstats show-node\nstats refresh 5s\n</code></pre> <p><code>haproxy -f /etc/haproxy/haproxy.cfg -c</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0441 (Configuration file is valid) <code>systemctl restart haproxy</code> \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 (\u043f\u0435\u0440\u0435\u0447\u0438\u0442\u0430\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e) <code>ss -lpn | grep 8081</code> <code>curl http://192.168.3.102:8081</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 http-\u0442\u0440\u0430\u0444\u0438\u043a\u0430 <code>http://192.168.3.102:8082</code> \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 <code>cat /var/log/haproxy.log</code> <code>journalctl -eu haproxy</code> <code>systemctl stop apache2</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043d\u0430 101</p> <ul> <li>options:</li> </ul> <p><code>maxconn</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 <code>nbproc</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 HAProxy <code>option httplog</code> \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0436\u0443\u0440\u043d\u0430\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 HTTP-\u0442\u0440\u0430\u0444\u0438\u043a\u0430, \u043f\u043e\u043b\u0435\u0437\u043d\u043e \u0434\u043b\u044f \u043e\u0442\u043b\u0430\u0434\u043a\u0438 \u0438 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u0447\u0435\u0440\u0435\u0437 HAProxy \u0438 \u0434\u0430\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u0440\u043e\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0442\u044c HTTP-\u0442\u0440\u0430\u0444\u0438\u043a \u0432 \u0436\u0443\u0440\u043d\u0430\u043b\u0435, \u0447\u0442\u043e\u0431\u044b \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u0438 \u043e\u0442\u0432\u0435\u0442\u044b <code>option httpchk</code> \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c HTTP-\u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c \u0432 \u0431\u044d\u043a\u0435\u043d\u0434\u0435, \u0447\u0442\u043e\u0431\u044b \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c, \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442 \u043b\u0438 \u043e\u043d\u0438, \u044d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u044b\u044f\u0432\u043b\u044f\u0442\u044c \u043d\u0435\u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0438 \u043f\u0435\u0440\u0435\u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043d\u0430 \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0435 <code>option httpchk GET / HTTP/1.1\\r\\nHost:\\ localhost</code> \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 GET-\u0437\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0439 \u043f\u0443\u0442\u044c (/) \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0432\u0435\u0440\u0441\u0438\u044e \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430 HTTP 1.1, Host:\\ localhost - \u044d\u0442\u043e \u0447\u0430\u0441\u0442\u044c \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0430 Host, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0442\u0430\u043a\u0436\u0435 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u0432 HTTP-\u0437\u0430\u043f\u0440\u043e\u0441 \u0438 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043d\u0430 \u0446\u0435\u043b\u0435\u0432\u043e\u0439 \u0445\u043e\u0441\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442\u0441\u044f <code>option tcp-check</code> \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442 \u043e\u0431\u0449\u0443\u044e \u0444\u0443\u043d\u043a\u0446\u0438\u044e TCP-\u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a \u0434\u043b\u044f \u0432\u0441\u0435\u0433\u043e \u0431\u044d\u043a\u044d\u043d\u0434\u0430, \u0431\u0435\u0437 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u043f\u043e\u0440\u0442 \u044f\u0432\u043d\u043e <code>tcp-check connect port 443</code> HAProxy \u0431\u0443\u0434\u0435\u0442 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0442\u044c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c\u0438 \u0432 \u0431\u044d\u043a\u0435\u043d\u0434\u0435 \u043d\u0430 \u043f\u043e\u0440\u0442\u0443 443 \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438, \u0447\u0442\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u044b \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0438 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u044b \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u043d\u0430 \u044d\u0442\u043e\u043c \u043f\u043e\u0440\u0442\u0443</p> <ul> <li>balance:</li> </ul> <p><code>Round Robin (roundrobin)</code> \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0439 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043f\u043e \u043e\u0447\u0435\u0440\u0435\u0434\u0438 <code>static-rr</code> \u043f\u043e\u0445\u043e\u0436 \u043d\u0430 roundrobin, \u043d\u043e \u043e\u043d \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 <code>Least Connections (leastconn)</code> \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440 \u0441 \u043d\u0430\u0438\u043c\u0435\u043d\u044c\u0448\u0438\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e\u043c \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439, \u044d\u0442\u043e \u043f\u043e\u043b\u0435\u0437\u043d\u043e, \u0435\u0441\u043b\u0438 \u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0440\u0430\u0437\u043d\u0430\u044f \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0438\u043b\u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u044c, \u0442\u0430\u043a \u043a\u0430\u043a \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u0431\u0443\u0434\u0443\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c\u0441\u044f \u043d\u0430 \u043c\u0435\u043d\u0435\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u044b <code>source</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 IP-\u0430\u0434\u0440\u0435\u0441 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 (\u043a\u043b\u0438\u0435\u043d\u0442\u0430) \u0434\u043b\u044f \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0438 \u043a \u043e\u0434\u043d\u043e\u043c\u0443 \u0438 \u0442\u043e\u043c\u0443 \u0436\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0443, \u044d\u0442\u043e \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442, \u0447\u0442\u043e \u043a\u043b\u0438\u0435\u043d\u0442 \u0432\u0441\u0435\u0433\u0434\u0430 \u0431\u0443\u0434\u0435\u0442 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c\u0441\u044f \u043a \u043e\u0434\u043d\u043e\u043c\u0443 \u0438 \u0442\u043e\u043c\u0443 \u0436\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0443, \u044d\u0442\u043e \u043f\u043e\u043b\u0435\u0437\u043d\u043e \u0434\u043b\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0441\u0435\u0430\u043d\u0441\u0430 <code>uri</code> \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u0441 \u043e\u0434\u043d\u0438\u043c \u0438 \u0442\u0435\u043c \u0436\u0435 URL (\u0434\u043e \u0437\u043d\u0430\u043a\u0430 \u0432\u043e\u043f\u0440\u043e\u0441\u0430) \u0431\u0443\u0434\u0443\u0442 \u043f\u0435\u0440\u0435\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c\u0441\u044f \u043d\u0430 \u043e\u0434\u0438\u043d \u0438 \u0442\u043e\u0442 \u0436\u0435 \u0441\u0435\u0440\u0432\u0435\u0440, \u044d\u0442\u043e \u043f\u043e\u043b\u0435\u0437\u043d\u043e \u0434\u043b\u044f \u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u043a\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043a \u0440\u0430\u0437\u043d\u044b\u043c \u0447\u0430\u0441\u0442\u044f\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f <code>rdp-cookie</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u043a\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 RDP (Remote Desktop Protocol), \u043e\u043d \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 cookie-\u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a RDP \u0434\u043b\u044f \u043f\u0440\u0438\u043d\u044f\u0442\u0438\u044f \u0440\u0435\u0448\u0435\u043d\u0438\u0439 \u043e \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432</p> <ul> <li>server:</li> </ul> <p><code>ssl</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 SSL <code>verify none</code> \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 <code>weight</code> \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043f\u043e \u0432\u0435\u0441\u0443, \u0435\u0441\u043b\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043d\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 <code>inter</code> \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442 \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b \u043c\u0435\u0436\u0434\u0443 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430\u043c\u0438, \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0434\u0432\u0435 \u0441\u0435\u043a\u0443\u043d\u0434\u044b <code>fall</code> \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043d\u0435\u0443\u0434\u0430\u0447\u043d\u044b\u0445 \u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a, \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0442\u0440\u0438 <code>rise</code> \u0437\u0430\u0434\u0430\u0435\u0442, \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u043e\u0445\u043e\u0434\u043d\u044b\u0445 \u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c, \u043f\u0440\u0435\u0436\u0434\u0435 \u0447\u0435\u043c \u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0440\u0430\u043d\u0435\u0435 \u043e\u0442\u043a\u0430\u0437\u0430\u0432\u0448\u0438\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 \u0432 \u0440\u043e\u0442\u0430\u0446\u0438\u044e, \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0434\u0432\u0430 <code>check port 443</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u044f\u0432\u043d\u0443\u044e \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u043f\u043e\u0440\u0442\u0430 \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 <code>check backup</code> \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442, \u0447\u0442\u043e \u0441\u0435\u0440\u0432\u0435\u0440 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u0432\u0441\u0435 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u044b \u0441\u0442\u0430\u043d\u043e\u0432\u044f\u0442\u0441\u044f \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u043c\u0438 \u0438 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0443\u0447\u0430\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0432 \u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u043a\u0435, \u043f\u043e\u043a\u0430 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u044b \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0438\u0440\u0443\u044e\u0442</p>"},{"location":"Linux/#keepalive","title":"keepalive","text":"<p>VRRP (Virtual Router Redundancy Protocol) - \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b, \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u043d\u044b\u0439 \u0434\u043b\u044f \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0442\u043e\u0440\u043e\u0432, \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0449\u0438\u0445 \u0440\u043e\u043b\u044c \u0448\u043b\u044e\u0437\u0430 VRRP-\u043f\u0430\u043a\u0435\u0442\u044b - \u044d\u0442\u043e \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u0437\u043b\u044b (\u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0442\u043e\u0440\u044b/\u0441\u0435\u0440\u0432\u0435\u0440\u0430) \u0432 VRRP-\u0433\u0440\u0443\u043f\u043f\u0435 \u0440\u0430\u0441\u0441\u044b\u043b\u0430\u044e\u0442 \u0434\u043b\u044f \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0441\u0432\u043e\u0435\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f VIP (Virtual IP) - \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 IP \u0430\u0434\u0440\u0435\u0441, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u043e\u0436\u0435\u0442 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0430\u0442\u044c\u0441\u044f \u043c\u0435\u0436\u0434\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c\u0438 \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0441\u0431\u043e\u044f (frondend \u0434\u043b\u044f haproxy/dns-rr), \u0443 \u043a\u043e\u0433\u043e \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0432 \u0441\u0435\u0442\u0435\u0432\u043e\u043c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435 \u043f\u0440\u043e\u043f\u0438\u0441\u0430\u043d VIP, \u0442\u043e\u0442 \u0441\u0435\u0440\u0432\u0435\u0440 \u0438 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 Master - \u0441\u0435\u0440\u0432\u0435\u0440, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0430\u043a\u0442\u0438\u0432\u0435\u043d VIP (\u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 VRRP-\u043f\u0430\u043a\u0435\u0442\u044b \u043d\u0430 backup nodes) Backup - \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u0441\u044f VIP, \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0441\u0431\u043e\u044f \u043c\u0430\u0441\u0442\u0435\u0440\u0430 (\u0441\u043b\u0435\u0434\u0438\u043c \u0437\u0430 \u043c\u0430\u0441\u0442\u0435\u0440\u043e\u043c) VRID (virtual_router_id) - \u0441\u0435\u0440\u0432\u0435\u0440\u0430, \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u043d\u044b\u0435 \u043e\u0431\u0449\u0438\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u043c IP (VIP) \u043e\u0431\u0440\u0430\u0437\u0443\u044e\u0442 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u043e\u0443\u0442\u0435\u0440, \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e, \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043e\u0442 1 \u0434\u043e 255. \u0421\u0435\u0440\u0432\u0435\u0440 \u043c\u043e\u0436\u0435\u0442 \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0432 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 VRID, \u043f\u0440\u0438 \u044d\u0442\u043e\u043c \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 VRID \u0434\u043e\u043b\u0436\u043d\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 IP \u0430\u0434\u0440\u0435\u0441\u0430. Master \u0441\u0435\u0440\u0432\u0435\u0440 \u0441 \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u043c \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b\u043e\u043c \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 VRRP \u043f\u0430\u043a\u0435\u0442\u044b \u043d\u0430 \u0437\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 multicast (\u043c\u043d\u043e\u0433\u043e\u0430\u0434\u0440\u0435\u0441\u043d\u043e\u0439) \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0438 \u0438\u043b\u0438 unicast \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 ip-\u0430\u0434\u0440\u0435\u0441\u0430, \u0430 \u0432\u0441\u0435 backup/slave \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0441\u043b\u0443\u0448\u0430\u044e\u0442 \u044d\u0442\u043e\u0442 \u0430\u0434\u0440\u0435\u0441. \u0415\u0441\u043b\u0438 Slave \u0441\u0435\u0440\u0432\u0435\u0440 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u043f\u0430\u043a\u0435\u0442\u044b, \u043e\u043d \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0443 \u0432\u044b\u0431\u043e\u0440\u0430 Master \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u043e\u043c, \u0438 \u0435\u0441\u043b\u0438 \u043e\u043d \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0438\u0442 \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 Master, \u0442\u043e \u0443 \u043d\u0435\u0433\u043e \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442 VIP (\u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441) \u0438 \u043e\u0442\u0440\u0430\u0432\u043b\u044f\u0435\u0442 gratuitous ARP. Gratuitous ARP - \u044d\u0442\u043e \u0432\u0438\u0434 ARP \u043e\u0442\u0432\u0435\u0442\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 MAC \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u043d\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043c\u043c\u0443\u0442\u0430\u0442\u043e\u0440\u0430\u0445, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0438\u043d\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e \u0441\u043c\u0435\u043d\u0435 \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e IP-\u0430\u0434\u0440\u0435\u0441\u0430 \u0438 MAC-\u0430\u0434\u0440\u0435\u0441\u0430 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u0440\u0430\u0444\u0438\u043a\u0430. \u041f\u0440\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0435 VRRP, \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0430\u0434\u0440\u0435\u0441\u0430 \u0434\u043b\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e IP \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0440\u0435\u0430\u043b\u044c\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430, \u0442\u0430\u043a \u043a\u0430\u043a, \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0441\u0431\u043e\u044f, \u0435\u0433\u043e \u0430\u0434\u0440\u0435\u0441 \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u0441\u044f \u043d\u0430 \u0441\u043e\u0441\u0435\u0434\u043d\u0438\u0439, \u0438 \u043f\u0440\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438, \u043e\u043d \u043e\u043a\u0430\u0436\u0435\u0442\u0441\u044f \u0438\u0437\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c \u043e\u0442 \u0441\u0435\u0442\u0438, \u0438 \u0447\u0442\u043e\u0431\u044b \u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0441\u0432\u043e\u0439 \u0430\u0434\u0440\u0435\u0441, \u043d\u0443\u0436\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432 \u0441\u0435\u0442\u044c VRRP \u043f\u0430\u043a\u0435\u0442, \u043d\u043e \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 IP \u0430\u0434\u0440\u0435\u0441\u0430, \u0441 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u044d\u0442\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c.</p> <p><code>/etc/keepalived/keepalived.conf</code></p> <pre><code>global_defs {\n    enable_script_security\n}\n\nvrrp_script nginx_check {\n    script \"/usr/bin/curl http://127.0.0.1\"\n    interval 5\n    user nginx\n}\n\nvrrp_instance web {\n    state MASTER # \u043d\u0430 \u0432\u0442\u043e\u0440\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0435 BACKUP\n    interface ens33\n    virtual_router_id 110\n    priority 255 # \u043d\u0430 \u0432\u0442\u043e\u0440\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0435 100\n    advert_int 2\n    notify /etc/keepalived/notify-web.sh root\n    virtual_ipaddress {\n        192.168.3.110\n    }\n    track_interface {\n        ens333\n    }\n    track_script {\n        nginx_check\n    }\n}\n</code></pre> <p><code>state &lt;MASTER|BACKUP&gt;</code> \u043d\u0430\u0447\u0430\u043b\u044c\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435, \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 nopreempt \u0435\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0435 \u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 - BACKUP <code>interface</code> \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c VRRP \u0438 \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0442\u044c\u0441\u044f VIP <code>virtual_router_id &lt;0-255&gt;</code> \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 VRRP \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430, \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u0442\u044c \u043d\u0430 \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445 \u043e\u0434\u043d\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b <code>priority &lt;0-255&gt;</code> \u0437\u0430\u0434\u0430\u0435\u0442 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 \u043f\u0440\u0438 \u0432\u044b\u0431\u043e\u0440\u0435 MASTER, \u0441\u0435\u0440\u0432\u0435\u0440 \u0441 \u0431\u043e\u043b\u044c\u0448\u0438\u043c \u0447\u0438\u0441\u043b\u043e\u043c \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u0430 \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f MASTER <code>advert_int &lt;\u0447\u0438\u0441\u043b\u043e \u0441\u0435\u043a\u0443\u043d\u0434&gt;</code> \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442, \u0441 \u043a\u0430\u043a\u043e\u0439 \u043f\u0435\u0440\u0438\u043e\u0434\u0438\u0447\u043d\u043e\u0441\u0442\u044c\u044e \u043c\u0430\u0441\u0442\u0435\u0440 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u043e\u0431\u0449\u0430\u0442\u044c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u043c \u043e \u0441\u0435\u0431\u0435, \u0438 \u0435\u0441\u043b\u0438 \u043f\u043e \u0438\u0441\u0442\u0435\u0447\u0435\u043d\u0438\u044e \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u0435\u0440\u0438\u043e\u0434\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0442 \u043e\u0442 \u043c\u0430\u0441\u0442\u0435\u0440\u0430 \u0448\u0438\u0440\u043e\u043a\u043e\u0432\u0435\u0449\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u0430\u043a\u0435\u0442, \u0442\u043e \u043e\u043d\u0438 \u0438\u043d\u0438\u0446\u0438\u0438\u0440\u0443\u044e\u0442 \u0432\u044b\u0431\u043e\u0440\u044b \u043d\u043e\u0432\u043e\u0433\u043e \u043c\u0430\u0441\u0442\u0435\u0440\u0430 <code>nopreempt</code> \u0435\u0441\u043b\u0438 \u043c\u0430\u0441\u0442\u0435\u0440 \u043f\u0440\u043e\u043f\u0430\u043b \u0438\u0437 \u0441\u0435\u0442\u0438, \u0438 \u0431\u044b\u043b \u0432\u044b\u0431\u0440\u0430\u043d \u043d\u043e\u0432\u044b\u0439 \u043c\u0430\u0441\u0442\u0435\u0440 \u0441 \u043c\u0435\u043d\u044c\u0448\u0438\u043c \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u043e\u043c, \u0442\u043e \u043f\u043e \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u0441\u0442\u0430\u0440\u0448\u0435\u0433\u043e \u043c\u0430\u0441\u0442\u0435\u0440\u0430, \u043e\u043d \u043e\u0441\u0442\u0430\u043d\u0435\u0442\u0441\u044f \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438 BACKUP, \u043f\u043e\u043a\u0430 \u043d\u043e\u0432\u044b\u0439 \u043c\u0430\u0441\u0442\u0435\u0440 \u043d\u0435 \u043e\u0442\u0432\u0430\u043b\u0438\u0442\u0441\u044f <code>preempt_delay</code> \u0447\u0442\u043e \u0431\u044b \u043c\u0430\u0441\u0442\u0435\u0440\u043e\u043c \u0431\u044b\u043b \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440, \u0442\u043e \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0443 nopreempt \u043d\u0430 preempt_delay <code>notify</code> \u0441\u043a\u0440\u0438\u043f\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c\u0441\u044f \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430, \u0438 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043e\u0442 \u0438\u043c\u0435\u043d\u0438 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0434\u0430\u043d\u043d\u044b\u0439 \u0441\u043a\u0440\u0438\u043f\u0442 \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c\u0441\u044f (\u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438\u043b\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u043d\u0430 \u043f\u043e\u0447\u0442\u0443) <code>virtual_ipaddress</code> \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 IP-\u0430\u0434\u0440\u0435\u0441 (VIP), \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438 MASTER, \u0434\u043e\u043b\u0436\u043d\u044b \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u0442\u044c \u043d\u0430 \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445 \u0432\u043d\u0443\u0442\u0440\u0438 VRRP \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 <code>track_interface</code> \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432, \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0438\u0442 VRRP \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 FAULT, \u0435\u0441\u043b\u0438 \u043e\u0434\u0438\u043d \u0438\u0437 \u043f\u0435\u0440\u0435\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438 DOWN <code>track_script</code> \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0441\u043a\u0440\u0438\u043f\u0442\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c 0 \u0435\u0441\u043b\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u043b\u0430\u0441\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u043b\u0438 1, \u0435\u0441\u043b\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u043b\u0430\u0441\u044c \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439 <code>fall &lt;\u0447\u0438\u0441\u043b\u043e&gt;</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0430\u0437, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0441\u043a\u0440\u0438\u043f\u0442 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043d\u0443\u043b\u0435\u0432\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u043f\u0440\u0438 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 FAULT <code>rise &lt;\u0447\u0438\u0441\u043b\u043e&gt;</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0430\u0437, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0441\u043a\u0440\u0438\u043f\u0442 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0443\u043b\u0435\u0432\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u043f\u0440\u0438 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0432\u044b\u0439\u0442\u0438 \u0438\u0437 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f FAULT <code>timeout &lt;\u0447\u0438\u0441\u043b\u043e&gt;</code> \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f, \u043f\u043e\u043a\u0430 \u0441\u043a\u0440\u0438\u043f\u0442 \u0432\u0435\u0440\u043d\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442, \u043f\u043e\u0441\u043b\u0435 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043d\u0435\u043d\u0443\u043b\u0435\u0432\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435</p> <p><code>journalctl -u keepalived</code> <code>cat /var/log/messages | grep -i keepalived</code> <code>tail /var/run/keepalived.INSTANCE.web.state</code></p>"},{"location":"MarkupLanguages/","title":"Markup Languages","text":""},{"location":"MarkupLanguages/#html","title":"HTML","text":""},{"location":"MarkupLanguages/#convertfrom-html","title":"ConvertFrom-Html","text":"<pre><code>function ConvertFrom-Html {\n    param (\n        [Parameter(ValueFromPipeline)]$url\n    )\n    $irm = Invoke-RestMethod $url\n    $HTMLFile = New-Object -ComObject HTMLFile\n    $Bytes = [System.Text.Encoding]::Unicode.GetBytes($irm)\n    $HTMLFile.write($Bytes)\n    ($HTMLFile.all | where {$_.tagname -eq \"body\"}).innerText\n}\n\n$apache_status = \"http://192.168.3.102/server-status\"\n$apache_status | ConvertFrom-Html\n</code></pre>"},{"location":"MarkupLanguages/#convertto-html","title":"ConvertTo-Html","text":"<p><code>Get-Process | select Name, CPU | ConvertTo-Html -As Table &gt; \"$home\\desktop\\proc-table.html\"</code> \u0432\u044b\u0432\u043e\u0434 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 List (Format-List) \u0438\u043b\u0438 Table (Format-Table)</p> <pre><code>$servers = \"ya.ru\",\"ya.com\",\"google.com\"\n$path = \"$home\\Desktop\\Ping.html\" \n$header = @\"\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"en\" xml:lang=\"en\"&gt;\n&lt;head&gt;\n&lt;title&gt;\u041e\u0442\u0447\u0435\u0442 \u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432&lt;/title&gt;\n&lt;style type=\"text/css\"&gt;\n&lt;!--\nbody {\nbackground-color: #E0E0E0;\nfont-family: sans-serif\n}\ntable, th, td {\nbackground-color: white;\nborder-collapse:collapse;\nborder: 1px solid black;\npadding: 5px\n}\n--&gt;\n&lt;/style&gt;\n\"@\n$body = @\"\n&lt;h1&gt;Ping status&lt;/h1&gt;\n&lt;p&gt;$(get-date -Format \"dd.MM.yyyy hh:mm\").&lt;/p&gt;\n\"@\n$results = foreach ($server in $servers) { \n    if (Test-Connection $server -Count 1 -ea 0 -Quiet) { \n        $status = \"Up\" \n    }\n    else { \n        $status = \"Down\"\n    }\n    [PSCustomObject]@{\n        Name = $server\n        Status = $status\n    }\n}\n$results | ConvertTo-Html -head $header -body $body | foreach {\n    $_ -replace \"&lt;td&gt;Down&lt;/td&gt;\",\"&lt;td style='background-color:#FF8080'&gt;Down&lt;/td&gt;\" -replace \"&lt;td&gt;Up&lt;/td&gt;\",\"&lt;td style='background-color:#5BCCF3'&gt;Up&lt;/td&gt;\"\n} | Out-File $path\nInvoke-Item $path\n</code></pre>"},{"location":"MarkupLanguages/#pswritehtml","title":"PSWriteHTML","text":"<pre><code>Import-Module PSWriteHTML\n(Get-Module PSWriteHTML).ExportedCommands\nGet-Service | Out-GridHtml -FilePath ~\\Desktop\\Get-Service-Out-GridHtml.html\n</code></pre>"},{"location":"MarkupLanguages/#htmlreport","title":"HtmlReport","text":"<pre><code>Import-Module HtmlReport\n$topVM = ps | Sort PrivateMemorySize -Descending | Select -First 10 | %{,@(($_.ProcessName + \" \" + $_.Id), $_.PrivateMemorySize)}\n$topCPU = ps | Sort CPU -Descending | Select -First 10 | %{,@(($_.ProcessName + \" \" + $_.Id), $_.CPU)}\nNew-Report -Title \"Piggy Processes\" -Input {\nNew-Chart Bar \"Top VM Users\" -input $topVm\nNew-Chart Column \"Top CPU Overall\" -input $topCPU\nps | Select ProcessName, Id, CPU, WorkingSet, *MemorySize | New-Table \"All Processes\"\n} &gt; ~\\Desktop\\Get-Process-HtmlReport.html\n</code></pre>"},{"location":"MarkupLanguages/#htmlagilitypack","title":"HtmlAgilityPack","text":"<p>Source</p> <pre><code># \u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 C#, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u0430\u0440\u0441\u0438\u0442\u044c HTML-\u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b, \u0432\u044b\u0431\u0438\u0440\u0430\u0442\u044c \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b DOM \u0438 \u0438\u0437\u0432\u043b\u0435\u043a\u0430\u0442\u044c \u0438\u0437 \u043d\u0438\u0445 \u0434\u0430\u043d\u043d\u044b\u0435\nAdd-Type -Path \"C:\\Users\\Lifailon\\Downloads\\HtmlAgilityPack\\Net40\\HtmlAgilityPack.dll\"\n$title = \"\u043d\u043e\u0432\u043e\u0431\u0440\u0430\u043d\u0435\u0446\"\n$url = \"http://fasts-torrent.net\"\n$ep = \"engine/ajax/search_torrent.php?title=$title\"\n$html = Invoke-RestMethod \"$url/$ep\"\n# \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430 HtmlDocument \u0438\u0437 HtmlAgilityPack, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 HTML-\u043a\u043e\u0434\u0430\n$HtmlDocument = New-Object HtmlAgilityPack.HtmlDocument\n# \u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 HTML \u0432 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043a\u0442 HtmlDocument\n$HtmlDocument.LoadHtml($html)\n$torrents = @()\n# \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 XPath \u0434\u043b\u044f \u0432\u044b\u0431\u043e\u0440\u0430 \u0432\u0441\u0435\u0445 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 &lt;tr&gt; (\u0441\u0442\u0440\u043e\u043a \u0442\u0430\u0431\u043b\u0438\u0446\u044b) \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0435\n$HtmlDocument.DocumentNode.SelectNodes(\"//tr\") | ForEach-Object {\n    # \u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0442\u0430\u0431\u043b\u0438\u0446\u044b \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u043c \u043a\u043b\u0430\u0441\u0441\u044b, \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0440\u0430\u0437\u0434\u0430\u0447\u0438, \u0440\u0430\u0437\u043c\u0435\u0440\u0443 \u0438 \u0441\u0441\u044b\u043b\u043a\u0435 \u0434\u043b\u044f \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u044f.\n    $titleNode = $_.SelectSingleNode(\".//td[@class='torrent-title']\")\n    $sizeNode = $_.SelectSingleNode(\".//td[@class='torrent-sp']\")\n    $downloadLinkNode = $_.SelectSingleNode(\".//td[@class='torrent-d-btn']/a\")\n    # \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c, \u0447\u0442\u043e \u0432\u0441\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u043d\u0430\u0439\u0434\u0435\u043d\u044b\n    if ($titleNode -ne $null -and $sizeNode -ne $null -and $downloadLinkNode -ne $null) {\n        # \u0418\u0437\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u0430 \u0438\u0437 \u043a\u043b\u0430\u0441\u0441\u043e\u0432\n        $title = $titleNode.InnerText.Trim()\n        $size = $sizeNode.InnerText.Trim()\n        $downloadLink = $downloadLinkNode.Attributes[\"href\"].Value\n        $torrent = New-Object PSObject -Property @{\n            Title = $title\n            Size = $size\n            DownloadLink = \"$($url)$($downloadLink)\"\n        }\n        $torrents += $torrent\n    }\n}\n</code></pre> <p><code>$torrents</code></p> <pre><code>Title                                                                    Size     DownloadLink\n-----                                                                    ----     ------------\n\u041d\u043e\u0432\u043e\u0431\u0440\u0430\u043d\u0435\u0446 (6 \u0441\u0435\u0437\u043e\u043d: 1-3 \u0441\u0435\u0440\u0438\u0438 \u0438\u0437 13) (2024) WEBRip | RuDub              1,55 \u0413\u0411  http://fasts-torrent.net/download/449613/torrent/-6-1-3-13-2024-webrip-rudub/\n\u041d\u043e\u0432\u043e\u0431\u0440\u0430\u043d\u0435\u0446 (5 \u0441\u0435\u0437\u043e\u043d: 1-22 \u0441\u0435\u0440\u0438\u0438 \u0438\u0437 22) (2023) WEBRip 1080p | RuDub       54,15 \u0413\u0411 http://fasts-torrent.net/download/433749/torrent/-5-1-22-22-2023-webrip-1080p-rudub/\n\u041d\u043e\u0432\u043e\u0431\u0440\u0430\u043d\u0435\u0446 (5 \u0441\u0435\u0437\u043e\u043d: 1-22 \u0441\u0435\u0440\u0438\u0438 \u0438\u0437 22) (2023) WEBRip 720p | RuDub        30,14 \u0413\u0411 http://fasts-torrent.net/download/433750/torrent/-5-1-22-22-2023-webrip-720p-rudub/\n\u041d\u043e\u0432\u043e\u0431\u0440\u0430\u043d\u0435\u0446 (5 \u0441\u0435\u0437\u043e\u043d: 1-22 \u0441\u0435\u0440\u0438\u0438 \u0438\u0437 22) (2023) WEBRip | RuDub             11,55 \u0413\u0411 http://fasts-torrent.net/download/433751/torrent/-5-1-22-22-2023-webrip-rudub/\n\u041d\u043e\u0432\u043e\u0431\u0440\u0430\u043d\u0435\u0446 (4 \u0441\u0435\u0437\u043e\u043d: 1-22 \u0441\u0435\u0440\u0438\u0438 \u0438\u0437 22) (2021) WEB-DL 720p | RG.Paravozik 21.33 Gb http://fasts-torrent.net/download/418618/torrent/-4-1-22-22-2021-web-dl-720p-rgparavozik/\n\u041f\u043e\u043b\u0438\u0446\u0435\u0439\u0441\u043a\u0438\u0439 \u0441 \u043f\u043e\u043b\u043e\u0432\u0438\u043d\u043e\u0439: \u041d\u043e\u0432\u043e\u0431\u0440\u0430\u043d\u0435\u0446 (2017) WEB-DLRip 720p| \u0427\u0438\u0441\u0442\u044b\u0439 \u0437\u0432\u0443\u043a   3.41 Gb  http://fasts-torrent.net/download/254846/torrent/-2017-web-dlrip-720p-/\n\u041f\u043e\u043b\u0438\u0446\u0435\u0439\u0441\u043a\u0438\u0439 \u0441 \u043f\u043e\u043b\u043e\u0432\u0438\u043d\u043e\u0439: \u041d\u043e\u0432\u043e\u0431\u0440\u0430\u043d\u0435\u0446 (2017) WEB-DLRip | \u0427\u0438\u0441\u0442\u044b\u0439 \u0437\u0432\u0443\u043a       1.37 Gb  http://fasts-torrent.net/download/254845/torrent/-2017-web-dlrip-/\n\u041d\u043e\u0432\u043e\u0431\u0440\u0430\u043d\u0435\u0446 (2 \u0441\u0435\u0437\u043e\u043d: 1-20 \u0441\u0435\u0440\u0438\u0438 \u0438\u0437 20) (2019) WEBRip | BaibaKo           11.28 Gb http://fasts-torrent.net/download/364669/torrent/-2-1-20-20-2019-webrip-baibako/\n\u041d\u043e\u0432\u043e\u0431\u0440\u0430\u043d\u0435\u0446 (2 \u0441\u0435\u0437\u043e\u043d: 1-20 \u0441\u0435\u0440\u0438\u0438 \u0438\u0437 20) (2019) WEBRip 1080p | Octopus     45.97 Gb http://fasts-torrent.net/download/364161/torrent/-2-1-20-20-2019-webrip-1080p-octopus/\n\u041d\u043e\u0432\u043e\u0431\u0440\u0430\u043d\u0435\u0446 (2 \u0441\u0435\u0437\u043e\u043d: 1-20 \u0441\u0435\u0440\u0438\u0438 \u0438\u0437 20) (2019) WEB-DLRip | LostFilm       11.95 Gb http://fasts-torrent.net/download/364668/torrent/-2-1-20-20-2019-web-dlrip-lostfilm/\n</code></pre>"},{"location":"MarkupLanguages/#markdown","title":"Markdown","text":""},{"location":"MarkupLanguages/#convert-markdown-to-html","title":"Convert Markdown to HTML","text":"<pre><code>function ConvertFrom-MarkdownToHtml {\n    param (\n        [Parameter(Mandatory = $true,ValueFromPipeline = $true)]$Markdown\n    )\n    $html = $(Get-Content index.md -Raw | ConvertFrom-Markdown).html\n    @\"\n    &lt;!DOCTYPE html&gt;\n    &lt;html&gt;\n    &lt;head&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n    $html\n    &lt;/body&gt;\n    &lt;/html&gt;\n    \"@\n}\n</code></pre> <p><code>Get-Content index.md -Raw | ConvertFrom-MarkdownToHtml | Out-File index.html</code></p>"},{"location":"MarkupLanguages/#psmarkdown","title":"PSMarkdown","text":"<p>Install-Module PSMarkdown</p>"},{"location":"MarkupLanguages/#convertfrom-markdownv2","title":"ConvertFrom-MarkdownV2","text":"<pre><code>Function ConvertFrom-MarkdownV2 {\n    [CmdletBinding()]\n    [OutputType([PSObject])]\n    Param (\n        [Parameter(\n            Mandatory = $true,\n            Position = 0,\n            ValueFromPipeline = $true\n        )]\n        $InputObject\n    )\n    Begin {\n        $items = @()\n    }\n    Process {\n        $mddata = $InputObject\n        $data = $mddata | Where-Object {$_ -notmatch \"--\" }\n        $items += $data\n    }\n    End {\n       $object = $items -replace ' +', '' | ConvertFrom-Csv -Delimiter '|'\n       $object \n    }\n}\n</code></pre>"},{"location":"MarkupLanguages/#convertto-markdown","title":"ConvertTo-Markdown","text":"<pre><code>Function ConvertTo-Markdown {\n    [CmdletBinding()]\n    [OutputType([string])]\n    Param (\n        [Parameter(\n            Mandatory = $true,\n            Position = 0,\n            ValueFromPipeline = $true\n        )]\n        [PSObject[]]$InputObject\n    )\n    Begin {\n        $items = @()\n        $columns = @{}\n    }\n    Process {\n        ForEach($item in $InputObject) {\n            $items += $item\n            $item.PSObject.Properties | ForEach-Object {\n                if($null -ne $_.Value) {\n                    if(-not $columns.ContainsKey($_.Name) -or $columns[$_.Name] -lt $_.Value.ToString().Length) {\n                        $columns[$_.Name] = $_.Value.ToString().Length\n                    }\n                }\n            }\n        }\n    }\n    End {\n        ForEach($key in $($columns.Keys)) {\n            $columns[$key] = [Math]::Max($columns[$key], $key.Length)\n        }\n        $header = @()\n        ForEach($key in $columns.Keys) {\n            $header += ('{0,-' + $columns[$key] + '}') -f $key\n        }\n        $header -join ' | '\n        $separator = @()\n        ForEach($key in $columns.Keys) {\n            $separator += '-' * $columns[$key]\n        }\n        $separator -join ' | '\n        ForEach($item in $items) {\n            $values = @()\n            ForEach($key in $columns.Keys) {\n                $values += ('{0,-' + $columns[$key] + '}') -f $item.($key)\n            }\n            $values -join ' | '\n        }\n    }\n}\n</code></pre>"},{"location":"MarkupLanguages/#xml","title":"XML","text":"<pre><code>$xml = [xml](Get-Content $home\\desktop\\test.rdg)` \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 XML-\u0444\u0430\u0439\u043b\u0430\n$xml.load(\"$home\\desktop\\test.rdg\")` \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0444\u0430\u0439\u043b\n$xml.RDCMan.file.group.properties.name` \u0438\u043c\u0435\u043d\u0430 \u0433\u0440\u0443\u043f\u043f\n$xml.RDCMan.file.group.server.properties` \u0438\u043c\u0435\u043d\u0430 \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432\n$xml.RDCMan.file.group[3].server.properties` \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0432 4-\u0439 \u0433\u0440\u0443\u043f\u043f\u0435\n($xml.RDCMan.file.group[3].server.properties | ? name -like ADIRK).Name = \"New-Name\"` \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\n$xml.RDCMan.file.group[3].server[0].properties.displayName = \"New-displayName\" \n$xml.RDCMan.file.group[3].server[1].RemoveAll()` \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442 (2-\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 \u0432 \u0441\u043f\u0438\u0441\u043a\u0435)\n$xml.Save($file)` \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0432 \u0444\u0430\u0439\u043b\u0430\n</code></pre> <p><code>Get-Service | Export-Clixml -path $home\\desktop\\test.xml</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442 PowerShell \u0432 XML  <code>Import-Clixml -Path $home\\desktop\\test.xml</code> \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442 XML \u0432 PowerShell  <code>ConvertTo-Xml (Get-Service)</code></p>"},{"location":"MarkupLanguages/#get-credtoxml","title":"Get-CredToXML","text":"<pre><code>function Get-CredToXML {\n    param (\n        $CredFile = \"$home\\Documents\\cred.xml\"\n    )\n    if (Test-Path $CredFile) {\n        Import-Clixml -path $CredFile\n    }\n    elseif (!(Test-Path $CredFile)) {\n        $Cred = Get-Credential -Message \"Enter credential\"\n        if ($Cred -ne $null) {\n        $Cred | Export-CliXml -Path $CredFile\n        $Cred\n    }\n    else {\n        return\n    }\n    }\n}\n</code></pre> <p><code>$Cred = Get-CredToXML</code> <code>$Login = $Cred.UserName</code> <code>$PasswordText = $Cred.GetNetworkCredential().password</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u0432 \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u043c \u0432\u0438\u0434\u0435</p>"},{"location":"MarkupLanguages/#xmlwriter-extensible-markup-language","title":"XmlWriter (Extensible Markup Language)","text":"<pre><code>$XmlWriterSettings = New-Object System.Xml.XmlWriterSettings\n$XmlWriterSettings.Indent = $true` \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043e\u0442\u0441\u0442\u0443\u043f\u044b\n$XmlWriterSettings.IndentChars = \"    \"` \u0437\u0430\u0434\u0430\u0442\u044c \u043e\u0442\u0441\u0442\u0443\u043f\n\n$XmlFilePath = \"$home\\desktop\\test.xml\"\n$XmlObjectWriter = [System.XML.XmlWriter]::Create($XmlFilePath, $XmlWriterSettings)` \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\n$XmlObjectWriter.WriteStartDocument()` \u043d\u0430\u0447\u0430\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\n\n$XmlObjectWriter.WriteComment(\"Comment\")\n$XmlObjectWriter.WriteStartElement(\"Root\")` \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0442\u0430\u0440\u0442\u043e\u0432\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b\n    $XmlObjectWriter.WriteStartElement(\"Configuration\")` \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0435\u0440\u0432\u044b\u0439 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u0434\u043b\u044f BaseSettings\n        $XmlObjectWriter.WriteElementString(\"Language\",\"RU\")\n        $XmlObjectWriter.WriteStartElement(\"Fonts\")         # &lt;Fonts&gt;\n            $XmlObjectWriter.WriteElementString(\"Name\",\"Arial\")\n            $XmlObjectWriter.WriteElementString(\"Size\",\"12\")\n        $XmlObjectWriter.WriteEndElement()                  # &lt;/Fonts&gt;\n    $XmlObjectWriter.WriteEndElement()` \u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 &lt;/Configuration&gt;\n$XmlObjectWriter.WriteEndElement()` \u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 &lt;/Root&gt;\n\n$XmlObjectWriter.WriteEndDocument()` \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\n$XmlObjectWriter.Flush()\n$XmlObjectWriter.Close()\n</code></pre>"},{"location":"MarkupLanguages/#createelement","title":"CreateElement","text":"<pre><code>$xml = [xml](gc $home\\desktop\\test.xml)\n$xml.Root.Configuration.Fonts\n$NewElement = $xml.CreateElement(\"Fonts\")` \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u043a\u0443\u0434\u0430 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c\n$NewElement.set_InnerXML(\"&lt;Name&gt;Times New Roman&lt;/Name&gt;&lt;Size&gt;14&lt;/Size&gt;\")` \u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u043c\u0438 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b Fonts\n$xml.Root.Configuration.AppendChild($NewElement)` \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u043d\u043e\u0432\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u043e\u0439 \u0432 Configuration (\u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044c Fonts)\n$xml.Save(\"$home\\desktop\\test.xml\")\n</code></pre>"},{"location":"MarkupLanguages/#excel","title":"Excel","text":"<p><code>Install-Module -Name ImportExcel</code> <code>$data | Export-Excel .\\Data.xlsx</code> <code>$data = Import-Excel .\\Data.xlsx</code></p> <p><code>$data = ps</code> <code>$Chart = New-ExcelChartDefinition -XRange CPU -YRange WS -Title \"Process\" -NoLegend</code> <code>$data | Export-Excel .\\ps.xlsx -AutoNameRange -ExcelChartDefinition $Chart -Show</code></p>"},{"location":"MarkupLanguages/#csv","title":"CSV","text":"<p><code>Get-Service | Select Name,DisplayName,Status,StartType | Export-Csv -path \"$home\\Desktop\\Get-Service.csv\" -Append -Encoding Default</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 csv (-Encoding UTF8)  <code>Import-Csv \"$home\\Desktop\\Get-Service.csv\" -Delimiter \",\"</code> \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432</p> <pre><code>$data = ConvertFrom-Csv @\"\nRegion,State,Units,Price\nWest,Texas,927,923.71\n$null,Tennessee,466,770.67\n\"@\n</code></pre> <p><code>$systeminfo = systeminfo /FO csv | ConvertFrom-Csv</code> \u0432\u044b\u0432\u043e\u0434 \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b \u0432 CSV \u0438 \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0432 \u043e\u0431\u044a\u0435\u043a\u0442  <code>$systeminfo.\"\u041f\u043e\u043b\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043c \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438\"</code> <code>$systeminfo.\"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u0430\u044f \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043f\u0430\u043c\u044f\u0442\u044c\"</code></p>"},{"location":"MarkupLanguages/#json","title":"JSON","text":"<pre><code>$log = '\n{\n  \"log\": {\n    \"level\": 7\n  }\n}\n' | ConvertFrom-Json\n\nGet-Service | ConvertTo-Json\n\n$OOKLA  = '\n{\n\"result\" : \n{\"date\":1683534970,\"id\":\"14708271987\",\"connection_icon\":\"wireless\",\"download\":33418,\"upload\":35442,\"latency\":15,\"distance\":50,\"country_code\":\"RU\",\"server_id\":2707,\"server_name\":\"Bryansk\",\"sponsor_name\":\"DOM.RU\",\"sponsor_url\":null,\"connection_mode\":\"multi\",\"isp_name\":\"Resource Link\",\"isp_rating\":\"4.0\",\"test_rank\":63,\"test_grade\":\"B-\",\"test_rating\":4,\"idle_latency\":\"17\",\"download_latency\":\"116\",\"upload_latency\":\"75\",\"additional_servers\":\n[{\"server_id\":8191,\"server_name\":\"Bryansk\",\"sponsor_name\":\"SectorTelecom.ru\"},{\"server_id\":46278,\"server_name\":\"Fokino\",\"sponsor_name\":\"Fokks - Promyshlennaya avtomatika Ltd.\"},{\"server_id\":18218,\"server_name\":\"Bryansk\",\"sponsor_name\":\"RIA-link Ltd.\"}],\n\"path\":\"result\\u002F14708271987\",\"hasSecondary\":true\n}\n}\n' | ConvertFrom-Json\n$ookla.result\n</code></pre>"},{"location":"MarkupLanguages/#yaml","title":"YAML","text":"<pre><code>Import-Module PSYaml` \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0432 Docker/Ansible\n$netplan = \"\nnetwork:` \u0441\u043b\u043e\u0432\u0430\u0440\u044c \u043f\u043e \u0442\u0438\u043f\u0443 - \u043a\u043b\u044e\u0447 : \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441 \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u043c\u0438 \u0441\u043b\u043e\u0432\u0430\u0440\u044f\u043c\u0438\n  ethernets:\n    ens160:\n      dhcp4: yes\n      dhcp6: no\n      nameservers:\n        addresses:` [8.8.8.8, 1.1.1.1]` \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u0430\u043d\u043d\u044b\u0445 (\u0441\u0442\u0440\u043e\u043a)\n          - 8.8.8.8\n          - 1.1.1.1\n  version: 2\n\"\n$network = ConvertFrom-Yaml $netplan\n$network.Values.ethernets.ens160.nameservers\n\n$DataType = \"\nint: !!int 10.1\nflo: !!float 10.1\nstr: !!str string\nbool: !!bool` boolean\n\"\n</code></pre>"},{"location":"MarkupLanguages/#toml","title":"TOML","text":"<p><code>Install-Module -Name PSToml -Scope CurrentUser</code> \u0423\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u043c\u043e\u0434\u0443\u043b\u044c \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f toml (PSToml)  <code>$toml = Get-Content \"$home\\Documents\\Git\\lifailon.github.io\\hugo.toml\"</code> \u0427\u0438\u0442\u0430\u0435\u043c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 Hugo \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 toml  <code>$json = ConvertFrom-Toml $toml | ConvertTo-Json -Depth 3</code> \u041a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u0443\u0435\u043c TOML \u0432 JSON  <code>$json | Out-File \"$home\\Documents\\Git\\lifailon.github.io\\hugo.json\"</code> \u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 JSON</p>"},{"location":"MarkupLanguages/#convertfrom-string","title":"ConvertFrom-String","text":"<pre><code>'\nlog = \n{\n   level = 4;\n};\n' | ConvertFrom-String` \u0441\u043e\u0437\u0434\u0430\u0435\u0442 PSCustomObject (\u0440\u0430\u0437\u0431\u0438\u0432\u0430\u0435\u0442 \u043f\u043e \u043f\u0440\u043e\u0431\u0435\u043b\u0430\u043c, \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0432\u0441\u0435 \u043f\u0440\u043e\u0431\u0435\u043b\u044b \u0438 \u043f\u0443\u0441\u0442\u044b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438)\n</code></pre>"},{"location":"MarkupLanguages/#convertfrom-stringdata","title":"ConvertFrom-StringData","text":"<pre><code>\"\nkey1 = value1\nkey2 = value2\n\" | ConvertFrom-StringData # \u0441\u043e\u0437\u0434\u0430\u0435\u0442 Hashtable\n</code></pre>"},{"location":"MarkupLanguages/#pandoc","title":"Pandoc","text":"<pre><code>$release_latest = Invoke-RestMethod \"https://api.github.com/repos/jgm/pandoc/releases/latest\"\n$url = $($release_latest.assets | Where-Object name -match \"windows-x86_64.zip\").browser_download_url\nInvoke-RestMethod $url -OutFile $home\\Downloads\\pandoc.zip\nExpand-Archive -Path \"$home\\Downloads\\pandoc.zip\" -DestinationPath \"$home\\Downloads\\\"\n$path = $(Get-ChildItem \"$home\\Downloads\\pandoc-*\\*.exe\").FullName\nCopy-Item -Path $path -Destination \"C:\\Windows\\System32\\pandoc.exe\"\nRemove-Item \"$home\\Downloads\\pandoc*\" -Force -Recurse\n</code></pre> <p><code>pandoc -s README.md -o index.html</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0438\u0437 Markdown \u0432 HTML  <code>pandoc README.md -o index.html --css=styles.css</code> \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0438\u043b\u0438 \u0438\u0437 css  <code>pandoc -s index.html -o README.md</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0438\u0437 HTML \u0432 Markdown  <code>pandoc -s README.md -o README.docx</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0432 Word  <code>pandoc -s README.md -o README.epub</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0432 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u044b\u0445 \u0432\u0435\u0440\u0441\u0438\u0439 \u043a\u043d\u0438\u0433  <code>pandoc -s README.md -o README.pdf</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0432 PDF (\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f rsvg-convert)  <code>pandoc input.md -f markdown+hard_line_breaks -o output.md</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0438\u0437 markdown \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043e\u0431\u0440\u0430\u0442\u043d\u044b\u0439 \u0441\u043b\u044d\u0448 \u0432 \u043a\u043e\u043d\u0446\u0435 \u043a\u0430\u0436\u0434\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0430 (), \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0438\u0445 \u0434\u043e\u0431\u0430\u0432\u0438\u0442</p>"},{"location":"MarkupLanguages/#convert-excel-to-markdown","title":"Convert Excel to Markdown","text":"<pre><code>Import-Module ImportExcel\nImport-Excel -Path srv.xlsx | Export-Csv -Path $csvFilePath -NoTypeInformation -Encoding UTF8 # \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f Excel \u0432 csv\npandoc -s -f csv -t markdown input.csv -o output.md # \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0443 csv \u0432 markdown\n</code></pre>"},{"location":"MarkupLanguages/#ffmpeg","title":"FFmpeg","text":"<pre><code>$release_latest = Invoke-RestMethod \"https://api.github.com/repos/BtbN/FFmpeg-Builds/releases/latest\"\n$url = $($release_latest.assets | Where-Object name -match \"ffmpeg-master-latest-win64-gpl.zip\").browser_download_url\nInvoke-RestMethod $url -OutFile $home\\Downloads\\ffmpeg-master-latest-win64-gpl.zip\nExpand-Archive -Path \"$home\\Downloads\\ffmpeg-master-latest-win64-gpl.zip\" -DestinationPath \"$home\\Downloads\\\"\nCopy-Item -Path \"$home\\Downloads\\ffmpeg-master-latest-win64-gpl\\bin\\ffmpeg.exe\" -Destination \"C:\\Windows\\System32\\ffmpeg.exe\"\nRemove-Item \"$home\\Downloads\\ffmpeg-*\" -Force -Recurse\n</code></pre> <p><code>ffmpeg -i input.mp4 output.gif</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c mp4 \u0432 gif  <code>ffmpeg -i input.mp4 -filter_complex \"scale=1440:-1:flags=lanczos\" output.gif</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043d\u0430 \u0432\u044b\u0445\u043e\u0434\u0435  <code>ffmpeg -i input.mp4 -filter_complex \"scale=1440:-1:flags=lanczos\" -r 10 output.gif</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043a\u0430\u0434\u0440\u043e\u0432 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0443 \u043d\u0430 \u0432\u044b\u0445\u043e\u0434\u0435  <code>ffmpeg -i input.mp4 -filter_complex \"fps=5,scale=960:-1:flags=lanczos,split[s0][s1];[s0]palettegen=max_colors=32[p];[s1][p]paletteuse=dither=bayer\" output.gif</code> \u0441\u0436\u0430\u0442\u0438\u0435 \u0437\u0430 \u0441\u0447\u0435\u0442 \u0446\u0432\u0435\u0442\u043e\u0432\u043e\u0439 \u043f\u043e\u043b\u0438\u0442\u0440\u044b  <code>ffmpeg -i input.mp4 -ss 00:00:10 -frames:v 1 -q:v 1 output.jpg</code> \u0432\u044b\u0442\u0430\u0449\u0438\u0442\u044c \u0441\u043a\u0440\u0438\u043d\u0448\u043e\u0442 \u0438\u0437 \u0432\u0438\u0434\u0435\u043e \u043d\u0430 10 \u0441\u0435\u043a\u0443\u043d\u0434\u0435  <code>ffmpeg -i input.mp4 -ss 00:00:05 -to 00:00:10 -c copy output.mp4</code> \u0432\u044b\u0442\u0430\u0449\u0438\u0442\u044c \u043a\u0443\u0441\u043e\u043a \u0432\u0438\u0434\u0435\u043e  <code>ffmpeg -i \"%d.jpeg\" -framerate 2 -c:v libx264 -r 30 -pix_fmt yuv420p output.mp4</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0438\u0434\u0435\u043e \u0438\u0437 \u0444\u043e\u0442\u043e (1.jpeg, 2.jpeg \u0438 \u0442.\u0434.) \u0441 framerate (\u0447\u0430\u0441\u0442\u043e\u0442\u043e\u0439 \u043a\u0430\u0434\u0440\u043e\u0432) \u0432 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0435\u043c\u043e\u043c \u0432\u0438\u0434\u0435\u043e 2 \u043a\u0430\u0434\u0440\u0430 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0443  <code>ffmpeg -i \"rtsp://admin:password@192.168.3.201:554\" -rtsp_transport tcp -c:v copy -c:a aac -strict experimental output.mp4</code> \u0437\u0430\u043f\u0438\u0441\u044c \u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (copy) RTSP-\u043f\u043e\u0442\u043e\u043a\u0430 \u0441 \u043a\u0430\u043c\u0435\u0440\u044b \u0432\u0438\u0434\u0435\u043e\u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u044f (+ \u0430\u0443\u0434\u0438\u043e \u0432 \u043a\u043e\u0434\u0435\u043a\u0435 AAC) \u0432 \u0444\u0430\u0439\u043b  <code>ffmpeg -i \"rtsp://admin:password@192.168.3.201:554\" -rtsp_transport tcp -c:v copy -c:a aac -strict experimental -movflags +faststart+frag_keyframe+empty_moov output.mp4</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u043d\u0430\u0447\u0430\u043b\u043e \u0444\u0430\u0439\u043b\u0430, \u0447\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043d\u0430\u0447\u0430\u0442\u044c \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u0430 \u0432 \u0432\u0438\u0434\u0435\u043e\u043f\u043b\u0435\u0435\u0440\u0435 \u0434\u043e \u0435\u0433\u043e \u043f\u043e\u043b\u043d\u043e\u0439 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438  <code>ffmpeg -i \"rtsp://admin:password@192.168.3.201:554\" -rtsp_transport tcp -frames:v 1 -c:v mjpeg output.jpg</code> \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0441\u043a\u0440\u0438\u043d\u0448\u043e\u0442</p>"},{"location":"MarkupLanguages/#handbrake","title":"HandBrake","text":"<pre><code>$url = \"https://github.com/HandBrake/HandBrake/releases/download/1.8.0/HandBrakeCLI-1.8.0-win-x86_64.zip\"\nInvoke-RestMethod $url -OutFile $home\\Downloads\\HandBrakeCLI.zip\nExpand-Archive -Path $home\\Downloads\\HandBrakeCLI.zip -OutputPath \"$home\\Downloads\\\"\nCopy-Item -Path \"$home\\Downloads\\HandBrakeCLI.exe\" -Destination \"C:\\Windows\\System32\\HandBrakeCLI.exe\"\nRemove-Item \"$home\\Downloads\\doc\" -Force -Recurse\nRemove-Item \"$home\\Downloads\\HandBrakeCLI*\"\n</code></pre> <p><code>HandBrakeCLI -i input.mp4 -o output.mkv</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u0443\u0435\u0442 \u0432\u0438\u0434\u0435\u043e \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 mp4 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442 mkv \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a HandBrake <code>HandBrakeCLI -i input.mp4 -o output.mkv -q 20</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u0438\u0434\u0435\u043e 20, \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0432\u0430\u0440\u044c\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u043e\u0442 0 (\u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e) \u0434\u043e 51 (\u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e), \u0433\u0434\u0435 20 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0445\u043e\u0440\u043e\u0448\u0438\u043c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e\u043c \u0434\u043b\u044f \u0431\u043e\u043b\u044c\u0448\u0438\u043d\u0441\u0442\u0432\u0430 \u0432\u0438\u0434\u0435\u043e <code>HandBrakeCLI -i input.mp4 -o output.mkv -r 30</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0447\u0430\u0441\u0442\u043e\u0442\u0443 \u043a\u0430\u0434\u0440\u043e\u0432 \u043d\u0430 30 fps <code>HandBrakeCLI -i input.mp4 -o output.mkv --maxWidth 1280 --maxHeight 720</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u043d\u0430 1280\u0445720 <code>HandBrakeCLI -i input.mp4 -o output.mkv -b 1500</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0431\u0438\u0442\u0440\u0435\u0439\u0442 \u0432\u0438\u0434\u0435\u043e 1500 \u043a\u0431\u0438\u0442/\u0441 <code>HandBrakeCLI -i input.mp4 -o output.mkv -e x264</code> \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u0432\u0438\u0434\u0435\u043e \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u043a\u043e\u0434\u0435\u043a\u0430 x264 <code>HandBrakeCLI -i input.mp4 -o output.mp4 --crop 0:200:0:0</code> \u043e\u0431\u0440\u0435\u0437\u0430\u0442\u044c \u0432\u0438\u0434\u0435\u043e \u0441\u043d\u0438\u0437\u0443 \u043d\u0430 200px (\u0432\u0435\u0440\u0445:\u043d\u0438\u0437:\u043b\u0435\u0432\u043e:\u043f\u0440\u0430\u0432\u043e) <code>HandBrakeCLI -i input.mp4 -o output.mp4 --start-at duration:5 --stop-at duration:15</code> \u043e\u0431\u0440\u0435\u0437\u0430\u0442\u044c \u0432\u0438\u0434\u0435\u043e (\u043d\u0430 \u0432\u044b\u0445\u043e\u0434\u0435 \u0431\u0443\u0434\u0435\u0442 15-\u0441\u0435\u043a\u0443\u043d\u0434\u043d\u043e\u0435 \u0432\u0438\u0434\u0435\u043e \u0441 5 \u043f\u043e 20 \u0441\u0435\u043a\u0443\u043d\u0434\u0443)</p>"},{"location":"MarkupLanguages/#imagemagick","title":"ImageMagick","text":"<p>Source: ImageMagick</p> <p><code>magick identify -verbose PowerShell-Commands.png</code> \u0438\u0437\u0432\u043b\u0435\u0447\u044c \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f  <code>magick PowerShell-Commands.png output.jpg</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0444\u043e\u0440\u043c\u0430\u0442\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f  <code>magick PowerShell-Commands.png -resize 800x600 output.jpg</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 (\u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0438\u043b\u0438 \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c)  <code>magick PowerShell-Commands.png -crop 400x300+100+50 output.jpg</code> \u043e\u0431\u0440\u0435\u0437\u0430\u0442\u044c  <code>magick PowerShell-Commands.png -rotate 90 output.jpg</code> \u043f\u043e\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435  <code>magick PowerShell-Commands.png -fill white -pointsize 24 -gravity center -annotate +0+0 \"PowerShell\" output.jpg</code> \u043d\u0430\u043b\u043e\u0436\u0438\u0442\u044c \u0442\u0435\u043a\u0441\u0442 \u043d\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435  <code>magick PowerShell-Commands.png -brightness-contrast +20x+10 output.jpg</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u044f\u0440\u043a\u043e\u0441\u0442\u044c \u0438 \u043a\u043e\u043d\u0442\u0440\u0430\u0441\u0442\u043d\u043e\u0441\u0442\u044c  <code>magick convert -delay 100 1.png 2.png 3.png output.gif</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c gif \u0438\u0437 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0439  <code>magick convert image1.jpg image2.jpg -append output.jpg</code> \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u043e \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f</p>"},{"location":"MarkupLanguages/#youtube","title":"YouTube","text":"<pre><code>$release_latest = Invoke-RestMethod \"https://api.github.com/repos/yt-dlp/yt-dlp/releases/latest\"\n$url = $($release_latest.assets | Where-Object name -match \"yt-dlp.exe\").browser_download_url\nInvoke-RestMethod $url -OutFile \"C:\\Windows\\System32\\yt-dlp.exe\"\n</code></pre> <p><code>yt-dlp -F https://www.youtube.com/watch?v=gxplizjhqiw</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0444\u043e\u0440\u043c\u0430\u0442\u043e\u0432 <code>yt-dlp -J https://www.youtube.com/watch?v=gxplizjhqiw</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 JSON <code>yt-dlp -J https://www.youtube.com/watch?v=gxplizjhqiw | jq -r .formats.[].format</code> id - resolution (format_note) <code>yt-dlp -f 137 https://www.youtube.com/watch?v=gxplizjhqiw</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u0438\u0434\u0435\u043e \u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u043f\u043e id <code>yt-dlp -f bestaudio https://www.youtube.com/watch?v=gxplizjhqiw</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0430\u0443\u0434\u0438\u043e <code>yt-dlp -f best https://www.youtube.com/watch?v=gxplizjhqiw</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432\u0438\u0434\u0435\u043e \u0441 \u0430\u0443\u0434\u0438\u043e \u0432 \u043b\u0443\u0447\u0448\u0435\u043c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 <code>yt-dlp -f 'bestvideo[height&lt;=1080]+bestaudio/best[height&lt;=1080]' https://www.youtube.com/watch?v=gxplizjhqiw</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 <code>yt-dlp -r 2m https://www.youtube.com/watch?v=gxplizjhqiw</code> \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0442\u044c \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u043e 2 \u041c\u0411\u0438\u0442/\u0441</p> <pre><code>function Get-YouTube {\n    param (\n        $url\n    )\n    $result = yt-dlp -J $url\n    $($result | ConvertFrom-Json).formats | \n    Where-Object filesize -ne $null | \n    Select-Object format_id,\n    @{Name=\"FileSize\"; \n        Expression={[string]([int]($_.filesize / 1024kb)).ToString(\"0.0\")+\" Mb\"}\n    },\n    resolution,format_note,quality,fps,ext,language\n}\n\n$formats = Get-YouTube \"https://www.youtube.com/watch?v=gxplizjhqiw\"\n$video = $($formats | Where-Object format_note -match 1080 | Where-Object ext -match mp4)[-1].format_id\n$audio = $($formats | Where-Object resolution -match \"audio\" | Where-Object ext -match m4a)[-1].format_id\ncd \"$home\\Downloads\"\nyt-dlp -f $video+$audio https://www.youtube.com/watch?v=gxplizjhqiw -o '%(title)s.%(ext)s'\n</code></pre>"},{"location":"Modules/","title":"Modules","text":""},{"location":"Modules/#psm1","title":"psm1","text":"<p>\u0421\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0441 \u043c\u043e\u0434\u0443\u043b\u044f \u0438 \u0435\u0433\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432</p> <pre><code>function Get-Function {\n    &lt;#\n    .SYNOPSIS\n    \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435\n    .DESCRIPTION\n    \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435\n    .LINK\n    https://github.com/Lifailon/PS-Commands\n    #&gt;\n    param (\n        [Parameter(Mandatory,ValueFromPipeline)][string]$Text,\n        [ValidateSet(\"Test1\",\"Test2\")][string]$Provider = \"Test1\",\n        [ValidateRange(1,3)][int]$Number = 2\n    )\n    Write-Host Param Text: $Text\n    Write-Host Param Provider: $Provider\n    Write-Host Param Number: $Number\n}\n</code></pre> <p><code>Get-Function -Text Text1</code> <code>Get-Function -Text Text2 -Provider Test2 -Number 3</code></p>"},{"location":"Modules/#psd1","title":"psd1","text":"<p>\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0443\u043b\u044f</p> <pre><code>@{\n    RootModule        = \"Get-Function.psm1\"\n    ModuleVersion     = \"0.1\"\n    Author            = \"Lifailon\"\n    CompanyName       = \"Open Source Community\"\n    Copyright         = \"Apache-2.0\"\n    Description       = \"Function example\"\n    PowerShellVersion = \"7.2\"\n    PrivateData       = @{\n        PSData = @{\n            Tags         = @(\"Function\",\"Example\")\n            ProjectUri   = \"https://github.com/Lifailon/PS-Commands\"\n            LicenseUri   = \"https://github.com/Lifailon/Console-Translate/blob/rsa/LICENSE\"\n            ReleaseNotes = \"Second release\"\n        }\n    }\n}\n</code></pre>"},{"location":"Modules/#packagemanagement","title":"PackageManagement","text":"<p><code>Import-Module PackageManagement</code> \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c  <code>Get-Module PackageManagement</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043c\u043e\u0434\u0443\u043b\u0435  <code>Get-Command -Module PackageManagement</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u043b\u0435\u0442\u044b \u043c\u043e\u0434\u0443\u043b\u044f  <code>Get-Package</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043f\u0430\u043a\u0435\u0442\u044b PowerShellGallery  <code>Get-Package -ProviderName msi,Programs</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c <code>[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b TLS 1.2 (\u0435\u0441\u043b\u0438 \u043d\u0435 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u044b \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u044b TLS 1.0 \u0438 1.1)  <code>Get-PackageSource</code> \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043f\u0430\u043a\u0435\u0442\u043e\u0432  <code>Get-PackageProvider</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u043e\u0432 \u043f\u0430\u043a\u0435\u0442\u043e\u0432  <code>Get-PackageProvider | Where-Object Name -Match nuget</code> <code>Find-PackageProvider</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u043e\u0432 \u043f\u0430\u043a\u0435\u0442\u043e\u0432  <code>Find-PackageProvider nuget</code> <code>Install-PackageProvider NuGet -Force</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 nuget  <code>Install-PackageProvider PSGallery -Force</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a  <code>Install-PackageProvider Chocolatey -Force</code> <code>Set-PackageSource nuget -Trusted</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0443 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0438\u0437 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430  <code>Register-PSRepository -Name \"NuGet\" -SourceLocation \"https://www.nuget.org/api/v2\" -InstallationPolicy Trusted</code> \u0437\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f url (\u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0434\u043b\u044f Power Shell Core)  <code>Set-PackageSource -Name NuGet -Trusted</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e  <code>Find-Package PSEverything</code> \u043f\u043e\u0438\u0441\u043a \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u0432\u043e \u0432\u0441\u0435\u0445 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u0430\u0445  <code>Find-Package PSEverything -Provider NuGet</code> \u043f\u043e\u0438\u0441\u043a \u043f\u0430\u043a\u0435\u0442\u0430 \u0443 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430  <code>Install-Module PSEverything -Scope CurrentUser</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u0434\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Install-Package -Name VeeamLogParser -ProviderName PSGallery -scope CurrentUser</code> <code>Get-Command *Veeam*</code> <code>Import-Module -Name VeeamLogParser</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c  <code>Get-Module VeeamLogParser | select -ExpandProperty ExportedCommands</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u0443\u043d\u043a\u0446\u0438\u0439</p>"},{"location":"Modules/#winget","title":"winget","text":"<p>Source Web</p> <p><code>winget list</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432  <code>winget search VLC</code> \u043d\u0430\u0439\u0442\u0438 \u043f\u0430\u043a\u0435\u0442  <code>winget show VideoLAN.VLC</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u0430\u043a\u0435\u0442\u0435  <code>winget show VideoLAN.VLC --versions</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0432\u0435\u0440\u0441\u0438\u0439 \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438  <code>winget install VideoLAN.VLC</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442  <code>winget uninstall VideoLAN.VLC</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442  <code>winget download jqlang.jq</code> \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 (https://github.com/jqlang/jq/releases/download/jq-1.7/jq-windows-amd64.exe)  <code>winget install jqlang.jq</code> \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0432 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u0441\u0440\u0435\u0434\u0443 \u0438 \u043f\u0441\u0435\u0432\u0434\u043e\u043d\u0438\u043c \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 jq  <code>winget uninstall jqlang.jq</code></p>"},{"location":"Modules/#jqlang","title":"jqlang","text":"<pre><code>[uri]$url = $($(irm https://api.github.com/repos/jqlang/jq/releases/latest).assets.browser_download_url -match \"windows-amd64\").ToString() # \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0435\u0440\u0441\u0438\u044e latest \u043d\u0430 GitHub\nirm $url -OutFile \"C:\\Windows\\System32\\jq.exe\" # \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c jq.exe\n</code></pre>"},{"location":"Modules/#scoop","title":"Scoop","text":"<p><code>Set-ExecutionPolicy RemoteSigned -Scope CurrentUser</code> <code>irm get.scoop.sh | iex</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430  <code>scoop help</code> <code>scoop search jq</code> <code>scoop info jq</code> <code>(scoop info jq).version</code> <code>scoop cat jq</code> <code>scoop download jq</code> C:\\Users\\lifailon\\scoop\\cache  <code>scoop install jq</code> C:\\Users\\lifailon\\scoop\\apps\\jq\\1.7  <code>scoop list</code> <code>(scoop list).version</code> <code>scoop uninstall jq</code></p>"},{"location":"Modules/#chocolatey","title":"Chocolatey","text":"<pre><code>Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))\n</code></pre> <p><code>choco -v</code> <code>choco -help</code> <code>choco list</code> <code>choco install adobereader</code></p>"},{"location":"Modules/#nuget","title":"NuGet","text":"<p><code>Invoke-RestMethod https://dist.nuget.org/win-x86-commandline/latest/nuget.exe -OutFile \"$home\\Documents\\nuget.exe\"</code> <code>Invoke-Expression \"$home\\Documents\\nuget.exe search Selenium.WebDriver\"</code> <code>Invoke-Expression \"$home\\Documents\\nuget.exe install Selenium.WebDriver\"</code> <code>Get-Item $home\\Documents\\*Selenium*</code></p> <p><code>&amp; \"$home\\Documents\\nuget.exe\" list console-translate</code> <code>$nuget_api_key = \"&lt;API-KEY&gt;\"</code> <code>$source = \"https://api.nuget.org/v3/index.json\"</code> <code>$Name = \"Console-Translate\"</code> <code>$path = \"$home\\Documents\\$Name\"</code> <code>New-Item -Type Directory $path</code> <code>Copy-Item \"$home\\Documents\\Git\\$Name\\$Name\\0.2\\*\" \"$path\\\"</code> <code>Copy-Item \"$home\\Documents\\Git\\$Name\\LICENSE\" \"$path\\\"</code> <code>Copy-Item \"$home\\Documents\\Git\\$Name\\README.md\" \"$path\\\"</code></p> <pre><code>'&lt;?xml version=\"1.0\"?&gt;\n&lt;package &gt;\n  &lt;metadata&gt;\n    &lt;id&gt;Console-Translate&lt;/id&gt;\n    &lt;version&gt;0.2.2&lt;/version&gt;\n    &lt;authors&gt;Lifailon&lt;/authors&gt;\n    &lt;owners&gt;Lifailon&lt;/owners&gt;\n    &lt;description&gt;Cross-platform client for translating text in the console, uses API Google (edded public free token), MyMemory and DeepLX (no token required)&lt;/description&gt;\n    &lt;tags&gt;PowerShell, Module, Translate, api&lt;/tags&gt;\n    &lt;repository type=\"git\" url=\"https://github.com/Lifailon/Console-Translate\" /&gt;\n    &lt;projectUrl&gt;https://github.com/Lifailon/Console-Translate&lt;/projectUrl&gt;\n    &lt;licenseUrl&gt;https://github.com/Lifailon/Console-Translate/blob/rsa/LICENSE&lt;/licenseUrl&gt;\n    &lt;contentFiles&gt;\n      &lt;files include=\"Console-Translate.psm1\" buildAction=\"Content\" /&gt;\n      &lt;files include=\"Console-Translate.psd1\" buildAction=\"Content\" /&gt;\n      &lt;files include=\"lang-iso-639-1.csv\" buildAction=\"Content\" /&gt;\n      &lt;files include=\"README.md\" buildAction=\"Content\" /&gt;\n      &lt;files include=\"LICENSE\" buildAction=\"Content\" /&gt;\n    &lt;/contentFiles&gt;\n  &lt;/metadata&gt;\n&lt;/package&gt;' &gt; \"$path\\$Name.nuspec\"\n</code></pre> <p><code>Set-Location $path</code> <code>&amp; \"$home\\Documents\\nuget.exe\" pack \"$path\\$Name.nuspec\"</code> <code>&amp; \"$home\\Documents\\nuget.exe\" push \"$path\\$Name.0.2.2.nupkg\" -ApiKey $nuget_api_key -Source $source</code> <code>&amp; \"$home\\Documents\\nuget.exe\" push \"$path\\$Name.0.2.2.nupkg\" -ApiKey $nuget_api_key -Source $source -SkipDuplicate</code></p> <p><code>Install-Package Console-Translate -Source nuget.org</code> <code>Get-Package Console-Translate | select *</code></p> <p><code>Register-PSRepository -Name \"NuGet\" -SourceLocation \"https://www.nuget.org/api/v2\" -InstallationPolicy Trusted</code> <code>Get-PSRepository</code> <code>Find-Module -Name Console-Translate</code> <code>Install-Module Console-Translate -Repository NuGet</code></p> <p><code>&amp; \"$home\\Documents\\nuget.exe\" delete Console-Translate 0.2.0 -Source https://api.nuget.org/v3/index.json -ApiKey $nuget_api_key -NoPrompt</code></p>"},{"location":"Modules/#ps2exe","title":"PS2EXE","text":"<p><code>Install-Module ps2exe -Repository PSGallery</code> <code>Get-Module -ListAvailable</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043c\u043e\u0434\u0443\u043b\u0435\u0439  <code>-noConsole</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c GUI, \u0431\u0435\u0437 \u043e\u043a\u043d\u0430 \u043a\u043e\u043d\u0441\u043e\u043b\u0438 powershell  <code>-noOutput</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0432 \u0444\u043e\u043d\u0435  <code>-noError</code> \u0431\u0435\u0437 \u0432\u044b\u0432\u043e\u0434\u0430 \u043e\u0448\u0438\u0431\u043e\u043a  <code>-requireAdmin</code> \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430  <code>-credentialGUI</code> \u0432\u044b\u0432\u043e\u0434 \u0434\u0438\u0430\u043b\u043e\u0433\u043e\u0432\u043e\u0433\u043e \u043e\u043a\u043d\u0430 \u0434\u043b\u044f \u0432\u0432\u043e\u0434\u0430 \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445  <code>Invoke-ps2exe -inputFile \"$home\\Desktop\\WinEvent-Viewer-1.1.ps1\" -outputFile \"$home\\Desktop\\WEV-1.1.exe\" -iconFile \"$home\\Desktop\\log_48px.ico\" -title \"WinEvent-Viewer\" -noConsole -noOutput -noError</code></p>"},{"location":"Modules/#nssm","title":"NSSM","text":"<p><code>$powershell_Path = (Get-Command powershell).Source</code> <code>$NSSM_Path = (Get-Command \"C:\\WinPerf-Agent\\NSSM-2.24.exe\").Source</code> <code>$Script_Path = \"C:\\WinPerf-Agent\\WinPerf-Agent-1.1.ps1\"</code> <code>$Service_Name = \"WinPerf-Agent\"</code> <code>&amp; $NSSM_Path install $Service_Name $powershell_Path -ExecutionPolicy Bypass -NoProfile -f $Script_Path</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c Service  <code>&amp; $NSSM_Path start $Service_Name</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c  <code>&amp; $NSSM_Path status $Service_Name</code> \u0441\u0442\u0430\u0442\u0443\u0441  <code>$Service_Name | Restart-Service</code> \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c  <code>$Service_Name | Get-Service</code> \u0441\u0442\u0430\u0442\u0443\u0441  <code>$Service_Name | Stop-Service</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c  <code>&amp; $NSSM_Path set $Service_Name description \"Check performance CPU and report email\"</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435  <code>&amp; $NSSM_Path remove $Service_Name</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c</p>"},{"location":"Modules/#winapi","title":"WinAPI","text":"<p><code>Install-Module ps.win.api -Repository NuGet -AllowClobber</code> <code>Import-Module ps.win.api</code> <code>Get-Command -Module ps.win.api</code> <code>Start-WinAPI</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440  <code>Test-WinAPI</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>Stop-WinAPI</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440  <code>Read-WinAPI</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043b\u043e\u0433 \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438  <code>Get-Hardware</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u0432\u043e\u0434\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u043f\u043e\u0442\u043e\u043a\u043e\u0432 (\u0444\u043e\u043d\u043e\u0432\u044b\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439)  <code>Get-DiskPhysical</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0434\u0438\u0441\u043a\u043e\u0432, \u0438\u0445 \u0440\u0430\u0437\u043c\u0435\u0440, \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0438 \u0441\u0442\u0430\u0442\u0443\u0441  <code>Get-DiskPhysical -ComputerName 192.168.3.100 -Port 8443 -User rest -Pass api</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u0441 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u0441\u0435\u0440\u0432\u0435\u0440 WinAPI (\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0444\u0443\u043d\u043a\u0446\u0438\u0439 \u043c\u043e\u0434\u0443\u043b\u044f)  <code>Get-DiskLogical</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0434\u0438\u0441\u043a\u043e\u0432 (\u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0438\u0441\u043a\u0438), \u0438\u0445 \u0444\u0430\u0439\u043b\u043e\u0432\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430, \u043e\u0431\u0449\u0438\u0439 \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0432 \u0433\u0431 \u0438 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u0430\u0445  <code>Get-DiskPartition</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0434\u0438\u0441\u043a\u043e\u0432 (\u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442 \u0441\u043a\u0440\u044b\u0442\u044b\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u044b, \u0437\u0430\u0433\u0440\u0443\u0437\u043e\u0447\u043d\u044b\u0439 \u0438 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0431\u0430\u0439\u0442)  <code>Get-Smart</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0440\u0430\u0431\u043e\u0442\u044b \u0432\u0441\u0435\u0445 \u0434\u0438\u0441\u043a\u043e\u0432 \u0438 \u0442\u0435\u043a\u0443\u0449\u0430\u044f \u0442\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u0430  <code>Get-IOps</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439 \u0432\u0432\u043e\u0434\u0430/\u0432\u044b\u0432\u043e\u0434\u0430 \u0434\u0438\u0441\u043a\u043e\u0432\u043e\u0439 \u043f\u043e\u0434\u0441\u0438\u0441\u0442\u0435\u043c\u044b  <code>Get-Files</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0444\u0430\u0439\u043b\u0430\u0445 (\u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0434\u0430\u0442\u0443 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f, \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f, \u0434\u043e\u0441\u0442\u0443\u043f\u0430, \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439)  <code>Find-Process</code> \u043f\u043e\u0438\u0441\u043a \u043f\u0443\u0442\u0438 \u043a \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u043e\u043c\u0443 \u0444\u0430\u0439\u043b\u0443 \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e (\u043d\u0435 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u043e\u0433\u043e) \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f\u0445  <code>Get-ProcessPerformance</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430\u0445 (Get-Process) \u0432 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u043e-\u0447\u0438\u0442\u0430\u0435\u043c\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435  <code>Get-CPU</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435 \u044f\u0434\u0435\u0440 \u0438 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u0435 \u044f\u0434\u0440\u043e \u0438 \u043d\u0430 \u0432\u0441\u0435 \u0441\u0440\u0430\u0437\u0443 (\u0441\u0443\u043c\u043c\u0430\u0440\u043d\u043e\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f, \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0435 \u0432\u0440\u0435\u043c\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430)  <code>Get-MemorySize</code> \u0440\u0430\u0437\u043c\u0435\u0440 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439, \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438, \u0441\u0443\u043c\u043c\u0430\u0440\u043d\u043e\u0435 \u043f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u043c\u044f\u0442\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0438 \u043f\u0443\u0442\u044c \u043a \u0444\u0430\u0439\u043b\u0443 \u043f\u043e\u0434\u043a\u0430\u0447\u043a\u0438  <code>Get-MemorySlots</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0441\u043b\u043e\u0442\u043e\u0432 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438  <code>Get-NetInterfaceStat</code> \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 \u0437\u0430 \u0432\u0440\u0435\u043c\u044f \u0441 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b (\u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0438 \u0413\u0411)  <code>Get-NetInterfaceStat -Current</code> \u0442\u0435\u043a\u0443\u0449\u0430\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 (\u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0438 \u041c\u0411/c)  <code>Get-NetIpConfig</code> \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0432\u0441\u0435\u0445 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 (ip \u0438 mac-\u0430\u0434\u0440\u0435\u0441, \u0441\u0442\u0430\u0442\u0443\u0441 DHCP \u0441\u0435\u0440\u0432\u0435\u0440\u0430, \u0434\u0430\u0442\u0430 \u0430\u0440\u0435\u043d\u0434\u044b)  <code>Get-NetStat</code> \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u0430\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 (\u0438\u0437 Get-NetTCPConnection), \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0438\u043c\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430, \u0438\u043c\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0445\u043e\u0441\u0442\u0430 (\u0447\u0435\u0440\u0435\u0437 nslookup), \u0432\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 (\u043d\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f) \u0438 \u043f\u0443\u0442\u044c \u043a \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u043e\u043c\u0443 \u0444\u0430\u0439\u043b\u0443  <code>Get-Performance</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0438\u0437 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u043e\u0432 (Get-Counter) \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u043e-\u0447\u0438\u0442\u0430\u0435\u043c\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435  <code>Get-VideoCard</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0432\u0441\u0435\u0445 \u0432\u0438\u0434\u0435\u043e-\u043a\u0430\u0440\u0442\u0430\u0445 (\u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435, \u0447\u0430\u0441\u0442\u043e\u0442\u0430 \u0438 \u043e\u0431\u044a\u0435\u043c \u0432\u0438\u0434\u0435\u043e-\u043f\u0430\u043c\u044f\u0442\u0438)  <code>Get-Software</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043d\u043e\u0433\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f  <code>Get-WinUpdate</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 Windows (\u0434\u0430\u0442\u0430 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0438 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a)  <code>Get-Driver</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u043e\u0432 (\u0438\u043c\u044f, \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440, \u0432\u0435\u0440\u0441\u0438\u044f \u0438 \u0434\u0430\u0442\u0430 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438)</p>"},{"location":"Modules/#get-query","title":"Get-Query","text":"<p><code>Install-Module Get-Query -Repository NuGet</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c  <code>Get-Help Get-Query</code> <code>Get-Query localhost</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435\u0445 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u0438\u0445 \u0441\u0442\u0430\u0442\u0443\u0441 \u0438 \u0432\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e localhost)  <code>Get-Query 192.168.1.1.1 -proc</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e -user *)  <code>Get-Query 192.168.1.1.1 -proc -user username</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</p>"},{"location":"Modules/#console-translate","title":"Console-Translate","text":"<p><code>Install-Module Console-Translate -Repository NuGet</code> <code>Get-Translate \"Module for text translation\"</code> <code>Get-Translate \"\u041c\u043e\u0434\u0443\u043b\u044c \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0430 \u0442\u0435\u043a\u0441\u0442\u0430\"</code> <code>Get-Translate \"\u041f\u0440\u0438\u0432\u0435\u0442 world\" -LanguageSelected</code> \u0442.\u043a. \u0431\u043e\u043b\u044c\u0448\u0435 \u043b\u0430\u0442\u0438\u043d\u0441\u043a\u0438\u0445 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 (\u043d\u0430 1), \u0442\u043e \u043f\u0435\u0440\u0435\u0432\u043e\u0434 \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d \u043d\u0430 \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a  <code>Get-Translate \"Hello \u0434\u0440\u0443\u0433\" -LanguageSelected</code> \u043f\u0435\u0440\u0435\u0432\u043e\u0434 \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a  <code>Get-Translate -Text \"\u041c\u043e\u0434\u0443\u043b\u044c \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0430 \u0442\u0435\u043a\u0441\u0442\u0430\" -LanguageSource ru -LanguageTarget tr</code> <code>Get-Translate -Provider MyMemory -Text \"Hello World\" -Alternatives</code> \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0430 \u0438 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u044b\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0432\u044b\u0432\u043e\u0434\u0430  <code>Get-DeepLX \"Get select\" ru</code> <code>Start-DeepLX -Job</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440 \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430  <code>Start-DeepLX -Status</code> <code>Get-DeepLX -Server 192.168.3.99 -Text \"Module for text translation\" ru</code> <code>Stop-DeepLX</code> <code>Get-LanguageCode</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u0434\u043e\u0432 \u044f\u0437\u044b\u043a\u043e\u0432 \u043f\u043e \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u0443 ISO-639-1</p>"},{"location":"Modules/#hardwaremonitor","title":"HardwareMonitor","text":"<p><code>Install-Module HardwareMonitor -Repository NuGet -Scope AllUsers</code> <code>Install-LibreHardwareMonitor</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0438 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c LibreHardwareMonitor \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 (https://github.com/LibreHardwareMonitor/LibreHardwareMonitor)  <code>Install-OpenHardwareMonitor</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c OpenHardwareMonitor (https://github.com/openhardwaremonitor/openhardwaremonitor)  <code>Get-Sensor | Where-Object {($_.SensorName -match \"Temperature\") -or ($_.SensorType -match \"Temperature\")} | Format-Table</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c LibreHardwareMonitor \u0438 WMI/CIM (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e) \u0438 \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043f\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044e \u0434\u0430\u0442\u0447\u0438\u043a\u0430\u043c \u0438\u043b\u0438 \u0442\u0438\u043f\u0443 \u0441\u0435\u043d\u0441\u043e\u0440\u0430 \u0434\u043b\u044f \u0432\u044b\u0432\u043e\u0434\u0430 \u0434\u0430\u0442\u0447\u0438\u043a\u043e\u0432 \u0442\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u044b  <code>Get-Sensor -Open</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c OpenHardwareMonitor  <code>Get-Sensor -ComputerName 192.168.3.99 -Port 8086 | Format-Table</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0434\u0430\u0442\u0447\u0438\u043a\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0447\u0435\u0440\u0435\u0437 REST API  <code>Get-Sensor -ComputerName 192.168.3.99 -Port 8085 -User hardware -Password monitor | Where-Object Value -notmatch \"^0,0\" | Format-Table</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u0438 \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043d\u0435 \u043f\u0443\u0441\u0442\u044b\u0445 \u0434\u0430\u0442\u0447\u0438\u043a\u043e\u0432  <code>Get-Sensor -Library | Where-Object Value -ne 0 | Format-Table</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 (dll) \u0447\u0435\u0440\u0435\u0437 .NET</p>"},{"location":"Modules/#crystaldisk-cli","title":"CrystalDisk-Cli","text":"<p><code>Install-Module CrystalDisk-Cli -Repository NuGet</code> <code>Get-DiskInfoSettings</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b Crystal-DiskInfo (https://github.com/hiyohiyo/CrystalDiskInfo)  <code>Get-DiskInfoSettings -AutoRefresh 5</code> \u0438\u0437\u043c\u0438\u043d\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0430 5 \u043c\u0438\u043d\u0443\u0442  <code>Get-DiskInfo -List</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u0438\u0441\u043a\u043e\u0432  <code>Get-DiskInfo</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f (\u0441\u0442\u0430\u0442\u0443\u0441, \u0442\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u0430 \u0438 \u0442.\u043f.)  <code>Get-DiskInfo -Report | Select-Object Name,Date,HealthStatus,Temperature</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0447\u0435\u0442 (\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u0434\u043e\u0436\u0434\u0430\u0442\u044c\u0441\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432)</p>"},{"location":"Modules/#ps-pi-hole","title":"PS-Pi-Hole","text":"<pre><code>$path_psm = ($env:PSModulePath.Split(\";\")[0])+\"\\Invoke-Pi-Hole\\Invoke-Pi-Hole.psm1\"\nif (!(Test-Path $path_psm)) {\n    New-Item $path_psm -ItemType File -Force\n}\nirm https://raw.githubusercontent.com/Lifailon/PS-Pi-Hole/rsa/Invoke-Pi-Hole/Invoke-Pi-Hole.psm1 | Out-File $path_psm -Force\n</code></pre> <p><code>sudo cat /etc/pihole/setupVars.conf | grep WEBPASSWORD</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u043e\u043a\u0435\u043d \u0434\u043e\u0441\u0442\u0443\u043f\u0430  <code>$Server = \"192.168.1.253\"</code> <code>$Token = \"5af9bd44aebce0af6206fc8ad4c3750b6bf2dd38fa59bba84ea9570e16a05d0f\"</code> <code>Invoke-Pi-Hole -Versions -Server $Server -Token $Token</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0432\u0435\u0440\u0441\u0438\u044e \u044f\u0434\u0440\u0430 (backend) \u0438 \u0432\u0435\u0431 (frontend) \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0430 \u0442\u0430\u043a\u0436\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044e\u044e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0443\u044e \u0432\u0435\u0440\u0441\u0438\u044e \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f  <code>Invoke-Pi-Hole -Releases -Server $Server -Token $Token</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044e\u044e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0443\u044e \u0432\u0435\u0440\u0441\u0438\u044e \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438 \u043d\u0430 GitHub  <code>Invoke-Pi-Hole -QueryLog -Server $Server -Token $Token</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u043e\u043b\u043d\u044b\u0439 \u0436\u0443\u0440\u043d\u0430\u043b \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 (\u043a\u043b\u0438\u0435\u043d\u0442, \u0434\u043e\u043c\u0435\u043d \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u0442\u0438\u043f \u0437\u0430\u043f\u0438\u0441\u0438, \u0441\u0442\u0430\u0442\u0443\u0441 \u0432\u0440\u0435\u043c\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0438 \u0430\u0434\u0440\u0435\u0441 \u043f\u0435\u0440\u0435\u0441\u044b\u043b\u043a\u0438 forward dns - \u043a\u0443\u0434\u0430 \u0443\u0448\u0435\u043b \u0437\u0430\u043f\u0440\u043e\u0441)  <code>Invoke-Pi-Hole -AdList -Server $Server -Token $Token</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043a\u0438 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 (\u0434\u0430\u0442\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f, \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043e\u043c\u0435\u043d\u043e\u0432 \u0438 url-\u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430)  <code>Invoke-Pi-Hole -Status -Server $Server -Token $Token</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0440\u0430\u0431\u043e\u0442\u044b \u0440\u0435\u0436\u0438\u043c\u0430 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438  <code>Invoke-Pi-Hole -Enable -Server $Server -Token $Token</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0443  <code>Invoke-Pi-Hole -Disable -Server $Server -Token $Token</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0443  <code>Invoke-Pi-Hole -Stats -Server $Server -Token $Token</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 Pi-Hole \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438 (\u043c\u0435\u0442\u0440\u0438\u043a\u0438: \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043e\u043c\u0435\u043d\u043e\u0432 \u0434\u043b\u044f \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438, \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0438 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043e\u043a \u0437\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f \u0438 \u0442.\u0434.)  <code>Invoke-Pi-Hole -QueryTypes -Server $Server -Token $Token</code> \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043f\u043e \u0442\u0438\u043f\u0443 \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e 100%  <code>Invoke-Pi-Hole -TopClient -Server $Server -Token $Token</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0430\u043c\u044b\u0445 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432 (ip/name \u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043f\u0440\u043e\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0447\u0435\u0440\u0435\u0437 \u0441\u0435\u0440\u0432\u0435\u0440)  <code>Invoke-Pi-Hole -TopPermittedDomains -Count 100 -Server $Server -Token $Token</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0430\u043c\u044b\u0445 \u043f\u043e\u0441\u0435\u0449\u044f\u0435\u043c\u044b\u0445 \u0434\u043e\u043c\u0435\u043d\u043e\u0432 \u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432  <code>Invoke-Pi-Hole -LastBlockedDomain -Server $Server -Token $Token</code> \u0430\u0434\u0440\u0435\u0441 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0434\u043e\u043c\u0435\u043d\u0430  <code>Invoke-Pi-Hole -ForwardServer -Server $Server -Token $Token</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0441\u044b\u043b\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u043e\u0431\u044b\u0447\u043d\u043e \u0432\u044b\u0441\u0442\u0443\u043f\u0430\u0435\u0442 DNS-\u0441\u0435\u0440\u0432\u0435\u0440 \u0441\u0442\u043e\u044f\u0449\u0438\u0439 \u0437\u0430 Pi-Hole \u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 AD  <code>Invoke-Pi-Hole -Data -Server $Server -Token $Token</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0437\u0430 \u043a\u0430\u0436\u0434\u044b\u0435 10 \u043c\u0438\u043d\u0443\u0442 \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 24 \u0447\u0430\u0441\u043e\u0432</p>"},{"location":"Network/","title":"Network","text":""},{"location":"Network/#ping","title":"ping","text":"<p><code>Test-Connection -Count 1 $srv1, $srv2</code> \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c icmp-\u043f\u0430\u043a\u0435\u0442 \u0434\u0432\u0443\u043c \u0445\u043e\u0441\u0442\u0430\u043c  <code>Test-Connection $srv -ErrorAction SilentlyContinue</code> \u043d\u0435 \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u043e\u0448\u0438\u0431\u043e\u043a, \u0435\u0441\u043b\u0438 \u0445\u043e\u0441\u0442 \u043d\u0435 \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442  <code>Test-Connection -Source $srv1 -ComputerName $srv2</code> \u043f\u0438\u043d\u0433 \u0441 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430</p> <pre><code>function Test-PingNetwork {\nparam (\n    [Parameter(Mandatory,ValueFromPipeline)][string[]]$Network,\n    [ValidateRange(100,10000)][int]$Timeout = 100\n)\n$ping = New-Object System.Net.NetworkInformation.Ping\n$Network  = $Network -replace \"0$\"\n$net = @()\nforeach ($r in @(1..254)) {\n    $net += \"$network$r\"\n}\nforeach ($n in $net) {\n    $ping.Send($n, $timeout) | select @{Name=\"Address\"; Expression={$n -replace \".+\\.\"}}, Status\n}\n}\n</code></pre> <p><code>Test-PingNetwork -Network 192.168.3.0</code> <code>Test-PingNetwork -Network 192.168.3.0 -Timeout 1000</code></p> <p><code>Get-CimInstance -Class Win32_PingStatus -Filter \"Address='127.0.0.1'\"</code> <code>Get-CimInstance -Class Win32_PingStatus -Filter \"Address='127.0.0.1'\" | Format-Table -Property Address,ResponseTime,StatusCode -Autosize</code> 0 - \u0443\u0441\u043f\u0435\u0445  <code>'127.0.0.1','8.8.8.8' | ForEach-Object -Process {Get-CimInstance -Class Win32_PingStatus -Filter (\"Address='$_'\") | Select-Object -Property Address,ResponseTime,StatusCode}</code> <code>$ips = 1..254 | ForEach-Object -Process {'192.168.1.' + $_}</code> \u0441\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432 \u0438\u0437 ip-\u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u043f\u043e\u0434\u0441\u0435\u0442\u0438</p>"},{"location":"Network/#dhcp","title":"dhcp","text":"<p><code>Get-CimInstance -Class Win32_NetworkAdapterConfiguration -Filter \"DHCPEnabled=$true\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u044b \u0441 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u043c DHCP  <code>$wql = 'SELECT * from Win32_NetworkAdapterConfiguration WHERE IPEnabled=True and DHCPEnabled=False'</code> <code>Invoke-CimMethod -MethodName ReleaseDHCPLease -Query $wql</code> \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 DHCP \u043d\u0430 \u0432\u0441\u0435\u0445 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0430\u0445  <code>Invoke-CimMethod -ClassName Win32_NetworkAdapterConfiguration -MethodName ReleaseDHCPLeaseAll</code> \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0440\u0435\u043d\u0434\u0443 \u0430\u0434\u0440\u0435\u0441\u043e\u0432 DHCP \u043d\u0430 \u0432\u0441\u0435\u0445 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0430\u0445  <code>Invoke-CimMethod -ClassName Win32_NetworkAdapterConfiguration -MethodName RenewDHCPLeaseAll</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0440\u0435\u043d\u0434\u0443 \u0430\u0434\u0440\u0435\u0441\u043e\u0432 DHCP \u043d\u0430 \u0432\u0441\u0435\u0445 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0430\u0445</p>"},{"location":"Network/#port","title":"port","text":"<p><code>tnc $srv -p 5985</code> <code>tnc $srv -CommonTCPPort WINRM</code> HTTP,RDP,SMB  <code>tnc ya.ru \u2013TraceRoute -Hops 2</code> TTL=2  <code>tnc ya.ru -DiagnoseRouting</code> \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u044f \u0434\u043e \u0445\u043e\u0441\u0442\u0430, \u043a\u0443\u0434\u0430 (DestinationPrefix: 0.0.0.0/0) \u0447\u0435\u0440\u0435\u0437 (NextHop: 192.168.1.254)</p>"},{"location":"Network/#netstat","title":"netstat","text":"<p><code>netstat -anop tcp</code> -n/-f/-b  <code>Get-NetTCPConnection -State Established,Listen | ? LocalPort -Match 3389</code> <code>Get-NetTCPConnection -State Established,Listen | ? RemotePort -Match 22</code> <code>Get-NetUDPEndpoint | ? LocalPort -Match 514</code> netstat -ap udp`</p>"},{"location":"Network/#nslookup","title":"nslookup","text":"<p><code>nslookup ya.ru 1.1.1.1</code> \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c DNS \u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>nslookup -type=any ya.ru</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0442\u0438\u043f \u0437\u0430\u043f\u0438\u0441\u0438  <code>Resolve-DnsName ya.ru -Type MX</code> ALL,ANY,A,NS,SRV,CNAME,PTR,TXT(spf)  <code>[System.Net.Dns]::GetHostEntry(\"ya.ru\")</code></p>"},{"location":"Network/#ipconfig","title":"ipconfig","text":"<p><code>Get-NetIPConfiguration</code> <code>Get-NetIPConfiguration -InterfaceIndex 14 -Detailed</code></p>"},{"location":"Network/#adapter","title":"Adapter","text":"<p><code>Get-NetAdapter</code> <code>Set-NetIPInterface -InterfaceIndex 14 -Dhcp Disabled</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c DHCP  <code>Get-NetAdapter -InterfaceIndex 14 | New-NetIPAddress \u2013IPAddress 192.168.3.99 -DefaultGateway 192.168.3.1 -PrefixLength 24</code> \u0437\u0430\u0434\u0430\u0442\u044c/\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 IP-\u0430\u0434\u0440\u0435\u0441  <code>Set-NetIPAddress -InterfaceIndex 14 -IPAddress 192.168.3.98</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c IP-\u0430\u0434\u0440\u0435\u0430\u0441 \u043d\u0430 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0435  <code>Remove-NetIPAddress -InterfaceIndex 14 -IPAddress 192.168.3.99</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c IP-\u0430\u0434\u0440\u0435\u0441 \u043d\u0430 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0435  <code>Set-NetIPInterface -InterfaceIndex 14 -Dhcp Enabled</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c DHCP</p>"},{"location":"Network/#dnsclient","title":"DNSClient","text":"<p><code>Get-DNSClientServerAddress</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432 \u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u043d\u0430 \u043d\u0438\u0445 \u0430\u0434\u0440\u0435\u0441\u0430 DNS \u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>Set-DNSClientServerAddress -InterfaceIndex 14 -ServerAddresses 8.8.8.8</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0434\u0440\u0435\u0441 DNS \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435</p>"},{"location":"Network/#dnscache","title":"DNSCache","text":"<p><code>Get-DnsClientCache</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u044d\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u043f\u0438\u0441\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 DNS  <code>Clear-DnsClientCache</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043a\u044d\u0448</p>"},{"location":"Network/#binding","title":"Binding","text":"<p><code>Get-NetAdapterBinding -Name Ethernet -IncludeHidden -AllBindings</code> <code>Get-NetAdapterBinding -Name \"\u0411\u0435\u0441\u043f\u0440\u043e\u0432\u043e\u0434\u043d\u0430\u044f \u0441\u0435\u0442\u044c\" -DisplayName \"IP \u0432\u0435\u0440\u0441\u0438\u0438 6 (TCP/IPv6)\" | Set-NetAdapterBinding -Enabled $false</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c IPv6 \u043d\u0430 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0435</p>"},{"location":"Network/#tcpsetting","title":"TCPSetting","text":"<p><code>Get-NetTCPSetting</code> <code>Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -CongestionProvider DCTCP</code> \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u0442 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0435\u0440\u0435\u0433\u0440\u0443\u0437\u043a\u043e\u0439 (Congestion Control Provider) \u043d\u0430 DCTCP (Data Center TCP) \u0434\u043b\u044f \u043f\u0440\u043e\u0444\u0438\u043b\u0435\u0439 TCP \u0441 \u0438\u043c\u0435\u043d\u0430\u043c\u0438 DatacenterCustom \u0438 Datacenter  <code>Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -CwndRestart True</code> \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043e\u043a\u043d\u0430 \u043f\u0435\u0440\u0435\u0433\u0440\u0443\u0437\u043a\u0438 (Congestion Window Restart, CwndRestart) \u0434\u043b\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0444\u0438\u043b\u0435\u0439 TCP. \u042d\u0442\u043e \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442, \u0447\u0442\u043e \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0438\u043e\u0434\u0430 \u0438\u0434\u043b\u0435 (\u043a\u043e\u0433\u0434\u0430 \u043d\u0435\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445) TCP \u043e\u043a\u043d\u043e \u043f\u0435\u0440\u0435\u0433\u0440\u0443\u0437\u043a\u0438 \u0431\u0443\u0434\u0435\u0442 \u0441\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0442\u044c\u0441\u044f  <code>Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -ForceWS Disabled</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u043a\u043d\u0430 (Forced Window Scaling) \u0434\u043b\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0444\u0438\u043b\u0435\u0439 TCP. \u041c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u043a\u043d\u0430 \u2014 \u044d\u0442\u043e \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u043e\u043a\u043d\u0430 \u043f\u0435\u0440\u0435\u0433\u0440\u0443\u0437\u043a\u0438 TCP, \u0447\u0442\u043e\u0431\u044b \u0443\u043b\u0443\u0447\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e \u0441\u0435\u0442\u0438 \u0441 \u0432\u044b\u0441\u043e\u043a\u043e\u0439 \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u043d\u043e\u0439 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c\u044e \u0438 \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u043e\u0439</p>"},{"location":"Network/#hostname","title":"hostname","text":"<p><code>$env:computername</code> <code>hostname.exe</code> <code>(Get-CIMInstance CIM_ComputerSystem).Name</code> <code>(New-Object -ComObject WScript.Network).ComputerName</code> <code>[System.Environment]::MachineName</code> <code>[System.Net.Dns]::GetHostName()</code></p>"},{"location":"Network/#arp","title":"arp","text":"<p><code>ipconfig /all | Select-String \"\u0444\u0438\u0437\"</code> grep  <code>Get-NetNeighbor -AddressFamily IPv4</code></p> <pre><code>function Get-ARP {\n    Param (\n        $proxy,\n        $search\n    )\n    if (!$proxy) {\n        $arp = arp -a\n    }\n    if ($proxy) {\n        $arp = icm $proxy { arp -a }\n    }\n    $mac = $arp[3..260]\n    $mac = $mac -replace \"^\\s\\s\"\n    $mac = $mac -replace \"\\s{1,50}\", \" \"\n    $mac_coll = New-Object System.Collections.Generic.List[System.Object]\n    foreach ($m in $mac) {\n        $smac = $m -split \" \"\n        $mac_coll.Add([PSCustomObject]@{\n                IP   = $smac[0];\n                MAC  = $smac[1];\n                Type = $smac[2]\n            })\n    }\n    if ($search) {\n        if ($search -NotMatch \"\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\") {\n            #$ns = nslookup $search\n            #$ns = $ns[-2]\n            #$global:ns = $ns -replace \"Address:\\s{1,10}\"\n            $rdns = Resolve-DnsName $search -ErrorAction Ignore\n            $ns = $rdns.IPAddress\n            if ($ns -eq $null) {\n                return\n            }\n        }\n        else {\n            $ns = $search\n        }\n        $mac_coll = $mac_coll | ? ip -Match $ns\n    }\n    $mac_coll\n}\n</code></pre> <p><code>Get-ARP -search 192.168.3.100</code> <code>Get-ARP -search 192.168.3.100 -proxy dc-01</code></p>"},{"location":"Network/#network-adapter-statistics","title":"Network Adapter Statistics","text":"<p><code>netstat -se</code> <code>Get-NetAdapterStatistics</code></p>"},{"location":"Network/#speedtest","title":"SpeedTest","text":"<pre><code>function Get-SpeedTestOokla {\n    param (\n        $Server = 3682,\n        [switch]$List\n    )\n    $path = \"$env:TEMP\\speedtest.exe\"\n    $testPath = Test-Path \"$env:TEMP\\speedtest.exe\"\n    if ($testPath -eq $false) {\n        Invoke-RestMethod https://install.speedtest.net/app/cli/ookla-speedtest-1.2.0-win64.zip -OutFile \"$env:TEMP\\speedtest.zip\"\n        Expand-Archive \"$env:TEMP\\speedtest.zip\" -DestinationPath $env:TEMP\n    }\n    if ($List) {\n        $(&amp; $path -L -f json | ConvertFrom-Json).servers\n    } else {\n        $test = &amp; $path -s $Server -f json\n        $Collections = New-Object System.Collections.Generic.List[System.Object]\n        $Collections.Add(\n            [PSCustomObject]@{\n                Date = $($test | ConvertFrom-Json).timestamp\n                Url = $($test | ConvertFrom-Json).result.url\n                Download = [double]::Round($($($test | ConvertFrom-Json).download.bandwidth / 1mb * 8), 2)\n                Upload = [double]::Round($($($test | ConvertFrom-Json).upload.bandwidth / 1mb * 8), 2)\n                Ping = $($test | ConvertFrom-Json).ping.latency\n                Internal_IP = $($test | ConvertFrom-Json).interface.internalIp\n                External_IP = $($test | ConvertFrom-Json).interface.externalIp\n                Server = $($test | ConvertFrom-Json).server\n            }\n        )\n        $Collections\n    }\n}\n</code></pre>"},{"location":"Network/#iperf","title":"iPerf","text":""},{"location":"Network/#install","title":"Install","text":"<pre><code>$url = $($(Invoke-RestMethod https://api.github.com/repos/ar51an/iperf3-win-builds/releases/latest).assets | Where-Object name -match \"win64.zip\").browser_download_url\nInvoke-RestMethod $url -OutFile $home\\Downloads\\iperf.zip\nNew-Item \"$home\\Documents\\iperf3\" -Type Directory | Out-Null\nExpand-Archive -Path \"$home\\Downloads\\iperf.zip\" -OutputPath \"$home\\Documents\\iperf3\"\nRemove-Item \"$home\\Downloads\\iperf*\" -Force -Recurse\n</code></pre> <p><code>&amp; \"$home\\Documents\\iperf3\\iperf3.exe\" -h</code></p>"},{"location":"Network/#env-update-exec-path","title":"Env-Update-Exec-Path","text":"<pre><code>$EnvPath = [Environment]::GetEnvironmentVariable(\"Path\", [EnvironmentVariableTarget]::Machine)\n$EnvPath -split \";\"\n$iperfPath = \"$home\\Documents\\iperf3\\\"\n$EnvAddPath = $EnvPath + \";\" + $iperfPath\n[Environment]::SetEnvironmentVariable(\"Path\", $EnvAddPath, [EnvironmentVariableTarget]::Machine)\n$([Environment]::GetEnvironmentVariable(\"Path\", [EnvironmentVariableTarget]::Machine)) -split \";\"\n</code></pre> <p><code>iperf3 -h</code></p>"},{"location":"Network/#iperf-gui","title":"iPerf-GUI","text":"<p><code>Invoke-RestMethod \"https://github.com/Lifailon/iPerf-GUI/raw/rsa/iPerf-GUI-Install.exe\" -OutFile \"$home\\Downloads\\iPerf-GUI-Install.exe\"</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043e\u0447\u043d\u0443\u044e \u0432\u0435\u0440\u0441\u0438\u044e \u0441\u043e\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e WinRAR  <code>Start-Process -FilePath \"$home\\Downloads\\iPerf-GUI-Install.exe\" -ArgumentList \"/S\" -NoNewWindow -Wait</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432 \u0442\u0438\u0445\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435</p>"},{"location":"Network/#iperf-docker","title":"iPerf-Docker","text":"<pre><code>echo '\nFROM alpine:latest\nRUN apk update &amp;&amp; apk add --no-cache iperf3\nENV PORT=5201\nEXPOSE $PORT\nCMD [\"sh\", \"-c\", \"iperf3 -s -p $PORT\"]\n' &gt; Dockerfile\n</code></pre> <p><code>docker build -t iperf3-alpine-server .</code> <code>docker run -d -p 5201:5201 --name iperf3-alpine-server iperf3-alpine-server</code></p>"},{"location":"Network/#server","title":"Server","text":"<p><code>iperf3 -s</code> \u0437\u0430\u043f\u0443\u0441\u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>iperf3 -s -D</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440 \u0432 \u0444\u043e\u043d\u043e\u0432\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u043a\u0430\u043a \u0441\u043b\u0443\u0436\u0431\u0443 (--daemon)  <code>Get-NetTCPConnection -State Established,Listen | ? LocalPort -Match 5201</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u0447\u0442\u043e \u043f\u043e\u0440\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0441\u043b\u0443\u0448\u0430\u0435\u0442  <code>Get-Process -Id $(Get-NetTCPConnection -State Established,Listen | ? LocalPort -Match 5201).OwningProcess</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u043e \u043f\u043e\u0440\u0442\u0443  <code>Get-Process iperf3 | Stop-Process</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441  <code>iperf3 -s -D --logfile \"$home\\Documents\\iperf3\\iperf3.log\"</code> \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u0432 \u043b\u043e\u0433 \u0444\u0430\u0439\u043b  <code>iperf3 -s -p 5211</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u043e\u0440\u0442, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0431\u0443\u0434\u0435\u0442 \u0441\u043b\u0443\u0448\u0430\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440 \u0438\u043b\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a\u043b\u0438\u0435\u043d\u0442  <code>iperf3 -s -p 5211 -f M</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0444\u043e\u0440\u043c\u0430\u0442 \u0432\u044b\u0432\u043e\u0434\u0438\u043c\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 (\u0438\u0437\u043c\u0435\u0440\u044f\u0442\u044c \u0432 \u0431\u0430\u0439\u0442\u0430\u0445 \u0430 \u043d\u0435 \u0432 \u0431\u0438\u0442\u0430\u0445, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f: K,M,G,T)  <code>iperf3 -s -p 5211 -f M -J</code> \u0432\u044b\u0432\u043e\u0434 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 json  <code>iperf3 -s -p 5211 -f M -V</code> \u0432\u044b\u0432\u043e\u0434 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438</p>"},{"location":"Network/#client","title":"Client","text":"<p><code>iperf3 -c 192.168.3.100 -p 5211</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442\u0441\u044f \u043e\u0442\u0434\u0430\u0447\u0430 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0430)  <code>iperf3 -c 192.168.3.100 -p 5211 -R</code> \u043e\u0431\u0440\u0430\u0442\u043d\u044b\u0439 \u0442\u0435\u0441\u0442, \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u044f \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 (--reverse, \u0441\u0435\u0440\u0432\u0435\u0440 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0443)  <code>iperf3 -c 192.168.3.100 -p 5211 -R -P 2</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043f\u043e\u0442\u043e\u043a\u043e\u0432 ([SUM] - \u0441\u0443\u043c\u043c\u0430\u0440\u043d\u0430\u044f \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438 \u043f\u043e\u0442\u043e\u043a\u043e\u0432)  <code>iperf3 -c 192.168.3.100 -p 5211 -R -4</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e IPv4  <code>iperf3 -c 192.168.3.100 -p 5211 -R -u</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c UDP \u0432\u043c\u0435\u0441\u0442\u043e TCP  <code>iperf3 -c 192.168.3.100 -p 5211 -R -u -b 2mb</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0431\u0438\u0442\u0440\u0435\u0439\u0442 \u0432 2.00 Mbits/sec \u0434\u043b\u044f UDP (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e 1 \u041c\u0431\u0438\u0442/\u0441\u0435\u043a, \u0434\u043b\u044f TCP \u043d\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043e)  <code>iperf3 -c 192.168.3.100 -p 5211 -R -t 30</code> \u0432\u0440\u0435\u043c\u044f \u043e\u0434\u043d\u043e\u0433\u043e \u0442\u0435\u0441\u0442\u0430 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e 10 \u0441\u0435\u043a\u0443\u043d\u0434)  <code>iperf3 -c 192.168.3.100 -p 5211 -R -n 1gb</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 (\u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u0432\u043c\u0435\u0441\u0442\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 -t)  <code>iperf3 -c 192.168.3.100 -p 5211 -R --get-server-output</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0432\u044b\u0432\u043e\u0434 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043d\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0435</p>"},{"location":"Network/#output","title":"Output","text":"<p><code>sender</code> upload (\u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440)  <code>receiver</code> download (\u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u044f \u0441 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430)  <code>Interval</code> \u043e\u0431\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f  <code>Transfer</code> \u043a\u043e\u043b-\u0432\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u041c\u0411\u0430\u0439\u0442  <code>Bandwidth</code> \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 (\u0438\u0437\u043c\u0435\u0440\u044f\u0435\u0442\u0441\u044f \u0432 \u041c\u0431\u0438\u0442/c)</p>"},{"location":"Network/#ps-iperf","title":"PS-iPerf","text":"<p><code>Install-Module ps-iperf -Repository NuGet</code> <code>Import-Module PS-iPerf</code> <code>Start-iPerfServer -Port 5211</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440  <code>Get-iPerfServer</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0440\u0430\u0431\u043e\u0442\u044b \u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>Stop-iPerfServer</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440  <code>Connect-iPerfServer -Server 192.168.3.100 -Port 5211 -MBytes 500 -Download</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u0438 \u0441\u043a\u0430\u0447\u0430\u0442\u044c 500 \u041c\u0411\u0430\u0439\u0442  <code>$SpeedTest = Connect-iPerfServer -Server 192.168.3.100 -Port 5211 -MBytes 500 -LogWrite</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c 500 \u041c\u0411\u0430\u0439\u0442 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440 (\u0432\u0435\u0441\u0442\u0438 \u0437\u0430\u043f\u0438\u0441\u044c \u0432 \u043b\u043e\u0433-\u0444\u0430\u0439\u043b)  <code>$SpeedTest.Intervals</code> \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u0439  <code>Get-iPerfLog</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u043b\u043e\u0433-\u0444\u0430\u0439\u043b</p>"},{"location":"Network/#firewall","title":"Firewall","text":"<pre><code>$days = 5\n$obj = @()\n$fw = Get-WinEvent \"Microsoft-Windows-Windows Firewall With Advanced Security/Firewall\"\nforeach ($temp_fw in $fw) {\nif ($temp_fw.id -eq 2097) { # 2004\n    $type = \"Added Rule\"\n}\nelseif ($temp_fw.id -eq 2006) {\n    $type = \"Deleted Rule\"\n}\n$port = $temp_fw.Properties[7] | select -ExpandProperty value\n$name = $temp_fw.Properties[1] | select -ExpandProperty value\n$obj += [PSCustomObject]@{\n    Time = $temp_fw.TimeCreated;\n    Type = $type;\n    Port = $port;\n    Name = $name}\n}\n$obj | Where-Object time -gt (Get-Date).AddDays(-$days)\n</code></pre> <p><code>New-NetFirewallRule -Profile Any -DisplayName \"Open Port 135 RPC\" -Direction Inbound -Protocol TCP -LocalPort 135</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c in-\u043f\u043e\u0440\u0442  <code>Get-NetFirewallRule | where DisplayName -match kms | select *</code> \u043d\u0430\u0439\u0442\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u043e \u043f\u043e \u0438\u043c\u0435\u043d\u0438  <code>Get-NetFirewallPortFilter | where LocalPort -like 80</code> \u043d\u0430\u0439\u0442\u0438 \u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u043e \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 \u043f\u043e\u0440\u0442\u0430</p> <pre><code>Get-NetFirewallRule -Enabled True -Direction Inbound | select -Property DisplayName,\n@{Name='Protocol';Expression={($_ | Get-NetFirewallPortFilter).Protocol}},\n@{Name='LocalPort';Expression={($_ | Get-NetFirewallPortFilter).LocalPort}},\n@{Name='RemotePort';Expression={($_ | Get-NetFirewallPortFilter).RemotePort}},\n@{Name='RemoteAddress';Expression={($_ | Get-NetFirewallAddressFilter).RemoteAddress}},\nEnabled,Profile\n</code></pre>"},{"location":"Network/#firewall-manager","title":"Firewall-Manager","text":"<p><code>Install-Module Firewall-Manager</code> <code>Export-FirewallRules -Name * -CSVFile $home\\documents\\fw.csv</code> -Inbound -Outbound -Enabled -Disabled -Allow -Block (\u0444\u0438\u043b\u044c\u0442\u0440 \u043f\u0440\u0430\u0432\u0438\u043b \u0434\u043b\u044f \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0430)  <code>Import-FirewallRules -CSVFile $home\\documents\\fw.csv</code></p>"},{"location":"Network/#rdp","title":"RDP","text":"<p><code>Get-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" -Name \"PortNumber\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e RDP \u043f\u043e\u0440\u0442\u0430  <code>Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" -Name \"PortNumber\" -Value \"3390\"</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c RDP-\u043f\u043e\u0440\u0442  <code>$(Get-ItemProperty -Path \"HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server\\\" -Name \"fDenyTSConnections\").fDenyTSConnections</code> \u0435\u0441\u043b\u0438 0, \u0442\u043e \u0432\u043a\u043b\u044e\u0447\u0435\u043d  <code>Set-ItemProperty -Path \"HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server\\\" -Name \"fDenyTSConnections\" -Value 0</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c RDP  <code>reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f</code> <code>(gcim -Class Win32_TerminalServiceSetting -Namespace root\\CIMV2\\TerminalServices).SetAllowTSConnections(0)</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c RDP (\u0434\u043b\u044f Windows Server)  <code>Get-Service TermService | Restart-Service -Force</code> \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c rdp-\u0441\u043b\u0443\u0436\u0431\u0443  <code>New-NetFirewallRule -Profile Any -DisplayName \"RDP 3390\" -Direction Inbound -Protocol TCP -LocalPort 3390</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c RDP-\u043f\u043e\u0440\u0442</p>"},{"location":"Network/#ipban","title":"IPBan","text":"<p><code>auditpol /get /category:*</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 \u0430\u0443\u0434\u0438\u0442\u0430  <code>auditpol /get /category:\u0412\u0445\u043e\u0434/\u0432\u044b\u0445\u043e\u0434</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 \u0430\u0443\u0434\u0438\u0442\u0430 \u0434\u043b\u044f \u0412\u0445\u043e\u0434\u0430 \u0438 \u0412\u044b\u0445\u043e\u0434\u0430 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b  <code>auditpol /set /subcategory:\"\u0412\u0445\u043e\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443\" /success:enable /failure:enable</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 - \u0410\u0443\u0434\u0438\u0442 \u0432\u0445\u043e\u0434\u0430 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443  <code>auditpol /set /subcategory:\"\u0412\u044b\u0445\u043e\u0434 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b\" /success:enable /failure:enable</code></p> <p><code>$url = $($(Invoke-RestMethod https://api.github.com/repos/DigitalRuby/IPBan/releases/latest).assets | Where-Object name -match \".+win.+x64.+\").browser_download_url</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443 \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0432\u0435\u0440\u0441\u0438\u0438  <code>$version = $(Invoke-RestMethod https://api.github.com/repos/DigitalRuby/IPBan/releases/latest).tag_name</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043d\u043e\u043c\u0435\u0440 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0432\u0435\u0440\u0441\u0438\u0438  <code>$path = \"$home\\Documents\\ipban-$version\"</code> \u043f\u0443\u0442\u044c \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438  <code>Invoke-RestMethod $url -OutFile \"$home\\Downloads\\IPBan-$version.zip\"</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0434\u0438\u0441\u0442\u0440\u0438\u0431\u0443\u0442\u0438\u0432  <code>Expand-Archive \"$home\\Downloads\\ipban-$version.zip\" -DestinationPath $path</code> \u0440\u0430\u0437\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u043f\u0443\u0442\u044c \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438  <code>Remove-Item \"$home\\Downloads\\ipban-$version.zip\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u0438\u0441\u0442\u0440\u0438\u0431\u0443\u0442\u0438\u0432  <code>sc create IPBan type=own start=delayed-auto binPath=\"$path\\DigitalRuby.IPBan.exe\" DisplayName=IPBan</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443  <code>Get-Service IPBan</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0441\u043b\u0443\u0436\u0431\u044b  <code>$conf = $(Get-Content \"$path\\ipban.config\")</code> \u0447\u0438\u0442\u0430\u0435\u043c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e  <code>$conf = $conf -replace '&lt;add key=\"Whitelist\" value=\"\"/&gt;','&lt;add key=\"Whitelist\" value=\"192.168.3.0/24\"/&gt;'</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0431\u0435\u043b\u044b\u0439 \u043b\u0438\u0441\u0442 \u0434\u043e\u043c\u0430\u0448\u043d\u044e\u044e \u0441\u0435\u0442\u044c \u0434\u043b\u044f \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f  <code>$conf = $conf -replace '&lt;add key=\"ProcessInternalIPAddresses\" value=\"false\"/&gt;','&lt;add key=\"ProcessInternalIPAddresses\" value=\"true\"/&gt;'</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445 (\u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0445) ip-\u0430\u0434\u0440\u0435\u0441\u043e\u0432  <code>$conf = $conf -replace '&lt;add key=\"FailedLoginAttemptsBeforeBanUserNameWhitelist\" value=\"20\"/&gt;','&lt;add key=\"FailedLoginAttemptsBeforeBanUserNameWhitelist\" value=\"5\"/&gt;'</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u043f\u044b\u0442\u043e\u043a \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0434\u043e \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438  <code>$conf = $conf -replace '&lt;add key=\"ExpireTime\" value=\"01:00:00:00\"/&gt;','&lt;add key=\"ExpireTime\" value=\"00:01:00:00\"/&gt;'</code> \u0437\u0430\u0434\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438 1 \u0447\u0430\u0441  <code>$conf &gt; \"$path\\ipban.config\"</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e  <code>Get-Service IPBan | Start-Service</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443</p> <pre><code>Get-NetFirewallRule | Where-Object DisplayName -Match \"IPBan\" | ForEach-Object {\n    $Name = $_.DisplayName\n    Get-NetFirewallAddressFilter -AssociatedNetFirewallRule $_ | Select-Object @{Name=\"Name\"; Expression={$Name}},LocalIP,RemoteIP\n} # \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043e\u0431\u043b\u0430\u0441\u0442\u044c \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u0430\u0432\u0438\u043b \u0411\u0440\u0430\u043d\u0434\u043c\u0430\u0443\u044d\u0440\u0430 \u0434\u043b\u044f IPBan\n</code></pre> <p><code>Get-Content -Wait \"$path\\logfile.txt\"</code> \u0447\u0438\u0442\u0430\u0442\u044c \u043b\u043e\u0433  <code>Get-Service IPBan | Stop-Service</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443  <code>sc delete IPBan</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443</p>"},{"location":"Network/#shutdown","title":"shutdown","text":"<p><code>shutdown /r /o</code> \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0432 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c  <code>shutdown /s /t 600 /c \"Power off after 10 minutes\"</code> \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435  <code>shutdown /s /f</code> \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439  <code>shutdown /a</code> \u043e\u0442\u043c\u0435\u043d\u0430  <code>shutdown /r /t 0 /m \\\\192.168.3.100</code> <code>Restart-Computer -ComputerName 192.168.3.100 -Protocol WSMan</code> \u0447\u0435\u0440\u0435\u0437 WinRM  <code>Restart-Computer \u2013ComputerName 192.168.3.100 \u2013Force</code> \u0447\u0435\u0440\u0435\u0437 WMI  <code>Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\PolicyManager\\default\\Start\\HideShutDown\" -Name \"value\" -Value 1</code> \u0441\u043a\u0440\u044b\u0442\u044c \u043a\u043d\u043e\u043f\u043a\u0443 \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f  <code>Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\PolicyManager\\default\\Start\\HideRestart\" -Name \"value\" -Value 1</code> \u0441\u043a\u0440\u044b\u0442\u044c \u043a\u043d\u043e\u043f\u043a\u0443 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438</p> <pre><code>function Start-Shutdown {\n    &lt;#\n    .SYNOPSIS\n    Module for shutdown and restart the computer at a specified time\n    .DESCRIPTION\n    Example:\n    # Start-Shutdown -Time \"18:00\"\n    # Start-Shutdown -Restart -Time \"18:00\"\n    # Start-Shutdown -Cancel\n    .LINK\n    https://github.com/Lifailon/PS-Commands\n    #&gt;\n    param(\n        [string]$Time,\n        [switch]$Restart,\n        [switch]$Cancel\n    )\n    if ($Time) {\n        $currentDateTime = Get-Date\n        $shutdownTime = Get-Date $Time\n        if ($shutdownTime -lt $currentDateTime) {\n            $shutdownTime = $shutdownTime.AddDays(1)\n        }\n        $timeUntilShutdown = $shutdownTime - $currentDateTime\n        $secondsUntilShutdown = [math]::Round($timeUntilShutdown.TotalSeconds)\n    }\n    if ($Cancel) {\n        Start-Process -FilePath \"shutdown.exe\" -ArgumentList \"/a\"\n    } elseif ($Restart) {\n        Write-Host \"The computer will restart after $($timeUntilShutdown.Hours) hours and $($timeUntilShutdown.Minutes) minutes.\"\n        Start-Process -FilePath \"shutdown.exe\" -ArgumentList \"/r\", \"/f\", \"/t\", \"$secondsUntilShutdown\"\n    } else {\n        Write-Host \"The computer will shutdown after $($timeUntilShutdown.Hours) hours and $($timeUntilShutdown.Minutes) minutes.\"\n        Start-Process -FilePath \"shutdown.exe\" -ArgumentList \"/s\", \"/f\", \"/t\", \"$secondsUntilShutdown\"\n    }\n}\n</code></pre>"},{"location":"Network/#udp-socket","title":"UDP-Socket","text":"<p>Source</p> <pre><code>function Start-UDPServer {\n    param(\n        $Port = 5201\n    )\n    $RemoteComputer = New-Object System.Net.IPEndPoint([System.Net.IPAddress]::Any, 0)\n    do {\n        $UdpObject = New-Object System.Net.Sockets.UdpClient($Port)\n        $ReceiveBytes = $UdpObject.Receive([ref]$RemoteComputer)\n        $UdpObject.Close()\n        $ASCIIEncoding = New-Object System.Text.ASCIIEncoding\n        [string]$ReturnString = $ASCIIEncoding.GetString($ReceiveBytes)\n        [PSCustomObject]@{\n            LocalDateTime = $(Get-Date -UFormat \"%Y-%m-%d %T\")\n            ClientIP      = $RemoteComputer.address.ToString()\n            ClientPort    = $RemoteComputer.Port.ToString()\n            Message       = $ReturnString\n        }\n    } while (1)\n}\n</code></pre> <p><code>Start-UDPServer -Port 5201</code></p>"},{"location":"Network/#test-netudpconnection","title":"Test-NetUDPConnection","text":"<pre><code>function Test-NetUDPConnection {\n    param(\n        [string]$ComputerName = \"127.0.0.1\",\n        [int32]$PortServer = 5201,\n        [int32]$PortClient = 5211,\n        $Message\n    )\n    begin {\n        $UdpObject = New-Object system.Net.Sockets.Udpclient($PortClient)\n        $UdpObject.Connect($ComputerName, $PortServer)\n    }\n    process {\n        $ASCIIEncoding = New-Object System.Text.ASCIIEncoding\n        if (!$Message) { $Message = Get-Date -UFormat \"%Y-%m-%d %T\" }\n        $Bytes = $ASCIIEncoding.GetBytes($Message)\n        [void]$UdpObject.Send($Bytes, $Bytes.length)\n    }\n    end {\n        $UdpObject.Close()\n    }\n}\n</code></pre> <p><code>Test-NetUDPConnection -ComputerName 127.0.0.1 -PortServer 5201</code> <code>Test-NetUDPConnection -ComputerName 127.0.0.1 -PortServer 514 -Message \"&lt;30&gt;May 31 00:00:00 HostName multipathd[784]: Test message\"</code></p>"},{"location":"Network/#tcp-socket","title":"TCP-Socket","text":"<pre><code>function Start-TCPServer {\n    param(\n        $Port = 5201\n    )\n    do {\n        $TcpObject = New-Object System.Net.Sockets.TcpListener($port)\n        $ReceiveBytes = $TcpObject.Start()\n        $ReceiveBytes = $TcpObject.AcceptTcpClient()\n        $TcpObject.Stop()\n        $ReceiveBytes.Client.RemoteEndPoint | select Address, Port\n    } while (1)\n}\n</code></pre> <p><code>Start-TCPServer -Port 5201</code> <code>Test-NetConnection -ComputerName 127.0.0.1 -Port 5201</code></p>"},{"location":"Network/#wakeonlan","title":"WakeOnLan","text":"<p>Broadcast package consisting of 6 byte filled \"0xFF\" and then 96 byte where the mac address is repeated 16 times</p> <pre><code>function Send-WOL {\n    param (\n        [Parameter(Mandatory = $True)]$Mac,\n        $IP,\n        [int]$Port = 9\n    )\n    $Mac = $Mac.replace(\":\", \"-\")\n    if (!$IP) { $IP = [System.Net.IPAddress]::Broadcast }\n    $SynchronizationChain = [byte[]](, 0xFF * 6)\n    $ByteMac = $Mac.Split(\"-\") | % { [byte](\"0x\" + $_) }\n    $Package = $SynchronizationChain + ($ByteMac * 16)\n    $UdpClient = New-Object System.Net.Sockets.UdpClient\n    $UdpClient.Connect($IP, $port)\n    $UdpClient.Send($Package, $Package.Length)\n    $UdpClient.Close()\n}\n</code></pre> <p><code>Send-WOL -Mac \"D8-BB-C1-70-A3-4E\"</code> <code>Send-WOL -Mac \"D8-BB-C1-70-A3-4E\" -IP 192.168.3.100</code></p>"},{"location":"Network/#httplistener","title":"HTTPListener","text":"<pre><code>$httpListener = New-Object System.Net.HttpListener\n$httpListener.Prefixes.Add(\"http://+:8888/\")\n$httpListener.Start()\nwhile (!([console]::KeyAvailable)) {\n    $info = Get-Service | select name, status | ConvertTo-HTML\n    $context = $httpListener.GetContext()\n    $context.Response.StatusCode = 200\n    $context.Response.ContentType = 'text/HTML'\n    $WebContent = $info\n    $EncodingWebContent = [Text.Encoding]::UTF8.GetBytes($WebContent)\n    $context.Response.OutputStream.Write($EncodingWebContent , 0, $EncodingWebContent.Length)\n    $context.Response.Close()\n    Get-NetTcpConnection -LocalPort 8888\n(Get-Date).datetime\n}\n$httpListener.Close()\n</code></pre>"},{"location":"Network/#webclient","title":"WebClient","text":"<p><code>[System.Net.WebClient] | Get-Member</code> <code>(New-Object Net.WebClient).DownloadString(\"https://raw.githubusercontent.com/Lifailon/PowerShell-Commands/rsa/README.md\")</code></p>"},{"location":"Network/#httpclient","title":"HttpClient","text":"<pre><code>$url = \"https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip\"\n$path = \"$home\\Downloads\\$(Split-Path -Path $url -Leaf)\"\n$httpClient = [System.Net.Http.HttpClient]::new()\n# \u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 GET-\u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0444\u0430\u0439\u043b\u0430 (\u0441\u0447\u0438\u0442\u044b\u0432\u0430\u044f \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0438 \u043e\u0442\u0432\u0435\u0442\u0430)\n$response = $httpClient.GetAsync($url, [System.Net.Http.HttpCompletionOption]::ResponseHeadersRead).Result\n# \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0442\u043e\u043a\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0438\u0437 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0430 \u043e\u0442\u0432\u0435\u0442\u0430\n$stream = $response.Content.ReadAsStreamAsync().Result\n# \u041e\u0442\u043a\u0440\u044b\u0442\u0438\u0435 \u0444\u0430\u0439\u043b\u0430 \u0434\u043b\u044f \u0437\u0430\u043f\u0438\u0441\u0438\n$fileStream = [System.IO.File]::OpenWrite($path)\ntry {\n    # \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0431\u0443\u0444\u0435\u0440\u0430 \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c 81920 \u0431\u0430\u0439\u0442 (80 \u041a\u0411) \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u043f\u043e\u0442\u043e\u043a\u0430\n    $buffer = New-Object byte[] 81920\n    # \u0427\u0442\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u043f\u043e\u0442\u043e\u043a\u0430 \u0438 \u0437\u0430\u043f\u0438\u0441\u044c \u0438\u0445 \u0432 \u0444\u0430\u0439\u043b\n    while (($bytesRead = $stream.Read($buffer, 0, $buffer.Length)) -ne 0) {\n        $fileStream.Write($buffer, 0, $bytesRead)\n    }\n}\nfinally {\n    # \u041e\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0435\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 \u043f\u043e\u0442\u043e\u043a\u0430\u043c\u0438\n    $stream.Dispose()\n    $fileStream.Dispose()\n}\n</code></pre>"},{"location":"Network/#certificate","title":"Certificate","text":"<pre><code>function Get-WebCertificate ($srv) {\n    $iwr = iwr $srv\n    $status_code = $iwr.StatusCode\n    $status = $iwr.BaseResponse.StatusCode\n    $info = $iwr.BaseResponse.Server\n    $spm = [System.Net.ServicePointManager]::FindServicePoint($srv)\n    $date_end = $spm.Certificate.GetExpirationDateString()\n    $cert_name = ($spm.Certificate.Subject) -replace \"CN=\"\n    $cert_owner = ((($spm.Certificate.Issuer) -split \", \") | where { $_ -match \"O=\" }) -replace \"O=\"\n    $Collections = New-Object System.Collections.Generic.List[System.Object]\n    $Collections.Add([PSCustomObject]@{\n            Host        = $srv;\n            Server      = $info;\n            Status      = $status;\n            StatusCode  = $status_code;\n            Certificate = $cert_name;\n            Issued      = $cert_owner;\n            End         = $date_end\n        })\n    $Collections\n}\n</code></pre> <p><code>Get-WebCertificate https://google.com</code></p>"},{"location":"Network/#openvpn","title":"OpenVPN","text":"<p><code>Invoke-WebRequest -Uri https://swupdate.openvpn.org/community/releases/OpenVPN-2.6.5-I001-amd64.msi -OutFile $home\\Downloads\\OpenVPN-2.6.5.msi</code> <code>Start-Process $home\\Downloads\\OpenVPN-2.6.5.msi -ArgumentList '/quiet /SELECT_OPENSSL_UTILITIES=1' -Wait</code> <code>msiexec /i $home\\Downloads\\OpenVPN-2.6.5.msi ADDLOCAL=EasyRSA /passive /quiet # \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 EasyRSA Certificate Management Scripts</code> <code># msiexec /i $home\\Downloads\\OpenVPN-2.6.5.msi ADDLOCAL=OpenVPN.Service,Drivers,Drivers.Wintun,OpenVPN,OpenVPN.GUI,OpenVPN.GUI.OnLogon,EasyRSA /passive</code> \u0432\u044b\u0431\u043e\u0440\u043e\u0447\u043d\u0430\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430  <code># Invoke-WebRequest -Uri https://github.com/OpenVPN/easy-rsa/releases/download/v3.1.5/EasyRSA-3.1.5-win64.zip -OutFile $home\\Downloads\\EasyRSA-3.1.5.zip</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u0430\u043a\u0435\u0442 EasyRSA  <code>rm $home\\Downloads\\OpenVPN-2.6.5.msi</code></p> <p><code>cd \"C:\\Program Files\\OpenVPN\\easy-rsa\"</code> <code>Copy-Item vars.example vars</code> \u0444\u0430\u0439\u043b \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0434\u043b\u044f EasyRSA</p> <pre><code>set_var EASYRSA_TEMP_DIR \"$EASYRSA_PKI\"\nset_var EASYRSA_REQ_COUNTRY \"RU\"\nset_var EASYRSA_REQ_PROVINCE \"MSK\"\nset_var EASYRSA_REQ_CITY \"MSK\"\nset_var EASYRSA_REQ_ORG \"FAILON.NET\"\nset_var EASYRSA_REQ_EMAIL \"lifailon@domain.ru\"\nset_var EASYRSA_REQ_OU \"IT\"\n#set_var EASYRSA_KEY_SIZE 2048\n#set_var EASYRSA_CA_EXPIRE 3650\n#set_var EASYRSA_CERT_EXPIRE 825\n</code></pre> <p><code>.\\EasyRSA-Start.bat</code> \u0441\u0440\u0435\u0434\u0430 EasyRSA Shell  <code>easyrsa init-pki</code> \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f PKI, \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e: C:\\Program Files\\OpenVPN\\easy-rsa\\pki \u0438 \u0447\u0438\u0442\u0430\u0435\u0442 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u0430 \\easy-rsa\\vars  <code>easyrsa build-ca</code> \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0433\u043e CA \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u043f\u0430\u0440\u043e\u043b\u044f \u0438 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u043e\u0435 \u0438\u043c\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 (\\pki\\ca.crt \u0438 \\pki\\private\\ca.key)  <code>easyrsa gen-req server nopass</code> \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0438 \u043a\u043b\u044e\u0447 \u0434\u043b\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 OpenVPN - yes (\\pki\\reqs\\server.req \u0438 \\pki\\private\\server.key)  <code>easyrsa sign-req server server</code> \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0432\u044b\u043f\u0443\u0441\u043a \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e CA - yes (\\pki\\issued\\server.crt)  <code>easyrsa gen-dh</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043b\u044e\u0447 \u0414\u0438\u0444\u0444\u0438-\u0425\u0435\u043b\u043b\u043c\u0430\u043d\u0430 (\\pki\\dh.pem)  <code>easyrsa gen-req client1</code> nopass<code>\u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0438 \u043a\u043b\u044e\u0447 \u0434\u043b\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u0430 OpenVPN (\\pki\\reqs\\client1.req \u0438 \\pki\\private\\client1.key)</code> <code>easyrsa sign-req client client1</code> \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0432\u044b\u043f\u0443\u0441\u043a \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e CA - yes (\\pki\\issued\\client1.crt)  <code>easyrsa revoke client1</code> \u043e\u0442\u043e\u0437\u0432\u0430\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>openssl rsa -in \"C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\private\\client1.key\" -out \"C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\private\\client1_nopass.key\"</code> \u0441\u043d\u044f\u0442\u044c \u0437\u0430\u0449\u0438\u0442\u0443 \u043f\u0430\u0440\u043e\u043b\u0435\u043c \u0434\u043b\u044f \u043a\u043b\u044e\u0447\u0430 (BEGIN ENCRYPTED PRIVATE KEY -&gt; BEGIN PRIVATE KEY)  <code>exit</code> <code>cd \"C:\\Program Files\\OpenVPN\\bin\"</code> <code>.\\openvpn --genkey secret ta.key</code> \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043a\u043b\u044e\u0447\u0430 tls-auth (\\bin\\ta.key)  <code>Move-Item \"C:\\Program Files\\OpenVPN\\bin\\ta.key\" \"C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\\"</code></p>"},{"location":"Network/#serverovpn","title":"server.ovpn","text":"<p><code># Copy-Item \"C:\\Program Files\\OpenVPN\\sample-config\\server.ovpn\" \"C:\\Program Files\\OpenVPN\\config-auto\\server.ovpn\"</code> <code>New-Item -ItemType File -Path \"C:\\Program Files\\OpenVPN\\config-auto\\server.ovpn\"</code></p> <pre><code>port 1194\nproto udp\n# \u0427\u0442\u043e \u0438\u043c\u0435\u043d\u043d\u043e \u0438\u043d\u043a\u0430\u043f\u0441\u0443\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0442\u0443\u043d\u043d\u0435\u043b\u0435 (ethernet \u0444\u0440\u0435\u0439\u043c\u044b - tap \u0438\u043b\u0438 ip \u043f\u0430\u043a\u0435\u0442\u044b - tun)\ndev tun\nca \"C:\\\\Program Files\\\\OpenVPN\\\\easy-rsa\\\\pki\\\\ca.crt\"\ncert \"C:\\\\Program Files\\\\OpenVPN\\\\easy-rsa\\\\pki\\\\issued\\\\server.crt\"\nkey \"C:\\\\Program Files\\\\OpenVPN\\\\easy-rsa\\\\pki\\\\private\\\\server.key\"\ndh \"C:\\\\Program Files\\\\OpenVPN\\\\easy-rsa\\\\pki\\\\dh.pem\"\nserver 192.168.4.0 255.255.255.0\n# \u0425\u0440\u0430\u043d\u0438\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u043e\u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f ip \u0434\u043b\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432, \u0447\u0442\u043e \u0431\u044b \u043d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u0442\u043e\u0442 \u0436\u0435 \u0430\u0434\u0440\u0435\u0441 \u043f\u0440\u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\n# ifconfig-pool-persist \"C:\\\\Program Files\\\\OpenVPN\\\\dhcp-client-list.txt\"\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0430\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c\u0441\u044f \u043f\u043e\u0434 \u043e\u0434\u043d\u0438\u043c \u043a\u043b\u044e\u0447\u043e\u043c\n# duplicate-cn\n# max-clients 30\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u043e\u0431\u043c\u0435\u043d \u0442\u0440\u0430\u0444\u0438\u043a\u043e\u043c \u043c\u0435\u0436\u0434\u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u0430\u043c\u0438\nclient-to-client\n# compress\ntls-auth \"C:\\\\Program Files\\\\OpenVPN\\\\easy-rsa\\\\pki\\\\ta.key\" 0\ncipher AES-256-GCM\nkeepalive 20 60\n# \u041d\u0435 \u043f\u0435\u0440\u0435\u0447\u0438\u0442\u0430\u0432\u0430\u0442\u044c \u0444\u0430\u0439\u043b\u044b \u043a\u043b\u044e\u0447\u0435\u0439 \u043f\u0440\u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0442\u0443\u043d\u043d\u0435\u043b\u044f\npersist-key\n# \u041e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 tun/tap \u043f\u0440\u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0435 OpenVPN\npersist-tun\nstatus \"C:\\\\Program Files\\\\OpenVPN\\\\log\\\\status.log\"\nlog \"C:\\\\Program Files\\\\OpenVPN\\\\log\\\\openvpn.log\"\nverb 3\nmute 20\nwindows-driver wintun\n# \u041e\u0442\u043a\u0440\u044b\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043f\u043e\u0434\u0441\u0435\u0442\u0438 \u0437\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c\npush \"route 192.168.3.0 255.255.255.0\"\npush \"route 192.168.4.0 255.255.255.0\"\n# \u0417\u0430\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0432\u0441\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a\u043b\u0438\u0435\u043d\u0442\u0430 (\u0432 \u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0435 \u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442 \u0442\u0440\u0430\u0444\u0438\u043a) \u043d\u0430 OpenVPN \u0441\u0435\u0440\u0432\u0435\u0440\n# push \"redirect-gateway def1\"\n# push \"dhcp-option DNS 192.168.3.101\"\n# push \"dhcp-option DOMAIN failon.net\"\n</code></pre> <p><code>New-NetFirewallRule -DisplayName \"AllowOpenVPN-In\" -Direction Inbound -Protocol UDP \u2013LocalPort 1194 -Action Allow</code> \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435  <code>New-NetFirewallRule -DisplayName \"AllowOpenVPN-Out\" -Direction Outbound -Protocol UDP \u2013LocalPort 1194 -Action Allow</code> \u043d\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0435  <code>Get-Service *openvpn* | Restart-Service</code></p>"},{"location":"Network/#clientovpn","title":"client.ovpn","text":"<p><code># Copy-Item \"C:\\Program Files\\OpenVPN\\sample-config\\client.ovpn\" \"C:\\Program Files\\OpenVPN\\config-auto\\client.ovpn\"</code> <code>New-Item -ItemType File -Path \"C:\\Program Files\\OpenVPN\\config-auto\\client.ovpn\"</code></p> <pre><code>client\ndev tun\nproto udp\nremote 26.115.154.67 1194\nresolv-retry infinite\nnobind\npersist-key\npersist-tun\nca ca.crt\ncert client1.crt\nkey client1.key\nremote-cert-tls server\ntls-auth ta.key 1\ncipher AES-256-GCM\nconnect-retry-max 25\n# \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0440\u0430\u0439\u0432\u0435\u0440 wintun \u0438 \u043f\u043e\u043b\u043d\u044b\u0439 \u043f\u0443\u0442\u044c \u0434\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u043f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 openvpn gui\nwindows-driver wintun\nverb 3\n</code></pre>"},{"location":"Network/#client_1","title":"Client","text":"<p><code>iwr -Uri https://openvpn.net/downloads/openvpn-connect-v3-windows.msi -OutFile \"$home\\downloads\\OpenVPN-Connect-3.msi\"</code>  \u041f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0438 \u043a\u043b\u044e\u0447\u0438:  <code>client.ovpn</code> <code>ca.crt</code> <code>dh.pem</code> <code>ta.key</code> <code>client1.crt</code> <code>client1.key</code></p>"},{"location":"Network/#route","title":"Route","text":"<p><code>Get-Service RemoteAccess | Stop-Service</code> <code>Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\" -Name \"IPEnableRouter\" -Value 1</code> \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 IP \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u044e  <code>(Get-ItemProperty \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\").IPEnableRouter</code> <code>Get-NetIPInterface | select ifIndex,InterfaceAlias,AddressFamily,ConnectionState,Forwarding | ft</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u044b  <code>Set-NetIPInterface -ifIndex 13 -Forwarding Enabled</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u0430\u0434\u0440\u0435\u0441\u0430\u0446\u0438\u044e \u043d\u0430 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435</p> <p><code>sysctl net.ipv4.ip_forward=1</code> <code>echo \"sysctl net.ipv4.ip_forward = 1\" &gt;&gt; /etc/sysctl.conf</code></p> <p><code>Get-NetRoute</code> <code>New-NetRoute -DestinationPrefix \"192.168.3.0/24\" -NextHop \"192.168.4.1\" -InterfaceIndex 8</code> <code>route -p add 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 1</code> <code>route -p change 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 2</code> <code>route -p add 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 1 if 7</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043d\u043e\u043c\u0435\u0440 \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u043e\u0441\u044b\u043b\u0430\u0442\u044c \u043f\u0430\u043a\u0435\u0442 (Wintun Userspace Tunnel)  <code>route print -4</code> <code>route delete 192.168.3.0</code></p> <p><code>tracert 192.168.3.101</code> \u0441 192.168.4.6</p> <pre><code>1    17 ms     *       22 ms  192.168.4.1\n2    12 ms    13 ms    14 ms  192.168.3.101\n</code></pre> <p><code>route add -net 192.168.4.0 netmask 255.255.255.0 gw 192.168.3.100</code> <code>route -e</code></p> <p><code>traceroute 192.168.4.6</code> \u0441 192.168.3.101</p> <pre><code>1  192.168.3.100 (192.168.3.100)  0.148 ms  0.110 ms  0.106 ms\n2  192.168.4.6 (192.168.4.6)  14.573 ms * *\n</code></pre> <p><code>ping 192.168.3.101 -t</code> \u0441 192.168.4.6  <code>tcpdump -n -i ens33 icmp</code> \u043d\u0430 192.168.3.101</p> <pre><code>14:36:34.533771 IP 192.168.4.6 &gt; 192.168.3.101: ICMP echo request, id 1, seq 2962, length 40 # \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u043b \u0437\u0430\u043f\u0440\u043e\u0441\n14:36:34.533806 IP 192.168.3.101 &gt; 192.168.4.6: ICMP echo reply, id 1, seq 2962, length 40 # \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u043b \u043e\u0442\u0432\u0435\u0442\n</code></pre>"},{"location":"Network/#nat","title":"NAT","text":"<p><code>Get-Command -Module NetNat</code> <code>New-NetNat -Name LocalNat -InternalIPInterfaceAddressPrefix \"192.168.3.0/24\"</code> <code>Add-NetNatStaticMapping -NatName LocalNat -Protocol TCP -ExternalIPAddress 0.0.0.0 -ExternalPort 80 -InternalIPAddress 192.168.3.102 -InternalPort 80</code> <code>Remove-NetNatStaticMapping -StaticMappingID 0</code> <code>Remove-NetNat -Name LocalNat</code></p>"},{"location":"Network/#wireguard","title":"WireGuard","text":"<p><code>Invoke-WebRequest \"https://download.wireguard.com/windows-client/wireguard-amd64-0.5.3.msi\" -OutFile \"$home\\Downloads\\WireGuard-Client-0.5.3.msi\"</code> <code>msiexec.exe /i \"$home\\Downloads\\WireGuard-Client-0.5.3.msi\" DO_NOT_LAUNCH=1 /qn</code> <code>Invoke-WebRequest \"http://www.wiresock.net/downloads/wiresock-vpn-gateway-x64-1.1.4.1.msi\" -OutFile \"$home\\Downloads\\WireSock-VPN-Gateway-1.1.4.1.msi\"</code> <code>msiexec.exe /i \"http://www.wiresock.net/downloads/wiresock-vpn-gateway-x64-1.1.4.1.msi\" /qn</code> <code>$env:Path = [System.Environment]::GetEnvironmentVariable(\"Path\",\"Machine\") + \";\" + [System.Environment]::GetEnvironmentVariable(\"Path\",\"User\")</code> <code>wg-quick-config -add -start</code> <code>26.115.154.67:8181</code> <code>192.168.21.4/24</code> <code>Successfully saved client configuration: C:\\ProgramData\\NT KERNEL\\WireSock VPN Gateway\\wsclient_1.conf</code> <code>Successfully saved server configuration: C:\\ProgramData\\NT KERNEL\\WireSock VPN Gateway\\wiresock.conf</code> <code>get-service *wire*</code> <code>wg show</code> <code>wg-quick-config -add -restart</code> add client</p> <p>wiresock.conf</p> <pre><code>[Interface]\nPrivateKey = gCHC0g2JPwr6sXPiaOL4/KTkMyjN9TculrJUA/GORV8=\nAddress = 192.168.21.5/24\nListenPort = 8181\n\n[Peer]\nPublicKey = NoSxjew2RCHiUzI6mlahjd4I+0EcLsoYom/H01z91yU=\nAllowedIPs = 192.168.21.6/32\n</code></pre> <p>wsclient_1.conf (\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u044b \u0434\u043b\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0432 AllowedIPs)</p> <pre><code>[Interface]\nPrivateKey = yIpRQRmaGrrk9Y+49E8JhEpFmKzSeecvUAdeNgf1hUM=\nAddress = 192.168.21.6/24\nDNS = 8.8.8.8, 1.1.1.1\nMTU = 1420\n\n[Peer]\nPublicKey = Fp7674VSYeGj8CYt6RCKR7Qz1y/IKUXCw8ImOFhX3hk=\nAllowedIPs = 192.168.21.0/24, 192.168.3.0/24\nEndpoint = 26.115.154.67:8181\nPersistentKeepalive = 25\n</code></pre>"},{"location":"Network/#vpnclient","title":"VpnClient","text":"<p><code>Get-Command -Module VpnClient</code> <code>Add-VpnConnection -Name \"vpn-failon\" -ServerAddress \"26.115.154.67\" -TunnelType L2TP -L2tpPsk \"123098\" -EncryptionLevel \"Required\" -AuthenticationMethod MSChapv2 -RememberCredential -AllUserConnection \u2013PassThru -Force</code> <code>-TunnelType PPTP/L2TP/SSTP/IKEv2/Automatic</code> <code>-L2tpPsk</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u0449\u0438\u0439 \u043a\u043b\u044e\u0447 \u0434\u043b\u044f \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 (\u0431\u0435\u0437 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430, \u0434\u043b\u044f L2TP \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442)  <code>-AuthenticationMethod Pap/Chap/MSChapv2/Eap/MachineCertificate</code> <code>-EncryptionLevel NoEncryption/Optional/Required/Maximum/Custom</code> <code>-SplitTunneling</code> \u0437\u0430\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u0442\u044c \u0432\u0435\u0441\u044c \u0442\u0440\u0430\u0444\u0438\u043a \u0447\u0435\u0440\u0435\u0437 VPN-\u0442\u0443\u043d\u043d\u0435\u043b\u044c (\u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 Use default gateway on remote network \u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 VPN \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0430)  <code>-UseWinlogonCredential</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0443\u0447\u0435\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0434\u043b\u044f \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043d\u0430 VPN \u0441\u0435\u0440\u0432\u0435\u0440\u0435  <code>-RememberCredential</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0442\u044c \u0443\u0447\u0435\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f VPN \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f (\u0443\u0447\u0435\u0442\u043d\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c \u0438 \u043f\u0430\u0440\u043e\u043b\u044c \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044e\u0442\u0441\u044f \u0432 \u0434\u0438\u0441\u043f\u0435\u0442\u0447\u0435\u0440 \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 Windows \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0433\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f)  <code>-DnsSuffix domain.local</code> <code>-AllUserConnection</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c VPN \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 (\u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b: C:\\ProgramData\\Microsoft\\Network\\Connections\\Pbk\\rasphone.pbk)</p> <p><code>Install-Module -Name VPNCredentialsHelper</code> \u043c\u043e\u0434\u0443\u043b\u044c \u0434\u043b\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043b\u043e\u0433\u0438\u043d\u0430 \u0438 \u043f\u0430\u0440\u043e\u043b\u044f \u0432 Windows Credential Manager \u0434\u043b\u044f VPN \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f  <code>Set-VpnConnectionUsernamePassword -connectionname vpn-failon -username user1 -password password</code></p> <p><code>rasdial \"vpn-failon\"</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f  <code>Get-VpnConnection -AllUserConnection | select *</code> \u0441\u043f\u0438\u0441\u043e\u043a VPN \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043d\u0430\u0439\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0438 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0441\u0442\u0430\u0442\u0443\u0441 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f (ConnectionStatus)  <code>Add-VpnConnectionRoute -ConnectionName vpn-failon -DestinationPrefix 192.168.3.0/24 \u2013PassThru</code> \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u0430\u0440\u0448\u0440\u0443\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u0443\u0434\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u0435\u043d \u043f\u0440\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u043a VPN  <code>Remove-VpnConnection -Name vpn-failon -AllUserConnection -Force</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c</p> <p><code>Set-VpnConnection -Name \"vpn-failon\" -SplitTunneling $True</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b\u044c\u043d\u043e\u0435 \u0442\u0443\u043d\u0435\u043b\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435  <code>Add-VpnConnectionRoute -ConnectionName \"vpn-failon\" -DestinationPrefix 172.22.22.0/24</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u044e \u043a \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u043f\u043e\u0434\u0441\u0435\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 VPN-\u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435  <code>(Get-VpnConnection -ConnectionName \"vpn-failon\").routes</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f  <code>Remove-VpnConnectionRoute -ConnectionName \"vpn-failon\" -DestinationPrefix \"172.22.23.0/24\"</code></p>"},{"location":"Network/#proxyclient","title":"ProxyClient","text":"<p><code>$user = \"lifailon\"</code> <code>$pass = \"Proxy\"</code> <code>$SecureString = ConvertTo-SecureString $pass -AsPlainText -Force</code> <code>$Credential = New-Object System.Management.Automation.PSCredential($user, $SecureString)</code> <code>[System.Net.Http.HttpClient]::DefaultProxy = New-Object System.Net.WebProxy(\"http://192.168.3.100:9090\")</code> <code>[System.Net.Http.HttpClient]::DefaultProxy.Credentials = [System.Net.CredentialCache]::DefaultCredentials</code> <code>[System.Net.Http.HttpClient]::DefaultProxy.Credentials = $Credential</code> <code>Invoke-RestMethod http://ifconfig.me/ip</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0432\u043d\u0435\u0448\u043d\u0438\u0439 ip-\u0430\u0434\u0440\u0435\u0441 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0435\u0441\u0441\u0438\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442\u044c \u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u0439 \u043f\u0440\u043e\u043a\u0441\u0438 \u0441\u0435\u0440\u0432\u0435\u0440)  <code>Invoke-RestMethod https://kinozal.tv/rss.xml</code></p>"},{"location":"Network/#netsh","title":"netsh","text":""},{"location":"Network/#reverse-proxy","title":"Reverse Proxy","text":"<p><code>netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=192.168.3.108</code> \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u0442 \u0432\u0445\u043e\u0434\u044f\u0449\u0435\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 8080 \u043f\u043e\u0440\u0442\u0443 \u0438 \u043f\u0435\u0440\u0435\u0430\u0434\u0440\u0435\u0441\u0443\u0435\u0442 \u0442\u0440\u0430\u0444\u0438\u043a \u043d\u0430 80 \u043f\u043e\u0440\u0442 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0445\u043e\u0441\u0442\u0430  <code>netsh interface portproxy show all</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a  <code>netsh interface portproxy delete v4tov4 listenport=8080 listenaddress=0.0.0.0</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u0430\u0434\u0440\u0435\u0441\u0430\u0446\u0438\u044e</p>"},{"location":"Network/#wlan","title":"Wlan","text":"<p><code>netsh wlan show profile</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b \u043f\u0440\u043e\u0444\u0438\u043b\u0435\u0439 Wi-Fi \u0438 \u043f\u0430\u0440\u043e\u043b\u0435\u0439  <code>netsh wlan show interfaces</code> \u0445\u0430\u0440-\u043a\u0438 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0435\u0442\u0438 (MAC, speed)  <code>netsh wlan show profile SSID-Name-Network key=clear</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c  <code>netsh wlan show networks</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0438\u0434\u0435\u043c\u044b\u0445 \u0441\u0435\u0442\u0435\u0439  <code>netsh wlan disconnect</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043e\u0442 Wi-Fi  <code>netsh wlan connect name=\"SSID-Name-Network\"</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f  <code>netsh wlan show drivers</code> \u0434\u0440\u0430\u0439\u0432\u0435\u0440 Wi-Fi  <code>netsh wlan set hostednetwork mode=allow ssid=\"WiFi-Test\" key=\"password\"</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0442\u043e\u0447\u043a\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 Wi-Fi (SoftAP)</p>"},{"location":"Network/#firewall_1","title":"Firewall","text":"<p><code>netsh advfirewall set allprofiles state off</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c fw  <code>netsh advfirewall reset</code> \u0441\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438  <code>netsh advfirewall firewall add rule name=\"Open Remote Desktop\" protocol=TCP dir=in localport=3389 action=allow</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u0440\u0442 3389  <code>netsh advfirewall firewall add rule name=\"All ICMP V4\" dir=in action=allow protocol=icmpv4</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c icmp</p>"},{"location":"Network/#openssh","title":"OpenSSH","text":"<p><code>Get-WindowsCapability -Online | ? Name -like 'OpenSSH.Client*'</code> <code>Add-WindowsCapability -Online -Name OpenSSH.Client*</code> <code>dism /Online /Add-Capability /CapabilityName:OpenSSH.Client~~~~0.0.1.0</code> <code>iwr https://github.com/PowerShell/Win32-OpenSSH/releases/download/v9.2.2.0p1-Beta/OpenSSH-Win64-v9.2.2.0.msi -OutFile $home\\Downloads\\OpenSSH-Win64-v9.2.2.0.msi</code> \u0441\u043a\u0430\u0447\u0430\u0442\u044c  <code>msiexec /i $home\\Downloads\\OpenSSH-Win64-v9.2.2.0.msi</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c msi \u043f\u0430\u043a\u0435\u0442  <code>Set-Service sshd -StartupType Automatic</code> <code>Get-NetTCPConnection | where LocalPort -eq 22</code> <code>New-NetFirewallRule -Name sshd -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22</code> <code>Get-NetFirewallRule -Name *ssh*</code> <code>Start-Process notepad++ C:\\Programdata\\ssh\\sshd_config</code> \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b  <code>GSSAPIAuthentication yes</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c Kerberos \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044e (\u0447\u0435\u0440\u0435\u0437 AD)  <code>SyslogFacility LOCAL0</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0435 \u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0432 \u0444\u0430\u0439\u043b (C:\\ProgramData\\ssh\\logs\\sshd.log)  <code>LogLevel INFO</code> <code>Restart-Service sshd</code> <code>ssh -K $srv</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c Kerberos \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044e  <code>ssh Lifailon@192.168.3.99 -p 22</code> <code>pwsh -command Get-Service</code> <code>ssh -L 3101:192.168.3.101:22 -R 3101:192.168.3.101:22 lifailon@192.168.3.101 -p 22</code> SSH Tunnel lifailon@localhost:3101 -&gt; 192.168.3.101:3101</p>"},{"location":"Network/#psremoting-over-ssh","title":"PSRemoting over SSH","text":"<p><code>Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 OpenSSH Server  <code>Get-WindowsCapability -Online | ? Name -like 'OpenSSH.Ser*'</code> <code>iex \"&amp; { $(irm https://aka.ms/install-powershell.ps1) } -UseMSI\"</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 PowerShell Core \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 (\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043d\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0439 \u0441\u0442\u043e\u0440\u043e\u043d\u0435)  <code>Set-Service -Name sshd -StartupType \"Automatic\"</code> <code>Start-Service sshd</code> <code>Get-NetTCPConnection -State Listen|where {$_.localport -eq '22'}</code> <code>Enable-NetFirewallRule -Name *OpenSSH-Server*</code> <code>New-ItemProperty -Path \"HKLM:\\SOFTWARE\\OpenSSH\" -Name DefaultShell -Value \"C:\\Program Files\\PowerShell\\7\\pwsh.exe\" -PropertyType String \u2013Force</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u043f\u0440\u0438\u0442\u0430\u0442\u043e\u0440 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u043d\u0430 pwsh  <code>notepad $Env:ProgramData\\ssh\\sshd_config</code></p> <p>PasswordAuthentication yes  Subsystem powershell c:/progra~1/powershell/7/pwsh.exe -sshs -NoLogo # \u0437\u0430\u043f\u0443\u0441\u043a \u0438\u043d\u0442\u0435\u0440\u043f\u0440\u0435\u0442\u0430\u0442\u043e\u0440\u0430 pwsh \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0445 SSH \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439</p> <p><code>Restart-Service sshd</code></p> <p><code>$session = New-PSSession -HostName 192.168.3.100 -Port 2121 -UserName lifailon -SSHTransport</code> <code>Invoke-Command -Session $session -ScriptBlock {Get-Service}</code></p>"},{"location":"Network/#winrm","title":"WinRM","text":"<p><code>Enter-PSSession -ComputerName $srv</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a PowerShell \u0441\u0435\u0441\u0441\u0438\u0438 \u0447\u0435\u0440\u0435\u0437 PSRemoting. \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e FQDN-\u0438\u043c\u0435\u043d\u0438  <code>Invoke-Command $srv -ScriptBlock {Get-ComputerInfo}</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0447\u0435\u0440\u0435\u0437 PSRemoting  <code>$session = New-PSSession $srv</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0441\u0435\u0441\u0441\u0438\u044e  <code>Get-PSSession</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0441\u0435\u0441\u0441\u0438\u0438  <code>icm -Session $session {$srv = $using:srv}</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0435\u0441\u0441\u0438\u0438 ($using) \u0432 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u0443\u044e  <code>Disconnect-PSSession $session</code> \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u0441\u0435\u0441\u0441\u0438\u044e  <code>Remove-PSSession $session</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0435\u0441\u0441\u0438\u044e  <code>Import-Module -Name ActiveDirectory -PSSession $srv</code> \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u0441 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0435\u0441\u0441\u0438\u044e</p>"},{"location":"Network/#windows-remote-management-configuration","title":"Windows Remote Management Configuration","text":"<p><code>winrm quickconfig -quiet</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442 \u0437\u0430\u043f\u0443\u0441\u043a \u0441\u043b\u0443\u0436\u0431\u044b WinRM \u043d\u0430 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439, \u0437\u0430\u0434\u0430\u0441\u0442 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 WinRM \u0438 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u043f\u043e\u0440\u0442\u043e\u0432 \u0432 fw  <code>Enable-PSRemoting \u2013Force</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c PowerShell Remoting, \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0434\u043e\u043c\u0435\u043d\u043d\u043e\u0433\u043e \u0438 \u0447\u0430\u0441\u0442\u043d\u043e\u0433\u043e \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u043f\u0440\u043e\u0444\u0438\u043b\u0435\u0439 Windows  <code>Enable-PSRemoting -SkipNetworkProfileCheck -Force</code> \u0434\u043b\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0432 \u043e\u0431\u0449\u0435\u0439 (public) \u0441\u0435\u0442\u0438 (\u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0441 \u0432\u0435\u0440\u0441\u0438\u0438 powershell 6)</p> <p><code>$NetProfiles = Get-NetConnectionProfile</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u0438 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439  <code>Set-NetConnectionProfile -InterfaceIndex $NetProfiles[1].InterfaceIndex -NetworkCategory Private</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0442\u0438\u043f \u0441\u0435\u0442\u0438 \u0434\u043b\u044f \u043f\u0440\u043e\u0444\u0438\u043b\u044f (DomainAuthenticated/Public)  <code>(Get-CimInstance -ClassName Win32_ComputerSystem).PartOfDomain</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u0447\u0442\u043e \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0432 \u0434\u043e\u043c\u0435\u043d AD  <code>Get-Service WinRM | Set-Service -StartupType AutomaticDelayedStart</code> \u043e\u0442\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0439 \u0437\u0430\u043f\u0443\u0441\u043a  <code>Get-Service -Name winrm -RequiredServices</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u044b\u0445 \u0441\u043b\u0443\u0436\u0431  <code>New-NetFirewallRule -Profile Any -DisplayName \"WinRM HTTP\" -Direction Inbound -Protocol TCP -LocalPort 5985,5986</code> <code>Test-NetConnection $srv -port 5895</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043f\u043e\u0440\u0442  <code>Test-WSMan $srv -ErrorAction Ignore</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0443 WinRM \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0435 (\u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043e\u0448\u0438\u0431\u043e\u043a \u0434\u043b\u044f \u0441\u043a\u0440\u0438\u043f\u0442\u0430) \u0438\u043b\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e (localhost)</p> <p><code>$Cert = New-SelfSignedCertificate -CertStoreLocation Cert:\\LocalMachine\\My -DnsName \"$env:computername\" -FriendlyName \"WinRM HTTPS Certificate\" -NotAfter (Get-Date).AddYears(5)</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0430\u043c\u043e\u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442  <code>$Thumbprint = $Cert.Thumbprint</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u043e\u0442\u043f\u0435\u0447\u0430\u0442\u043e\u043a  <code>New-Item -Path WSMan:\\Localhost\\Listener -Transport HTTPS -Address * -CertificateThumbprint $Thumbprint -Name WinRM_HTTPS_Listener -Force</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0440\u043e\u0441\u043b\u0443\u0448\u0438\u0432\u0430\u0442\u0435\u043b\u044c  <code>New-NetFirewallRule -DisplayName 'WinRM HTTPS' -Profile Domain,Private -Direction Inbound -Action Allow -Protocol TCP -LocalPort 5986</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u0440\u0442 \u0432 fw</p> <pre><code>$selector_set = @{\n    Address = \"*\"\n    Transport = \"HTTPS\"\n}\n$value_set = @{\n    CertificateThumbprint = \"66ABFDA044D8C85135048186E2FDC0DBE6125163\"\n}\nNew-WSManInstance -ResourceURI \"winrm/config/Listener\" -SelectorSet $selector_set -ValueSet $value_set\n</code></pre> <p><code>winrm get winrm/config</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u044e \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e (Client/Service)  <code>winrm get winrm/config/service/auth</code> \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435  <code>winrm enumerate winrm/config/listener</code> \u0442\u0435\u043a\u0443\u0449\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0441\u043b\u0443\u0448\u0438\u0432\u0430\u0442\u0435\u043b\u0435\u0439 WinRM (\u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043e\u0442\u043f\u0435\u0447\u0430\u0442\u043e\u043a \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0434\u043b\u044f HTTPS 5986)  <code>Get-ChildItem -Path Cert:\\LocalMachine\\My\\ | where Thumbprint -eq D9356FB774EE0E6206B7D5B59B99102CA5B17BDA | select *</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0435</p> <p><code>ls WSMan:\\localhost\\Client</code> \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u043a\u043b\u0438\u0435\u043d\u0442\u0430  <code>ls WSMan:\\localhost\\Service</code> \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>ls WSMan:\\localhost\\Service\\auth</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0439 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 WinRM \u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>Set-Item -path WSMan:\\localhost\\Service\\auth\\basic -value $true</code> \u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u0443\u044e \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044e \u043a \u0442\u0435\u043a\u0443\u0449\u0435\u043c\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u0443  <code>ls HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WSMAN</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0432 \u0440\u0435\u0435\u0441\u0442\u0440\u0435 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0434\u043b\u044f \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0430\u0443\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0432 \\Service\\auth_basic = 1)  <code>Set-Item WSMan:\\localhost\\Client\\TrustedHosts -Value 192.168.* -Force</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u044b\u0435 \u0445\u043e\u0441\u0442\u044b \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u043d\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0440\u0430\u0431\u043e\u0442\u0430\u043b\u0430 Negotiate \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0447\u0435\u0440\u0435\u0437 NTLM  <code>Set-Item WSMan:\\localhost\\Client\\TrustedHosts -Value 192.168.3.100 -Concatenate -Force</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432\u0442\u043e\u0440\u043e\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440  <code>ls WSMan:\\localhost\\Client\\TrustedHosts</code> <code>Set-Item WSMan:\\localhost\\Client\\AllowUnencrypted $true</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0430 \u043d\u0435\u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0430  <code>Set-Item WSMan:\\localhost\\Service\\AllowUnencrypted $true</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0430 \u043d\u0435\u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 (\u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0431\u044b\u0442\u044c \u0432 private \u0441\u0435\u0442\u0438)</p> <p><code>Get-PSSessionConfiguration</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u0432\u043a\u043b\u044e\u0447\u0435\u043d \u043b\u0438 PSremoting \u0438 \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0438 \u0433\u0440\u0443\u043f\u043f, \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c\u0441\u044f \u0447\u0435\u0440\u0435\u0437 WinRM  <code>Set-PSSessionConfiguration -Name Microsoft.PowerShell -ShowSecurityDescriptorUI</code> \u043d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0447\u0435\u0440\u0435\u0437 \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0435\u0441\u0441\u0438\u0438 (\u0434\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u043a\u0438)  <code>(Get-PSSessionConfiguration -Name \"Microsoft.PowerShell\").SecurityDescriptorSDDL</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u0430 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 SDDL  <code>Set-PSSessionConfiguration -Name Microsoft.PowerShell -SecurityDescriptorSDDL $SDDL</code> \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0434\u0435\u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0440\u0430 \u043d\u0430 \u0434\u0440\u0443\u0433\u043e\u043c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0435 \u0431\u0435\u0437 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f GUI </p> <p><code>New-LocalUser \"WinRM-Writer\" -Password (ConvertTo-SecureString -AsPlainText \"123098\")</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Add-LocalGroupMember -Group \"Remote Management Users\" -Member \"WinRM-Writer\"</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f WinRM-Writer \u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f\"  <code>cmdkey /add:192.168.3.99 /user:WinRM-Writer /pass:123098</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u0432 CredentialManager <code>cmdkey /list</code> <code>Import-Module CredentialManager</code> <code>Add-Type -AssemblyName System.Web</code> <code>New-StoredCredential -Target 192.168.3.99 -UserName WinRM-Writer -Password 123098 -Comment WinRM</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u0432 CredentialManager (\u0438\u0437 PS5)  <code>Get-StoredCredential -AsCredentialObject</code> <code>$cred = Get-StoredCredential -Target 192.168.3.99</code> <code>Enter-PSSession -ComputerName 192.168.3.99 -Credential $cred -Authentication Negotiate</code> <code>Enter-PSSession -ComputerName 192.168.3.99 -Credential $cred -Authentication Basic -Port 5985</code> \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043f\u0440\u0438 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 allowunencrypted \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0430  <code>winrs -r:http://192.168.3.100:5985/wsman -u:WinRM-Writer -p:123098 ipconfig</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0447\u0435\u0440\u0435\u0437 winrs (-?)  <code>winrs -r:https://192.168.3.100:5985/wsman -u:WinRM-Writer -p:123098 -ssl ipconfig</code> \u0447\u0435\u0440\u0435\u0437 https  <code>pwsh -Command \"Install-Module -Name PSWSMan\"</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432 Linux \u0441\u0438\u0441\u0442\u0435\u043c\u0435</p>"},{"location":"Network/#kerberos","title":"Kerberos","text":"<p><code>.\\CheckMaxTokenSize.ps1 -Principals login -OSEmulation $true -Details $true</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0442\u043e\u043a\u0435\u043d\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0434\u043e\u043c\u0435\u043d\u0435  <code>Get-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Kerberos\\Parameters | select maxtokensize</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0442\u043e\u043a\u0435\u043d\u0430 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435  <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\HTTP\\Parameters</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440\u0430, \u0435\u0441\u043b\u0438 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u043f\u0430\u043a\u0435\u0442\u0430 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0435\u0442 16 \u041a\u0431 (\u0438\u0437 \u0437\u0430 \u0431\u043e\u043b\u044c\u0448\u043e\u0433\u043e \u043a\u043e\u043b-\u0432\u0430 \u0433\u0440\u0443\u043f\u043f)  <code>MaxFieldLength \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0434\u043e 0000ffff (65535)</code> <code>MaxRequestBytes \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0434\u043e 0000ffff (65535)</code></p>"},{"location":"Network/#console-download","title":"Console-Download","text":"<p><code>Install-Module Console-Download -Repository NuGet</code> \u0443\u0441\u0442\u0430\u043e\u0432\u0438\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u0438\u0437 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u0430 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 NuGet  <code>Invoke-Expression $(Invoke-RestMethod \"https://raw.githubusercontent.com/Lifailon/Console-Download/rsa/module/Console-Download/Console-Download.psm1\")</code> \u0438\u043b\u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u0438\u0437 GitHub \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f \u0432 \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0441\u0435\u0441\u0441\u0438\u044e PowerShell  <code>Invoke-Download -Url \"https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip\"</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b \u0432 \u043e\u0434\u0438\u043d \u043f\u043e\u0442\u043e\u043a \u0441 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435\u043c \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d (\u043f\u0443\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0444\u0430\u0439\u043b\u0430 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: $home\\downloads)  <code>Invoke-Download -Url \"https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip\" -Thread 3</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043e\u0434\u0438\u043d \u0438 \u0442\u043e\u0442\u0436\u0435 \u0444\u0430\u0439\u043b \u0432 3 \u043f\u043e\u0442\u043e\u043a\u0430 (\u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f 3 \u0444\u0430\u0439\u043b\u0430, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u043e\u0442 1 \u0434\u043e 20 \u043f\u043e\u0442\u043e\u043a\u043e\u0432)</p> <pre><code>$urls = @(\n    \"https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip\",\n    \"https://github.com/Lifailon/helperd/releases/download/0.0.1/Helper-Desktop-Setup-0.0.1.exe\"\n)\nInvoke-Download $urls # \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u043e 2 \u0444\u0430\u0439\u043b\u0430\n</code></pre> <p><code>$urls = Get-Content \"$home\\Desktop\\links.txt\"</code> <code>Invoke-Download $urls</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0439\u0442\u0435 \u0441\u043f\u0438\u0441\u043e\u043a URL-\u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u0438\u0437 \u0444\u0430\u0439\u043b\u0430 \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0444\u0430\u0439\u043b\u043e\u0432, \u044d\u043a\u0432\u0438\u0432\u0430\u043b\u0435\u043d\u0442\u043d\u043e\u043c\u0443 \u0447\u0438\u0441\u043b\u0443 url</p> <p><code>$urls = Get-LookingGlassList</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0445 \u0442\u043e\u0447\u0435\u043a Looking Glass \u0447\u0435\u0440\u0435\u0437 Looking.House (\u0432\u044b\u0434\u0430\u0435\u0442 3 \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443 \u0444\u0430\u0439\u043b\u043e\u0432 \u043f\u043e 10, 100 \u0438 1000 \u043c\u0431\u0430\u0439\u0442 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0440\u0435\u0433\u0438\u043e\u043d\u0430)  <code>$usaNy = $urls | Where-Object region -like *USA*New*York*</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e \u0440\u0435\u0433\u0438\u043e\u043d\u0443 \u0438 \u0433\u043e\u0440\u043e\u0434\u0443  <code>$url = $usaNy[0].url100mb</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u043f\u0435\u0440\u0432\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443 \u0441 \u0444\u0430\u0439\u043b\u043e\u0432 \u043d\u0430 100 \u041c\u0411\u0430\u0439\u0442  <code>Invoke-Download $url</code> \u043d\u0430\u0447\u0430\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443 \u0444\u0430\u0439\u043b\u0430  <code>Invoke-Download $url -Thread 3</code> \u043d\u0430\u0447\u0430\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443 3-\u0445 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432</p>"},{"location":"Network/#psdomaintest","title":"PSDomainTest","text":"<p><code>Install-Module PSDomainTest -Repository NuGet -Scope CurrentUser</code> <code>Get-DomainTest -Domain github.com -Warning</code> \u043f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u043e\u043c\u0435\u043d \u0438 DNS \u0437\u0430\u043f\u0438\u0441\u0438 \u043d\u0430 \u043e\u0448\u0438\u0431\u043a\u0438 (\u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0448\u0438\u0431\u043a\u0438) \u0447\u0435\u0440\u0435\u0437 ZoneMaster (https://github.com/zonemaster/zonemaster)  <code>Get-DomainTest -Domain github.com -Warning -json</code> \u0432\u044b\u0432\u043e\u0434 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 json  <code>Get-DomainTest -Domain github.com -html | Out-File .\\result.html</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043e\u0442\u0447\u0435\u0442 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 HTML-\u0442\u0430\u0431\u043b\u0438\u0446\u044b \u0441 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0435\u0439 \u043f\u043e \u0441\u0442\u043e\u043b\u0431\u0446\u0430\u043c</p>"},{"location":"Network/#check-host","title":"Check-Host","text":"<pre><code>$path = $(($env:PSModulePath -split \";\")[0]) + \"\\Get-CheckHost\"\nif (Test-Path $path) {\n    Remove-Item $path -Force -Recurse\n    New-Item -ItemType Directory -Path $path\n} else {\n    New-Item -ItemType Directory -Path $path\n}\nInvoke-RestMethod \"https://raw.githubusercontent.com/Lifailon/Check-Host/rsa/Get-CheckHost/Get-CheckHost.psm1\" -OutFile \"$path\\Get-CheckHost.psm1\"\n</code></pre> <p><code>Install-Module CheckHost</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u0440\u0430\u0431\u043e\u0442\u044b \u0441 Check-Host (https://check-host.net) \u0447\u0435\u0440\u0435\u0437 api  <code>Get-CheckHost -List</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0445\u043e\u0441\u0442\u043e\u0432 (node) \u0440\u0430\u0437\u043d\u044b\u0445 \u0440\u0435\u0433\u0438\u043e\u043d\u043e\u0432 (40)  <code>Get-CheckHost -Server google.com -Type ping -Count 5</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c 5 \u043b\u044e\u0431\u044b\u0445 \u0445\u043e\u0441\u0442\u043e\u0432 \u0434\u043b\u044f 4 \u043f\u0438\u043d\u0433\u043e\u0432 \u0441 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0434\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e url (google)  <code>Get-CheckHost -Server google.com -Type dns -Count 5</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c DNS (\u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0410-\u0437\u0430\u043f\u0438\u0441\u044c \u0438\u043b\u0438 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u0441 ip-\u0430\u0434\u0440\u0435\u0441\u043e\u043c)  <code>Get-CheckHost -Server google.com:443 -Type http -Count 5</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0440\u0442\u0430  <code>Get-CheckHost -Server google.com:443 -Type tcp -Count 5</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c TCP \u0438\u043b\u0438 UDP \u043f\u043e\u0440\u0442\u0430</p>"},{"location":"Network/#syslog","title":"Syslog","text":""},{"location":"Network/#psyslog","title":"pSyslog","text":"<p><code>Install-Module pSyslog -Repository NuGet</code> <code>Start-pSyslog -Port 514</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440 \u043d\u0430 \u043f\u043e\u0440\u0442\u0443 514 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e)  <code>Start-pSyslog -RotationSize 500</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0434\u043b\u044f \u0435\u0433\u043e \u0440\u043e\u0442\u0430\u0446\u0438\u0438 (\u043e\u0431\u0440\u0435\u0437\u0430\u043d\u0438\u044f) \u0432 \u041a\u0411  <code>Get-pSyslog -Status | Format-List</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0440\u0430\u0431\u043e\u0442\u044b  <code>Get-pSyslog</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0436\u0443\u0440\u043d\u0430\u043b \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438  <code>Stop-pSyslog</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440  <code>Send-pSyslog -Content \"Test\" -Server 192.168.3.99</code> \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043d\u0430 Syslog-\u0441\u0435\u0440\u0432\u0435\u0440  <code>Send-pSyslog -Content \"Test\" -Server 192.168.3.99 -Type Informational -PortServer 514 -PortClient 55514</code> <code>(Get-Service -Name WinRM).Status | Send-pSyslog -Server 192.168.3.102 -Tag Service[WinRM]</code> <code>Send-pSyslog -Content \"test\" -Server 192.168.3.99 -PortServer 514 -Base64</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f (\u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 pSyslog)  <code>Start-UDPRelay -inPort 515 -outIP 192.168.3.102 -outPort 514</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440 \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 UDP-Relay, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0441\u043b\u0443\u0448\u0430\u0435\u0442 \u043d\u0430 \u043f\u043e\u0440\u0442\u0443 515 \u0438 \u043f\u0435\u0440\u0435\u0430\u0434\u0440\u0435\u0441\u0443\u0435\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043d\u0430 Syslog \u0441\u0435\u0440\u0432\u0435\u0440 192.168.3.102 \u0441 \u043f\u043e\u0440\u0442\u043e\u043c 514  <code>Send-pSyslog -Server 192.168.3.99 -PortServer 515 -Content $(Get-Date)</code> \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 UDP-Relay  <code>Show-pSyslog -Type Warning -Count</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043c\u0435\u0442\u0440\u0438\u043a\u0438 (\u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0448\u0438\u0431\u043e\u043a)  <code>Show-pSyslog -Type Alert -Count</code> <code>Show-pSyslog -Type Critical -Count</code> <code>Show-pSyslog -Type Error -Count</code> <code>Show-pSyslog -Type Emergency -Count</code> <code>Show-pSyslog -Type Informational -Count</code> <code>Show-pSyslog -LogFile 05-06 | Out-GridView</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0436\u0443\u0440\u043d\u0430\u043b \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0432 GridView \u0434\u043b\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439  <code>Show-pSyslog -Count</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0436\u0443\u0440\u043d\u0430\u043b\u0430  <code>Show-pSyslog -Count -LogFile 10-06</code> \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0436\u0443\u0440\u043d\u0430\u043b \u043f\u043e \u0434\u0430\u0442\u0435</p>"},{"location":"Network/#syslog-source-message","title":"Syslog source message","text":"<pre><code>Add-Type -TypeDefinition @\"\npublic enum Syslog_Facility {\n    kern,     // 0  kernel (core) messages\n    user,     // 1  user level messages\n    mail,     // 2  mail system\n    daemon,   // 3  system daemons\n    auth,     // 4  security/authorization messages (login/su)\n    syslog,   // 5  syslog daemon\n    lpr,      // 6  line printer subsystem (creating jobs and send to spool for print by using lpd)\n    news,     // 7  network news subsystem (USENET)\n    uucp,     // 8  Unix-to-Unix Copy subsystem\n    cron,     // 9  scheduling daemon\n    authpriv, // 10 security/authorization private messages\n    ftp,      // 11 FTP daemon\n    ntp,      // 12 NTP daemon\n    security, // 13 security log audit\n    console,  // 14 console log alert\n    clock,    // 15 clock subsystem\n    local0,   // 16 local use\n    local1,   // 17\n    local2,   // 18\n    local3,   // 19\n    local4,   // 20\n    local5,   // 21\n    local6,   // 22\n    local7    // 23\n}\n\"@\n</code></pre>"},{"location":"Network/#syslog-type-message","title":"Syslog type message","text":"<pre><code>Add-Type -TypeDefinition @\"\npublic enum Syslog_Severity {\n    Emergency,     // 0 emerg\n    Alert,         // 1 alert\n    Critical,      // 2 crit\n    Error,         // 3 err\n    Warning,       // 4 warning\n    Notice,        // 5 notice\n    Informational, // 6 info\n    Debug          // 7 debug\n}\n\"@\n</code></pre>"},{"location":"SCM/","title":"SCM","text":""},{"location":"SCM/#git","title":"Git","text":"<p><code>git --version</code> <code>git config --global user.name \"Lifailon\"</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0438\u043c\u044f \u0434\u043b\u044f \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432  <code>git config --global user.email \"lifailon@yandex.ru\"</code> <code>git config --global --edit</code> <code>ssh-keygen -t rsa -b 4096</code> <code>Get-Service | where name -match \"ssh-agent\" | Set-Service -StartupType Automatic</code> <code>Get-Service | where name -match \"ssh-agent\" | Start-Service</code> <code>Get-Service | where name -match \"ssh-agent\" | select Name,Status,StartType</code> <code>ssh-agent</code> <code>ssh-add C:\\Users\\Lifailon\\.ssh\\id_rsa</code> <code>cat ~\\.ssh\\id_rsa.pub | Set-Clipboard</code> copy to settings keys <code>cd $home\\Documents\\Git</code> <code>git clone git@github.com:Lifailon/lifailon.github.io</code> <code>cd lifailon.github.io</code> <code>git grep \"ping ya.ru\"</code> \u043f\u043e\u0438\u0441\u043a \u0442\u0435\u043a\u0441\u0442\u0430 \u0432 \u0444\u0430\u0439\u043b\u0430\u0445  <code>git fetch</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u0437 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u0441\u0435\u0445 \u0432\u0435\u0442\u043e\u043a \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f, \u043d\u0435 \u0437\u0430\u0442\u0440\u0430\u0433\u0438\u0432\u0430\u044f \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0440\u0430\u0431\u043e\u0447\u0443\u044e \u0432\u0435\u0442\u043a\u0443 (\u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442 \u0432\u0441\u0435 \u043a\u043e\u043c\u043c\u0438\u0442\u044b, \u0432\u0435\u0442\u043a\u0438 \u0438 \u0442.\u0434. \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u043c \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438)  <code>git fetch --all</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0432\u0435\u0442\u043a\u0438 \u0441 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f (\u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f \u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442 \u0432\u0441\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432\u0430\u0448\u0438\u0445 \u0432\u0435\u0442\u043e\u043a \u0431\u0435\u0437 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f)  <code>git pull</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u0437 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f (\u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 git fetch, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u0437 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f, \u0430 \u0437\u0430\u0442\u0435\u0438\u043c \u043e\u0431\u044a\u0435\u0434\u0435\u043d\u044f\u0435\u043c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u043a\u043e\u043f\u0438\u0435\u0439 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e git merge \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u0432\u0435\u0442\u043a\u0438)  <code>git status</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u043f\u043e \u0444\u0430\u0439\u043b\u0430\u043c  <code>git diff</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u043f\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u043e  <code>git diff pandoc</code> \u0441\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u0435\u0442 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0441 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u043c \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u043c \u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0432\u0435\u0442\u043a\u0435  <code>git add .</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c (\u043f\u0440\u043e\u0438\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u0442\u044c) \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432\u043e \u0432\u0441\u0435\u0445 \u0444\u0430\u0439\u043b\u0430\u0445 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430  <code>git commit -m \"update powershell commands\"</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0435\u043c  <code>git push</code> \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0435\u043c \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435  <code>git push origin mkdocs-material</code> \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u0443\u044e \u0432\u0435\u0442\u043a\u0443  <code>git push origin --delete mkdocs</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0435\u0442\u043a\u0443 \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0435  <code>git branch -a</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0432\u0435\u0442\u043a\u0438 (\u0432 \u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0435 remotes/origin)  <code>git branch hugo</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0432\u0435\u0442\u043a\u0443  <code>git branch -m hugo-public</code> \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u0432\u0435\u0442\u043a\u0443  <code>git branch -d hugo-public</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0435\u0442\u043a\u0443  <code>git switch hugo</code> \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u0434\u0440\u0443\u0433\u0443\u044e \u0432\u0435\u0442\u043a\u0443  <code>git push origin hugo</code> \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u0443\u044e \u0432\u0435\u0442\u043a\u0443  <code>git push --set-upstream origin hugo</code> \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0432\u0435\u0442\u043a\u0435 (\u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0434\u0435\u043b\u0430\u0442\u044c push \u0431\u0435\u0437 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u044f \u0432\u0435\u0442\u043a\u0438)  <code>git merge hugo</code> \u0441\u043b\u0438\u044f\u043d\u0438\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0432\u0435\u0442\u043a\u0438 (pandoc) \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 (hugo)  <code>git log --oneline --all</code> \u043b\u043e\u0433 \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432  <code>git log --graph</code> \u043a\u043e\u043c\u043c\u0438\u0442\u044b \u0438 \u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0432\u0435\u0442\u043e\u043a  <code>git log --author=\"Lifailon\"</code> \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>git blame index.html</code> \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442, \u043a\u0442\u043e \u0438 \u043a\u043e\u0433\u0434\u0430 \u0432\u043d\u0435\u0441 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u043a\u0430\u0436\u0434\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430  <code>git show d01f09dead3a6a8d75dda848162831c58ca0ee13</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0439 \u043b\u043e\u0433 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 \u043a\u043e\u043c\u043c\u0438\u0442\u0430  <code>git restore filename</code> \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u0441\u0435 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043a\u043e\u043f\u0438\u0438 \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e \u043e\u0442 \u0442\u043e\u0433\u043e, \u0431\u044b\u043b\u0438 \u043e\u043d\u0438 \u043f\u0440\u043e\u0438\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u0438\u043b\u0438 \u043d\u0435\u0442 (\u0435\u0441\u043b\u0438 \u0431\u044b\u043b\u0430 \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u0446\u0438\u044f \u0447\u0435\u0440\u0435\u0437 add), \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u044f \u0435\u0433\u043e \u043a \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e \u043d\u0430 \u043c\u043e\u043c\u0435\u043d\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043a\u043e\u043c\u043c\u0438\u0442\u0430  <code>git restore --source d01f09dead3a6a8d75dda848162831c58ca0ee13 filename</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0444\u0430\u0439\u043b \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u0443\u044e \u0432\u0435\u0440\u0441\u0438\u044e \u043f\u043e \u0445\u044d\u0448\u0443 \u0438\u043d\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u0430 \u043a\u043e\u043c\u043c\u0438\u0442\u0430  <code>git checkout filename</code> \u043e\u0442\u043a\u0430\u0442\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043d\u0435 \u043f\u0440\u043e\u0438\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043a\u043e\u043c\u043c\u0438\u0442\u0430, \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u044f \u0435\u0433\u043e \u043a \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e, \u043a\u0430\u043a\u0438\u043c \u043e\u043d\u043e \u0431\u044b\u043b\u043e \u043d\u0430 \u043c\u043e\u043c\u0435\u043d\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043a\u043e\u043c\u043c\u0438\u0442\u0430 (\u0435\u0441\u043b\u0438 \u043d\u0435 \u0431\u044b\u043b\u043e \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u0446\u0438\u0438 \u0447\u0435\u0440\u0435\u0437 add)  <code>git checkout d01f09dead3a6a8d75dda848162831c58ca0ee13</code> \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043a\u043e\u043f\u0438\u0438 \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043c\u0438\u0442 (\u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0430\u0435\u0442 HEAD \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043c\u0438\u0442)  <code>git reset HEAD filename</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u0438\u0437 \u0438\u043d\u0434\u0435\u043a\u0441\u0430 \u0431\u0435\u0437 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0441\u0430\u043c\u0438\u0445 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0432 \u0444\u0430\u0439\u043b\u0435 \u0434\u043b\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0439 \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u0446\u0438\u0438 (\u0435\u0441\u043b\u0438 \u0431\u044b\u043b add \u043d\u043e \u043d\u0435 \u0431\u044b\u043b\u043e commit, \u043f\u043e\u0442\u043e\u043c \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c checkout)  <code>git reset --soft HEAD^</code> \u043e\u0442\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 (^) \u043a\u043e\u043c\u043c\u0438\u0442, \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044f \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u0437 \u044d\u0442\u043e\u0433\u043e \u043a\u043e\u043c\u043c\u0438\u0442\u0430 \u0432 \u0440\u0430\u0431\u043e\u0447\u0435\u043c \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435 \u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0435 (\u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0439 \u043e\u0431\u043b\u0430\u0441\u0442\u0438), \u043c\u043e\u0436\u043d\u043e \u0432\u043d\u0435\u0441\u0442\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0444\u0430\u0439\u043b\u044b \u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u0438\u0445 \u0437\u0430\u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u0442\u044c  <code>git reset --hard HEAD^</code> \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u043e\u0442\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u043a\u043e\u043c\u043c\u0438\u0442, \u0443\u0434\u0430\u043b\u044f\u044f \u0432\u0441\u0435 \u0435\u0433\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u0437 \u0440\u0430\u0431\u043e\u0447\u0435\u0433\u043e \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 \u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0430 \u0434\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043a\u043e\u043c\u043c\u0438\u0442\u0430  <code>git reset --hard d01f09dead3a6a8d75dda848162831c58ca0ee13</code> \u043e\u0442\u043a\u0430\u0442\u044b\u0432\u0430\u0435\u0442 HEAD \u043a \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c\u0443 \u043a\u043e\u043c\u043c\u0438\u0442\u0443 \u0438 \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0432\u0441\u0435 \u043a\u043e\u043c\u043c\u0438\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u044b\u043b\u0438 \u0441\u0434\u0435\u043b\u0430\u043d\u044b \u043f\u043e\u0441\u043b\u0435 \u043d\u0435\u0433\u043e (\u0431\u0443\u0434\u0443\u0442 \u043f\u043e\u0442\u0435\u0440\u044f\u043d\u044b \u0432\u0441\u0435 \u043d\u0435\u0437\u0430\u043a\u043e\u043c\u043c\u0438\u0447\u0435\u043d\u043d\u044b\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432 \u043f\u043e\u0441\u043b\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e)  <code>git revert HEAD --no-edit</code> \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043d\u043e\u0432\u044b\u0439 \u043a\u043e\u043c\u043c\u0438\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0442\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u043a\u043e\u043c\u043c\u0438\u0442 (HEAD) \u0438 \u043d\u043e\u0432\u044b\u0439 \u043a\u043e\u043c\u043c\u0438\u0442 \u0431\u0443\u0434\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u043f\u043e\u0432\u0435\u0440\u0445 \u043d\u0435\u0433\u043e (\u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0432 git log)  <code>git revert d01f09dead3a6a8d75dda848162831c58ca0ee13</code> \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043d\u043e\u0432\u044b\u0439 \u043a\u043e\u043c\u043c\u0438\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0442\u043c\u0435\u043d\u044f\u0435\u0442 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f, \u0432\u043d\u0435\u0441\u0435\u043d\u043d\u044b\u0435 \u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043c\u0438\u0442 \u0441 \u0445\u0435\u0448\u0435\u043c (\u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432, \u0430 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043d\u043e\u0432\u044b\u0439 \u043a\u043e\u043c\u043c\u0438\u0442 \u0441 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f\u043c\u0438 \u043e\u0442\u043c\u0435\u043d\u044b)  <code>git stash</code> \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u0442\u0435\u043a\u0443\u0449\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0441\u0442\u044d\u0448 (\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0435 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435) \u0438 \u043e\u0447\u0438\u0449\u0430\u0435\u0442 \u0440\u0430\u0431\u043e\u0447\u0443\u044e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e  <code>git stash pop</code> \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u0437 \u0441\u0442\u044d\u0448\u0430 \u043a \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0432\u0435\u0442\u043a\u0435</p>"},{"location":"SCM/#github-api","title":"GitHub-api","text":"<p><code>$user = \"Lifailon\"</code> <code>$repository = \"ReverseProxyNET\"</code> <code>Invoke-RestMethod https://api.github.com/users/$($user)</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435  <code>Invoke-RestMethod https://api.github.com/users/$($user)/repos</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 (\u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043c\u043c\u0438\u0442\u044b) 30 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0435\u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Invoke-RestMethod https://api.github.com/users/$($user)/repos?per_page=100</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 (\u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043c\u043c\u0438\u0442\u044b) 100 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0435\u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Invoke-RestMethod https://api.github.com/repos/$($user)/$($repository)/contents</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f  <code>Invoke-RestMethod https://api.github.com/repos/$($user)/$($repository)/contents/source/rpnet.cs</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0444\u0430\u0439\u043b\u0430 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 Base64  <code>$commits = Invoke-RestMethod https://api.github.com/repos/$($user)/$($repository)/commits</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432  <code>$commits[0].commit.message</code> \u0447\u0438\u0442\u0430\u0435\u043c \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043a\u043e\u043c\u043c\u0438\u0442\u0430  <code>$commits[0].commit.committer.date</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0434\u0430\u0442\u0443 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043a\u043e\u043c\u043c\u0438\u0442\u0430  <code>Invoke-RestMethod https://api.github.com/repos/$($user)/$($repository)/commits/$($commits[0].sha)</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c \u043a\u043e\u043c\u043c\u0438\u0442\u0435 \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438  <code>$releases_latest = Invoke-RestMethod \"https://api.github.com/repos/$($user)/$($repository)/releases/latest\"</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c \u0440\u0435\u043b\u0438\u0437\u0435 \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438  <code>$releases_latest.assets.name</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0440\u0435\u043b\u0438\u0437\u0430  <code>$releases_latest.assets.browser_download_url</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a url \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0444\u0430\u0439\u043b\u043e\u0432  <code>$($releases_latest.assets | Where-Object name -like \"*win*x64*exe*\").browser_download_url</code> \u0444\u0438\u043b\u044c\u0442\u0440\u0443\u0435\u043c \u043f\u043e \u041e\u0421 \u0438 \u0440\u0430\u0437\u0440\u044f\u0434\u043d\u043e\u0441\u0442\u0438  <code>$(Invoke-RestMethod -Uri \"https://api.github.com/repos/Lifailon/epic-games-radar/commits?path=api/giveaway/index.json\")[0].commit.author.date</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0434\u0430\u0442\u0443 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u0430 \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438  <code>$issues = Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/issues?per_page=500</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0445 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438 (\u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 100 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445, \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0437\u0430\u0431\u0438\u0440\u0430\u0435\u043c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 30 issues)  <code>$issue_number = $($issues | Where-Object title -match \"PowerShell\").number</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u043d\u043e\u043c\u0435\u0440 issue, \u0432 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0435 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0435\u0441\u0442\u044c \u0441\u043b\u043e\u0432\u043e \"PowerShell\"  <code>Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/issues/$($issue_number)/comments</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0435\u043c \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e issues  <code>Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/languages</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u044f\u0437\u044b\u043a\u043e\u0432 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438  <code>Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/pulls</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 pull requests \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438  <code>Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/forks</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u043e\u0440\u043a\u043e\u0432 (forks)  <code>Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/stargazers?per_page=4000</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u0441\u0442\u0430\u0432\u0438\u043b\u0438 \u0437\u0432\u0435\u0437\u0434\u044b \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044e  <code>Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/subscribers</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u0434\u043f\u0438\u0441\u0447\u0438\u043a\u043e\u0432 (watchers) \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f</p>"},{"location":"SCM/#atlassian","title":"Atlassian","text":""},{"location":"SCM/#bitbucket","title":"Bitbucket","text":"<pre><code>$url = \"https://github.com/AtlassianPS/BitbucketPS/archive/refs/heads/master.zip\"\nInvoke-RestMethod $url -OutFile $home\\Downloads\\BitbucketPS.zip\nExpand-Archive -Path \"$home\\Downloads\\BitbucketPS.zip\" -OutputPath \"$home\\Downloads\"\nCopy-Item -Path \"$home\\Downloads\\BitbucketPS-master\\*\" -Destination \"$($env:PSModulePath.Split(\";\")[0])\\PSBitBucket\" -Recurse\nRemove-Item \"$home\\Downloads\\Bitbucket*\" -Recurse -Force\n</code></pre> <p><code>Import-Module PSBitBucket</code> <code>Get-Command -Module PSBitBucket</code> <code>Set-BitBucketConfigServer -Url $url -User username -Password password</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 BitBucket  <code>Get-BitBucketConfigServer</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 BitBucket  <code>Get-Repositories</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0435\u0432 \u0434\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 BitBucket  <code>Get-ProjectKey</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043a\u043b\u044e\u0447 \u043f\u0440\u043e\u0435\u043a\u0442\u0430 BitBucket  <code>Get-BranchList -Repository pSyslog</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0432\u0435\u0442\u043e\u043a \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438  <code>Get-Branch -Repository pSyslog -Branch main</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0432\u0435\u0442\u043a\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f  <code>Get-CommitMessage -Repository pSyslog -CommitHash $hash</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043a\u043e\u043c\u043c\u0438\u0442\u0430 \u043f\u043e \u0435\u0433\u043e \u0445\u044d\u0448\u0443  <code>Get-Commits -Repository pSyslog -Limit 10</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 10 \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432 \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438  <code>Get-CommitsForBranch -Repository pSyslog -Branch main</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u043c\u0438\u0442\u043e\u0432 \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0432\u0435\u0442\u043a\u0438 \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438</p>"},{"location":"SCM/#jira","title":"Jira","text":"<p><code>Install-Module JiraPS -Scope CurrentUser -Repository PSGallery -AllowClobber -Force</code> <code>Get-Command -Module JiraPS</code> <code>Get-JiraServerInfo</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0435  <code>Add-JiraFilterPermission</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430  <code>Add-JiraGroupMember</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430 \u0432 \u0433\u0440\u0443\u043f\u043f\u0443  <code>Add-JiraIssueAttachment</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043a \u0437\u0430\u0434\u0430\u0447\u0435  <code>Add-JiraIssueComment</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f \u043a \u0437\u0430\u0434\u0430\u0447\u0435  <code>Add-JiraIssueLink</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443  <code>Add-JiraIssueWatcher</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u0430\u0431\u043b\u044e\u0434\u0430\u0442\u0435\u043b\u044f \u043a \u0437\u0430\u0434\u0430\u0447\u0435  <code>Add-JiraIssueWorklog</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0447\u0435\u0433\u043e \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u043a \u0437\u0430\u0434\u0430\u0447\u0435  <code>Find-JiraFilter</code> \u043f\u043e\u0438\u0441\u043a \u0444\u0438\u043b\u044c\u0442\u0440\u0430  <code>Format-Jira</code> \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 Jira  <code>Get-JiraComponent</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430  <code>Get-JiraConfigServer</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 Jira  <code>Get-JiraField</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044f Jira  <code>Get-JiraFilter</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u0430  <code>Get-JiraFilterPermission</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430  <code>Get-JiraGroup</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b  <code>Get-JiraGroupMember</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u0433\u0440\u0443\u043f\u043f\u044b  <code>Get-JiraIssue</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438  <code>Get-JiraIssueAttachment</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438  <code>Get-JiraIssueAttachmentFile</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u0430 \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438  <code>Get-JiraIssueComment</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438  <code>Get-JiraIssueCreateMetadata</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438  <code>Get-JiraIssueEditMetadata</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438  <code>Get-JiraIssueLink</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 \u0437\u0430\u0434\u0430\u0447\u0438  <code>Get-JiraIssueLinkType</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0442\u0438\u043f\u0430 \u0441\u0441\u044b\u043b\u043a\u0438 \u0437\u0430\u0434\u0430\u0447\u0438  <code>Get-JiraIssueType</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0442\u0438\u043f\u0430 \u0437\u0430\u0434\u0430\u0447\u0438  <code>Get-JiraIssueWatcher</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043d\u0430\u0431\u043b\u044e\u0434\u0430\u0442\u0435\u043b\u044f \u0437\u0430\u0434\u0430\u0447\u0438  <code>Get-JiraIssueWorklog</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0440\u0430\u0431\u043e\u0447\u0435\u0433\u043e \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0437\u0430\u0434\u0430\u0447\u0438  <code>Get-JiraPriority</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u0430 \u0437\u0430\u0434\u0430\u0447\u0438  <code>Get-JiraProject</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430  <code>Get-JiraRemoteLink</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0438  <code>Get-JiraServerInformation</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0435 Jira  <code>Get-JiraSession</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u0438  <code>Get-JiraUser</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Get-JiraVersion</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u0435\u0440\u0441\u0438\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u0430  <code>Invoke-JiraIssueTransition</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u0437\u0430\u0434\u0430\u0447\u0438  <code>Invoke-JiraMethod</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u0430 Jira  <code>Move-JiraVersion</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u0432\u0435\u0440\u0441\u0438\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u0430  <code>New-JiraFilter</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u0444\u0438\u043b\u044c\u0442\u0440\u0430  <code>New-JiraGroup</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b  <code>New-JiraIssue</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438  <code>New-JiraSession</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0439 \u0441\u0435\u0441\u0441\u0438\u0438  <code>New-JiraUser</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>New-JiraVersion</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u0430  <code>Remove-JiraFilter</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u0430  <code>Remove-JiraFilterPermission</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430  <code>Remove-JiraGroup</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b  <code>Remove-JiraGroupMember</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430 \u0433\u0440\u0443\u043f\u043f\u044b  <code>Remove-JiraIssue</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438  <code>Remove-JiraIssueAttachment</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438  <code>Remove-JiraIssueLink</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 \u0437\u0430\u0434\u0430\u0447\u0438  <code>Remove-JiraIssueWatcher</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043d\u0430\u0431\u043b\u044e\u0434\u0430\u0442\u0435\u043b\u044f \u0437\u0430\u0434\u0430\u0447\u0438  <code>Remove-JiraRemoteLink</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0438  <code>Remove-JiraSession</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u0438  <code>Remove-JiraUser</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Remove-JiraVersion</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0432\u0435\u0440\u0441\u0438\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u0430  <code>Set-JiraConfigServer</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 Jira  <code>Set-JiraFilter</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u0430  <code>Set-JiraIssue</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0437\u0430\u0434\u0430\u0447\u0438  <code>Set-JiraIssueLabel</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043c\u0435\u0442\u043a\u0438 \u0437\u0430\u0434\u0430\u0447\u0438  <code>Set-JiraUser</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Set-JiraVersion</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0432\u0435\u0440\u0441\u0438\u0438 \u043f\u0440\u043e\u0435\u043a\u0442\u0430</p>"},{"location":"SCM/#confluence","title":"Confluence","text":"<p><code>Install-Module ConfluencePS -Scope CurrentUser -Repository PSGallery -AllowClobber -Force</code> <code>Get-Command -Module ConfluencePS</code> <code>Add-ConfluenceAttachment</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043a \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435  <code>Add-ConfluenceLabel</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0442\u043a\u0438 \u043a \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435  <code>ConvertTo-ConfluenceStorageFormat</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0432 \u0444\u043e\u0440\u043c\u0430\u0442 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f Confluence  <code>ConvertTo-ConfluenceTable</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0443 Confluence  <code>Get-ConfluenceAttachment</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b  <code>Get-ConfluenceAttachmentFile</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u0430 \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b  <code>Get-ConfluenceChildPage</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0445 \u0441\u0442\u0440\u0430\u043d\u0438\u0446  <code>Get-ConfluenceLabel</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043c\u0435\u0442\u043e\u043a \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b  <code>Get-ConfluencePage</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435  <code>Get-ConfluenceSpace</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0435  <code>Invoke-ConfluenceMethod</code> \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u0430 Confluence  <code>New-ConfluencePage</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b  <code>New-ConfluenceSpace</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0430  <code>Remove-ConfluenceAttachment</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b  <code>Remove-ConfluenceLabel</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043c\u0435\u0442\u043a\u0438 \u0441\u043e \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b  <code>Remove-ConfluencePage</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b  <code>Remove-ConfluenceSpace</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0430  <code>Set-ConfluenceAttachment</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b  <code>Set-ConfluenceInfo</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435  <code>Set-ConfluenceLabel</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043c\u0435\u0442\u043a\u0438 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b  <code>Set-ConfluencePage</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b</p>"},{"location":"ServerManager/","title":"Server Manager","text":""},{"location":"ServerManager/#module","title":"Module","text":"<p><code>Get-Command *WindowsFeature*</code> source module ServerManager  <code>Get-WindowsFeature -ComputerName \"localhost\"</code> <code>Get-WindowsFeature | where Installed -eq $True</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0440\u043e\u043b\u0435\u0439 \u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432  <code>Get-WindowsFeature | where FeatureType -eq \"Role\"</code> \u043e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0441\u043f\u0438\u0441\u043a\u0443 \u0440\u043e\u043b\u0435\u0439  <code>Install-WindowsFeature -Name DNS</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u043e\u043b\u044c  <code>Get-Command *DNS*</code> <code>Get-DnsServerSetting -ALL</code> <code>Uninstall-WindowsFeature -Name DNS</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0440\u043e\u043b\u044c</p>"},{"location":"ServerManager/#pswa","title":"PSWA","text":"<p><code>Install-WindowsFeature -Name WindowsPowerShellWebAccess -IncludeManagementTools</code> <code>Install-PswaWebApplication -UseTestCertificate</code> \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0435\u0431-\u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 /pswa  <code>Add-PswaAuthorizationRule -UserGroupName \"$domain\\Domain Admins\" -ComputerName * -ConfigurationName * -RuleName \"For Admins\"</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438</p>"},{"location":"ServerManager/#wsb-windows-server-backup","title":"WSB (Windows Server Backup)","text":"<p>\u041f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 backup DC \u0447\u0435\u0440\u0435\u0437 WSB, \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u043a\u043e\u043f\u0438\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b (System State), \u043a\u0443\u0434\u0430 \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0431\u0430\u0437\u0430 AD (NTDS.DIT), \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u044b\u0445 \u043f\u043e\u043b\u0438\u0442\u0438\u043a, \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 SYSVOL, \u0440\u0435\u0435\u0441\u0442\u0440, \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 IIS, \u0431\u0430\u0437\u0430 AD CS, \u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u044b. \u0420\u0435\u0437\u0435\u0440\u0432\u043d\u0430\u044f \u043a\u043e\u043f\u0438\u044f \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u0441\u043b\u0443\u0436\u0431\u0443 \u0442\u0435\u043d\u0435\u0432\u043e\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f VSS.  <code>Get-WindowsFeature Windows-Server-Backup</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u043b\u0438 \u0440\u043e\u043b\u044c  <code>Add-Windowsfeature Windows-Server-Backup \u2013Includeallsubfeature</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u043e\u043b\u044c</p> <pre><code>$path=\"\\\\$srv\\bak-dc\\dc-03\\\"\n[string]$TargetUNC=$path+(get-date -f 'yyyy-MM-dd')\nif ((Test-Path -Path $path) -eq $true) {New-Item -Path $TargetUNC -ItemType directory} # \u0435\u0441\u043b\u0438 \u043f\u0443\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d, \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u043f\u043e \u0434\u0430\u0442\u0435\n$WBadmin_cmd = \"wbadmin.exe START BACKUP -backupTarget:$TargetUNC -systemState -noverify -vssCopy -quiet\"\n# $WBadmin_cmd = \"wbadmin start backup -backuptarget:$path -include:C:\\Windows\\NTDS\\ntds.dit -quiet\" # Backup DB NTDS\nInvoke-Expression $WBadmin_cmd\n</code></pre>"},{"location":"ServerManager/#rds","title":"RDS","text":"<p><code>Get-Command -Module RemoteDesktop</code> <code>Get-RDServer -ConnectionBroker $broker</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0432 \u0444\u0435\u0440\u043c\u0435\u044b, \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u043b\u043d\u043e\u0435 \u0434\u043e\u043c\u0435\u043d\u043d\u043e\u0435 \u0438\u043c\u044f \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0435 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u0441 \u0440\u043e\u043b\u044c\u044e RDCB  <code>Get-RDRemoteDesktop -ConnectionBroker $broker</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u0439  <code>(Get-RDLicenseConfiguration -ConnectionBroker $broker | select *).LicenseServer</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0441 \u0440\u043e\u043b\u044c\u044e RDL  <code>Get-RDUserSession -ConnectionBroker $broker</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439  <code>Disconnect-RDUser -HostServer $srv -UnifiedSessionID $id -Force</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u0435\u0441\u0441\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Get-RDAvailableApp -ConnectionBroker $broker -CollectionName C03</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u041f\u041e \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445 \u0432 \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u0438  <code>(Get-RDSessionCollectionConfiguration -ConnectionBroker $broker -CollectionName C03 | select *).CustomRdpProperty</code> use redirection server name:i:1  <code>Get-RDConnectionBrokerHighAvailability</code></p>"},{"location":"ServerManager/#dnsserver","title":"DNSServer","text":"<p><code>Get-Command -Module DnsServer</code> <code>Show-DnsServerCache</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0435\u0441\u044c \u043a\u044d\u0448 DNS-\u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>Show-DnsServerCache | where HostName -match ru</code> <code>Clear-DnsServerCache</code> <code>Get-DnsServerCache</code> <code>Get-DnsServerDiagnostics</code></p> <pre><code>$zone = icm $srv {Get-DnsServerZone} | select ZoneName,ZoneType,DynamicUpdate,ReplicationScope,SecureSecondaries,\nDirectoryPartitionName | Out-GridView -Title \"DNS Server: $srv\" \u2013PassThru\n$zone_name = $zone.ZoneName\nif ($zone_name -ne $null) {\n    icm $srv {\n        Get-DnsServerResourceRecord -ZoneName $using:zone_name | sort RecordType | select RecordType,HostName, @{\n        Label=\"IPAddress\"; Expression={$_.RecordData.IPv4Address.IPAddressToString}},TimeToLive,Timestamp\n    } | select RecordType,HostName,IPAddress,TimeToLive,Timestamp | Out-GridView -Title \"DNS Server: $srv\"\n}\n</code></pre> <p><code>Sync-DnsServerZone \u2013passthru</code> \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u043e\u043d\u044b \u0441 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 DC \u0432 \u0434\u043e\u043c\u0435\u043d\u0435  <code>Remove-DnsServerZone -Name domain.local</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u043e\u043d\u0443  <code>Get-DnsServerResourceRecord -ZoneName domain.local -RRType A</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0435 \u0410-\u0437\u0430\u043f\u0438\u0441\u0438 \u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0437\u043e\u043d\u0435  <code>Add-DnsServerResourceRecordA -Name new-host-name -IPv4Address 192.168.1.100 -ZoneName domain.local -TimeToLive 01:00:00 -CreatePtr</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0410-\u0437\u0430\u043f\u0438\u0441\u044c \u0438 PTR \u0434\u043b\u044f \u043d\u0435\u0435  <code>Remove-DnsServerResourceRecord -ZoneName domain.local -RRType A -Name new-host-name \u2013Force</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0410-\u0437\u0430\u043f\u0438\u0441\u044c</p> <pre><code>$DNSServer = \"DC-01\"\n$DNSFZone = \"domain.com\"\n$DataFile = \"C:\\Scripts\\DNS-Create-A-Records-from-File.csv\"\n# cat $DataFile\n# \"HostName;IP\"\n# \"server-01;192.168.1.10\"\n$DNSRR = [WmiClass]\"\\\\$DNSServer\\root\\MicrosoftDNS:MicrosoftDNS_ResourceRecord\"\n$ConvFile = $DataFile + \"_unicode\"\nGet-Content $DataFile | Set-Content $ConvFile -Encoding Unicode\nImport-CSV $ConvFile -Delimiter \";\" | ForEach-Object {\n    $FQDN = $_.HostName + \".\" + $DNSFZone\n    $IP = $_.HostIP\n    $TextA = \"$FQDN IN A $IP\"\n    [Void]$DNSRR.CreateInstanceFromTextRepresentation($DNSServer,$DNSFZone,$TextA)\n}\n</code></pre>"},{"location":"ServerManager/#dhcpserver","title":"DHCPServer","text":"<p><code>Get-Command -Module DhcpServer</code></p> <pre><code>$mac = icm $srv -ScriptBlock {Get-DhcpServerv4Scope | Get-DhcpServerv4Lease} | select AddressState,\nHostName,IPAddress,ClientId,DnsRegistration,DnsRR,ScopeId,ServerIP | Out-GridView -Title \"HDCP Server: $srv\" \u2013PassThru\n(New-Object -ComObject Wscript.Shell).Popup($mac.ClientId,0,$mac.HostName,64)\n</code></pre> <p><code>Add-DhcpServerv4Reservation -ScopeId 192.168.1.0 -IPAddress 192.168.1.10 -ClientId 00-50-56-C0-00-08 -Description \"new reservation\"</code></p>"},{"location":"ServerManager/#dfs","title":"DFS","text":"<p><code>dfsutil /root:\\\\domain.sys\\public /export:C:\\export-dfs.txt</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 namespace root  <code>dfsutil /AddFtRoot /Server:\\\\$srv /Share:public</code> \u043d\u0430 \u043d\u043e\u0432\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u0440\u0435\u043d\u044c \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0434\u043e\u043c\u0435\u043d\u0430  <code>dfsutil /root:\\\\domain.sys\\public /import:C:\\export-dfs.txt /&lt;verify /set</code> Import (\u043f\u0435\u0440\u0435\u0434 \u0438\u043c\u043f\u043e\u0440\u0442\u043e\u043c \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u043a\u043e\u0440\u0435\u043d\u044c DFS, \u0443\u0442\u0438\u043b\u0438\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u043a\u043e\u0440\u043d\u044f \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u043c \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435, \u0438\u0437 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0443\u0442\u0438\u043b\u0438\u0442\u0430 dfsutil)  <code>/verify</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0432\u043d\u0435\u0441\u0435\u043d\u044b \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u0438\u043c\u043f\u043e\u0440\u0442\u0430, \u0431\u0435\u0437 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f  <code>/set</code> \u043c\u0435\u043d\u044f\u0435\u0442 \u0446\u0435\u043b\u0435\u0432\u043e\u0435 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e \u0438\u043c\u0435\u043d \u043f\u0443\u0442\u0435\u043c \u043f\u043e\u043b\u043d\u043e\u0439 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u0438 \u0438 \u0437\u0430\u043c\u0435\u043d\u044b \u043d\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0430 \u0438\u043c\u0435\u043d \u0438\u0437 \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u043c\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430  <code>/merge</code> \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u0442 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0430 \u0438\u043c\u0435\u043d \u0432 \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043a \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u0441\u043b\u0438\u044f\u043d\u0438\u044f, \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0438\u0437 \u0444\u0430\u0439\u043b\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0431\u0443\u0434\u0443\u0442 \u0438\u043c\u0435\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0438\u0439 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442, \u0447\u0435\u043c \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0430 \u0438\u043c\u0435\u043d</p> <p><code>Export-DfsrClone</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u0442 \u043a\u043b\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u0443\u044e \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 DFS \u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0442\u043e\u043c\u0430  <code>Get-DfsrCloneState</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u043a\u043b\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445  <code>Import-DfsrClone</code> \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u0442 \u043a\u043b\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u0443\u044e \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 DFS \u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0442\u043e\u043c\u0430</p> <p><code>net use x: \\\\$srv1\\public\\*</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0438\u0441\u043a  <code>Get-DfsrFileHash x:\\* | Out-File C:\\$srv1.txt</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c hash \u0432\u0441\u0435\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u0434\u0438\u0441\u043a\u0430 \u0432 \u0444\u0430\u0439\u043b (\u0444\u0430\u0439\u043b\u044b \u0441 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u043c\u0438 \u0445\u0435\u0448\u0430\u043c\u0438 \u0432\u0441\u0435\u0433\u0434\u0430 \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0442\u043e\u0447\u043d\u044b\u043c\u0438 \u043a\u043e\u043f\u0438\u044f\u043c\u0438 \u0434\u0440\u0443\u0433 \u0434\u0440\u0443\u0433\u0430)  <code>net use x: /d</code> \u043e\u0442\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c  <code>net use x: \\\\$srv2\\public\\*</code> <code>Get-DfsrFileHash x:\\* | Out-File C:\\$srv2.txt</code> <code>net use x: /d</code> <code>Compare-Object -ReferenceObject (Get-Content C:\\$srv1.txt) -DifferenceObject (Get-Content C:\\$srv2.txt) -IncludeEqual</code> \u0441\u0440\u0430\u0432\u043d\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0444\u0430\u0439\u043b\u043e\u0432</p> <p><code>Get-DfsrBacklog -DestinationComputerName \"fs-06\" -SourceComputerName \"fs-05\" -GroupName \"folder-rep\" -FolderName \"folder\" -Verbose</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u043e\u0436\u0438\u0434\u0430\u044e\u0449\u0438\u0445 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u0444\u0430\u0439\u043b\u043e\u0432 \u043c\u0435\u0436\u0434\u0443 \u0434\u0432\u0443\u043c\u044f \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u0430\u043c\u0438 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 DFS  <code>Get-DfsrConnection</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438, \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u0438 \u0441\u0442\u0430\u0442\u0443\u0441  <code>Get-DfsReplicatedFolder</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0438\u043c\u044f \u0438 \u043f\u043e\u043b\u043d\u044b\u0439 \u043f\u0443\u0442\u044c \u043a \u043f\u0430\u043f\u043a\u0430\u043c \u0440\u0435\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 DFS  <code>Get-DfsrState -ComputerName fs-06 -Verbose</code> \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 DFS \u0434\u043b\u044f \u0447\u043b\u0435\u043d\u0430 \u0433\u0440\u0443\u043f\u043f\u044b  <code>Get-DfsReplicationGroup</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0438 \u0438\u0445 \u0441\u0442\u0430\u0442\u0443\u0441  <code>Add-DfsrConnection</code> \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u043c\u0435\u0436\u0434\u0443 \u0447\u043b\u0435\u043d\u0430\u043c\u0438 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Add-DfsrMember</code> \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u044b \u0432 \u0433\u0440\u0443\u043f\u043f\u0443 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>ConvertFrom-DfsrGuid</code> \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u0442 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u044b GUID \u0432 \u043f\u043e\u043d\u044f\u0442\u043d\u044b\u0435 \u0438\u043c\u0435\u043d\u0430 \u0432 \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Get-DfsrConnectionSchedule</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0447\u043b\u0435\u043d\u0430\u043c\u0438 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Get-DfsrGroupSchedule</code> \u0438\u0437\u0432\u043b\u0435\u043a\u0430\u0435\u0442 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Get-DfsrIdRecord</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0437\u0430\u043f\u0438\u0441\u0438 ID \u0434\u043b\u044f \u0440\u0435\u043f\u043b\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u0438\u043b\u0438 \u043f\u0430\u043f\u043e\u043a \u0438\u0437 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 DFS  <code>Get-DfsrMember</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u044b \u0432 \u0433\u0440\u0443\u043f\u043f\u0435 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Get-DfsrMembership</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0447\u043b\u0435\u043d\u0441\u0442\u0432\u0430 \u0434\u043b\u044f \u0447\u043b\u0435\u043d\u043e\u0432 \u0433\u0440\u0443\u043f\u043f \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Get-DfsrPreservedFiles</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u0430\u0439\u043b\u043e\u0432 \u0438 \u043f\u0430\u043f\u043e\u043a, \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0445 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0435\u0439 DFS  <code>Get-DfsrServiceConfiguration</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0441\u043b\u0443\u0436\u0431\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 DFS \u0434\u043b\u044f \u0447\u043b\u0435\u043d\u043e\u0432 \u0433\u0440\u0443\u043f\u043f\u044b  <code>Grant-DfsrDelegation</code> \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430\u043c \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0434\u043b\u044f \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Revoke-DfsrDelegation</code> \u043e\u0442\u043c\u0435\u043d\u044f\u0435\u0442 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0434\u043b\u044f \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>New-DfsReplicationGroup</code> \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0433\u0440\u0443\u043f\u043f\u0443 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>New-DfsReplicatedFolder</code> \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0440\u0435\u043f\u043b\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u0443\u044e \u043f\u0430\u043f\u043a\u0443 \u0432 \u0433\u0440\u0443\u043f\u043f\u0435 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Remove-DfsrConnection</code> \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u043c\u0435\u0436\u0434\u0443 \u0447\u043b\u0435\u043d\u0430\u043c\u0438 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Remove-DfsReplicatedFolder</code> \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0440\u0435\u043f\u043b\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u0443\u044e \u043f\u0430\u043f\u043a\u0443 \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Remove-DfsReplicationGroup</code> \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0433\u0440\u0443\u043f\u043f\u0443 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Remove-DfsrMember</code> \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u044b \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Restore-DfsrPreservedFiles</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u0444\u0430\u0439\u043b\u044b \u0438 \u043f\u0430\u043f\u043a\u0438, \u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0435\u0439 DFS  <code>Set-DfsrConnection</code> \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0447\u043b\u0435\u043d\u0430\u043c\u0438 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Set-DfsrConnectionSchedule</code> \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u0447\u043b\u0435\u043d\u0430\u043c\u0438 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Set-DfsReplicatedFolder</code> \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0440\u0435\u043f\u043b\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u043f\u0430\u043f\u043a\u0438  <code>Set-DfsReplicationGroup</code> \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442 \u0433\u0440\u0443\u043f\u043f\u0443 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Set-DfsrGroupSchedule</code> \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Set-DfsrMember</code> \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0435-\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0435 \u0432 \u0433\u0440\u0443\u043f\u043f\u0435 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Set-DfsrMembership</code> \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0447\u043b\u0435\u043d\u0441\u0442\u0432\u0430 \u0434\u043b\u044f \u0447\u043b\u0435\u043d\u043e\u0432 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Set-DfsrServiceConfiguration</code> \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0441\u043b\u0443\u0436\u0431\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 DFS  <code>Sync-DfsReplicationGroup</code> \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u044e \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430\u043c\u0438 \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e \u043e\u0442 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f  <code>Suspend-DfsReplicationGroup</code> \u043f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u044e \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430\u043c\u0438 \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e \u043e\u0442 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f  <code>Update-DfsrConfigurationFromAD</code> \u0438\u043d\u0438\u0446\u0438\u0438\u0440\u0443\u0435\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043b\u0443\u0436\u0431\u044b \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 DFS  <code>Write-DfsrHealthReport</code> \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043e\u0442\u0447\u0435\u0442 \u043e \u0440\u0430\u0431\u043e\u0442\u043e\u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 DFS  <code>Write-DfsrPropagationReport</code> \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043e\u0442\u0447\u0435\u0442\u044b \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u0440\u0430\u0441\u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0432 \u0433\u0440\u0443\u043f\u043f\u0435 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>Start-DfsrPropagationTest</code> \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0439 \u0444\u0430\u0439\u043b \u0440\u0430\u0441\u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0432 \u0440\u0435\u043f\u043b\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u043f\u0430\u043f\u043a\u0435</p>"},{"location":"ServerManager/#storagereplica","title":"StorageReplica","text":"<p><code>Install-WindowsFeature Storage-Replica \u2013IncludeManagementTools -Restart</code> <code>Get-Command -Module StorageReplica</code> <code>Test-SRTopology</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u043b\u0438 \u0441\u0435\u0440\u0432\u0435\u0440 \u0438 \u043a\u0430\u043d\u0430\u043b \u0441\u0432\u044f\u0437\u0438 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438 Storage Replica  <code>New-SRPartnership -SourceComputerName srv-01 -SourceRGName srv-01-rep-group-01 -SourceVolumeName D: -SourceLogVolumeName L: -DestinationComputerName srv-02 -DestinationRGName srv-02-rep-group-01 -DestinationVolumeName D: -DestinationLogVolumeName L: -LogSizeInBytes 1GB</code> <code>Get-Counter -Counter \"\\Storage Replica Statistics(*)\"</code> <code>Get-WinEvent -ProviderName Microsoft-Windows-StorageReplica -max 10</code> <code>Set-SRPartnership -ReplicationMode Asynchronous</code> \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0440\u0435\u0436\u0438\u043c \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u043d\u0430 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439  <code>Set-SRPartnership -NewSourceComputerName srv-02 -SourceRGName srv-02-rep-group-01 -DestinationComputerName srv-01 -DestinationRGName srv-01-rep-group-01</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445, \u043f\u0435\u0440\u0435\u0432\u0435\u0434\u044f \u0432\u0442\u043e\u0440\u0438\u0447\u043d\u0443\u044e \u043a\u043e\u043f\u0438\u044e \u0432 \u043e\u043d\u043b\u0430\u0439\u043d \u0440\u0435\u0436\u0438\u043c (\u043f\u0440\u0438 \u0432\u044b\u0445\u043e\u0434\u0435 \u0438\u0437 \u0441\u0442\u0440\u043e\u044f \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430)  <code>Get-SRGroup</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b \u0440\u0435\u043f\u043b\u0438\u0437\u0430\u0446\u0438\u0438  <code>Get-SRPartnerShip</code> \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438  <code>(Get-SRGroup).Replicas | Select-Object numofbytesremaining</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0434\u043b\u0438\u043d\u0443 \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f  <code>Get-SRPartnership | Remove-SRPartnership</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0440\u0435\u043f\u043b\u0438\u0437\u0430\u0446\u0438\u044e \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0435  <code>Get-SRGroup | Remove-SRGroup</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0440\u0435\u043f\u043b\u0438\u0437\u0430\u0446\u0438\u044e \u043d\u0430 \u043e\u0431\u043e\u0438\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445</p>"},{"location":"ServerManager/#wsus","title":"WSUS","text":"<p><code>Get-Hotfix | Sort-Object -Descending  InstalledOn</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 (\u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0438\u0437 cimv2)  <code>Get-Hotfix -Description \"Security update\"</code> <code>Get-CimInstance Win32_QuickFixEngineering</code> <code>Get-Service uhssvc</code> \u0441\u043b\u0443\u0436\u0431\u0430 Microsoft Health Update Tools, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439</p>"},{"location":"ServerManager/#windowsupdate","title":"WindowsUpdate","text":"<p><code>Get-Command -Module WindowsUpdate</code> <code>Get-WindowsUpdateLog</code> \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442 \u043e\u0442\u0447\u0435\u0442 \u0432 $home\\AppData\\Local\\Temp\\WindowsUpdateLog \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 csv</p>"},{"location":"ServerManager/#pswindowsupdate","title":"PSWindowsUpdate","text":"<p><code>Install-Module -Name PSWindowsUpdate -Scope CurrentUser</code> <code>Import-Module PSWindowsUpdate</code> <code>Get-Command -Module PSWindowsUpdate</code> <code>Get-WindowsUpdate</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 WSUS \u0438\u043b\u0438 Microsoft Update  <code>Get-WindowsUpdate -Download</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f  <code>Get-WindowsUpdate \u2013Install</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0441\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f  <code>Install-WindowsUpdate -MicrosoftUpdate -AcceptAll -IgnoreReboot</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0441\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438  <code>Get-WindowsUpdate -KBArticleID KB2267602, KB4533002 -Install</code> <code>Get-WindowsUpdate -KBArticleID KB2538243 -Hide</code> \u0441\u043a\u0440\u044b\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f, \u0447\u0442\u043e \u0431\u044b \u043e\u043d\u0438 \u043d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u043b\u0438\u0441\u044c  <code>Get-WindowsUpdate \u2013IsHidden</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043a\u0440\u044b\u0442\u044b\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f (Hide-WindowsUpdate)  <code>Remove-WindowsUpdate -KBArticleID KB4011634 -NoRestart</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435  <code>Uninstall-WindowsUpdate</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435  <code>Add-WUServiceManager</code> \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f (Windows Update Service Manager)  <code>Enable-WURemoting</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u0430 Windows Defender, \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u044e\u0449\u0438\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u043b\u0435\u0442\u0430 PSWindowsUpdate  <code>Get-WUApiVersion</code> \u0432\u0435\u0440\u0441\u0438\u044f Windows Update Agent  <code>Get-WUHistory</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 (\u0438\u0441\u0442\u043e\u0440\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439)  <code>Get-WUHistory | Where-Object {$_.Title -match \"KB4517389\"}</code> \u043f\u043e\u0438\u0441\u043a \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f  <code>Get-WULastResults</code> \u0434\u0430\u0442\u044b \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430 \u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-WURebootStatus</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u043d\u0443\u0436\u043d\u0430 \u043b\u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u043b\u044f \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f  <code>Get-WUServiceManager</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-WUInstallerStatus</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0441\u043b\u0443\u0436\u0431\u044b Windows Installer  <code>Remove-WUServiceManager</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c Windows Update Service Manager</p>"},{"location":"ServerManager/#updateservices","title":"UpdateServices","text":"<p><code>Install-WindowsFeature -Name UpdateServices-RSAT</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u043e\u043b\u044c UpdateServices  <code>$UpdateScope = New-Object Microsoft.UpdateServices.Administration.UpdateScope</code> <code>[enum]::GetValues([Microsoft.UpdateServices.Administration.ApprovedStates])</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u044b\u0445 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0439  <code>[enum]::GetValues([Microsoft.UpdateServices.Administration.UpdateInstallationStates])</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 (\u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439, \u043d\u0435\u043f\u0440\u0438\u0433\u043e\u0434\u043d\u044b\u0439, \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d, \u0441\u043a\u0430\u0447\u0435\u043d\u043e, \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d, \u043d\u0435\u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0439, \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u0438 \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438, \u0432\u0441\u0435)  <code>$UpdateScope.ApprovedStates = [Microsoft.UpdateServices.Administration.ApprovedStates]\"NotApproved\"</code> \u0432\u044b\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c \u0441\u0442\u0430\u0442\u0443\u0441 \u043d\u0435 \u0443\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u044b\u0445 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 WSUS  <code>$UpdateScope.IncludedInstallationStates = [Microsoft.UpdateServices.Administration.UpdateInstallationStates]\"NotInstalled\"</code> \u0432\u044b\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c \u0441\u0442\u0430\u0442\u0443\u0441 \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>$UpdateScope.IncludedInstallationStates = [Microsoft.UpdateServices.Administration.UpdateInstallationStates]\"NotInstalled,Downloaded\"</code> \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b, \u043d\u043e \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b</p>"},{"location":"ServerManager/#poshwsus","title":"PoshWSUS","text":"<p><code>Install-Module -Name PoshWSUS</code> <code>Get-Command -Module PoshWSUS</code> \u043d\u0443\u0436\u043d\u044b \u043f\u0440\u0430\u0432\u0430 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430  <code>Add-PSWSUSClientToGroup</code> \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0432 \u0433\u0440\u0443\u043f\u043f\u0443  <code>Approve-PSWSUSUpdate</code> \u0443\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f  <code>Connect-PSWSUSDatabaseServer</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 WSUS  <code>Connect-PSWSUSServer</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 WSUS  <code>Deny-PSWSUSUpdate</code> \u043e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f  <code>Disconnect-PSWSUSServer</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043e\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 WSUS  <code>Export-PSWSUSMetaData</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 WSUS  <code>Get-PoshWSUSSyncUpdateCategories</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438  <code>Get-PoshWSUSSyncUpdateClassifications</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0439 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438  <code>Get-PSWSUSCategory</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 WSUS  <code>Get-PSWSUSChildServer</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u0447\u0435\u0440\u043d\u0435\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 WSUS  <code>Get-PSWSUSClassification</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 WSUS  <code>Get-PSWSUSClient</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0435  <code>Get-PSWSUSClientGroupMembership</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u043e\u0439 \u043f\u0440\u0438\u043d\u0430\u0434\u043b\u0435\u0436\u043d\u043e\u0441\u0442\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0430  <code>Get-PSWSUSClientPerUpdate</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0430\u0445 \u043f\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\u043c  <code>Get-PSWSUSClientsInGroup</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432 \u0432 \u0433\u0440\u0443\u043f\u043f\u0435  <code>Get-PSWSUSCommand</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043a\u043e\u043c\u0430\u043d\u0434\u0430\u0445 WSUS  <code>Get-PSWSUSConfig</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 WSUS  <code>Get-PSWSUSConfigEnabledUpdateLanguages</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u044f\u0437\u044b\u043a\u043e\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-PSWSUSConfigProxyServer</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u043f\u0440\u043e\u043a\u0441\u0438-\u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>Get-PSWSUSConfigSupportedUpdateLanguages</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0445 \u044f\u0437\u044b\u043a\u043e\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-PSWSUSConfigSyncSchedule</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438  <code>Get-PSWSUSConfigSyncUpdateCategories</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438  <code>Get-PSWSUSConfigSyncUpdateClassifications</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0439 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438  <code>Get-PSWSUSConfigUpdateFiles</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0444\u0430\u0439\u043b\u043e\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-PSWSUSConfigUpdateSource</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-PSWSUSConfiguration</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u043d\u043e\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 WSUS  <code>Get-PSWSUSContentDownloadProgress</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043a\u043e\u043d\u0442\u0435\u043d\u0442\u0430  <code>Get-PSWSUSCurrentUserRole</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0440\u043e\u043b\u0438 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Get-PSWSUSDatabaseConfig</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445  <code>Get-PSWSUSDownstreamServer</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u043d\u0438\u0436\u0435\u0441\u0442\u043e\u044f\u0449\u0435\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>Get-PSWSUSEmailConfig</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b  <code>Get-PSWSUSEnabledUpdateLanguages</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u044f\u0437\u044b\u043a\u043e\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-PSWSUSEvent</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 WSUS  <code>Get-PSWSUSGroup</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0433\u0440\u0443\u043f\u043f\u0435  <code>Get-PSWSUSInstallableItem</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e\u0431 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430\u0445  <code>Get-PSWSUSInstallApprovalRule</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u0430\u0432\u0438\u043b \u0443\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438  <code>Get-PSWSUSProxyServer</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u0440\u043e\u043a\u0441\u0438-\u0441\u0435\u0440\u0432\u0435\u0440\u0435  <code>Get-PSWSUSServer</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0435 WSUS  <code>Get-PSWSUSStatus</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 WSUS  <code>Get-PSWSUSSubscription</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0438 WSUS  <code>Get-PSWSUSSupportedUpdateLanguages</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0445 \u044f\u0437\u044b\u043a\u043e\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-PSWSUSSyncEvent</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438  <code>Get-PSWSUSSyncHistory</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u0438 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0439  <code>Get-PSWSUSSyncProgress</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438  <code>Get-PSWSUSSyncSchedule</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438  <code>Get-PSWSUSUpdate</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e\u0431 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438  <code>Get-PSWSUSUpdateApproval</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e\u0431 \u0443\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-PSWSUSUpdateCategory</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-PSWSUSUpdateClassification</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-PSWSUSUpdateFile</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u043e\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-PSWSUSUpdateFiles</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-PSWSUSUpdatePerClient</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e\u0431 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\u0445 \u043f\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0430\u043c  <code>Get-PSWSUSUpdateSource</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Get-PSWSUSUpdateSummary</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u0432\u043e\u0434\u043a\u0438 \u043f\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\u043c  <code>Get-PSWSUSUpdateSummaryPerClient</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u0432\u043e\u0434\u043a\u0438 \u043f\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\u043c \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0430  <code>Get-PSWSUSUpdateSummaryPerGroup</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u0432\u043e\u0434\u043a\u0438 \u043f\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\u043c \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b  <code>Import-PSWSUSMetaData</code> \u0438\u043c\u043f\u043e\u0440\u0442 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 WSUS  <code>New-PSWSUSComputerScope</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u043e\u0445\u0432\u0430\u0442\u0430 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043e\u0432  <code>New-PSWSUSGroup</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b  <code>New-PSWSUSInstallApprovalRule</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0443\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438  <code>New-PSWSUSUpdateScope</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u043e\u0445\u0432\u0430\u0442\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Remove-PSWSUSClient</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430  <code>Remove-PSWSUSClientFromGroup</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b  <code>Remove-PSWSUSGroup</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b  <code>Remove-PSWSUSInstallApprovalRule</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0443\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438  <code>Remove-PSWSUSUpdate</code> \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f  <code>Reset-PSWSUSContent</code> \u0441\u0431\u0440\u043e\u0441 \u043a\u043e\u043d\u0442\u0435\u043d\u0442\u0430 WSUS  <code>Resume-PSWSUSDownload</code> \u0432\u043e\u0437\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438  <code>Resume-PSWSUSUpdateDownload</code> \u0432\u043e\u0437\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Set-PoshWsusClassification</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 WSUS  <code>Set-PoshWSUSProduct</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430 WSUS  <code>Set-PSWSUSConfigEnabledUpdateLanguages</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u044f\u0437\u044b\u043a\u043e\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Set-PSWSUSConfigProduct</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 WSUS  <code>Set-PSWsusConfigProxyServer</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0440\u043e\u043a\u0441\u0438-\u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 WSUS  <code>Set-PSWSUSConfigSyncSchedule</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438  <code>Set-PSWSUSConfigTargetingMode</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0440\u0435\u0436\u0438\u043c\u0430 \u0442\u0430\u0440\u0433\u0435\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f  <code>Set-PSWSUSConfigUpdateClassification</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Set-PSWSUSConfigUpdateFiles</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Set-PSWSUSConfigUpdateSource</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Set-PSWSUSEmailConfig</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b  <code>Set-PSWSUSEnabledUpdateLanguages</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u044f\u0437\u044b\u043a\u043e\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Set-PSWSUSInstallApprovalRule</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0443\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438  <code>Set-PSWSUSProxyServer</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0440\u043e\u043a\u0441\u0438-\u0441\u0435\u0440\u0432\u0435\u0440\u0430  <code>Set-PSWSUSSyncSchedule</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438  <code>Set-PSWSUSTargetingMode</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0440\u0435\u0436\u0438\u043c\u0430 \u0442\u0430\u0440\u0433\u0435\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f  <code>Set-PSWSUSUpdateFiles</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Set-PSWSUSUpdateSource</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Start-PSWSUSCleanup</code> \u0437\u0430\u043f\u0443\u0441\u043a \u043e\u0447\u0438\u0441\u0442\u043a\u0438 WSUS  <code>Start-PSWSUSInstallApprovalRule</code> \u0437\u0430\u043f\u0443\u0441\u043a \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0443\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438  <code>Start-PSWSUSSync</code> \u0437\u0430\u043f\u0443\u0441\u043a \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438  <code>Stop-PSWSUSDownload</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438  <code>Stop-PSWSUSSync</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438  <code>Stop-PSWSUSUpdateDownload</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439  <code>Test-PSWSUSDatabaseServerConnection</code> \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445</p>"},{"location":"Syntax/","title":"Syntax","text":""},{"location":"Syntax/#cheat-sheet","title":"Cheat Sheet","text":""},{"location":"Syntax/#help","title":"Help","text":"<p><code>Get-Verb</code> \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f/\u0433\u043b\u0430\u0433\u043e\u043b\u044b, \u0443\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u043b\u0435\u0442\u0430\u0445  <code>Get-Command *Language*</code> \u043f\u043e\u0438\u0441\u043a \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043f\u043e \u0438\u043c\u0435\u043d\u0438  <code>(Get-Command Get-Language).Module</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043a \u043a\u0430\u043a\u043e\u043c\u0443 \u043c\u043e\u0434\u0443\u043b\u044e \u043f\u0440\u0438\u043d\u0430\u0434\u043b\u0435\u0436\u0438\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u0430  <code>Get-Command Get-Content | fl Module,DLL</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043f\u0440\u0438\u043d\u0430\u0434\u043b\u0435\u0436\u043d\u043e\u0441\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043a \u043c\u043e\u0434\u0443\u043b\u044e \u0438 dll  <code>Get-Command -Module LanguagePackManagement</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u0430\u043d\u0434 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u043c\u043e\u0434\u0443\u043b\u044f  <code>(Get-Module LanguagePackManagement).ExportedCommands.Values</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u0430\u043d\u0434 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u043c\u043e\u0434\u0443\u043b\u044f  <code>Get-Language | Get-Member</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043c\u0435\u0442\u043e\u0434\u043e\u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u044b (\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f), \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0432\u044b\u0432\u043e\u0434\u0430 \u0438 Event (\u0441\u043e\u0431\u044b\u0442\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432: Click)  <code>(Get-Help Get-Service).Aliases</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043f\u0441\u0435\u0432\u0434\u043e\u043d\u0438\u043c\u043e\u043c \u043a\u043e\u043c\u0430\u043d\u0434\u044b  <code>Get-Alias gsv</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0438\u043c\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043f\u043e \u043f\u0441\u0435\u0432\u0434\u043e\u043d\u0438\u043c\u0443  <code>Get-Help Get-Service</code> \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0441  <code>Get-Help Get-Service -Parameter *</code> \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432  <code>Get-Help Get-Service -Online</code> <code>Get-Help Get-Service -ShowWindow</code> \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0432 GUI \u0441 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0435\u0439  <code>Show-Command</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u0430\u043d\u0434 \u0432 GUI  <code>Show-Command Get-Service</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0432 GUI  <code>Invoke-Expression</code> iex \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u0442\u0435\u043a\u0441\u0442 \u0434\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u0438 \u043a\u0430\u043a \u043a\u043e\u043c\u0430\u043d\u0434\u044b  <code>$PSVersionTable</code> \u0442\u0435\u043a\u0443\u0449\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f PowerShell  <code>Set-ExecutionPolicy Unrestricted</code> <code>Get-ExecutionPolicy</code> <code>$Metadata = New-Object System.Management.Automation.CommandMetaData (Get-Command Get-Service)</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043a\u043e\u043c\u0430\u043d\u0434\u043b\u0435\u0442\u0435  <code>[System.Management.Automation.ProxyCommand]::Create($Metadata)</code> \u0438\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u043a\u043e\u0434 \u0444\u0443\u043d\u043a\u0446\u0438\u0438</p>"},{"location":"Syntax/#object","title":"Object","text":""},{"location":"Syntax/#variable","title":"Variable","text":"<p><code>$var = Read-Host \"Enter\"</code> \u0440\u0443\u0447\u043d\u043e\u0439 \u0432\u0432\u043e\u0434  <code>$pass = Read-Host \"Enter Password\" -AsSecureString</code> \u0441\u043a\u0440\u044b\u0432\u0430\u0442\u044c \u043d\u0430\u0431\u043e\u0440  <code>$global:path = \"\\\\path\"</code> \u0437\u0430\u0434\u0430\u0442\u044c \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u0443\u044e \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u0432 \u0444\u0443\u043d\u043a\u0446\u0438\u0438  <code>$using:srv</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0435\u0441\u0441\u0438 \u0432 Invoke-\u0441\u0435\u0441\u0441\u0438\u0438  <code>Get-Variable</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435  <code>ls variable:/</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435  <code>Get-Variable *srv*</code> \u043d\u0430\u0439\u0442\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u043f\u043e \u0438\u043c\u0435\u043d\u0438  <code>Get-Variable -Scope Global</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435  <code>Get-Variable Error</code> \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439  <code>Remove-Variable -Name *</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435  <code>$LASTEXITCODE</code> \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043a\u043e\u0434 \u0432\u044b\u0432\u043e\u0434\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u043e\u0439 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 ping. \u0415\u0441\u043b\u0438 \u043a\u043e\u0434 \u0432\u043e\u0437\u0432\u0440\u0430\u0442\u0430 \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 (True), \u0442\u043e $LastExitCode = 0</p>"},{"location":"Syntax/#env","title":"ENV","text":"<p><code>Get-ChildItem Env:</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f  <code>$env:PSModulePath</code> \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u043c\u043e\u0434\u0443\u043b\u0435\u0439  <code>$env:userprofile</code> <code>$env:computername</code> <code>$env:username</code> <code>$env:userdnsdomain</code> <code>$env:logonserver</code> <code>([DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()).Name</code> <code>[Environment]::GetFolderPath('ApplicationData')</code></p>"},{"location":"Syntax/#history","title":"History","text":"<p><code>Get-History</code> \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u043a\u043e\u043c\u0430\u043d\u0434 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0435\u0441\u0441\u0438\u0438  <code>(Get-History)[-1].Duration.TotalSeconds</code> \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b  <code>(Get-PSReadLineOption).HistorySavePath</code> \u043f\u0443\u0442\u044c \u043a \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u043c\u0443 \u0444\u0430\u0439\u043b\u0443 \u0441 4096 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 \u043a\u043e\u043c\u0430\u043d\u0434 (\u0438\u0437 \u043c\u043e\u0434\u0443\u043b\u044f PSReadLine)  <code>Get-Content (Get-PSReadlineOption).HistorySavePath | Select-String Get</code> \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u043c\u0443 \u0444\u0430\u0439\u043b\u0430 (GREP)  <code>Set-PSReadlineOption -MaximumHistoryCount 10000</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c\u044b\u0445 \u043a\u043e\u043c\u0430\u043d\u0434 \u0432 \u0444\u0430\u0439\u043b  <code>Get-PSReadLineOption | select MaximumHistoryCount</code> <code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u0430  <code>F2</code> \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u0441 InlineView \u043d\u0430 ListView</p>"},{"location":"Syntax/#clipboard","title":"Clipboard","text":"<p><code>Set-Clipboard $srv</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0431\u0443\u0444\u0435\u0440 \u043e\u0431\u043c\u0435\u043d\u0430  <code>Get-Clipboard</code> \u0432\u0441\u0442\u0430\u0432\u0438\u0442\u044c</p>"},{"location":"Syntax/#write-host","title":"Write-Host","text":"<pre><code>Write-Host -BackgroundColor Green \"Test:\" -NoNewline # \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0446\u0432\u0435\u0442 \u0444\u043e\u043d\u0430 \u0438 \u0437\u0430\u043f\u0440\u0435\u0442\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u043d\u043e\u0441 \u0441\u0442\u0440\u043e\u043a\u0438\nWrite-Host \" True\" -ForegroundColor Green # \u0434\u0430\u043d\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c\u0441\u044f \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u044f \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0443\u044e \u0441 \u043d\u043e\u0432\u044b\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u0446\u0432\u0435\u0442\u0430 (\u0444\u043e\u043d \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u043c \u0446\u0432\u0435\u0442 \u0442\u0435\u043a\u0441\u0442\u0430)\n</code></pre> <p><code>Write-Error \"False\"</code> <code>Write-Warning \"False\"</code></p>"},{"location":"Syntax/#write-progress","title":"Write-Progress","text":"<pre><code>foreach ($n in 1..100) {\n    Write-Progress -Activity \"Test Progress\" -PercentComplete $n\n    Start-Sleep -Milliseconds 100\n}\n</code></pre>"},{"location":"Syntax/#for","title":"for","text":"<pre><code>for ($i = 0; $i -le 100; $i+=10) {\n    Write-Progress -Activity \"Test Progress\" -PercentComplete $i\n    Start-Sleep -Seconds 1\n}\n</code></pre>"},{"location":"Syntax/#array","title":"Array","text":"<p><code>$srv = @(\"server-01\", \"server-02\")</code>  \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432  <code>$srv += @(\"server-03\")</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043c\u0430\u0441\u0441\u0438\u0432 \u043d\u043e\u0432\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442  <code>$srv.Count</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u043e\u043b-\u0432\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435  <code>Out-String</code> \u043f\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434</p>"},{"location":"Syntax/#index","title":"Index","text":"<p><code>$srv[0]</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043f\u0435\u0440\u0432\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u043c\u0430\u0441\u0441\u0438\u0432\u0430  <code>$srv[0] = Name</code> \u0437\u0430\u043c\u0435\u043d\u0430 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435  <code>$srv[0].Length</code> \u0443\u0437\u043d\u0430\u0442\u044c \u043a\u043e\u043b-\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435  <code>$srv[10..100]</code> \u0441\u0440\u0435\u0437</p> <pre><code>$array = \"a\",\"b\",\"c\",\"d\"\n$num = 0\nforeach ($a in $array) {\n    $num += 1\n    $index = [array]::IndexOf($array, $a) # \u0443\u0437\u043d\u0430\u0442\u044c \u043d\u043e\u043c\u0435\u0440 \u0438\u043d\u0434\u0435\u043a\u0441\u0430 \u043f\u043e \u0437\u0430\u0447\u0435\u043d\u0438\u044e\n    $array[$index] = $num # \u043f\u0435\u0440\u0435\u0441\u043e\u0431\u0440\u0430\u0442\u044c \u0438\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u043c\u0430\u0441\u0441\u0438\u0432\n}\n</code></pre>"},{"location":"Syntax/#hashtable","title":"HashTable","text":"<pre><code>$hashtable = @{ # \u0421\u043e\u0437\u0434\u0430\u0442\u044c (\u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c)\n    \"User\" = $env:USERNAME; \n    \"Server\" = $env:COMPUTERNAME\n}\n\n$hashtable += @{ # \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043b\u044e\u0447\u0438\n    \"Profile\" = $PROFILE;\n    \"PowerShell_Home_Dir\" = $PSHOME\n}\n</code></pre> <p><code>$hashtable.Keys</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043a\u043b\u044e\u0447\u0435\u0439  <code>$hashtable[\"User\"]</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 (Values) \u043f\u043e \u043a\u043b\u044e\u0447\u0443  <code>$hashtable[\"User\"] = \"Test\"</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c  <code>$hashtable.Remove(\"User\")</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u043b\u044e\u0447</p>"},{"location":"Syntax/#collectionslist","title":"Collections/List","text":"<pre><code>$Collections = New-Object System.Collections.Generic.List[System.Object]\n$Collections.Add([PSCustomObject]@{\n    User = $env:username;\n    Server = $env:computername\n})\n</code></pre>"},{"location":"Syntax/#pscustomobject","title":"PSCustomObject","text":"<pre><code>$CustomObject = [PSCustomObject][ordered]@{\n    User = $env:username;\n    Server = $env:computername\n}\n</code></pre>"},{"location":"Syntax/#add-and-remove-property","title":"Add and Remove Property","text":"<p><code>$CustomObject | Add-Member \u2013MemberType NoteProperty \u2013Name Arr \u2013Value @(1,2,3)</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u043e/\u0441\u0442\u043e\u0431\u0435\u0446  <code>$CustomObject.Arr = @(1,3,5)</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435  <code>$CustomObject.PsObject.Properties.Remove('User')</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c Property</p>"},{"location":"Syntax/#add-method","title":"Add Method","text":"<pre><code>$ScriptBlock = {Get-Service}\n$CustomObject | Add-Member -Name \"TestMethod\" -MemberType ScriptMethod -Value $ScriptBlock\n$CustomObject | Get-Member\n$CustomObject.TestMethod()\n</code></pre>"},{"location":"Syntax/#class","title":"Class","text":"<pre><code>Class CustomClass {\n    [string]$User\n    [string]$Server\n    Start([bool]$Param1) {\n        If ($Param1) {\n        Write-Host \"Start Function\"\n        }\n    }\n}\n</code></pre> <p><code>$Class = New-Object -TypeName CustomClass</code> <code>$Class.User = $env:username</code> <code>$Class.Server = $env:computername</code> <code>$Class.Start(1)</code></p>"},{"location":"Syntax/#pipeline","title":"Pipeline","text":"<p><code>$CustomObject | Add-Member -MemberType NoteProperty -Name \"Type\" -Value \"user\" -Force</code> \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u044a\u043a\u0442\u0430 \u0432\u044b\u0432\u043e\u0434\u0430 NoteProperty  <code>$CustomObject | Add-Member -MemberType NoteProperty -Name \"User\" -Value \"admin\" -Force</code> \u0438\u0437\u043c\u0435\u043d\u0435\u0438\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0434\u043b\u044f \u0441\u0443\u0449\u043d\u043e\u0441\u0442\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 User  <code>ping $srv | Out-Null</code> \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432\u044b\u0432\u043e\u0434\u0430 \u0432 Out-Null</p>"},{"location":"Syntax/#select-object","title":"Select-Object","text":"<p><code>Get-Process | Select-Object -Property *</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0432\u044b\u0432\u043e\u0434\u0430  <code>Get-Process | select -Unique \"Name\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u044e\u0449\u0438\u0435\u0441\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435  <code>Get-Process | select -ExpandProperty ProcessName</code> \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u0438\u0437 \u043e\u0431\u044a\u0435\u043a\u0442\u0430-\u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u0438 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432 (\u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0431\u0435\u0437 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u044f \u0441\u0442\u043e\u043b\u0431\u0446\u0430)  <code>(Get-Process | ? Name -match iperf).Modules</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c</p>"},{"location":"Syntax/#expression","title":"Expression","text":"<pre><code>Get-Process | Sort-Object -Descending CPU | select -first 10 ProcessName, # \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u043e CPU, \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043f\u0435\u0440\u0432\u044b\u0445 10 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 (-first)\n@{Name=\"ProcessorTime\";\n    Expression={$_.TotalProcessorTime -replace \"\\.\\d+$\"} # \u0437\u0430\u0442\u0440\u0430\u0447\u0435\u043d\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043d\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0432 \u043c\u0438\u043d\u0443\u0442\u0430\u0445\n},\n@{Name=\"Memory\"; \n    Expression={[string]([int]($_.WS / 1024kb))+\"MB\"} # \u0434\u0435\u043b\u0438\u043c \u0431\u0430\u0439\u0442\u044b \u043d\u0430 \u041a\u0411 (1mb)\n},\n@{Label=\"RunTime\"; \n    Expression={((Get-Date) - $_.StartTime) -replace \"\\.\\d+$\"} # \u0432\u044b\u0447\u0435\u0441\u0442\u044c \u0438\u0437 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 - \u0432\u0440\u0435\u043c\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430, \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u044c milisec\n}\n</code></pre>"},{"location":"Syntax/#select-string","title":"Select-String","text":"<p><code>$(ipconfig | Select-String IPv4) -replace \".+: \" | Where-Object {$_ -match \"^172.\"}</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e IP  <code>$Current_IP = Get-Content $RDCMan_RDG_PATH | Select-String $RDCMan_Display_Name -Context 0,1</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u0432\u0435 \u0441\u0442\u0440\u043e\u043a\u0438  <code>$Current_IP = $Current_IP.Context.DisplayPostContext[0] -replace \".+&lt;name&gt;|&lt;\\/name&gt;\"</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u0442\u043e\u0440\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u044d\u0433\u0438</p>"},{"location":"Syntax/#format-listformat-table","title":"Format-List/Format-Table","text":"<p><code>Get-Process | fl ProcessName, StartTime</code> <code>Get-Process | ft ProcessName, StartTime -Autosize</code> \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0438\u0440\u043e\u0432\u043a\u0430 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432</p>"},{"location":"Syntax/#measure-object","title":"Measure-Object","text":"<p><code>Get-Process | Measure | select Count</code> \u043a\u043e\u043b-\u0432\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432  <code>Get-Process | Measure -Line -Word -Character</code> \u043a\u043e\u043b-\u0432\u043e \u0441\u0442\u0440\u043e\u043a, \u0441\u043b\u043e\u0432 \u0438 Char \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432  <code>Get-Process | Measure-Object PM -sum | Select-Object Count,@{Name=\"MEM_MB\"; Expression={[int]($_.Sum/1mb)}}</code> \u043a\u043e\u043b-\u0432\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0438 \u043e\u0431\u0449\u0438\u0439 \u043e\u0431\u044a\u0435\u043c \u0437\u0430\u043d\u044f\u0442\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 \u0432 \u041c\u0411\u0430\u0439\u0442</p>"},{"location":"Syntax/#compare-object","title":"Compare-Object","text":"<p><code>Compare-Object -ReferenceObject (Get-Content -Path .\\file1.txt) -DifferenceObject (Get-Content -Path .\\file2.txt)</code> \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0435 \u0434\u0432\u0443\u0445 \u0444\u0430\u0439\u043b\u043e\u0432  <code>$group1 = Get-ADGroupMember -Identity \"Domain Admins\"</code> <code>$group2 = Get-ADGroupMember -Identity \"Enterprise Admins\"</code> <code>Compare-Object -ReferenceObject $group1 -DifferenceObject $group2 -IncludeEqual</code> \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0435 \u0434\u0440\u0443\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 <code>==</code> \u043d\u0435\u0442 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439  <code>&lt;=</code> \u0435\u0441\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 $group1  <code>=&gt;</code> \u0435\u0441\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 $group2</p>"},{"location":"Syntax/#where-object","title":"Where-Object (?)","text":"<p><code>Get-Process | Where-Object {$_.ProcessName -match \"zabbix\"}</code> \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f/\u043f\u043e\u0438\u0441\u043a \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430 \u043e\u0431\u044a\u0435\u043a\u0442\u0430  <code>Get-Process | where CPU -gt 10 | Sort-Object -Descending CPU</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u044b, \u0433\u0434\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f CPU \u0431\u043e\u043b\u044c\u0448\u0435 10  <code>Get-Process | where WS -gt 200MB</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0433\u0434\u0435 WS \u0432\u044b\u0448\u0435 200\u041c\u0411  <code>Get-Service | where Name -match \"zabbix\"</code> \u043f\u043e\u0438\u0441\u043a \u0441\u043b\u0443\u0436\u0431\u044b  <code>Get-Service -ComputerName $srv | Where {$_.Name -match \"WinRM\"} | Restart-Service</code> \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443 \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0435  <code>(Get-Service).DisplayName</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430 \u043c\u0430\u0441\u0441\u0438\u0432\u0430  <code>netstat -an | where {$_ -match 443}</code> <code>netstat -an | ?{$_ -match 443}</code> <code>(netstat -an) -match 443</code></p>"},{"location":"Syntax/#sort-object","title":"Sort-Object","text":"<p><code>Get-Process | Sort-Object -Descending CPU | ft</code> \u043e\u0431\u0440\u0430\u0442\u043d\u0430\u044f (-Descending) \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u043e CPU  <code>Get-Process | Sort-Object -Descending cpu,ws</code> \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u043e \u0434\u0432\u0443\u043c \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430\u043c  <code>$path[-1..-10]</code> \u043e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0441\u0431\u043e\u0440\u043a\u0430 \u043c\u0430\u0441\u0441\u0438\u0432\u0430 \u0431\u0435\u0437 \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0438  <code>$arr = @(1..20); $arr[$($arr.Count - 1)..0]</code> \u043f\u0435\u0440\u0435\u0441\u043e\u0431\u0440\u0430\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432 \u0441 \u043a\u043e\u043d\u0446\u0430</p>"},{"location":"Syntax/#lastfirst","title":"Last/First","text":"<p><code>Get-Process | Sort-Object -Descending CPU | select -First 10</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043f\u0435\u0440\u0432\u044b\u0445 10 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432  <code>Get-Process | Sort-Object -Descending CPU | select -Last 10</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 10 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432</p>"},{"location":"Syntax/#group-object","title":"Group-Object","text":"<pre><code>$Groups = Get-CimInstance -Class Win32_PnPSignedDriver |\nSelect-Object DriverProviderName, FriendlyName, Description, DriverVersion, DriverDate |\nGroup-Object DriverProviderName, FriendlyName, Description, DriverVersion, DriverDate\n$(foreach ($Group in $Groups) {\n    $Group.Group[0]\n}) | Format-Table\n</code></pre>"},{"location":"Syntax/#property","title":"Property","text":"<p><code>$srv.Count</code> \u043a\u043e\u043b-\u0432\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435  <code>$srv.Length</code> \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u043c \u0441\u0442\u0440\u043e\u043a\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 [string] \u0438\u043b\u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 (\u0441\u0442\u0440\u043e\u043a) \u043e\u0431\u044a\u0435\u043a\u0442\u0430  <code>$srv.Chars(2)</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c 3-\u0439 \u0441\u0438\u043c\u0432\u043e\u043b \u0432 \u0441\u0442\u0440\u043e\u043a\u0435  <code>$srv[2]</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c 3-\u044e \u0441\u0442\u0440\u043e\u043a\u0443 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435</p>"},{"location":"Syntax/#method","title":"Method","text":"<p><code>$srv = \"127.0.0.1\"</code> <code>$srv.Insert(0,\"https://\")</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u0434 \u043f\u0435\u0440\u0432\u044b\u043c \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u043c  <code>$srv.Substring(4)</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c (\u0438\u0437 \u0432\u0441\u0435\u0433\u043e \u043c\u0430\u0441\u0441\u0438\u0432\u0430) \u043f\u0435\u0440\u0432\u044b\u0435 4 \u0441\u0438\u043c\u0432\u043e\u043b\u0430  <code>$srv.Remove(3)</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437 \u0432\u0441\u0435\u0433\u043e \u043c\u0430\u0441\u0441\u0438\u0432\u0430 \u0432\u0441\u0435 \u043f\u043e\u0441\u043b\u0435 3 \u0441\u0438\u043c\u0432\u043e\u043b\u0430  <code>$string = \"123\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443  <code>$int = [convert]::ToInt32($string)</code> \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443 \u0432 \u0442\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445 \u0447\u0438\u0441\u043b\u043e  <code>[string]::Concat($text,$num)</code> \u043e\u0431\u044a\u0435\u0434\u0435\u043d\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0432 \u043e\u0434\u043d\u0443 \u0441\u0442\u0440\u043e\u043a\u0443  <code>[string]::Join(\":\",$text,$num)</code> \u043e\u0431\u044a\u0435\u0434\u0435\u043d\u0438\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c  <code>[string]::Compare($text,$num,$true)</code> \u0432\u044b\u0434\u0430\u0435\u0442 0 \u043f\u0440\u0438 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0438 \u0438\u043b\u0438 1/-1 \u043f\u0440\u0438 \u043d\u0435\u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0438, $true (\u0431\u0435\u0437 \u0443\u0447\u0435\u0442\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430) \u0438\u043b\u0438 $false (\u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430)  <code>[string]::Equals($text,$num)</code> \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0435 \u0434\u0432\u0443\u0445 \u0441\u0442\u0440\u043e\u043a \u0438 \u0432\u044b\u0434\u0430\u0435\u0442 $true \u043f\u0440\u0438 \u0438\u0445 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0438 \u0438\u043b\u0438 $false \u043f\u0440\u0438 \u043d\u0435\u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0438  <code>[string]::IsNullOrEmpty($text)</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u0441\u0442\u0440\u043e\u043a\u0438, \u0435\u0441\u043b\u0438 \u0441\u0442\u0440\u043e\u043a\u0430 \u043f\u0443\u0441\u0442\u0430 $true, \u0435\u0441\u043b\u0438 \u043d\u0435\u0442 $false  <code>[string]::IsNullOrWhiteSpace($text2)</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043d\u0430 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u043f\u0440\u043e\u0431\u0435\u043b, \u0442\u0430\u0431\u0443\u043b\u044f\u0446\u0438\u044f \u0438\u043b\u0438 \u0441\u0438\u043c\u0432\u043e\u043b \u043d\u043e\u0432\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438</p>"},{"location":"Syntax/#error","title":"Error","text":"<p><code>$Error</code> \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0432\u0441\u0435 \u043e\u0448\u0438\u0431\u043a\u0438 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0441\u0435\u0430\u043d\u0441\u0430  <code>$Error[0].InvocationInfo</code> \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044b\u0439 \u043e\u0442\u0447\u0435\u0442 \u043e\u0431 \u043e\u0448\u0438\u0431\u043a\u0435  <code>$Error.clear()</code> <code>$LASTEXITCODE</code> \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b (0 - \u0443\u0441\u043f\u0435\u0445)  <code>exit 1</code> \u043a\u043e\u0434 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f $LASTEXITCODE</p>"},{"location":"Syntax/#executionstatus","title":"ExecutionStatus","text":"<pre><code>$(Get-History)[-1] | Select-Object @{\n    Name=\"RunTime\"; Expression={$_.EndExecutionTime - $_.StartExecutionTime}\n},ExecutionStatus,CommandLine # \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 [-1] (\u0438\u043b\u0438 Select-Object -Last 1) \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0438 \u0435\u0435 \u0443\u0437\u043d\u0430\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441\n</code></pre>"},{"location":"Syntax/#measure-command","title":"Measure-Command","text":"<p><code>$(Measure-Command {ping ya.ru}).TotalSeconds</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445</p>"},{"location":"Syntax/#datetime","title":"DateTime","text":"<p><code>[DateTime]::UtcNow</code> \u0432\u0440\u0435\u043c\u044f \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 UTC 0  <code>$(Get-Date).AddHours(-3)</code> \u0432\u044b\u0447\u0435\u0441\u0442\u044c \u0442\u0440\u0438 \u0447\u0430\u0441\u0430 \u0438\u0437 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438  <code>$Date = $(Get-Date -Format \"dd/MM/yyyy HH:mm:ss\")</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0444\u043e\u0440\u043c\u0430\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0432\u0440\u0435\u043c\u0435\u043d\u0438  <code>$Date = Get-Date -f \"dd/MM/yyyy\"</code> \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0442\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445 [string] $($Date.GetType().Name)  <code>$Date = \"19.05.2024\"</code> <code>[DateTime]$Date = Get-Date \"$Date\"</code> \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0443\u044e \u043f\u043e\u0434 \u0444\u043e\u0440\u043c\u0430\u0442 \u0434\u0430\u0442\u044b \u0432 \u0442\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445 [DateTime]  <code>$BeforeDate = Get-Date \"12.05.2024\"</code> <code>[int32]$days=$($Date - $BeforeDate).Days</code> \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0440\u0430\u0437\u043d\u0438\u0446\u0443 \u0432 \u0434\u043d\u044f\u0445  <code>\"5/7/07\" -as [DateTime]</code> \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u0432\u0445\u043e\u0434\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0442\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445 [DateTime]</p>"},{"location":"Syntax/#timespan","title":"TimeSpan","text":"<p><code>New-TimeSpan -Start $(Get-Date) -End $($(Get-Date).AddMinutes(+1))</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0440\u0430\u0437\u043d\u0438\u0446\u0443 \u0432\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438  <code>$TimeZone = (Get-TimeZone).BaseUtcOffset.TotalMinutes</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0440\u0430\u0437\u043d\u0438\u0446\u0443 \u0432 \u043c\u0438\u043d\u0443\u0442\u0430\u0445 \u043e\u0442 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0447\u0430\u0441\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u044f\u0441\u0430 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e UTC 0  <code>$UnixTime  = (New-TimeSpan -Start (Get-Date \"01/01/1970\") -End ((Get-Date).AddMinutes(-$tz))).TotalSeconds</code> \u0432\u044b\u0447\u0435\u0441\u0442\u044c \u043c\u0438\u043d\u0443\u0442\u044b \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f UTC 0  <code>$TimeStamp = ([string]$UnixTime -replace \"\\..+\") + \"000000000\"</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0438\u0439 TimeStamp</p>"},{"location":"Syntax/#format","title":"Format","text":"<pre><code>HH   # \u0427\u0430\u0441\u044b \u0432 24-\u0447\u0430\u0441\u043e\u0432\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435 (00 \u0434\u043e 23)\nhh   # \u0427\u0430\u0441\u044b \u0432 12-\u0447\u0430\u0441\u043e\u0432\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435 (01 \u0434\u043e 12)\nmm   # \u041c\u0438\u043d\u0443\u0442\u044b (00 \u0434\u043e 59)\nss   # \u0421\u0435\u043a\u0443\u043d\u0434\u044b (00 \u0434\u043e 59)\ntt   # \u0414\u0435\u0441\u0438\u0433\u043d\u0430\u0442\u043e\u0440 (AM/PM)\nfff  # \u041c\u0438\u043b\u043b\u0438\u0441\u0435\u043a\u0443\u043d\u0434\u044b (000 \u0434\u043e 999)\nd    # \u0414\u0435\u043d\u044c \u043c\u0435\u0441\u044f\u0446\u0430 \u0431\u0435\u0437 \u0432\u0435\u0434\u0443\u0449\u0435\u0433\u043e \u043d\u0443\u043b\u044f (1-31)\ndd   # \u0414\u0435\u043d\u044c \u043c\u0435\u0441\u044f\u0446\u0430 \u0441 \u0432\u0435\u0434\u0443\u0449\u0438\u043c \u043d\u0443\u043b\u0451\u043c (01-31)\nddd  # \u0421\u043e\u043a\u0440\u0430\u0449\u0451\u043d\u043d\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0434\u043d\u044f \u043d\u0435\u0434\u0435\u043b\u0438 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \"\u041f\u043d\")\ndddd # \u041f\u043e\u043b\u043d\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0434\u043d\u044f \u043d\u0435\u0434\u0435\u043b\u0438 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \"\u041f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a\")\nM    # \u041d\u043e\u043c\u0435\u0440 \u043c\u0435\u0441\u044f\u0446\u0430 \u0431\u0435\u0437 \u0432\u0435\u0434\u0443\u0449\u0435\u0433\u043e \u043d\u0443\u043b\u044f (1-12)\nMM   # \u041d\u043e\u043c\u0435\u0440 \u043c\u0435\u0441\u044f\u0446\u0430 \u0441 \u0432\u0435\u0434\u0443\u0449\u0438\u043c \u043d\u0443\u043b\u0451\u043c (01-12)\nMMM  # \u0421\u043e\u043a\u0440\u0430\u0449\u0451\u043d\u043d\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0441\u044f\u0446\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \"\u042f\u043d\u0432\")\nMMMM # \u041f\u043e\u043b\u043d\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0441\u044f\u0446\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \"\u042f\u043d\u0432\u0430\u0440\u044c\")\ny    # \u0413\u043e\u0434 \u0431\u0435\u0437 \u0432\u0435\u043a\u0430 (0-99)\nyy   # \u0413\u043e\u0434 \u0431\u0435\u0437 \u0432\u0435\u043a\u0430 \u0441 \u0432\u0435\u0434\u0443\u0449\u0438\u043c \u043d\u0443\u043b\u0451\u043c (00-99)\nyyyy # \u0413\u043e\u0434 \u0441 \u0432\u0435\u043a\u043e\u043c (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, 2024)\ng    # \u041f\u0435\u0440\u0438\u043e\u0434 \u0438\u043b\u0438 \u044d\u0440\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \"\u043d.\u044d.\")\n</code></pre>"},{"location":"Syntax/#timer","title":"Timer","text":"<p><code>$start_time = Get-Date</code> \u0437\u0430\u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0434\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u044b  <code>$end_time = Get-Date</code> \u0437\u0430\u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u043f\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044e  <code>$time = $end_time - $start_time</code> \u0432\u044b\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441\u043a\u0440\u0438\u043f\u0442\u0430  <code>$min = $time.minutes</code> <code>$sec = $time.seconds</code> <code>Write-Host \"$min \u043c\u0438\u043d\u0443\u0442 $sec \u0441\u0435\u043a\u0443\u043d\u0434\"</code></p> <p><code>$timer = [System.Diagnostics.Stopwatch]::StartNew()</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0442\u0430\u0439\u043c\u0435\u0440  <code>$timer.IsRunning</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0440\u0430\u0431\u043e\u0442\u044b \u0442\u0430\u0439\u043c\u0435\u0440\u0430  <code>$timer.Elapsed.TotalSeconds</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0441 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 (\u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445)  <code>$timer.Stop()</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0442\u0430\u0439\u043c\u0435\u0440</p>"},{"location":"Syntax/#regex","title":"Regex","text":"<pre><code>.       # \u041e\u0431\u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442 \u043b\u044e\u0431\u043e\u0439 \u0441\u0438\u043c\u0432\u043e\u043b, \u043a\u0440\u043e\u043c\u0435 \u043d\u043e\u0432\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438\n\\       # \u042d\u043a\u0440\u0430\u043d\u0438\u0440\u0443\u0435\u0442 \u043b\u044e\u0431\u043e\u0439 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0438\u043c\u0432\u043e\u043b (\u043c\u0435\u0442\u0430\u0441\u0438\u043c\u0432\u043e\u043b). \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f, \u0435\u0441\u043b\u0438 \u043d\u0443\u0436\u043d\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0441\u0438\u043c\u0432\u043e\u043b, \u0432\u043c\u0435\u0441\u0442\u043e \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0433\u043e ({ } [ ] / \\ + * . $ ^ | ?)\n\\A (^)  # \u041d\u0430\u0447\u0430\u043b\u043e \u0441\u0442\u0440\u043e\u043a\u0438\n\\Z ($)  # \u041a\u043e\u043d\u0435\u0446 \u0441\u0442\u0440\u043e\u043a\u0438\n\\n      # \u041d\u043e\u0432\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430\n\\s      # \u041f\u0440\u043e\u0431\u0435\u043b (\u044d\u043a\u0432\u0438\u0432\u0430\u043b\u0435\u043d\u0442 \" \"), \u0442\u0430\u0431\u0443\u043b\u044f\u0446\u0438\u044f, \u043f\u0435\u0440\u0435\u043d\u043e\u0441 \u0441\u0442\u0440\u043e\u043a\u0438\n\\S      # \u041d\u0435 \u043f\u0440\u043e\u0431\u0435\u043b\n\\d      # \u0427\u0438\u0441\u043b\u043e \u043e\u0442 0 \u0434\u043e 9 (20-07-2022 \u044d\u043a\u0432\u0438\u0432\u0430\u043b\u0435\u043d\u0442: \"\\d\\d-\\d\\d-\\d\\d\\d\\d\")\n\\D      # \u041e\u0431\u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442 \u043b\u044e\u0431\u043e\u0439 \u0441\u0438\u043c\u0432\u043e\u043b, \u043a\u0440\u043e\u043c\u0435 \u0447\u0438\u0441\u043b\u0430 (\u0446\u0438\u0444\u0440\u044b). \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0432\u0441\u0435\u0445 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432, \u043a\u0440\u043e\u043c\u0435 \u0446\u0438\u0444\u0440: [int]$(\"123 test\" -replace \"\\D\")\n\\w      # \u041b\u044e\u0431\u0430\u044f \u0431\u0443\u043a\u0432\u0430 \u043b\u0430\u0442\u0438\u043d\u0438\u0446\u044b, \u0446\u0438\u0444\u0440\u0430, \u0438\u043b\u0438 \u0437\u043d\u0430\u043a \u043f\u043e\u0434\u0447\u0451\u0440\u043a\u0438\u0432\u0430\u043d\u0438\u044f (\u043e\u0442 \"a\" \u0434\u043e \"z\" \u0438 \u043e\u0442 \"A\" \u0434\u043e \"Z\" \u0438\u043b\u0438 \u0447\u0438\u0441\u043b\u043e \u043e\u0442 0 \u0434\u043e 9)\n\\W      # \u041d\u0435 \u043b\u0430\u0442\u0438\u043d\u0438\u0446\u0430, \u043d\u0435 \u0446\u0438\u0444\u0440\u0430, \u043d\u0435 \u043f\u043e\u0434\u0447\u0451\u0440\u043a\u0438\u0432\u0430\u043d\u0438\u0435\n\\b      # \u0413\u0440\u0430\u043d\u0438\u0446\u0430 \u0441\u043b\u043e\u0432\u0430. \u041f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u043a\u043e\u0433\u0434\u0430 \u043d\u0443\u0436\u043d\u043e \u0432\u044b\u0434\u0435\u043b\u0438\u0442\u044c, \u0447\u0442\u043e \u0438\u0441\u043a\u043e\u043c\u044b\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u044b \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0441\u043b\u043e\u0432\u043e\u043c, \u0430 \u043d\u0435 \u0447\u0430\u0441\u0442\u044c\u044e \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0441\u043b\u043e\u0432\u0430\n\\B      # \u041d\u0435 \u0433\u0440\u0430\u043d\u0438\u0446\u0430 \u0441\u043b\u043e\u0432\u0430\n\\A      # \u041d\u0430\u0447\u0430\u043b\u043e \u0442\u0435\u043a\u0441\u0442\u0430\n\\Z      # \u041a\u043e\u043d\u0435\u0446 \u0442\u0435\u043a\u0441\u0442\u0430\n+       # \u041f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u0442\u0441\u044f 1 \u0438 \u0431\u043e\u043b\u0435\u0435 \u0440\u0430\u0437 (\\s+)\n|       # \u0418\u043b\u0438. \u0421\u043e\u0435\u0434\u0438\u043d\u044f\u0435\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432\n()      # \u0412 \u043a\u0440\u0443\u0433\u043b\u044b\u0435 \u0441\u043a\u043e\u0431\u043a\u0438 \u0437\u0430\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u0432\u0441\u0435 \u043a\u043e\u043c\u0431\u0438\u043d\u0430\u0446\u0438\u0438 \u0441 \"\u0438\u043b\u0438\" \u0438 \u043f\u043e\u0438\u0441\u043a \u043d\u0430\u0447\u0430\u043b\u0430 \u0438 \u043a\u043e\u043d\u0446\u0430 \u0441\u0442\u0440\u043e\u043a\n[]      # \u043f\u043e\u0438\u0441\u043a \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u044f \u043b\u044e\u0431\u043e\u0439 \u0431\u0443\u043a\u0432\u044b, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, [A-z0-9] \u043e\u0442 A \u0434\u043e z \u0438 \u0446\u0438\u0444\u0440\u044b \u043e\u0442 0 \u0434\u043e 9 (\"192.168.1.1\" -match \"192.1[6-7][0-9]\")\n[^ ]    # \u0418\u0441\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0438\u0437 \u043f\u043e\u0438\u0441\u043a\u0430 \u0441\u0438\u043c\u0432\u043e\u043b\u044b \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432 \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u043d\u044b\u0445 \u0441\u043a\u043e\u0431\u043a\u0430\u0445\n{ }     # \u041a\u0432\u0430\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0432 \u0444\u0438\u0433\u0443\u0440\u043d\u044b\u0445 \u0441\u043a\u043e\u0431\u043a\u0430\u0445, \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439 \u0441\u0438\u043c\u0432\u043e\u043b\u0430 \u0441\u043b\u0435\u0432\u0430 \u043d\u0430 \u043f\u0440\u0430\u0432\u043e (\u043e\u0442 1 \u0434\u043e 25 \u0440\u0430\u0437)\n\\d{2}   # \u041d\u0430\u0439\u0442\u0438 \u0434\u0432\u0435 \u0446\u0438\u0444\u0440\u044b\n\\d{2,4} # \u041d\u0430\u0439\u0442\u0438 \u0434\u0432\u0435 \u0438\u043b\u0438 \u0447\u0435\u0442\u044b\u0440\u0435\n{4,}    # \u041d\u0430\u0439\u0442\u0438 \u0447\u0435\u0442\u044b\u0440\u0435 \u0438 \u0431\u043e\u043b\u0435\u0435\n</code></pre>"},{"location":"Syntax/#_1","title":"\u042f\u043a\u043e\u0440\u0438","text":"<p><code>^</code> \u0438\u043b\u0438 <code>\\A</code> \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043d\u0430\u0447\u0430\u043b\u043e \u0441\u0442\u0440\u043e\u043a\u0438. $url -replace '^','https:'<code>\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043d\u0430\u0447\u0430\u043b\u043e;</code>$<code>\u0438\u043b\u0438</code>\\Z<code>\u043e\u0431\u043e\u0437\u043d\u0430\u0447\u0430\u044e\u0442 \u043a\u043e\u043d\u0435\u0446 \u0441\u0442\u0440\u043e\u043a\u0438. $ip -replace \"\\d{1,3}$\",\"0\"</code>(?=text)<code>\u043f\u043e\u0438\u0441\u043a \u0441\u043b\u043e\u0432\u0430 \u0441\u043b\u0435\u0432\u0430. \u041f\u0438\u0448\u0435\u043c \u0441\u043b\u0435\u0432\u0430 \u043d\u0430 \u043f\u0440\u0430\u0432\u043e \u043e\u0442 \u0438\u0441\u043a\u043e\u043c\u043e\u0433\u043e (\u0438\u0449\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0446\u0435\u043b\u044b\u0435 \u0441\u043b\u043e\u0432\u043e\u0441\u043e\u0447\u0435\u0442\u0430\u043d\u0438\u044f) \"Server:\\s(.{1,30})\\s(?=$username)\"</code>(?&lt;=text)<code>\u043f\u043e\u0438\u0441\u043a \u0441\u043b\u043e\u0432\u0430 \u0441\u043f\u0440\u0430\u0432\u0430. $in_time -replace \".+(?&lt;=Last)\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0434\u043e \u0441\u043b\u043e\u0432\u0430 Last  <code>(?!text)</code> \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441\u043e \u0441\u043b\u043e\u0432\u043e\u043c \u0441\u043b\u0435\u0432\u0430  <code>(?&lt;!text)</code> \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u0435\u0442 \u0441\u043e \u0441\u043b\u043e\u0432\u043e\u043c \u0441\u043f\u0440\u0430\u0432\u0430</p> <p><code>$test = \"string\"</code> <code>$test -replace \".{1}$\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043b\u044e\u0431\u043e\u0435 \u043a\u043e\u043b-\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0432 \u043a\u043e\u043d\u0446\u0435 \u0441\u0442\u0440\u043e\u043a\u0438  <code>$test -replace \"^.{1}\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043b\u044e\u0431\u043e\u0435 \u043a\u043e\u043b-\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0432 \u043d\u0430\u0447\u0430\u043b\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 </p>"},{"location":"Syntax/#_2","title":"\u0413\u0440\u0443\u043f\u043f\u044b \u0437\u0430\u0445\u0432\u0430\u0442\u0430","text":"<p><code>$date = '12.31.2021'</code> <code>$date -replace '^(\\d{2}).(\\d{2})','$2.$1'</code> \u043f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u043c\u0435\u0441\u0442\u0430\u043c\u0438  <code>$1</code> \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043f\u0435\u0440\u0432\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b \u0432 \u0441\u043a\u043e\u0431\u043a\u0430\u0445  <code>$2</code> \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0432\u0442\u043e\u0440\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b</p> <p><code>-replace \"1\",\"2\"</code> \u0437\u0430\u043c\u0435\u043d\u0430 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0432 \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u0445 \u043c\u0430\u0441\u0441\u0438\u0432\u0430 (\u0432\u0435\u0437\u0434\u0435 \u0433\u0434\u0435 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 1, \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430 2), \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0435\u0440\u0432\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435  <code>-split \" \"</code> \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432, \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u0435\u043c \u0443\u043a\u0430\u0437\u0430\u043d \u043f\u0440\u043e\u0431\u0435\u043b, \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0443\u0434\u0430\u043b\u044f\u0435\u0442\u0441\u044f ($url.Split(\"/\")[-1])  <code>-join \" \"</code> \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432 (\u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u044e) \u0432 \u0435\u0434\u0438\u043d\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 (string), \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u0435\u043c \u043f\u0440\u043e\u0431\u0435\u043b</p> <p><code>@(1,2,3) -contains 3</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u0447\u0442\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u0441\u043f\u0440\u0430\u0432\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442\u0441\u044f \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435 \u0441\u043b\u0435\u0432\u0430  <code>@(1,2) -notcontains 3</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c, \u0447\u0442\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u0441\u043f\u0440\u0430\u0432\u0430 \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442\u0441\u044f \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435 \u0441\u043b\u0435\u0432\u0430</p> <p><code>-like *txt*</code> \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u043c\u0430\u0441\u043a\u0430\u043c wildcard, \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 \u044d\u043a\u0440\u0430\u043d  <code>-match txt</code> \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u0448\u0430\u0431\u043b\u043e\u043d\u0430\u043c, \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0442\u0435\u043a\u0441\u0442\u0430  <code>-match \"zabbix|rpc\"</code> \u0443\u0441\u043b\u043e\u0432\u0438\u044f, \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u043c \u0441\u043b\u043e\u0432\u0430\u043c  <code>-NotMatch</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0430 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0435 \u0432\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f </p>"},{"location":"Syntax/#matches","title":"Matches","text":"<p><code>\"num: 777\" -match \"num: ([0-9]+)\" | Out-Null</code> <code>$Matches[1]</code> \u0432\u044b\u0432\u043e\u0434\u0438\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u043e\u043c\u0435\u0440</p> <p><code>$ip = \"192.168.10.1\"</code> <code>$ip -match \"(\\.\\d{1,3})\\.\\d{1,2}\"</code> True  <code>$Matches</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0432\u0445\u043e\u0434\u044f\u0442 \u0438 \u043d\u0435 \u0432\u0445\u043e\u0434\u044f\u0442 \u0432 \u0433\u0440\u0443\u043f\u043f\u044b ()</p> <p><code>$String = \"09/14/2017 12:00:27 - mtbill_post_201709141058.txt 7577_Delivered: OK\"</code> <code>$String -Match \".*(?=\\.txt)\" | Out-Null</code> <code>$Matches[0][-4..-1] -Join \"\"</code></p> <p><code>$string.Substring($string.IndexOf(\".txt\")-4, 4)</code> 2-\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 (IndexOf)</p>"},{"location":"Syntax/#net-method-format","title":"\u0424\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 (.NET method format)","text":"<p><code>[string]::Format(\"{1} {0}\",\"Index0\",\"Index1\")</code> <code>\"{1} {0}\" -f \"Index0\",\"Index1\"</code> <code>\"{0:###-###-###}\" -f 1234567</code> \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0447\u0438\u0441\u043b\u043e \u0432 \u0434\u0440\u0443\u0433\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435 (#)  <code>\"{0:0000}\" -f 123</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0447\u0438\u0441\u043b\u043e \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u043d\u0435 \u043c\u0435\u043d\u044c\u0448\u0435 4 \u0437\u043d\u0430\u043a\u043e\u0432 (0123)  <code>\"{0:P0}\" -f (220/1000)</code> \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0432 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u0430\u0445 (P)  <code>\"{0:P}\" -f (512MB/1GB)</code> \u0441\u043a\u043e\u043b\u044c\u043a\u043e % \u0441\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 512\u041c\u0431 \u043e\u0442 1\u0413\u0431  <code>\"{0:0.0%}\" -f 0.123</code> \u0443\u043c\u043d\u043e\u0436\u0438\u0442\u044c \u043d\u0430 100%</p> <pre><code>$gp = Get-Process | sort cpu -Descending | select -First 10\nforeach ($p in $gp) {\n    \"{0} - {1:N2}\" -f $p.processname, $p.cpu # \u043e\u043a\u0440\u0443\u0433\u043b\u0438\u0442\u044c\n}\n</code></pre>"},{"location":"Syntax/#_3","title":"\u0423\u0441\u043b\u043e\u0432\u043d\u044b\u0439 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440","text":"<pre><code>$rh = Read-Host\nif ($rh -eq 1) {\n    ipconfig\n} elseif (\n    $rh -eq 2\n) {\n    getmac\n} else {\n    hostname\n}\n</code></pre> <p>\u0415\u0441\u043b\u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u0435 if () \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0438\u0441\u0442\u0435\u043d\u043d\u044b\u043c ($True), \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0432 {}  \u0415\u0441\u043b\u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u0435 if () \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043b\u043e\u0436\u043d\u044b\u043c ($False), \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043d\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430 else  \u0423\u0441\u043b\u043e\u0432\u0438\u0435 Elseif \u0438\u0434\u0451\u0442 \u043f\u043e\u0441\u043b\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f if \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0443\u0441\u043b\u043e\u0432\u0438\u0439 \u043f\u0435\u0440\u0435\u0434 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430 else. \u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0435\u0440\u0432\u044b\u0439 \u0432\u0435\u0440\u043d\u0435\u0442 $True, \u043e\u0442\u043c\u0435\u043d\u0438\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0443\u0441\u043b\u043e\u0432\u0438\u0439  \u0415\u0441\u043b\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e \u0432 \u0443\u0441\u043b\u043e\u0432\u0438\u0435 \u0431\u0435\u0437 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430, \u0442\u043e \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c\u0441\u044f \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0443 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u043d\u0430 $True/$False </p> <pre><code>if ($(Test-NetConnection $srv -Port 80).TcpTestSucceeded) {\n    \"Opened port\"\n} else {\n    \"Closed port\"\n}\n</code></pre>"},{"location":"Syntax/#_4","title":"\u041b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u044b \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f","text":"<p><code>-eq</code> \u0440\u0430\u0432\u043d\u043e (equal)  <code>-ceq</code> \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440  <code>-ne</code> \u043d\u0435 \u0440\u0430\u0432\u043d\u043e (not equal)  <code>-cne</code> \u043d\u0435 \u0440\u0430\u0432\u043d\u043e \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440  <code>-gt</code> \u0431\u043e\u043b\u044c\u0448\u0435 (greater)  <code>-ge</code> \u0431\u043e\u043b\u044c\u0448\u0435 \u0438\u043b\u0438 \u0440\u0430\u0432\u043d\u043e  <code>-lt</code> \u043c\u0435\u043d\u044c\u0448\u0435 (less)  <code>-le</code> \u043c\u0435\u043d\u044c\u0448\u0435 \u0438\u043b\u0438 \u0440\u0430\u0432\u043d\u043e  <code>-in</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043d\u0430 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 (5 -in @(1,2,3,4,5))  <code>-NOT</code> \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u041d\u0415\u0422 !(Test-Path $path)  <code>-and</code> \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0418  <code>-or</code> \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0418\u041b\u0418 </p> <pre><code>if ((($1 -eq 1) -and ($2 -eq 2)) -or ($1 -ne 3)) {\n    $true\n} else {\n    $false\n} # \u0434\u0432\u0430 \u0443\u0441\u043b\u043e\u0432\u0438\u044f: (\u0435\u0441\u043b\u0438 $1 = 1 \u0418 $2 = 2) \u0418\u041b\u0418 $1 \u043d\u0435 \u0440\u0430\u0432\u043d\u043e 3 \u0432\u0435\u0440\u043d\u0443\u0442\u044c $true\n</code></pre>"},{"location":"Syntax/#pipeline-operators","title":"Pipeline Operators","text":"<p><code>Write-Output \"First\" &amp;&amp; Write-Output \"Second\"</code> \u0434\u0432\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0442\u0441\u044f  <code>Write-Error \"Bad\" &amp;&amp; Write-Output \"Second\"</code> \u043f\u0435\u0440\u0432\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0430\u0435\u0442\u0441\u044f \u043e\u0448\u0438\u0431\u043a\u043e\u0439, \u0438\u0437-\u0437\u0430 \u0447\u0435\u0433\u043e \u0432\u0442\u043e\u0440\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f  <code>Write-Error \"Bad\" || Write-Output \"Second\"</code> \u043f\u0435\u0440\u0432\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0430\u0435\u0442\u0441\u044f \u043e\u0448\u0438\u0431\u043a\u043e\u0439, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0432\u0442\u043e\u0440\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430  <code>Write-Output \"First\" || Write-Output \"Second\"</code> \u043f\u0435\u0440\u0432\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0432\u0442\u043e\u0440\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f</p>"},{"location":"Syntax/#invocation-operator","title":"Invocation Operator","text":"<p><code>$addr = \"8.8.8.8\"</code> <code>$ping = \"ping\"</code> <code>&amp; $ping $addr</code> \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0442\u0435\u043a\u0441\u0442 \u043a\u0430\u043a \u043a\u043e\u043c\u0430\u043d\u0434\u0443</p> <p><code>&amp; $ping $addr &amp;</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0432 \u0444\u043e\u043d\u0435  <code>(Get-Job)[-1] | Receive-Job -Keep</code></p>"},{"location":"Syntax/#datatype","title":"DataType","text":"<p><code>$srv.GetType()</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0442\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445  <code>$srv -is [string]</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435 \u0442\u0438\u043f\u0430 \u0434\u0430\u043d\u043d\u044b\u0445  <code>$srv -isnot [System.Object]</code> \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0430 \u043d\u0435\u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435  <code>[Object]</code> \u043c\u0430\u0441\u0441\u0438\u0432 (BaseType:System.Array)  <code>[DateTime]</code> \u0444\u043e\u0440\u043c\u0430\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 (BaseType:System.ValueType)  <code>[Bool]/[Boolean]</code> \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 ($True/$False) \u0438\u043b\u0438 1/0 (1 \u0431\u0438\u0442) \u043d\u0430\u043b\u0438\u0447\u0438\u0435/\u043e\u0442\u0441\u0443\u0441\u0442\u0432\u0438\u0435 \u043d\u0430\u043f\u0440\u044f\u0436\u0435\u043d\u0438\u044f  <code>[Byte]</code> 8-\u0431\u0438\u0442\u043d\u043e\u0435 (1 \u0431\u0430\u0439\u0442) \u0446\u0435\u043b\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u0431\u0435\u0437 \u0437\u043d\u0430\u043a\u0430 (0..255)  <code>[Int16]</code> 16-\u0431\u0438\u0442\u043d\u043e\u0435 \u0437\u043d\u0430\u043a\u043e\u0432\u043e\u0435 \u0446\u0435\u043b\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043e\u0442 -32767 \u0434\u043e 32767 (\u0442\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445 WORD 0..65535)  <code>[Int]</code> 32-\u0431\u0438\u0442\u043d\u043e\u0435 (4 \u0431\u0430\u0439\u0442\u0430) \u0437\u043d\u0430\u043a\u043e\u0432\u043e\u0435 \u0446\u0435\u043b\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u043e\u0442 \u20132147483648 \u0434\u043e 2147483647 (DWORD)  <code>[Int64]</code> 64-\u0431\u0438\u0442\u043d\u043e\u0435 \u043e\u0442 -9223372036854775808 \u0434\u043e 9223372036854775808 (LWORD)  <code>[Decimal]</code> 128-\u0431\u0438\u0442\u043d\u043e\u0435 \u0434\u0435\u0441\u044f\u0442\u0438\u0447\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043e\u0442 \u201379228162514264337593543950335 \u0434\u043e 79228162514264337593543950335  <code>[Single]</code> \u0447\u0438\u0441\u043b\u043e \u0441 \u043f\u043b\u0430\u0432\u0430\u044e\u0449\u0435\u0439 \u0437\u0430\u043f\u044f\u0442\u043e\u0439 (32-\u0440\u0430\u0437\u0440\u044f\u0434\u043d\u043e\u0435)  <code>[Double]</code> \u0447\u0438\u0441\u043b\u043e \u0441 \u043f\u043b\u0430\u0432\u0430\u044e\u0449\u0435\u0439 \u0437\u0430\u043f\u044f\u0442\u043e\u0439 \u0441 \u0434\u0432\u043e\u0439\u043d\u043e\u0439 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c\u044e (64-\u0440\u0430\u0437\u0440\u044f\u0434\u043d\u043e\u0435)  <code>[String]</code> \u043d\u0435\u0438\u0437\u043c\u0435\u043d\u044f\u0435\u043c\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u042e\u043d\u0438\u043a\u043e\u0434\u0430 \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0434\u043b\u0438\u043d\u044b (BaseType:System.Object)</p>"},{"location":"Syntax/#math","title":"Math","text":"<p><code>[math] | Get-Member -Static</code> <code>[math]::Pow(2,4)</code> 2 \u0432 4 \u0441\u0442\u0435\u043f\u0435\u043d\u0438  <code>[math]::Truncate(1.8)</code> \u0433\u0440\u0443\u0431\u043e\u0435 \u043e\u043a\u0440\u0443\u0433\u043b\u0435\u043d\u0438\u0435, \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0447\u0430\u0441\u0442\u044c  <code>[math]::Ceiling(1.8)</code> \u043e\u043a\u0440\u0443\u0433\u043b\u044f\u0435\u0442 \u0447\u0438\u0441\u043b\u043e \u0432 \u0431\u043e\u043b\u044c\u0448\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u043d\u0443 \u0434\u043e \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0433\u043e \u0446\u0435\u043b\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f  <code>[math]::Floor(-1.8)</code> \u043e\u043a\u0440\u0443\u0433\u043b\u044f\u0435\u0442 \u0447\u0438\u0441\u043b\u043e \u0432 \u043c\u0435\u043d\u044c\u0448\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u043d\u0443  <code>[math]::Min(33,22)</code> \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043d\u0430\u0438\u043c\u0435\u043d\u044c\u0448\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u0432\u0443\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439  <code>[math]::Max(33,22)</code> \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043d\u0430\u0438\u0431\u043e\u043b\u044c\u0448\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u0432\u0443\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439</p>"},{"location":"Syntax/#round","title":"Round","text":"<p><code>[double]::Round(87.5, 0)</code> 88 (\u043d\u0435\u0447\u0435\u0442\u043d\u043e\u0435), \u0432 .NET \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043e\u043a\u0440\u0443\u0433\u043b\u0435\u043d\u0438\u0435 \u0432 \u0441\u0440\u0435\u0434\u043d\u0435\u0439 \u0442\u043e\u0447\u043a\u0435 ToEven, \u0433\u0434\u0435 *.5 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043e\u043a\u0440\u0443\u0433\u043b\u044f\u044e\u0442\u0441\u044f \u0434\u043e \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0433\u043e \u0447\u0435\u0442\u043d\u043e\u0433\u043e \u0446\u0435\u043b\u043e\u0433\u043e \u0447\u0438\u0441\u043b\u0430  <code>[double]::Round(88.5, 0)</code> 88 (\u0447\u0435\u0442\u043d\u043e\u0435)  <code>[double]::Round(88.5, 0, 1)</code> 89 (\u043e\u043a\u0440\u0443\u0433\u043b\u044f\u0442\u044c \u0432 \u0431\u043e\u043b\u044c\u0448\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u043d\u0443)  <code>[double]::Round(1234.56789, 2)</code> \u043e\u043a\u0440\u0443\u0433\u043b\u0438\u0442\u044c \u0434\u043e 2 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u044f\u0442\u043e\u0439</p>"},{"location":"Syntax/#tostring","title":"ToString","text":"<p><code>(4164539/1MB).ToString(\"0.00\")</code> \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u044c \u043d\u0430 \u0434\u0432\u0430\u0436\u0434\u044b \u043d\u0430 1024/1024 \u0438 \u043e\u043a\u0440\u0443\u0433\u043b\u0438\u0442\u044c \u0434\u043e 3,97</p>"},{"location":"Syntax/#char","title":"Char","text":"<p><code>[Char]</code> c\u0438\u043c\u0432\u043e\u043b \u042e\u043d\u0438\u043a\u043e\u0434\u0430 (16-\u0440\u0430\u0437\u0440\u044f\u0434\u043d\u044b\u0439)  <code>$char = $srv.ToCharArray()</code> \u0440\u0430\u0437\u0431\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443 [string] \u043d\u0430 \u043c\u0430\u0441\u0441\u0438\u0432 [System.Array] \u0438\u0437 \u0431\u0443\u043a\u0432</p>"},{"location":"Syntax/#switch-function","title":"Switch function","text":"<pre><code>$MMM = Get-Date -UFormat \"%m\"\nswitch($MMM) {\n    \"01\" {$Month = 'Jan'}\n    \"02\" {$Month = 'Feb'}\n    \"03\" {$Month = 'Mar'}\n    \"04\" {$Month = 'Apr'}\n    \"05\" {$Month = 'May'}\n    \"06\" {$Month = 'Jun'}\n    \"07\" {$Month = 'Jul'}\n    \"08\" {$Month = 'Aug'}\n    \"09\" {$Month = 'Sep'}\n    \"10\" {$Month = 'Oct'}\n    \"11\" {$Month = 'Nov'}\n    \"12\" {$Month = 'Dec'}\n}\n</code></pre>"},{"location":"Syntax/#switch-param","title":"Switch param","text":"<pre><code>Function fun-switch (\n    [switch]$param\n) {\n    If ($param) {\"yes\"} else {\"no\"}\n}\n</code></pre> <p><code>fun-switch -param</code></p>"},{"location":"Syntax/#bit","title":"Bit","text":"<pre><code>\u0414\u0432\u043e\u0438\u0447\u043d\u043e\u0435    \u0414\u0435\u0441\u044f\u0442\u0438\u0447\u043d\u043e\u0435\n1           1\n10          2\n11          3\n100         4\n101         5\n110         6\n111         7\n1000        8\n1001        9\n1010        10\n1011        11\n1100        12\n1101        13\n1110        14\n1111        15\n1 0000      16\n\n\u0414\u0432\u043e\u0438\u0447\u043d\u043e\u0435    \u0414\u0435\u0441\u044f\u0442\u0438\u0447\u043d\u043e\u0435  \u041d\u043e\u043c\u0435\u0440 \u0440\u0430\u0437\u0440\u044f\u0434\u0430\n1           1           0\n10          2           1\n100         4           2\n1000        8           3\n1 0000      16          4\n10 0000     32          5\n100 0000    64          6\n1000 0000   128         7\n1 0000 0000 256         8\n\n\u0418\u0437 \u0434\u0432\u043e\u0438\u0447\u043d\u043e\u0433\u043e =&gt; \u0434\u0435\u0441\u044f\u0442\u0438\u0447\u043d\u043e\u0435 (1-\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u043e \u0442\u0430\u0431\u043b\u0438\u0446\u0435)\n1001 0011 = 1000 0000 + 1 0000 + 10 + 1 = 128 + 16 + 2 + 1 = 147\n\n2-\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\n7654 3210 (\u0440\u0430\u0437\u0440\u044f\u0434\u044b \u0434\u0432\u043e\u0438\u0447\u043d\u043e\u0433\u043e \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f) = (1*2^7)+(0*2^6)+(0*2^5)+(1*2^4)+(0*2^3)+(0*2^2)+(1*2^1)+(1*2^0) = 147\n[math]::Pow(2,7) + [math]::Pow(2,4) + [math]::Pow(2,1) + [math]::Pow(2,0) = 147` \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c 0 \u0438 \u0441\u043b\u043e\u0436\u0438\u0442\u044c \u0441\u0442\u0435\u043f\u0435\u043d\u044c\n\n\u0418\u0437 \u0434\u0435\u0441\u044f\u0442\u0438\u0447\u043d\u043e\u0433\u043e =&gt; \u0434\u0432\u043e\u0438\u0447\u043d\u043e\u0435 (1-\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u043e \u0442\u0430\u0431\u043b\u0438\u0446\u0435)\n347 \u0432\u044b\u0447\u0435\u0441\u0442\u044c \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0438\u0435 256 = 91 (+ 1 0000 0000 \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u0434\u0432\u043e\u0438\u0447\u043d\u044b\u0439 \u043e\u0441\u0442\u0430\u0442\u043e\u043a)\n91  - 64  = 27 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 16 (+ 100 0000)\n27  - 16  = 11 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 8 (+ 1 0000)\n11  - 8   = 3  \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 2 (+ 1000)\n3   - 2   = 1 (+ 10)\n1   - 1   = 0 (+ 1)\n1 0101 1011\n\n2-\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\n\u041f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0447\u0438\u0441\u043b\u0430 \u043d\u0430 2, \u043f\u0440\u0435\u0434\u0432\u043e\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0437\u0430\u0431\u0438\u0440\u0430\u044f \u043e\u0441\u0442\u0430\u0442\u043e\u043a \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0447\u0435\u0442\u043d\u043e\u0433\u043e \u0447\u0438\u0441\u043b\u0430 \u0432 \u043c\u0435\u043d\u044c\u0448\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u043d\u0443\n347 - 346 = \u043e\u0441\u0442\u0430\u0442\u043e\u043a 1, (347-1)/2 = 173\n173 - 172 = \u043e\u0441\u0442\u0430\u0442\u043e\u043a 1, (172-1)/2 = 86\n86  - 86  = \u043e\u0441\u0442\u0430\u0442\u043e\u043a 0, 86/2 = 43\n43  - 42  = \u043e\u0441\u0442\u0430\u0442\u043e\u043a 1, (43-1)/2 = 21\n21  - 20  = \u043e\u0441\u0442\u0430\u0442\u043e\u043a 1, (21-1)/2 = 10\n10  - 10  = \u043e\u0441\u0442\u0430\u0442\u043e\u043a 0, 10/2 = 5\n5   - 4   = \u043e\u0441\u0442\u0430\u0442\u043e\u043a 1, (5-1)/2 = 2\n2   - 2   = \u043e\u0441\u0442\u0430\u0442\u043e\u043a 0, 2/2 = 1\n1   - 2   = \u043e\u0441\u0442\u0430\u0442\u043e\u043a 1, (1-1)/2 = 0\n\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0441\u043d\u0438\u0437\u0443 \u0432\u0432\u0435\u0440\u0445\n</code></pre>"},{"location":"Syntax/#bit-convertor","title":"Bit Convertor","text":"<pre><code>function ConvertTo-Bit {\n    param (\n        [Int]$int\n    )\n    [array]$bits = @()\n    $test = $true\n    while ($test -eq $true) {\n        if (($int/2).GetType() -match [double]) {\n            $int = ($int-1)/2\n            [array]$bits += 1\n        }\n        elseif (($int/2).GetType() -match [int]) {\n            $int = $int/2\n            [array]$bits += 0\n        }\n        if ($int -eq 0) {\n            $test = $false\n        }\n    }\n    $bits =  $bits[-1..-999]\n    ([string]($bits)) -replace \"\\s\"\n}\n</code></pre> <p><code>ConvertTo-Bit 347</code></p> <pre><code>function ConvertFrom-Bit {\n    param (\n        $bit\n    )\n    [int]$int = 0\n    $bits = $bit.ToString().ToCharArray()\n    $index = ($bits.Count)-1\n    foreach ($b in $bits) {\n        if ($b -notlike 0) {\n            $int += [math]::Pow(2,$index)\n        }\n    $index -= 1\n    }\n    $int\n}\n</code></pre> <p><code>ConvertFrom-Bit 10010011</code></p> <p><code>Get-Process pwsh | fl ProcessorAffinity</code> \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u043a \u044f\u0434\u0440\u0430\u043c, \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0438\u0437 \u0441\u0435\u0431\u044f \u0431\u0438\u0442\u043e\u0432\u0443\u044e \u043c\u0430\u0441\u043a\u0443 (bitmask), \u0433\u0434\u0435 \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u0431\u0438\u0442\u0443 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u044f\u0434\u0440\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430. \u0415\u0441\u043b\u0438 \u0434\u043b\u044f \u044f\u0434\u0440\u0430 \u043e\u0442\u043c\u0435\u0447\u0435\u043d\u043e \u0441\u0445\u043e\u0434\u0441\u0442\u0432\u043e (affinity), \u0442\u043e \u0431\u0438\u0442 \u0432\u044b\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432 1, \u0435\u0441\u043b\u0438 \u043d\u0435\u0442 \u2014 \u0442\u043e \u0432 0. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0435\u0441\u043b\u0438 \u0432\u044b\u0431\u0440\u0430\u043d\u044b \u0432\u0441\u0435 16 \u044f\u0434\u0435\u0440, \u0442\u043e \u044d\u0442\u043e 1111 1111 1111 1111 \u0438\u043b\u0438 65535.  <code>$(Get-Process pwsh).ProcessorAffinity = 15</code> 0000000000001111 \u043f\u0440\u0438\u0441\u0432\u043e\u0438\u0442\u044c 4 \u043f\u0435\u0440\u0432\u044b\u0445 \u044f\u0434\u0440\u0430  <code>$(Get-Process pwsh).ProcessorAffinity = 61440</code> 1111000000000000 \u043f\u0440\u0438\u0441\u0432\u043e\u0438\u0442\u044c 4 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 \u044f\u0434\u0440\u0430  <code>$(Get-Process pwsh).ProcessorAffinity = (ConvertFrom-Bit 1111000000000000)</code></p>"},{"location":"Syntax/#cycle","title":"Cycle","text":""},{"location":"Syntax/#foreach","title":"Foreach","text":"<p><code>$list = 100..110</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043c\u0430\u0441\u0441\u0438\u0432 \u0438\u0437 \u0446\u0438\u0444\u0440 \u043e\u0442 100 \u0434\u043e 110  <code>foreach ($srv in $list) {ping 192.168.3.$srv -n 1 -w 50}</code> $srv \u0445\u0440\u0430\u043d\u0438\u0442 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u0438\u0437 $list \u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0434\u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0435  <code>$foreach.Current</code> \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u0432 \u0446\u0438\u043a\u043b\u0435  <code>$foreach.Reset()</code> \u043e\u0431\u043d\u0443\u043b\u044f\u0435\u0442 \u0438\u0442\u0435\u0440\u0430\u0446\u0438\u044e, \u043f\u0435\u0440\u0435\u0431\u043e\u0440 \u043d\u0430\u0447\u043d\u0435\u0442\u0441\u044f \u0437\u0430\u043d\u043e\u0432\u043e, \u0447\u0442\u043e \u043f\u0440\u0438\u0432\u043e\u0434\u0438\u0442 \u043a \u0431\u0435\u0441\u043a\u043e\u043d\u0435\u0447\u043d\u043e\u043c\u0443 \u0446\u0438\u043a\u043b\u0443  <code>$foreach.MoveNext()</code> \u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u043a \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c\u0443 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0443 \u0432 \u0446\u0438\u043a\u043b\u0435</p>"},{"location":"Syntax/#foreach-object","title":"ForEach-Object (%)","text":"<pre><code>100..110 | %{\n    ping -n 1 -w 50 192.168.3.$_ &gt; $null\n    if ($LastExitCode -eq 0) {\n        Write-Host \"192.168.3.$_\" -ForegroundColor green\n    } else {\n    Write-Host \"192.168.3.$_\"-ForegroundColor Red\n    }\n}\n</code></pre> <p><code>%</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0446\u0438\u043a\u043b \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043d\u0432\u0435\u0435\u0440 (ForEach-Object)  <code>$_</code> \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f \u0446\u0438\u043a\u043b\u0430 \u0438 \u043a\u043e\u043d\u0432\u0435\u0435\u0440\u0430 ($PSItem)  <code>gwmi Win32_QuickFixEngineering | where {$_.InstalledOn.ToString() -match \"2022\"} | %{($_.HotFixID.Substring(2))}</code> gwmi \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043c\u0430\u0441\u0441\u0438\u0432, \u0432\u044b\u0432\u043e\u0434 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u0442\u0441\u044f where \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043f\u043e\u0434 \u043a\u0440\u0438\u0442\u0435\u0440\u0438\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432. \u041f\u043e \u043a\u043e\u043d\u0432\u0435\u0435\u0440\u0443 \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u0442\u0441\u044f \u0432 \u0446\u0438\u043a\u043b \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043f\u0435\u0440\u0432\u044b\u0445 (2) \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u043c\u0435\u0442\u043e\u0434\u043e\u043c Substring \u0438\u0437 \u0432\u0441\u0435\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 HotFixID.</p>"},{"location":"Syntax/#while","title":"While","text":"<pre><code>$srv = \"yandex.ru\"\n$out2 = \"\u0415\u0441\u0442\u044c \u043f\u0438\u043d\u0433\"\n$out3 = \"\u041d\u0435\u0442 \u043f\u0438\u043d\u0433\u0430\"\n$out = $false # \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0441\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e, While \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0443\u0441\u043b\u043e\u0432\u0438\u0435 \u0434\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0446\u0438\u043a\u043b\u0430\nWhile ($out -eq $false) { # \u043f\u043e\u043a\u0430 \u0443\u0441\u043b\u043e\u0432\u0438\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f $true, \u0446\u0438\u043a\u043b \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0442\u044c\u0441\u044f\n    $out = ping -n 1 -w 50 $srv\n    if ($out -match \"ttl\") {$out = $true; $out2} else {$out = $false; $out3; sleep 1}\n}\n\nwhile ($True) { # \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0431\u0435\u0441\u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0439 \u0446\u0438\u043a\u043b\n    $result = ping yandex.ru -n 1 -w 50\n    if ($result -match \"TTL\") { # \u0443\u0441\u043b\u043e\u0432\u0438\u0435, \u043f\u0440\u0438 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d break\n        Write-Host \"\u0421\u0430\u0439\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d\"\n        break # \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442 \u0446\u0438\u043a\u043b\n    } else {\n        Write-Host \"\u0421\u0430\u0439\u0442 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d\"; sleep 1\n    }\n}\n</code></pre>"},{"location":"Syntax/#try-catch-finally","title":"Try-Catch-Finally","text":"<pre><code>Try {$out = pping 192.168.3.1}\nCatch {Write-Warning \"$($error[0])\"} # \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u043e\u0448\u0438\u0431\u043a\u0438 (\u0432\u043c\u0435\u0441\u0442\u043e \u043e\u0448\u0438\u0431\u043a\u0438)\nfinally {$out = \"End\"} # \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0432 \u043a\u043e\u043d\u0446\u0435 \u0432 \u043b\u044e\u0431\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435\n</code></pre>"},{"location":"Syntax/#out-gridview","title":"Out-Gridview","text":"<p><code>Get-Service -cn $srv | Out-GridView -Title \"Service $srv\" -OutputMode Single \u2013PassThru | Restart-Service</code> \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u0441\u043b\u0443\u0436\u0431\u0443</p>"},{"location":"Syntax/#out-file","title":"Out-File","text":"<p><code>Read-Host \u2013AsSecureString | ConvertFrom-SecureString | Out-File \"$env:userprofile\\desktop\\password.txt\"</code> \u043f\u0438\u0441\u0430\u0442\u044c \u0432 \u0444\u0430\u0439\u043b. \u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u0432 \u0444\u043e\u0440\u043c\u0430\u0442 SecureString \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u044f Windows Data Protection API (DPAPI)</p>"},{"location":"Syntax/#get-content-gccattype","title":"Get-Content (gc/cat/type)","text":"<p><code>$password = gc \"$env:userprofile\\desktop\\password.txt\" | ConvertTo-SecureString</code> \u0447\u0438\u0442\u0430\u0442\u044c \u0445\u044d\u0448 \u043f\u0430\u0440\u043e\u043b\u044f \u0438\u0437 \u0444\u0430\u0439\u043b\u0430 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043a\u043b\u044e\u0447\u0435\u0439, \u0445\u0440\u0430\u043d\u044f\u0449\u0438\u0445\u0441\u044f \u0432 \u043f\u0440\u043e\u0444\u0438\u043b\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u043d\u0430 \u0434\u0440\u0443\u0433\u043e\u043c \u043a\u043e\u043f\u044c\u044e\u0442\u0435\u0440\u0435</p>"},{"location":"Syntax/#aes-key","title":"AES Key","text":"<p><code>$AESKey = New-Object Byte[] 32</code> <code>[Security.Cryptography.RNGCryptoServiceProvider]::Create().GetBytes($AESKey)</code> <code>$AESKey | Out-File \"C:\\password.key\"</code> <code>$Cred.Password | ConvertFrom-SecureString -Key (Get-Content \"C:\\password.key\") | Set-Content \"C:\\password.txt\"</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u0432 \u0444\u0430\u0439\u043b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0432\u043d\u0435\u0448\u043d\u0438\u0439 \u043a\u043b\u044e\u0447  <code>$pass = Get-Content \"C:\\password.txt\" | ConvertTo-SecureString -Key (Get-Content \"\\\\Server\\Share\\password.key\")</code> \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u043d\u0430 \u0432\u0442\u043e\u0440\u043e\u043c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0435</p>"},{"location":"Threads/","title":"Threads","text":""},{"location":"Threads/#jobs","title":"Jobs","text":"<p><code>Get-Job</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0437\u0430\u0434\u0430\u0447  <code>Start-Job</code> \u0437\u0430\u043f\u0443\u0441\u043a \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430  <code>Stop-Job</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430  <code>Suspend-Job</code> \u043f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430  <code>Resume-Job</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430  <code>Wait-Job</code> \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0432\u044b\u0432\u043e\u0434\u0430 \u043a\u043e\u043c\u0430\u043d\u0434\u044b  <code>Receive-Job</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430  <code>Remove-Job</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443</p> <pre><code>function Start-PingJob ($Network) {\n    $RNetwork = $Network -replace \"\\.\\d{1,3}$\",\".\"\n    foreach ($4 in 1..254) {\n        $ip = $RNetwork+$4\n        # \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u044f, \u0437\u0430\u0431\u0438\u0440\u0430\u0435\u043c 3-\u044e \u0441\u0442\u0440\u043e\u043a\u0443 \u0432\u044b\u0432\u043e\u0434\u0430 \u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u043a \u0432\u044b\u0432\u043e\u0434\u0443 ip-\u0430\u0434\u0440\u0435\u0441\n        (Start-Job {\"$using:ip : \"+(ping -n 1 -w 50 $using:ip)[2]}) | Out-Null\n    }\n    while ($True) {\n        $status_job = $(Get-Job).State[-1] # \u0437\u0430\u0431\u0438\u0440\u0430\u0435\u043c \u0441\u0442\u0430\u0442\u0443\u0441 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0437\u0430\u0434\u0430\u043d\u0438\u044f (\u0437\u0430\u0434\u0430\u043d\u0438\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0442\u0441\u044f \u043f\u043e \u043e\u0447\u0435\u0440\u0435\u0434\u0438 \u0441\u0432\u0435\u0440\u0445\u0443 \u0432\u043d\u0438\u0437)\n        if ($status_job -like \"Completed\") { # \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u043d\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\n            $ping_out = Get-Job | Receive-Job # \u0435\u0441\u043b\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e, \u0437\u0430\u0431\u0438\u0440\u0430\u0435\u043c \u0432\u044b\u0432\u043e\u0434 \u0432\u0441\u0435\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439\n            Get-Job | Remove-Job -Force # \u0443\u0434\u0430\u043b\u044f\u0435\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u044f\n            break # \u0437\u0430\u0432\u0435\u0440\u0448\u0430\u0435\u043c \u0446\u0438\u043a\u043b\n        }\n    }\n    $ping_out\n}\n</code></pre> <p><code>Start-PingJob -Network 192.168.3.0</code> <code>$(Measure-Command {Start-PingJob -Network 192.168.3.0}).TotalSeconds</code> 60 Seconds</p>"},{"location":"Threads/#threadjob","title":"ThreadJob","text":"<p><code>Install-Module -Name ThreadJob</code> <code>Get-Module ThreadJob -list</code> <code>Start-ThreadJob {ping ya.ru} | Out-Null</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0444\u043e\u043d\u043e\u0432\u0443\u044e \u0437\u0430\u0434\u0430\u0447\u0443  <code>Get-Job | Receive-Job -Keep</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0438 \u043d\u0435 \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u0432\u044b\u0432\u043e\u0434  <code>(Get-Job).HasMoreData</code> \u0435\u0441\u043b\u0438 False, \u0442\u043e \u0432\u044b\u0432\u043e\u0434 \u043a\u043e\u043c\u0430\u043d\u044b \u0443\u0434\u0430\u043b\u0435\u043d  <code>(Get-Job)[-1].Output</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0437\u0430\u0434\u0430\u0447\u0438</p> <pre><code>function Start-PingThreadJob ($Network) {\n    $RNetwork = $Network -replace \"\\.\\d{1,3}$\",\".\"\n    foreach ($4 in 1..254) {\n        $ip = $RNetwork+$4\n        $(Start-ThreadJob {\n            \"$using:ip : \" + $(ping -n 1 -w 50 $using:ip)[2]\n        }) | Out-Null\n    }\n    while ($True) {\n        $status_job = $(Get-Job).State[-1]\n        if ($status_job -like \"Completed\") {\n            $ping_out = Get-Job | Receive-Job\n            Get-Job | Remove-Job -Force\n            break\n        }\n    }\n    $ping_out\n}\n</code></pre> <p><code>Start-PingThreadJob -Network 192.168.3.0</code> <code>$(Measure-Command {Start-PingThread -Network 192.168.3.0}).TotalSeconds</code> 24 Seconds</p>"},{"location":"Threads/#poshrsjob","title":"PoshRSJob","text":"<p>Install-Module -Name PoshRSJob</p> <pre><code>function Start-PingRSJob ($Network) {\n    $RNetwork = $Network -replace \"\\.\\d{1,3}$\",\".\"\n    foreach ($4 in 1..254) {\n        $ip = $RNetwork+$4\n        $(Start-RSJob {\n            \"$using:ip : \" + $(ping -n 1 -w 50 $using:ip)[2]\n        }) | Out-Null\n    }\n    while ($True) {\n        $status_job = $(Get-RSJob).State -notcontains \"Running\" # \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c, \u0447\u0442\u043e \u043c\u0430\u0441\u0441\u0438\u0432 \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439\n        if ($status_job) {\n            $ping_out = Get-RSJob | Receive-RSJob\n            Get-RSJob | Remove-RSJob\n            break\n        }\n    }\n    $ping_out\n}\n</code></pre> <p><code>Start-PingRSJob -Network 192.168.3.0</code> <code>$(Measure-Command {Start-PingRSJob -Network 192.168.3.0}).TotalSeconds</code> 10 Seconds</p>"},{"location":"Threads/#parallel","title":"Parallel","text":"<pre><code># Import function from GitHub to current session\n$module = \"https://raw.githubusercontent.com/RamblingCookieMonster/Invoke-Parallel/master/Invoke-Parallel/Invoke-Parallel.ps1\"\nInvoke-Expression $(Invoke-RestMethod $module)\n</code></pre> <p>Get-Help Invoke-Parallel -Full</p> <pre><code>function Start-PingInvokeParallel ($Network) {\n    $RNetwork = $Network -replace \"\\.\\d{1,3}$\",\".\"\n    1..254 | ForEach-Object {$srvList += @($RNetwork+$_)}\n    Invoke-Parallel -InputObject $srvList -ScriptBlock {\n        \"$_ : \" + $(ping -n 1 -w 50 $_)[2]\n    }\n}\n</code></pre> <p><code>Start-PingInvokeParallel -Network 192.168.3.0</code> <code>$(Get-History)[-1].Duration.TotalSeconds</code> 7 seconds</p> <pre><code>$array_main  = 1..10 | ForEach-Object {\"192.168.3.$_\"}\nInvoke-Parallel -InputObject $(0..$($array_main.Count-1)) -ScriptBlock {\n    Foreach ($n in 1..100) {\n        Start-Sleep -Milliseconds 100\n        Write-Progress -Activity $($array_main[$_]) -PercentComplete $n -id $_\n    }\n} -ImportVariables\n</code></pre>"},{"location":"Threads/#foreach-object-parallel","title":"ForEach-Object-Parallel","text":"<pre><code>function Start-PingParallel ($Network) {\n    $RNetwork = $Network -replace \"\\.\\d{1,3}$\",\".\"\n    1..254 | ForEach-Object -Parallel {\n        \"$using:RNetwork.$_ : \" + $(ping -n 1 -w 50 \"$using:RNetwork$_\")[2]\n    } -ThrottleLimit 254\n}\n</code></pre> <p><code>Start-PingParallel -Network 192.168.3.0</code> <code>$(Get-History)[-1].Duration.TotalSeconds</code> 2 seconds</p> <pre><code>function Start-TestConnectParallel (\n        $Network,\n        [switch]$Csv\n    ) {\n    $RNetwork = $Network -replace \"\\.\\d{1,3}$\",\".\"\n    if ($csv) {\n        \"Address,Status,Latency\"\n    }\n    1..254 | ForEach-Object -Parallel {\n        $test = Test-Connection \"$using:RNetwork$_\" -Count 1 -TimeoutSeconds 1\n        if ($using:csv) {\n            \"$($using:RNetwork)$_,$($test.Status),$($test.Latency)\"\n        } else {\n            $test\n        }\n    } -ThrottleLimit 254\n}\n</code></pre> <p><code>Start-TestConnectParallel -Network 192.168.3.0 -Csv | ConvertFrom-Csv</code> <code>$(Get-History)[-1].Duration.TotalSeconds</code> 3 seconds</p> <pre><code>$array_main  = 1..10 | ForEach-Object {\"192.168.3.$_\"}\n$(0..$($array_main.Count-1)) | ForEach-Object -Parallel {\n    Foreach ($n in 1..100) {\n        Start-Sleep -Milliseconds 100\n        $array_temp = $using:array_main\n        Write-Progress -Activity $($array_temp[$_]) -PercentComplete $n -id $_\n    }\n} -ThrottleLimit $($array_main.Count)\n</code></pre>"},{"location":"Virtualization/","title":"Virtualization","text":""},{"location":"Virtualization/#vmwarepowercli","title":"VMWare/PowerCLI","text":"<p><code>Install-Module -Name VMware.PowerCLI # -AllowClobber</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c (PackageProvider: nuget)  <code>Get-Module -ListAvailable VMware* | Select Name,Version</code> <code>Import-Module VMware.VimAutomation.Core</code> \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0441\u0435\u0441\u0441\u0438\u044e  <code>Get-PSProvider | format-list Name,PSSnapIn,ModuleName</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043e\u0441\u043d\u0430\u0441\u0442\u043e\u043a Windows PowerShell</p> <p><code>Get-PowerCLIConfiguration</code> \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f  <code>Set-PowerCLIConfiguration -Scope AllUsers -InvalidCertificateAction ignore -confirm:$false</code> e\u0441\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u0430\u043c\u043e\u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442, \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 InvalidCertificateAction \u0441 Unset \u043d\u0430 Ignore/Warn  <code>Set-PowerCLIConfiguration -Scope AllUsers -ParticipateInCeip $false</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435 \u0441\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0447\u0435\u0440\u0435\u0437 VMware Customer Experience Improvement Program (CEIP)</p> <p><code>Read-Host \u2013AsSecureString | ConvertFrom-SecureString | Out-File \"$home\\Documents\\vcsa_password.txt\"</code> \u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432 \u0444\u0430\u0439\u043b  <code>$esxi = \"vcsa.domain.local\"</code> <code>$user = \"administrator@vsphere.local\"</code> <code>$pass = Get-Content \"$home\\Documents\\vcsa_password.txt\" | ConvertTo-SecureString</code> \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c  <code>$pass = \"password\"</code> <code>$Cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $user ,$pass</code> <code>Connect-VIServer $esxi -User $Cred.Username -Password $Cred.GetNetworkCredential().password</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f PSCredential ($Cred)  <code>Connect-VIServer $esxi -User $user -Password $pass</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043b\u043e\u0433\u0438\u043d \u0438 \u043f\u0430\u0440\u043e\u043b\u044c</p> <p><code>Get-Command \u2013Module *vmware*</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u0430\u043d\u0434 \u043c\u043e\u0434\u0443\u043b\u044f VMware  <code>Get-Command \u2013Module *vmware* -name *get*iscsi*</code> \u043d\u0430\u0439\u0442\u0438 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043c\u043e\u0434\u0443\u043b\u044f VMware, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0441 iSCSI  <code>Get-IScsiHbaTarget</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0446\u0435\u043b\u0438 iSCSI HBA (Host Bus Adapter)  <code>Get-Datacenter</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u0430\u0442\u0430\u0446\u0435\u043d\u0442\u0440\u043e\u0432 \u0432 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0435 VMware  <code>Get-Cluster</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u043e\u0432  <code>Get-VMHost</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0445\u043e\u0441\u0442\u043e\u0432 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d (ESXi \u0445\u043e\u0441\u0442\u043e\u0432)  <code>Get-VMHost | Select-Object Name,Model,ProcessorType,MaxEVCMode,NumCpu,CpuTotalMhz,CpuUsageMhz,MemoryTotalGB,MemoryUsageGB</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0445\u043e\u0441\u0442\u0430\u0445 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0438\u043c\u044f, \u043c\u043e\u0434\u0435\u043b\u044c, \u0442\u0438\u043f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430 \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432  <code>Get-VMHostDisk | Select-Object VMHost,ScsiLun,TotalSectors</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0434\u0438\u0441\u043a\u0430\u0445 \u0445\u043e\u0441\u0442\u043e\u0432 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0445\u043e\u0441\u0442, SCSI LUN \u0438 \u043e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0435\u043a\u0442\u043e\u0440\u043e\u0432</p> <p><code>Get-Datastore</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449 \u0434\u0430\u043d\u043d\u044b\u0445  <code>Get-Datastore TNAS-vmfs-4tb-01</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u0438\u043c\u0435\u043d\u0435\u043c TNAS-vmfs-4tb-01  <code>Get-Datastore TNAS-vmfs-4tb-01 | get-vm</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0434\u0430\u043d\u043d\u044b\u0445  <code>Get-Datastore -RelatedObject vm-01</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430\u0445 \u0434\u0430\u043d\u043d\u044b\u0445, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u043e\u0439  <code>$(Get-Datastore TNAS-vmfs-4tb-01).ExtensionData.Info.GetType()</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u0438\u043f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0434\u0430\u043d\u043d\u044b\u0445  <code>$(Get-Datastore TNAS-vmfs-4tb-01).ExtensionData.Info.Vmfs.Extent</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0442\u043e\u043c, \u043d\u0430 \u043a\u0430\u043a\u0438\u0445 \u0434\u0438\u0441\u043a\u0430\u0445 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0434\u0430\u043d\u043d\u044b\u0445</p> <p><code>Get-Command \u2013Module *vmware* -name *disk*</code> \u043d\u0430\u0439\u0442\u0438 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043c\u043e\u0434\u0443\u043b\u044f VMware, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0441 \u0434\u0438\u0441\u043a\u0430\u043c\u0438  <code>Get-VM vm-01 | Get-Datastore</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430\u0445 \u0434\u0430\u043d\u043d\u044b\u0445, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u043e\u0439  <code>Get-VM vm-01 | Get-HardDisk</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u0434\u0438\u0441\u043a\u0430\u0445 \u043a \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b  <code>Get-VM | Get-HardDisk | select Parent,Name,CapacityGB,StorageFormat,FileName | ft</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0434\u0438\u0441\u043a\u0430\u0445 \u0432\u0441\u0435\u0445 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u0443\u044e \u0412\u041c, \u0438\u043c\u044f, \u0435\u043c\u043a\u043e\u0441\u0442\u044c, \u0444\u043e\u0440\u043c\u0430\u0442 \u0438 \u0438\u043c\u044f \u0444\u0430\u0439\u043b\u0430  <code>Copy-HardDisk</code> \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0436\u0435\u0441\u0442\u043a\u0438\u0439 \u0434\u0438\u0441\u043a \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b  <code>Get-VM | Get-Snapshot</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0441\u043d\u0438\u043c\u043a\u043e\u0432 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d  <code>Get-VM | where {$_.Powerstate -eq \"PoweredOn\"}</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0445 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d  <code>Get-VMHost esxi-05 | Get-VM | where {$_.Powerstate -eq \"PoweredOff\"} | Move-VM \u2013Destination (Get-VMHost esxi-06)</code> \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0432\u0441\u0435 \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0435 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b \u0441 \u0445\u043e\u0441\u0442\u0430 esxi-05 \u043d\u0430 \u0445\u043e\u0441\u0442 esxi-06</p> <pre><code>Get-VM | select Name,VMHost,PowerState,NumCpu,MemoryGB,\n@{Name=\"UsedSpaceGB\"; Expression={[int32]($_.UsedSpaceGB)}},\n@{Name=\"ProvisionedSpaceGB\"; Expression={[int32]($_.ProvisionedSpaceGB)}},\nCreateDate,CpuHotAddEnabled,MemoryHotAddEnabled,CpuHotRemoveEnabled,Notes\n</code></pre> <p><code>Get-VMGuest vm-01 | Update-Tools</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c VMware Tools \u043d\u0430 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 vm-01  <code>Get-VMGuest vm-01 | select OSFullName,IPAddress,HostName,State,Disks,Nics,ToolsVersion</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0433\u043e\u0441\u0442\u0435\u0432\u043e\u0439 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b vm-01 (\u0438\u043c\u044f \u041e\u0421, IP-\u0430\u0434\u0440\u0435\u0441, \u0438\u043c\u044f \u0445\u043e\u0441\u0442\u0430, \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435, \u0434\u0438\u0441\u043a\u0438, \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u044b \u0438 \u0432\u0435\u0440\u0441\u0438\u044e VMware Tools)  <code>Get-VMGuest * | select -ExpandProperty IPAddress</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c IP-\u0430\u0434\u0440\u0435\u0441\u0430 \u0432\u0441\u0435\u0445 \u0433\u043e\u0441\u0442\u0435\u0432\u044b\u0445 \u041e\u0421 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d  <code>Restart-VMGuest -vm vm-01 -Confirm:$False</code> \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0433\u043e\u0441\u0442\u0435\u0432\u0443\u044e \u041e\u0421 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b \u0431\u0435\u0437 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f  <code>Start-VM -vm vm-01 -Confirm:$False</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 \u0431\u0435\u0437 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f  <code>Shutdown-VMGuest -vm vm-01 -Confirm:$false</code> \u0432\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c</p> <p><code>New-VM \u2013Name vm-01 -VMHost esxi-06 \u2013ResourcePool Production \u2013DiskGB 60 \u2013DiskStorageFormat Thin \u2013Datastore TNAS-vmfs-4tb-01</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 vm-01 \u043d\u0430 \u0445\u043e\u0441\u0442\u0435 esxi-06 \u0432 \u043f\u0443\u043b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 Production \u0441 \u0434\u0438\u0441\u043a\u043e\u043c 60 \u0413\u0411 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 Thin \u0438 \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u0435\u043c \u043d\u0430 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 TNAS-vmfs-4tb-01</p> <p><code>Get-VM vm-01 | Copy-VMGuestFile -Source \"\\\\$srv\\Install\\Soft\\Btest.exe\" -Destination \"C:\\Install\\\" -LocalToGuest -GuestUser USER -GuestPassword PASS -force</code> \u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0444\u0430\u0439\u043b \u0441 \u0445\u043e\u0441\u0442\u0430 \u043d\u0430 \u0433\u043e\u0441\u0442\u0435\u0432\u0443\u044e \u041e\u0421 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b vm-01 \u0441 \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\u043c</p> <p><code>Get-VM -name vm-01 | Export-VApp -Destination C:\\Install -Format OVF</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 vm-01 \u0432 \u0448\u0430\u0431\u043b\u043e\u043d OVF (.ovf, .vmdk, .mf)  <code>Get-VM -name vm-01 | Export-VApp -Destination C:\\Install -Format OVA</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 vm-01 \u0432 \u0448\u0430\u0431\u043b\u043e\u043d OVA</p> <p><code>Get-VMHostNetworkAdapter | select VMHost,Name,Mac,IP,@{Label=\"Port Group\"; Expression={$_.ExtensionData.Portgroup}} | ft</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0430\u0445 \u0445\u043e\u0441\u0442\u043e\u0432 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0445\u043e\u0441\u0442, \u0438\u043c\u044f, MAC-\u0430\u0434\u0440\u0435\u0441, IP-\u0430\u0434\u0440\u0435\u0441 \u0438 \u043f\u043e\u0440\u0442\u043e\u0432\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443  <code>Get-VM | Get-NetworkAdapter | select Parent,Name,Id,Type,MacAddress,ConnectionState,WakeOnLanEnabled | ft</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u0430\u0445 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u0443\u044e \u0412\u041c, \u0438\u043c\u044f, \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440, \u0442\u0438\u043f, MAC-\u0430\u0434\u0440\u0435\u0441, \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0443 Wake-on-LAN</p> <p><code>Get-Command \u2013Module *vmware* -name *event*</code> <code>Get-VIEvent -MaxSamples 1000 | where {($_.FullFormattedMessage -match \"power\")} | select username,CreatedTime,FullFormattedMessage</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 1000 \u0441\u043e\u0431\u044b\u0442\u0438\u0439, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 \u043f\u0438\u0442\u0430\u043d\u0438\u0435\u043c, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0432\u0440\u0435\u043c\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0438 \u043f\u043e\u043b\u043d\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435  <code>Get-logtype | select Key,SourceEntityId,Filename,Creator,Info</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0442\u0438\u043f\u0430\u0445 \u043b\u043e\u0433\u043e\u0432  <code>$(Get-Log vpxd:vpxd.log).Entries | select -Last 50</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 50 \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u0438\u0437 \u043b\u043e\u0433\u0430 vpxd</p> <p><code>Get-Command \u2013Module *vmware* -name *syslog*</code> <code>Set-VMHostSysLogServer -VMHost esxi-05 -SysLogServer \"tcp://192.168.3.100\" -SysLogServerPort 3515</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440 syslog \u0441\u0435\u0440\u0432\u0435\u0440 \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u043b\u043e\u0433\u043e\u0432 \u0434\u043b\u044f \u0445\u043e\u0441\u0442\u0430 esxi-05  <code>Get-VMHostSysLogServer -VMHost esxi-05</code></p>"},{"location":"Virtualization/#hyper-v","title":"Hyper-V","text":"<p><code>Install-WindowsFeature -Name Hyper-V -IncludeManagementTools -Restart</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u043e\u043b\u044c \u043d\u0430 Windows Server  <code>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V \u2013All</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u043e\u043b\u044c \u043d\u0430 Windows Desktop  <code>Get-Command -Module hyper-v</code> <code>Get-VMHost</code></p> <pre><code>New-VMSwitch -name NAT -SwitchType Internal # \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043c\u043c\u0443\u0442\u0430\u0442\u043e\u0440 \u0438 \u0430\u0434\u0430\u043f\u0442\u0435\u0440 \u0434\u043b\u044f \u043d\u0435\u0433\u043e\nGet-NetAdapter | where InterfaceDescription -match Hyper-V # \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u043e\u0432\nNew-NetNat -Name LocalNat -InternalIPInterfaceAddressPrefix \"192.168.3.0/24\" # \u0437\u0430\u0434\u0430\u0442\u044c \u0441\u0435\u0442\u044c\nGet-NetAdapter \"vEthernet (NAT)\" | New-NetIPAddress -IPAddress 192.168.3.200 -AddressFamily IPv4 -PrefixLength 24 # \u043f\u0440\u0438\u0441\u0432\u043e\u0438\u0442\u044c \u0430\u0434\u0440\u0435\u0441, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043d\u0430 \u0412\u041c \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0448\u043b\u044e\u0437 192.168.3.200, \u0447\u0442\u043e \u0431\u044b \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0437\u0430 NAT, \u0438\u043b\u0438 \u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0412\u041c \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\nAdd-NetNatStaticMapping -NatName LocalNat -Protocol TCP -ExternalIPAddress 0.0.0.0 -ExternalPort 2222 -InternalIPAddress 192.168.3.103 -InternalPort 2121 # \u043f\u0440\u043e\u0431\u0440\u043e\u0441, \u0432\u0435\u0441\u0442 \u0442\u0440\u0430\u0444\u0438\u043a \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u0438\u0445\u043e\u0434\u0438\u0442 \u043d\u0430 \u0445\u043e\u0441\u0442 Hyper-V TCP/2222, \u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c\u0441\u044f \u043d\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u043f\u043e\u0440\u0442 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b \u0437\u0430 NAT.\n(Get-NetAdapter | where Name -match NAT).Status\n</code></pre> <p><code>Get-NetNatStaticMapping</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u0440\u043e\u0441\u044b (NAT)  <code>Get-NetNat</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0442\u0435\u0439  <code>Remove-NetNatStaticMapping -StaticMappingID 0</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u0440\u043e\u0441  <code>Remove-NetNat -Name LocalNat</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0435\u0442\u044c</p> <p><code>New-VMSwitch -Name Local -AllowManagementOS $True -NetAdapterName \"Ethernet 4\" -SwitchType External</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0448\u0435\u043d\u0438\u0439 (External) \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043c\u043c\u0443\u0442\u0430\u0442\u043e\u0440 </p> <pre><code>$VMName = \"hv-dc-01\"\n$VM = @{\n    Name = $VMName\n    MemoryStartupBytes = 4Gb\n    Generation = 2\n    NewVHDPath = \"D:\\VM\\$VMName\\$VMName.vhdx\"\n    NewVHDSizeBytes = 50Gb\n    BootDevice = \"VHD\"\n    Path = \"D:\\VM\\$VMName\"\n    SwitchName = \"NAT\"\n}\n</code></pre> <p><code>New-VM @VM</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438</p> <p><code>Set-VMDvdDrive -VMName $VMName -Path \"C:\\Users\\Lifailon\\Documents\\WS-2016.iso\"</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0437  <code>New-VHD -Path \"D:\\VM\\$VMName\\disk_d.vhdx\" -SizeBytes 10GB</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c VHDX \u0434\u0438\u0441\u043a  <code>Add-VMHardDiskDrive -VMName $VMName -Path \"D:\\VM\\$VMName\\disk_d.vhdx\"</code> \u043f\u0440\u0438\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0438\u0441\u043a  <code>Get-VM \u2013VMname $VMName | Set-VM \u2013AutomaticStartAction Start</code> \u0430\u0432\u0442\u043e\u0437\u0430\u043f\u0443\u0441\u043a  <code>Get-VM -Name $VMName | Set-VMMemory -StartupBytes 8Gb</code> \u043d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u0441\u0442\u0430\u0440\u0442\u043e\u0432\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435  <code>Set-VMProcessor $VMName -Count 2</code> \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043e\u0432 (vCPU: \u044f\u0434\u0435\u0440/\u043f\u043e\u0442\u043e\u043a\u043e\u0432)  <code>Set-VMProcessor $VMName -Count 2 -Maximum 4 -Reserve 50 -RelativeWeight 200</code> \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u044b\u0434\u0435\u043b\u044f\u0435\u043c\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043e\u0432, \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044f 50% \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430 \u0445\u043e\u0441\u0442\u0430 \u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0432\u0435\u0441 200 \u0434\u043b\u044f \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u0440\u0443\u0433\u0438\u0445 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d  <code>Get-VM -Name $VMName | Checkpoint-VM -SnapshotName \"Snapshot-1\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u043d\u0430\u043f\u0448\u043e\u0442  <code>Restore-VMCheckpoint -Name \"Snapshot-1\" -VMName $VMName -Confirm:$false</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0438\u0437 \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u0430  <code>Get-VM | Select -ExpandProperty NetworkAdapters | Select VMName,IPAddresses,Status</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c IP \u0430\u0434\u0440\u0435\u0441 \u0432\u0441\u0435\u0445 \u0412\u041c</p>"},{"location":"Virtualization/#vmconnect-via-rdcman","title":"VMConnect via RDCMan","text":"<p><code>vmconnect.exe localhost $VMHost</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 \u0447\u0435\u0440\u0435\u0437 VMConnect (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0432 \u0434\u0438\u0441\u043f\u0435\u0442\u0447\u0435\u0440\u0435 Hyper-V)  <code>Get-NetTCPConnection -State Established,Listen | Where-Object LocalPort -Match 2179</code> \u043d\u0430\u0439\u0442\u0438 \u043f\u043e\u0440\u0442 \u0441\u043b\u0443\u0448\u0430\u0442\u0435\u043b\u044f <code>Get-Process -Id (Get-NetTCPConnection -State Established,Listen | Where-Object LocalPort -Match 2179).OwningProcess</code> \u043d\u0430\u0439\u0442\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u043e ID (vmms/VMConnect)  <code>New-NetFirewallRule -Name \"Hyper-V\" -DisplayName \"Hyper-V\" -Group \"Hyper-V\" -Direction Inbound -Protocol TCP -LocalPort 2179 -Action Allow -Profile Public</code> \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u0440\u0442 \u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u043c Firewall  <code>Get-LocalGroupMember -Group \"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u044b Hyper-V\"</code> <code>Get-LocalGroupMember -Group \"Hyper-V Administrators\"</code> <code>Add-LocalGroupMember -Group \"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u044b Hyper-V\" -Member \"lifailon\"</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0433\u0440\u0443\u043f\u043f\u0443 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u043e\u0432 (\u0434\u043b\u044f \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f)  <code>Get-VM * | Select-Object Name,Id</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c id \u0432 RDCMan \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f  <code>Grant-VMConnectAccess -ComputerName plex-01 -VMName hv-devops-01 -UserName lifailon</code> \u0434\u0430\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043d\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043d\u0435 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0443  <code>Get-VMConnectAccess</code> <code>Revoke-VMConnectAccess -VMName hv-devops-01 -UserName lifailon</code> \u0437\u0430\u0431\u0440\u0430\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f</p> <p>Error: <code>Unknown disconnection reason 3848</code> - \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043b\u044e\u0447\u0438 \u0440\u0435\u0435\u0441\u0442\u0440\u0430 \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430</p> <pre><code>New-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Credssp\\PolicyDefaults\\AllowFreshCredentialsDomain -Name Hyper-V -PropertyType String -Value \"Microsoft Virtual Console Service/*\" -Force\nNew-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Credssp\\PolicyDefaults\\AllowDefaultCredentials -Name Hyper-V -PropertyType String -Value \"Microsoft Virtual Console Service/*\" -Force\nNew-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Credssp\\PolicyDefaults\\AllowFreshCredentialsWhenNTLMOnlyDomain -Name Hyper-V -PropertyType String -Value \"Microsoft Virtual Console Service/*\" -Force\nItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Credssp\\PolicyDefaults\\AllowDefaultCredentialsDomain -Name Hyper-V -PropertyType String -Value \"Microsoft Virtual Console Service/*\" -Force\nNew-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Credssp\\PolicyDefaults\\AllowFreshCredentials -Name Hyper-V -PropertyType String -Value \"Microsoft Virtual Console Service/*\" -Force\nNew-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Credssp\\PolicyDefaults\\AllowFreshCredentialsWhenNTLMOnly -Name Hyper-V -PropertyType String -Value \"Microsoft Virtual Console Service/*\" -Force\nNew-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Credssp\\PolicyDefaults\\AllowSavedCredentialsWhenNTLMOnly -Name Hyper-V -PropertyType String -Value \"Microsoft Virtual Console Service/*\" -Force\nNew-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Credssp\\PolicyDefaults\\AllowSavedCredentials -Name Hyper-V -PropertyType String -Value \"Microsoft Virtual Console Service/*\" -Force\nNew-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Credssp\\PolicyDefaults\\AllowSavedCredentialsDomain -Name Hyper-V -PropertyType String -Value \"Microsoft Virtual Console Service/*\" -Force\n</code></pre>"},{"location":"Virtualization/#azure","title":"Azure","text":"<p><code>Install-Module -Name Az -Scope CurrentUser -Repository PSGallery -Force</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0441\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 Azure  <code>Get-Module *Az.*</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043c\u043e\u0434\u0443\u043b\u0435\u0439</p> <p><code>Get-Command -Module Az.Accounts</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u0430\u043d\u0434 \u043c\u043e\u0434\u0443\u043b\u044f Az.Accounts  <code>Connect-AzAccount</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u0443 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 Azure  <code>Get-AzContext</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0441\u0442\u0430\u0442\u0443\u0441 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a Azure  <code>Get-AzSubscription</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u0434\u043f\u0438\u0441\u043e\u043a Azure, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0434\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Set-AzContext</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 Azure \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0438 \u0438/\u0438\u043b\u0438 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438  <code>Disconnect-AzAccount</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043e\u0442 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 Azure</p> <p><code>Get-Command -Module Az.Compute</code> <code>Get-AzVM</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0435 \u0438\u043b\u0438 \u0433\u0440\u0443\u043f\u043f\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432  <code>Get-AzVMSize</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u0432 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u0432 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u043c \u0440\u0435\u0433\u0438\u043e\u043d\u0435  <code>Get-AzVMImage</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u043e\u0431\u0440\u0430\u0437\u043e\u0432 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d  <code>New-AzVM</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443  <code>Remove-AzVM</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443  <code>Start-AzVM</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443  <code>Stop-AzVM</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443  <code>Restart-AzVM</code> \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443</p> <p><code>Get-Command -Module Az.Network</code> <code>Get-AzVirtualNetwork</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u0441\u0435\u0442\u0435\u0439 \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0435 \u0438\u043b\u0438 \u0433\u0440\u0443\u043f\u043f\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432  <code>New-AzVirtualNetwork</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0435\u0442\u044c  <code>Remove-AzVirtualNetwork</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0435\u0442\u044c  <code>Get-AzNetworkInterface</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432  <code>New-AzNetworkInterface</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441  <code>Remove-AzNetworkInterface</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441</p> <p><code>Get-Command -Module Az.Storage</code> <code>Get-AzStorageAccount</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430  <code>New-AzStorageAccount</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0443\u0447\u0435\u0442\u043d\u0443\u044e \u0437\u0430\u043f\u0438\u0441\u044c \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430  <code>Remove-AzStorageAccount</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0443\u0447\u0435\u0442\u043d\u0443\u044e \u0437\u0430\u043f\u0438\u0441\u044c \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430  <code>Get-AzStorageContainer</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 \u0432 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430  <code>New-AzStorageContainer</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0432 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430  <code>Remove-AzStorageContainer</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440</p> <p><code>Get-Command -Module Az.ResourceManager</code> <code>Get-AzResourceGroup</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0435  <code>New-AzResourceGroup</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432  <code>Remove-AzResourceGroup</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432  <code>Get-AzResource</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432  <code>New-AzResource</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0440\u0435\u0441\u0443\u0440\u0441  <code>Remove-AzResource</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0440\u0435\u0441\u0443\u0440\u0441</p> <p><code>Get-Command -Module Az.KeyVault</code> <code>Get-AzKeyVault</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449 \u043a\u043b\u044e\u0447\u0435\u0439  <code>New-AzKeyVault</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u043e\u0435 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u043a\u043b\u044e\u0447\u0435\u0439 \u0432 Azure  <code>Remove-AzKeyVault</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u043a\u043b\u044e\u0447\u0435\u0439 \u0432 Azure</p> <p><code>Get-Command -Module Az.Identity</code> <code>Get-AzADUser</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u0445 Azure Active Directory  <code>New-AzADUser</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Remove-AzADUser</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Get-AzADGroup</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0433\u0440\u0443\u043f\u043f\u0430\u0445  <code>New-AzADGroup</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443  <code>Remove-AzADGroup</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443</p>"},{"location":"Virtualization/#manage-vm","title":"Manage-VM","text":"<p>Source: https://learn.microsoft.com/ru-ru/azure/virtual-machines/windows/tutorial-manage-vm</p> <p><code>New-AzResourceGroup -Name \"Resource-Group-01\" -Location \"EastUS\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 (\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 Azure)  <code>Get-AzVMImageOffer -Location \"EastUS\" -PublisherName \"MicrosoftWindowsServer\"</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u043e\u0431\u0440\u0430\u0437\u043e\u0432 Windows Server \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438  <code>$cred = Get-Credential</code> <code>New-AzVm -ResourceGroupName \"Resource-Group-01\" -Name \"vm-01\" -Location 'EastUS' -Image \"MicrosoftWindowsServer:WindowsServer:2022-datacenter-azure-edition:latest\" -Size \"Standard_D2s_v3\" -OpenPorts 80,3389 --Credential $cred</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443  <code>Get-AzVM -ResourceGroupName \"Resource-Group-01\" -Name \"vm-01\" -Status | Select @{n=\"Status\"; e={$_.Statuses[1].Code}}</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b  <code>Start-AzVM -ResourceGroupName \"Resource-Group-01\" -Name \"vm-01\"</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443  <code>Stop-AzVM -ResourceGroupName \"Resource-Group-01\" -Name \"vm-01\" -Force</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443  <code>Invoke-AzVMRunCommand -ResourceGroupName \"Resource-Group-01\" -VMName \"vm-01\" -CommandId \"RunPowerShellScript\" -ScriptString \"Install-WindowsFeature -Name Web-Server -IncludeManagementTools\"</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u043e\u043b\u044c \u0432\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440\u0430 IIS</p>"},{"location":"Virtualization/#manage-disk","title":"Manage-Disk","text":"<p>Source: https://learn.microsoft.com/ru-ru/azure/virtual-machines/windows/tutorial-manage-data-disk</p> <p><code>$diskConfig = New-AzDiskConfig -Location \"EastUS\" -CreateOption Empty -DiskSizeGB 512 -SkuName \"Standard_LRS\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0438\u0441\u043a \u043d\u0430 512 \u0413\u0431  <code>$dataDisk = New-AzDisk -ResourceGroupName \"Resource-Group-01\" -DiskName \"disk-512\" -Disk $diskConfig</code> \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0434\u0438\u0441\u043a\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438 \u0434\u0438\u0441\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a \u0440\u0430\u0431\u043e\u0442\u0435  <code>Get-AzDisk -ResourceGroupName \"Resource-Group-01\" -DiskName \"disk-512\"</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u0438\u0441\u043a\u043e\u0432  <code>$vm = Get-AzVM -ResourceGroupName \"Resource-Group-01\" -Name \"vm-01\"</code> <code>Add-AzVMDataDisk -VM $vm -Name \"Resource-Group-01\" -CreateOption Attach -ManagedDiskId $dataDisk.Id -Lun 1</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0434\u0438\u0441\u043a \u043a \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435  <code>Update-AzVM -ResourceGroupName \"Resource-Group-01\" -VM $vm</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b  <code>Get-Disk | Where PartitionStyle -eq 'raw' | Initialize-Disk -PartitionStyle MBR -PassThru | New-Partition -AssignDriveLetter -UseMaximumSize | Format-Volume -FileSystem NTFS -NewFileSystemLabel \"disk-512\" -Confirm:$false</code> \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0438\u0441\u043a \u0432 \u041e\u0421 (\u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435) \u0441 \u0442\u0430\u0431\u043b\u0438\u0446\u0435\u0439 MBR, \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0440\u0430\u0437\u0434\u0435\u043b \u0438 \u043d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u0432\u0441\u0435 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e \u0438 \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0444\u0430\u0439\u043b\u043e\u0432\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443 NTFS</p>"},{"location":"Windows/","title":"Windows","text":""},{"location":"Windows/#windows-event","title":"Windows Event","text":"<p><code>Get-WinEvent -ListLog *</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u044b \u043b\u043e\u0433\u043e\u0432  <code>Get-WinEvent -ListLog * | where RecordCount -ne 0 | where RecordCount -ne $null | sort -Descending RecordCount</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043d\u0435 \u043f\u0443\u0441\u0442\u044b\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u044b \u0441 \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u043e\u0439 \u043f\u043e \u043a\u043e\u043b-\u0432\u0443 \u0437\u0430\u043f\u0438\u0441\u0435\u0439  <code>Get-WinEvent -ListProvider * | ft</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435\u0445 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439  <code>Get-WinEvent -ListProvider GroupPolicy</code> \u043d\u0430\u0439\u0442\u0438 \u0432 \u043a\u0430\u043a\u043e\u0439 \u0436\u0443\u0440\u043d\u0430\u043b LogLinks {Application} \u043f\u0438\u0448\u0443\u0442\u0441\u044f \u043b\u043e\u0433\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f  <code>Get-WinEvent -ListProvider *smb*</code> <code>Get-WinEvent -ListLog * | where logname -match SMB | sort -Descending RecordCount</code> \u043d\u0430\u0439\u0442\u0438 \u0432\u0441\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u044b \u043f\u043e \u0438\u043c\u0435\u043d\u0438  <code>Get-WinEvent -LogName \"Microsoft-Windows-SmbClient/Connectivity\"</code> <code>Get-WinEvent -ListProvider *firewall*</code></p>"},{"location":"Windows/#filter-xpathhashtable","title":"Filter XPath/Hashtable","text":"<p><code>Get-WinEvent -FilterHashtable @{LogName=\"Security\";ID=4624}</code> \u043d\u0430\u0439\u0442\u0438 \u043b\u043e\u0433\u0438 \u043f\u043e ID \u0432 \u0436\u0443\u0440\u043d\u0430\u043b\u0435 Security  <code>Get-WinEvent -FilterHashtable @{LogName=\"System\";Level=2}</code> \u043d\u0430\u0439\u0442\u0438 \u0432\u0441\u0435 \u0437\u0430\u043f\u0438\u0441\u0438 \u043e\u0448\u0438\u0431\u043a\u0438 (1 - \u043a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439, 3 - \u043f\u0440\u0435\u0434\u0443\u043f\u0440\u0435\u0436\u0434\u0435\u043d\u0438\u0435, 4 - \u0441\u0432\u0435\u0434\u0435\u043d\u0438\u044f)  <code>Get-WinEvent -FilterHashtable @{LogName=\"System\";Level=2;ProviderName=\"Service Control Manager\"}</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430</p> <p><code>([xml](Get-WinEvent -FilterHashtable @{LogName=\"Security\";ID=4688} -MaxEvents 1).ToXml()).Event.EventData.Data</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430, \u0445\u0440\u0430\u043d\u0438\u043c\u044b\u0435 \u0432 EventData (Message)  <code>Get-WinEvent -FilterHashtable @{logname=\"security\";ID=4688} -MaxEvents 1 | select timecreated,{$_.Properties[5].value}</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0438 \u0438\u043c\u044f \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430</p> <pre><code>$query = '\n&lt;QueryList&gt;\n    &lt;Query Id=\"0\" Path=\"Security\"&gt;\n        &lt;Select Path=\"Security\"&gt;\n            *[System[EventID=4688]] and \n            *[EventData[Data[@Name=\"NewProcessName\"]=\"C:\\Windows\\System32\\autochk.exe\" or Data[@Name=\"NewProcessName\"]=\"C:\\Windows\\System32\\services.exe\"]]\n        &lt;/Select&gt;\n    &lt;/Query&gt;\n&lt;/QueryList&gt;\n'\n\nGet-WinEvent -LogName Security -FilterXPath $query\n</code></pre>"},{"location":"Windows/#reboot","title":"Reboot","text":"<pre><code>$query = '\n&lt;QueryList&gt;\n    &lt;Query Id=\"0\" Path=\"System\"&gt;\n        &lt;Select Path=\"System\"&gt;\n            *[\n            System[\n            EventID=41 or\n            EventID=1074 or\n            EventID=1076 or\n            EventID=6005 or\n            EventID=6006 or\n            EventID=6008 or\n            EventID=6009 or\n            EventID=6013\n            ]\n            ]\n        &lt;/Select&gt;\n    &lt;/Query&gt;\n&lt;/QueryList&gt;\n'\nGet-WinEvent -LogName System -FilterXPath $query\n\n41  ` \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0431\u044b\u043b\u0430 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u0430 \u0431\u0435\u0437 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442\u044b.\n1074` \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0431\u044b\u043b\u0430 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c \u0438\u043b\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c.\n1076` \u0421\u043b\u0435\u0434\u0443\u0435\u0442 \u0437\u0430 Event ID 6008 \u0438 \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442, \u0447\u0442\u043e \u043f\u0435\u0440\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c (\u0441 \u043f\u0440\u0430\u0432\u043e\u043c \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b) \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0432\u0448\u0438\u0439\u0441\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u043f\u043e\u0441\u043b\u0435 \u043d\u0435\u043e\u0436\u0438\u0434\u0430\u043d\u043d\u043e\u0439 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438\u043b\u0438 \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u0443\u043a\u0430\u0437\u0430\u043b \u043f\u0440\u0438\u0447\u0438\u043d\u0443 \u044d\u0442\u043e\u0433\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u044f.\n6005` \u0417\u0430\u043f\u0443\u0441\u043a \"\u0416\u0443\u0440\u043d\u0430\u043b\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 Windows\" (Event Log). \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043d\u0430 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.\n6006` \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u00ab\u0416\u0443\u0440\u043d\u0430\u043b\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 Windows\u00bb. \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043d\u0430 \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.\n6008` \u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0435 \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0431\u044b\u043b\u043e \u043d\u0435\u043e\u0436\u0438\u0434\u0430\u043d\u043d\u044b\u043c.\n6009` \u0412\u0435\u0440\u0441\u0438\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b, \u0437\u0430\u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.\n6013` \u0412\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441\u0438\u0441\u0442\u0435\u043c\u044b (system uptime) \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445.\n</code></pre>"},{"location":"Windows/#logon","title":"Logon","text":"<pre><code>$srv = \"localhost\"\n$FilterXPath = '&lt;QueryList&gt;&lt;Query Id=\"0\"&gt;&lt;Select&gt;*[System[EventID=21]]&lt;/Select&gt;&lt;/Query&gt;&lt;/QueryList&gt;'\n$RDPAuths = Get-WinEvent -ComputerName $srv -LogName \"Microsoft-Windows-TerminalServices-LocalSessionManager/Operational\" -FilterXPath $FilterXPath\n[xml[]]$xml = $RDPAuths | Foreach {$_.ToXml()}\n$EventData = Foreach ($event in $xml.Event) {\n    New-Object PSObject -Property @{\n        \"Connection Time\" = (Get-Date ($event.System.TimeCreated.SystemTime) -Format 'yyyy-MM-dd hh:mm K')\n        \"User Name\" = $event.UserData.EventXML.User\n        \"User ID\" = $event.UserData.EventXML.SessionID\n        \"User Address\" = $event.UserData.EventXML.Address\n        \"Event ID\" = $event.System.EventID\n    }\n}\n$EventData | ft\n</code></pre>"},{"location":"Windows/#eventlog","title":"EventLog","text":"<p><code>Get-EventLog -List</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043a\u043e\u0440\u043d\u0435\u0432\u044b\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u044b \u043b\u043e\u0433\u043e\u0432 \u0438 \u0438\u0445 \u0440\u0430\u0437\u043c\u0435\u0440  <code>Clear-EventLog Application</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043b\u043e\u0433\u0438 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0436\u0443\u0440\u043d\u0430\u043b\u0430  <code>Get-EventLog -LogName Security -InstanceId 4624</code> \u043d\u0430\u0439\u0442\u0438 \u043b\u043e\u0433\u0438 \u043f\u043e ID \u0432 \u0436\u0443\u0440\u043d\u0430\u043b\u0435 Security</p>"},{"location":"Windows/#performance","title":"Performance","text":"<p><code>lodctr /R</code> \u043f\u0435\u0440\u0435\u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u043e\u0432 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u0433\u043e \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0430\u0440\u0445\u0438\u0432\u043e\u0432 (\u0442\u0430\u043a \u0436\u0435 \u0438\u0441\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0438 \u0434\u043b\u044f CIM, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0434\u043b\u044f cpu Win32_PerfFormattedData_PerfOS_Processor \u0438 iops Win32_PerfFormattedData_PerfDisk_PhysicalDisk)  <code>(Get-Counter -ListSet *).CounterSetName</code> \u0432\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u043e\u0432 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435  <code>(Get-Counter -ListSet *memory*).Counter</code> \u043f\u043e\u0438\u0441\u043a \u043f\u043e wildcard-\u0438\u043c\u0435\u043d\u0438 \u0432\u043e \u0432\u0441\u0435\u0445 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0430\u0445 (\u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0438)  <code>Get-Counter \"\\Memory\\Available MBytes\"</code> \u043e\u0431\u044a\u0435\u043c \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0439 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438  <code>Get-Counter -cn $srv \"\\LogicalDisk(*)\\% Free Space\"</code> % \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0433\u043e \u043c\u0435\u0441\u0442\u0430 \u043d\u0430 \u0432\u0441\u0435\u0445 \u0440\u0430\u0437\u0434\u0435\u043b\u0430\u0445 \u0434\u0438\u0441\u043a\u043e\u0432  <code>(Get-Counter \"\\Process(*)\\ID Process\").CounterSamples</code> <code>Get-Counter \"\\Processor(_Total)\\% Processor Time\" \u2013ComputerName $srv -MaxSamples 5 -SampleInterval 2</code> 5 \u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a \u043a\u0430\u0436\u0434\u044b\u0435 2 \u0441\u0435\u043a\u0443\u043d\u0434\u044b  <code>Get-Counter \"\\\u041f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440(_Total)\\% \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430\" -Continuous</code> \u043d\u0435\u043f\u0440\u0435\u0440\u044b\u0432\u043d\u043e  <code>(Get-Counter \"\\\u041f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440(*)\\% \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430\").CounterSamples</code></p> <p><code>(Get-Counter -ListSet *\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441*).Counter</code> \u043d\u0430\u0439\u0442\u0438 \u0432\u0441\u0435 \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0438  <code>Get-Counter \"\\\u0421\u0435\u0442\u0435\u0432\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441(*)\\\u0412\u0441\u0435\u0433\u043e \u0431\u0430\u0439\u0442/\u0441\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u0430\u0434\u0430\u043f\u0442\u0435\u0440\u044b (\u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u043f\u043e \u0442\u0440\u0430\u0444\u0438\u043a\u0443)</p> <pre><code>$WARNING = 25\n$CRITICAL = 50\n$TransferRate = ((Get-Counter \"\\\\huawei-mb-x-pro\\\u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441(intel[r] wi-fi 6e ax211 160mhz)\\\u0432\u0441\u0435\u0433\u043e \u0431\u0430\u0439\u0442/\u0441\"\n).countersamples | select -ExpandProperty CookedValue)*8\n$NetworkUtilisation = [math]::round($TransferRate/1000000000*100,2)\nif ($NetworkUtilisation -gt $CRITICAL){\nWrite-Output \"CRITICAL: $($NetworkUtilisation) % Network utilisation, $($TransferRate.ToString('N0')) b/s\"   \n#exit 2     \n}\nif ($NetworkUtilisation -gt $WARNING){\nWrite-Output \"WARNING: $($NetworkUtilisation) % Network utilisation, $($TransferRate.ToString('N0')) b/s\"\n#exit 1\n}\nWrite-Output \"OK: $($NetworkUtilisation) % Network utilisation, $($TransferRate.ToString('N0')) b/s\"   \n#exit 0\n</code></pre>"},{"location":"Windows/#defender","title":"Defender","text":"<p><code>Import-Module Defender</code> <code>Get-Command -Module Defender</code> <code>Get-MpComputerStatus</code> <code>(Get-MpComputerStatus).AntivirusEnabled</code> \u0441\u0442\u0430\u0442\u0443\u0441 \u0440\u0430\u0431\u043e\u0442\u044b \u0430\u043d\u0442\u0438\u0432\u0438\u0440\u0443\u0441\u0430</p> <p><code>$session = NewCimSession -ComputerName hostname</code> \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c\u0443 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0443, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f WinRM  <code>Get-MpComputerStatus -CimSession $session | fl fullscan*</code> \u0443\u0437\u043d\u0430\u0442\u044c \u0434\u0430\u0442\u0443 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0435</p> <p><code>Get-MpPreference</code> \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438  <code>(Get-MpPreference).ScanPurgeItemsAfterDelay</code> \u0432\u0440\u0435\u043c\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u0436\u0443\u0440\u043d\u0430\u043b\u0430 \u0437\u0430\u0449\u0438\u0442\u043d\u0438\u043a\u0430 \u0432 \u0434\u043d\u044f\u0445  <code>Set-MpPreference -ScanPurgeItemsAfterDelay 30</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f  <code>ls \"C:\\ProgramData\\Microsoft\\Windows Defender\\Scans\\History\"</code> <code>Get-MpPreference | select disable*</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0432\u0441\u0435\u0445 \u0432\u0438\u0434\u043e\u0432 \u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a/\u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439  <code>Set-MpPreference -DisableRealtimeMonitoring $true</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0437\u0430\u0449\u0438\u0442\u0443 Defender \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438 (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0440\u0443\u0447\u043d\u043e\u0435 \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435)  <code>Set-MpPreference -DisableRemovableDriveScanning $false</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 USB \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u0435\u0439  <code>Get-MpPreference | select excl*</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439  <code>(Get-MpPreference).ExclusionPath</code> <code>Add-MpPreference -ExclusionPath C:\\install</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u0432 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435  <code>Remove-MpPreference -ExclusionPath C:\\install</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f  <code>New-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force</code> \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c Windows Defender</p> <p><code>Set-MpPreference -SignatureDefinitionUpdateFileSharesSources \\\\FileShare1\\Updates</code> \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0438\u0437 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u043f\u0430\u043f\u043a\u0438 \u043d\u0443\u0436\u043d\u043e \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0444\u0430\u0439\u043b\u044b \u0441 \u0441\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u0430\u043c\u0438 \u0431\u0430\u0437 \u0441 \u0441\u0430\u0439\u0442\u0430 https://www.microsoft.com/security/portal/definitions/adl.aspx \u0438 \u043f\u043e\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0432 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 <code>Update-MpSignature -UpdateSource FileShares</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 (MicrosoftUpdateServer \u2013 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 MS \u0432 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0435, InternalDefinitionUpdateServer \u2014 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 WSUS \u0441\u0435\u0440\u0432\u0435\u0440)  <code>Update-MpSignature</code> \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u044b</p> <p><code>Start-MpScan -ScanType QuickScan</code> \u0431\u044b\u0441\u0442\u0440\u0430\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0438\u043b\u0438 FullScan  <code>Start-MpScan -ScanType FullScan -AsJob</code> <code>Set-MpPreference -RemediationScheduleDay 1-7</code> \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u043d\u0438, \u043d\u0430\u0447\u0438\u043d\u0430\u044f \u0441 \u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u044f \u0438\u043b\u0438 0 \u043a\u0430\u0436\u0434\u044b\u0439 \u0434\u0435\u043d\u044c, 8 - \u0441\u0431\u0440\u043e\u0441\u0438\u0442\u044c  <code>Set-MpPreference -ScanScheduleQuickScanTime 14:00:00</code> <code>Start-MpScan -ScanType CustomScan -ScanPath \"C:\\Program Files\"</code> \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e</p> <p><code>Get-MpThreat</code> \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u0443\u0433\u0440\u043e\u0437 \u0438 \u0442\u0438\u043f \u0443\u0433\u0440\u043e\u0437\u044b (ThreatName: HackTool/Trojan)  <code>Get-MpThreatCatalog</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0445 \u0432\u0438\u0434\u043e\u0432 \u0443\u0433\u0440\u043e\u0437  <code>Get-MpThreatDetection</code> \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u0449\u0438\u0442\u044b (\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0438 \u043f\u0440\u043e\u0448\u043b\u044b\u0435) \u0438 ID \u0443\u0433\u0440\u043e\u0437\u044b  <code>Get-MpThreat -ThreatID 2147760253</code></p> <p><code>ls \"C:\\ProgramData\\Microsoft\\Windows Defender\\Quarantine\\\"</code> \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0432 \u043a\u0430\u0440\u0430\u043d\u0442\u0438\u043d\u0435  <code>cd \"C:\\Program Files\\Windows Defender\\\"</code> <code>.\\MpCmdRun.exe -restore -name $ThreatName</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0444\u0430\u0439\u043b \u0438\u0437 \u043a\u0430\u0440\u0430\u043d\u0442\u0438\u043d\u0430  <code>.\\MpCmdRun.exe -restore -filepath $path_file</code></p>"},{"location":"Windows/#dism","title":"DISM","text":"<p><code>Get-Command -Module Dism -Name *Driver*</code> <code>Export-WindowsDriver -Online -Destination C:\\Users\\Lifailon\\Documents\\Drivers\\</code> \u0438\u0437\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u0435 \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u043e\u0432 \u0438\u0437 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b (C:\\Windows\\System32\\DriverStore\\FileRepository), \u0432\u044b\u0433\u0440\u0443\u0436\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u0430\u0439\u043b\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u0430 (dll,sys,exe) \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441\u043e \u0441\u043f\u0438\u0441\u043a\u043e\u043c \u0444\u0430\u0439\u043b\u043e\u0432, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 \u0441\u0435\u043a\u0446\u0438\u0438 [CopyFiles] inf-\u0444\u0430\u0439\u043b\u0430 \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u0430.  <code>Export-WindowsDriver -Path C:\\win_image -Destination C:\\drivers</code> \u0438\u0437\u0432\u043b\u0435\u0447\u044c \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u0430 \u0438\u0437 \u043e\u0444\u043b\u0430\u0439\u043d \u043e\u0431\u0440\u0430\u0437\u0430 Windows, \u0441\u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 c:\\win_image  <code>$BackupDrivers = Export-WindowsDriver -Online -Destination C:\\Drivers</code> <code>$BackupDrivers | ft Driver,ClassName,ProviderName,Date,Version,ClassDescription</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u043e\u0432 \u0432 \u043e\u0431\u044a\u0435\u043a\u0442\u043d\u043e\u043c \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0438  <code>$BackupDrivers | where classname -match printer</code> <code>pnputil.exe /add-driver C:\\drivers\\*.inf /subdirs /install</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0441\u0435 (\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 subdirs) \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u0430 \u0438\u0437 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u043f\u0430\u043f\u043a\u0438 (\u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0435)</p> <p><code>sfc /scannow</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u044c \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0443\u0442\u0438\u043b\u0438\u0442\u044b SFC (System File Checker), \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u043f\u043e\u0438\u0441\u043a\u0430 \u043e\u0448\u0438\u0431\u043e\u043a, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0435\u0442 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u0445 \u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043f\u0438\u0438 \u0438\u0437 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 Windows (\u043a\u0430\u0442\u0430\u043b\u043e\u0433 C:\\Windows\\WinSxS). \u0412\u044b\u0432\u043e\u0434 \u0440\u0430\u0431\u043e\u0442\u044b \u043b\u043e\u0433\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432 C:\\Windows\\Logs\\CBS \u0441 \u0442\u0435\u0433\u043e\u043c SR  <code>Get-ComputerInfo | select *</code> \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0438\u0441\u0442\u0435\u043c\u0435 (WindowsVersion,WindowsEditionId,Bios)  <code>Get-WindowsImage -ImagePath E:\\sources\\install.wim</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0432\u0435\u0440\u0441\u0438\u0439 \u0432 \u043e\u0431\u0440\u0430\u0437\u0435  <code>Repair-WindowsImage -Online \u2013ScanHealth</code> <code>Repair-WindowsImage -Online -RestoreHealth</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432  <code>Repair-WindowsImage -Online -RestoreHealth -Source E:\\sources\\install.wim:3 \u2013LimitAccess</code> \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0432 \u043e\u0444\u0444\u043b\u0430\u0439\u043d \u0440\u0435\u0436\u0438\u043c\u0435 \u0438\u0437 \u043e\u0431\u0440\u0430\u0437\u0430 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 \u0438\u043d\u0434\u0435\u043a\u0441\u0430</p>"},{"location":"Windows/#scheduled","title":"Scheduled","text":"<p><code>$Trigger = New-ScheduledTaskTrigger -At 01:00am -Daily</code> 1:00 \u043d\u043e\u0447\u0438  <code>$Trigger = New-ScheduledTaskTrigger \u2013AtLogon</code> \u0437\u0430\u043f\u0443\u0441\u043a \u043f\u0440\u0438 \u0432\u0445\u043e\u0434\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443  <code>$Trigger = New-ScheduledTaskTrigger -AtStartup</code> \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b  <code>$User = \"NT AUTHORITY\\SYSTEM\"</code> <code>$Action = New-ScheduledTaskAction -Execute \"PowerShell.exe\" -Argument \"$home\\Documents\\DNS-Change-Tray-1.3.ps1\"</code> <code>$Action = New-ScheduledTaskAction -Execute \"PowerShell.exe\" -Argument \"-NoProfile -NoLogo -NonInteractive -ExecutionPolicy Unrestricted -WindowStyle Hidden -File $home\\Documents\\DNS-Change-Tray-1.3.ps1\"</code> <code>Register-ScheduledTask -TaskName \"DNS-Change-Tray-Startup\" -Trigger $Trigger -User $User -Action $Action -RunLevel Highest \u2013Force</code></p> <p><code>Get-ScheduledTask | ? state -ne Disabled</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439  <code>Start-ScheduledTask DNS-Change-Tray-Startup</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u043d\u0435\u043c\u0435\u0434\u043b\u0435\u043d\u043d\u043e  <code>Get-ScheduledTask DNS-Change-Tray-Startup | Disable-ScheduledTask</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435  <code>Get-ScheduledTask DNS-Change-Tray-Startup | Enable-ScheduledTask</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435  <code>Unregister-ScheduledTask DNS-Change-Tray-Startup</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435  <code>Export-ScheduledTask DNS-Change-Tray-Startup | Out-File $home\\Desktop\\Task-Export-Startup.xml</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u0432 xml  <code>Register-ScheduledTask -Xml (Get-Content $home\\Desktop\\Task-Export-Startup.xml | Out-String) -TaskName \"DNS-Change-Tray-Startup\"</code></p>"},{"location":"Windows/#localaccounts","title":"LocalAccounts","text":"<p><code>Get-Command -Module Microsoft.PowerShell.LocalAccounts</code> <code>Get-LocalUser</code> \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439  <code>Get-LocalGroup</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f  <code>New-LocalUser \"1C\" -Password $Password -FullName \"1C Domain\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Set-LocalUser -Password $Password 1C</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c  <code>Add-LocalGroupMember -Group \"Administrators\" -Member \"1C\"</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0433\u0440\u0443\u043f\u043f\u0443 \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u043e\u0432  <code>Get-LocalGroupMember \"Administrators\"</code> \u0447\u043b\u0435\u043d\u044b \u0433\u0440\u0443\u043f\u043f\u044b</p> <pre><code>@(\"vproxy-01\",\"vproxy-02\",\"vproxy-03\") | %{\n    icm $_ {Add-LocalGroupMember -Group \"Administrators\" -Member \"support4\"}\n    icm $_ {Get-LocalGroupMember \"Administrators\"}\n}\n</code></pre>"},{"location":"Windows/#credential","title":"Credential","text":"<p><code>$Cred = Get-Credential</code> \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u043a\u0440\u0435\u0434\u044b \u0432 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 <code>$Cred.Username</code> \u0438 <code>$Cred.Password</code> <code>$Cred.GetNetworkCredential().password</code> \u0438\u0437\u0432\u043b\u0435\u0447\u044c \u043f\u0430\u0440\u043e\u043b\u044c  <code>cmdkey /generic:\"TERMSRV/$srv\" /user:\"$username\" /pass:\"$password\"</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u043a\u0440\u0435\u0434\u044b \u0430\u0443\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043d\u0430 \u043d\u0430 \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0431\u0435\u0437 \u043f\u0430\u0440\u043e\u043b\u044f  <code>mstsc /admin /v:$srv</code> \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f  <code>cmdkey /delete:\"TERMSRV/$srv\"</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043a\u0440\u0435\u0434\u044b \u0430\u0443\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b  <code>rundll32.exe keymgr.dll,KRShowKeyMgr</code> \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 Stored User Names and Password  <code>Get-Service VaultSvc</code> \u0441\u043b\u0443\u0436\u0431\u0430 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b Credential Manager  <code>Install-Module CredentialManager</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f Credential Manager \u043a \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0443 PasswordVault \u0438\u0437 PowerShell  <code>[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]'Tls11,Tls12'</code> \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u043a\u0438 \u043c\u043e\u0434\u0443\u043b\u044f  <code>Get-StoredCredential</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0443\u0447\u0435\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 Windows Vault  <code>Get-StrongPassword</code> \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440 \u043f\u0430\u0440\u043e\u043b\u044f  <code>New-StoredCredential -UserName test -Password \"123456\"</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0447\u0435\u0442\u043d\u0443\u044e \u0437\u0430\u043f\u0438\u0441\u044c  <code>Remove-StoredCredential</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0443\u0447\u0435\u0442\u043d\u0443\u044e \u0437\u0430\u043f\u0438\u0441\u044c  <code>$Cred = Get-StoredCredential | where {$_.username -match \"admin\"}</code> <code>$pass = $cred.password</code> <code>$BSTR = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pass)</code> <code>[System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)</code></p>"},{"location":"Windows/#regedit","title":"Regedit","text":"<p><code>Get-PSDrive</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0434\u0438\u0441\u043a\u043e\u0432/\u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432, \u0438\u0445 \u0440\u0430\u0437\u043c\u0435\u0440 \u0438 \u0432\u0435\u0442\u043e\u043a \u0440\u0435\u0435\u0441\u0442\u0440\u0430  <code>cd HKLM:\\</code> HKEY_LOCAL_MACHINE  <code>cd HKCU:\\</code> HKEY_CURRENT_USER  <code>Get-Item</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0432\u0435\u0442\u043a\u0435 \u0440\u0435\u0435\u0441\u0442\u0440\u0430  <code>New-Item</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0440\u0430\u0437\u0434\u0435\u043b \u0440\u0435\u0435\u0441\u0442\u0440\u0430  <code>Remove-Item</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0435\u0442\u043a\u0443 \u0440\u0435\u0435\u0441\u0442\u0440\u0430  <code>Get-ItemProperty</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043a\u043b\u044e\u0447\u0435\u0439/\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0440\u0435\u0435\u0441\u0442\u0440\u0430 (\u044d\u0442\u043e \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430 \u0432\u0435\u0442\u043a\u0438 \u0440\u0435\u0435\u0441\u0442\u0440\u0430, \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430\u043c \u0444\u0430\u0439\u043b\u0430)  <code>Set-ItemProperty</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0438\u043b\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 \u0440\u0435\u0435\u0441\u0442\u0440\u0430  <code>New-ItemProperty</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0440\u0435\u0435\u0441\u0442\u0440\u0430  <code>Remove-ItemProperty</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440</p> <p><code>Get-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select DisplayName</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c  <code>Get-Item HKCU:\\SOFTWARE\\Microsoft\\Office\\16.0\\Outlook\\Profiles\\Outlook\\9375CFF0413111d3B88A00104B2A6676\\00000002</code> \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 Items  <code>(Get-ItemProperty HKCU:\\SOFTWARE\\Microsoft\\Office\\16.0\\Outlook\\Profiles\\Outlook\\9375CFF0413111d3B88A00104B2A6676\\00000002).\"New Signature\"</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 (Value) \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430 (Property) Items  <code>$reg_path = \"HKCU:\\SOFTWARE\\Microsoft\\Office\\16.0\\Outlook\\Profiles\\Outlook\\9375CFF0413111d3B88A00104B2A6676\\00000002\"</code> <code>$sig_name = \"auto\"</code> <code>Set-ItemProperty -Path $reg_path -Name \"New Signature\" -Value $sig_name</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u043b\u0438 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043a\u043e\u0440\u043d\u0435 \u0432\u0435\u0442\u043a\u0438 (Path) \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u043e (Name) \u0441\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\u043c (Value)  <code>Set-ItemProperty -Path $reg_path -Name \"Reply-Forward Signature\" -Value $sig_name</code></p> <pre><code>Windows Registry Editor Version 5.00\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\taskmgr.exe]\n\"Debugger\"=\"\\\"C:\\\\Windows\\\\System32\\\\Taskmgr.exe\\\"\"\n</code></pre>"},{"location":"Windows/#pki","title":"pki","text":"<p><code>New-SelfSignedCertificate -CertStoreLocation Cert:\\LocalMachine\\My -DnsName \"$env:computername\" -FriendlyName \"Test Certificate\" -NotAfter (Get-Date).AddYears(5)</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0430\u043c\u043e\u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 (\u0432 LocalMachine\\My - \u0421\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u044b \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430\\\u041b\u0438\u0447\u043d\u043e\u0435) \u0441 \u0441\u0440\u043e\u043a\u043e\u043c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f 5 \u043b\u0435\u0442</p> <p><code>Get-ChildItem -Path Cert:\\CurrentUser\\Root\\</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u0432 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0414\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u0440\u043d\u0435\u0432\u044b\u0435 \u0426\u0421 \u0422\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Get-ChildItem -Path Cert:\\CurrentUser\\My\\</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0430\u043c\u043e\u0437\u0430\u0432\u0435\u0440\u044f\u044e\u0449\u0438\u0445 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u0432 \u041b\u0438\u0447\u043d\u043e\u0435 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0422\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Get-ChildItem -Path Cert:\\LocalMachine\\My\\</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0430\u043c\u043e\u0437\u0430\u0432\u0435\u0440\u044f\u044e\u0449\u0438\u0445 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u0432 \u041b\u0438\u0447\u043d\u043e\u0435 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u041b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430  <code>Get-ChildItem -Path Cert:\\LocalMachine\\My\\ | select NotBefore,NotAfter,Thumbprint,Subject</code> \u0441\u0440\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430  <code>Get-ChildItem -Path Cert:\\LocalMachine\\My\\ | where Thumbprint -eq D9356FB774EE0E6206B7D5B59B99102CA5B17BDA</code> \u043f\u043e\u0438\u0441\u043a \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043f\u043e \u043e\u0442\u043f\u0435\u0447\u0430\u0442\u043a\u0443</p> <p><code>Get-ChildItem -Path $env:APPDATA\\Microsoft\\SystemCertificates\\My\\Certificates\\</code> \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u044b \u0432 \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435, \u043a\u0430\u0436\u0434\u044b\u0439 \u0444\u0430\u0439\u043b \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0443, \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u043c\u0443 \u0432 \u043b\u0438\u0447\u043d\u043e\u043c \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f  <code>Get-ChildItem -Path $env:APPDATA\\Microsoft\\SystemCertificates\\My\\Keys\\</code> \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0437\u0430\u043a\u0440\u044b\u0442\u044b\u0445 \u043a\u043b\u044e\u0447\u0435\u0439, \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a\u043e\u043c \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u043a\u043b\u044e\u0447\u0435\u0439 (KSP)  <code>Get-ChildItem -Path HKCU:\\Software\\Microsoft\\SystemCertificates\\CA\\Certificates | ft -AutoSize</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u0432 \u0440\u0435\u0435\u0441\u0442\u0440\u0435 \u0432\u043e\u0448\u0435\u0434\u0448\u0435\u0433\u043e \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</p> <p><code>$cert = (Get-ChildItem -Path Cert:\\CurrentUser\\My\\)[1]</code> \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442  <code>$cert | Remove-Item</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442</p> <p><code>Export-Certificate -FilePath $home\\Desktop\\certificate.cer -Cert $cert</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442  <code>$cert.HasPrivateKey</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430  <code>$pass = \"password\" | ConvertTo-SecureString -AsPlainText -Force</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u0434\u043b\u044f \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0437\u0430\u043a\u0440\u044b\u0442\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430  <code>Export-PfxCertificate -FilePath $home\\Desktop\\certificate.pfx -Password $pass -Cert $certificate</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u0441 \u0437\u0430\u043a\u0440\u044b\u0442\u044b\u043c \u043a\u043b\u044e\u0447\u0435\u043c</p> <p><code>Import-Certificate -FilePath $home\\Desktop\\certificate.cer -CertStoreLocation Cert:\\CurrentUser\\My</code> \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442  <code>Import-PfxCertificate -Exportable -Password $pass -CertStoreLocation Cert:\\CurrentUser\\My -FilePath $home\\Desktop\\certificate.pfx</code></p>"},{"location":"Windows/#openssl","title":"OpenSSL","text":"<pre><code>Invoke-WebRequest -Uri https://slproweb.com/download/Win64OpenSSL_Light-3_1_1.msi -OutFile $home\\Downloads\\OpenSSL-Light-3.1.1.msi\nStart-Process $home\\Downloads\\OpenSSL-Light-3.1.1.msi -ArgumentList '/quiet' -Wait` \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c msi \u043f\u0430\u043a\u0435\u0442 \u0432 \u0442\u0438\u0445\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 (\u0437\u0430\u043f\u0443\u0441\u043a \u043e\u0442 \u0438\u043c\u0435\u043d\u0438 \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430)\nrm $home\\Downloads\\OpenSSL-Light-3.1.1.msi\ncd \"C:\\Program Files\\OpenSSL-Win64\\bin\"\n</code></pre> <ul> <li> <p>\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u0434\u043b\u044f PFX  <code>openssl pkcs12 -in \"C:\\Cert\\domain.ru.pfx\" -out \"C:\\Cert\\domain.ru.pem\" -nodes</code> \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u043c \u0438\u043c\u0435\u044e\u0449\u0438\u0439\u0441\u044f \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u044b\u0439 \u043a\u043b\u044e\u0447 \u0432 .pem-\u0444\u0430\u0439\u043b \u0431\u0435\u0437 \u043f\u0430\u0440\u043e\u043b\u044f \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u0430\u0440\u043e\u043b\u044f  <code>openssl pkcs12 -export -in \"C:\\Cert\\domain.ru.pem\" -out \"C:\\Cert\\domain.ru_password.pfx\" -nodes</code> \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u0443\u0435\u043c .pem \u043e\u0431\u0440\u0430\u0442\u043d\u043e \u0432 .pfx c \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u0430\u0440\u043e\u043b\u044f</p> </li> <li> <p>\u041a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f \u0438\u0437 \u0437\u0430\u043a\u0440\u044b\u0442\u043e\u0433\u043e \u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430 PEM \u0432 PFX  <code>openssl pkcs12 -export -in \"C:\\tmp\\vpn\\vpn.itproblog.ru-crt.pem\" -inkey \"C:\\tmp\\vpn\\vpn.itproblog.ru-key.pem\" -out \"C:\\tmp\\vpn\\vpn.iiproblog.ru.pfx\"</code>  in \u2013 \u043f\u0443\u0442\u044c \u0434\u043e \u0444\u0430\u0439\u043b\u0430 \u0441 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u043c \u043a\u043b\u044e\u0447\u043e\u043c  inkey \u2013 \u043f\u0443\u0442\u044c \u0434\u043e \u0444\u0430\u0439\u043b\u0430 \u0441 \u0437\u0430\u043a\u0440\u044b\u0442\u044b\u043c \u043a\u043b\u044e\u0447\u043e\u043c  out \u2013 \u043f\u0443\u0442\u044c \u0434\u043e \u0444\u0430\u0439\u043b\u0430, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u0443\u0434\u0435\u0442 \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 (pfx)</p> </li> <li> <p>\u041a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f PFX \u0432 CRT  <code>openssl pkcs12 -in \"C:\\OpenSSL-Win64\\bin\\_.domain.ru.pfx\" -clcerts -out \"C:\\OpenSSL-Win64\\bin\\_.domain.ru.crt\"</code> \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0438 2 \u0440\u0430\u0437\u0430 \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c PEM pass phrase (\u0444\u0430\u0439\u043b \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 EGIN CERTIFICATE \u0438 BEGIN ENCRYPTED PRIVATE KEY)  <code>openssl pkcs12 -in \"C:\\OpenSSL-Win64\\bin\\_.domain.ru.pfx\" -clcerts -nokeys -out \"C:\\OpenSSL-Win64\\bin\\_.domain.ru.crt\"</code> \u0431\u0435\u0437 \u043a\u043b\u044e\u0447\u0430, \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043e\u0442\u043a\u0440\u044b\u0442\u0443\u044e \u0447\u0430\u0441\u0442\u044c (\u0444\u0430\u0439\u043b \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0442\u043e\u043b\u044c\u043a\u043e EGIN CERTIFICATE)</p> </li> <li> <p>\u041a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u044f PFX \u0432 KEY  <code>openssl pkcs12 -in \"C:\\OpenSSL-Win64\\bin\\_.domain.ru.pfx\" -nocerts -out \"C:\\OpenSSL-Win64\\bin\\_.domain.ru.key\"</code> \u0444\u0430\u0439\u043b \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0442\u043e\u043b\u044c\u043a\u043e BEGIN ENCRYPTED PRIVATE KEY</p> </li> <li> <p>\u0421\u043d\u044f\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c \u043a \u0437\u0430\u043a\u0440\u044b\u0442\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430 .key  <code>openssl rsa -in \"C:\\OpenSSL-Win64\\bin\\_.domain.ru.key\" -out \"C:\\OpenSSL-Win64\\bin\\_.domain.ru-decrypted.key\"</code></p> </li> <li> <p>CRT \u0438 KEY \u0432 PFX:  <code>openssl pkcs12 -inkey certificate.key -in certificate.crt -export -out certificate.pfx</code></p> </li> </ul>"},{"location":"Windows/#wmi","title":"WMI","text":""},{"location":"Windows/#wmicim-windows-management-instrumentationcommon-information-model","title":"WMI/CIM (Windows Management Instrumentation/Common Information Model)","text":"<p><code>Get-WmiObjec -ComputerName localhost -Namespace root -class \"__NAMESPACE\" | select name,__namespace</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0434\u043e\u0447\u0435\u0440\u043d\u0438\u0438 Namespace (\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0438\u0435\u0440\u0430\u0440\u0445\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b)  <code>Get-WmiObject -List</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0430 \u0438\u043c\u0435\u043d \"root\\cimv2\" (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e), \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430 (\u043e\u043f\u0438\u0441\u044b\u0432\u0430\u044e\u0442 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0438 \u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u043e\u0433\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u0430) \u0438 \u0438\u0445 \u043c\u0435\u0442\u043e\u0434\u044b (\u043a\u0430\u043a\u0438\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043d\u0430\u0434 \u044d\u0442\u0438\u043c \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u043c)  <code>Get-WmiObject -List | Where-Object {$_.name -match \"video\"}</code> \u043f\u043e\u0438\u0441\u043a \u043a\u043b\u0430\u0441\u0441\u0430 \u043f\u043e \u0438\u043c\u0435\u043d\u0438, \u0435\u0433\u043e \u0441\u0432\u043e\u0439\u0441\u0442\u0432 \u0438 \u043c\u0435\u0442\u043e\u0434\u043e\u0432  <code>Get-WmiObject -ComputerName localhost -Class Win32_VideoController</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0441\u0432\u043e\u0439\u0441\u0442\u0432 \u043a\u043b\u0430\u0441\u0441\u0430</p> <p><code>gwmi -List | where name -match \"service\" | ft -auto</code> \u0435\u0441\u043b\u0438 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 Methods, \u0442\u043e \u043c\u043e\u0436\u043d\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c {StartService, StopService}  <code>gwmi -Class win32_service | select *</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0441\u043b\u0443\u0436\u0431 \u0438 \u0432\u0441\u0435\u0445 \u0438\u0445 \u0441\u0432\u043e\u0439\u0441\u0442\u0432  <code>Get-CimInstance Win32_service</code> \u043e\u0431\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043f\u0440\u044f\u043c\u0443\u044e \u043a \"root\\cimv2\"  <code>gwmi win32_service -Filter \"name='Zabbix Agent'\"</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043f\u043e \u0438\u043c\u0435\u043d\u0438  <code>(gwmi win32_service -Filter \"name='Zabbix Agent'\").State</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0435 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u043e  <code>gwmi win32_service -Filter \"State = 'Running'\"</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0435 \u0441\u043b\u0443\u0436\u0431\u044b  <code>gwmi win32_service -Filter \"StartMode = 'Auto'\"</code> \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u044b \u043f\u043e \u043c\u0435\u0442\u043e\u0434\u0443 \u0437\u0430\u043f\u0443\u0441\u043a\u0430  <code>gwmi -Query 'select * from win32_service where startmode=\"Auto\"'</code> WQL-\u0437\u0430\u043f\u0440\u043e\u0441 (WMI Query Language)  <code>gwmi win32_service | Get-Member -MemberType Method</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043c\u0435\u0442\u043e\u0434\u044b \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f (Delete, StartService)  <code>(gwmi win32_service -Filter 'name=\"Zabbix Agent\"').Delete()</code> \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443  <code>(gwmi win32_service -Filter 'name=\"MSSQL$MSSQLE\"').StartService()</code> \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443</p> <p><code>Get-CimInstance -ComputerName $srv Win32_OperatingSystem | select LastBootUpTime</code> \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f  <code>gwmi -ComputerName $srv -Class Win32_OperatingSystem | select LocalDateTime,LastBootUpTime</code> \u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0438 \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f  <code>gwmi Win32_OperatingSystem | Get-Member -MemberType Method</code> \u043c\u0435\u0442\u043e\u0434\u044b reboot \u0438 shutdown  <code>(gwmi Win32_OperatingSystem -EnableAllPrivileges).Reboot()</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441 \u043a\u043b\u044e\u0447\u0435\u043c \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u0438\u044f \u043f\u0440\u0438\u0432\u0435\u043b\u0435\u0433\u0438\u0439  <code>(gwmi Win32_OperatingSystem -EnableAllPrivileges).Win32Shutdown(0)</code> \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u0441\u0435\u0430\u043d\u0441\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</p> <pre><code>$system = Get-WmiObject -Class Win32_OperatingSystem\n$InstallDate = [Management.ManagementDateTimeconverter]::ToDateTime($system.installdate)` \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0434\u0430\u0442\u0443 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u041e\u0421\n$AfterInstallDays = ((Get-Date) \u2014 $Installdate).Days` \u0412\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u043c \u0432\u0440\u0435\u043c\u044f, \u043f\u0440\u043e\u0448\u0435\u0434\u0448\u0435\u0435 \u0441 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438\n$ShortInstallDate = \"{0:yyyy-MM-dd HH:MM}\" -f ($InstallDate)\n\"\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0430: $ShortInstallDate (\u041f\u0440\u043e\u0448\u043b\u043e $AfterInstalldays \u0434\u043d\u0435\u0439)\"\n</code></pre> <p><code>(Get-WmiObject win32_battery).estimatedChargeRemaining</code> \u0437\u0430\u0440\u044f\u0434 \u0431\u0430\u0442\u0430\u0440\u0435\u0438 \u0432 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u0430\u0445  <code>gwmi Win32_UserAccount</code> \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438  <code>(gwmi Win32_SystemUsers).PartComponent</code> <code>Get-CimInstance -ClassName Win32_LogonSession</code> <code>Get-CimInstance -ClassName Win32_BIOS</code></p> <p><code>gwmi -list -Namespace root\\CIMV2\\Terminalservices</code> <code>(gwmi -Class Win32_TerminalServiceSetting -Namespace root\\CIMV2\\TerminalServices).AllowTSConnections</code> <code>(gwmi -Class Win32_TerminalServiceSetting -Namespace root\\CIMV2\\TerminalServices).SetAllowTSConnections(1)</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c RDP</p> <pre><code>$srv = \"localhost\"\ngwmi Win32_logicalDisk -ComputerName $srv | where {$_.Size -ne $null} | select @{\nLabel=\"Value\"; Expression={$_.DeviceID}}, @{Label=\"AllSize\"; Expression={\n[string]([int]($_.Size/1Gb))+\" GB\"}},@{Label=\"FreeSize\"; Expression={\n[string]([int]($_.FreeSpace/1Gb))+\" GB\"}}, @{Label=\"Free%\"; Expression={\n[string]([int]($_.FreeSpace/$_.Size*100))+\" %\"}}\n</code></pre>"},{"location":"Windows/#nla-network-level-authentication","title":"NLA (Network Level Authentication)","text":"<p><code>(gwmi -class \"Win32_TSGeneralSetting\" -Namespace root\\cimv2\\Terminalservices -Filter \"TerminalName='RDP-tcp'\").UserAuthenticationRequired</code> <code>(gwmi -class \"Win32_TSGeneralSetting\" -Namespace root\\cimv2\\Terminalservices -Filter \"TerminalName='RDP-tcp'\").SetUserAuthenticationRequired(1)</code> \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c NLA  <code>Get-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" -Name SecurityLayer</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 (2)  <code>Get-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" -Name UserAuthentication</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 (1)  <code>Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" -Name SecurityLayer -Value 0</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435  <code>Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" -Name UserAuthentication -Value 0</code> <code>REG ADD HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\CredSSP\\Parameters /v AllowEncryptionOracle /t REG_DWORD /d 2</code> \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043d\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u043c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u0432\u0435\u0440\u0441\u0438\u0438 CredSSP, \u0435\u0441\u043b\u0438 \u043d\u0430 \u0446\u0435\u043b\u0435\u0432\u043e\u043c \u043a\u043e\u043c\u044c\u044e\u0442\u0435\u0440\u0435-\u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f KB4512509 \u043e\u0442 \u043c\u0430\u044f 2018 \u0433\u043e\u0434\u0430</p>"},{"location":"Windows/#oh-my-posh","title":"oh-my-posh","text":"<p>Install</p> <p><code>winget install JanDeDobbeleer.OhMyPosh -s winget</code> <code>choco install oh-my-posh -y</code> <code>scoop install https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/oh-my-posh.json</code> <code>Set-ExecutionPolicy Bypass -Scope Process -Force; Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://ohmyposh.dev/install.ps1'))</code></p> <p>Themes</p> <p><code>Get-PoshThemes</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0442\u0435\u043c  <code>oh-my-posh init pwsh --config \"$env:POSH_THEMES_PATH/di4am0nd.omp.json\" | Invoke-Expression</code> \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c) \u0442\u0435\u043c\u0443 \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0435\u0441\u0441\u0438\u0438  <code>oh-my-posh init pwsh --config \"https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/cert.omp.json\" | Invoke-Expression</code> \u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0442\u0435\u043c\u0443 \u0438\u0437 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f  <code>New-Item -Path $PROFILE -Type File -Force</code> \u0441\u043e\u0437\u0434\u0430\u0439\u0442 \u0444\u0430\u0439\u043b \u043f\u0440\u043e\u0444\u0438\u043b\u044c\u044f PowerShell  <code>'oh-my-posh init pwsh --config \"$env:POSH_THEMES_PATH/di4am0nd.omp.json\" | Invoke-Expression' &gt; $PROFILE</code> \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0442\u0435\u043c\u0443 \u043f\u0440\u043e\u0444\u0438\u043b\u044f (\u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0442\u044c \u0442\u0435\u043c\u0443 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 PowerShell)</p>"},{"location":"Windows/#themes-performance","title":"themes-performance","text":"<p><code>Install-Module themes-performance -Repository NuGet</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u0441 \u0442\u0435\u043c\u0430\u043c\u0438  <code>Set-PoshTheme -Theme System-Sensors</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043c\u0443 \u0441 \u0434\u0430\u0442\u0447\u0438\u043a\u0430\u043c\u0438 \u0438\u0437 LibreHardwareMonitor  <code>Set-PoshTheme -Theme System-Sensors -Save</code> \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0442\u0435\u043c\u0443 \u0438\u0437 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0442\u0435\u043c\u0443 \u0432 \u043f\u0440\u043e\u0444\u0438\u043b\u0435  <code>Set-PoshTheme -Theme System-Performance</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u043c\u0443 \u0441 \u0434\u0430\u0442\u0447\u0438\u043a\u0430\u043c\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b, \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c\u044b\u043c\u0438 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b WMI/CIM (\u0437\u0430\u0440\u044f\u0434 \u0431\u0430\u0442\u0430\u0440\u0435\u0438 \u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0430 | \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 CPU \u0432 % | \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u043f\u0435\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438 | \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430)  <code>Set-PoshTheme -Theme System-Performance -Save</code> <code>Set-PoshTheme -Theme Pwsh-Process-Performance</code> \u0432\u0440\u0435\u043c\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 pwsh (\u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f), \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0445/\u043e\u0431\u0449\u0435\u0435 (\u0441\u0442\u0430\u0442\u0443\u0441 \u0443\u0441\u043f\u0435\u0445/\u043e\u0448\u0438\u0431\u043a\u0430) \u0444\u043e\u043d\u043e\u0432\u044b\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439, Working Set \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0438 \u0432\u0441\u0435\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 PowerShell \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435  <code>Set-PoshTheme -Theme Pwsh-Process-Performance -Save</code></p>"},{"location":"Windows/#windows-terminal","title":"Windows-Terminal","text":""},{"location":"Windows/#terminal-icons","title":"Terminal-Icons","text":"<p><code>Install-Module -Name Terminal-Icons -Repository PSGallery</code> <code>scoop bucket add extras</code> <code>scoop install terminal-icons</code></p> <p><code>notepad $PROFILE</code> <code>Import-Module -Name Terminal-Icons</code></p> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0448\u0440\u0438\u0444\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0432 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u0445 \u043f\u0440\u043e\u0444\u0438\u043b\u044f PowerShell: Nerd Fonts \u0421\u043f\u0438\u0441\u043e\u043a \u0448\u0440\u0438\u0444\u0442\u043e\u0432  \u0421\u043a\u0430\u0447\u0430\u0442\u044c \u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0448\u0440\u0438\u0444\u0442 \u043f\u043e\u0445\u043e\u0436\u0438\u0439 \u043d\u0430 Cascadia Code - CaskaydiaCove</p> <p>\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0448\u0440\u0438\u0444\u0442 \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e Windows Terminal \u0434\u043b\u044f PowerShell Core:</p> <pre><code>\"profiles\": \n{\n    \"defaults\": \n    {\n        \"colorScheme\": \"One Half Dark\",\n        \"experimental.retroTerminalEffect\": true,\n        \"font\": \n        {\n            \"size\": 10.0\n        },\n        \"useAtlasEngine\": true\n    },\n    \"list\": \n    [\n        // PowerShell Core\n        {\n            \"font\": \n            {\n                \"face\": \"CaskaydiaMono Nerd Font\" // \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u0448\u0440\u0438\u0444\u0442 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b Terminal-Icons\n            },\n            \"guid\": \"{574e775e-4f2a-5b96-ac1e-a2962a402336}\",\n            \"hidden\": false,\n            \"name\": \"PowerShell Core\",\n            \"source\": \"Windows.Terminal.PowershellCore\"\n        },\n        // WSL (Ubuntu)\n        {\n            \"guid\": \"{2c4de342-38b7-51cf-b940-2309a097f518}\",\n            \"hidden\": false,\n            \"name\": \"WSL\",\n            \"source\": \"Windows.Terminal.Wsl\"\n        },\n        // ssh\n        {\n            \"commandline\": \"ssh lifailon@192.168.1.100 -p 22\",\n            \"guid\": \"{a3ec86f6-2bc1-59dd-814d-2a0d935af5f8}\",\n            \"icon\": \"\ud83d\udc27\",\n            \"name\": \"devops-01\"\n        }\n    ]\n}\n</code></pre>"},{"location":"Windows/#custom-actions","title":"Custom Actions","text":"<p>Custom actions: https://learn.microsoft.com/ru-ru/windows/terminal/customize-settings/actions  Escape-\u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438: https://learn.microsoft.com/ru-ru/cpp/c-language/escape-sequences?view=msvc-170</p> <pre><code>\"actions\": \n[\n    {\n        \"command\": \n        {\n            \"action\": \"copy\",\n            \"singleLine\": false\n        },\n        \"keys\": \"ctrl+c\"\n    },\n    {\n        \"command\": \"paste\",\n        // \u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043a\u043b\u0430\u0441\u0441\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u0432\u0441\u0442\u0430\u0432\u043a\u0443 \u0438\u043d\u0442\u0435\u0440\u043f\u0440\u0438\u0442\u0430\u0442\u043e\u0440\u0430, \u043d\u0435 \u0437\u0430\u0441\u0442\u0430\u0432\u043b\u044f\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043a\u043e\u0434 \u043f\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u043e\n        \"keys\": \"ctrl+shift+v\" // default: ctrl+v\n    },\n    {\n        \"command\": \"find\",\n        \"keys\": \"ctrl+f\" // default: ctrl+shift+f\n    },\n    {\n        \"command\": \n        {\n            \"action\": \"splitPane\",\n            \"split\": \"left\", // default: auto\n            \"splitMode\": \"duplicate\"\n        },\n        \"keys\": \"ctrl+shift+d\" // default: alt+shift+d\n    },\n    // \u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443\n    {\n        \"command\": {\n            \"action\": \"sendInput\",\n            \"input\": \"\\u0001\\u001b[3~\"\n        },\n        \"keys\": \"ctrl+k\"\n    },\n    // \u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b\n    {\n        \"command\": {\n            \"action\": \"sendInput\",\n            \"input\": \"\\u0001\\u001b[3~clear\\r\"\n        },\n        \"keys\": \"ctrl+l\"\n    },\n    // \u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0448\u0430\u0431\u043b\u043e\u043d \u043c\u043e\u0434\u0443\u043b\u044f \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0430 \u0442\u0435\u043a\u0441\u0442\u0430 \u0447\u0435\u0440\u0435\u0437 Google Translate\n    {\n        \"command\": {\n            \"action\": \"sendInput\",\n            \"input\": \"\\u0001\\u001b[3~Get-Translate -Alternatives -Provider Google ''\\u001b[D\"\n        },\n        \"keys\": \"ctrl+g\"\n    },\n    // \u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0448\u0430\u0431\u043b\u043e\u043d \u043c\u043e\u0434\u0443\u043b\u044f \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0430 \u0442\u0435\u043a\u0441\u0442\u0430 \u0447\u0435\u0440\u0435\u0437 MyMemory\n    {\n        \"command\": {\n            \"action\": \"sendInput\",\n            \"input\": \"\\u0001\\u001b[3~Get-Translate -Alternatives -Provider MyMemory ''\\u001b[D\"\n        },\n        \"keys\": \"ctrl+q\"\n    },\n    // \u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u043f\u0435\u0440\u0435\u0432\u043e\u0434 \u0442\u0435\u043a\u0441\u0442\u0430 \u0438\u0437 \u0431\u0443\u0444\u0435\u0440\u0430 \u043e\u0431\u043c\u0435\u043d\u0430\n    {\n        \"command\": {\n            \"action\": \"sendInput\",\n            \"input\": \"\\u0001\\u001b[3~Get-Translate -Alternatives -Provider MyMemory -Text $(Get-Clipboard)\\u001b[D\\r\"\n        },\n        \"keys\": \"ctrl+shift+q\"\n    },\n    // \u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u043f\u0438\u043d\u0433 dns google\n    {\n        \"command\": {\n            \"action\": \"sendInput\",\n            \"input\": \"\\u0001\\u001b[3~ping 8.8.8.8 -t\\r\"\n        },\n        \"keys\": \"ctrl+p\"\n    }\n]\n</code></pre>"},{"location":"Zabbix/","title":"Zabbix","text":""},{"location":"Zabbix/#zabbix-agent","title":"Zabbix Agent","text":""},{"location":"Zabbix/#deploy","title":"Deploy","text":"<pre><code>$url = \"https://cdn.zabbix.com/zabbix/binaries/stable/6.4/6.4.5/zabbix_agent2-6.4.5-windows-amd64-static.zip\"\n$path = \"$home\\Downloads\\zabbix-agent2-6.4.5.zip\"\n$WebClient = New-Object System.Net.WebClient\n$WebClient.DownloadFile($url, $path)` \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u0444\u0430\u0439\u043b\nExpand-Archive $path -DestinationPath \"C:\\zabbix-agent2-6.4.5\\\"` \u0440\u0430\u0437\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c\nRemove-Item $path` \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u0440\u0445\u0438\u0432\nNew-NetFirewallRule -DisplayName \"Zabbix-Agent\" -Profile Any -Direction Inbound -Action Allow -Protocol TCP -LocalPort 10050,10051` \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u0440\u0442\u044b \u0432 FW\n\n$Zabbix_Server = \"192.168.3.102\"\n$conf = \"C:\\zabbix-agent2-6.4.5\\conf\\zabbix_agent2.conf\"\n$cat = cat $conf\n$rep = $cat -replace \"Server=.+\",\"Server=$Zabbix_Server\"\n$rep | Select-String Server=\n$rep &gt; $conf\n\n$exe = \"C:\\zabbix-agent2-6.4.5\\bin\\zabbix_agent2.exe\"\n.$exe --config $conf --install` \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443\nGet-Service *Zabbix*Agent* | Start-Service` \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443\n#.$exe --config $conf --uninstall` \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u043b\u0443\u0436\u0431\u0443\n</code></pre>"},{"location":"Zabbix/#zabbix_sender","title":"zabbix_sender","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c host - \u0437\u0430\u0434\u0430\u0442\u044c \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u043e\u0435 \u0438\u043c\u044f (powershell-host) \u0438 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0433\u0440\u0443\u043f\u043f\u0443  \u0421\u043e\u0437\u0434\u0430\u0442\u044c Items:  Name: Service Count  Type: Zabbix trapper  Key: service.count  Type of Information: Numeric</p> <pre><code>$path = \"C:\\zabbix-agent2-6.4.5\\bin\"\n$scount = (Get-Service).Count\n.$path\\zabbix_sender.exe -z 192.168.3.102 -s \"powershell-host\" -k service.count -o $scount\n</code></pre>"},{"location":"Zabbix/#zabbix_get","title":"zabbix_get","text":"<p><code>apt install zabbix-get</code> <code>nano /etc/zabbix/zabbix_agentd.conf</code> <code>Server=127.0.0.1,192.168.3.102,192.168.3.99</code> \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 zabbix_get \u0441 \u0430\u0433\u0435\u043d\u0442\u0430 (\u043a\u0430\u043a \u0438\u0445 \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440)</p> <p><code>.$path\\zabbix_get -s 192.168.3.101 -p 10050 -k agent.version</code> \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0432\u0435\u0440\u0441\u0438\u044e \u0430\u0433\u0435\u043d\u0442\u0430  <code>.$path\\zabbix_get -s 192.168.3.101 -p 10050 -k agent.ping</code> 1 - ok  <code>.$path\\zabbix_get -s 192.168.3.101 -p 10050 -k net.if.discovery</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432  <code>.$path\\zabbix_get -s 192.168.3.101 -p 10050 -k net.if.in[\"ens33\"]</code> <code>.$path\\zabbix_get -s 192.168.3.101 -p 10050 -k net.if.out[\"ens33\"]</code></p>"},{"location":"Zabbix/#userparameter","title":"UserParameter","text":"<p><code>UserParameter=process.count,powershell -Command \"(Get-Process).Count\"</code> <code>UserParameter=process.vm[*],powershell -Command \"(Get-Process $1).ws\"</code></p> <p>Test:  <code>C:\\zabbix-agent2-6.4.5\\bin\\zabbix_get.exe -s 127.0.0.1 -p 10050 -k process.count</code> <code>C:\\zabbix-agent2-6.4.5\\bin\\zabbix_get.exe -s 127.0.0.1 -p 10050 -k process.vm[zabbix_agent2]</code> <code>C:\\zabbix-agent2-6.4.5\\bin\\zabbix_get.exe -s 127.0.0.1 -p 10050 -k process.vm[powershell]</code></p> <p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0435 Items:  key: <code>process.count</code>  key: <code>process.vm[zabbix_agent2]</code></p>"},{"location":"Zabbix/#include","title":"Include","text":"<ul> <li> <p>\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 Include \u0434\u043b\u044f \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u044b\u0445 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 <code>'Include=.\\zabbix_agent2.d\\plugins.d\\*.conf' &gt;&gt; C:\\zabbix-agent2-6.4.5\\conf\\zabbix_agent2.conf</code></p> </li> <li> <p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u0441 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435, \u043f\u0443\u0442\u044c \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0443\u043a\u0430\u0437\u0430\u043d \u0432 zabbix_agentd.conf  <code>'UserParameter=Get-Query-Param[*],powershell.exe -noprofile -executionpolicy bypass -File C:\\zabbix-agent2-6.4.5\\conf\\zabbix_agent2.d\\scripts\\User-Sessions\\Get-Query-Param.ps1 $1' &gt; C:\\zabbix-agent2-6.4.5\\conf\\zabbix_agent2.d\\plugins.d\\User-Sessions.conf</code></p> </li> <li> <p>\u041f\u043e\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0441\u043a\u0440\u0438\u043f\u0442 Get-Query-Param.ps1 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433, \u043f\u0443\u0442\u044c \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0443\u043a\u0430\u0437\u0430\u043d \u0432 User-Sessions.conf. \u0421\u043a\u0440\u0438\u043f\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u043d \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u043e\u0442 Zabbix \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0438\u0445 \u0432 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0441\u043a\u0440\u0438\u043f\u0442\u0430.</p> </li> </ul> <pre><code>Param([string]$select)\nif ($select -eq \"ACTIVEUSER\") {\n(Get-Query | where status -match \"Active\").User\n}\nif ($select -eq \"INACTIVEUSER\") {\n(Get-Query | where status -match \"Disconnect\").User\n}\nif ($select -eq \"ACTIVECOUNT\") {\n(Get-Query | where status -match \"Active\").Status.Count\n}\nif ($select -eq \"INACTIVECOUNT\") {\n(Get-Query | where status -match \"Disconnect\").Status.Count\n}\n</code></pre> <ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0443 \u0441\u043a\u0440\u0438\u043f\u0442\u0430:</li> </ul> <p><code>$path = \"C:\\zabbix-agent2-6.4.5\\conf\\zabbix_agent2.d\\scripts\\User-Sessions\"</code> <code>.$path\\Get-Query-Param.ps1 ACTIVEUSER</code> <code>.$path\\Get-Query-Param.ps1 INACTIVEUSER</code> <code>.$path\\Get-Query-Param.ps1 ACTIVECOUNT</code> <code>.$path\\Get-Query-Param.ps1 INACTIVECOUNT</code></p> <ul> <li>\u0421\u043e\u0437\u0434\u0430\u0442\u044c Items \u0441 \u043a\u043b\u044e\u0447\u0430\u043c\u0438:</li> </ul> <p><code>Get-Query-Param[ACTIVEUSER]</code> Type: Text  <code>Get-Query-Param[INACTIVEUSER]</code> Type: Text  <code>Get-Query-Param[ACTIVECOUNT]</code> Type: Int  <code>Get-Query-Param[INACTIVECOUNT]</code> Type: Int</p> <ul> <li>\u041c\u0430\u043a\u0440\u043e\u0441\u044b:</li> </ul> <p><code>{$ACTIVEMAX} = 16</code> <code>{$ACTIVEMIN} = 0</code></p> <ul> <li>\u0422\u0440\u0438\u0433\u0433\u0435\u0440\u044b:</li> </ul> <p><code>last(/Windows-User-Sessions/Get-Query-Param[ACTIVECOUNT])&gt;{$ACTIVEMAX}</code> <code>min(/Windows-User-Sessions/Get-Query-Param[ACTIVECOUNT],24h)={$ACTIVEMIN}</code></p>"},{"location":"Zabbix/#zabbix_agent2conf","title":"zabbix_agent2.conf","text":"<pre><code># \u0410\u0433\u0435\u043d\u0442 \u043c\u043e\u0436\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0432 \u043f\u0430\u0441\u0441\u0438\u0432\u043d\u043e\u043c (\u0441\u0435\u0440\u0432\u0435\u0440 \u0437\u0430\u0431\u0438\u0440\u0430\u0435\u0442 \u0441\u0430\u043c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e) \u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 (\u0430\u0433\u0435\u043d\u0442 \u0441\u0430\u043c \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442):\nServer=192.168.3.102\nServerActive=192.168.3.102\n# \u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0443\u043a\u0430\u0437\u0430\u0442\u044c hostname \u0434\u043b\u044f ServerActive:\nHostname=huawei-book-01\n# \u0415\u0441\u043b\u0438 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u0438\u043c\u0435\u043d\u0438 \u0445\u043e\u0441\u0442\u0430 (\u0438\u0433\u043d\u043e\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f, \u0435\u0441\u043b\u0438 \u0438\u043c\u044f \u0445\u043e\u0441\u0442\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043e):\n# HostnameItem=system.hostname\n# \u041a\u0430\u043a \u0447\u0430\u0441\u0442\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0441\u043f\u0438\u0441\u043e\u043a \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a, \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445 (Range: 60-3600):\nRefreshActiveChecks=120\n# IP-\u0430\u0434\u0440\u0435\u0441 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0430 \u0434\u043b\u044f \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439:\n# SourceIP=\n# \u0410\u0433\u0435\u043d\u0442 \u0431\u0443\u0434\u0435\u0442 \u0441\u043b\u0443\u0448\u0430\u0442\u044c \u043d\u0430 \u044d\u0442\u043e\u043c \u043f\u043e\u0440\u0442\u0443 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c (Range: 1024-32767):\n# ListenPort=10050\n# \u0421\u043f\u0438\u0441\u043e\u043a IP-\u0430\u0434\u0440\u0435\u0441\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0430\u0433\u0435\u043d\u0442 \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u0440\u043e\u0441\u043b\u0443\u0448\u0438\u0432\u0430\u0442\u044c \u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u043f\u044f\u0442\u0443\u044e\n# ListenIP=0.0.0.0\n# \u0410\u0433\u0435\u043d\u0442 \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0441\u043b\u0443\u0448\u0438\u0432\u0430\u0442\u044c \u044d\u0442\u043e\u0442 \u043f\u043e\u0440\u0442 \u0434\u043b\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 HTTP (Range: 1024-32767):\n# StatusPort=\nControlSocket=\\\\.\\pipe\\agent.sock\n# \u041a\u0443\u0434\u0430 \u0432\u0435\u0441\u0442\u0438 \u0436\u0443\u0440\u043d\u0430\u043b (file/syslog/console):\nLogType=file\nLogFile=C:\\zabbix-agent2-6.4.5\\zabbix_agent2.log\n# \u0420\u0430\u0437\u043c\u0435\u0440 \u043b\u043e\u0433\u0430 \u043e\u0442 0-1024 MB (0 - \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u0440\u043e\u0442\u0430\u0446\u0438\u044e \u043b\u043e\u0433\u043e\u0432)\nLogFileSize=100\n# \u0423\u0440\u043e\u0432\u0435\u043d\u044c \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. 4 - \u0434\u043b\u044f \u043e\u0442\u043b\u0430\u0434\u043a\u0438 (\u0432\u044b\u0434\u0430\u0435\u0442 \u043c\u043d\u043e\u0433\u043e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438)\nDebugLevel=4\n</code></pre>"},{"location":"Zabbix/#api","title":"API","text":""},{"location":"Zabbix/#token","title":"Token","text":"<p>Documentation</p> <p><code>$ip = \"192.168.3.102\"</code> <code>$url = \"http://$ip/zabbix/api_jsonrpc.php\"</code></p> <pre><code>$data = @{\n    \"jsonrpc\"=\"2.0\";\n    \"method\"=\"user.login\";\n    \"params\"=@{\n        \"username\"=\"Admin\";` \u0432 \u0432\u0435\u0440\u0441\u0438\u0438 \u0434\u043e 6.4 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \"user\"\n        \"password\"=\"zabbix\";\n    };\n    \"id\"=1;\n}\n$token = (Invoke-RestMethod -Method POST -Uri $url -Body ($data | ConvertTo-Json) -ContentType \"application/json\").Result\n</code></pre> <p><code>$token = \"2eefd25fdf1590ebcdb7978b5bcea1fff755c65b255da8cbd723181b639bb789\"</code> \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u043e\u043a\u0435\u043d \u0432 UI (http://192.168.3.102/zabbix/zabbix.php?action=token.list)</p>"},{"location":"Zabbix/#userget","title":"user.get","text":"<pre><code>$data = @{\n    \"jsonrpc\"=\"2.0\";\n    \"method\"=\"user.get\";\n    \"params\"=@{\n    };\n    \"auth\"=$token;\n    \"id\"=1;\n}\n$users = (Invoke-RestMethod -Method POST -Uri $url -Body ($data | ConvertTo-Json) -ContentType \"application/json\").Result\n</code></pre>"},{"location":"Zabbix/#problemget","title":"problem.get","text":"<pre><code>$data = @{\n    \"jsonrpc\"=\"2.0\";\n    \"method\"=\"problem.get\";\n    \"params\"=@{\n    };\n    \"auth\"=$token;\n    \"id\"=1;\n}\n(Invoke-RestMethod -Method POST -Uri $url -Body ($data | ConvertTo-Json) -ContentType \"application/json\").Result\n</code></pre>"},{"location":"Zabbix/#hostget","title":"host.get","text":"<p>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0445\u043e\u0441\u0442\u043e\u0432 (\u0438\u043c\u044f \u0438 id)</p> <p>Endpoint host</p> <p>host.create - creating new hosts  host.delete - deleting hosts  host.get - retrieving hosts  host.massadd - adding related objects to hosts  host.massremove - removing related objects from hosts  host.massupdate - replacing or removing related objects from hosts  host.update - updating hosts</p> <pre><code>$data = @{\n    \"jsonrpc\"=\"2.0\";\n    \"method\"=\"host.get\";\n    \"params\"=@{\n        \"output\"=@(` \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434\n            \"hostid\";\n            \"host\";\n        );\n    };\n    \"id\"=2;\n    \"auth\"=$token;\n}\n$hosts = (Invoke-RestMethod -Method POST -Uri $url -Body ($data | ConvertTo-Json) -ContentType \"application/json\").Result\n$host_id = $hosts[3].hostid` \u0437\u0430\u0431\u0440\u0430\u0442\u044c id \u0445\u043e\u0441\u0442\u0430 \u043f\u043e \u0438\u043d\u0434\u0435\u043a\u0441\u0443\n</code></pre>"},{"location":"Zabbix/#itemget","title":"item.get","text":"<p>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c id \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044e \u043a\u043b\u044e\u0447\u0430 \u0434\u043b\u044f \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0445\u043e\u0441\u0442\u0430</p> <pre><code>$data = @{\n    \"jsonrpc\"=\"2.0\";\n    \"method\"=\"item.get\";\n    \"params\"=@{\n        \"hostids\"=@($host_id);` \u043e\u0442\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0445\u043e\u0441\u0442\u0443\n    };\n    \"auth\"=$token;\n    \"id\"=1;\n}\n$items = (Invoke-RestMethod -Method POST -Uri $url -Body ($data | ConvertTo-Json) -ContentType \"application/json\").Result\n$items_id = ($items | where key_ -match system.uptime).itemid` \u0437\u0430\u0431\u0440\u0430\u0442\u044c id \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\n</code></pre>"},{"location":"Zabbix/#historyget","title":"history.get","text":"<p>\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0441\u044e \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e \u0435\u0433\u043e id</p> <pre><code>$data = @{\n    \"jsonrpc\"=\"2.0\";\n    \"method\"=\"history.get\";\n    \"params\"=@{\n        \"hostids\"=@($host_id); ` \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e \u0445\u043e\u0441\u0442\u0443\n        \"itemids\"=@($items_id);` \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0443 \u0434\u0430\u043d\u043d\u044b\u0445\n    };\n    \"auth\"=$token;\n    \"id\"=1;\n}\n$items_data_uptime = (Invoke-RestMethod -Method POST -Uri $url -Body ($data | ConvertTo-Json) -ContentType \"application/json\").Result` \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e \u043a\u043b\u044e\u0447\u0443 \u0443 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0445\u043e\u0441\u0442\u0430\n</code></pre>"},{"location":"Zabbix/#convert-secconds-to-timespan-and-datetime","title":"Convert Secconds To TimeSpan and DateTime","text":"<p><code>$sec = $items_data_uptime.value</code></p> <pre><code>function ConvertSecondsTo-TimeSpan {\n    param (\n        $insec\n    )\n    $TimeSpan = [TimeSpan]::fromseconds($insec)\n    \"{0:dd' day 'hh\\:mm\\:ss}\" -f $TimeSpan\n}\n</code></pre> <p><code>$UpTime = ConvertSecondsTo-TimeSpan $sec[-1]</code></p>"},{"location":"Zabbix/#convert-from-unix-time","title":"Convert From Unix Time","text":"<p><code>$time = $items_data_uptime.clock</code></p> <pre><code>function ConvertFrom-UnixTime {\n    param (\n        $intime\n    )\n    $EpochTime = [DateTime]\"1/1/1970\"\n    $TimeZone = Get-TimeZone\n    $UTCTime = $EpochTime.AddSeconds($intime)\n    $UTCTime.AddMinutes($TimeZone.BaseUtcOffset.TotalMinutes)\n}\n</code></pre> <p><code>$GetDataTime = ConvertFrom-UnixTime $time[-1]</code></p> <p><code>($hosts | where hostid -eq $host_id).host</code> \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043c\u044f \u0445\u043e\u0441\u0442\u0430  <code>$UpTime</code> \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0440\u0430\u0431\u043e\u0442\u044b \u0445\u043e\u0441\u0442\u0430  <code>$GetDataTime</code> \u0432\u0440\u0435\u043c\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f</p>"},{"location":"Zabbix/#snmp","title":"SNMP","text":""},{"location":"Zabbix/#setup-snmp-service","title":"Setup SNMP Service","text":"<p><code>Install-WindowsFeature SNMP-Service,SNMP-WMI-Provider -IncludeManagementTools</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u043e\u043b\u044c SNMP \u0438 WMI \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 \u0447\u0435\u0440\u0435\u0437 Server Manager  <code>Get-WindowsFeature SNMP*</code> <code>Add-WindowsCapability -Online -Name SNMP.Client~~~~0.0.1.0</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 Feature On Demand \u0434\u043b\u044f Windows 10/11<code></code>Get-Service SNMP<code></code>Get-NetFirewallrule -DisplayName snmp | ft<code></code>Get-NetFirewallrule -DisplayName snmp* | Enable-NetFirewallRule`</p>"},{"location":"Zabbix/#setting-snmp-service-via-regedit","title":"Setting SNMP Service via Regedit","text":"<p>Agent:  <code>New-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\services\\SNMP\\Parameters\\RFC1156Agent\" -Name \"sysContact\" -Value \"lifailon-user\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c (New) \u0438\u043b\u0438 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c (Set)  <code>New-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\services\\SNMP\\Parameters\\RFC1156Agent\" -Name \"sysLocation\" -Value \"plex-server\"</code></p> <p>Security:  <code>New-Item -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\services\\SNMP\\Parameters\\TrapConfiguration\\public\"</code> \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 community string  <code>New-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\SNMP\\Parameters\\ValidCommunities\" -Name \"public\" -Value 16</code> \u043d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u043d\u0430 public  <code>1 \u2014 NONE</code> <code>2 \u2014 NOTIFY</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c SNMP \u043b\u043e\u0432\u0443\u0448\u043a\u0438  <code>4 \u2014 READ ONLY</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0441 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430  <code>8 \u2014 READ WRITE</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0438 \u0438\u0437\u043c\u0435\u043d\u044f\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430  <code>16 \u2014 READ CREATE</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0447\u0438\u0442\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435, \u0438\u0437\u043c\u0435\u043d\u044f\u0442\u044c \u0438 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442\u044b  <code>New-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\SNMP\\Parameters\\PermittedManagers\" -Name \"1\" -Value \"192.168.3.99\"</code> \u043e\u0442 \u043a\u043e\u0433\u043e \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043e \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b  <code>Get-Service SNMP | Restart-Service</code></p>"},{"location":"Zabbix/#snmpwalk","title":"snmpwalk","text":"<p><code>snmpwalk -v 2c -c public 192.168.3.100</code> <code>snmpwalk -v 2c -c public -O e 192.168.3.100</code></p>"},{"location":"Zabbix/#snmp-modules","title":"SNMP Modules","text":"<p><code>Install-Module -Name SNMP</code> <code>Get-SnmpData -IP 192.168.3.100 -OID 1.3.6.1.2.1.1.4.0 -UDPport 161 -Community public</code> <code>(Get-SnmpData -IP 192.168.3.100 -OID 1.3.6.1.2.1.1.4.0).Data</code> <code>Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.1</code> \u043f\u0440\u043e\u0439\u0442\u0438\u0441\u044c \u043f\u043e \u0434\u0435\u0440\u0435\u0432\u0443 OID  <code>Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.25.6.3.1.2</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u041f\u041e  <code>Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.25.2.3.1</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 \u0438 \u043f\u0430\u043c\u044f\u0442\u0438 (C: D: Virtual Memory \u0438 Physical Memory)  <code>Set-SnmpData</code> \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435</p> <p><code>Install-Module -Name SNMPv3</code> <code>Invoke-SNMPv3Get</code> \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e \u043e\u0434\u043d\u043e\u043c\u0443 OID  <code>Invoke-SNMPv3Set</code> \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445  <code>Invoke-SNMPv3Walk</code> \u043e\u0431\u0445\u043e\u0434 \u043f\u043e \u0434\u0435\u0440\u0435\u0432\u0443 OID  <code>Invoke-SNMPv3Walk -UserName lifailon -Target 192.168.3.100 -AuthSecret password -PrivSecret password -OID 1.3.6.1.2.1.1 -AuthType MD5 -PrivType AES128</code></p>"},{"location":"Zabbix/#lextmsharpsnmplib","title":"Lextm.SharpSnmpLib","text":"<p>\u0421\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0441 Download lib</p> <p><code>Add-Type -LiteralPath \"$home\\Desktop\\lextm.sharpsnmplib-12.5.2\\net471\\SharpSnmpLib.dll\"</code></p> <pre><code>$port = 161\n$OID = \"1.3.6.1.2.1.1.4.0\"\n$variableList = New-Object Collections.Generic.List[Lextm.SharpSnmpLib.Variable]\n$variableList.Add([Lextm.SharpSnmpLib.Variable]::new([Lextm.SharpSnmpLib.ObjectIdentifier]::new($OID)))\n$timeout = 3000\n[Net.IPAddress]$ip = \"192.168.3.100\"\n$endpoint = New-Object Net.IpEndPoint $ip, $port\n$Community = \"public\"\n[Lextm.SharpSnmpLib.VersionCode]$Version = \"V2\"\n\n$message = [Lextm.SharpSnmpLib.Messaging.Messenger]::Get(\n$Version,\n$endpoint,\n$Community,\n$variableList,\n$TimeOut\n)\n$message.Data.ToString()\n</code></pre>"},{"location":"Zabbix/#walk","title":"Walk","text":"<pre><code>[Lextm.SharpSnmpLib.ObjectIdentifier]$OID = \"1.3.6.1.2.1.1\" # \u0434\u0435\u0440\u0435\u0432\u043e \u0438\u043b\u0438 \u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0439 OID\n$WalkMode = [Lextm.SharpSnmpLib.Messaging.WalkMode]::WithinSubtree # \u0440\u0435\u0436\u0438\u043c \u043e\u0431\u0445\u043e\u0434\u0430 \u043f\u043e \u0434\u0435\u0440\u0435\u0432\u0443\n$results = New-Object Collections.Generic.List[Lextm.SharpSnmpLib.Variable]\n$message = [Lextm.SharpSnmpLib.Messaging.Messenger]::Walk(\n  $Version,\n  $endpoint,\n  $Community,\n  $OID,\n  $results,\n  $TimeOut,\n  $WalkMode\n)\n$results\n\n$results2 = @()\nforeach ($d in $results) {\n$results2 +=[PSCustomObject]@{'ID'=$d.id.ToString();'Data'=$d.Data.ToString()} # \u043f\u0435\u0440\u0435\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0432\u043e\u0434 \u043f\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u043e \u0432 \u0441\u0442\u0440\u043e\u043a\u0443\n}\n$results2\n</code></pre>"},{"location":"Zabbix/#smtp","title":"SMTP","text":"<pre><code>function Send-SMTP {\nparam (\n    [Parameter(Mandatory = $True)]$mess\n)\n    $srv_smtp = \"smtp.yandex.ru\" \n    $port = \"587\"\n    $from = \"login1@yandex.ru\" \n    $to = \"login2@yandex.ru\" \n    $user = \"login1\"\n    $pass = \"password\"\n    $subject = \"Service status on Host: $hostname\"\n    $Message = New-Object System.Net.Mail.MailMessage\n    $Message.From = $from\n    $Message.To.Add($to) \n    $Message.Subject = $subject \n    $Message.IsBodyHTML = $true \n    $Message.Body = \"&lt;h1&gt; $mess &lt;/h1&gt;\"\n    $smtp = New-Object Net.Mail.SmtpClient($srv_smtp, $port)\n    $smtp.EnableSSL = $true \n    $smtp.Credentials = New-Object System.Net.NetworkCredential($user, $pass);\n    $smtp.Send($Message) \n}\n</code></pre> <p><code>Send-SMTP $(Get-Service)</code></p>"},{"location":"dotNET/","title":".NET","text":""},{"location":"dotNET/#console-api","title":"Console API","text":"<p>Source</p> <p><code>[Console] | Get-Member -Static</code> <code>[Console]::BackgroundColor = \"Blue\"</code> <code>[Console]::OutputEncoding</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u0430\u044f \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u043a\u0430 \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0435\u0441\u0441\u0438\u0438  <code>[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding(\"utf-8\")</code> \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u043a\u0443 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043a\u0438\u0440\u0438\u043b\u043b\u0438\u0446\u044b  <code>[Console]::outputEncoding = [System.Text.Encoding]::GetEncoding(\"cp866\")</code> \u0434\u043b\u044f ISE  <code>[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding(\"windows-1251\")</code> \u0434\u043b\u044f ps2exe  <code>Get-Service | Out-File $home\\Desktop\\Service.txt -Encoding oem</code> &gt;  <code>Get-Service | Out-File $home\\Desktop\\Service.txt -Append</code> &gt;&gt;</p> <pre><code>do {\n    if ([Console]::KeyAvailable) {\n        $keyInfo = [Console]::ReadKey($true)\n        break\n    }\n    Write-Host \".\" -NoNewline\n    Start-Sleep 1\n} while ($true)\nWrite-Host\n$keyInfo\n\nfunction Get-KeyPress {\n    param (\n        [Parameter(Mandatory)][ConsoleKey]$Key,\n        [System.ConsoleModifiers]$ModifierKey = 0\n    )\n    if ([Console]::KeyAvailable) {\n        $pressedKey = [Console]::ReadKey($true)\n        $isPressedKey = $key -eq $pressedKey.Key\n        if ($isPressedKey) {\n            $pressedKey.Modifiers -eq $ModifierKey\n        }\n        else {\n            [Console]::Beep(1800, 200)\n            $false\n        }\n    }\n}\n\nWrite-Warning 'Press Ctrl+Shift+Q to exit'\ndo {\n    Write-Host \".\" -NoNewline\n    $pressed = Get-KeyPress -Key Q -ModifierKey 'Control,Shift'\n    if ($pressed) { break }\n    Start-Sleep 1\n} while ($true)\n</code></pre>"},{"location":"dotNET/#drawing","title":"Drawing","text":"<p>API</p> <pre><code>Add-Type -AssemblyName System.Drawing\n$Width = 800\n$Height = 400\n$image = New-Object System.Drawing.Bitmap($Width,$Height)\n$graphic = [System.Drawing.Graphics]::FromImage($image)\n$background_color = [System.Drawing.Brushes]::Blue # \u0437\u0430\u0434\u0430\u0442\u044c \u0446\u0432\u0435\u0442 \u0444\u043e\u043d\u0430 (\u0441\u0438\u043d\u0438\u0439)\n$graphic.FillRectangle($background_color, 0, 0, $image.Width, $image.Height)\n$text_color = [System.Drawing.Brushes]::White # \u0437\u0430\u0434\u0430\u0442\u044c \u0446\u0432\u0435\u0442 \u0442\u0435\u043a\u0441\u0442\u0430 (\u0431\u0435\u043b\u044b\u0439)\n$font = New-Object System.Drawing.Font(\"Arial\", 20, [System.Drawing.FontStyle]::Bold) # \u0437\u0430\u0434\u0430\u0442\u044c \u0448\u0440\u0438\u0444\u0442\n$text = \"PowerShell\" # \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0442\u0435\u043a\u0441\u0442\n$text_position = New-Object System.Drawing.RectangleF(320, 180, 300, 100)  # \u0437\u0430\u0434\u0430\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u0430 (x, y, width, height)\n$graphic.DrawString($text, $font, $text_color, $text_position) # \u043d\u0430\u043d\u0435\u0441\u0442\u0438 \u0442\u0435\u043a\u0441\u0442 \u043d\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435\n$image.Save(\"$home\\desktop\\powershell_image.bmp\", [System.Drawing.Imaging.ImageFormat]::Bmp) # \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435\n$image.Dispose() # \u043e\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0435\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432\n</code></pre> <p><code>$path = \"$home\\desktop\\powershell_image.bmp\"</code> <code>Invoke-Item $path</code></p> <pre><code>$src_image = [System.Drawing.Image]::FromFile($path)\n$Width = 400\n$Height = 200\n$dst_image = New-Object System.Drawing.Bitmap -ArgumentList $src_image, $Width, $Height # \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f\n$dst_image.Save(\"$home\\desktop\\powershell_image_resize.bmp\", [System.Drawing.Imaging.ImageFormat]::Bmp)\n\n$rotated_image = $src_image.Clone() # \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043f\u0438\u044e \u0438\u0441\u0445\u043e\u0434\u043d\u043e\u0433\u043e \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f\n$rotated_image.RotateFlip([System.Drawing.RotateFlipType]::Rotate180FlipNone) # \u043f\u0435\u0440\u0435\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043d\u0430 180 \u0433\u0440\u0430\u0434\u0443\u0441\u043e\u0432\n$rotated_image.Save(\"$home\\desktop\\powershell_image_rotated.bmp\", [System.Drawing.Imaging.ImageFormat]::Bmp)\n$src_image.Dispose() # \u0437\u0430\u043a\u0440\u044b\u0442\u044c (\u043e\u0442\u043f\u0443\u0441\u0442\u0438\u0442\u044c) \u0438\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u0444\u0430\u0439\u043b\n</code></pre>"},{"location":"dotNET/#selenium","title":"Selenium","text":"<p><code>Invoke-Expression(New-Object Net.WebClient).DownloadString(\"https://raw.githubusercontent.com/Lifailon/Deploy-Selenium/rsa/Deploy-Selenium-Drivers.ps1\")</code> \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0432\u0441\u0435\u0445 \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u043e\u0432 \u0438 Chromium \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 \u0434\u043b\u044f \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u0430</p> <pre><code>$path = \"$home\\Documents\\Selenium\\\"\n$log = \"$path\\ChromeDriver.log\"\n$ChromeDriver = \"$path\\ChromeDriver.exe\"\n$WebDriver = \"$path\\WebDriver.dll\"\n$SupportDriver = \"$path\\WebDriver.Support.dll\"\n$Chromium = (Get-ChildItem $path -Recurse | Where-Object Name -like chrome.exe).FullName\nAdd-Type -Path $WebDriver\nAdd-Type -Path $SupportDriver\ntry {\n    $ChromeOptions = New-Object OpenQA.Selenium.Chrome.ChromeOptions # \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u043e\u0431\u044a\u0435\u043a\u0442 \u0441 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u043c\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0430\n    $ChromeOptions.BinaryLocation = $Chromium # \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u043c \u043f\u0443\u0442\u044c \u0434\u043e \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u0437\u0430\u043f\u0443\u0441\u043a \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0430\n    $ChromeOptions.AddArgument(\"start-maximized\") # \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u043d\u0430 \u0432\u0435\u0441\u044c \u044d\u043a\u0440\u0430\u043d\n    #$ChromeOptions.AddArgument(\"start-minimized\") # \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u0432 \u043e\u043a\u043d\u0435\n    #$ChromeOptions.AddArgument(\"window-size=400,800\") # \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u0441 \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u0440\u0430\u0437\u043c\u0435\u0440\u0430\u043c \u043e\u043a\u043d\u0430 \u0432 \u043f\u0438\u043a\u0441\u0435\u043b\u044f\u0445\n    $ChromeOptions.AcceptInsecureCertificates = $True # \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u0435\u0434\u0443\u043f\u0440\u0435\u0436\u0434\u0435\u043d\u0438\u0435 \u043d\u0430 \u0441\u0430\u0439\u0442\u0430\u0445 \u0441 \u043d\u0435 \u0432\u0430\u043b\u0438\u0434\u043d\u044b\u043c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u043c\n    #$ChromeOptions.AddArgument(\"headless\") # \u0441\u043a\u0440\u044b\u0432\u0430\u0442\u044c \u043e\u043a\u043d\u043e \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0430 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435\n    $ChromeDriverService = [OpenQA.Selenium.Chrome.ChromeDriverService]::CreateDefaultService($ChromeDriver) # \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u043e\u0431\u044a\u0435\u043a\u0442 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a \u0441\u043b\u0443\u0436\u0431\u044b \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u0430\n    $ChromeDriverService.HideCommandPromptWindow = $True # \u043e\u0442\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u0432\u0435\u0441\u044c \u0432\u044b\u0432\u043e\u0434 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u0440\u0430\u0439\u0432\u0435\u0440\u0430 \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c (\u044d\u0442\u043e\u0442 \u0432\u044b\u0432\u043e\u0434 \u043d\u0435\u043b\u044c\u0437\u044f \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u0438\u0442\u044c)\n    $ChromeDriverService.LogPath = $log # \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0443\u0442\u044c \u0434\u043e \u0444\u0430\u0439\u043b\u0430 \u0441 \u0436\u0443\u0440\u043d\u0430\u043b\u043e\u043c\n    $ChromeDriverService.EnableAppendLog = $True # \u043d\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c \u0436\u0443\u0440\u043d\u0430\u043b \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u043d\u043e\u0432\u043e\u043c \u0437\u0430\u043f\u0443\u0441\u043a\u0435\n    #$ChromeDriverService.EnableVerboseLogging = $True # \u043a\u0440\u043e\u043c\u0435 INFO \u0438 \u043e\u0448\u0438\u0431\u043e\u043a, \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c DEBUG \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f\n    $Selenium = New-Object OpenQA.Selenium.Chrome.ChromeDriver($ChromeDriverService, $ChromeOptions) # \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u0437\u0430\u043f\u0443\u0441\u043a \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u043c\u0438\n\n    $Selenium.Navigate().GoToUrl(\"https://google.com\") # \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0438\u043c \u043f\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435\n    #$Selenium.Manage().Window.Minimize() # \u0441\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043e\u043a\u043d\u043e \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0430 \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0438 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u043f\u043e \u043d\u0443\u0436\u043d\u043e\u043c\u0443 url (\u0447\u0442\u043e \u0431\u044b \u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e)\n    # \u0418\u0449\u0435\u043c \u043f\u043e\u043b\u0435 \u0434\u043b\u044f \u0432\u0432\u043e\u0434\u0430 \u0442\u0435\u043a\u0441\u0442\u0430:\n    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::Id('APjFqb'))\n    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::XPath('//*[@id=\"APjFqb\"]'))\n    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::Name('q'))\n    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::XPath('//*[@name=\"q\"]'))\n    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::ClassName('gLFyf'))\n    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::CssSelector('[jsname=\"yZiJbe\"]'))\n    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::TagName('textarea')) | Where-Object ComputedAccessibleRole -eq combobox\n    $Search.SendKeys(\"calculator online\") # \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u043c \u0442\u0435\u043a\u0441\u0442 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c\u0443 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0443\n    $Search.SendKeys([OpenQA.Selenium.Keys]::Enter) # \u043d\u0430\u0436\u0438\u043c\u0430\u0435\u043c Enter \u0434\u043b\u044f \u0432\u044b\u0437\u043e\u0432\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0438\u0441\u043a\u0430\n\n    Start-Sleep 1\n    $div = $Selenium.FindElements([OpenQA.Selenium.By]::TagName(\"div\"))\n    $2 = $div | Where-Object {($_.ComputedAccessibleRole -eq \"button\") -and ($_.ComputedAccessibleLabel -eq \"2\")}\n    $2.Click()\n    $2.Click()\n    $plus = $div | Where-Object {($_.ComputedAccessibleRole -eq \"button\") -and ($_.Text -eq \"+\")}\n    $plus.Click()\n    $3 = $Selenium.FindElement([OpenQA.Selenium.By]::CssSelector('[jsname=\"KN1kY\"]'))\n    $3.Click()\n    $3.Click()\n    $sum = $Selenium.FindElement([OpenQA.Selenium.By]::CssSelector('[jsname=\"Pt8tGc\"]'))\n    $sum.Click()\n    $result = $Selenium.FindElement([OpenQA.Selenium.By]::CssSelector('[jsname=\"VssY5c\"]')).Text\n    Write-Host \"Result: $result\" -ForegroundColor Green\n}\nfinally {\n    $Selenium.Close()\n    $Selenium.Quit()\n}\n</code></pre>"},{"location":"dotNET/#selenium-modules","title":"Selenium modules","text":"<pre><code>Invoke-RestMethod https://raw.githubusercontent.com/Lifailon/Selenium-Modules/rsa/Modules/Get-GPT/Get-GPT.psm1 | Out-File -FilePath \"$(New-Item -Path \"$($($Env:PSModulePath -split \";\")[0])\\Get-GPT\" -ItemType Directory -Force)\\Get-GPT.psm1\" -Force\n</code></pre> <p><code>Get-GPT \"\u0418\u0441\u043f\u043e\u043b\u043d\u044f\u0439 \u0440\u043e\u043b\u044c \u043a\u0430\u043b\u044c\u043a\u0443\u043b\u044f\u0442\u043e\u0440\u0430. \u041f\u043e\u0441\u0447\u0438\u0442\u0430\u0439 \u0441\u0443\u043c\u043c\u0443 \u0447\u0438\u0441\u0435\u043b: 22+33\"</code></p> <pre><code>Invoke-RestMethod https://raw.githubusercontent.com/Lifailon/Selenium-Modules/rsa/Modules/Get-Translation/Get-Translation.psm1 | Out-File -FilePath \"$(New-Item -Path \"$($($Env:PSModulePath -split \";\")[0])\\Get-Translation\" -ItemType Directory -Force)\\Get-Translation.psm1\" -Force\n</code></pre> <p><code>Get-Translation -Provider DeepL -Text \"I translating the text\"</code> <code>Get-Translation -Provider DeepL -Text \"\u042f \u043f\u0435\u0440\u0435\u0432\u043e\u0436\u0443 \u0442\u0435\u043a\u0441\u0442\"</code> <code>Get-Translation -Provider Google -Text \"I translating the text\"</code> <code>Get-Translation -Provider Google -Text \"\u042f \u043f\u0435\u0440\u0435\u0432\u043e\u0436\u0443 \u0442\u0435\u043a\u0441\u0442\" -Language en</code></p> <pre><code>Invoke-RestMethod https://raw.githubusercontent.com/Lifailon/Selenium-Modules/rsa/Modules/Get-SpeedTest/Get-SpeedTest.psm1 | Out-File -FilePath \"$(New-Item -Path \"$($($Env:PSModulePath -split \";\")[0])\\Get-SpeedTest\" -ItemType Directory -Force)\\Get-SpeedTest.psm1\" -Force\n</code></pre> <p><code>Get-SpeedTest -Provider Libre</code> <code>Get-SpeedTest -Provider Open</code> <code>Get-SpeedTest -Provider Ookla</code></p>"},{"location":"dotNET/#object-event","title":"Object Event","text":"<pre><code>$Timer = New-Object System.Timers.Timer\n$Timer.Interval = 1000\nRegister-ObjectEvent -InputObject $Timer -EventName Elapsed -SourceIdentifier Timer.Output -Action {\n$Random = Get-Random -Min 0 -Max 100\nWrite-Host $Random \n}\n$Timer.Enabled = $True\n</code></pre> <p><code>$Timer.Enabled = $False</code> \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c  <code>$Timer | Get-Member -MemberType Event</code> \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \u043e\u0431\u044a\u0435\u043a\u0442\u0430  <code>Get-EventSubscriber</code> \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u0434\u043f\u0438\u0441\u043e\u043a \u043d\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0435\u0441\u0441\u0438\u0438  <code>Unregister-Event -SourceIdentifier Timer.Output</code> \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0438 \u043d\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u0435 \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u0441\u043e\u0431\u044b\u0442\u0438\u044f (EventName) \u0438\u043b\u0438 \u0432\u0441\u0435 *  <code>-Forward</code> \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0438\u0437 \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0430\u043d\u0441\u0430 (New-PSSession) \u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0435\u0430\u043d\u0441  <code>-SupportEvent</code> \u043d\u0435 \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u043d\u0430 \u044d\u043a\u0440\u0430\u043d (\u0438 Get-EventSubscriber \u0438 Get-Job)</p> <pre><code>Register-EngineEvent -SourceIdentifier PowerShell.Exiting -Action {\n$date = Get-Date -f hh:mm:ss\n(New-Object -ComObject Wscript.Shell).Popup(\"PowerShell Exit: $date\",0,\"Action\",64)\n}\n</code></pre>"},{"location":"dotNET/#methods","title":"Methods","text":""},{"location":"dotNET/#eventlog","title":"EventLog","text":"<p><code>[System.Diagnostics.EventLog] | select Assembly,Module</code> <code>$EventLog = [System.Diagnostics.EventLog]::new(\"Application\")</code> <code>$EventLog = New-Object -TypeName System.Diagnostics.EventLog -ArgumentList Application,192.168.3.100</code> <code>$EventLog | Get-Member -MemberType Method</code> <code>$EventLog.MaximumKilobytes</code> \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0436\u0443\u0440\u043d\u0430\u043b\u0430  <code>$EventLog.Entries</code> \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0436\u0443\u0440\u043d\u0430\u043b  <code>$EventLog.Clear()</code> \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0436\u0443\u0440\u043d\u0430\u043b</p> <p><code>Join-Path C: Install Test</code> <code>[System.IO.Path]::Combine(\"C:\", \"Install\", \"Test\")</code></p>"},{"location":"dotNET/#match","title":"Match","text":"<p><code>[System.Math] | Get-Member -Static -MemberType Methods</code> <code>[System.Math]::Max(2,7)</code> <code>[System.Math]::Min(2,7)</code> <code>[System.Math]::Floor(3.9)</code> <code>[System.Math]::Truncate(3.9)</code></p>"},{"location":"dotNET/#generatepassword","title":"GeneratePassword","text":"<p><code>Add-Type -AssemblyName System.Web</code> <code>[System.Web.Security.Membership]::GeneratePassword(10,2)</code></p>"},{"location":"dotNET/#soundplayer","title":"SoundPlayer","text":"<pre><code>$CriticalSound = New-Object System.Media.SoundPlayer\n$CriticalSound.SoundLocation = \"C:\\WINDOWS\\Media\\Windows Critical Stop.wav\"\n$CriticalSound.Play()\n\n$GoodSound = New-Object System.Media.SoundPlayer\n$GoodSound.SoundLocation = \"C:\\WINDOWS\\Media\\tada.wav\"\n$GoodSound.Play()\n</code></pre>"},{"location":"dotNET/#static-class","title":"Static Class","text":"<p><code>[System.Environment] | Get-Member -Static</code> <code>[System.Environment]::OSVersion</code> <code>[System.Environment]::Version</code> <code>[System.Environment]::MachineName</code> <code>[System.Environment]::UserName</code></p> <p><code>[System.Diagnostics.Process] | Get-Member -Static</code> <code>[System.Diagnostics.Process]::Start('notepad.exe')</code></p>"},{"location":"dotNET/#clicker","title":"Clicker","text":"<pre><code>$cSource = @'\nusing System;\nusing System.Drawing;\nusing System.Runtime.InteropServices;\nusing System.Windows.Forms;\npublic class Clicker\n{\n//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646270(v=vs.85).aspx\n[StructLayout(LayoutKind.Sequential)]\nstruct INPUT\n{ \n    public int        type; // 0 = INPUT_MOUSE,\n                            // 1 = INPUT_KEYBOARD\n                            // 2 = INPUT_HARDWARE\n    public MOUSEINPUT mi;\n}\n//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646273(v=vs.85).aspx\n[StructLayout(LayoutKind.Sequential)]\nstruct MOUSEINPUT\n{\n    public int    dx ;\n    public int    dy ;\n    public int    mouseData ;\n    public int    dwFlags;\n    public int    time;\n    public IntPtr dwExtraInfo;\n}\n//This covers most use cases although complex mice may have additional buttons\n//There are additional constants you can use for those cases, see the msdn page\nconst int MOUSEEVENTF_MOVED      = 0x0001 ;\nconst int MOUSEEVENTF_LEFTDOWN   = 0x0002 ;\nconst int MOUSEEVENTF_LEFTUP     = 0x0004 ;\nconst int MOUSEEVENTF_RIGHTDOWN  = 0x0008 ;\nconst int MOUSEEVENTF_RIGHTUP    = 0x0010 ;\nconst int MOUSEEVENTF_MIDDLEDOWN = 0x0020 ;\nconst int MOUSEEVENTF_MIDDLEUP   = 0x0040 ;\nconst int MOUSEEVENTF_WHEEL      = 0x0080 ;\nconst int MOUSEEVENTF_XDOWN      = 0x0100 ;\nconst int MOUSEEVENTF_XUP        = 0x0200 ;\nconst int MOUSEEVENTF_ABSOLUTE   = 0x8000 ;\nconst int screen_length          = 0x10000 ;\n//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646310(v=vs.85).aspx\n[System.Runtime.InteropServices.DllImport(\"user32.dll\")]\nextern static uint SendInput(uint nInputs, INPUT[] pInputs, int cbSize);\npublic static void LeftClickAtPoint(int x, int y)\n{\n    //Move the mouse\n    INPUT[] input = new INPUT[3];\n    input[0].mi.dx = x*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width);\n    input[0].mi.dy = y*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height);\n    input[0].mi.dwFlags = MOUSEEVENTF_MOVED | MOUSEEVENTF_ABSOLUTE;\n    //Left mouse button down\n    input[1].mi.dwFlags = MOUSEEVENTF_LEFTDOWN;\n    //Left mouse button up\n    input[2].mi.dwFlags = MOUSEEVENTF_LEFTUP;\n    SendInput(3, input, Marshal.SizeOf(input[0]));\n}\n}\n'@\n</code></pre> <p><code>Add-Type -TypeDefinition $cSource -ReferencedAssemblies System.Windows.Forms,System.Drawing</code> <code>[Clicker]::LeftClickAtPoint(1900,1070)</code></p>"},{"location":"dotNET/#audio","title":"Audio","text":"<pre><code>Add-Type -Language CsharpVersion3 -TypeDefinition @\"\nusing System.Runtime.InteropServices;\n[Guid(\"5CDF2C82-841E-4546-9722-0CF74078229A\"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]\ninterface IAudioEndpointVolume {\n// f(), g(), ... are unused COM method slots. Define these if you care\nint f(); int g(); int h(); int i();\nint SetMasterVolumeLevelScalar(float fLevel, System.Guid pguidEventContext);\nint j();\nint GetMasterVolumeLevelScalar(out float pfLevel);\nint k(); int l(); int m(); int n();\nint SetMute([MarshalAs(UnmanagedType.Bool)] bool bMute, System.Guid pguidEventContext);\nint GetMute(out bool pbMute);\n}\n[Guid(\"D666063F-1587-4E43-81F1-B948E807363F\"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]\ninterface IMMDevice {\nint Activate(ref System.Guid id, int clsCtx, int activationParams, out IAudioEndpointVolume aev);\n}\n[Guid(\"A95664D2-9614-4F35-A746-DE8DB63617E6\"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]\ninterface IMMDeviceEnumerator {\nint f(); // Unused\nint GetDefaultAudioEndpoint(int dataFlow, int role, out IMMDevice endpoint);\n}\n[ComImport, Guid(\"BCDE0395-E52F-467C-8E3D-C4579291692E\")] class MMDeviceEnumeratorComObject { }\npublic class Audio {\nstatic IAudioEndpointVolume Vol() {\nvar enumerator = new MMDeviceEnumeratorComObject() as IMMDeviceEnumerator;\nIMMDevice dev = null;\nMarshal.ThrowExceptionForHR(enumerator.GetDefaultAudioEndpoint(/*eRender*/ 0, /*eMultimedia*/ 1, out dev));\nIAudioEndpointVolume epv = null;\nvar epvid = typeof(IAudioEndpointVolume).GUID;\nMarshal.ThrowExceptionForHR(dev.Activate(ref epvid, /*CLSCTX_ALL*/ 23, 0, out epv));\nreturn epv;\n}\npublic static float Volume {\nget {float v = -1; Marshal.ThrowExceptionForHR(Vol().GetMasterVolumeLevelScalar(out v)); return v;}\nset {Marshal.ThrowExceptionForHR(Vol().SetMasterVolumeLevelScalar(value, System.Guid.Empty));}\n}\npublic static bool Mute {\nget { bool mute; Marshal.ThrowExceptionForHR(Vol().GetMute(out mute)); return mute; }\nset { Marshal.ThrowExceptionForHR(Vol().SetMute(value, System.Guid.Empty)); }\n}\n}\n\"@\n</code></pre> <p><code>[Audio]::Volume = 0.50</code> <code>[Audio]::Mute = $true</code></p>"},{"location":"dotNET/#netsessionenum","title":"NetSessionEnum","text":"<p>Function Source</p> <pre><code>function Invoke-NetSessionEnum {\nparam (\n[Parameter(Mandatory = $True)][string]$HostName\n)\nAdd-Type -TypeDefinition @\"\nusing System;\nusing System.Diagnostics;\nusing System.Runtime.InteropServices;\n[StructLayout(LayoutKind.Sequential)]\npublic struct SESSION_INFO_10\n{\n    [MarshalAs(UnmanagedType.LPWStr)]public string OriginatingHost;\n    [MarshalAs(UnmanagedType.LPWStr)]public string DomainUser;\n    public uint SessionTime;\n    public uint IdleTime;\n}\npublic static class Netapi32\n{\n[DllImport(\"Netapi32.dll\", SetLastError=true)]\n    public static extern int NetSessionEnum(\n        [In,MarshalAs(UnmanagedType.LPWStr)] string ServerName,\n        [In,MarshalAs(UnmanagedType.LPWStr)] string UncClientName,\n        [In,MarshalAs(UnmanagedType.LPWStr)] string UserName,\n        Int32 Level,\n        out IntPtr bufptr,\n        int prefmaxlen,\n        ref Int32 entriesread,\n        ref Int32 totalentries,\n        ref Int32 resume_handle);\n\n[DllImport(\"Netapi32.dll\", SetLastError=true)]\n    public static extern int NetApiBufferFree(\n        IntPtr Buffer);\n}\n\"@\n# Create SessionInfo10 Struct\n$SessionInfo10 = New-Object SESSION_INFO_10\n$SessionInfo10StructSize = [System.Runtime.InteropServices.Marshal]::SizeOf($SessionInfo10)` Grab size to loop bufptr\n$SessionInfo10 = $SessionInfo10.GetType()` Hacky, but we need this ;))\n# NetSessionEnum params\n$OutBuffPtr = [IntPtr]::Zero` Struct output buffer\n$EntriesRead = $TotalEntries = $ResumeHandle = 0` Counters &amp; ResumeHandle\n$CallResult = [Netapi32]::NetSessionEnum($HostName, \"\", \"\", 10, [ref]$OutBuffPtr, -1, [ref]$EntriesRead, [ref]$TotalEntries, [ref]$ResumeHandle)\nif ($CallResult -ne 0){\necho \"Mmm something went wrong!`nError Code: $CallResult\"\n}\nelse {\nif ([System.IntPtr]::Size -eq 4) {\necho \"`nNetapi32::NetSessionEnum Buffer Offset  --&gt; 0x$(\"{0:X8}\" -f $OutBuffPtr.ToInt32())\"\n}\nelse {\necho \"`nNetapi32::NetSessionEnum Buffer Offset  --&gt; 0x$(\"{0:X16}\" -f $OutBuffPtr.ToInt64())\"\n}\necho \"Result-set contains $EntriesRead session(s)!\"\n# Change buffer offset to int\n$BufferOffset = $OutBuffPtr.ToInt64()\n# Loop buffer entries and cast pointers as SessionInfo10\nfor ($Count = 0; ($Count -lt $EntriesRead); $Count++){\n$NewIntPtr = New-Object System.Intptr -ArgumentList $BufferOffset\n$Info = [system.runtime.interopservices.marshal]::PtrToStructure($NewIntPtr,[type]$SessionInfo10)\n$Info\n$BufferOffset = $BufferOffset + $SessionInfo10StructSize\n}\necho \"`nCalling NetApiBufferFree, no memleaks here!\"\n[Netapi32]::NetApiBufferFree($OutBuffPtr) |Out-Null\n}\n}\n</code></pre> <p><code>Invoke-NetSessionEnum localhost</code></p>"},{"location":"dotNET/#copyfile","title":"CopyFile","text":"<p>Function Source</p> <pre><code>$MethodDefinition = @\"\n[DllImport(\"kernel32.dll\", CharSet = CharSet.Unicode)]\npublic static extern bool CopyFile(string lpExistingFileName, string lpNewFileName, bool bFailIfExists);\n\"@\n$Kernel32 = Add-Type -MemberDefinition $MethodDefinition -Name \"Kernel32\" -Namespace \"Win32\" -PassThru\n$Kernel32::CopyFile(\"$($Env:SystemRoot)\\System32\\calc.exe\", \"$($Env:USERPROFILE)\\Desktop\\calc.exe\", $False) \n</code></pre>"},{"location":"dotNET/#showwindowasync","title":"ShowWindowAsync","text":"<p>Function</p> <pre><code>$Signature = @\"\n[DllImport(\"user32.dll\")]public static extern bool ShowWindowAsync(IntPtr hWnd, int nCmdShow);\n\"@\n$ShowWindowAsync = Add-Type -MemberDefinition $Signature -Name \"Win32ShowWindowAsync\" -Namespace Win32Functions -PassThru\n$ShowWindowAsync | Get-Member -Static\n$ShowWindowAsync::ShowWindowAsync((Get-Process -Id $pid).MainWindowHandle, 2)\n$ShowWindowAsync::ShowWindowAsync((Get-Process -Id $Pid).MainWindowHandle, 3)\n$ShowWindowAsync::ShowWindowAsync((Get-Process -Id $Pid).MainWindowHandle, 4)\n</code></pre>"},{"location":"dotNET/#getasynckeystate","title":"GetAsyncKeyState","text":"<p>Function</p> <p><code>Add-Type -AssemblyName System.Windows.Forms</code> <code>[int][System.Windows.Forms.Keys]::F1</code> \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043d\u043e\u043c\u0435\u0440 [Int] \u043a\u043b\u0430\u0432\u0438\u0448\u0438 \u043f\u043e \u0435\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e  <code>65..90 | % {\"{0} = {1}\" -f $_, [System.Windows.Forms.Keys]$_}</code> \u043f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0431\u0443\u043a\u0432 (A..Z)</p> <pre><code>function Get-ControlKey {\n$key = 112\n$Signature = @'\n[DllImport(\"user32.dll\", CharSet=CharSet.Auto, ExactSpelling=true)] \npublic static extern short GetAsyncKeyState(int virtualKeyCode); \n'@\nAdd-Type -MemberDefinition $Signature -Name Keyboard -Namespace PsOneApi\n[bool]([PsOneApi.Keyboard]::GetAsyncKeyState($key) -eq -32767)\n}\n\nWrite-Warning 'Press F1 to exit'\nwhile ($true) {\nWrite-Host '.' -NoNewline\nif (Get-ControlKey) {\nbreak\n}\nStart-Sleep -Seconds 0.5\n}\n</code></pre>"}]}