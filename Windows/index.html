
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Lifailon">
      
      
        <link rel="canonical" href="https://lifailon.github.io/Windows/">
      
      
        <link rel="prev" href="../Syntax/">
      
      
        <link rel="next" href="../FileSystem/">
      
      
      <link rel="icon" href="../Logo/PowerShell-Logo.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.20">
    
    
      
        <title>Windows - PowerShell Commands / RuDocs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CInter:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Inter"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/highlight/obsidian.min.css">
    
      <link rel="stylesheet" href="../assets/custom/headers.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#windows-event" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PowerShell Commands / RuDocs" class="md-header__button md-logo" aria-label="PowerShell Commands / RuDocs" data-md-component="logo">
      
  <img src="../Logo/PowerShell-Logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PowerShell Commands / RuDocs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Windows
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Lifailon/PS-Commands" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PowerShell Commands / RuDocs" class="md-nav__button md-logo" aria-label="PowerShell Commands / RuDocs" data-md-component="logo">
      
  <img src="../Logo/PowerShell-Logo.png" alt="logo">

    </a>
    PowerShell Commands / RuDocs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Lifailon/PS-Commands" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Start
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Syntax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PowerShell Syntax
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Operating System
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Operating System
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#windows-event" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Event
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows Event">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filter-xpathhashtable" class="md-nav__link">
    <span class="md-ellipsis">
      Filter XPath/Hashtable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reboot" class="md-nav__link">
    <span class="md-ellipsis">
      Reboot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logon" class="md-nav__link">
    <span class="md-ellipsis">
      Logon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventlog" class="md-nav__link">
    <span class="md-ellipsis">
      EventLog
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    <span class="md-ellipsis">
      Performance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defender" class="md-nav__link">
    <span class="md-ellipsis">
      Defender
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dism" class="md-nav__link">
    <span class="md-ellipsis">
      DISM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scheduled" class="md-nav__link">
    <span class="md-ellipsis">
      Scheduled
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#localaccounts" class="md-nav__link">
    <span class="md-ellipsis">
      LocalAccounts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#credential" class="md-nav__link">
    <span class="md-ellipsis">
      Credential
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regedit" class="md-nav__link">
    <span class="md-ellipsis">
      Regedit
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pki" class="md-nav__link">
    <span class="md-ellipsis">
      pki
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openssl" class="md-nav__link">
    <span class="md-ellipsis">
      OpenSSL
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wmi" class="md-nav__link">
    <span class="md-ellipsis">
      WMI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WMI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wmicim-windows-management-instrumentationcommon-information-model" class="md-nav__link">
    <span class="md-ellipsis">
      WMI/CIM (Windows Management Instrumentation/Common Information Model)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nla-network-level-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      NLA (Network Level Authentication)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oh-my-posh" class="md-nav__link">
    <span class="md-ellipsis">
      oh-my-posh
    </span>
  </a>
  
    <nav class="md-nav" aria-label="oh-my-posh">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#themes-performance" class="md-nav__link">
    <span class="md-ellipsis">
      themes-performance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-terminal" class="md-nav__link">
    <span class="md-ellipsis">
      Windows-Terminal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows-Terminal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terminal-icons" class="md-nav__link">
    <span class="md-ellipsis">
      Terminal-Icons
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-actions" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Actions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../FileSystem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File System
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Threads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threads
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dotNET/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    .NET
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../COM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    COM
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ServerManager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Manager
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ActiveDirectory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active Directory
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exchange/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microsoft Exchange
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Virtualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtualization
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../MarkupLanguages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markup Languages
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Zabbix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zabbix
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üê≥ Docker
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../DevOps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DevOps
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üêß Linux
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Node.js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node.js
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#windows-event" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Event
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows Event">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filter-xpathhashtable" class="md-nav__link">
    <span class="md-ellipsis">
      Filter XPath/Hashtable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reboot" class="md-nav__link">
    <span class="md-ellipsis">
      Reboot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logon" class="md-nav__link">
    <span class="md-ellipsis">
      Logon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventlog" class="md-nav__link">
    <span class="md-ellipsis">
      EventLog
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    <span class="md-ellipsis">
      Performance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defender" class="md-nav__link">
    <span class="md-ellipsis">
      Defender
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dism" class="md-nav__link">
    <span class="md-ellipsis">
      DISM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scheduled" class="md-nav__link">
    <span class="md-ellipsis">
      Scheduled
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#localaccounts" class="md-nav__link">
    <span class="md-ellipsis">
      LocalAccounts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#credential" class="md-nav__link">
    <span class="md-ellipsis">
      Credential
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regedit" class="md-nav__link">
    <span class="md-ellipsis">
      Regedit
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pki" class="md-nav__link">
    <span class="md-ellipsis">
      pki
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openssl" class="md-nav__link">
    <span class="md-ellipsis">
      OpenSSL
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wmi" class="md-nav__link">
    <span class="md-ellipsis">
      WMI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WMI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wmicim-windows-management-instrumentationcommon-information-model" class="md-nav__link">
    <span class="md-ellipsis">
      WMI/CIM (Windows Management Instrumentation/Common Information Model)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nla-network-level-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      NLA (Network Level Authentication)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oh-my-posh" class="md-nav__link">
    <span class="md-ellipsis">
      oh-my-posh
    </span>
  </a>
  
    <nav class="md-nav" aria-label="oh-my-posh">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#themes-performance" class="md-nav__link">
    <span class="md-ellipsis">
      themes-performance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-terminal" class="md-nav__link">
    <span class="md-ellipsis">
      Windows-Terminal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows-Terminal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terminal-icons" class="md-nav__link">
    <span class="md-ellipsis">
      Terminal-Icons
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-actions" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Actions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Operating System</h1>

<h2 id="windows-event">Windows Event</h2>
<p><code>Get-WinEvent -ListLog *</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∂—É—Ä–Ω–∞–ª—ã –ª–æ–≥–æ–≤ <br />
<code>Get-WinEvent -ListLog * | where RecordCount -ne 0 | where RecordCount -ne $null | sort -Descending RecordCount</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–µ –ø—É—Å—Ç—ã–µ –∂—É—Ä–Ω–∞–ª—ã —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–æ –∫–æ–ª-–≤—É –∑–∞–ø–∏—Å–µ–π <br />
<code>Get-WinEvent -ListProvider * | ft</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π <br />
<code>Get-WinEvent -ListProvider GroupPolicy</code> –Ω–∞–π—Ç–∏ –≤ –∫–∞–∫–æ–π –∂—É—Ä–Ω–∞–ª LogLinks {Application} –ø–∏—à—É—Ç—Å—è –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è <br />
<code>Get-WinEvent -ListProvider *smb*</code> <br />
<code>Get-WinEvent -ListLog * | where logname -match SMB | sort -Descending RecordCount</code> –Ω–∞–π—Ç–∏ –≤—Å–µ –∂—É—Ä–Ω–∞–ª—ã –ø–æ –∏–º–µ–Ω–∏ <br />
<code>Get-WinEvent -LogName "Microsoft-Windows-SmbClient/Connectivity"</code> <br />
<code>Get-WinEvent -ListProvider *firewall*</code></p>
<h3 id="filter-xpathhashtable">Filter XPath/Hashtable</h3>
<p><code>Get-WinEvent -FilterHashtable @{LogName="Security";ID=4624}</code> –Ω–∞–π—Ç–∏ –ª–æ–≥–∏ –ø–æ ID –≤ –∂—É—Ä–Ω–∞–ª–µ Security <br />
<code>Get-WinEvent -FilterHashtable @{LogName="System";Level=2}</code> –Ω–∞–π—Ç–∏ –≤—Å–µ –∑–∞–ø–∏—Å–∏ –æ—à–∏–±–∫–∏ (1 - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π, 3 - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, 4 - —Å–≤–µ–¥–µ–Ω–∏—è) <br />
<code>Get-WinEvent -FilterHashtable @{LogName="System";Level=2;ProviderName="Service Control Manager"}</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –∏–º–µ–Ω–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞</p>
<p><code>([xml](Get-WinEvent -FilterHashtable @{LogName="Security";ID=4688} -MaxEvents 1).ToXml()).Event.EventData.Data</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞, —Ö—Ä–∞–Ω–∏–º—ã–µ –≤ EventData (Message) <br />
<code>Get-WinEvent -FilterHashtable @{logname="security";ID=4688} -MaxEvents 1 | select timecreated,{$_.Properties[5].value}</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è –∏ –∏–º—è –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞</p>
<pre><code>$query = '
&lt;QueryList&gt;
    &lt;Query Id=&quot;0&quot; Path=&quot;Security&quot;&gt;
        &lt;Select Path=&quot;Security&quot;&gt;
            *[System[EventID=4688]] and 
            *[EventData[Data[@Name=&quot;NewProcessName&quot;]=&quot;C:\Windows\System32\autochk.exe&quot; or Data[@Name=&quot;NewProcessName&quot;]=&quot;C:\Windows\System32\services.exe&quot;]]
        &lt;/Select&gt;
    &lt;/Query&gt;
&lt;/QueryList&gt;
'

Get-WinEvent -LogName Security -FilterXPath $query
</code></pre>
<h3 id="reboot">Reboot</h3>
<pre><code>$query = '
&lt;QueryList&gt;
    &lt;Query Id=&quot;0&quot; Path=&quot;System&quot;&gt;
        &lt;Select Path=&quot;System&quot;&gt;
            *[
            System[
            EventID=41 or
            EventID=1074 or
            EventID=1076 or
            EventID=6005 or
            EventID=6006 or
            EventID=6008 or
            EventID=6009 or
            EventID=6013
            ]
            ]
        &lt;/Select&gt;
    &lt;/Query&gt;
&lt;/QueryList&gt;
'
Get-WinEvent -LogName System -FilterXPath $query

41  ` –°–∏—Å—Ç–µ–º–∞ –±—ã–ª–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞ –±–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã.
1074` –°–∏—Å—Ç–µ–º–∞ –±—ã–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã–∫–ª—é—á–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–º.
1076` –°–ª–µ–¥—É–µ—Ç –∑–∞ Event ID 6008 –∏ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–µ—Ä–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—Å –ø—Ä–∞–≤–æ–º –≤—ã–∫–ª—é—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã) –ø–æ–¥–∫–ª—é—á–∏–≤—à–∏–π—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ—Å–ª–µ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏—è, —É–∫–∞–∑–∞–ª –ø—Ä–∏—á–∏–Ω—É —ç—Ç–æ–≥–æ —Å–æ–±—ã—Ç–∏—è.
6005` –ó–∞–ø—É—Å–∫ &quot;–ñ—É—Ä–Ω–∞–ª–∞ —Å–æ–±—ã—Ç–∏–π Windows&quot; (Event Log). –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã.
6006` –û—Å—Ç–∞–Ω–æ–≤–∫–∞ ¬´–ñ—É—Ä–Ω–∞–ª–∞ —Å–æ–±—ã—Ç–∏–π Windows¬ª. –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã.
6008` –ü—Ä–µ–¥—ã–¥—É—â–µ–µ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –±—ã–ª–æ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º.
6009` –í–µ—Ä—Å–∏—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã.
6013` –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã (system uptime) –≤ —Å–µ–∫—É–Ω–¥–∞—Ö.
</code></pre>
<h3 id="logon">Logon</h3>
<pre><code class="language-PowerShell">$srv = &quot;localhost&quot;
$FilterXPath = '&lt;QueryList&gt;&lt;Query Id=&quot;0&quot;&gt;&lt;Select&gt;*[System[EventID=21]]&lt;/Select&gt;&lt;/Query&gt;&lt;/QueryList&gt;'
$RDPAuths = Get-WinEvent -ComputerName $srv -LogName &quot;Microsoft-Windows-TerminalServices-LocalSessionManager/Operational&quot; -FilterXPath $FilterXPath
[xml[]]$xml = $RDPAuths | Foreach {$_.ToXml()}
$EventData = Foreach ($event in $xml.Event) {
    New-Object PSObject -Property @{
        &quot;Connection Time&quot; = (Get-Date ($event.System.TimeCreated.SystemTime) -Format 'yyyy-MM-dd hh:mm K')
        &quot;User Name&quot; = $event.UserData.EventXML.User
        &quot;User ID&quot; = $event.UserData.EventXML.SessionID
        &quot;User Address&quot; = $event.UserData.EventXML.Address
        &quot;Event ID&quot; = $event.System.EventID
    }
}
$EventData | ft
</code></pre>
<h3 id="eventlog">EventLog</h3>
<p><code>Get-EventLog -List</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –∫–æ—Ä–Ω–µ–≤—ã–µ –∂—É—Ä–Ω–∞–ª—ã –ª–æ–≥–æ–≤ –∏ –∏—Ö —Ä–∞–∑–º–µ—Ä <br />
<code>Clear-EventLog Application</code> –æ—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∂—É—Ä–Ω–∞–ª–∞ <br />
<code>Get-EventLog -LogName Security -InstanceId 4624</code> –Ω–∞–π—Ç–∏ –ª–æ–≥–∏ –ø–æ ID –≤ –∂—É—Ä–Ω–∞–ª–µ Security</p>
<h2 id="performance">Performance</h2>
<p><code>lodctr /R</code> –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å—á–µ—Ç—á–∏–∫–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∞—Ä—Ö–∏–≤–æ–≤ (—Ç–∞–∫ –∂–µ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç —Å—á–µ—Ç—á–∏–∫–∏ –¥–ª—è CIM, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è cpu Win32_PerfFormattedData_PerfOS_Processor –∏ iops Win32_PerfFormattedData_PerfDisk_PhysicalDisk) <br />
<code>(Get-Counter -ListSet *).CounterSetName</code> –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—á–µ—Ç—á–∏–∫–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º–µ <br />
<code>(Get-Counter -ListSet *memory*).Counter</code> –ø–æ–∏—Å–∫ –ø–æ wildcard-–∏–º–µ–Ω–∏ –≤–æ –≤—Å–µ—Ö —Å—á–µ—Ç—á–∏–∫–∞—Ö (–≤–∫–ª—é—á–∞—è –¥–æ—á–µ—Ä–Ω–∏–∏) <br />
<code>Get-Counter "\Memory\Available MBytes"</code> –æ–±—ä–µ–º —Å–≤–æ–±–æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ <br />
<code>Get-Counter -cn $srv "\LogicalDisk(*)\% Free Space"</code> % —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö –¥–∏—Å–∫–æ–≤ <br />
<code>(Get-Counter "\Process(*)\ID Process").CounterSamples</code> <br />
<code>Get-Counter "\Processor(_Total)\% Processor Time" ‚ÄìComputerName $srv -MaxSamples 5 -SampleInterval 2</code> 5 –ø—Ä–æ–≤–µ—Ä–æ–∫ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã <br />
<code>Get-Counter "\–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä(_Total)\% –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞" -Continuous</code> –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ <br />
<code>(Get-Counter "\–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä(*)\% –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞").CounterSamples</code></p>
<p><code>(Get-Counter -ListSet *–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å*).Counter</code> –Ω–∞–π—Ç–∏ –≤—Å–µ —Å—á–µ—Ç—á–∏–∫–∏ <br />
<code>Get-Counter "\–°–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å(*)\–í—Å–µ–≥–æ –±–∞–π—Ç/—Å"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –∞–¥–∞–ø—Ç–µ—Ä—ã (–≤—ã–±—Ä–∞—Ç—å –¥–µ–π—Å—Ç–≤—É—é—â–∏–π –ø–æ —Ç—Ä–∞—Ñ–∏–∫—É)</p>
<pre><code class="language-PowerShell">$WARNING = 25
$CRITICAL = 50
$TransferRate = ((Get-Counter &quot;\\huawei-mb-x-pro\—Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å(intel[r] wi-fi 6e ax211 160mhz)\–≤—Å–µ–≥–æ –±–∞–π—Ç/—Å&quot;
).countersamples | select -ExpandProperty CookedValue)*8
$NetworkUtilisation = [math]::round($TransferRate/1000000000*100,2)
if ($NetworkUtilisation -gt $CRITICAL){
Write-Output &quot;CRITICAL: $($NetworkUtilisation) % Network utilisation, $($TransferRate.ToString('N0')) b/s&quot;   
#exit 2     
}
if ($NetworkUtilisation -gt $WARNING){
Write-Output &quot;WARNING: $($NetworkUtilisation) % Network utilisation, $($TransferRate.ToString('N0')) b/s&quot;
#exit 1
}
Write-Output &quot;OK: $($NetworkUtilisation) % Network utilisation, $($TransferRate.ToString('N0')) b/s&quot;   
#exit 0
</code></pre>
<h2 id="defender">Defender</h2>
<p><code>Import-Module Defender</code> <br />
<code>Get-Command -Module Defender</code> <br />
<code>Get-MpComputerStatus</code> <br />
<code>(Get-MpComputerStatus).AntivirusEnabled</code> —Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞</p>
<p><code>$session = NewCimSession -ComputerName hostname</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —É–¥–∞–ª–µ–Ω–Ω–æ–º—É –∫–æ–º–ø—å—é—Ç–µ—Ä—É, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è WinRM <br />
<code>Get-MpComputerStatus -CimSession $session | fl fullscan*</code> —É–∑–Ω–∞—Ç—å –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ</p>
<p><code>Get-MpPreference</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ <br />
<code>(Get-MpPreference).ScanPurgeItemsAfterDelay</code> –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –∂—É—Ä–Ω–∞–ª–∞ –∑–∞—â–∏—Ç–Ω–∏–∫–∞ –≤ –¥–Ω—è—Ö <br />
<code>Set-MpPreference -ScanPurgeItemsAfterDelay 30</code> –∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è <br />
<code>ls "C:\ProgramData\Microsoft\Windows Defender\Scans\History"</code> <br />
<code>Get-MpPreference | select disable*</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –≤–∏–¥–æ–≤ –ø—Ä–æ–≤–µ—Ä–æ–∫/—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–π <br />
<code>Set-MpPreference -DisableRealtimeMonitoring $true</code> –æ—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É Defender –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ä—É—á–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ) <br />
<code>Set-MpPreference -DisableRemovableDriveScanning $false</code> –≤–∫–ª—é—á–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ USB –Ω–∞–∫–æ–ø–∏—Ç–µ–ª–µ–π <br />
<code>Get-MpPreference | select excl*</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π <br />
<code>(Get-MpPreference).ExclusionPath</code> <br />
<code>Add-MpPreference -ExclusionPath C:\install</code> –¥–æ–±–∞–≤–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ <br />
<code>Remove-MpPreference -ExclusionPath C:\install</code> —É–¥–∞–ª–∏—Ç—å –∏–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏—è <br />
<code>New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force</code> –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å Windows Defender</p>
<p><code>Set-MpPreference -SignatureDefinitionUpdateFileSharesSources \\FileShare1\Updates</code> –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ —Å–µ—Ç–µ–≤–æ–π –ø–∞–ø–∫–∏ –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª—ã —Å —Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º–∏ –±–∞–∑ —Å —Å–∞–π—Ç–∞ https://www.microsoft.com/security/portal/definitions/adl.aspx –∏ –ø–æ–º–µ—Å—Ç–∏—Ç—å –≤ —Å–µ—Ç–µ–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥<br />
<code>Update-MpSignature -UpdateSource FileShares</code> –∏–∑–º–µ–Ω–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (MicrosoftUpdateServer ‚Äì —Å–µ—Ä–≤–µ—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π MS –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ, InternalDefinitionUpdateServer ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π WSUS —Å–µ—Ä–≤–µ—Ä) <br />
<code>Update-MpSignature</code> –æ–±–Ω–æ–≤–∏—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—ã</p>
<p><code>Start-MpScan -ScanType QuickScan</code> –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–ª–∏ FullScan <br />
<code>Start-MpScan -ScanType FullScan -AsJob</code> <br />
<code>Set-MpPreference -RemediationScheduleDay 1-7</code> –≤—ã–±—Ä–∞—Ç—å –¥–Ω–∏, –Ω–∞—á–∏–Ω–∞—è —Å –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è –∏–ª–∏ 0 –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, 8 - —Å–±—Ä–æ—Å–∏—Ç—å <br />
<code>Set-MpPreference -ScanScheduleQuickScanTime 14:00:00</code> <br />
<code>Start-MpScan -ScanType CustomScan -ScanPath "C:\Program Files"</code> —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é</p>
<p><code>Get-MpThreat</code> –∏—Å—Ç–æ—Ä–∏—è —É–≥—Ä–æ–∑ –∏ —Ç–∏–ø —É–≥—Ä–æ–∑—ã (ThreatName: HackTool/Trojan) <br />
<code>Get-MpThreatCatalog</code> —Å–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –≤–∏–¥–æ–≤ —É–≥—Ä–æ–∑ <br />
<code>Get-MpThreatDetection</code> –∏—Å—Ç–æ—Ä–∏—è –∑–∞—â–∏—Ç—ã (–∞–∫—Ç–∏–≤–Ω—ã—Ö –∏ –ø—Ä–æ—à–ª—ã–µ) –∏ ID —É–≥—Ä–æ–∑—ã <br />
<code>Get-MpThreat -ThreatID 2147760253</code></p>
<p><code>ls "C:\ProgramData\Microsoft\Windows Defender\Quarantine\"</code> –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –≤ –∫–∞—Ä–∞–Ω—Ç–∏–Ω–µ <br />
<code>cd "C:\Program Files\Windows Defender\"</code> <br />
<code>.\MpCmdRun.exe -restore -name $ThreatName</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª –∏–∑ –∫–∞—Ä–∞–Ω—Ç–∏–Ω–∞ <br />
<code>.\MpCmdRun.exe -restore -filepath $path_file</code></p>
<h2 id="dism">DISM</h2>
<p><code>Get-Command -Module Dism -Name *Driver*</code> <br />
<code>Export-WindowsDriver -Online -Destination C:\Users\Lifailon\Documents\Drivers\</code> –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏–∑ —Ç–µ–∫—É—â–µ–π —Å–∏—Å—Ç–µ–º—ã (C:\Windows\System32\DriverStore\FileRepository), –≤—ã–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞ (dll,sys,exe) –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å–ø–∏—Å–∫–æ–º —Ñ–∞–π–ª–æ–≤, —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤ —Å–µ–∫—Ü–∏–∏ [CopyFiles] inf-—Ñ–∞–π–ª–∞ –¥—Ä–∞–π–≤–µ—Ä–∞. <br />
<code>Export-WindowsDriver -Path C:\win_image -Destination C:\drivers</code> –∏–∑–≤–ª–µ—á—å –¥—Ä–∞–π–≤–µ—Ä–∞ –∏–∑ –æ—Ñ–ª–∞–π–Ω –æ–±—Ä–∞–∑–∞ Windows, —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤ –∫–∞—Ç–∞–ª–æ–≥ c:\win_image <br />
<code>$BackupDrivers = Export-WindowsDriver -Online -Destination C:\Drivers</code> <br />
<code>$BackupDrivers | ft Driver,ClassName,ProviderName,Date,Version,ClassDescription</code> —Å–ø–∏—Å–æ–∫ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –≤ –æ–±—ä–µ–∫—Ç–Ω–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ <br />
<code>$BackupDrivers | where classname -match printer</code> <br />
<code>pnputil.exe /add-driver C:\drivers\*.inf /subdirs /install</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ (–ø–∞—Ä–∞–º–µ—Ç—Ä subdirs) –¥—Ä–∞–π–≤–µ—Ä–∞ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–∏ (–≤–∫–ª—é—á–∞—è –≤–ª–æ–∂–µ–Ω–Ω—ã–µ)</p>
<p><code>sfc /scannow</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å –ø–æ–º–æ—â—å—é —É—Ç–∏–ª–∏—Ç—ã SFC (System File Checker), –≤ —Å–ª—É—á–∞–µ –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫, –ø–æ–ø—Ä–æ–±—É–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Ö –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∫–æ–ø–∏–∏ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Windows (–∫–∞—Ç–∞–ª–æ–≥ C:\Windows\WinSxS). –í—ã–≤–æ–¥ —Ä–∞–±–æ—Ç—ã –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ C:\Windows\Logs\CBS —Å —Ç–µ–≥–æ–º SR <br />
<code>Get-ComputerInfo | select *</code> –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ (WindowsVersion,WindowsEditionId,<em>Bios</em>) <br />
<code>Get-WindowsImage -ImagePath E:\sources\install.wim</code> —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–µ—Ä—Å–∏–π –≤ –æ–±—Ä–∞–∑–µ <br />
<code>Repair-WindowsImage -Online ‚ÄìScanHealth</code> <br />
<code>Repair-WindowsImage -Online -RestoreHealth</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ <br />
<code>Repair-WindowsImage -Online -RestoreHealth -Source E:\sources\install.wim:3 ‚ÄìLimitAccess</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–µ –∏–∑ –æ–±—Ä–∞–∑–∞ –ø–æ –Ω–æ–º–µ—Ä—É –∏–Ω–¥–µ–∫—Å–∞</p>
<h2 id="scheduled">Scheduled</h2>
<p><code>$Trigger = New-ScheduledTaskTrigger -At 01:00am -Daily</code> 1:00 –Ω–æ—á–∏ <br />
<code>$Trigger = New-ScheduledTaskTrigger ‚ÄìAtLogon</code> –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º—É <br />
<code>$Trigger = New-ScheduledTaskTrigger -AtStartup</code> –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–∏—Å—Ç–µ–º—ã <br />
<code>$User = "NT AUTHORITY\SYSTEM"</code> <br />
<code>$Action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "$home\Documents\DNS-Change-Tray-1.3.ps1"</code> <br />
<code>$Action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "-NoProfile -NoLogo -NonInteractive -ExecutionPolicy Unrestricted -WindowStyle Hidden -File $home\Documents\DNS-Change-Tray-1.3.ps1"</code> <br />
<code>Register-ScheduledTask -TaskName "DNS-Change-Tray-Startup" -Trigger $Trigger -User $User -Action $Action -RunLevel Highest ‚ÄìForce</code></p>
<p><code>Get-ScheduledTask | ? state -ne Disabled</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π <br />
<code>Start-ScheduledTask DNS-Change-Tray-Startup</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ <br />
<code>Get-ScheduledTask DNS-Change-Tray-Startup | Disable-ScheduledTask</code> –æ—Ç–∫–ª—é—á–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ <br />
<code>Get-ScheduledTask DNS-Change-Tray-Startup | Enable-ScheduledTask</code> –≤–∫–ª—é—á–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ <br />
<code>Unregister-ScheduledTask DNS-Change-Tray-Startup</code> —É–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ <br />
<code>Export-ScheduledTask DNS-Change-Tray-Startup | Out-File $home\Desktop\Task-Export-Startup.xml</code> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ –≤ xml <br />
<code>Register-ScheduledTask -Xml (Get-Content $home\Desktop\Task-Export-Startup.xml | Out-String) -TaskName "DNS-Change-Tray-Startup"</code></p>
<h2 id="localaccounts">LocalAccounts</h2>
<p><code>Get-Command -Module Microsoft.PowerShell.LocalAccounts</code> <br />
<code>Get-LocalUser</code> —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π <br />
<code>Get-LocalGroup</code> —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø <br />
<code>New-LocalUser "1C" -Password $Password -FullName "1C Domain"</code> —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code>Set-LocalUser -Password $Password 1C</code> –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å <br />
<code>Add-LocalGroupMember -Group "Administrators" -Member "1C"</code> –¥–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ <br />
<code>Get-LocalGroupMember "Administrators"</code> —á–ª–µ–Ω—ã –≥—Ä—É–ø–ø—ã</p>
<pre><code class="language-PowerShell">@(&quot;vproxy-01&quot;,&quot;vproxy-02&quot;,&quot;vproxy-03&quot;) | %{
    icm $_ {Add-LocalGroupMember -Group &quot;Administrators&quot; -Member &quot;support4&quot;}
    icm $_ {Get-LocalGroupMember &quot;Administrators&quot;}
}
</code></pre>
<h2 id="credential">Credential</h2>
<p><code>$Cred = Get-Credential</code> —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫—Ä–µ–¥—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ <code>$Cred.Username</code> –∏ <code>$Cred.Password</code> <br />
<code>$Cred.GetNetworkCredential().password</code> –∏–∑–≤–ª–µ—á—å –ø–∞—Ä–æ–ª—å <br />
<code>cmdkey /generic:"TERMSRV/$srv" /user:"$username" /pass:"$password"</code> –¥–æ–±–∞–≤–∏—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫—Ä–µ–¥—ã –∞—É–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ –Ω–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–µ–∑ –ø–∞—Ä–æ–ª—è <br />
<code>mstsc /admin /v:$srv</code> –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è <br />
<code>cmdkey /delete:"TERMSRV/$srv"</code> —É–¥–∞–ª–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∫—Ä–µ–¥—ã –∞—É–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã <br />
<code>rundll32.exe keymgr.dll,KRShowKeyMgr</code> —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Stored User Names and Password <br />
<code>Get-Service VaultSvc</code> —Å–ª—É–∂–±–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã Credential Manager <br />
<code>Install-Module CredentialManager</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Credential Manager –∫ —Ö—Ä–∞–Ω–∏–ª–∏—â—É PasswordVault –∏–∑ PowerShell <br />
<code>[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]'Tls11,Tls12'</code> –¥–ª—è —É—Å—Ç–∞–Ω–æ–∫–∏ –º–æ–¥—É–ª—è <br />
<code>Get-StoredCredential</code> –ø–æ–ª—É—á–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ Windows Vault <br />
<code>Get-StrongPassword</code> –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª—è <br />
<code>New-StoredCredential -UserName test -Password "123456"</code> –¥–æ–±–∞–≤–∏—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å <br />
<code>Remove-StoredCredential</code> —É–¥–∞–ª–∏—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å <br />
<code>$Cred = Get-StoredCredential | where {$_.username -match "admin"}</code> <br />
<code>$pass = $cred.password</code> <br />
<code>$BSTR = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pass)</code> <br />
<code>[System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)</code></p>
<h2 id="regedit">Regedit</h2>
<p><code>Get-PSDrive</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∏—Å–∫–æ–≤/—Ä–∞–∑–¥–µ–ª–æ–≤, –∏—Ö —Ä–∞–∑–º–µ—Ä –∏ –≤–µ—Ç–æ–∫ —Ä–µ–µ—Å—Ç—Ä–∞ <br />
<code>cd HKLM:\</code> HKEY_LOCAL_MACHINE <br />
<code>cd HKCU:\</code> HKEY_CURRENT_USER <br />
<code>Get-Item</code> –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–µ—Ç–∫–µ —Ä–µ–µ—Å—Ç—Ä–∞ <br />
<code>New-Item</code> —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª —Ä–µ–µ—Å—Ç—Ä–∞ <br />
<code>Remove-Item</code> —É–¥–∞–ª–∏—Ç—å –≤–µ—Ç–∫—É —Ä–µ–µ—Å—Ç—Ä–∞ <br />
<code>Get-ItemProperty</code> –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π/–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–µ—Å—Ç—Ä–∞ (—ç—Ç–æ —Å–≤–æ–π—Å—Ç–≤–∞ –≤–µ—Ç–∫–∏ —Ä–µ–µ—Å—Ç—Ä–∞, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–≤–æ–π—Å—Ç–≤–∞–º —Ñ–∞–π–ª–∞) <br />
<code>Set-ItemProperty</code> –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–µ–µ—Å—Ç—Ä–∞ <br />
<code>New-ItemProperty</code> —Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞ <br />
<code>Remove-ItemProperty</code> —É–¥–∞–ª–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä</p>
<p><code>Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Select DisplayName</code> —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º <br />
<code>Get-Item HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002</code> –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ Items <br />
<code>(Get-ItemProperty HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002)."New Signature"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (Value) —Å–≤–æ–π—Å—Ç–≤–∞ (Property) Items <br />
<code>$reg_path = "HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002"</code> <br />
<code>$sig_name = "auto"</code> <br />
<code>Set-ItemProperty -Path $reg_path -Name "New Signature" -Value $sig_name</code> –∏–∑–º–µ–Ω–∏—Ç—å –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–Ω–µ –≤–µ—Ç–∫–∏ (Path) —Å–≤–æ–π—Å—Ç–≤–æ (Name) —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º (Value) <br />
<code>Set-ItemProperty -Path $reg_path -Name "Reply-Forward Signature" -Value $sig_name</code></p>
<pre><code>Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\taskmgr.exe]
&quot;Debugger&quot;=&quot;\&quot;C:\\Windows\\System32\\Taskmgr.exe\&quot;&quot;
</code></pre>
<h2 id="pki">pki</h2>
<p><code>New-SelfSignedCertificate -CertStoreLocation Cert:\LocalMachine\My -DnsName "$env:computername" -FriendlyName "Test Certificate" -NotAfter (Get-Date).AddYears(5)</code> —Å–æ–∑–¥–∞—Ç—å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–≤ LocalMachine\My - –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∫–æ–º–ø—å—é—Ç–µ—Ä–∞\–õ–∏—á–Ω–æ–µ) —Å —Å—Ä–æ–∫–æ–º –¥–µ–π—Å—Ç–≤–∏—è 5 –ª–µ—Ç</p>
<p><code>Get-ChildItem -Path Cert:\CurrentUser\Root\</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –î–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ –¶–° –¢–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code>Get-ChildItem -Path Cert:\CurrentUser\My\</code> —Å–ø–∏—Å–æ–∫ —Å–∞–º–æ–∑–∞–≤–µ—Ä—è—é—â–∏—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ –õ–∏—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¢–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code>Get-ChildItem -Path Cert:\LocalMachine\My\</code> —Å–ø–∏—Å–æ–∫ —Å–∞–º–æ–∑–∞–≤–µ—Ä—è—é—â–∏—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ –õ–∏—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –õ–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ <br />
<code>Get-ChildItem -Path Cert:\LocalMachine\My\ | select NotBefore,NotAfter,Thumbprint,Subject</code> —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ <br />
<code>Get-ChildItem -Path Cert:\LocalMachine\My\ | where Thumbprint -eq D9356FB774EE0E6206B7D5B59B99102CA5B17BDA</code> –ø–æ–∏—Å–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ –æ—Ç–ø–µ—á–∞—Ç–∫—É</p>
<p><code>Get-ChildItem -Path $env:APPDATA\Microsoft\SystemCertificates\My\Certificates\</code> —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ, –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É –≤ –ª–∏—á–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code>Get-ChildItem -Path $env:APPDATA\Microsoft\SystemCertificates\My\Keys\</code> —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—ä–µ–∫—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã—Ö –∫–ª—é—á–µ–π, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∫–ª—é—á–µ–π (KSP) <br />
<code>Get-ChildItem -Path HKCU:\Software\Microsoft\SystemCertificates\CA\Certificates | ft -AutoSize</code> —Å–ø–∏—Å–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ —Ä–µ–µ—Å—Ç—Ä–µ –≤–æ—à–µ–¥—à–µ–≥–æ –≤ —Å–∏—Å—Ç–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
<p><code>$cert = (Get-ChildItem -Path Cert:\CurrentUser\My\)[1]</code> –≤—ã–±—Ä–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç <br />
<code>$cert | Remove-Item</code> —É–¥–∞–ª–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</p>
<p><code>Export-Certificate -FilePath $home\Desktop\certificate.cer -Cert $cert</code> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç <br />
<code>$cert.HasPrivateKey</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ <br />
<code>$pass = "password" | ConvertTo-SecureString -AsPlainText -Force</code> —Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ <br />
<code>Export-PfxCertificate -FilePath $home\Desktop\certificate.pfx -Password $pass -Cert $certificate</code> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å –∑–∞–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–µ–º</p>
<p><code>Import-Certificate -FilePath $home\Desktop\certificate.cer -CertStoreLocation Cert:\CurrentUser\My</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç <br />
<code>Import-PfxCertificate -Exportable -Password $pass -CertStoreLocation Cert:\CurrentUser\My -FilePath $home\Desktop\certificate.pfx</code></p>
<h2 id="openssl">OpenSSL</h2>
<pre><code class="language-PowerShell">Invoke-WebRequest -Uri https://slproweb.com/download/Win64OpenSSL_Light-3_1_1.msi -OutFile $home\Downloads\OpenSSL-Light-3.1.1.msi
Start-Process $home\Downloads\OpenSSL-Light-3.1.1.msi -ArgumentList '/quiet' -Wait` —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å msi –ø–∞–∫–µ—Ç –≤ —Ç–∏—Ö–æ–º —Ä–µ–∂–∏–º–µ (–∑–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
rm $home\Downloads\OpenSSL-Light-3.1.1.msi
cd &quot;C:\Program Files\OpenSSL-Win64\bin&quot;
</code></pre>
<ul>
<li>
<p>–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è PFX <br />
<code>openssl pkcs12 -in "C:\Cert\domain.ru.pfx" -out "C:\Cert\domain.ru.pem" -nodes</code> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∏–º–µ—é—â–∏–π—Å—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á –≤ .pem-—Ñ–∞–π–ª –±–µ–∑ –ø–∞—Ä–æ–ª—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–∞—Ä–æ–ª—è <br />
<code>openssl pkcs12 -export -in "C:\Cert\domain.ru.pem" -out "C:\Cert\domain.ru_password.pfx" -nodes</code> –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º .pem –æ–±—Ä–∞—Ç–Ω–æ –≤ .pfx c —É–∫–∞–∑–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è</p>
</li>
<li>
<p>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∏ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ PEM –≤ PFX <br />
<code>openssl pkcs12 -export -in "C:\tmp\vpn\vpn.itproblog.ru-crt.pem" -inkey "C:\tmp\vpn\vpn.itproblog.ru-key.pem" -out "C:\tmp\vpn\vpn.iiproblog.ru.pfx"</code> <br />
in ‚Äì –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–æ–º <br />
inkey ‚Äì –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞ —Å –∑–∞–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–æ–º <br />
out ‚Äì –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (pfx)</p>
</li>
<li>
<p>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PFX –≤ CRT <br />
<code>openssl pkcs12 -in "C:\OpenSSL-Win64\bin\_.domain.ru.pfx" -clcerts -out "C:\OpenSSL-Win64\bin\_.domain.ru.crt"</code> —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–π –∏ 2 —Ä–∞–∑–∞ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å PEM pass phrase (—Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç EGIN CERTIFICATE –∏ BEGIN ENCRYPTED PRIVATE KEY) <br />
<code>openssl pkcs12 -in "C:\OpenSSL-Win64\bin\_.domain.ru.pfx" -clcerts -nokeys -out "C:\OpenSSL-Win64\bin\_.domain.ru.crt"</code> –±–µ–∑ –∫–ª—é—á–∞, –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç—É—é —á–∞—Å—Ç—å (—Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ EGIN CERTIFICATE)</p>
</li>
<li>
<p>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PFX –≤ KEY <br />
<code>openssl pkcs12 -in "C:\OpenSSL-Win64\bin\_.domain.ru.pfx" -nocerts -out "C:\OpenSSL-Win64\bin\_.domain.ru.key"</code> —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ BEGIN ENCRYPTED PRIVATE KEY</p>
</li>
<li>
<p>–°–Ω—è—Ç—å –ø–∞—Ä–æ–ª—å –∫ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ .key <br />
<code>openssl rsa -in "C:\OpenSSL-Win64\bin\_.domain.ru.key" -out "C:\OpenSSL-Win64\bin\_.domain.ru-decrypted.key"</code></p>
</li>
<li>
<p>CRT –∏ KEY –≤ PFX: <br />
<code>openssl pkcs12 -inkey certificate.key -in certificate.crt -export -out certificate.pfx</code></p>
</li>
</ul>
<h2 id="wmi">WMI</h2>
<h3 id="wmicim-windows-management-instrumentationcommon-information-model">WMI/CIM (Windows Management Instrumentation/Common Information Model)</h3>
<p><code>Get-WmiObjec -ComputerName localhost -Namespace root -class "__NAMESPACE" | select name,__namespace</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –¥–æ—á–µ—Ä–Ω–∏–∏ Namespace (–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –≥—Ä—É–ø–ø—ã) <br />
<code>Get-WmiObject -List</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –∫–ª–∞—Å—Å—ã –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω "root\cimv2" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), —Å–≤–æ–π—Å—Ç–≤–∞ (–æ–ø–∏—Å—ã–≤–∞—é—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞) –∏ –∏—Ö –º–µ—Ç–æ–¥—ã (–∫–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞–¥ —ç—Ç–∏–º —Ä–µ—Å—É—Ä—Å–æ–º) <br />
<code>Get-WmiObject -List | Where-Object {$_.name -match "video"}</code> –ø–æ–∏—Å–∫ –∫–ª–∞—Å—Å–∞ –ø–æ –∏–º–µ–Ω–∏, –µ–≥–æ —Å–≤–æ–π—Å—Ç–≤ –∏ –º–µ—Ç–æ–¥–æ–≤ <br />
<code>Get-WmiObject -ComputerName localhost -Class Win32_VideoController</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–≤–æ–π—Å—Ç–≤ –∫–ª–∞—Å—Å–∞</p>
<p><code>gwmi -List | where name -match "service" | ft -auto</code> –µ—Å–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç Methods, —Ç–æ –º–æ–∂–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å {StartService, StopService} <br />
<code>gwmi -Class win32_service | select *</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–ª—É–∂–± –∏ –≤—Å–µ—Ö –∏—Ö —Å–≤–æ–π—Å—Ç–≤ <br />
<code>Get-CimInstance Win32_service</code> –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä—è–º—É—é –∫ "root\cimv2" <br />
<code>gwmi win32_service -Filter "name='Zabbix Agent'"</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ –∏–º–µ–Ω–∏ <br />
<code>(gwmi win32_service -Filter "name='Zabbix Agent'").State</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ <br />
<code>gwmi win32_service -Filter "State = 'Running'"</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ —Å–ª—É–∂–±—ã <br />
<code>gwmi win32_service -Filter "StartMode = 'Auto'"</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–ª—É–∂–±—ã –ø–æ –º–µ—Ç–æ–¥—É –∑–∞–ø—É—Å–∫–∞ <br />
<code>gwmi -Query 'select * from win32_service where startmode="Auto"'</code> WQL-–∑–∞–ø—Ä–æ—Å (WMI Query Language) <br />
<code>gwmi win32_service | Get-Member -MemberType Method</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –º–µ—Ç–æ–¥—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è (Delete, StartService) <br />
<code>(gwmi win32_service -Filter 'name="Zabbix Agent"').Delete()</code> —É–¥–∞–ª–∏—Ç—å —Å–ª—É–∂–±—É <br />
<code>(gwmi win32_service -Filter 'name="MSSQL$MSSQLE"').StartService()</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É</p>
<p><code>Get-CimInstance -ComputerName $srv Win32_OperatingSystem | select LastBootUpTime</code> –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è <br />
<code>gwmi -ComputerName $srv -Class Win32_OperatingSystem | select LocalDateTime,LastBootUpTime</code> —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è <br />
<code>gwmi Win32_OperatingSystem | Get-Member -MemberType Method</code> –º–µ—Ç–æ–¥—ã reboot –∏ shutdown <br />
<code>(gwmi Win32_OperatingSystem -EnableAllPrivileges).Reboot()</code> –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å –∫–ª—é—á–µ–º –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–µ–ª–µ–≥–∏–π <br />
<code>(gwmi Win32_OperatingSystem -EnableAllPrivileges).Win32Shutdown(0)</code> –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
<pre><code class="language-PowerShell">$system = Get-WmiObject -Class Win32_OperatingSystem
$InstallDate = [Management.ManagementDateTimeconverter]::ToDateTime($system.installdate)` –ü–æ–ª—É—á–∞–µ–º –¥–∞—Ç—É —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –û–°
$AfterInstallDays = ((Get-Date) ‚Äî $Installdate).Days` –í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è, –ø—Ä–æ—à–µ–¥—à–µ–µ —Å –º–æ–º–µ–Ω—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
$ShortInstallDate = &quot;{0:yyyy-MM-dd HH:MM}&quot; -f ($InstallDate)
&quot;–°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: $ShortInstallDate (–ü—Ä–æ—à–ª–æ $AfterInstalldays –¥–Ω–µ–π)&quot;
</code></pre>
<p><code>(Get-WmiObject win32_battery).estimatedChargeRemaining</code> –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö <br />
<code>gwmi Win32_UserAccount</code> –¥–æ–º–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ <br />
<code>(gwmi Win32_SystemUsers).PartComponent</code> <br />
<code>Get-CimInstance -ClassName Win32_LogonSession</code> <br />
<code>Get-CimInstance -ClassName Win32_BIOS</code></p>
<p><code>gwmi -list -Namespace root\CIMV2\Terminalservices</code> <br />
<code>(gwmi -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).AllowTSConnections</code> <br />
<code>(gwmi -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).SetAllowTSConnections(1)</code> –≤–∫–ª—é—á–∏—Ç—å RDP</p>
<pre><code>$srv = &quot;localhost&quot;
gwmi Win32_logicalDisk -ComputerName $srv | where {$_.Size -ne $null} | select @{
Label=&quot;Value&quot;; Expression={$_.DeviceID}}, @{Label=&quot;AllSize&quot;; Expression={
[string]([int]($_.Size/1Gb))+&quot; GB&quot;}},@{Label=&quot;FreeSize&quot;; Expression={
[string]([int]($_.FreeSpace/1Gb))+&quot; GB&quot;}}, @{Label=&quot;Free%&quot;; Expression={
[string]([int]($_.FreeSpace/$_.Size*100))+&quot; %&quot;}}
</code></pre>
<h3 id="nla-network-level-authentication">NLA (Network Level Authentication)</h3>
<p><code>(gwmi -class "Win32_TSGeneralSetting" -Namespace root\cimv2\Terminalservices -Filter "TerminalName='RDP-tcp'").UserAuthenticationRequired</code> <br />
<code>(gwmi -class "Win32_TSGeneralSetting" -Namespace root\cimv2\Terminalservices -Filter "TerminalName='RDP-tcp'").SetUserAuthenticationRequired(1)</code> –≤–∫–ª—é—á–∏—Ç—å NLA <br />
<code>Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name SecurityLayer</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (2) <br />
<code>Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name UserAuthentication</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (1) <br />
<code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name SecurityLayer -Value 0</code> –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ <br />
<code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name UserAuthentication -Value 0</code> <br />
<code>REG ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters /v AllowEncryptionOracle /t REG_DWORD /d 2</code> –æ—Ç–∫–ª—é—á–∏—Ç—å –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä–∫—É –≤–µ—Ä—Å–∏–∏ CredSSP, –µ—Å–ª–∏ –Ω–∞ —Ü–µ–ª–µ–≤–æ–º –∫–æ–º—å—é—Ç–µ—Ä–µ-—Å–µ—Ä–≤–µ—Ä–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è KB4512509 –æ—Ç –º–∞—è 2018 –≥–æ–¥–∞</p>
<h2 id="oh-my-posh">oh-my-posh</h2>
<p><a href="https://ohmyposh.dev/docs/installation/windows">Install</a></p>
<p><code>winget install JanDeDobbeleer.OhMyPosh -s winget</code> <br />
<code>choco install oh-my-posh -y</code> <br />
<code>scoop install https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/oh-my-posh.json</code> <br />
<code>Set-ExecutionPolicy Bypass -Scope Process -Force; Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://ohmyposh.dev/install.ps1'))</code></p>
<p><a href="https://ohmyposh.dev/docs/themes">Themes</a></p>
<p><code>Get-PoshThemes</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–µ–º <br />
<code>oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/di4am0nd.omp.json" | Invoke-Expression</code> –ø—Ä–∏–º–µ–Ω–∏—Ç—å (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å) —Ç–µ–º—É –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ <br />
<code>oh-my-posh init pwsh --config "https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/cert.omp.json" | Invoke-Expression</code> —Å—á–∏—Ç–∞—Ç—å —Ç–µ–º—É –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è <br />
<code>New-Item -Path $PROFILE -Type File -Force</code> —Å–æ–∑–¥–∞–π—Ç —Ñ–∞–π–ª –ø—Ä–æ—Ñ–∏–ª—å—è PowerShell <br />
<code>'oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/di4am0nd.omp.json" | Invoke-Expression' &gt; $PROFILE</code> —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–º—É –ø—Ä–æ—Ñ–∏–ª—è (–∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–µ–º—É –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ PowerShell)</p>
<h3 id="themes-performance">themes-performance</h3>
<p><code>Install-Module themes-performance -Repository NuGet</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å —Å —Ç–µ–º–∞–º–∏ <br />
<code>Set-PoshTheme -Theme System-Sensors</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–º—É —Å –¥–∞—Ç—á–∏–∫–∞–º–∏ –∏–∑ LibreHardwareMonitor <br />
<code>Set-PoshTheme -Theme System-Sensors -Save</code> –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–º—É –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–º—É –≤ –ø—Ä–æ—Ñ–∏–ª–µ <br />
<code>Set-PoshTheme -Theme System-Performance</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–º—É —Å –¥–∞—Ç—á–∏–∫–∞–º–∏ —Å–∏—Å—Ç–µ–º—ã, –ø–æ–ª—É—á–∞–µ–º—ã–º–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã WMI/CIM (–∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏ –Ω–æ—É—Ç–±—É–∫–∞ | –∑–∞–≥—Ä—É–∑–∫–∞ CPU –≤ % | –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ | —Å–∫–æ—Ä–æ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞) <br />
<code>Set-PoshTheme -Theme System-Performance -Save</code> <br />
<code>Set-PoshTheme -Theme Pwsh-Process-Performance</code> –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ pwsh (–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–µ –≤—Ä–µ–º—è), –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö/–æ–±—â–µ–µ (—Å—Ç–∞—Ç—É—Å —É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞) —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞–Ω–∏–π, Working Set —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ PowerShell –≤ —Å–∏—Å—Ç–µ–º–µ <br />
<code>Set-PoshTheme -Theme Pwsh-Process-Performance -Save</code></p>
<h2 id="windows-terminal">Windows-Terminal</h2>
<h3 id="terminal-icons">Terminal-Icons</h3>
<p><code>Install-Module -Name Terminal-Icons -Repository PSGallery</code> <br />
<code>scoop bucket add extras</code> <br />
<code>scoop install terminal-icons</code></p>
<p><code>notepad $PROFILE</code> <br />
<code>Import-Module -Name Terminal-Icons</code></p>
<p>–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —à—Ä–∏—Ñ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –ø—Ä–æ—Ñ–∏–ª—è PowerShell: <a href="https://github.com/ryanoasis/nerd-fonts">Nerd Fonts</a> <br />
<a href="https://www.nerdfonts.com/font-downloads">–°–ø–∏—Å–æ–∫ —à—Ä–∏—Ñ—Ç–æ–≤</a> <br />
–°–∫–∞—á–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —à—Ä–∏—Ñ—Ç –ø–æ—Ö–æ–∂–∏–π –Ω–∞ Cascadia Code - <a href="https://github.com/ryanoasis/nerd-fonts/releases/download/v3.1.1/CascadiaCode.zip">CaskaydiaCove</a></p>
<p>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —à—Ä–∏—Ñ—Ç –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Windows Terminal –¥–ª—è PowerShell Core:</p>
<pre><code class="language-json">&quot;profiles&quot;: 
{
    &quot;defaults&quot;: 
    {
        &quot;colorScheme&quot;: &quot;One Half Dark&quot;,
        &quot;experimental.retroTerminalEffect&quot;: true,
        &quot;font&quot;: 
        {
            &quot;size&quot;: 10.0
        },
        &quot;useAtlasEngine&quot;: true
    },
    &quot;list&quot;: 
    [
        // PowerShell Core
        {
            &quot;font&quot;: 
            {
                &quot;face&quot;: &quot;CaskaydiaMono Nerd Font&quot; // —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à—Ä–∏—Ñ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã Terminal-Icons
            },
            &quot;guid&quot;: &quot;{574e775e-4f2a-5b96-ac1e-a2962a402336}&quot;,
            &quot;hidden&quot;: false,
            &quot;name&quot;: &quot;PowerShell Core&quot;,
            &quot;source&quot;: &quot;Windows.Terminal.PowershellCore&quot;
        },
        // WSL (Ubuntu)
        {
            &quot;guid&quot;: &quot;{2c4de342-38b7-51cf-b940-2309a097f518}&quot;,
            &quot;hidden&quot;: false,
            &quot;name&quot;: &quot;WSL&quot;,
            &quot;source&quot;: &quot;Windows.Terminal.Wsl&quot;
        },
        // ssh
        {
            &quot;commandline&quot;: &quot;ssh lifailon@192.168.1.100 -p 22&quot;,
            &quot;guid&quot;: &quot;{a3ec86f6-2bc1-59dd-814d-2a0d935af5f8}&quot;,
            &quot;icon&quot;: &quot;üêß&quot;,
            &quot;name&quot;: &quot;devops-01&quot;
        }
    ]
}
</code></pre>
<h3 id="custom-actions">Custom Actions</h3>
<p>Custom actions: https://learn.microsoft.com/ru-ru/windows/terminal/customize-settings/actions <br />
Escape-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: https://learn.microsoft.com/ru-ru/cpp/c-language/escape-sequences?view=msvc-170</p>
<pre><code class="language-json">&quot;actions&quot;: 
[
    {
        &quot;command&quot;: 
        {
            &quot;action&quot;: &quot;copy&quot;,
            &quot;singleLine&quot;: false
        },
        &quot;keys&quot;: &quot;ctrl+c&quot;
    },
    {
        &quot;command&quot;: &quot;paste&quot;,
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é –≤—Å—Ç–∞–≤–∫—É –∏–Ω—Ç–µ—Ä–ø—Ä–∏—Ç–∞—Ç–æ—Ä–∞, –Ω–µ –∑–∞—Å—Ç–∞–≤–ª—è—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–¥ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ
        &quot;keys&quot;: &quot;ctrl+shift+v&quot; // default: ctrl+v
    },
    {
        &quot;command&quot;: &quot;find&quot;,
        &quot;keys&quot;: &quot;ctrl+f&quot; // default: ctrl+shift+f
    },
    {
        &quot;command&quot;: 
        {
            &quot;action&quot;: &quot;splitPane&quot;,
            &quot;split&quot;: &quot;left&quot;, // default: auto
            &quot;splitMode&quot;: &quot;duplicate&quot;
        },
        &quot;keys&quot;: &quot;ctrl+shift+d&quot; // default: alt+shift+d
    },
    // –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É
    {
        &quot;command&quot;: {
            &quot;action&quot;: &quot;sendInput&quot;,
            &quot;input&quot;: &quot;\u0001\u001b[3~&quot;
        },
        &quot;keys&quot;: &quot;ctrl+k&quot;
    },
    // –û—á–∏—Å—Ç–∏—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª
    {
        &quot;command&quot;: {
            &quot;action&quot;: &quot;sendInput&quot;,
            &quot;input&quot;: &quot;\u0001\u001b[3~clear\r&quot;
        },
        &quot;keys&quot;: &quot;ctrl+l&quot;
    },
    // –í—Å—Ç–∞–≤–∏—Ç—å —à–∞–±–ª–æ–Ω –º–æ–¥—É–ª—è –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ Google Translate
    {
        &quot;command&quot;: {
            &quot;action&quot;: &quot;sendInput&quot;,
            &quot;input&quot;: &quot;\u0001\u001b[3~Get-Translate -Alternatives -Provider Google ''\u001b[D&quot;
        },
        &quot;keys&quot;: &quot;ctrl+g&quot;
    },
    // –í—Å—Ç–∞–≤–∏—Ç—å —à–∞–±–ª–æ–Ω –º–æ–¥—É–ª—è –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ MyMemory
    {
        &quot;command&quot;: {
            &quot;action&quot;: &quot;sendInput&quot;,
            &quot;input&quot;: &quot;\u0001\u001b[3~Get-Translate -Alternatives -Provider MyMemory ''\u001b[D&quot;
        },
        &quot;keys&quot;: &quot;ctrl+q&quot;
    },
    // –ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞
    {
        &quot;command&quot;: {
            &quot;action&quot;: &quot;sendInput&quot;,
            &quot;input&quot;: &quot;\u0001\u001b[3~Get-Translate -Alternatives -Provider MyMemory -Text $(Get-Clipboard)\u001b[D\r&quot;
        },
        &quot;keys&quot;: &quot;ctrl+shift+q&quot;
    },
    // –ë—ã—Å—Ç—Ä—ã–π –ø–∏–Ω–≥ dns google
    {
        &quot;command&quot;: {
            &quot;action&quot;: &quot;sendInput&quot;,
            &quot;input&quot;: &quot;\u0001\u001b[3~ping 8.8.8.8 -t\r&quot;
        },
        &quot;keys&quot;: &quot;ctrl+p&quot;
    }
]
</code></pre>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright ¬© 2023-2024 Alex Kup (Lifailon)
    </div>
  
  
  PowerShell Commands on
  <a href="https://github.com/Lifailon/PS-Commands" target="_blank" rel="noopener">
    GitHub
  </a>
  | Theme
  <a href="https://github.com/squidfunk/mkdocs-material" target="_blank" rel="noopener">
    Material
  </a>
  for
  <a href="https://github.com/mkdocs/mkdocs" target="_blank" rel="noopener">
    MkDocs
  </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/Lifailon/PS-Commands" target="_blank" rel="noopener" title="PS-Commands on Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dd8806f2.min.js"></script>
      
        <script src="../assets/highlight/highlight.min.js"></script>
      
        <script src="../assets/highlight/powershell.min.js"></script>
      
        <script src="../assets/highlight/init.js"></script>
      
    
  </body>
</html>