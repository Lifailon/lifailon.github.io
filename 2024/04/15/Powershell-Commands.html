<!DOCTYPE html>
<html>
  <head>
    <title>PowerShell Commands ‚Äì Lifailon ‚Äì üìö Large base of PowerShell notes in Russian language</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="



" />
    <meta property="og:description" content="



" />
    
    <meta name="author" content="Lifailon" />

    
    <meta property="og:title" content="PowerShell Commands" />
    <meta property="twitter:title" content="PowerShell Commands" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Lifailon - üìö Large base of PowerShell notes in Russian language" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="https://avatars.githubusercontent.com/u/116945542?s=400&u=a0265b8aff463b2b6814705dffc04894954d0a59&v=4" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Lifailon</a></h1>
            <p class="site-description">üìö Large base of PowerShell notes in Russian language</p>
          </div>

          <nav>
            <a href="/">Blog</a>
            <a href="/about">About</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>PowerShell Commands</h1>

  <div class="entry">
    <p><img src="https://img.shields.io/github/languages/top/lifailon/PS-Commands" alt="GitHub top language" />
<img src="https://img.shields.io/github/last-commit/lifailon/PS-Commands" alt="GitHub last commit (by committer)" />
<img src="https://img.shields.io/github/languages/code-size/lifailon/PS-Commands" alt="GitHub code size in bytes" />
<img src="https://img.shields.io/github/stars/Lifailon/PS-Commands" alt="GitHub Repo stars" /></p>

<p>–ë–æ–ª—å—à–∞—è –±–∞–∑–∞ –∑–∞–º–µ—Ç–æ–∫ PowerShell –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.</p>

<p><a href="https://lifailon.github.io/">‚û°Ô∏è –í–µ–±-–≤–µ—Ä—Å–∏—è</a></p>

<p>üì¢ Habr: <a href="https://habr.com/ru/articles/782592/">PowerShell –∏ –µ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</a></p>

<ul>
  <li><a href="#help">Help</a></li>
  <li><a href="#object">Object</a></li>
  <li><a href="#npp">npp</a></li>
  <li><a href="#regex">Regex</a></li>
  <li><a href="#datatype">DataType</a></li>
  <li><a href="#module">Module</a></li>
  <li><a href="#bit">Bit</a></li>
  <li><a href="#cycle">Cycle</a></li>
  <li><a href="#files">Files</a></li>
  <li><a href="#credential">Credential</a></li>
  <li><a href="#winevent">WinEvent</a></li>
  <li><a href="#firewall">Firewall</a></li>
  <li><a href="#defender">Defender</a></li>
  <li><a href="#windowsupdate">WindowsUpdate</a></li>
  <li><a href="#dism">DISM</a></li>
  <li><a href="#scheduled">Scheduled</a></li>
  <li><a href="#network">Network</a></li>
  <li><a href="#rdp">RDP</a></li>
  <li><a href="#shutdown">Shutdown</a></li>
  <li><a href="#localaccounts">LocalAccounts</a></li>
  <li><a href="#smb">SMB</a></li>
  <li><a href="#activedirectory">ActiveDirectory</a></li>
  <li><a href="#repadmin">repadmin</a></li>
  <li><a href="#dcdiag">dcdiag</a></li>
  <li><a href="#ntdsutil">ntdsutil</a></li>
  <li><a href="#gpo">GPO</a></li>
  <li><a href="#servermanager">ServerManager</a></li>
  <li><a href="#dnsserver">DNS</a></li>
  <li><a href="#dhcpserver">DHCP</a></li>
  <li><a href="#dfs">DFS</a></li>
  <li><a href="#storagereplica">StorageReplica</a></li>
  <li><a href="#ps2exe">PS2EXE</a></li>
  <li><a href="#nssm">NSSM</a></li>
  <li><a href="#jobs">Jobs</a></li>
  <li><a href="#smtp">SMTP</a></li>
  <li><a href="#hyper-v">Hyper-V</a></li>
  <li><a href="#vmwarepowercli">VMWare/PowerCLI</a></li>
  <li><a href="#exchangeemshell">Exchange/EMShell</a></li>
  <li><a href="#truenas">TrueNAS</a></li>
  <li><a href="#veeam">Veeam</a></li>
  <li><a href="#rest-api">REST API</a></li>
  <li><a href="#pode">Pode</a></li>
  <li><a href="#selenium">Selenium</a></li>
  <li><a href="#ie">IE</a></li>
  <li><a href="#com">COM</a></li>
  <li><a href="#dotnet">dotNET</a></li>
  <li><a href="#console-api">Console API</a></li>
  <li><a href="#drawing">Drawing</a></li>
  <li><a href="#objectevent">ObjectEvent</a></li>
  <li><a href="#sockets">Sockets</a></li>
  <li><a href="#excel">Excel</a></li>
  <li><a href="#csv">CSV</a></li>
  <li><a href="#xml">XML</a></li>
  <li><a href="#json">JSON</a></li>
  <li><a href="#yaml">YAML</a></li>
  <li><a href="#html">HTML</a></li>
  <li><a href="#htmlagilitypack">HtmlAgilityPack</a></li>
  <li><a href="#sqlite">SQLite</a></li>
  <li><a href="#mysql">MySQL</a></li>
  <li><a href="#mssql">MSSQL</a></li>
  <li><a href="#influxdb">InfluxDB</a></li>
  <li><a href="#telegraf">Telegraf</a></li>
  <li><a href="#elasticsearch">Elasticsearch</a></li>
  <li><a href="#cdata">CData</a></li>
  <li><a href="#odbc">ODBC</a></li>
  <li><a href="#postgresql">PostgreSQL</a></li>
  <li><a href="#wmi">WMI</a></li>
  <li><a href="#regedit">Regedit</a></li>
  <li><a href="#performance">Performance</a></li>
  <li><a href="#snmp">SNMP</a></li>
  <li><a href="#zabbix">Zabbix</a></li>
  <li><a href="#pki">pki</a></li>
  <li><a href="#openssl">OpenSSL</a></li>
  <li><a href="#openvpn">OpenVPN</a></li>
  <li><a href="#route">Route</a></li>
  <li><a href="#nat">NAT</a></li>
  <li><a href="#wireguard">WireGuard</a></li>
  <li><a href="#vpnclient">VpnClient</a></li>
  <li><a href="#proxy">Proxy</a></li>
  <li><a href="#netsh">netsh</a></li>
  <li><a href="#openssh">OpenSSH</a></li>
  <li><a href="#winrm">WinRM</a></li>
  <li><a href="#packagemanagement">PackageManagement</a></li>
  <li><a href="#nuget">NuGet</a></li>
  <li><a href="#git">Git</a></li>
  <li><a href="#github">GitHub</a></li>
  <li><a href="#dsc">DSC</a></li>
  <li><a href="#ansible">Ansible</a></li>
  <li><a href="#win_modules">Win_Modules</a></li>
  <li><a href="#GigaChat">GigaChat</a></li>
  <li><a href="#YandexGPT">YandexGPT</a></li>
  <li><a href="#superagi">SuperAGI</a></li>
  <li><a href="#replicate">Replicate</a></li>
  <li><a href="#google-filter">Google-Filter</a></li>
  <li><a href="#google-api">Google-API</a></li>
  <li><a href="#rapidapi">RapidAPI</a></li>
  <li><a href="#tmdb">TMDB</a></li>
  <li><a href="#omdb">OMDb</a></li>
  <li><a href="#ivi">ivi</a></li>
  <li><a href="#kinopoisk">Kinopoisk</a></li>
  <li><a href="#videocdn">VideoCDN</a></li>
  <li><a href="#telegram">Telegram</a></li>
  <li><a href="#discord">Discord</a></li>
  <li><a href="#oh-my-posh">oh-my-posh</a></li>
  <li><a href="#pester">Pester</a></li>
  <li><a href="#pandoc">Pandoc</a></li>
  <li><a href="#ffmpeg">FFmpeg</a></li>
  <li><a href="#imagemagick">ImageMagick</a></li>
  <li><a href="#hugo">Hugo</a></li>
</ul>

<h1 id="help">Help</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Verb</code> –¥–µ–π—Å—Ç–≤–∏—è/–≥–ª–∞–≥–æ–ª—ã, —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–º–∞–Ω–¥–ª–µ—Ç–∞—Ö <br />
<code class="language-plaintext highlighter-rouge">Get-Command *Language*</code> –ø–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥—ã –ø–æ –∏–º–µ–Ω–∏ <br />
<code class="language-plaintext highlighter-rouge">(Get-Command Get-Language).Module</code> —É–∑–Ω–∞—Ç—å –∫ –∫–∞–∫–æ–º—É –º–æ–¥—É–ª—é –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫–æ–º–∞–Ω–¥–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-Command Get-Content | fl Module,DLL</code> —É–∑–Ω–∞—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥—ã –∫ –º–æ–¥—É–ª—é –∏ dll <br />
<code class="language-plaintext highlighter-rouge">Get-Command -Module LanguagePackManagement</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è <br />
<code class="language-plaintext highlighter-rouge">(Get-Module LanguagePackManagement).ExportedCommands.Values</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è <br />
<code class="language-plaintext highlighter-rouge">Get-Language | Get-Member</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–µ—Ç–æ–¥–æ–≤ –∫–æ–º–∞–Ω–¥—ã (–¥–µ–π—Å—Ç–≤–∏—è), –æ–±—ä–µ–∫—Ç—ã –≤—ã–≤–æ–¥–∞ –∏ Event (—Å–æ–±—ã—Ç–∏—è –æ–±—ä–µ–∫—Ç–æ–≤: Click) <br />
<code class="language-plaintext highlighter-rouge">(Get-Help Get-Service).Aliases</code> —É–∑–Ω–∞—Ç—å –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–º –∫–æ–º–∞–Ω–¥—ã <br />
<code class="language-plaintext highlighter-rouge">Get-Alias gsv</code> —É–∑–Ω–∞—Ç—å –∏–º—è –∫–æ–º–∞–Ω–¥—ã –ø–æ –ø—Å–µ–≤–¥–æ–Ω–∏–º—É <br />
<code class="language-plaintext highlighter-rouge">Get-Help Get-Service</code> —Å–∏–Ω—Ç–∞–∫—Å–∏—Å <br />
<code class="language-plaintext highlighter-rouge">Get-Help Get-Service -Parameter *</code> –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-Help Get-Service -Online</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Help Get-Service -ShowWindow</code> –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ GUI —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π <br />
<code class="language-plaintext highlighter-rouge">Show-Command</code> –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –≤ GUI <br />
<code class="language-plaintext highlighter-rouge">Show-Command Get-Service</code> —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–º–∞–Ω–¥—ã –≤ GUI <br />
<code class="language-plaintext highlighter-rouge">Invoke-Expression</code> iex –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏ –∫–∞–∫ –∫–æ–º–∞–Ω–¥—ã <br />
<code class="language-plaintext highlighter-rouge">$PSVersionTable</code> –≤–µ—Ä—Å–∏—è PowerShell <br />
<code class="language-plaintext highlighter-rouge">Set-ExecutionPolicy Unrestricted</code> <br />
<code class="language-plaintext highlighter-rouge">Get-ExecutionPolicy</code> <br />
<code class="language-plaintext highlighter-rouge">$Metadata = New-Object System.Management.Automation.CommandMetaData (Get-Command Get-Service)</code> –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–∞–Ω–¥–ª–µ—Ç–µ <br />
<code class="language-plaintext highlighter-rouge">[System.Management.Automation.ProxyCommand]::Create($Metadata)</code> –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏</p>

<h1 id="object">Object</h1>

<h3 id="variable">Variable</h3>

<p><code class="language-plaintext highlighter-rouge">$var = Read-Host "Enter"</code> —Ä—É—á–Ω–æ–π –≤–≤–æ–¥ <br />
<code class="language-plaintext highlighter-rouge">$pass = Read-Host "Enter Password" -AsSecureString</code> —Å–∫—Ä—ã–≤–∞—Ç—å –Ω–∞–±–æ—Ä <br />
<code class="language-plaintext highlighter-rouge">$global:path = "\\path"</code> –∑–∞–¥–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ —Ñ—É–Ω–∫—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">$using:srv</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏ –≤ Invoke-—Å–µ—Å—Å–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-Variable</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ <br />
<code class="language-plaintext highlighter-rouge">ls variable:/</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ <br />
<code class="language-plaintext highlighter-rouge">Get-Variable *srv*</code> –Ω–∞–π—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –ø–æ –∏–º–µ–Ω–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-Variable -Scope Global</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ <br />
<code class="language-plaintext highlighter-rouge">Get-Variable Error</code> –ø–æ—Å–ª–µ–¥–Ω—è—è –∫–æ–º–∞–Ω–¥–∞ —Å –æ—à–∏–±–∫–æ–π <br />
<code class="language-plaintext highlighter-rouge">Remove-Variable -Name *</code> –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ <br />
<code class="language-plaintext highlighter-rouge">$LASTEXITCODE</code> —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –≤—ã–≤–æ–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø—É—â–µ–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä ping. –ï—Å–ª–∏ –∫–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π (True), —Ç–æ $LastExitCode = 0</p>

<h3 id="env">ENV</h3>

<p><code class="language-plaintext highlighter-rouge">Get-ChildItem Env:</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">$env:PSModulePath</code> –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π <br />
<code class="language-plaintext highlighter-rouge">$env:userprofile</code> <br />
<code class="language-plaintext highlighter-rouge">$env:computername</code> <br />
<code class="language-plaintext highlighter-rouge">$env:username</code> <br />
<code class="language-plaintext highlighter-rouge">$env:userdnsdomain</code> <br />
<code class="language-plaintext highlighter-rouge">$env:logonserver</code> <br />
<code class="language-plaintext highlighter-rouge">([DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()).Name</code> <br />
<code class="language-plaintext highlighter-rouge">[Environment]::GetFolderPath('ApplicationData')</code></p>

<h3 id="history">History</h3>

<p><code class="language-plaintext highlighter-rouge">Get-History</code> –∏—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">(Get-History)[-1].Duration.TotalSeconds</code> –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã <br />
<code class="language-plaintext highlighter-rouge">(Get-PSReadLineOption).HistorySavePath</code> –ø—É—Ç—å –∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–º—É —Ñ–∞–π–ª—É —Å 4096 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ (–∏–∑ –º–æ–¥—É–ª—è PSReadLine) <br />
<code class="language-plaintext highlighter-rouge">Get-Content (Get-PSReadlineOption).HistorySavePath | Select-String Get</code> –ø–æ–∏—Å–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É —Ñ–∞–π–ª–∞ (GREP) <br />
<code class="language-plaintext highlighter-rouge">Set-PSReadlineOption -MaximumHistoryCount 10000</code> –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã—Ö –∫–æ–º–∞–Ω–¥ –≤ —Ñ–∞–π–ª <br />
<code class="language-plaintext highlighter-rouge">Get-PSReadLineOption | select MaximumHistoryCount</code> <br />
<code class="language-plaintext highlighter-rouge">Set-PSReadlineOption -HistorySaveStyle SaveNothing</code> –æ—Ç–∫–ª—é—á–∏—Ç—å –≤–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ <br />
<code class="language-plaintext highlighter-rouge">F2</code> –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è —Å InlineView –Ω–∞ ListView</p>

<h3 id="clipboard">Clipboard</h3>

<p><code class="language-plaintext highlighter-rouge">Set-Clipboard $srv</code> —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-Clipboard</code> –≤—Å—Ç–∞–≤–∏—Ç—å</p>

<h3 id="write">Write</h3>

<p><code class="language-plaintext highlighter-rouge">Write-Host -ForegroundColor Black -BackgroundColor Green "Test" -NoNewline</code> <br />
<code class="language-plaintext highlighter-rouge">Write-Error Test</code> <br />
<code class="language-plaintext highlighter-rouge">Foreach ($n in 1..100) {Write-Progress -Activity "Test Progress" -PercentComplete $n}</code></p>

<h3 id="array">Array</h3>

<p><code class="language-plaintext highlighter-rouge">$srv = @("server-01", "server-02")</code>  —Å–æ–∑–¥–∞—Ç—å –º–∞—Å—Å–∏–≤ <br />
<code class="language-plaintext highlighter-rouge">$srv += @("server-03")</code> –¥–æ–±–∞–≤–∏—Ç—å –≤ –º–∞—Å—Å–∏–≤ –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç <br />
<code class="language-plaintext highlighter-rouge">$srv.Count</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–æ–ª-–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ <br />
<code class="language-plaintext highlighter-rouge">Out-String</code> –ø–æ—Å—Ç—Ä–æ—á–Ω—ã–π –≤—ã–≤–æ–¥</p>

<h3 id="index">Index</h3>

<p><code class="language-plaintext highlighter-rouge">$srv[0]</code> –≤—ã–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –º–∞—Å—Å–∏–≤–∞ <br />
<code class="language-plaintext highlighter-rouge">$srv[0] = Name</code> –∑–∞–º–µ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –º–∞—Å—Å–∏–≤–µ <br />
<code class="language-plaintext highlighter-rouge">$srv[0].Length</code> —É–∑–Ω–∞—Ç—å –∫–æ–ª-–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –ø–µ—Ä–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –º–∞—Å—Å–∏–≤–µ <br />
<code class="language-plaintext highlighter-rouge">$srv[10..100]</code> —Å—Ä–µ–∑</p>
<pre><code class="language-PowerShell">$array = "a","b","c","d"
$num = 0
foreach ($a in $array) {
$num += 1
$index = [array]::IndexOf($array, $a) # —É–∑–Ω–∞—Ç—å –Ω–æ–º–µ—Ä –∏–Ω–¥–µ–∫—Å–∞ –ø–æ –∑–∞—á–µ–Ω–∏—é
$array[$index] = $num # –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤
}
</code></pre>
<h3 id="hashtable">HashTable</h3>
<pre><code class="language-PowerShell">$hashtable = @{"User" = "$env:username"; "Server" = "$env:computername"} # —Å–æ–∑–¥–∞—Ç—å
$hashtable += @{"User2" = "$env:username"; "Server2" = "$env:computername"} # –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á–∏
$hashtable.Keys # —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–ª—é—á–µ–π
$hashtable["User"] # –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (Values) –ø–æ –∫–ª—é—á—É
$hashtable["User"] = "Test" # –∏–∑–º–µ–Ω–∏—Ç—å
$hashtable.Remove("User") # —É–¥–∞–ª–∏—Ç—å –∫–ª—é—á
</code></pre>
<p><code class="language-plaintext highlighter-rouge">$Tag = @{$true = 'dev'; $false = 'prod'}[([System.Net.Dns]::GetHostEntry("localhost").HostName) -match '.*.TestDomain$']</code></p>

<h3 id="collectionslist">Collections/List</h3>
<pre><code class="language-PowerShell">$Collections = New-Object System.Collections.Generic.List[System.Object]
$Collections.Add([PSCustomObject]@{User = $env:username; Server = $env:computername})
</code></pre>
<h3 id="pscustomobject">PSCustomObject</h3>
<pre><code class="language-PowerShell">$CustomObject = [PSCustomObject][ordered]@{User = $env:username; Server = $env:computername}
$CustomObject | Add-Member ‚ÄìMemberType NoteProperty ‚ÄìName Arr ‚ÄìValue @(1,2,3) # –¥–æ–±–∞–≤–∏—Ç—å Property (—Å–≤–æ–π—Å—Ç–≤–æ/—Å—Ç–æ–±–µ—Ü)
$CustomObject.Arr = @(1,3,5) # –∏–∑–º–µ–Ω–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
$CustomObject.PsObject.Properties.Remove('User') # —É–¥–∞–ª–∏—Ç—å Property
</code></pre>
<h3 id="add-member">Add-Member</h3>
<pre><code class="language-PowerShell">$ScriptBlock = {Get-Service}
$CustomObject | Add-Member -Name "TestMethod" -MemberType ScriptMethod -Value $ScriptBlock # –î–æ–±–∞–≤–∏—Ç—å Method
$CustomObject | Get-Member
$CustomObject.TestMethod()
</code></pre>
<h3 id="class">Class</h3>
<pre><code class="language-PowerShell">Class CustomClass {
[string]$User
[string]$Server
Start([bool]$Param1) {
If ($Param1) {Write-Host "Start Function"}}
}

$Class = New-Object -TypeName CustomClass
$Class.User = $env:username
$Class.Server = $env:computername
$Class.Start(1)
</code></pre>
<h3 id="pipeline">Pipeline</h3>

<p><code class="language-plaintext highlighter-rouge">$obj | Add-Member -MemberType NoteProperty -Name "Type" -Value "user" -Force</code> –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–∫—Ç–∞ –≤—ã–≤–æ–¥–∞ NoteProperty <br />
<code class="language-plaintext highlighter-rouge">$obj | Add-Member -MemberType NoteProperty -Name "User" -Value "admin" -Force</code> –∏–∑–º–µ–Ω–µ–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–ª—è —Å—É—â–Ω–æ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç–∞ User <br />
<code class="language-plaintext highlighter-rouge">ping $srv | Out-Null</code> –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–≤–æ–¥–∞ –≤ Out-Null</p>

<h3 id="select-object">Select-Object</h3>

<p><code class="language-plaintext highlighter-rouge">Get-Process | Select-Object -Property *</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –≤—ã–≤–æ–¥–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-Process | select -Unique "Name"</code> —É–¥–∞–ª–∏—Ç—å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –≤ –º–∞—Å—Å–∏–≤–µ <br />
<code class="language-plaintext highlighter-rouge">Get-Process | select -ExpandProperty ProcessName</code> –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∏–∑ –æ–±—ä–µ–∫—Ç–∞-–∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ –º–∞—Å—Å–∏–≤ (–≤—ã–≤–µ—Å—Ç–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–µ–∑ –Ω–∞–∏–º–µ–Ω–æ–≤–∞—è —Å—Ç–æ–ª–±—Ü–∞) <br />
<code class="language-plaintext highlighter-rouge">(Get-Process | ? Name -match iperf).Modules</code> —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –º–æ–¥—É–ª–µ–π –ø—Ä–æ—Ü–µ—Å—Å–æ–º</p>

<h3 id="expression">Expression</h3>
<pre><code class="language-PowerShell">ps | Sort-Object -Descending CPU | select -first 10 ProcessName, # —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ CPU, –≤—ã–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤—ã—Ö 10 –∑–Ω–∞—á–µ–Ω–∏–π (-first)
@{Name="ProcessorTime"; Expression={$_.TotalProcessorTime -replace "\.\d+$"}}, # –∑–∞—Ç—Ä–∞—á–µ–Ω–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ –º–∏–Ω—É—Ç–∞—Ö
@{Name="Memory"; Expression={[string]([int]($_.WS / 1024kb))+"MB"}}, # –¥–µ–ª–∏–º –±–∞–π—Ç—ã –Ω–∞ –ö–ë
@{Label="RunTime"; Expression={((Get-Date) - $_.StartTime) -replace "\.\d+$"}} # –≤—ã—á–µ—Å—Ç—å –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ - –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞, –∏ —É–¥–∞–ª–∏—Ç—å milisec
</code></pre>
<h3 id="select-string">Select-String</h3>

<p><code class="language-plaintext highlighter-rouge">$(ipconfig | Select-String IPv4) -replace ".+: " | Where-Object {$_ -match "^172."}</code> —É–∑–Ω–∞—Ç—å —Ç–æ–ª—å–∫–æ IP <br />
<code class="language-plaintext highlighter-rouge">$Current_IP = Get-Content $RDCMan_RDG_PATH | Select-String $RDCMan_Display_Name -Context 0,1</code> –ø–æ–ª—É—á–∏—Ç—å –¥–≤–µ —Å—Ç—Ä–æ–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">$Current_IP = $Current_IP.Context.DisplayPostContext[0] -replace ".+&lt;name&gt;|&lt;\/name&gt;"</code> –∑–∞–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤—Ç–æ—Ä—É—é —Å—Ç—Ä–æ–∫—É –∏ —É–¥–∞–ª–∏—Ç—å —Ç—ç–≥–∏</p>

<h3 id="format-tableformat-list">Format-Table/Format-List</h3>

<p><code class="language-plaintext highlighter-rouge">Get-Process | ft ProcessName, StartTime -Autosize</code> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Å—Ç–æ–ª–±—Ü–æ–≤</p>

<h3 id="measure-object">Measure-Object</h3>

<p><code class="language-plaintext highlighter-rouge">Get-Process | Measure | select Count</code> –∫–æ–ª-–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-Process | Measure -Line -Word -Character</code> –∫–æ–ª-–≤–æ —Å—Ç—Ä–æ–∫, —Å–ª–æ–≤ –∏ Char –æ–±—ä–µ–∫—Ç–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-Process | Measure-Object PM -sum | Select-Object Count,@{Name="MEM_MB"; Expression={[int]($_.Sum/1mb)}}</code> –∫–æ–ª-–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –æ–±—â–∏–π –æ–±—ä–µ–º –∑–∞–Ω—è—Ç–æ–π –ø–∞–º—è—Ç–∏ –≤ –ú–ë–∞–π—Ç</p>

<h3 id="compare-object">Compare-Object</h3>

<p><code class="language-plaintext highlighter-rouge">Compare-Object -ReferenceObject (Get-Content -Path .\file1.txt) -DifferenceObject (Get-Content -Path .\file2.txt)</code> —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö —Ñ–∞–π–ª–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">$group1 = Get-ADGroupMember -Identity "Domain Admins"</code> <br />
<code class="language-plaintext highlighter-rouge">$group2 = Get-ADGroupMember -Identity "Enterprise Admins"</code> <br />
<code class="language-plaintext highlighter-rouge">Compare-Object -ReferenceObject $group1 -DifferenceObject $group2 -IncludeEqual</code>
<code class="language-plaintext highlighter-rouge">==</code> –Ω–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">&lt;=</code> –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ $group1 <br />
<code class="language-plaintext highlighter-rouge">=&gt;</code> –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ $group2</p>

<h3 id="where-object-">Where-Object (?)</h3>

<p><code class="language-plaintext highlighter-rouge">Get-Process | Where-Object {$_.ProcessName -match "zabbix"}</code> —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è/–ø–æ–∏—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ –∏–º–µ–Ω–∏ —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-Process | where CPU -gt 10 | Sort-Object -Descending CPU</code> –≤—ã–≤–µ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç—ã, –≥–¥–µ –∑–Ω–∞—á–µ–Ω–∏—è CPU –±–æ–ª—å—à–µ 10 <br />
<code class="language-plaintext highlighter-rouge">Get-Process | where WS -gt 200MB</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –≥–¥–µ WS –≤—ã—à–µ 200–ú–ë <br />
<code class="language-plaintext highlighter-rouge">Get-Service | where Name -match "zabbix"</code> –ø–æ–∏—Å–∫ —Å–ª—É–∂–±—ã <br />
<code class="language-plaintext highlighter-rouge">Get-Service -ComputerName $srv | Where {$_.Name -match "WinRM"} | Restart-Service</code> –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ <br />
<code class="language-plaintext highlighter-rouge">(Get-Service).DisplayName</code> –≤—ã–≤–µ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤–∞ –º–∞—Å—Å–∏–≤–∞ <br />
<code class="language-plaintext highlighter-rouge">netstat -an | where {$_ -match 443}</code> <br />
<code class="language-plaintext highlighter-rouge">netstat -an | ?{$_ -match 443}</code> <br />
<code class="language-plaintext highlighter-rouge">(netstat -an) -match 443</code></p>

<h3 id="sort-object">Sort-Object</h3>

<p><code class="language-plaintext highlighter-rouge">Get-Process | Sort-Object -Descending CPU | ft</code> –æ–±—Ä–∞—Ç–Ω–∞—è (-Descending) —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ CPU <br />
<code class="language-plaintext highlighter-rouge">$path[-1..-10]</code> –æ–±—Ä–∞—Ç–Ω–∞—è —Å–±–æ—Ä–∫–∞ –º–∞—Å—Å–∏–≤–∞ –±–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</p>

<h3 id="lastfirst">Last/First</h3>

<p><code class="language-plaintext highlighter-rouge">Get-Process | Sort-Object -Descending CPU | select -First 10</code> –≤—ã–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤—ã—Ö 10 –æ–±—ä–µ–∫—Ç–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-Process | Sort-Object -Descending CPU | select -Last 10</code> –≤—ã–≤–µ—Å—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 –æ–±—ä–µ–∫—Ç–æ–≤</p>

<h3 id="group-object">Group-Object</h3>
<pre><code class="language-PowerShell">$Groups = Get-CimInstance -Class Win32_PnPSignedDriver |
Select-Object DriverProviderName, FriendlyName, Description, DriverVersion, DriverDate |
Group-Object DriverProviderName, FriendlyName, Description, DriverVersion, DriverDate
$(foreach ($Group in $Groups) {
    $Group.Group[0]
}) | Format-Table
</code></pre>
<h3 id="error">Error</h3>

<p><code class="language-plaintext highlighter-rouge">$Error</code> –≤—ã–≤–æ–¥–∏—Ç –≤—Å–µ –æ—à–∏–±–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ —Å–µ–∞–Ω—Å–∞ <br />
<code class="language-plaintext highlighter-rouge">$Error[0].InvocationInfo</code> —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç—á–µ—Ç –æ–± –æ—à–∏–±–∫–µ <br />
<code class="language-plaintext highlighter-rouge">$Error.clear()</code> <br />
<code class="language-plaintext highlighter-rouge">$LASTEXITCODE</code> —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã (0 - —É—Å–ø–µ—Ö) <br />
<code class="language-plaintext highlighter-rouge">exit 1</code> –∫–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è $LASTEXITCODE</p>

<h3 id="property">Property</h3>

<p><code class="language-plaintext highlighter-rouge">$srv.Count</code> –∫–æ–ª-–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ <br />
<code class="language-plaintext highlighter-rouge">$srv.Length</code> —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–º —Å—Ç—Ä–æ–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π [string] –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π (—Å—Ç—Ä–æ–∫) –æ–±—ä–µ–∫—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">$srv.Chars(2)</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å 3-–π —Å–∏–º–≤–æ–ª –≤ —Å—Ç—Ä–æ–∫–µ <br />
<code class="language-plaintext highlighter-rouge">$srv[2]</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å 3-—é —Å—Ç—Ä–æ–∫—É –≤ –º–∞—Å—Å–∏–≤–µ</p>

<h3 id="method">Method</h3>

<p><code class="language-plaintext highlighter-rouge">$srv.Insert(0,"https://")</code> –¥–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º —Å–∏–º–≤–æ–ª–æ–º <br />
<code class="language-plaintext highlighter-rouge">$srv.Substring(4)</code> —É–¥–∞–ª–∏—Ç—å (–∏–∑ –≤—Å–µ–≥–æ –º–∞—Å—Å–∏–≤–∞) –ø–µ—Ä–≤—ã–µ 4 —Å–∏–º–≤–æ–ª–∞ <br />
<code class="language-plaintext highlighter-rouge">$srv.Remove(3)</code> —É–¥–∞–ª–∏—Ç—å –∏–∑ –≤—Å–µ–≥–æ –º–∞—Å—Å–∏–≤–∞ –≤—Å–µ –ø–æ—Å–ª–µ 3 —Å–∏–º–≤–æ–ª–∞ <br />
<code class="language-plaintext highlighter-rouge">$string = "123"</code> —Å–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–æ–∫—É <br />
<code class="language-plaintext highlighter-rouge">$int = [convert]::ToInt32($string)</code> –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É –≤ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö —á–∏—Å–ª–æ <br />
<code class="language-plaintext highlighter-rouge">[string]::Concat($text,$num)</code> –æ–±—ä–µ–¥–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É <br />
<code class="language-plaintext highlighter-rouge">[string]::Join(":",$text,$num)</code> –æ–±—ä–µ–¥–µ–Ω–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å <br />
<code class="language-plaintext highlighter-rouge">[string]::Compare($text,$num,$true)</code> –≤—ã–¥–∞–µ—Ç 0 –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∏–ª–∏ 1/-1 –ø—Ä–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏, $true (–±–µ–∑ —É—á–µ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞) –∏–ª–∏ $false (—Å —É—á–µ—Ç–æ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞) <br />
<code class="language-plaintext highlighter-rouge">[string]::Equals($text,$num)</code> –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö —Å—Ç—Ä–æ–∫ –∏ –≤—ã–¥–∞–µ—Ç $true –ø—Ä–∏ –∏—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∏–ª–∏ $false –ø—Ä–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">[string]::IsNullOrEmpty($text)</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –ø—É—Å—Ç–∞ $true, –µ—Å–ª–∏ –Ω–µ—Ç $false <br />
<code class="language-plaintext highlighter-rouge">[string]::IsNullOrWhiteSpace($text2)</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª–æ–≤ –ø—Ä–æ–±–µ–ª, —Ç–∞–±—É–ª—è—Ü–∏—è –∏–ª–∏ —Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏</p>

<h3 id="datetime">DateTime</h3>

<p><code class="language-plaintext highlighter-rouge">Get-TimeZone</code> —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å <br />
<code class="language-plaintext highlighter-rouge">[DateTime]::UtcNow</code> –≤—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ UTC 0 <br />
<code class="language-plaintext highlighter-rouge">(Get-Date).AddHours(-3)</code> <br />
<code class="language-plaintext highlighter-rouge">$Date = (Get-Date -Format "dd/MM/yyyy hh:mm:ss")</code> <br />
<code class="language-plaintext highlighter-rouge">$Date = Get-Date -f "dd/MM/yyyy"</code> –ø–æ–ª—É—á–∞–µ–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö [string] <br />
<code class="language-plaintext highlighter-rouge">[DateTime]$gDate = Get-Date "$Date"</code> –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —Ç–∏–ø [DateTime] <br />
<code class="language-plaintext highlighter-rouge">[int32]$days=($fDate-$gDate).Days</code> –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –≤ –¥–Ω—è—Ö <br />
<code class="language-plaintext highlighter-rouge">"5/7/07" -as [DateTime]</code> –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö [DateTime] <br />
<code class="language-plaintext highlighter-rouge">New-TimeSpan -Start $VBRRP.CreationTimeUTC -End $VBRRP.CompletionTimeUTC</code> –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –≤–æ –≤—Ä–µ–º–µ–Ω–∏</p>

<h3 id="measure-command">Measure-Command</h3>

<p><code class="language-plaintext highlighter-rouge">(Measure-Command {ping ya.ru}).TotalSeconds</code> —É–∑–Ω–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">(Get-History)[-1] | select @{Name="RunTime"; Expression={$_.EndExecutionTime - $_.StartExecutionTime}},ExecutionStatus,CommandLine</code> –ø–æ—Å—á–∏—Ç–∞—Ç—å –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–π [-1] (select -Last 1) –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã –∏ —É–∑–Ω–∞—Ç—å –µ–µ —Å—Ç–∞—Ç—É—Å</p>

<h3 id="timer">Timer</h3>

<p><code class="language-plaintext highlighter-rouge">$start_time = Get-Date</code> –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã <br />
<code class="language-plaintext highlighter-rouge">$end_time = Get-Date</code> –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é <br />
<code class="language-plaintext highlighter-rouge">$time = $end_time - $start_time</code> –≤—ã—Å—á–∏—Ç–∞—Ç—å –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">$min = $time.minutes</code> <br />
<code class="language-plaintext highlighter-rouge">$sec = $time.seconds</code> <br />
<code class="language-plaintext highlighter-rouge">Write-Host "$min –º–∏–Ω—É—Ç $sec —Å–µ–∫—É–Ω–¥"</code> <br />
<code class="language-plaintext highlighter-rouge">$timer = [System.Diagnostics.Stopwatch]::StartNew()</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–∞–π–º–µ—Ä <br />
<code class="language-plaintext highlighter-rouge">$timer.IsRunning</code> —Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã —Ç–∞–π–º–µ—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">$timer.Elapsed.TotalSeconds</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Ä–µ–º—è —Å –º–æ–º–µ–Ω—Ç–∞ –∑–∞–ø—É—Å–∫–∞ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö) <br />
<code class="language-plaintext highlighter-rouge">$timer.Stop()</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä</p>

<h1 id="npp">npp</h1>

<p><code class="language-plaintext highlighter-rouge">pwsh -NoExit -ExecutionPolicy Unrestricted -WindowStyle Maximized -File "$(FULL_CURRENT_PATH)"</code></p>

<p><code class="language-plaintext highlighter-rouge">%AppData%\Notepad++</code> themes/shortcuts.xml \</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="nt">&lt;NotepadPlus&gt;</span>
    <span class="nt">&lt;InternalCommands</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Macros&gt;</span>
        <span class="nt">&lt;Macro</span> <span class="na">name=</span><span class="s">"`+\+&amp;gt;"</span> <span class="na">Ctrl=</span><span class="s">"yes"</span> <span class="na">Alt=</span><span class="s">"no"</span> <span class="na">Shift=</span><span class="s">"no"</span> <span class="na">Key=</span><span class="s">"190"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Action</span> <span class="na">type=</span><span class="s">"0"</span> <span class="na">message=</span><span class="s">"2453"</span> <span class="na">wParam=</span><span class="s">"0"</span> <span class="na">lParam=</span><span class="s">"0"</span> <span class="na">sParam=</span><span class="s">""</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Action</span> <span class="na">type=</span><span class="s">"1"</span> <span class="na">message=</span><span class="s">"2170"</span> <span class="na">wParam=</span><span class="s">"0"</span> <span class="na">lParam=</span><span class="s">"0"</span> <span class="na">sParam=</span><span class="s">"`"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Action</span> <span class="na">type=</span><span class="s">"0"</span> <span class="na">message=</span><span class="s">"2451"</span> <span class="na">wParam=</span><span class="s">"0"</span> <span class="na">lParam=</span><span class="s">"0"</span> <span class="na">sParam=</span><span class="s">""</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Action</span> <span class="na">type=</span><span class="s">"0"</span> <span class="na">message=</span><span class="s">"2451"</span> <span class="na">wParam=</span><span class="s">"0"</span> <span class="na">lParam=</span><span class="s">"0"</span> <span class="na">sParam=</span><span class="s">""</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Action</span> <span class="na">type=</span><span class="s">"1"</span> <span class="na">message=</span><span class="s">"2170"</span> <span class="na">wParam=</span><span class="s">"0"</span> <span class="na">lParam=</span><span class="s">"0"</span> <span class="na">sParam=</span><span class="s">" "</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Action</span> <span class="na">type=</span><span class="s">"1"</span> <span class="na">message=</span><span class="s">"2170"</span> <span class="na">wParam=</span><span class="s">"0"</span> <span class="na">lParam=</span><span class="s">"0"</span> <span class="na">sParam=</span><span class="s">"\"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Action</span> <span class="na">type=</span><span class="s">"0"</span> <span class="na">message=</span><span class="s">"2300"</span> <span class="na">wParam=</span><span class="s">"0"</span> <span class="na">lParam=</span><span class="s">"0"</span> <span class="na">sParam=</span><span class="s">""</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/Macro&gt;</span>
    <span class="nt">&lt;/Macros&gt;</span>
    <span class="nt">&lt;UserDefinedCommands&gt;</span>
        <span class="nt">&lt;Command</span> <span class="na">name=</span><span class="s">"PowerShell7"</span> <span class="na">Ctrl=</span><span class="s">"no"</span> <span class="na">Alt=</span><span class="s">"yes"</span> <span class="na">Shift=</span><span class="s">"no"</span> <span class="na">Key=</span><span class="s">"116"</span><span class="nt">&gt;</span>pwsh -NoExit -ExecutionPolicy Unrestricted -WindowStyle Maximized -File <span class="ni">&amp;quot;</span>$(FULL_CURRENT_PATH)<span class="ni">&amp;quot;</span><span class="nt">&lt;/Command&gt;</span>
    <span class="nt">&lt;/UserDefinedCommands&gt;</span>
    <span class="nt">&lt;PluginCommands</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ScintillaKeys</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/NotepadPlus&gt;</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">Parsing text to Markdown:</code> <br />
<code class="language-plaintext highlighter-rouge">Macros: FnLeft+'+FnRight+FnRight+\s\\+Down</code> <br />
<code class="language-plaintext highlighter-rouge">Replace: "# ","'"</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.		# –û–±–æ–∑–Ω–∞—á–∞–µ—Ç –ª—é–±–æ–π —Å–∏–º–≤–æ–ª
\		# –≠–∫—Ä–∞–Ω–∏—Ä—É—é—â–∏–π —Å–∏–º–≤–æ–ª. –°–∏–º–≤–æ–ª—ã –∫–æ—Ç–æ—Ä—ã–µ —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è: ^, [, ., $, {, *, (, ), \, +, |, ?, &lt;, &gt;
^		# –ù–∞—á–∞–ª–æ —Å—Ç—Ä–æ–∫–∏
$		# –ö–æ–Ω–µ—Ü —Å—Ç—Ä–æ–∫–∏
\n		# –ù–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞
\d		# –õ—é–±–∞—è —Ü–∏—Ñ—Ä–∞
\D		# –ù–µ —Ü–∏—Ñ—Ä–∞
\w		# –õ—é–±–∞—è –±—É–∫–≤–∞ –ª–∞—Ç–∏–Ω–∏—Ü—ã, —Ü–∏—Ñ—Ä–∞, –∏–ª–∏ –∑–Ω–∞–∫ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏—è
\W		# –ù–µ –ª–∞—Ç–∏–Ω–∏—Ü–∞, –Ω–µ —Ü–∏—Ñ—Ä–∞, –Ω–µ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ
\s		# –ü—Ä–æ–±–µ–ª, —Ç–∞–±—É–ª—è—Ü–∏—è, –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏
\S		# –ù–µ –ø—Ä–æ–±–µ–ª
\b		# –ì—Ä–∞–Ω–∏—Ü–∞ —Å–ª–æ–≤–∞. –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å, —á—Ç–æ –∏—Å–∫–æ–º—ã–µ —Å–∏–º–≤–æ–ª—ã —è–≤–ª—è—é—Ç—Å—è —Å–ª–æ–≤–æ–º, –∞ –Ω–µ —á–∞—Å—Ç—å—é –¥—Ä—É–≥–æ–≥–æ —Å–ª–æ–≤–∞
\B		# –ù–µ –≥—Ä–∞–Ω–∏—Ü–∞ —Å–ª–æ–≤–∞
\&lt;		# –ù–∞—á–∞–ª–æ —Å–ª–æ–≤–∞
\&gt;		# –ö–æ–Ω–µ—Ü —Å–ª–æ–≤–∞
\A		# –ù–∞—á–∞–ª–æ —Ç–µ–∫—Å—Ç–∞
\Z		# –ö–æ–Ω–µ—Ü —Ç–µ–∫—Å—Ç–∞
*		# –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ–ª—å. –û–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–∏–π —Å–∏–º–≤–æ–ª –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å 0 –∏ –±–æ–ª–µ–µ —Ä–∞–∑
+		# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–µ–≥–æ –Ω–µ –º–µ–Ω–µ–µ 1-–≥–æ.
?		# –û–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å. –ù–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞
|		# –ò–ª–∏. –°–æ–µ–¥–∏–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
()		# –í –∫—Ä—É–≥–ª—ã–µ —Å–∫–æ–±–∫–∏ –∑–∞–∫–ª—é—á–∞—é—Ç—Å—è –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å "–∏–ª–∏" –∏ –ø–æ–∏—Å–∫ –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ —Å—Ç—Ä–æ–∫
[ ]	 	# –í –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö –∑–∞–¥–∞—é—Ç—Å—è —Å–∏–º–≤–æ–ª—ã –∫ –ø–æ–∏—Å–∫—É, –Ω–∞–ø—Ä–∏–º–µ—Ä [a-—è–ê-–Ø], –∏–ª–∏ [0-9]
[^ ]	# –ò—Å–∫–ª—é—á–∞–µ—Ç –∏–∑ –ø–æ–∏—Å–∫–∞ —Å–∏–º–≤–æ–ª—ã —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö
{ }		# –í —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π
\d{2}	# –ù–∞–π—Ç–∏ –¥–≤–µ —Ü–∏—Ñ—Ä—ã
\d{2,4}	# –ù–∞–π—Ç–∏ –¥–≤–µ –∏–ª–∏ —á–µ—Ç—ã—Ä–µ
{4,}	# –ù–∞–π—Ç–∏ —á–µ—Ç—ã—Ä–µ –∏ –±–æ–ª–µ–µ

^\s{1,}#.+` –ø–æ–∏—Å–∫ –≤–Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –∏ –ø—Ä–æ–±–µ–ª –ø–æ—Å–ª–µ –Ω–µ–≥–æ 1 –∏–ª–∏ –±–æ–ª—å—à–µ –∏ –ª—é–±–æ–µ –∫–æ–ª-–≤–æ —Å–∏–º–≤–æ–ª–æ–≤
</code></pre></div></div>
<h1 id="regex">Regex</h1>

<p><code class="language-plaintext highlighter-rouge">-replace "1","2"</code> –∑–∞–º–µ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∏–Ω–¥–µ–∫—Å–∞—Ö –º–∞—Å—Å–∏–≤–∞ (–≤–µ–∑–¥–µ –≥–¥–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç 1, –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ 2), –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">-split " "</code> –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É –≤ –º–∞—Å—Å–∏–≤, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º —É–∫–∞–∑–∞–Ω –ø—Ä–æ–±–µ–ª, –∫–æ—Ç–æ—Ä–æ–π —É–¥–∞–ª—è–µ—Ç—Å—è ($url.Split(‚Äú/‚Äù)[-1]) <br />
<code class="language-plaintext highlighter-rouge">-join " "</code> –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ (–∫–æ–ª–ª–µ–∫—Ü–∏—é) –≤ –µ–¥–∏–Ω—É—é —Å—Ç—Ä–æ–∫—É (string), –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º –ø—Ä–æ–±–µ–ª \</p>

<p><code class="language-plaintext highlighter-rouge">-like *txt*</code> –ø–æ–∏—Å–∫ –ø–æ –º–∞—Å–∫–∞–º wildcard, –≤—ã–≤–æ–¥–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ —ç–∫—Ä–∞–Ω <br />
<code class="language-plaintext highlighter-rouge">-match txt</code> –ø–æ–∏—Å–∫–∞ –ø–æ —à–∞–±–ª–æ–Ω–∞–º, –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">-match "zabbix|rpc"</code> —É—Å–ª–æ–≤–∏—è, –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å–ª–æ–≤–∞–º <br />
<code class="language-plaintext highlighter-rouge">-NotMatch</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è \</p>

<h3 id="matches">Matches</h3>

<p><code class="language-plaintext highlighter-rouge">$ip = "192.168.10.1"</code> <br />
<code class="language-plaintext highlighter-rouge">$ip -match "(\.\d{1,3})\.\d{1,2}"</code> True <br />
<code class="language-plaintext highlighter-rouge">$Matches</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–∏—Å–∫–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤—Ö–æ–¥—è—Ç –∏ –Ω–µ –≤—Ö–æ–¥—è—Ç –≤ –≥—Ä—É–ø–ø—ã ()</p>

<p><code class="language-plaintext highlighter-rouge">$String = "09/14/2017 12:00:27 - mtbill_post_201709141058.txt 7577_Delivered: OK"</code> <br />
<code class="language-plaintext highlighter-rouge">$String -Match ".*(?=\.txt)" | Out-Null</code> <br />
<code class="language-plaintext highlighter-rouge">$Matches[0][-4..-1] -Join ""</code></p>

<p><code class="language-plaintext highlighter-rouge">$string.Substring($string.IndexOf(".txt")-4, 4)</code> 2-–π –≤–∞—Ä–∏–∞–Ω—Ç (IndexOf)`</p>

<h3 id="—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-net-method-format">–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (.NET method format)</h3>

<p><code class="language-plaintext highlighter-rouge">[string]::Format("{1} {0}","Index0","Index1")</code> <br />
<code class="language-plaintext highlighter-rouge">"{1} {0}" -f "Index0","Index1"</code> <br />
<code class="language-plaintext highlighter-rouge">"{0:###-##-##}" -f 1234567</code> –∑–∞–ø–∏—Å–∞—Ç—å —á–∏—Å–ª–æ –≤ –¥—Ä—É–≥–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (#) <br />
<code class="language-plaintext highlighter-rouge">"{0:0000}" -f 123</code> –≤—ã–≤–µ—Å—Ç–∏ —á–∏—Å–ª–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –Ω–µ –º–µ–Ω—å—à–µ 4 –∑–Ω–∞–∫–æ–≤ (0123) <br />
<code class="language-plaintext highlighter-rouge">"{0:P0}" -f (220/1000)</code> –ø–æ—Å—á–∏—Ç–∞—Ç—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (P) <br />
<code class="language-plaintext highlighter-rouge">"{0:P}" -f (512MB/1GB)</code> —Å–∫–æ–ª—å–∫–æ % —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 512–ú–± –æ—Ç 1–ì–± <br />
<code class="language-plaintext highlighter-rouge">"{0:0.0%}" -f 0.123</code> —É–º–Ω–æ–∂–∏—Ç—å –Ω–∞ 100%</p>
<pre><code class="language-PowerShell">$gp = Get-Process | sort cpu -Descending | select -First 10
foreach ($p in $gp) {
"{0} - {1:N2}" -f $p.processname, $p.cpu # –æ–∫—Ä—É–≥–ª–∏—Ç—å
}
</code></pre>
<h3 id="—É—Å–ª–æ–≤–Ω—ã–π-–æ–ø–µ—Ä–∞—Ç–æ—Ä">–£—Å–ª–æ–≤–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä</h3>

<p><code class="language-plaintext highlighter-rouge">$rh = Read-Host</code> <br />
<code class="language-plaintext highlighter-rouge">if ($rh -eq 1) {ipconfig} elseif ($rh -eq 2) {getmac} else {hostname}</code> <br />
–ï—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ if () —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ç–µ–Ω–Ω—ã–º ($True), –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –≤ {} <br />
–ï—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ if () —è–≤–ª—è–µ—Ç—Å—è –ª–æ–∂–Ω—ã–º ($False), –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ else <br />
–£—Å–ª–æ–≤–∏–µ Elseif –∏–¥—ë—Ç –ø–æ—Å–ª–µ —É—Å–ª–æ–≤–∏—è if –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ else. –û–ø–µ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–≤—ã–π –≤–µ—Ä–Ω–µ—Ç $True, –æ—Ç–º–µ–Ω–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π <br />
–ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ —É—Å–ª–æ–≤–∏–µ –±–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞, —Ç–æ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –Ω–∞–ª–∏—á–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —É –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–∞ $True/$False <br />
<code class="language-plaintext highlighter-rouge">if ((tnc $srv -Port 80).TcpTestSucceeded) {"Opened port"} else {"Closed port"}</code></p>

<h3 id="–æ–ø–µ—Ä–∞—Ç–æ—Ä—ã">–û–ø–µ—Ä–∞—Ç–æ—Ä—ã</h3>

<p><code class="language-plaintext highlighter-rouge">-eq</code> —Ä–∞–≤–Ω–æ (equal) <br />
<code class="language-plaintext highlighter-rouge">-ceq</code> —É—á–∏—Ç—ã–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä <br />
<code class="language-plaintext highlighter-rouge">-ne</code> –Ω–µ —Ä–∞–≤–Ω–æ (not equal) <br />
<code class="language-plaintext highlighter-rouge">-gt</code> –±–æ–ª—å—à–µ (greater) <br />
<code class="language-plaintext highlighter-rouge">-ge</code> –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ <br />
<code class="language-plaintext highlighter-rouge">-lt</code> –º–µ–Ω—å—à–µ (less) <br />
<code class="language-plaintext highlighter-rouge">-le</code> –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ <br />
<code class="language-plaintext highlighter-rouge">-in</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ (5 -in @(1,2,3,4,5)) <br />
<code class="language-plaintext highlighter-rouge">-NOT</code> –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –ù–ï–¢ !(Test-Path $path) <br />
<code class="language-plaintext highlighter-rouge">-and</code> –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –ò <br />
<code class="language-plaintext highlighter-rouge">-or</code> –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –ò–õ–ò <br />
<code class="language-plaintext highlighter-rouge">if ((($1 -eq 1) -and ($2 -eq 2)) -or ($1 -ne 3)) {"$true"} else {"$false"}</code> –¥–≤–∞ —É—Å–ª–æ–≤–∏—è: (–µ—Å–ª–∏ $1 = 1 –∏ $2 = 2) –∏–ª–∏ $1 –Ω–µ —Ä–∞–≤–Ω–æ 3</p>

<h3 id="pipeline-operators">Pipeline Operators</h3>

<p><code class="language-plaintext highlighter-rouge">Write-Output "First" &amp;&amp; Write-Output "Second"</code> –¥–≤–µ —É—Å–ø–µ—à–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è <br />
<code class="language-plaintext highlighter-rouge">Write-Error "Bad" &amp;&amp; Write-Output "Second"</code> –ø–µ—Ä–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ—à–∏–±–∫–æ–π, –∏–∑-–∑–∞ —á–µ–≥–æ –≤—Ç–æ—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è <br />
<code class="language-plaintext highlighter-rouge">Write-Error "Bad" || Write-Output "Second"</code> –ø–µ—Ä–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ—à–∏–±–∫–æ–π, –ø–æ—ç—Ç–æ–º—É –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ç–æ—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ <br />
<code class="language-plaintext highlighter-rouge">Write-Output "First" || Write-Output "Second"</code> –ø–µ—Ä–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ, –ø–æ—ç—Ç–æ–º—É –≤—Ç–æ—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è</p>

<h3 id="invocation-operator">Invocation Operator</h3>

<p><code class="language-plaintext highlighter-rouge">$addr = "8.8.8.8"</code> <br />
<code class="language-plaintext highlighter-rouge">$ping = "ping"</code> <br />
<code class="language-plaintext highlighter-rouge">&amp; $ping $addr</code> –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç –∫–∞–∫ –∫–æ–º–∞–Ω–¥—É</p>

<p><code class="language-plaintext highlighter-rouge">&amp; $ping $addr &amp;</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤ —Ñ–æ–Ω–µ <br />
<code class="language-plaintext highlighter-rouge">(Get-Job)[-1] | Receive-Job -Keep</code></p>

<h3 id="—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ-—Å–∏–º–≤–æ–ª—ã">–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã</h3>

<p><code class="language-plaintext highlighter-rouge">\d</code> —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 9 (20-07-2022 —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç: ‚Äú\d\d-\d\d-\d\d\d\d‚Äù) <br />
<code class="language-plaintext highlighter-rouge">\D</code> –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –ª—é–±–æ–π —Å–∏–º–≤–æ–ª, –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä—ã. –£–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤, –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä: [int]$(‚Äú123 test‚Äù -replace ‚Äú\D‚Äù) <br />
<code class="language-plaintext highlighter-rouge">\w</code> –±—É–∫–≤–∞ –æ—Ç ‚Äúa‚Äù –¥–æ ‚Äúz‚Äù –∏ –æ—Ç ‚ÄúA‚Äù –¥–æ ‚ÄúZ‚Äù –∏–ª–∏ —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 9 <br />
<code class="language-plaintext highlighter-rouge">\s</code> –ø—Ä–æ–±–µ–ª, —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç: ‚Äú ‚Äú <br />
<code class="language-plaintext highlighter-rouge">\n</code> –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ <br />
<code class="language-plaintext highlighter-rouge">\b</code> –º–∞—Å–∫–∞, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü —Ü–µ–ª–æ–≥–æ —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ <br />
<code class="language-plaintext highlighter-rouge">.</code> –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –ª—é–±–æ–π —Å–∏–º–≤–æ–ª, –∫—Ä–æ–º–µ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">\</code> —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç –ª—é–±–æ–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã —Å–∏–º–≤–æ–ª (–º–µ—Ç–∞—Å–∏–º–≤–æ–ª). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–∏–º–≤–æ–ª, –≤–º–µ—Å—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ ({ } [ ] / \ + * . $ ^ | ?) <br />
<code class="language-plaintext highlighter-rouge">+</code> –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è 1 –∏ –±–æ–ª–µ–µ —Ä–∞–∑ (\s+) <br />
<code class="language-plaintext highlighter-rouge">{1,25}</code> –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π —Å–∏–º–≤–æ–ª–∞ —Å–ª–µ–≤–∞ –Ω–∞ –ø—Ä–∞–≤–æ (–æ—Ç 1 –¥–æ 25 —Ä–∞–∑) <br />
<code class="language-plaintext highlighter-rouge">[]</code> –ø–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ª—é–±–æ–π –±—É–∫–≤—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, [A-z0-9] –æ—Ç A –¥–æ z –∏ —Ü–∏—Ñ—Ä—ã –æ—Ç 0 –¥–æ 9 (‚Äú192.168.1.1‚Äù -match ‚Äú192.1[6-7][0-9]‚Äù)</p>

<h3 id="—è–∫–æ—Ä–∏">–Ø–∫–æ—Ä–∏</h3>

<p><code class="language-plaintext highlighter-rouge">^</code> –∏–ª–∏ <code class="language-plaintext highlighter-rouge">\A</code> –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞—á–∞–ª–æ —Å—Ç—Ä–æ–∫–∏. $url -replace ‚Äò^‚Äô,‚Äôhttps:‚Äô<code class="language-plaintext highlighter-rouge"> –¥–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ; \
</code>$<code class="language-plaintext highlighter-rouge"> –∏–ª–∏ </code>\Z<code class="language-plaintext highlighter-rouge"> –æ–±–æ–∑–Ω–∞—á–∞—é—Ç –∫–æ–Ω–µ—Ü —Å—Ç—Ä–æ–∫–∏. $ip -replace "\d{1,3}$","0" \
</code>(?=text)<code class="language-plaintext highlighter-rouge"> –ø–æ–∏—Å–∫ —Å–ª–æ–≤–∞ —Å–ª–µ–≤–∞. –ü–∏—à–µ–º —Å–ª–µ–≤–∞ –Ω–∞ –ø—Ä–∞–≤–æ –æ—Ç –∏—Å–∫–æ–º–æ–≥–æ (–∏—â–µ—Ç —Ç–æ–ª—å–∫–æ —Ü–µ–ª—ã–µ —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è) "Server:\s(.{1,30})\s(?=$username)" \
</code>(?&lt;=text)<code class="language-plaintext highlighter-rouge"> –ø–æ–∏—Å–∫ —Å–ª–æ–≤–∞ —Å–ø—Ä–∞–≤–∞. $in_time -replace ".+(?&lt;=Last)"</code> —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–æ —Å–ª–æ–≤–∞ Last <br />
<code class="language-plaintext highlighter-rouge">(?!text)</code> –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å–æ —Å–ª–æ–≤–æ–º —Å–ª–µ–≤–∞ <br />
<code class="language-plaintext highlighter-rouge">(?&lt;!text)</code> –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å–æ —Å–ª–æ–≤–æ–º —Å–ø—Ä–∞–≤–∞</p>

<p><code class="language-plaintext highlighter-rouge">$test = "string"</code> <br />
<code class="language-plaintext highlighter-rouge">$test -replace ".{1}$"</code> —É–¥–∞–ª–∏—Ç—å –ª—é–±–æ–µ –∫–æ–ª-–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">$test -replace "^.{1}"</code> —É–¥–∞–ª–∏—Ç—å –ª—é–±–æ–µ –∫–æ–ª-–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏ \</p>

<h3 id="–≥—Ä—É–ø–ø—ã-–∑–∞—Ö–≤–∞—Ç–∞">–ì—Ä—É–ø–ø—ã –∑–∞—Ö–≤–∞—Ç–∞</h3>

<p><code class="language-plaintext highlighter-rouge">$date = '12.31.2021'</code> <br />
<code class="language-plaintext highlighter-rouge">$date -replace '^(\d{2}).(\d{2})','$2.$1'</code> –ø–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏ <br />
<code class="language-plaintext highlighter-rouge">$1</code> —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–µ—Ä–≤–æ–π –≥—Ä—É–ø–ø—ã –≤ —Å–∫–æ–±–∫–∞—Ö <br />
<code class="language-plaintext highlighter-rouge">$2</code> —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—Ç–æ—Ä–æ–π –≥—Ä—É–ø–ø—ã</p>

<h1 id="datatype">DataType</h1>

<p><code class="language-plaintext highlighter-rouge">$srv.GetType()</code> —É–∑–Ω–∞—Ç—å —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö <br />
<code class="language-plaintext highlighter-rouge">$srv -is [string]</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö <br />
<code class="language-plaintext highlighter-rouge">$srv -isnot [System.Object]</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ <br />
<code class="language-plaintext highlighter-rouge">[Object]</code> –º–∞—Å—Å–∏–≤ (BaseType:System.Array) <br />
<code class="language-plaintext highlighter-rouge">[DateTime]</code> —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏ (BaseType:System.ValueType) <br />
<code class="language-plaintext highlighter-rouge">[Bool]/[Boolean]</code> –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ($True/$False) –∏–ª–∏ 1/0 (1 –±–∏—Ç) –Ω–∞–ª–∏—á–∏–µ/–æ—Ç—Å—É—Å—Ç–≤–∏–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">[Byte]</code> 8-–±–∏—Ç–Ω–æ–µ (1 –±–∞–π—Ç) —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –±–µ–∑ –∑–Ω–∞–∫–∞ (0..255) <br />
<code class="language-plaintext highlighter-rouge">[Int16]</code> 16-–±–∏—Ç–Ω–æ–µ –∑–Ω–∞–∫–æ–≤–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –æ—Ç -32767 –¥–æ 32767 (—Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö WORD 0..65535) <br />
<code class="language-plaintext highlighter-rouge">[Int]</code> 32-–±–∏—Ç–Ω–æ–µ (4 –±–∞–π—Ç–∞) –∑–Ω–∞–∫–æ–≤–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –æ—Ç ‚Äì2147483648 –¥–æ 2147483647 (DWORD) <br />
<code class="language-plaintext highlighter-rouge">[Int64]</code> 64-–±–∏—Ç–Ω–æ–µ –æ—Ç -9223372036854775808 –¥–æ 9223372036854775808 (LWORD) <br />
<code class="language-plaintext highlighter-rouge">[Decimal]</code> 128-–±–∏—Ç–Ω–æ–µ –¥–µ—Å—è—Ç–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç ‚Äì79228162514264337593543950335 –¥–æ 79228162514264337593543950335 <br />
<code class="language-plaintext highlighter-rouge">[Single]</code> —á–∏—Å–ª–æ —Å –ø–ª–∞–≤–∞—é—â–µ–π –∑–∞–ø—è—Ç–æ–π (32-—Ä–∞–∑—Ä—è–¥–Ω–æ–µ) <br />
<code class="language-plaintext highlighter-rouge">[Double]</code> —á–∏—Å–ª–æ —Å –ø–ª–∞–≤–∞—é—â–µ–π –∑–∞–ø—è—Ç–æ–π —Å –¥–≤–æ–π–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é (64-—Ä–∞–∑—Ä—è–¥–Ω–æ–µ) <br />
<code class="language-plaintext highlighter-rouge">[String]</code> –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤ –Æ–Ω–∏–∫–æ–¥–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã (BaseType:System.Object)</p>

<h3 id="math">Math</h3>

<p><code class="language-plaintext highlighter-rouge">[math] | Get-Member -Static</code> <br />
<code class="language-plaintext highlighter-rouge">[math]::Pow(2,4)</code> 2 –≤ 4 —Å—Ç–µ–ø–µ–Ω–∏ <br />
<code class="language-plaintext highlighter-rouge">[math]::Truncate(1.8)</code> –≥—Ä—É–±–æ–µ –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ, —É–¥–∞–ª—è–µ—Ç –¥—Ä–æ–±–Ω—É—é —á–∞—Å—Ç—å <br />
<code class="language-plaintext highlighter-rouge">[math]::Ceiling(1.8)</code> –æ–∫—Ä—É–≥–ª—è–µ—Ç —á–∏—Å–ª–æ –≤ –±–æ–ª—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">[math]::Floor(-1.8)</code> –æ–∫—Ä—É–≥–ª—è–µ—Ç —á–∏—Å–ª–æ –≤ –º–µ–Ω—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É <br />
<code class="language-plaintext highlighter-rouge">[math]::Min(33,22)</code> –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–∏–º–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–≤—É—Ö –∑–Ω–∞—á–µ–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">[math]::Max(33,22)</code> –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–≤—É—Ö –∑–Ω–∞—á–µ–Ω–∏–π</p>

<h3 id="round">Round</h3>

<p><code class="language-plaintext highlighter-rouge">[double]::Round(87.5, 0)</code> 88 (–Ω–µ—á–µ—Ç–Ω–æ–µ), –≤ .NET –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –≤ —Å—Ä–µ–¥–Ω–µ–π —Ç–æ—á–∫–µ ToEven, –≥–¥–µ *.5 –∑–Ω–∞—á–µ–Ω–∏—è –æ–∫—Ä—É–≥–ª—è—é—Ç—Å—è –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —á–µ—Ç–Ω–æ–≥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞. <br />
<code class="language-plaintext highlighter-rouge">[double]::Round(88.5, 0)</code> 88 (—á–µ—Ç–Ω–æ–µ) <br />
<code class="language-plaintext highlighter-rouge">[double]::Round(88.5, 0, 1)</code> 89 (–æ–∫—Ä—É–≥–ª—è—Ç—å –≤ –±–æ–ª—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É) <br />
<code class="language-plaintext highlighter-rouge">[double]::Round(1234.56789, 2)</code> –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ 2 —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π</p>

<h3 id="tostring">ToString</h3>

<p><code class="language-plaintext highlighter-rouge">(4164539/1MB).ToString("0.00")</code> —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –¥–≤–∞–∂–¥—ã –Ω–∞ 1024/1024 –∏ –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ 3,97</p>

<h3 id="char">Char</h3>

<p><code class="language-plaintext highlighter-rouge">[Char]</code> c–∏–º–≤–æ–ª –Æ–Ω–∏–∫–æ–¥–∞ (16-—Ä–∞–∑—Ä—è–¥–Ω—ã–π) <br />
<code class="language-plaintext highlighter-rouge">$char = $srv.ToCharArray()</code> —Ä–∞–∑–±–∏—Ç—å —Å—Ç—Ä–æ–∫—É [string] –Ω–∞ –º–∞—Å—Å–∏–≤ [System.Array] –∏–∑ –±—É–∫–≤ \</p>

<h1 id="module">Module</h1>

<h3 id="psd1">psd1</h3>
<pre><code class="language-PowerShell">@{
    RootModule        = "Get-Function.psm1"
    ModuleVersion     = "0.1"
    Author            = "Lifailon"
    CompanyName       = "Open Source Community"
    Copyright         = "Apache-2.0"
    Description       = "Function example"
    PowerShellVersion = "7.2"
    PrivateData       = @{
        PSData = @{
            Tags         = @("Function","Example")
            ProjectUri   = "https://github.com/Lifailon/PS-Commands"
            LicenseUri   = "https://github.com/Lifailon/Console-Translate/blob/rsa/LICENSE"
            ReleaseNotes = "Second release"
        }
    }
}
</code></pre>
<h3 id="psm1">psm1</h3>
<pre><code class="language-PowerShell">function Get-Function {
    &lt;#
    .SYNOPSIS
    –û–ø–∏—Å–∞–Ω–∏–µ
    .DESCRIPTION
    –û–ø–∏—Å–∞–Ω–∏–µ
    .LINK
    https://github.com/Lifailon/PS-Commands
    #&gt;
    param (
        [Parameter(Mandatory,ValueFromPipeline)][string]$Text,
        [ValidateSet("Test1","Test2")][string]$Provider = "Test1",
        [ValidateRange(1,3)][int]$Number = 2,
        [Switch]$Switch
    )
    Write-Host Param Text: $Text
    Write-Host Param Provider: $Provider
    Write-Host Param Number: $Number
    Write-Host Param Switch: $Switch
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Get-Function Test</code></p>

<h3 id="switch">Switch</h3>
<pre><code class="language-PowerShell">$MMM = Get-Date -UFormat "%m"
switch($MMM) {
    "01" {$Month = 'Jan'}
    "02" {$Month = 'Feb'}
    "03" {$Month = 'Mar'}
    "04" {$Month = 'Apr'}
    "05" {$Month = 'May'}
    "06" {$Month = 'Jun'}
    "07" {$Month = 'Jul'}
    "08" {$Month = 'Aug'}
    "09" {$Month = 'Sep'}
    "10" {$Month = 'Oct'}
    "11" {$Month = 'Nov'}
    "12" {$Month = 'Dec'}
}
</code></pre>
<h3 id="function-switch">function switch</h3>
<pre><code class="language-PowerShell">Function fun-switch (
    [switch]$param
) {
    If ($param) {"yes"} else {"no"}
}

fun-switch -param
</code></pre>
<h1 id="bit">Bit</h1>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>–î–≤–æ–∏—á–Ω–æ–µ    –î–µ—Å—è—Ç–∏—á–Ω–æ–µ
1           1
10          2
11          3
100         4
101         5
110         6
111         7
1000        8
1001        9
1010        10
1011        11
1100        12
1101        13
1110        14
1111        15
1 0000      16

–î–≤–æ–∏—á–Ω–æ–µ    –î–µ—Å—è—Ç–∏—á–Ω–æ–µ  –ù–æ–º–µ—Ä —Ä–∞–∑—Ä—è–¥–∞
1           1           0
10          2           1
100         4           2
1000        8           3
1 0000      16          4
10 0000     32          5
100 0000    64          6
1000 0000   128         7
1 0000 0000 256         8

–ò–∑ –¥–≤–æ–∏—á–Ω–æ–≥–æ =&gt; –¥–µ—Å—è—Ç–∏—á–Ω–æ–µ (1-–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ —Ç–∞–±–ª–∏—Ü–µ)
1001 0011 = 1000 0000 + 1 0000 + 10 + 1 = 128 + 16 + 2 + 1 = 147

2-–π –≤–∞—Ä–∏–∞–Ω—Ç
7654 3210 (—Ä–∞–∑—Ä—è–¥—ã –¥–≤–æ–∏—á–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è) = (1*2^7)+(0*2^6)+(0*2^5)+(1*2^4)+(0*2^3)+(0*2^2)+(1*2^1)+(1*2^0) = 147
[math]::Pow(2,7) + [math]::Pow(2,4) + [math]::Pow(2,1) + [math]::Pow(2,0) = 147` –∏—Å–∫–ª—é—á–∏—Ç—å 0 –∏ —Å–ª–æ–∂–∏—Ç—å —Å—Ç–µ–ø–µ–Ω—å

–ò–∑ –¥–µ—Å—è—Ç–∏—á–Ω–æ–≥–æ =&gt; –¥–≤–æ–∏—á–Ω–æ–µ (1-–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ —Ç–∞–±–ª–∏—Ü–µ)
347 –≤—ã—á–µ—Å—Ç—å –±–ª–∏–∂–∞–π—à–∏–µ 256 = 91 (+ 1 0000 0000 –∑–∞–±—Ä–∞—Ç—å –¥–≤–æ–∏—á–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫)
91  - 64  = 27 –±–ª–∏–∂–∞–π—à–µ–µ 16 (+ 100 0000)
27  - 16  = 11 –±–ª–∏–∂–∞–π—à–µ–µ 8 (+ 1 0000)
11  - 8   = 3  –±–ª–∏–∂–∞–π—à–µ–µ 2 (+ 1000)
3   - 2   = 1 (+ 10)
1   - 1   = 0 (+ 1)
1 0101 1011

2-–π –≤–∞—Ä–∏–∞–Ω—Ç
–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –¥–µ–ª–µ–Ω–∏—è —á–∏—Å–ª–∞ –Ω–∞ 2, –ø—Ä–µ–¥–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–±–∏—Ä–∞—è –æ—Å—Ç–∞—Ç–æ–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —á–µ—Ç–Ω–æ–≥–æ —á–∏—Å–ª–∞ –≤ –º–µ–Ω—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É
347 - 346 = –æ—Å—Ç–∞—Ç–æ–∫ 1, (347-1)/2 = 173
173 - 172 = –æ—Å—Ç–∞—Ç–æ–∫ 1, (172-1)/2 = 86
86  - 86  = –æ—Å—Ç–∞—Ç–æ–∫ 0, 86/2 = 43
43  - 42  = –æ—Å—Ç–∞—Ç–æ–∫ 1, (43-1)/2 = 21
21  - 20  = –æ—Å—Ç–∞—Ç–æ–∫ 1, (21-1)/2 = 10
10  - 10  = –æ—Å—Ç–∞—Ç–æ–∫ 0, 10/2 = 5
5   - 4   = –æ—Å—Ç–∞—Ç–æ–∫ 1, (5-1)/2 = 2
2   - 2   = –æ—Å—Ç–∞—Ç–æ–∫ 0, 2/2 = 1
1   - 2   = –æ—Å—Ç–∞—Ç–æ–∫ 1, (1-1)/2 = 0
–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö
</code></pre></div></div>
<h3 id="bit-convertor">Bit Convertor</h3>
<pre><code class="language-PowerShell">function ConvertTo-Bit {
    param (
        [Int]$int
    )
    [array]$bits = @()
    $test = $true
    while ($test -eq $true) {
        if (($int/2).GetType() -match [double]) {
            $int = ($int-1)/2
            [array]$bits += 1
        }
        elseif (($int/2).GetType() -match [int]) {
            $int = $int/2
            [array]$bits += 0
        }
        if ($int -eq 0) {
            $test = $false
        }
    }
    $bits =  $bits[-1..-999]
    ([string]($bits)) -replace "\s"
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">ConvertTo-Bit 347</code></p>
<pre><code class="language-PowerShell">function ConvertFrom-Bit {
    param (
        $bit
    )
    [int]$int = 0
    $bits = $bit.ToString().ToCharArray()
    $index = ($bits.Count)-1
    foreach ($b in $bits) {
        if ($b -notlike 0) {
            $int += [math]::Pow(2,$index)
        }
    $index -= 1
    }
    $int
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">ConvertFrom-Bit 10010011</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-Process pwsh | fl ProcessorAffinity</code> –ø—Ä–∏–≤—è–∑–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫ —è–¥—Ä–∞–º, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–∑ —Å–µ–±—è –±–∏—Ç–æ–≤—É—é –º–∞—Å–∫—É (bitmask), –≥–¥–µ –∫–∞–∂–¥–æ–º—É –±–∏—Ç—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —è–¥—Ä–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞. –ï—Å–ª–∏ –¥–ª—è —è–¥—Ä–∞ –æ—Ç–º–µ—á–µ–Ω–æ —Å—Ö–æ–¥—Å—Ç–≤–æ (affinity), —Ç–æ –±–∏—Ç –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ 1, –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî —Ç–æ –≤ 0. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω—ã –≤—Å–µ 16 —è–¥–µ—Ä, —Ç–æ —ç—Ç–æ 1111 1111 1111 1111 –∏–ª–∏ 65535. <br />
<code class="language-plaintext highlighter-rouge">(Get-Process pwsh).ProcessorAffinity = 15</code> 0000000000001111 –ø—Ä–∏—Å–≤–æ–∏—Ç—å 4 –ø–µ—Ä–≤—ã—Ö —è–¥—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">(Get-Process pwsh).ProcessorAffinity = 61440</code> 1111000000000000 –ø—Ä–∏—Å–≤–æ–∏—Ç—å 4 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —è–¥—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">(Get-Process pwsh).ProcessorAffinity = (ConvertFrom-Bit 1111000000000000)</code></p>

<h1 id="cycle">Cycle</h1>

<h3 id="foreach">Foreach</h3>

<p><code class="language-plaintext highlighter-rouge">$list = 100..110</code> —Å–æ–∑–¥–∞—Ç—å –º–∞—Å—Å–∏–≤ –∏–∑ —Ü–∏—Ñ—Ä –æ—Ç 100 –¥–æ 110 <br />
<code class="language-plaintext highlighter-rouge">foreach ($srv in $list) {ping 192.168.3.$srv -n 1 -w 50}</code> $srv —Ö—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –∏–∑ $list –∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –º–∞—Å—Å–∏–≤–µ <br />
<code class="language-plaintext highlighter-rouge">$foreach.Current</code> —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Ü–∏–∫–ª–µ <br />
<code class="language-plaintext highlighter-rouge">$foreach.Reset()</code> –æ–±–Ω—É–ª—è–µ—Ç –∏—Ç–µ—Ä–∞—Ü–∏—é, –ø–µ—Ä–µ–±–æ—Ä –Ω–∞—á–Ω–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º—É —Ü–∏–∫–ª—É <br />
<code class="language-plaintext highlighter-rouge">$foreach.MoveNext()</code> –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –≤ —Ü–∏–∫–ª–µ</p>

<h3 id="foreach-object-">ForEach-Object (%)</h3>
<pre><code class="language-PowerShell">100..110 | %{ping -n 1 -w 50 192.168.3.$_ &gt; $null
if ($LastExitCode -eq 0) {Write-Host "192.168.3.$_" -ForegroundColor green
} else {
Write-Host "192.168.3.$_"-ForegroundColor Red}}
%  # –ø–µ—Ä–µ–¥–∞—Ç—å —Ü–∏–∫–ª —á–µ—Ä–µ–∑ –∫–æ–Ω–≤–µ–µ—Ä (ForEach-Object)
$_ # –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ü–∏–∫–ª–∞ –∏ –∫–æ–Ω–≤–µ–µ—Ä–∞ ($PSItem)
gwmi Win32_QuickFixEngineering | where {$_.InstalledOn.ToString() -match "2022"} | %{($_.HotFixID.Substring(2))} # gwmi —Å–æ–∑–¥–∞–µ—Ç –º–∞—Å—Å–∏–≤, –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è where –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø–æ–¥ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤. –ü–æ –∫–æ–Ω–≤–µ–µ—Ä—É –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Ü–∏–∫–ª –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–µ—Ä–≤—ã—Ö (2) —Å–∏–º–≤–æ–ª–æ–≤ –º–µ—Ç–æ–¥–æ–º Substring –∏–∑ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ HotFixID.
</code></pre>
<h3 id="while">While</h3>
<pre><code class="language-PowerShell">$srv = "yandex.ru"
$out2 = "–ï—Å—Ç—å –ø–∏–Ω–≥"
$out3 = "–ù–µ—Ç –ø–∏–Ω–≥–∞"
$out = $false # –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, While –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏–µ –¥–æ –∑–∞–ø—É—Å–∫–∞ —Ü–∏–∫–ª–∞
While ($out -eq $false){ # –ø–æ–∫–∞ —É—Å–ª–æ–≤–∏–µ —è–≤–ª—è–µ—Ç—Å—è $true, —Ü–∏–∫–ª –±—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è
$out = ping -n 1 -w 50 $srv
if ($out -match "ttl") {$out = $true; $out2} else {$out = $false; $out3; sleep 1}
}

while ($True){ # –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª
$result = ping yandex.ru -n 1 -w 50
if ($result -match "TTL"){ # —É—Å–ª–æ–≤–∏–µ, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω break
Write-Host "–°–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω"
break # –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç —Ü–∏–∫–ª
} else {Write-Host "–°–∞–π—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"; sleep 1}
}
</code></pre>
<h3 id="try-catch-finally">Try-Catch-Finally</h3>
<pre><code class="language-PowerShell">Try {$out = pping 192.168.3.1}
Catch {Write-Warning "$($error[0])"} # –≤—ã–≤–æ–¥–∏—Ç –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ (–≤–º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏)
finally {$out = "End"} # –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ
</code></pre>
<h1 id="files">Files</h1>

<p><code class="language-plaintext highlighter-rouge">$file = [System.IO.File]::Create("$home\desktop\test.txt")</code> —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª <br />
<code class="language-plaintext highlighter-rouge">$file.Close()</code> –∑–∞–∫—Ä—ã—Ç—å —Ñ–∞–π–ª <br />
<code class="language-plaintext highlighter-rouge">[System.IO.File]::ReadAllLines("$home\desktop\test.txt")</code> –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª <br />
<code class="language-plaintext highlighter-rouge">$file = New-Object System.IO.StreamReader("$home\desktop\test.txt")</code> —Ñ–∞–π–ª –±—É–¥–µ—Ç –∑–∞–Ω—è—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–º PowerShell <br />
<code class="language-plaintext highlighter-rouge">$file | gm</code> <br />
<code class="language-plaintext highlighter-rouge">$file.ReadLine()</code> –ø–æ—Å—Ç—Ä–æ—á–Ω—ã–π –≤—ã–≤–æ–¥ <br />
<code class="language-plaintext highlighter-rouge">$file.ReadToEnd()</code> –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª —Ü–µ–ª–∏–∫–æ–º</p>

<h3 id="readwrite-bytes">Read/Write Bytes</h3>

<p><code class="language-plaintext highlighter-rouge">$file = [io.file]::ReadAllBytes("$home\desktop\powershell.jpg")</code> –º–µ—Ç–æ–¥ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–≤–æ–∏—á–Ω—ã–π —Ñ–∞–π–ª, —Å—á–∏—Ç—ã–≤–∞–µ—Ç –µ–≥–æ –≤ –º–∞—Å—Å–∏–≤ –±–∞–π—Ç –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª <br />
<code class="language-plaintext highlighter-rouge">[io.file]::WriteAllBytes("$home\desktop\tloztotk-2.jpg",$file)</code> —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–∞–π—Ç—ã –≤ —Ñ–∞–π–ª (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏ –¥–≤–æ–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ –ë–î)</p>

<p><code class="language-plaintext highlighter-rouge">Get-Content $home/desktop\test.txt -Wait</code> –∞–Ω–∞–ª–æ–≥ tail <br />
<code class="language-plaintext highlighter-rouge">Test-Path $path</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—É—Ç–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-ChildItem $path -Filter *.txt -Recurse</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–∞—Ç–∞–ª–æ–≥–∞ (Alias: ls/gci/dir) –∏ –¥–æ—á–µ—Ä–Ω–∏—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤ (-Recurse) –∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ <br />
<code class="language-plaintext highlighter-rouge">Get-Location</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –º–µ—Å—Ç–æ—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ (Alias: pwd/gl) <br />
<code class="language-plaintext highlighter-rouge">Set-Location $path</code> –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–∞–ª–æ–≥–∞–º (Alias: cd/sl) <br />
<code class="language-plaintext highlighter-rouge">Invoke-Item $path</code> –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª (Alias: ii/start) <br />
<code class="language-plaintext highlighter-rouge">Get-ItemProperty $env:userprofile\Documents\dns-list.txt | select FullName,Directory,Name,BaseName,Extension</code> —Å–≤–æ–π—Ç—Å–≤–∞ —Ñ–∞–π–ª–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-ItemProperty -Path $path\* | select FullName,CreationTime,LastWriteTime</code> —Å–≤–æ–π—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –¥–∞—Ç–∞ –∏—Ö —Å–æ–∑–¥–∞–Ω–∏—è –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">New-Item -Path "C:\test\" -ItemType "Directory"</code> —Å–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é (Alias: mkdir/md) <br />
<code class="language-plaintext highlighter-rouge">New-Item -Path "C:\test\file.txt" -ItemType "File" -Value "–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –≤ —Ñ–∞–π–ª"</code> —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª <br />
<code class="language-plaintext highlighter-rouge">"test" &gt; "C:\test\file.txt"</code> –∑–∞–º–µ–Ω–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ <br />
<code class="language-plaintext highlighter-rouge">"test" &gt;&gt; "C:\test\file.txt"</code> –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É –≤ —Ñ–∞–π–ª <br />
<code class="language-plaintext highlighter-rouge">New-Item -Path "C:\test\test\file.txt" -Force</code> –∫–ª—é—á –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤ –ø—É—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–∞ –µ—Å–ª–∏ –æ–Ω —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç <br />
<code class="language-plaintext highlighter-rouge">Move-Item</code> –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ (Alias: mv/move) <br />
<code class="language-plaintext highlighter-rouge">Remove-Item "$path\" -Recurse</code> —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–∞–ª–æ–≥–∞, –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–¥–≤–µ—Ä–∂–¥–µ–Ω–∏—è (Alias: rm/del) <br />
<code class="language-plaintext highlighter-rouge">Remove-Item $path -Recurse -Include "*.txt","*.temp" -Exclude "log.txt"</code> —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º txt –∏ temp ([Array]), –∫—Ä–æ–º–µ log.txt <br />
<code class="language-plaintext highlighter-rouge">Rename-Item "C:\test\*.*" "*.jpg"</code> –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –ø–æ –º–∞—Å–∫–µ (Alias: ren) <br />
<code class="language-plaintext highlighter-rouge">Copy-Item</code> –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ (Alias: cp/copy) <br />
<code class="language-plaintext highlighter-rouge">Copy-Item -Path "\\server-01\test" -Destination "C:\" -Recurse</code> –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –µ–µ —Å–æ–¥–µ—Ä–∂–∏–º—ã–º (-Recurse) <br />
<code class="language-plaintext highlighter-rouge">Copy-Item -Path "C:\*.txt" -Destination "C:\test\"</code> –∑–Ω–∞–∫ ‚Äò' –≤ –∫–æ–Ω—Ü–µ Destination –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –ø–∞–ø–∫–∏ –≤–Ω—É—Ç—Ä—å —É–∫–∞–∑–∞–Ω–Ω–æ–π, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ, —á—Ç–æ —ç—Ç–æ –Ω–æ–≤–æ–µ –∏–º—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Copy-Item -Path "C:\*" -Destination "C:\test\" -Include '*.txt','*.jpg'</code> –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º (Include) <br />
<code class="language-plaintext highlighter-rouge">Copy-Item -Path "C:\*" -Destination "C:\test\" -Exclude '*.jpeg'</code> –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º (Exclude) <br />
<code class="language-plaintext highlighter-rouge">$log = Copy-Item "C:\*.txt" "C:\test\" -PassThru</code> –≤—ã–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ) –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –º–æ–∂–Ω–æ –∑–∞–±–∏—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å –ø–æ–º–æ—â—å—é –∏–Ω–¥–µ–∫—Å–æ–≤ $log[0].FullName</p>

<h3 id="clear-env-temp-14-days">Clear-env-Temp-14-days</h3>
<pre><code class="language-PowerShell">$ls = Get-Item $env:TEMP\*.tmp # —Å—á–∏—Ç–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º
$date = (Get-Date).AddDays(-14)
foreach ($l in $ls) {
    if ($l.LastWriteTime -le $date) {
        $l.FullName
        Remove-Item $l.FullName -Recurse
    }
}
</code></pre>
<h3 id="filehash">Filehash</h3>
<p><code class="language-plaintext highlighter-rouge">Get-Filehash -Algorithm SHA256 "$env:USERPROFILE\Documents\RSA.conf.txt"</code></p>

<h3 id="microsoftpowershellarchive">Microsoft.PowerShell.Archive</h3>
<p><code class="language-plaintext highlighter-rouge">Compress-Archive -Path $sourcepath -DestinationPath $dstpath -CompressionLevel Optimal</code> –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å <br />
<code class="language-plaintext highlighter-rouge">Expand-Archive .\powerlinefonts.zip</code> —Ä–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å</p>

<h1 id="credential">Credential</h1>

<p><code class="language-plaintext highlighter-rouge">$Cred = Get-Credential</code> —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫—Ä–µ–¥—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ <code class="language-plaintext highlighter-rouge">$Cred.Username</code> –∏ <code class="language-plaintext highlighter-rouge">$Cred.Password</code> <br />
<code class="language-plaintext highlighter-rouge">$Cred.GetNetworkCredential().password</code> –∏–∑–≤–ª–µ—á—å –ø–∞—Ä–æ–ª—å <br />
<code class="language-plaintext highlighter-rouge">cmdkey /generic:"TERMSRV/$srv" /user:"$username" /pass:"$password"</code> –¥–æ–±–∞–≤–∏—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫—Ä–µ–¥—ã –∞—É–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ –Ω–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–µ–∑ –ø–∞—Ä–æ–ª—è <br />
<code class="language-plaintext highlighter-rouge">mstsc /admin /v:$srv</code> –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è <br />
<code class="language-plaintext highlighter-rouge">cmdkey /delete:"TERMSRV/$srv"</code> —É–¥–∞–ª–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∫—Ä–µ–¥—ã –∞—É–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã <br />
<code class="language-plaintext highlighter-rouge">rundll32.exe keymgr.dll,KRShowKeyMgr</code> —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Stored User Names and Password <br />
<code class="language-plaintext highlighter-rouge">Get-Service VaultSvc</code> —Å–ª—É–∂–±–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã Credential Manager <br />
<code class="language-plaintext highlighter-rouge">Install-Module CredentialManager</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Credential Manager –∫ —Ö—Ä–∞–Ω–∏–ª–∏—â—É PasswordVault –∏–∑ PowerShell <br />
<code class="language-plaintext highlighter-rouge">[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]'Tls11,Tls12'</code> –¥–ª—è —É—Å—Ç–∞–Ω–æ–∫–∏ –º–æ–¥—É–ª—è <br />
<code class="language-plaintext highlighter-rouge">Get-StoredCredential</code> –ø–æ–ª—É—á–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ Windows Vault <br />
<code class="language-plaintext highlighter-rouge">Get-StrongPassword</code> –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª—è <br />
<code class="language-plaintext highlighter-rouge">New-StoredCredential -UserName test -Password "123456"</code> –¥–æ–±–∞–≤–∏—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å <br />
<code class="language-plaintext highlighter-rouge">Remove-StoredCredential</code> —É–¥–∞–ª–∏—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å <br />
<code class="language-plaintext highlighter-rouge">$Cred = Get-StoredCredential | where {$_.username -match "admin"}</code> <br />
<code class="language-plaintext highlighter-rouge">$pass = $cred.password</code> <br />
<code class="language-plaintext highlighter-rouge">$BSTR = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pass)</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)</code></p>

<h3 id="out-gridview">Out-Gridview</h3>
<p><code class="language-plaintext highlighter-rouge">Get-Service -cn $srv | Out-GridView -Title "Service $srv" -OutputMode Single ‚ÄìPassThru | Restart-Service</code> –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–ª—É–∂–±—É</p>

<h3 id="out-file">Out-File</h3>
<p><code class="language-plaintext highlighter-rouge">Read-Host ‚ÄìAsSecureString | ConvertFrom-SecureString | Out-File "$env:userprofile\desktop\password.txt"</code> –ø–∏—Å–∞—Ç—å –≤ —Ñ–∞–π–ª. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –≤ —Ñ–æ—Ä–º–∞—Ç SecureString —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è Windows Data Protection API (DPAPI)</p>

<h3 id="get-content-gccattype">Get-Content (gc/cat/type)</h3>
<p><code class="language-plaintext highlighter-rouge">$password = gc "$env:userprofile\desktop\password.txt" | ConvertTo-SecureString</code> —á–∏—Ç–∞—Ç—å —Ö—ç—à –ø–∞—Ä–æ–ª—è –∏–∑ —Ñ–∞–π–ª–∞ —Å –ø–æ–º–æ—â—å—é –∫–ª—é—á–µ–π, —Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è –≤ –ø—Ä–æ—Ñ–∏–ª–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–º –∫–æ–ø—å—é—Ç–µ—Ä–µ</p>

<h3 id="aes-key">AES Key</h3>
<p><code class="language-plaintext highlighter-rouge">$AESKey = New-Object Byte[] 32</code> <br />
<code class="language-plaintext highlighter-rouge">[Security.Cryptography.RNGCryptoServiceProvider]::Create().GetBytes($AESKey)</code> <br />
<code class="language-plaintext highlighter-rouge">$AESKey | Out-File "C:\password.key"</code> <br />
<code class="language-plaintext highlighter-rouge">$Cred.Password | ConvertFrom-SecureString -Key (Get-Content "C:\password.key") | Set-Content "C:\password.txt"</code> —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ —Ñ–∞–π–ª –∏—Å–ø–æ–ª—å–∑—É—è –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á <br />
<code class="language-plaintext highlighter-rouge">$pass = Get-Content "C:\password.txt" | ConvertTo-SecureString -Key (Get-Content "\\Server\Share\password.key")</code> —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –Ω–∞ –≤—Ç–æ—Ä–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ</p>

<h1 id="winevent">WinEvent</h1>

<p><code class="language-plaintext highlighter-rouge">Get-WinEvent -ListLog *</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∂—É—Ä–Ω–∞–ª—ã –ª–æ–≥–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-WinEvent -ListLog * | where RecordCount -ne 0 | where RecordCount -ne $null | sort -Descending RecordCount</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–µ –ø—É—Å—Ç—ã–µ –∂—É—Ä–Ω–∞–ª—ã —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–æ –∫–æ–ª-–≤—É –∑–∞–ø–∏—Å–µ–π <br />
<code class="language-plaintext highlighter-rouge">Get-WinEvent -ListProvider * | ft</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">Get-WinEvent -ListProvider GroupPolicy</code> –Ω–∞–π—Ç–∏ –≤ –∫–∞–∫–æ–π –∂—É—Ä–Ω–∞–ª LogLinks {Application} –ø–∏—à—É—Ç—Å—è –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Get-WinEvent -ListProvider *smb*</code> <br />
<code class="language-plaintext highlighter-rouge">Get-WinEvent -ListLog * | where logname -match SMB | sort -Descending RecordCount</code> –Ω–∞–π—Ç–∏ –≤—Å–µ –∂—É—Ä–Ω–∞–ª—ã –ø–æ –∏–º–µ–Ω–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-WinEvent -LogName "Microsoft-Windows-SmbClient/Connectivity"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-WinEvent -ListProvider *firewall*</code></p>

<h3 id="filter-xpathhashtable">Filter XPath/Hashtable</h3>

<p><code class="language-plaintext highlighter-rouge">Get-WinEvent -FilterHashtable @{LogName="Security";ID=4624}</code> –Ω–∞–π—Ç–∏ –ª–æ–≥–∏ –ø–æ ID –≤ –∂—É—Ä–Ω–∞–ª–µ Security <br />
<code class="language-plaintext highlighter-rouge">Get-WinEvent -FilterHashtable @{LogName="System";Level=2}</code> –Ω–∞–π—Ç–∏ –≤—Å–µ –∑–∞–ø–∏—Å–∏ –æ—à–∏–±–∫–∏ (1 - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π, 3 - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, 4 - —Å–≤–µ–¥–µ–Ω–∏—è) <br />
<code class="language-plaintext highlighter-rouge">Get-WinEvent -FilterHashtable @{LogName="System";Level=2;ProviderName="Service Control Manager"}</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –∏–º–µ–Ω–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞</p>

<p><code class="language-plaintext highlighter-rouge">([xml](Get-WinEvent -FilterHashtable @{LogName="Security";ID=4688} -MaxEvents 1).ToXml()).Event.EventData.Data</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞, —Ö—Ä–∞–Ω–∏–º—ã–µ –≤ EventData (Message) <br />
<code class="language-plaintext highlighter-rouge">Get-WinEvent -FilterHashtable @{logname="security";ID=4688} -MaxEvents 1 | select timecreated,{$_.Properties[5].value}</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è –∏ –∏–º—è –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$query = '
&lt;QueryList&gt;
    &lt;Query Id="0" Path="Security"&gt;
        &lt;Select Path="Security"&gt;
		    *[System[EventID=4688]] and 
            *[EventData[Data[@Name="NewProcessName"]="C:\Windows\System32\autochk.exe" or Data[@Name="NewProcessName"]="C:\Windows\System32\services.exe"]]
        &lt;/Select&gt;
    &lt;/Query&gt;
&lt;/QueryList&gt;
'

Get-WinEvent -LogName Security -FilterXPath $query
</code></pre></div></div>
<h3 id="reboot">Reboot</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$query = '
&lt;QueryList&gt;
    &lt;Query Id="0" Path="System"&gt;
        &lt;Select Path="System"&gt;
		    *[
			System[
			EventID=41 or
			EventID=1074 or
			EventID=1076 or
			EventID=6005 or
			EventID=6006 or
			EventID=6008 or
			EventID=6009 or
			EventID=6013
			]
			]
        &lt;/Select&gt;
    &lt;/Query&gt;
&lt;/QueryList&gt;
'
Get-WinEvent -LogName System -FilterXPath $query

41  ` –°–∏—Å—Ç–µ–º–∞ –±—ã–ª–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞ –±–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã.
1074` –°–∏—Å—Ç–µ–º–∞ –±—ã–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã–∫–ª—é—á–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–º.
1076` –°–ª–µ–¥—É–µ—Ç –∑–∞ Event ID 6008 –∏ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–µ—Ä–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—Å –ø—Ä–∞–≤–æ–º –≤—ã–∫–ª—é—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã) –ø–æ–¥–∫–ª—é—á–∏–≤—à–∏–π—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ—Å–ª–µ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏—è, —É–∫–∞–∑–∞–ª –ø—Ä–∏—á–∏–Ω—É —ç—Ç–æ–≥–æ —Å–æ–±—ã—Ç–∏—è.
6005` –ó–∞–ø—É—Å–∫ "–ñ—É—Ä–Ω–∞–ª–∞ —Å–æ–±—ã—Ç–∏–π Windows" (Event Log). –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã.
6006` –û—Å—Ç–∞–Ω–æ–≤–∫–∞ ¬´–ñ—É—Ä–Ω–∞–ª–∞ —Å–æ–±—ã—Ç–∏–π Windows¬ª. –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã.
6008` –ü—Ä–µ–¥—ã–¥—É—â–µ–µ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –±—ã–ª–æ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º.
6009` –í–µ—Ä—Å–∏—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã.
6013` –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã (system uptime) –≤ —Å–µ–∫—É–Ω–¥–∞—Ö.
</code></pre></div></div>
<h3 id="logon">Logon</h3>
<pre><code class="language-PowerShell">$srv = "localhost"
$FilterXPath = '&lt;QueryList&gt;&lt;Query Id="0"&gt;&lt;Select&gt;*[System[EventID=21]]&lt;/Select&gt;&lt;/Query&gt;&lt;/QueryList&gt;'
$RDPAuths = Get-WinEvent -ComputerName $srv -LogName "Microsoft-Windows-TerminalServices-LocalSessionManager/Operational" -FilterXPath $FilterXPath
[xml[]]$xml = $RDPAuths | Foreach {$_.ToXml()}
$EventData = Foreach ($event in $xml.Event) {
New-Object PSObject -Property @{
"Connection Time" = (Get-Date ($event.System.TimeCreated.SystemTime) -Format 'yyyy-MM-dd hh:mm K')
"User Name" = $event.UserData.EventXML.User
"User ID" = $event.UserData.EventXML.SessionID
"User Address" = $event.UserData.EventXML.Address
"Event ID" = $event.System.EventID
}}
$EventData | ft
</code></pre>
<h3 id="eventlog">EventLog</h3>

<p><code class="language-plaintext highlighter-rouge">Get-EventLog -List</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –∫–æ—Ä–Ω–µ–≤—ã–µ –∂—É—Ä–Ω–∞–ª—ã –ª–æ–≥–æ–≤ –∏ –∏—Ö —Ä–∞–∑–º–µ—Ä <br />
<code class="language-plaintext highlighter-rouge">Clear-EventLog Application</code> –æ—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∂—É—Ä–Ω–∞–ª–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-EventLog -LogName Security -InstanceId 4624</code> –Ω–∞–π—Ç–∏ –ª–æ–≥–∏ –ø–æ ID –≤ –∂—É—Ä–Ω–∞–ª–µ Security</p>

<h1 id="firewall">Firewall</h1>
<pre><code class="language-PowerShell">$days = 5
$obj = @()
$fw = Get-WinEvent "Microsoft-Windows-Windows Firewall With Advanced Security/Firewall"
foreach ($temp_fw in $fw) {
if ($temp_fw.id -eq 2097) { # 2004
    $type = "Added Rule"
}
elseif ($temp_fw.id -eq 2006) {
    $type = "Deleted Rule"
}
$port = $temp_fw.Properties[7] | select -ExpandProperty value
$name = $temp_fw.Properties[1] | select -ExpandProperty value
$obj += [PSCustomObject]@{
    Time = $temp_fw.TimeCreated;
    Type = $type;
    Port = $port;
    Name = $name}
}
$obj | Where-Object time -gt (Get-Date).AddDays(-$days)
</code></pre>
<p><code class="language-plaintext highlighter-rouge">New-NetFirewallRule -Profile Any -DisplayName "Open Port 135 RPC" -Direction Inbound -Protocol TCP -LocalPort 135</code> –æ—Ç–∫—Ä—ã—Ç—å in-–ø–æ—Ä—Ç <br />
<code class="language-plaintext highlighter-rouge">Get-NetFirewallRule | where DisplayName -match kms | select *</code> –Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª–æ –ø–æ –∏–º–µ–Ω–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-NetFirewallPortFilter | where LocalPort -like 80</code> –Ω–∞–π—Ç–∏ –¥–µ–π—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∞–≤–∏–ª–æ –ø–æ –Ω–æ–º–µ—Ä—É –ø–æ—Ä—Ç–∞</p>
<pre><code class="language-PowerShell">Get-NetFirewallRule -Enabled True -Direction Inbound | select -Property DisplayName,
@{Name='Protocol';Expression={($_ | Get-NetFirewallPortFilter).Protocol}},
@{Name='LocalPort';Expression={($_ | Get-NetFirewallPortFilter).LocalPort}},
@{Name='RemotePort';Expression={($_ | Get-NetFirewallPortFilter).RemotePort}},
@{Name='RemoteAddress';Expression={($_ | Get-NetFirewallAddressFilter).RemoteAddress}},
Enabled,Profile
</code></pre>
<h3 id="firewall-manager">Firewall-Manager</h3>

<p><code class="language-plaintext highlighter-rouge">Install-Module Firewall-Manager</code> <br />
<code class="language-plaintext highlighter-rouge">Export-FirewallRules -Name * -CSVFile $home\documents\fw.csv</code> -Inbound -Outbound -Enabled -Disabled -Allow -Block (—Ñ–∏–ª—å—Ç—Ä –ø—Ä–∞–≤–∏–ª –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞) <br />
<code class="language-plaintext highlighter-rouge">Import-FirewallRules -CSVFile $home\documents\fw.csv</code></p>

<h1 id="defender">Defender</h1>

<p><code class="language-plaintext highlighter-rouge">Import-Module Defender</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Command -Module Defender</code> <br />
<code class="language-plaintext highlighter-rouge">Get-MpComputerStatus</code> <br />
<code class="language-plaintext highlighter-rouge">(Get-MpComputerStatus).AntivirusEnabled</code> —Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞</p>

<p><code class="language-plaintext highlighter-rouge">$session = NewCimSession -ComputerName hostname</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —É–¥–∞–ª–µ–Ω–Ω–æ–º—É –∫–æ–º–ø—å—é—Ç–µ—Ä—É, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è WinRM <br />
<code class="language-plaintext highlighter-rouge">Get-MpComputerStatus -CimSession $session | fl fullscan*</code> —É–∑–Ω–∞—Ç—å –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ</p>

<p><code class="language-plaintext highlighter-rouge">Get-MpPreference</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">(Get-MpPreference).ScanPurgeItemsAfterDelay</code> –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –∂—É—Ä–Ω–∞–ª–∞ –∑–∞—â–∏—Ç–Ω–∏–∫–∞ –≤ –¥–Ω—è—Ö <br />
<code class="language-plaintext highlighter-rouge">Set-MpPreference -ScanPurgeItemsAfterDelay 30</code> –∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">ls "C:\ProgramData\Microsoft\Windows Defender\Scans\History"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-MpPreference | select disable*</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –≤–∏–¥–æ–≤ –ø—Ä–æ–≤–µ—Ä–æ–∫/—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">Set-MpPreference -DisableRealtimeMonitoring $true</code> –æ—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É Defender –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ä—É—á–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ) <br />
<code class="language-plaintext highlighter-rouge">Set-MpPreference -DisableRemovableDriveScanning $false</code> –≤–∫–ª—é—á–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ USB –Ω–∞–∫–æ–ø–∏—Ç–µ–ª–µ–π <br />
<code class="language-plaintext highlighter-rouge">Get-MpPreference | select excl*</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">(Get-MpPreference).ExclusionPath</code> <br />
<code class="language-plaintext highlighter-rouge">Add-MpPreference -ExclusionPath C:\install</code> –¥–æ–±–∞–≤–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">Remove-MpPreference -ExclusionPath C:\install</code> —É–¥–∞–ª–∏—Ç—å –∏–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force</code> –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å Windows Defender</p>

<p><code class="language-plaintext highlighter-rouge">Set-MpPreference -SignatureDefinitionUpdateFileSharesSources \\FileShare1\Updates</code> –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ —Å–µ—Ç–µ–≤–æ–π –ø–∞–ø–∫–∏ –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª—ã —Å —Å–∏–≥–Ω–∞—Ç—É—Ä–∞–º–∏ –±–∞–∑ —Å —Å–∞–π—Ç–∞ https://www.microsoft.com/security/portal/definitions/adl.aspx –∏ –ø–æ–º–µ—Å—Ç–∏—Ç—å –≤ —Å–µ—Ç–µ–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥
<code class="language-plaintext highlighter-rouge">Update-MpSignature -UpdateSource FileShares</code> –∏–∑–º–µ–Ω–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (MicrosoftUpdateServer ‚Äì —Å–µ—Ä–≤–µ—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π MS –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ, InternalDefinitionUpdateServer ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π WSUS —Å–µ—Ä–≤–µ—Ä) <br />
<code class="language-plaintext highlighter-rouge">Update-MpSignature</code> –æ–±–Ω–æ–≤–∏—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—ã</p>

<p><code class="language-plaintext highlighter-rouge">Start-MpScan -ScanType QuickScan</code> –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–ª–∏ FullScan <br />
<code class="language-plaintext highlighter-rouge">Start-MpScan -ScanType FullScan -AsJob</code> <br />
<code class="language-plaintext highlighter-rouge">Set-MpPreference -RemediationScheduleDay 1-7</code> –≤—ã–±—Ä–∞—Ç—å –¥–Ω–∏, –Ω–∞—á–∏–Ω–∞—è —Å –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è –∏–ª–∏ 0 –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, 8 - —Å–±—Ä–æ—Å–∏—Ç—å <br />
<code class="language-plaintext highlighter-rouge">Set-MpPreference -ScanScheduleQuickScanTime 14:00:00</code> <br />
<code class="language-plaintext highlighter-rouge">Start-MpScan -ScanType CustomScan -ScanPath "C:\Program Files"</code> —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é</p>

<p><code class="language-plaintext highlighter-rouge">Get-MpThreat</code> –∏—Å—Ç–æ—Ä–∏—è —É–≥—Ä–æ–∑ –∏ —Ç–∏–ø —É–≥—Ä–æ–∑—ã (ThreatName: HackTool/Trojan) <br />
<code class="language-plaintext highlighter-rouge">Get-MpThreatCatalog</code> —Å–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –≤–∏–¥–æ–≤ —É–≥—Ä–æ–∑ <br />
<code class="language-plaintext highlighter-rouge">Get-MpThreatDetection</code> –∏—Å—Ç–æ—Ä–∏—è –∑–∞—â–∏—Ç—ã (–∞–∫—Ç–∏–≤–Ω—ã—Ö –∏ –ø—Ä–æ—à–ª—ã–µ) –∏ ID —É–≥—Ä–æ–∑—ã <br />
<code class="language-plaintext highlighter-rouge">Get-MpThreat -ThreatID 2147760253</code></p>

<p><code class="language-plaintext highlighter-rouge">ls "C:\ProgramData\Microsoft\Windows Defender\Quarantine\"</code> –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –≤ –∫–∞—Ä–∞–Ω—Ç–∏–Ω–µ <br />
<code class="language-plaintext highlighter-rouge">cd "C:\Program Files\Windows Defender\"</code> <br />
<code class="language-plaintext highlighter-rouge">.\MpCmdRun.exe -restore -name $ThreatName</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª –∏–∑ –∫–∞—Ä–∞–Ω—Ç–∏–Ω–∞ <br />
<code class="language-plaintext highlighter-rouge">.\MpCmdRun.exe -restore -filepath $path_file</code></p>

<h1 id="windowsupdate">WindowsUpdate</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Hotfix | Sort-Object -Descending  InstalledOn</code> —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ cimv2) <br />
<code class="language-plaintext highlighter-rouge">Get-Hotfix -Description "Security update"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-CimInstance Win32_QuickFixEngineering</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Command -Module WindowsUpdate</code> <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsUpdateLog</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Service uhssvc</code> —Å–ª—É–∂–±–∞ Microsoft Health Update Tools, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π</p>

<p><code class="language-plaintext highlighter-rouge">Install-Module -Name PSWindowsUpdate -Scope CurrentUser</code> <br />
<code class="language-plaintext highlighter-rouge">Import-Module PSWindowsUpdate</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Command -Module PSWindowsUpdate</code> <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsUpdate</code> —Å–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –¥–ª—è —Å–∫–∞—á–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞ WSUS –∏–ª–∏ Microsoft Update <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsUpdate -Download</code> –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsUpdate ‚ÄìInstall</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Install-WindowsUpdate -MicrosoftUpdate -AcceptAll -IgnoreReboot</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsUpdate -KBArticleID KB2267602, KB4533002 -Install</code> <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsUpdate -KBArticleID KB2538243 -Hide</code> —Å–∫—Ä—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —á—Ç–æ –±—ã –æ–Ω–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∏—Å—å <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsUpdate ‚ÄìIsHidden</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (Hide-WindowsUpdate) <br />
<code class="language-plaintext highlighter-rouge">Remove-WindowsUpdate -KBArticleID KB4011634 -NoRestart</code> —É–¥–∞–ª–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">Uninstall-WindowsUpdate</code> —É–¥–∞–ª–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">Add-WUServiceManager</code> —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (Windows Update Service Manager) <br />
<code class="language-plaintext highlighter-rouge">Enable-WURemoting</code> –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ Windows Defender, —Ä–∞–∑—Ä–µ—à–∞—é—â–∏–µ —É–¥–∞–ª–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥–ª–µ—Ç–∞ PSWindowsUpdate <br />
<code class="language-plaintext highlighter-rouge">Get-WUApiVersion</code> –≤–µ—Ä—Å–∏—è Windows Update Agent <br />
<code class="language-plaintext highlighter-rouge">Get-WUHistory</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (–∏—Å—Ç–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π) <br />
<code class="language-plaintext highlighter-rouge">Get-WUHistory | Where-Object {$_.Title -match "KB4517389"}</code> –ø–æ–∏—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Get-WULastResults</code> –¥–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">Get-WURebootStatus</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω—É–∂–Ω–∞ –ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Get-WUServiceManager</code> –≤—ã–≤–æ–¥–∏—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">Get-WUInstallerStatus</code> —Å—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã Windows Installer <br />
<code class="language-plaintext highlighter-rouge">Remove-WUServiceManager</code> –æ—Ç–∫–ª—é—á–∏—Ç—å Windows Update Service Manager</p>

<h1 id="dism">DISM</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Command -Module Dism -Name *Driver*</code> <br />
<code class="language-plaintext highlighter-rouge">Export-WindowsDriver -Online -Destination C:\Users\Lifailon\Documents\Drivers\</code> –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏–∑ —Ç–µ–∫—É—â–µ–π —Å–∏—Å—Ç–µ–º—ã (C:\Windows\System32\DriverStore\FileRepository), –≤—ã–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞ (dll,sys,exe) –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å–ø–∏—Å–∫–æ–º —Ñ–∞–π–ª–æ–≤, —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤ —Å–µ–∫—Ü–∏–∏ [CopyFiles] inf-—Ñ–∞–π–ª–∞ –¥—Ä–∞–π–≤–µ—Ä–∞. <br />
<code class="language-plaintext highlighter-rouge">Export-WindowsDriver -Path C:\win_image -Destination C:\drivers</code> –∏–∑–≤–ª–µ—á—å –¥—Ä–∞–π–≤–µ—Ä–∞ –∏–∑ –æ—Ñ–ª–∞–π–Ω –æ–±—Ä–∞–∑–∞ Windows, —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤ –∫–∞—Ç–∞–ª–æ–≥ c:\win_image <br />
<code class="language-plaintext highlighter-rouge">$BackupDrivers = Export-WindowsDriver -Online -Destination C:\Drivers</code> <br />
<code class="language-plaintext highlighter-rouge">$BackupDrivers | ft Driver,ClassName,ProviderName,Date,Version,ClassDescription</code> —Å–ø–∏—Å–æ–∫ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –≤ –æ–±—ä–µ–∫—Ç–Ω–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">$BackupDrivers | where classname -match printer</code> <br />
<code class="language-plaintext highlighter-rouge">pnputil.exe /add-driver C:\drivers\*.inf /subdirs /install</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ (–ø–∞—Ä–∞–º–µ—Ç—Ä subdirs) –¥—Ä–∞–π–≤–µ—Ä–∞ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–∏ (–≤–∫–ª—é—á–∞—è –≤–ª–æ–∂–µ–Ω–Ω—ã–µ)</p>

<p><code class="language-plaintext highlighter-rouge">sfc /scannow</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å –ø–æ–º–æ—â—å—é —É—Ç–∏–ª–∏—Ç—ã SFC (System File Checker), –≤ —Å–ª—É—á–∞–µ –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫, –ø–æ–ø—Ä–æ–±—É–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Ö –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∫–æ–ø–∏–∏ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Windows (–∫–∞—Ç–∞–ª–æ–≥ C:\Windows\WinSxS). –í—ã–≤–æ–¥ —Ä–∞–±–æ—Ç—ã –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ C:\Windows\Logs\CBS —Å —Ç–µ–≥–æ–º SR <br />
<code class="language-plaintext highlighter-rouge">Get-ComputerInfo | select *</code> –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ (WindowsVersion,WindowsEditionId,<em>Bios</em>) <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsImage -ImagePath E:\sources\install.wim</code> —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–µ—Ä—Å–∏–π –≤ –æ–±—Ä–∞–∑–µ <br />
<code class="language-plaintext highlighter-rouge">Repair-WindowsImage -Online ‚ÄìScanHealth</code> <br />
<code class="language-plaintext highlighter-rouge">Repair-WindowsImage -Online -RestoreHealth</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Repair-WindowsImage -Online -RestoreHealth -Source E:\sources\install.wim:3 ‚ÄìLimitAccess</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–µ –∏–∑ –æ–±—Ä–∞–∑–∞ –ø–æ –Ω–æ–º–µ—Ä—É –∏–Ω–¥–µ–∫—Å–∞</p>

<h1 id="scheduled">Scheduled</h1>

<p><code class="language-plaintext highlighter-rouge">$Trigger = New-ScheduledTaskTrigger -At 01:00am -Daily</code> 1:00 –Ω–æ—á–∏ <br />
<code class="language-plaintext highlighter-rouge">$Trigger = New-ScheduledTaskTrigger ‚ÄìAtLogon</code> –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º—É <br />
<code class="language-plaintext highlighter-rouge">$Trigger = New-ScheduledTaskTrigger -AtStartup</code> –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–∏—Å—Ç–µ–º—ã <br />
<code class="language-plaintext highlighter-rouge">$User = "NT AUTHORITY\SYSTEM"</code> <br />
<code class="language-plaintext highlighter-rouge">$Action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "$home\Documents\DNS-Change-Tray-1.3.ps1"</code> <br />
<code class="language-plaintext highlighter-rouge">$Action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "-NoProfile -NoLogo -NonInteractive -ExecutionPolicy Unrestricted -WindowStyle Hidden -File $home\Documents\DNS-Change-Tray-1.3.ps1"</code> <br />
<code class="language-plaintext highlighter-rouge">Register-ScheduledTask -TaskName "DNS-Change-Tray-Startup" -Trigger $Trigger -User $User -Action $Action -RunLevel Highest ‚ÄìForce</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-ScheduledTask | ? state -ne Disabled</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">Start-ScheduledTask DNS-Change-Tray-Startup</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ <br />
<code class="language-plaintext highlighter-rouge">Get-ScheduledTask DNS-Change-Tray-Startup | Disable-ScheduledTask</code> –æ—Ç–∫–ª—é—á–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">Get-ScheduledTask DNS-Change-Tray-Startup | Enable-ScheduledTask</code> –≤–∫–ª—é—á–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">Unregister-ScheduledTask DNS-Change-Tray-Startup</code> —É–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">Export-ScheduledTask DNS-Change-Tray-Startup | Out-File $home\Desktop\Task-Export-Startup.xml</code> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ –≤ xml <br />
<code class="language-plaintext highlighter-rouge">Register-ScheduledTask -Xml (Get-Content $home\Desktop\Task-Export-Startup.xml | Out-String) -TaskName "DNS-Change-Tray-Startup"</code></p>

<h1 id="network">Network</h1>

<h3 id="ping">ping</h3>
<p><code class="language-plaintext highlighter-rouge">Test-Connection -Count 1 $srv1, $srv2</code> –æ—Ç–ø—Ä–∞–≤–∏—Ç—å icmp-–ø–∞–∫–µ—Ç –¥–≤—É–º —Ö–æ—Å—Ç–∞–º <br />
<code class="language-plaintext highlighter-rouge">Test-Connection $srv -ErrorAction SilentlyContinue</code> –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—å –æ—à–∏–±–æ–∫, –µ—Å–ª–∏ —Ö–æ—Å—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç <br />
<code class="language-plaintext highlighter-rouge">Test-Connection -Source $srv1 -ComputerName $srv2</code> –ø–∏–Ω–≥ —Å —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</p>
<pre><code class="language-PowerShell">function Test-PingNetwork {
param (
    [Parameter(Mandatory,ValueFromPipeline)][string[]]$Network,
    [ValidateRange(100,10000)][int]$Timeout = 100
)
$ping = New-Object System.Net.NetworkInformation.Ping
$Network  = $Network -replace "0$"
$net = @()
foreach ($r in @(1..254)) {
    $net += "$network$r"
}
foreach ($n in $net) {
    $ping.Send($n, $timeout) | select @{Name="Address"; Expression={$n -replace ".+\."}}, Status
}
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Test-PingNetwork -Network 192.168.3.0</code> <br />
<code class="language-plaintext highlighter-rouge">Test-PingNetwork -Network 192.168.3.0 -Timeout 1000</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-CimInstance -Class Win32_PingStatus -Filter "Address='127.0.0.1'"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-CimInstance -Class Win32_PingStatus -Filter "Address='127.0.0.1'" | Format-Table -Property Address,ResponseTime,StatusCode -Autosize</code> 0 - —É—Å–ø–µ—Ö <br />
<code class="language-plaintext highlighter-rouge">'127.0.0.1','8.8.8.8' | ForEach-Object -Process {Get-CimInstance -Class Win32_PingStatus -Filter ("Address='$_'") | Select-Object -Property Address,ResponseTime,StatusCode}</code> <br />
<code class="language-plaintext highlighter-rouge">$ips = 1..254 | ForEach-Object -Process {'192.168.1.' + $_}</code> —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ –∏–∑ ip-–∞–¥—Ä–µ—Å–æ–≤ –ø–æ–¥—Å–µ—Ç–∏</p>

<h3 id="dhcp">dhcp</h3>
<p><code class="language-plaintext highlighter-rouge">Get-CimInstance -Class Win32_NetworkAdapterConfiguration -Filter "DHCPEnabled=$true"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∞–¥–∞–ø—Ç–µ—Ä—ã —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º DHCP <br />
<code class="language-plaintext highlighter-rouge">$wql = 'SELECT * from Win32_NetworkAdapterConfiguration WHERE IPEnabled=True and DHCPEnabled=False'</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-CimMethod -MethodName ReleaseDHCPLease -Query $wql</code> –≤–∫–ª—é—á–µ–Ω–∏–µ DHCP –Ω–∞ –≤—Å–µ—Ö –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö <br />
<code class="language-plaintext highlighter-rouge">Invoke-CimMethod -ClassName Win32_NetworkAdapterConfiguration -MethodName ReleaseDHCPLeaseAll</code> –æ—Ç–º–µ–Ω–∏—Ç—å –∞—Ä–µ–Ω–¥—É –∞–¥—Ä–µ—Å–æ–≤ DHCP –Ω–∞ –≤—Å–µ—Ö –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö <br />
<code class="language-plaintext highlighter-rouge">Invoke-CimMethod -ClassName Win32_NetworkAdapterConfiguration -MethodName RenewDHCPLeaseAll</code> –æ–±–Ω–æ–≤–∏—Ç—å –∞—Ä–µ–Ω–¥—É –∞–¥—Ä–µ—Å–æ–≤ DHCP –Ω–∞ –≤—Å–µ—Ö –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö</p>

<h3 id="port">port</h3>
<p><code class="language-plaintext highlighter-rouge">tnc $srv -p 5985</code> <br />
<code class="language-plaintext highlighter-rouge">tnc $srv -CommonTCPPort WINRM</code> HTTP,RDP,SMB <br />
<code class="language-plaintext highlighter-rouge">tnc ya.ru ‚ÄìTraceRoute -Hops 2</code> TTL=2 <br />
<code class="language-plaintext highlighter-rouge">tnc ya.ru -DiagnoseRouting</code> –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –¥–æ —Ö–æ—Å—Ç–∞, –∫—É–¥–∞ (DestinationPrefix: 0.0.0.0/0) —á–µ—Ä–µ–∑ (NextHop: 192.168.1.254)</p>

<h3 id="nslookup">nslookup</h3>
<p><code class="language-plaintext highlighter-rouge">nslookup ya.ru 1.1.1.1</code> —Å —É–∫–∞–∑–∞–Ω–∏–µ–º DNS —Å–µ—Ä–≤–µ—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">nslookup -type=any ya.ru</code> —É–∫–∞–∑–∞—Ç—å —Ç–∏–ø –∑–∞–ø–∏—Å–∏ <br />
<code class="language-plaintext highlighter-rouge">Resolve-DnsName ya.ru -Type MX</code> ALL,ANY,A,NS,SRV,CNAME,PTR,TXT(spf) <br />
<code class="language-plaintext highlighter-rouge">[System.Net.Dns]::GetHostEntry("ya.ru")</code></p>

<h3 id="ipconfig">ipconfig</h3>
<p><code class="language-plaintext highlighter-rouge">Get-NetIPConfiguration</code> <br />
<code class="language-plaintext highlighter-rouge">Get-NetIPConfiguration -InterfaceIndex 14 -Detailed</code></p>

<h3 id="adapter">Adapter</h3>
<p><code class="language-plaintext highlighter-rouge">Get-NetAdapter</code> <br />
<code class="language-plaintext highlighter-rouge">Set-NetIPInterface -InterfaceIndex 14 -Dhcp Disabled</code> –æ—Ç–∫–ª—é—á–∏—Ç—å DHCP <br />
<code class="language-plaintext highlighter-rouge">Get-NetAdapter -InterfaceIndex 14 | New-NetIPAddress ‚ÄìIPAddress 192.168.3.99 -DefaultGateway 192.168.3.1 -PrefixLength 24</code> –∑–∞–¥–∞—Ç—å/–¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP-–∞–¥—Ä–µ—Å <br />
<code class="language-plaintext highlighter-rouge">Set-NetIPAddress -InterfaceIndex 14 -IPAddress 192.168.3.98</code> –∏–∑–º–µ–Ω–∏—Ç—å IP-–∞–¥—Ä–µ–∞—Å –Ω–∞ –∞–¥–∞–ø—Ç–µ—Ä–µ <br />
<code class="language-plaintext highlighter-rouge">Remove-NetIPAddress -InterfaceIndex 14 -IPAddress 192.168.3.99</code> —É–¥–∞–ª–∏—Ç—å IP-–∞–¥—Ä–µ—Å –Ω–∞ –∞–¥–∞–ø—Ç–µ—Ä–µ <br />
<code class="language-plaintext highlighter-rouge">Set-NetIPInterface -InterfaceIndex 14 -Dhcp Enabled</code> –≤–∫–ª—é—á–∏—Ç—å DHCP</p>

<h3 id="dnsclient">DNSClient</h3>
<p><code class="language-plaintext highlighter-rouge">Get-DNSClientServerAddress</code> <br />
<code class="language-plaintext highlighter-rouge">Set-DNSClientServerAddress -InterfaceIndex 14 -ServerAddresses 8.8.8.8</code></p>

<h3 id="dnscache">DNSCache</h3>
<p><code class="language-plaintext highlighter-rouge">Get-DnsClientCache</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞ DNS <br />
<code class="language-plaintext highlighter-rouge">Clear-DnsClientCache</code> –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à</p>

<h3 id="binding">Binding</h3>
<p><code class="language-plaintext highlighter-rouge">Get-NetAdapterBinding -Name Ethernet -IncludeHidden -AllBindings</code> <br />
<code class="language-plaintext highlighter-rouge">Get-NetAdapterBinding -Name "–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–∞—è —Å–µ—Ç—å" -DisplayName "IP –≤–µ—Ä—Å–∏–∏ 6 (TCP/IPv6)" | Set-NetAdapterBinding -Enabled $false</code> –æ—Ç–∫–ª—é—á–∏—Ç—å IPv6 –Ω–∞ –∞–¥–∞–ø—Ç–µ—Ä–µ</p>

<h3 id="tcpsetting">TCPSetting</h3>
<p><code class="language-plaintext highlighter-rouge">Get-NetTCPSetting</code> <br />
<code class="language-plaintext highlighter-rouge">Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -CongestionProvider DCTCP</code> <br />
<code class="language-plaintext highlighter-rouge">Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -CwndRestart True</code> <br />
<code class="language-plaintext highlighter-rouge">Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -ForceWS Disabled</code></p>

<h3 id="netstat">netstat</h3>
<p><code class="language-plaintext highlighter-rouge">netstat -anop tcp</code> -n/-f/-b <br />
<code class="language-plaintext highlighter-rouge">Get-NetTCPConnection -State Established,Listen | ? LocalPort -Match 3389</code> <br />
<code class="language-plaintext highlighter-rouge">Get-NetTCPConnection -State Established,Listen | ? RemotePort -Match 22</code> <br />
<code class="language-plaintext highlighter-rouge">Get-NetUDPEndpoint | ? LocalPort -Match 514</code> netstat -ap udp`</p>

<h3 id="statistics">Statistics</h3>
<p><code class="language-plaintext highlighter-rouge">netstat -se</code> <br />
<code class="language-plaintext highlighter-rouge">Get-NetAdapterStatistics</code></p>

<h3 id="hostname">hostname</h3>
<p><code class="language-plaintext highlighter-rouge">$env:computername</code> <br />
<code class="language-plaintext highlighter-rouge">hostname.exe</code> <br />
<code class="language-plaintext highlighter-rouge">(Get-CIMInstance CIM_ComputerSystem).Name</code> <br />
<code class="language-plaintext highlighter-rouge">(New-Object -ComObject WScript.Network).ComputerName</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Environment]::MachineName</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Net.Dns]::GetHostName()</code></p>

<h3 id="arp">arp</h3>
<p><code class="language-plaintext highlighter-rouge">ipconfig /all | Select-String "—Ñ–∏–∑"</code> grep <br />
<code class="language-plaintext highlighter-rouge">Get-NetNeighbor -AddressFamily IPv4</code></p>
<pre><code class="language-PowerShell">function Get-ARP {
Param (
$proxy,
$search
)
if (!$proxy) {
$arp = arp -a
}
if ($proxy) {
$arp = icm $proxy {arp -a}
}
$mac = $arp[3..260]
$mac = $mac -replace "^\s\s"
$mac = $mac -replace "\s{1,50}"," "
$mac_coll = New-Object System.Collections.Generic.List[System.Object]
foreach ($m in $mac) {
$smac = $m -split " "
$mac_coll.Add([PSCustomObject]@{
IP = $smac[0];
MAC = $smac[1];
Type = $smac[2]
})
}
if ($search) {
if ($search -NotMatch "\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}") {
#$ns = nslookup $search
#$ns = $ns[-2]
#$global:ns = $ns -replace "Address:\s{1,10}"
$rdns = Resolve-DnsName $search -ErrorAction Ignore
$ns = $rdns.IPAddress
if ($ns -eq $null) {
return
}
} else {
$ns = $search
}
$mac_coll = $mac_coll | ? ip -Match $ns
}
$mac_coll
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Get-ARP -search 192.168.3.100</code> <br />
<code class="language-plaintext highlighter-rouge">Get-ARP -search 192.168.3.100 -proxy dc-01</code></p>

<h1 id="rdp">RDP</h1>

<p><code class="language-plaintext highlighter-rouge">Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "PortNumber"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ RDP –ø–æ—Ä—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "PortNumber" -Value "3390"</code> –∏–∑–º–µ–Ω–∏—Ç—å RDP-–ø–æ—Ä—Ç <br />
<code class="language-plaintext highlighter-rouge">$(Get-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server\" -Name "fDenyTSConnections").fDenyTSConnections</code> –µ—Å–ª–∏ 0, —Ç–æ –≤–∫–ª—é—á–µ–Ω <br />
<code class="language-plaintext highlighter-rouge">Set-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server\" -Name "fDenyTSConnections" -Value 0</code> –≤–∫–ª—é—á–∏—Ç—å RDP <br />
<code class="language-plaintext highlighter-rouge">reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f</code> <br />
<code class="language-plaintext highlighter-rouge">(gcim -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).SetAllowTSConnections(0)</code> –≤–∫–ª—é—á–∏—Ç—å RDP (–¥–ª—è Windows Server) <br />
<code class="language-plaintext highlighter-rouge">Get-Service TermService | Restart-Service -Force</code> –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å rdp-—Å–ª—É–∂–±—É <br />
<code class="language-plaintext highlighter-rouge">New-NetFirewallRule -Profile Any -DisplayName "RDP 3390" -Direction Inbound -Protocol TCP -LocalPort 3390</code> –æ—Ç–∫—Ä—ã—Ç—å RDP-–ø–æ—Ä—Ç</p>

<h3 id="ipban">IPBan</h3>

<p><code class="language-plaintext highlighter-rouge">auditpol /get /category:*</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –∞—É–¥–∏—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">auditpol /get /category:–í—Ö–æ–¥/–≤—ã—Ö–æ–¥</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –∞—É–¥–∏—Ç–∞ –¥–ª—è –í—Ö–æ–¥–∞ –∏ –í—ã—Ö–æ–¥–∞ –∏–∑ —Å–∏—Å—Ç–µ–º—ã <br />
<code class="language-plaintext highlighter-rouge">auditpol /set /subcategory:"–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É" /success:enable /failure:enable</code> –≤–∫–ª—é—á–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ - –ê—É–¥–∏—Ç –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É <br />
<code class="language-plaintext highlighter-rouge">auditpol /set /subcategory:"–í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã" /success:enable /failure:enable</code></p>

<p><code class="language-plaintext highlighter-rouge">$url = $($(Invoke-RestMethod https://api.github.com/repos/DigitalRuby/IPBan/releases/latest).assets | Where-Object name -match ".+win.+x64.+").browser_download_url</code> –ø–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">$version = $(Invoke-RestMethod https://api.github.com/repos/DigitalRuby/IPBan/releases/latest).tag_name</code> –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">$path = "$home\Documents\ipban-$version"</code> –ø—É—Ç—å –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod $url -OutFile "$home\Downloads\IPBan-$version.zip"</code> —Å–∫–∞—á–∞—Ç—å –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ <br />
<code class="language-plaintext highlighter-rouge">Expand-Archive "$home\Downloads\ipban-$version.zip" -DestinationPath $path</code> —Ä–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—É—Ç—å –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">Remove-Item "$home\Downloads\ipban-$version.zip"</code> —É–¥–∞–ª–∏—Ç—å –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ <br />
<code class="language-plaintext highlighter-rouge">sc create IPBan type=own start=delayed-auto binPath="$path\DigitalRuby.IPBan.exe" DisplayName=IPBan</code> —Å–æ–∑–¥–∞—Ç—å —Å–ª—É–∂–±—É <br />
<code class="language-plaintext highlighter-rouge">Get-Service IPBan</code> —Å—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã <br />
<code class="language-plaintext highlighter-rouge">$conf = $(Get-Content "$path\ipban.config")</code> —á–∏—Ç–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é <br />
<code class="language-plaintext highlighter-rouge">$conf = $conf -replace '&lt;add key="Whitelist" value=""/&gt;','&lt;add key="Whitelist" value="192.168.3.0/24"/&gt;'</code> –¥–æ–±–∞–≤–∏—Ç—å –≤ –±–µ–ª—ã–π –ª–∏—Å—Ç –¥–æ–º–∞—à–Ω—é—é —Å–µ—Ç—å –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">$conf = $conf -replace '&lt;add key="ProcessInternalIPAddresses" value="false"/&gt;','&lt;add key="ProcessInternalIPAddresses" value="true"/&gt;'</code> –≤–∫–ª—é—á–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ª–æ–∫–∞–ª—å–Ω—ã—Ö (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö) ip-–∞–¥—Ä–µ—Å–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">$conf = $conf -replace '&lt;add key="FailedLoginAttemptsBeforeBanUserNameWhitelist" value="20"/&gt;','&lt;add key="FailedLoginAttemptsBeforeBanUserNameWhitelist" value="5"/&gt;'</code> —É–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">$conf = $conf -replace '&lt;add key="ExpireTime" value="01:00:00:00"/&gt;','&lt;add key="ExpireTime" value="00:01:00:00"/&gt;'</code> –∑–∞–¥–∞—Ç—å –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ 1 —á–∞—Å <br />
<code class="language-plaintext highlighter-rouge">$conf &gt; "$path\ipban.config"</code> –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é <br />
<code class="language-plaintext highlighter-rouge">Get-Service IPBan | Start-Service</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-NetFirewallRule | Where-Object DisplayName -Match "IPBan" | ForEach-Object {
    $Name = $_.DisplayName
    Get-NetFirewallAddressFilter -AssociatedNetFirewallRule $_ | Select-Object @{Name="Name"; Expression={$Name}},LocalIP,RemoteIP
} # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –æ–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª –ë—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ –¥–ª—è IPBan
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">Get-Content -Wait "$path\logfile.txt"</code> —á–∏—Ç–∞—Ç—å –ª–æ–≥ <br />
<code class="language-plaintext highlighter-rouge">Get-Service IPBan | Stop-Service</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂–±—É <br />
<code class="language-plaintext highlighter-rouge">sc delete IPBan</code> —É–¥–∞–ª–∏—Ç—å —Å–ª—É–∂–±—É</p>

<h1 id="shutdown">shutdown</h1>

<p><code class="language-plaintext highlighter-rouge">shutdown /r /o</code> –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º <br />
<code class="language-plaintext highlighter-rouge">shutdown /s /t 600 /c "Power off after 10 minutes"</code> –≤—ã–∫–ª—é—á–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">shutdown /s /f</code> –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">shutdown /a</code> –æ—Ç–º–µ–Ω–∞ <br />
<code class="language-plaintext highlighter-rouge">shutdown /r /t 0 /m \\192.168.3.100</code> <br />
<code class="language-plaintext highlighter-rouge">Restart-Computer -ComputerName 192.168.3.100 -Protocol WSMan</code> —á–µ—Ä–µ–∑ WinRM <br />
<code class="language-plaintext highlighter-rouge">Restart-Computer ‚ÄìComputerName 192.168.3.100 ‚ÄìForce</code> —á–µ—Ä–µ–∑ WMI <br />
<code class="language-plaintext highlighter-rouge">Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\Start\HideShutDown" -Name "value" -Value 1</code> —Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –≤—ã–∫–ª—é—á–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\Start\HideRestart" -Name "value" -Value 1</code> —Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏</p>
<pre><code class="language-PowerShell">function Start-Shutdown {
    &lt;#
    .SYNOPSIS
    Module for shutdown and restart the computer at a specified time
    .DESCRIPTION
    Example:
    # Start-Shutdown -Time "18:00"
    # Start-Shutdown -Restart -Time "18:00"
    # Start-Shutdown -Cancel
    .LINK
    https://github.com/Lifailon/PS-Commands
    #&gt;
    param(
        [string]$Time,
        [switch]$Restart,
        [switch]$Cancel
    )
    if ($Time) {
        $currentDateTime = Get-Date
        $shutdownTime = Get-Date $Time
        if ($shutdownTime -lt $currentDateTime) {
            $shutdownTime = $shutdownTime.AddDays(1)
        }
        $timeUntilShutdown = $shutdownTime - $currentDateTime
        $secondsUntilShutdown = [math]::Round($timeUntilShutdown.TotalSeconds)
    }
    if ($Cancel) {
        Start-Process -FilePath "shutdown.exe" -ArgumentList "/a"
    } elseif ($Restart) {
        Write-Host "The computer will restart after $($timeUntilShutdown.Hours) hours and $($timeUntilShutdown.Minutes) minutes."
        Start-Process -FilePath "shutdown.exe" -ArgumentList "/r", "/f", "/t", "$secondsUntilShutdown"
    } else {
        Write-Host "The computer will shutdown after $($timeUntilShutdown.Hours) hours and $($timeUntilShutdown.Minutes) minutes."
        Start-Process -FilePath "shutdown.exe" -ArgumentList "/s", "/f", "/t", "$secondsUntilShutdown"
    }
}
</code></pre>
<h1 id="localaccounts">LocalAccounts</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Command -Module Microsoft.PowerShell.LocalAccounts</code> <br />
<code class="language-plaintext highlighter-rouge">Get-LocalUser</code> —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π <br />
<code class="language-plaintext highlighter-rouge">Get-LocalGroup</code> —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø <br />
<code class="language-plaintext highlighter-rouge">New-LocalUser "1C" -Password $Password -FullName "1C Domain"</code> —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">Set-LocalUser -Password $Password 1C</code> –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å <br />
<code class="language-plaintext highlighter-rouge">Add-LocalGroupMember -Group "Administrators" -Member "1C"</code> –¥–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-LocalGroupMember "Administrators"</code> —á–ª–µ–Ω—ã –≥—Ä—É–ø–ø—ã</p>
<pre><code class="language-PowerShell">@("vproxy-01","vproxy-02","vproxy-03") | %{
icm $_ {Add-LocalGroupMember -Group "Administrators" -Member "support4"}
icm $_ {Get-LocalGroupMember "Administrators"}
}
</code></pre>
<h1 id="smb">SMB</h1>

<p><code class="language-plaintext highlighter-rouge">Get-SmbServerConfiguration</code> <br />
<code class="language-plaintext highlighter-rouge">Set-SmbServerConfiguration -EnableSMB1Protocol $false -Force</code> –æ—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª SMB v1 <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsFeature | Where-Object {$_.name -eq "FS-SMB1"} | ft Name,Installstate</code> –º–æ–¥—É–ª—å ServerManager, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç SMB1 <br />
<code class="language-plaintext highlighter-rouge">Install-WindowsFeature FS-SMB1</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SMB1 <br />
<code class="language-plaintext highlighter-rouge">Uninstall-WindowsFeature ‚ÄìName FS-SMB1 ‚ÄìRemove</code> —É–¥–∞–ª–∏—Ç—å SMB1 –∫–ª–∏–µ–Ω—Ç–∞ (–ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞) <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsOptionalFeature -Online</code> –º–æ–¥—É–ª—å DISM, –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ Windows <br />
<code class="language-plaintext highlighter-rouge">Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol -Remove</code> —É–¥–∞–ª–∏—Ç—å SMB1 <br />
<code class="language-plaintext highlighter-rouge">Set-SmbServerConfiguration ‚ÄìAuditSmb1Access $true</code> –≤–∫–ª—é—á–∏—Ç—å –∞—É–¥–∏—Ç SMB1 <br />
<code class="language-plaintext highlighter-rouge">Get-SmbConnection</code> —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –≤–µ—Ä—Å–∏—è SMB (Dialect) <br />
<code class="language-plaintext highlighter-rouge">Get-SmbOpenFile | select ClientUserName,ClientComputerName,Path,SessionID</code> —Å–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-SmbShare</code> —Å–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–ø–æ–∫ <br />
<code class="language-plaintext highlighter-rouge">New-SmbShare -Name xl-share -Path E:\test</code> —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –æ–±—â—É—é —Å–µ—Ç–µ–≤—É—é –ø–∞–ø–∫—É (—Ä–∞—Å—à–∞—Ä–∏—Ç—å) <br />
<code class="language-plaintext highlighter-rouge">-EncryptData $True</code> –≤–∫–ª—é—á–∏—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ SMB <br />
<code class="language-plaintext highlighter-rouge">-Description</code> –∏–º—è –≤ —Å–µ—Ç–µ–≤–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">-ReadAccess "domain\username"</code> –¥–æ—Å—Ç—É–ø –Ω–∞ —á—Ç–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">-ChangeAccess</code> –¥–æ—Å—Ç—É–ø –Ω–∞ –∑–∞–ø–∏—Å—å <br />
<code class="language-plaintext highlighter-rouge">-FullAccess</code> –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø <br />
<code class="language-plaintext highlighter-rouge">-NoAccess ALL</code> –Ω–µ—Ç –ø—Ä–∞–≤ <br />
<code class="language-plaintext highlighter-rouge">-FolderEnumerationMode [AccessBased | Unrestricted]</code> –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫—Ä—ã—Ç—å –≤ —Å–µ—Ç–µ–≤–æ–π –ø–∞–ø–∫–µ –æ–±—ä–µ–∫—Ç—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ —Å –ø–æ–º–æ—â—å—é Access-Based Enumeration (ABE) <br />
<code class="language-plaintext highlighter-rouge">Get-SmbShare xl-share | Set-SmbShare -FolderEnumerationMode AccessBased</code> –∫–ª—é—á–∏—Ç—å ABE –¥–ª—è –≤—Å–µ—Ö —Ä–∞—Å—à–∞—Ä–µ–Ω–Ω—ã—Ö –ø–∞–ø–æ–∫ <br />
<code class="language-plaintext highlighter-rouge">Remove-SmbShare xl-share -force</code> —É–¥–∞–ª–∏—Ç—å —Å–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø (—à–∞—Ä—É) <br />
<code class="language-plaintext highlighter-rouge">Get-SmbShareAccess xl-share</code> –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫ —à–∞—Ä–µ <br />
<code class="language-plaintext highlighter-rouge">Revoke-SmbShareAccess xl-share -AccountName Everyone ‚ÄìForce</code> —É–¥–∞–ª–∏—Ç—å –≥—Ä—É–ø–ø—É –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Grant-SmbShareAccess -Name xl-share -AccountName "domain\XL-Share" -AccessRight Change ‚Äìforce</code> –∏–∑–º–µ–Ω–∏—Ç—å/–¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –∑–∞–ø–∏—Å—å (Full,Read) <br />
<code class="language-plaintext highlighter-rouge">Grant-SmbShareAccess -Name xl-share -AccountName "–≤—Å–µ" -AccessRight Change ‚Äìforce</code> <br />
<code class="language-plaintext highlighter-rouge">Block-SmbShareAccess -Name xl-share -AccountName "domain\noAccess" -Force</code> –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–µ—Ç <br />
<code class="language-plaintext highlighter-rouge">New-SmbMapping -LocalPath X: -RemotePath \\$srv\xl-share -UserName support4 -Password password ‚ÄìPersistent $true</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å —Å–µ—Ç–µ–≤–æ–π –¥–∏—Å–∫ <br />
<code class="language-plaintext highlighter-rouge">-Persistent</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∏–ª–∏ —Å–µ—Ç–∏ <br />
<code class="language-plaintext highlighter-rouge">-SaveCredential</code> –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –¥–∏—Å–ø–µ—Ç—á–µ—Ä —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö Windows Credential Manager <br />
<code class="language-plaintext highlighter-rouge">Stop-Process -Name "explorer" | Start-Process -FilePath "C:\Windows\explorer.exe"</code> –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–µ <br />
<code class="language-plaintext highlighter-rouge">Get-SmbMapping</code> —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –¥–∏—Å–∫–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Remove-SmbMapping X: -force</code> –æ—Ç–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤–æ–π –¥–∏—Å–∫ <br />
<code class="language-plaintext highlighter-rouge">$CIMSession = New-CIMSession ‚ÄìComputername $srv</code> —Å–æ–∑–¥–∞—Ç—å —Å–µ–∞–Ω—Å CIM (–∞—É–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ SMB) <br />
<code class="language-plaintext highlighter-rouge">Get-SmbOpenFile -CIMSession $CIMSession | select ClientUserName,ClientComputerName,Path | Out-GridView -PassThru | Close-SmbOpenFile -CIMSession $CIMSession -Confirm:$false ‚ÄìForce</code> –∑–∞–∫—Ä—ã—Ç—å —Ñ–∞–π–ª—ã (–æ—Ç–∫—Ä—ã—Ç—å –∫ –Ω–∏–º —Å–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø)</p>

<h3 id="get-acl">Get-Acl</h3>
<p><code class="language-plaintext highlighter-rouge">(Get-Acl \\$srv\xl-share).access</code> –¥–æ—Å—Ç—É–ø ACL –Ω–∞ —É—Ä–æ–≤–Ω–µ NTFS <br />
<code class="language-plaintext highlighter-rouge">Get-Acl C:\Drivers | Set-Acl C:\Distr</code> —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å NTFS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å –æ–¥–Ω–æ–π –ø–∞–ø–∫–∏ –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Ö –Ω–∞ –¥—Ä—É–≥—É—é</p>

<h3 id="ntfssecurity">NTFSSecurity</h3>
<p><code class="language-plaintext highlighter-rouge">Install-Module -Name NTFSSecurity -force</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Item "\\$srv\xl-share" | Get-NTFSAccess</code> <br />
<code class="language-plaintext highlighter-rouge">Add-NTFSAccess -Path "\\$srv\xl-share" -Account "domain\xl-share" -AccessRights Fullcontrol -PassThru</code> –¥–æ–±–∞–≤–∏—Ç—å <br />
<code class="language-plaintext highlighter-rouge">Remove-NTFSAccess -Path "\\$srv\xl-share" -Account "domain\xl-share" -AccessRights FullControl -PassThru</code> —É–¥–∞–ª–∏—Ç—å <br />
<code class="language-plaintext highlighter-rouge">Get-ChildItem -Path "\\$srv\xl-share" -Recurse -Force | Clear-NTFSAccess</code> —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è, –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">Get-ChildItem -Path "\\$srv\xl-share" -Recurse -Force | Enable-NTFSAccessInheritance</code> –≤–∫–ª—é—á–∏—Ç—å NTFS –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</p>

<h3 id="storage">Storage</h3>
<p><code class="language-plaintext highlighter-rouge">Get-Command -Module Storage</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Disk</code> —Å–ø–∏—Å–æ–∫ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –¥–∏—Å–∫–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-Partition</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ä–∞–∑–¥–µ–ª—ã –Ω–∞ –≤—Å–µ—Ö –¥–∏—Å–∫–∞—Ö <br />
<code class="language-plaintext highlighter-rouge">Get-Volume</code> —Å–ø–∏—Å–æ–∫ –ª–æ–≥–∏—á–∫–∏—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-PhysicalDisk</code> —Å–ø–∏—Å–æ–∫ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –¥–∏—Å–∫–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Initialize-Disk 1 ‚ÄìPartitionStyle MBR</code> –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏—Å–∫ <br />
<code class="language-plaintext highlighter-rouge">New-Partition -DriveLetter D ‚ÄìDiskNumber 1 -Size 500gb</code> —Å–æ–∑–¥–∞—Ç—å —Ä–∞–∑–¥–µ–ª (–≤—ã–¥–µ–ª–∏—Ç—å –≤—Å–µ –º–µ—Å—Ç–æ -UseMaximumSize) <br />
<code class="language-plaintext highlighter-rouge">Format-Volume -DriveLetter D -FileSystem NTFS -NewFileSystemLabel Disk-D</code> —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–¥–µ–ª <br />
<code class="language-plaintext highlighter-rouge">Set-Partition -DriveLetter D -IsActive $True</code> —Å–¥–µ–ª–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–º <br />
<code class="language-plaintext highlighter-rouge">Remove-Partition -DriveLetter D ‚ÄìDiskNumber 1</code> —É–¥–∞–ª–∏—Ç—å —Ä–∞–∑–¥–µ–ª <br />
<code class="language-plaintext highlighter-rouge">Clear-Disk -Number 1 -RemoveData</code> –æ—á–∏—Å—Ç–∏—Ç—å –¥–∏—Å–∫ <br />
<code class="language-plaintext highlighter-rouge">Repair-Volume ‚Äìdriveletter C ‚ÄìScan</code> Check disk <br />
<code class="language-plaintext highlighter-rouge">Repair-Volume ‚Äìdriveletter C ‚ÄìSpotFix</code> <br />
<code class="language-plaintext highlighter-rouge">Repair-Volume ‚Äìdriverletter C -Scan ‚ÄìCimsession $CIMSession</code></p>

<h3 id="iscsi">iSCSI</h3>
<p><code class="language-plaintext highlighter-rouge">New-IscsiVirtualDisk -Path D:\iSCSIVirtualDisks\iSCSI2.vhdx -Size 20GB</code> —Å–æ–∑–¥–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π vhdx-–¥–∏—Å–∫ (–¥–ª—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ -UseFixed) <br />
<code class="language-plaintext highlighter-rouge">New-IscsiServerTarget -TargetName iscsi-target-2 -InitiatorIds "IQN:iqn.1991-05.com.microsoft:srv3.contoso.com"</code> —Å–æ–∑–¥–∞—Ç—å Target <br />
<code class="language-plaintext highlighter-rouge">Get-IscsiServerTarget | fl TargetName, LunMappings</code> <br />
<code class="language-plaintext highlighter-rouge">Connect-IscsiTarget -NodeAddress "iqn.1995-05.com.microsoft:srv2-iscsi-target-2-target" -IsPersistent $true</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–æ–º –∫ —Ç–∞—Ä–≥–µ—Ç—É <br />
<code class="language-plaintext highlighter-rouge">Get-IscsiTarget | fl</code> <br />
<code class="language-plaintext highlighter-rouge">Disconnect-IscsiTarget -NodeAddress "iqn.1995-05.com.microsoft:srv2-iscsi-target-2-target" -Confirm:$false</code> –æ—Ç–∫–ª—é—á–∏—Ç—å—Å—è</p>

<h1 id="activedirectory">ActiveDirectory</h1>

<h3 id="rsat-remote-server-administration-tools">RSAT (Remote Server Administration Tools)</h3>
<p><code class="language-plaintext highlighter-rouge">DISM.exe /Online /add-capability /CapabilityName:Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0 /CapabilityName:Rsat.GroupPolicy.Management.Tools~~~~0.0.1.0</code> <br />
<code class="language-plaintext highlighter-rouge">Add-WindowsCapability ‚Äìonline ‚ÄìName Rsat.Dns.Tools~~~~0.0.1.0</code> <br />
<code class="language-plaintext highlighter-rouge">Add-WindowsCapability -Online -Name Rsat.DHCP.Tools~~~~0.0.1.0</code> <br />
<code class="language-plaintext highlighter-rouge">Add-WindowsCapability ‚Äìonline ‚ÄìName Rsat.FileServices.Tools~~~~0.0.1.0</code> <br />
<code class="language-plaintext highlighter-rouge">Add-WindowsCapability -Online -Name Rsat.WSUS.Tools~~~~0.0.1.0</code> <br />
<code class="language-plaintext highlighter-rouge">Add-WindowsCapability -Online -Name Rsat.CertificateServices.Tools~~~~0.0.1.0</code> <br />
<code class="language-plaintext highlighter-rouge">Add-WindowsCapability -Online -Name Rsat.RemoteDesktop.Services.Tools~~~~0.0.1.0</code> <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsCapability -Name RSAT* -Online | Select-Object -Property DisplayName, State</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–µ–Ω—Ç–æ–≤</p>

<h3 id="import-module-activedirectory">Import-Module ActiveDirectory</h3>
<p><code class="language-plaintext highlighter-rouge">$Session = New-PSSession -ComputerName $srv</code> -Credential $cred<code class="language-plaintext highlighter-rouge"> \
</code>Export-PSsession -Session $Session -Module ActiveDirectory -OutputModule ActiveDirectory<code class="language-plaintext highlighter-rouge"> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å –∏–∑ —É–¥–∞–ª–µ–Ω–Ω–æ–π —Å–µ—Å—Å–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å DC) \
</code>Remove-PSSession -Session $Session<code class="language-plaintext highlighter-rouge"> \
</code>Import-Module ActiveDirectory<code class="language-plaintext highlighter-rouge"> \
</code>Get-Command -Module ActiveDirectory`</p>

<h3 id="adsi-active-directory-service-interface">ADSI (Active Directory Service Interface)</h3>
<p><code class="language-plaintext highlighter-rouge">$d0 = $env:userdnsdomain</code> <br />
<code class="language-plaintext highlighter-rouge">$d0 = $d0 -split "\."</code> <br />
<code class="language-plaintext highlighter-rouge">$d1 = $d0[0]</code> <br />
<code class="language-plaintext highlighter-rouge">$d2 = $d0[1]</code> <br />
<code class="language-plaintext highlighter-rouge">$group = [ADSI]"LDAP://OU=Domain Controllers,DC=$d1,DC=$d2"</code> <br />
<code class="language-plaintext highlighter-rouge">$group | select *</code></p>

<p><code class="language-plaintext highlighter-rouge">$Local_User = [ADSI]"WinNT://./–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä,user"</code> <br />
<code class="language-plaintext highlighter-rouge">$Local_User | Get-Member</code> <br />
<code class="language-plaintext highlighter-rouge">$Local_User.Description</code> <br />
<code class="language-plaintext highlighter-rouge">$Local_User.LastLogin</code> –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>

<h3 id="ldap-lightweight-directory-access-protocol">LDAP (Lightweight Directory Access Protocol)</h3>
<p><code class="language-plaintext highlighter-rouge">$ldapsearcher = New-Object System.DirectoryServices.DirectorySearcher</code> <br />
<code class="language-plaintext highlighter-rouge">$ldapsearcher.SearchRoot = "LDAP://OU=Domain Controllers,DC=$d1,DC=$d2"</code> <br />
<code class="language-plaintext highlighter-rouge">$ldapsearcher.Filter = "(objectclass=computer)"</code> <br />
<code class="language-plaintext highlighter-rouge">$dc = $ldapsearcher.FindAll().path</code></p>

<p><code class="language-plaintext highlighter-rouge">$usr = $env:username</code> c–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">$ldapsearcher = New-Object System.DirectoryServices.DirectorySearcher</code> <br />
<code class="language-plaintext highlighter-rouge">$ldapsearcher.Filter = "(&amp;(objectCategory=User)(samAccountName=$usr))"</code> <br />
<code class="language-plaintext highlighter-rouge">$usrfind = $ldapsearcher.FindOne()</code> <br />
<code class="language-plaintext highlighter-rouge">$groups = $usrfind.properties.memberof -replace "(,OU=.+)"</code> <br />
<code class="language-plaintext highlighter-rouge">$groups = $groups -replace "(CN=)"</code></p>

<p>DC (Domain Component) - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–æ–º–µ–Ω–Ω–æ–≥–æ –∏–º–µ–Ω–∏ <br />
OU (Organizational Unit) - –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è (type), –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ <br />
Container - —Ç–∞–∫ –∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ –æ—Ç–ª–∏—á–∏–∏ –æ—Ç –ø–æ–¥—Ä–∞–¥–µ–ª–µ–Ω–∏–π –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã, —É–¥–∞–ª–µ–Ω—ã, —Å–æ–∑–¥–∞–Ω—ã –∏–ª–∏ —Å–≤—è–∑–∞–Ω—ã —Å –æ–±—ä–µ–∫—Ç–æ–º –≥—Ä—É–ø–ø–æ–≤–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏ (Computers, Domain Controllers, Users) <br />
DN (Distinguished Name) ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è –æ–±—ä–µ–∫—Ç–∞ –∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –ª–µ—Å—É AD. –í DN –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –≤ –¥–µ—Ä–µ–≤–µ (–ø—É—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏), —Ç—Ä–µ–±—É–µ–º–æ–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –∏–ª–∏ –µ–µ –ø–æ–∏—Å–∫–∞ <br />
CN (Common Name) - –æ–±—â–µ–µ –∏–º—è</p>

<p><code class="language-plaintext highlighter-rouge">(Get-ADObject (Get-ADRootDSE).DefaultNamingContext -Properties wellKnownObjects).wellKnownObjects</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é <br />
<code class="language-plaintext highlighter-rouge">redircmp OU=Client Computers,DC=root,DC=domain,DC=local</code> –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é <br />
<code class="language-plaintext highlighter-rouge">redirusr</code> –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</p>

<h3 id="laps-local-admin-password-management">LAPS (Local Admin Password Management)</h3>
<p><code class="language-plaintext highlighter-rouge">Import-module AdmPwd.ps</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å <br />
<code class="language-plaintext highlighter-rouge">Get-AdmPwdPassword -ComputerName NAME</code> –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–∞—Ä–æ–ª—å <br />
<code class="language-plaintext highlighter-rouge">Reset-AdmPwdPassword -ComputerName NAME</code> –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å <br />
<code class="language-plaintext highlighter-rouge">Get-ADComputer -Filter * -SearchBase "DC=$d1,DC=$d2" | Get-AdmPwdPassword -ComputerName {$_.Name} | select ComputerName,Password,ExpirationTimestamp | Out-GridView</code> <br />
<code class="language-plaintext highlighter-rouge">Get-ADComputer -Identity $srv | Get-AdmPwdPassword -ComputerName {$_.Name} | select ComputerName,Password,ExpirationTimestamp</code></p>

<h3 id="recycle-bin">Recycle Bin</h3>
<p>–£–¥–∞–ª–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∫–æ—Ä–∑–∏–Ω–µ AD –≤ —Ç–µ—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞—Ö–æ—Ä–æ–Ω–µ–Ω–∏—è (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ –∞—Ç—Ä–∏–±—É—Ç–µ –¥–æ–º–µ–Ω–∞ msDS-deletedObjectLifetime), –∑–∞–¥–∞–Ω–Ω–æ–º –¥–ª—è –ª–µ—Å–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ 180 –¥–Ω–µ–π. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–π —Å—Ä–æ–∫ –ø—Ä–æ—à–µ–ª, –æ–±—ä–µ–∫—Ç –≤—Å–µ –µ—â–µ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ Deleted Objects, –Ω–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –µ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ —Å–≤—è–∑–µ–π –æ—á–∏—â–∞—é—Ç—Å—è (Recycled Object). –ü–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è –ø–µ—Ä–∏–æ–¥–∞ tombstoneLifetime (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–∞–∫–∂–µ 180 –¥–Ω–µ–π, –Ω–æ –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å) –æ–±—ä–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ AD –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º –æ—á–∏—Å—Ç–∫–∏. <br />
<code class="language-plaintext highlighter-rouge">Get-ADForest domain.local</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —Ä–∞–±–æ—Ç—ã –ª–µ—Å–∞ <br />
<code class="language-plaintext highlighter-rouge">Set-ADForestMode -Identity domain.local -ForestMode Windows2008R2Forest -force</code> —É–≤–µ–ª–∏—á–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —Ä–∞–±–æ—Ç—ã –ª–µ—Å–∞ <br />
<code class="language-plaintext highlighter-rouge">Enable-ADOptionalFeature ‚ÄìIdentity "CN=Recycle Bin Feature,CN=Optional Features,CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration,DC=domain,DC=local" ‚ÄìScope ForestOrConfigurationSet ‚ÄìTarget "domain.local"</code> –≤–∫–ª—é—á–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É <br />
<code class="language-plaintext highlighter-rouge">Get-ADOptionalFeature "Recycle Bin Feature" | select-object name,EnabledScopes</code> –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ EnabledScopes –Ω–µ –ø—É—Å—Ç–æ–µ, –∑–Ω–∞—á–∏—Ç –≤ –¥–æ–º–µ–Ω–µ –∫–æ—Ä–∑–∏–Ω–∞ Active Directory –≤–∫–ª—é—á–µ–Ω–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-ADObject -Filter 'Name -like "*tnas*"' -IncludeDeletedObjects</code> –Ω–∞–π—Ç–∏ —É–¥–∞–ª–µ–Ω–Ω—É—é (Deleted: True) –£–ó (ObjectClass: user) –≤ AD <br />
<code class="language-plaintext highlighter-rouge">Get-ADObject -Filter 'Name -like "*tnas*"' ‚ÄìIncludeDeletedObjects -Properties *| select-object Name, sAMAccountName, LastKnownParent, memberOf, IsDeleted | fl</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ IsDeleted, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥–∏–ª—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º (LastKnownParent) –∏ —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω —Å–æ—Å—Ç–æ—è–ª <br />
<code class="language-plaintext highlighter-rouge">Get-ADObject ‚Äìfilter {Deleted -eq $True -and ObjectClass -eq "user"} ‚ÄìincludeDeletedObjects</code> –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π <br />
<code class="language-plaintext highlighter-rouge">Restore-ADObject -Identity "3dc33c7c-b912-4a19-b1b7-415c1395a34e"</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é –∞—Ç—Ä–∏–±—É—Ç–∞ ObjectGUID <br />
<code class="language-plaintext highlighter-rouge">Get-ADObject -Filter 'SAMAccountName -eq "tnas-01"' ‚ÄìIncludeDeletedObjects | Restore-ADObject</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ SAMAccountName <br />
<code class="language-plaintext highlighter-rouge">Get-ADObject -Filter {Deleted -eq $True -and ObjectClass -eq 'group' -and Name -like '*Allow*'} ‚ÄìIncludeDeletedObjects | Restore-ADObject ‚ÄìVerbose</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥—Ä—É–ø–ø—É –∏–ª–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä</p>

<h3 id="thumbnailphoto">thumbnailPhoto</h3>
<p><code class="language-plaintext highlighter-rouge">$photo = [byte[]](Get-Content C:\Install\adm.jpg -Encoding byte)</code> –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ –º–∞—Å—Å–∏–≤ –±–∞–π—Ç–æ–≤ (jpeg/bmp —Ñ–∞–π–ª, —Ä–∞–∑–º–µ—Ä–æ–º —Ñ–æ—Ç–æ –¥–æ 100 –ö–± –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º 96?96) <br />
<code class="language-plaintext highlighter-rouge">Set-ADUser support4 -Replace @{thumbnailPhoto=$photo}</code> –∑–∞–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ thumbnailPhoto</p>

<h3 id="addomaincontroller">ADDomainController</h3>
<p><code class="language-plaintext highlighter-rouge">Get-ADDomainController</code> –≤—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞ (LogonServer), –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∞–Ω–Ω—ã–º –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (DC –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–æ–ø–æ–ª–æ–≥–∏–µ–π —Å–∞–π—Ç–æ–≤ AD) <br />
<code class="language-plaintext highlighter-rouge">Get-ADDomainController -Discover -Service PrimaryDC</code> –Ω–∞–π—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å —Ä–æ–ª—å—é PDC –≤ –¥–æ–º–µ–Ω–µ <br />
<code class="language-plaintext highlighter-rouge">Get-ADDomainController -Filter * | ft HostName,IPv4Address,Name,Site,OperatingSystem,IsGlobalCatalog</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ DC, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫ —Å–∞–π—Ç—É, –≤–µ—Ä—Å–∏–∏ –û–° –∏ GC</p>

<p>–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –û–° —Å–ª—É–∂–±–∞ NetLogon –¥–µ–ª–∞–µ—Ç DNS –∑–∞–ø—Ä–æ—Å —Å–æ —Å–ø–∏—Å–∫–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –¥–æ–º–µ–Ω–∞ (–∫ SRV –∑–∞–ø–∏—Å–∏ <em>ldap._tcp.dc._msdcs.domain</em>), DNS –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ DC –≤ –¥–æ–º–µ–Ω–µ —Å –∑–∞–ø–∏—Å—å—é Service Location (SRV). –ö–ª–∏–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç LDAP –∑–∞–ø—Ä–æ—Å –∫ DC –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–∞–π—Ç–∞ AD –ø–æ —Å–≤–æ–µ–º—É IP –∞–¥—Ä–µ—Å—É. –ö–ª–∏–µ–Ω—Ç —á–µ—Ä–µ–∑ DNS –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –¥–æ–º–µ–Ω–∞ –≤ —Å–∞–π—Ç–µ (–≤ —Ä–∞–∑–¥–µ–ª–µ _tcp.sitename._sites‚Ä¶).</p>

<p>USN (Update Sequence Numbers) - —Å—á–µ—Ç—á–∏–∫ –Ω–æ–º–µ—Ä–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —É –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ AD. –ü—Ä–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ USN, –æ–±—ä–µ–∫—Ç —Å –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–º USN –±—É–¥–µ—Ç –ø—Ä–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω –æ–±—ä–µ–∫—Ç–æ–º —Å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º USN. –ù–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–≤–æ–π—Å—Ç–≤–∞—Ö - Object (–≤–∫–ª—é—á–∏—Ç—å View - Advanced Features). –ö–∞–∂–¥—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫ USN, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—á–∏–Ω–∞–µ—Ç –æ—Ç—Å—á–µ—Ç –≤ –º–æ–º–µ–Ω—Ç –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ Dcpromo –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ç–µ—á–µ–Ω–∏–µ –≤—Å–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞. –ó–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ USN —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è, —ç—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞.</p>

<p><code class="language-plaintext highlighter-rouge">Get-ADDomainController -Filter * | % {</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å USN –æ–±—ä–µ–∫—Ç–∞ –Ω–∞ –≤—Å–µ—Ö DC –≤ –¥–æ–º–µ–Ω–µ<code class="language-plaintext highlighter-rouge"> \
</code>Get-ADUser -Server $_.HostName -Identity support4 -Properties uSNChanged | select SamAccountName,uSNChanged<code class="language-plaintext highlighter-rouge"> \
</code>}`</p>

<p><code class="language-plaintext highlighter-rouge">dcpromo /forceremoval</code> –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç –ø–æ–Ω–∏–∂–µ–Ω–∏–µ –≤ —Ä–æ–ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞ –¥–æ —É—Ä–æ–≤–Ω—è —Ä—è–¥–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞. –ü–æ—Å–ª–µ –ø–æ–Ω–∏–∂–µ–Ω–∏—è —Ä–æ–ª–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫ –≤ –¥–æ–º–µ–Ω–µ –Ω–∞ —ç—Ç–æ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä. –î–∞–ª–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –≤–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Å–æ—Å—Ç–∞–≤ –¥–æ–º–µ–Ω–∞, –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, —Ç.–µ. –ø–æ–≤—ã—à–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ —É—Ä–æ–≤–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞.</p>

<h3 id="adcomputer">ADComputer</h3>
<p><code class="language-plaintext highlighter-rouge">nltest /DSGETDC:$env:userdnsdomain</code> —É–∑–Ω–∞—Ç—å –Ω–∞ –∫–∞–∫–æ–º DC –∞—É–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω —Ö–æ—Å—Ç (Logon Server) <br />
<code class="language-plaintext highlighter-rouge">nltest /SC_RESET:$env:userdnsdomain\srv-dc2.$env:userdnsdomain</code> –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä –Ω–∞ –¥—Ä—É–≥–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞ AD –≤—Ä—É—á–Ω—É—é (The command completed successfully) <br />
<code class="language-plaintext highlighter-rouge">Get-ADComputer ‚ÄìIdentity $env:computername -Properties PasswordLastSet</code> –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ <br />
<code class="language-plaintext highlighter-rouge">Test-ComputerSecureChannel ‚Äìverbose</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –¥–æ–º–µ–Ω–æ–º (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –ø–∞—Ä–æ–ª—é, —Ö—Ä–∞–Ω—è—â–µ–º—É—Å—è –≤ AD) <br />
<code class="language-plaintext highlighter-rouge">Reset-ComputerMachinePassword -Credential domain\admin</code> –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å <br />
<code class="language-plaintext highlighter-rouge">Netdom ResetPWD /Server:dc-01 /UserD:domain\admin /PasswordD:*</code> —Å–±—Ä–æ—Å–∏—Ç—å —Ö—ç—à –ø–∞—Ä–æ–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ –¥–æ–º–µ–Ω–µ (–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è) <br />
<code class="language-plaintext highlighter-rouge">Search-ADAccount -AccountDisabled -ComputersOnly | select Name,LastLogonDate,Enabled</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã</p>

<p><code class="language-plaintext highlighter-rouge">Get-ADComputer -Filter * -Properties * | select name</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ –≤ –¥–æ–º–µ–Ω–µ (Filter), –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞ (Properties) <br />
<code class="language-plaintext highlighter-rouge">Get-ADComputer -Identity $srv -Properties * | ft Name,LastLogonDate,PasswordLastSet,ms-Mcs-AdmPwd -Autosize</code> –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ AD (Identity) <br />
<code class="language-plaintext highlighter-rouge">Get-ADComputer -SearchBase "OU=Domain Controllers,DC=$d1,DC=$d2" -Filter * -Properties * | ft Name, LastLogonDate, distinguishedName -Autosize</code> –ø–æ–∏—Å–∫ –≤ –±–∞–∑–µ –ø–æ DN (SearchBase)</p>

<p><code class="language-plaintext highlighter-rouge">(Get-ADComputer -Filter {enabled -eq "true"}).count</code> –ø–æ–ª—É—á–∏—Ç—å –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö (–Ω–µ–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö) –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">(Get-ADComputer -Filter {enabled -eq "true" -and OperatingSystem -like "*Windows Server 2016*"}).count</code> –∫–æ–ª-–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–ø—å—é—Ç–µ—Ä–æ–≤ —Å –û–° WS 2016</p>

<p><code class="language-plaintext highlighter-rouge">Get-ADComputer -Filter * -Properties * | select @{Label="Ping Status"; Expression={</code> <br />
<code class="language-plaintext highlighter-rouge">$ping = ping -n 1 -w 50 $_.Name</code> <br />
<code class="language-plaintext highlighter-rouge">if ($ping -match "TTL") {"Online"} else {"Offline"}</code> <br />
<code class="language-plaintext highlighter-rouge">}},</code> <br />
<code class="language-plaintext highlighter-rouge">@{Label="Status"; Expression={</code> <br />
<code class="language-plaintext highlighter-rouge">if ($_.Enabled -eq "True") {$_.Enabled -replace "True","Active"} else {$_.Enabled -replace "False","Blocked"}</code> <br />
<code class="language-plaintext highlighter-rouge">}}, Name, IPv4Address, OperatingSystem, @{Label="UserOwner"; Expression={$_.ManagedBy -replace "(CN=|,.+)"}</code> <br />
<code class="language-plaintext highlighter-rouge">},Created | Out-GridView</code></p>

<h3 id="aduser">ADUser</h3>
<p><code class="language-plaintext highlighter-rouge">Get-ADUser -Identity support4 -Properties *</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-ADUser -Identity support4 -Properties DistinguishedName, EmailAddress, Description</code> –ø—É—Ç—å DN, email –∏ –æ–ø–∏—Å–∞–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">Get-ADUser -Filter {(Enabled -eq "True") -and (mail -ne "null")} -Properties mail | ft Name,mail</code> —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –µ—Å—Ç—å –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ <br />
<code class="language-plaintext highlighter-rouge">Get-ADUser -Filter {SamAccountName -like "*"} | Measure-Object</code> –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª-–≤–æ –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (Count) <br />
<code class="language-plaintext highlighter-rouge">Get-ADUser -Filter * -Properties WhenCreated | sort WhenCreated | ft Name, whenCreated</code> –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Get-ADUser -Identity support4 -property LockedOut | select samaccountName,Name,Enabled,Lockedout</code> <br />
<code class="language-plaintext highlighter-rouge">Enabled=True</code> —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –≤–∫–ª—é—á–µ–Ω–∞ - –¥–∞ <br />
<code class="language-plaintext highlighter-rouge">Lockedout=False</code> —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª–∏—Ç–∏–∫–æ–π –ø–∞—Ä–æ–ª–µ–π) - –Ω–µ—Ç <br />
<code class="language-plaintext highlighter-rouge">Get-ADUser -Identity support4 | Unlock-ADAccount</code> —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å <br />
<code class="language-plaintext highlighter-rouge">Disable-ADAccount -Identity support4</code> –æ—Ç–∫–ª—é—á–∏—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å <br />
<code class="language-plaintext highlighter-rouge">Enable-ADAccount -Identity support4</code> –≤–∫–ª—é—á–∏—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å <br />
<code class="language-plaintext highlighter-rouge">Search-ADAccount -LockedOut</code> –Ω–∞–π—Ç–∏ –≤—Å–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ <br />
<code class="language-plaintext highlighter-rouge">Search-ADAccount -AccountDisabled | select Name,LastLogonDate,Enabled</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Å –≤—Ä–µ–º–µ–Ω–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞</p>

<p><code class="language-plaintext highlighter-rouge">Get-ADUser -Identity support4 -Properties PasswordLastSet,PasswordExpired,PasswordNeverExpires</code> <br />
<code class="language-plaintext highlighter-rouge">PasswordLastSet</code> –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è <br />
<code class="language-plaintext highlighter-rouge">PasswordExpired=False</code> –ø–∞—Ä–æ–ª—å –∏—Å—Ç–µ–∫ - –Ω–µ—Ç <br />
<code class="language-plaintext highlighter-rouge">PasswordNeverExpires=True</code> —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª—è –Ω–µ –∏—Å—Ç–µ–∫–∞–µ—Ç - –¥–∞ <br />
<code class="language-plaintext highlighter-rouge">Set-ADAccountPassword support4 -Reset -NewPassword (ConvertTo-SecureString -AsPlainText "password" -Force -Verbose)</code> –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ <br />
<code class="language-plaintext highlighter-rouge">Set-ADUser -Identity support4 -ChangePasswordAtLogon $True</code> —Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –≤—Ö–æ–¥–µ –≤ —Å–∏—Å—Ç–µ–º—É</p>

<p><code class="language-plaintext highlighter-rouge">$day = (Get-Date).adddays(-90)</code> <br />
<code class="language-plaintext highlighter-rouge">Get-ADUser -filter {(passwordlastset -le $day)} | ft</code> –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–µ–Ω—è–ª–∏ —Å–≤–æ–π –ø–∞—Ä–æ–ª—å –±–æ–ª—å—à–µ 90 –¥–Ω–µ–π</p>

<p><code class="language-plaintext highlighter-rouge">$day = (Get-Date).adddays(-30)</code> <br />
<code class="language-plaintext highlighter-rouge">Get-ADUser -filter {(Created -ge $day)} -Property Created | select Name,Created</code> –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞ 30 –¥–Ω–µ–π</p>

<p><code class="language-plaintext highlighter-rouge">$day = (Get-Date).adddays(-360)</code> <br />
<code class="language-plaintext highlighter-rouge">Get-ADUser -Filter {(LastLogonTimestamp -le $day)} -Property LastLogonTimestamp | select Name,SamAccountName,@{n='LastLogonTimestamp';e={[DateTime]::FromFileTime($_.LastLogonTimestamp)}} | sort -Descending LastLogonTimestamp</code> –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ª–æ–≥–∏–Ω–∏–ª–∏—Å—å –±–æ–ª—å—à–µ 360 –¥–Ω–µ–π. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞ LastLogonTimestamp —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç 9 –¥–æ 14 –¥–Ω–µ–π. <br />
<code class="language-plaintext highlighter-rouge">| Disable-ADAccount $_.SamAccountName</code> –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å <br />
<code class="language-plaintext highlighter-rouge">-WhatIf</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—ã–≤–æ–¥ –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π</p>

<h3 id="adgroupmember">ADGroupMember</h3>
<p><code class="language-plaintext highlighter-rouge">(Get-ADUser -Identity support4 -Properties MemberOf).memberof</code> —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ—Å—Ç–æ–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å <br />
<code class="language-plaintext highlighter-rouge">Get-ADGroupMember -Identity "Domain Admins" | Select Name,SamAccountName</code> —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–µ <br />
<code class="language-plaintext highlighter-rouge">Add-ADGroupMember -Identity "Domain Admins" -Members support5</code> –¥–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É <br />
<code class="language-plaintext highlighter-rouge">Remove-ADGroupMember -Identity "Domain Admins" -Members support5 -force</code> —É–¥–∞–ª–∏—Ç—å –∏–∑ –≥—Ä—É–ø–ø—ã <br />
<code class="language-plaintext highlighter-rouge">Get-ADGroup -filter * | where {!($_ | Get-ADGroupMember)} | Select Name</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç—ã—Ö –≥—Ä—É–ø–ø (-Not)</p>

<h3 id="adreplication">ADReplication</h3>
<p><code class="language-plaintext highlighter-rouge">Get-Command -Module ActiveDirectory -Name *Replication*</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥–ª–µ—Ç–æ–≤ –º–æ–¥—É–ª—è <br />
<code class="language-plaintext highlighter-rouge">Get-ADReplicationFailure -Target dc-01</code> —Å–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-ADReplicationFailure -Target $env:userdnsdomain -Scope Domain</code> <br />
<code class="language-plaintext highlighter-rouge">Get-ADReplicationPartnerMetadata -Target dc-01 | select Partner,LastReplicationAttempt,LastReplicationSuccess,LastReplicationResult,LastChangeUsn</code> –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏ –≤—Ä–µ–º—è —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-ADReplicationUpToDatenessVectorTable -Target dc-01</code> Update Sequence Number (USN) —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è (–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞), –ø—Ä–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DC –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ USN, –æ–±—ä–µ–∫—Ç —Å –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–º USN –ø—Ä–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω –≤—ã—Å–æ–∫–∏–º USN.</p>

<h1 id="repadmin">repadmin</h1>

<p><code class="language-plaintext highlighter-rouge">repadmin /replsummary</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ –≤—Å–µ—Ö DC –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é (Source –∏ Destination) –∏ –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å —É—á–µ—Ç–æ–º –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">repadmin /showrepl $srv</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Å–µ—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –ø–æ —Ä–µ–ø–ª–∫–∞—Ü–∏–∏ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ Naming Contexts (DC=ForestDnsZones, DC=DomainDnsZones, CN=Schema, CN=Configuration) <br />
<code class="language-plaintext highlighter-rouge">repadmin /replicate $srv2 $srv1 DC=domain,DC=local </code> –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é —Å $srv1 –Ω–∞ $srv2 —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∞ –¥–æ–º–µ–Ω–∞ <br />
<code class="language-plaintext highlighter-rouge">repadmin /SyncAll /AdeP</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–µ–∂—Å–∞–π—Ç–æ–≤—É—é –∏—Å—Ö–æ–¥—è—â—É—é —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Å–æ –≤—Å–µ–º–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏ –ø–æ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">/A</code> –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ NC <br />
<code class="language-plaintext highlighter-rouge">/d</code> –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä—ã –ø–æ DN (–≤–º–µ—Å—Ç–æ GUID DNS - –≥–ª–æ–±–∞–ª—å–Ω—ã–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º) <br />
<code class="language-plaintext highlighter-rouge">/e</code> –º–µ–∂—Å–∞–π—Ç–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ —Å DC —Ç–µ–∫—É—â–µ–≥–æ —Å–∞–π—Ç–∞) <br />
<code class="language-plaintext highlighter-rouge">/P</code> –∏–∑–≤–µ—â–∞—Ç—å –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö —Å —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –æ–ø—Ä–∞—à–∏–≤–∞—Ç—å –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö) <br />
<code class="language-plaintext highlighter-rouge">repadmin /Queue $srv</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–æ–ª-–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤—Ö–æ–¥—è—â–µ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ (–æ—á–µ—Ä–µ–¥—å), –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å (–ø—Ä–∏—á–∏–Ω–æ–π –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–æ–µ –∫–æ–ª-–≤–æ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –∏–ª–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ 1000 –æ–±—ä–µ–∫—Ç–æ–≤ —Å–∫—Ä–∏–ø—Ç–æ–º) <br />
<code class="language-plaintext highlighter-rouge">repadmin /showbackup *</code> —É–∑–Ω–∞—Ç—å –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ Backup</p>

<p><code class="language-plaintext highlighter-rouge">Error: 1722</code> —Å–µ—Ä–≤–µ—Ä rpc –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–æ—à–∏–±–∫–∞ –æ—Ç–∫–∞—Ç–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏). –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º—è –¥–æ–º–µ–Ω–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–µ—Ç–µ–≤–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞, –ø–µ—Ä–≤—ã–º –¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ –∞–¥—Ä–µ—Å DNS-—Å–µ—Ä–≤–µ—Ä–∞ –¥—Ä—É–≥–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞, –≤—Ç–æ—Ä—ã–º —Å–≤–æ–π –∞–¥—Ä–µ—Å. <br />
<code class="language-plaintext highlighter-rouge">Get-Service -ComputerName $srv | select name,status | ? name -like "RpcSs"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Service -ComputerName $srv -Name RpcSs -RequiredServices</code> –∑–∞–≤–∏—Å–∏–º—ã–µ —Å–ª—É–∂–±—ã <br />
–ó–∞–≤–∏—Å–∏–º—ã–µ —Å–ª—É–∂–±—ã RPC: <br />
‚Äú–°–ª—É–∂–±–∞ —Å–≤–µ–¥–µ–Ω–∏–π –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —Å–µ—Ç—è—Ö‚Äù - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫. –ï—Å–ª–∏ —Å–ª—É–∂–±–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–æ ‚Äú—Å–ª—É–∂–±—ã —Å–ø–∏—Å–∫–∞ —Å–µ—Ç–µ–π‚Äù, –º–æ–∂–µ—Ç –ø–∞–¥–∞—Ç—å —Å–≤—è–∑—å —Å –¥–æ–º–µ–Ω–æ–º (netlogon) <br />
‚Äú–¶–µ–Ω—Ç—Ä —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫–ª—é—á–µ–π Kerberos‚Äù <br />
‚ÄúDNS-—Å–µ—Ä–≤–µ—Ä‚Äù <br />
<code class="language-plaintext highlighter-rouge">nslookup $srv</code> <br />
<code class="language-plaintext highlighter-rouge">tnc $srv -p 135</code> <br />
<code class="language-plaintext highlighter-rouge">repadmin /retry</code> –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É –ø—Ä–∏–≤—è–∑–∫–∏ –∫ —Ü–µ–ª–µ–≤–æ–º—É DC, –µ—Å–ª–∏ –±—ã–ª–∞ –æ—à–∏–±–∫–∞ 1722 –∏–ª–∏ 1753 (RPC –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)</p>

<p><code class="language-plaintext highlighter-rouge">repadmin /showrepl $srv</code> <br />
<code class="language-plaintext highlighter-rouge">Last attempt @ 2022-07-15 10:46:01 –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —Å –æ—à–∏–±–∫–æ–π, —Ä–µ–∑—É–ª—å—Ç–∞—Ç 8456 (0x2108)</code> –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ showrepl —ç—Ç–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞, –µ–≥–æ –æ—à–∏–±–∫–∞: 8457 (0x2109) <br />
<code class="language-plaintext highlighter-rouge">Last success @ 2022-07-11 02:29:46</code> –ø–æ—Å–ª–µ–¥–Ω–∏–π —É—Å–ø–µ—Ö <br />
–ö–æ–≥–¥–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∞, –û–° –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ DSA - not writable –æ–¥–Ω–æ –∏–∑ —á–µ—Ç—ã—Ä–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π: <br />
<code class="language-plaintext highlighter-rouge">Path: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\NTDS\Parameters</code> <br />
<code class="language-plaintext highlighter-rouge">Dsa Not Writable</code> <br />
<code class="language-plaintext highlighter-rouge">#define DSA_WRITABLE_GEN 1</code> –≤–µ—Ä—Å–∏—è –ª–µ—Å–∞ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å –û–° <br />
<code class="language-plaintext highlighter-rouge">#define DSA_WRITABLE_NO_SPACE 2</code> –Ω–∞ –¥–∏—Å–∫–µ, –≥–¥–µ —Ä–∞–∑–º–µ—â–µ–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Active Directory –∏–ª–∏ —Ñ–∞–π–ª—ã –∂—É—Ä–Ω–∞–ª–æ–≤ (–ª–æ–≥–∏), –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">#define DSA_WRITABLE_USNROLLBCK 4</code> –æ—Ç–∫–∞—Ç USN –ø—Ä–æ–∏–∑–æ—à–µ–ª –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–∫–∞—Ç–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Active Directory –≤–æ –≤—Ä–µ–º–µ–Ω–∏ (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Å–Ω–∞–ø—à–æ—Ç–∞) <br />
<code class="language-plaintext highlighter-rouge">#define DSA_WRITABLE_CORRUPT_UTDV 8</code> –≤–µ–∫—Ç–æ—Ä –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞</p>

<h1 id="dcdiag">dcdiag</h1>

<p><code class="language-plaintext highlighter-rouge">dcdiag /s:&lt;DomainController&gt; [/n:&lt;NamingContext&gt;] [[/u:&lt;domain\user&gt;] [/p:&lt;password&gt;]] [{/a|/e}{/q|/v}] [/f:&lt;LogFile&gt;] [/ferr:&lt;ErrorLog&gt;] [/test:&lt;test&gt;] [/fix]</code> <br />
<code class="language-plaintext highlighter-rouge">dcdiag /Test:replications /s:dc-01</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ—à–∏–±–∫–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">dcdiag /Test:DNS /e /v /q</code> —Ç–µ—Å—Ç DNS <br />
<code class="language-plaintext highlighter-rouge">/a</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–∞–Ω–Ω–æ–≥–æ —Å–∞–π—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">/e</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è <br />
<code class="language-plaintext highlighter-rouge">/q</code> –≤—ã–≤–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö <br />
<code class="language-plaintext highlighter-rouge">/v</code> –≤—ã–≤–æ–¥–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é <br />
<code class="language-plaintext highlighter-rouge">/fix</code> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –æ—à–∏–±–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">/test:</code> <br />
<code class="language-plaintext highlighter-rouge">NetLogons</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Connectivity</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é DNS –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —ç—Ö–æ-–ø–∞–∫–µ—Ç –Ω–∞ –∫–∞–∂–¥—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º LDAP –∏ RPC –∫ –∫–∞–∂–¥–æ–º—É –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É –¥–æ–º–µ–Ω–∞ <br />
<code class="language-plaintext highlighter-rouge">Services</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤—Å–µ—Ö —Å–ª—É–∂–±, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è —Ä–∞–±–æ—Ç—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞, –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞ <br />
<code class="language-plaintext highlighter-rouge">Systemlog</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –≤ –∂—É—Ä–Ω–∞–ª–∞—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞ <br />
<code class="language-plaintext highlighter-rouge">FRSEvent</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—à–∏–±–∫–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –≤ —Ä–∞–±–æ—Ç–µ —Å–ª—É–∂–±—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤, —á—Ç–æ –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ–±–ª–µ–º –≤ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ SYSVOL –∏, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∫–æ–ø–∏–π –æ–±—ä–µ–∫—Ç–æ–≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö –ø–æ–ª–∏—Ç–∏–∫ <br />
<code class="language-plaintext highlighter-rouge">FSMOCheck</code> –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª–∏ —Ö–æ–∑—è–µ–≤ –æ–ø–µ—Ä–∞—Ü–∏–π, –∞ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞, –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –≤—Ä–µ–º–µ–Ω–∏, —Å–µ—Ä–≤–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ –∏ —Ü–µ–Ω—Ç—Ä —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫–ª—é—á–µ–π (–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ KDC, PDC, —Å–µ—Ä–≤–µ—Ä—É –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞) <br />
<code class="language-plaintext highlighter-rouge">KnowsOfRoleHolders</code> –øg—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –¥–æ–º–µ–Ω–∞ –∫–æ –≤—Å–µ–º –ø—è—Ç–∏ —Ö–æ–∑—è–µ–≤–∞–º –æ–ø–µ—Ä–∞—Ü–∏–π (—Ä–æ–ª—è–º–∏ FSMO) <br />
<code class="language-plaintext highlighter-rouge">MachineAccount</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Å–ª—É–∂–± —ç—Ç–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –¥–æ–º–µ–Ω–æ–º). –ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞, –µ–µ –º–æ–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å –ø–æ–º–æ—â—å—é —É—Ç–∏–ª–∏—Ç—ã dcdiag, —É–∫–∞–∑–∞–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã /fixmachineaccount –∏–ª–∏ /recreatemachineaccount <br />
<code class="language-plaintext highlighter-rouge">Advertising</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞ —Å–æ–æ–±—â–∞–µ—Ç –æ —Å–µ–±–µ –∏ –æ —Å–≤–æ–µ–π —Ä–æ–ª–∏ —Ö–æ–∑—è–∏–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–π. –≠—Ç–æ—Ç —Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –Ω–µ—É–¥–∞—á–Ω–æ, –µ—Å–ª–∏ —Å–ª—É–∂–±–∞ NetLogon –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞ <br />
<code class="language-plaintext highlighter-rouge">CheckSDRefDom</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –¥–æ–º–µ–Ω–æ–≤ —Å—Å—ã–ª–æ–∫ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º <br />
<code class="language-plaintext highlighter-rouge">CrossRefValidation</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ –¥–ª—è –¥–æ–º–µ–Ω–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">RRSSysvol</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–ª—è FRS SYSVOL <br />
<code class="language-plaintext highlighter-rouge">Intersite</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–º–µ—à–∞—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å–∞–π—Ç–∞–º–∏. –ö–æ–º–ø–∞–Ω–∏—è Microsoft –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç, —á—Ç–æ –∏–Ω–æ–≥–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç—Ç–æ–≥–æ —Ç–µ—Å—Ç–∞ –º–æ–≥—É—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –Ω–µ—Ç–æ—á–Ω—ã–º–∏ <br />
<code class="language-plaintext highlighter-rouge">KCCEvent</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±–µ–∑–æ—à–∏–±–æ—á–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å–∞–π—Ç–∞–º–∏ <br />
<code class="language-plaintext highlighter-rouge">NCSecDesc</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –¥–ª—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –≤ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">ObjectsReplicated</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –∏ –æ–±—ä–µ–∫—Ç–æ–≤ —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">OutboundSecureChannels</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º–∏ –¥–æ–º–µ–Ω–∞ –≤ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–º –¥–æ–º–µ–Ω–µ <br />
<code class="language-plaintext highlighter-rouge">Replications</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º–∏ –¥–æ–º–µ–Ω–∞ –∏ —Å–æ–æ–±—â–∞–µ—Ç –æ–±–æ –≤—Å–µ—Ö –æ—à–∏–±–∫–∞—Ö –ø—Ä–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">RidManager</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ö–æ–∑—è–∏–Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">VerifyEnterpriseReferences</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ —Å–ª—É–∂–±—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –≤—Å–µ—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö –¥–æ–º–µ–Ω–∞ –≤ –ª–µ—Å—É <br />
<code class="language-plaintext highlighter-rouge">VerifyReferences</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ —Å–ª—É–∂–±—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞ <br />
<code class="language-plaintext highlighter-rouge">VerifyReplicas</code> –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ –∫–∞—Ç–∞–ª–æ–≥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏—Ö —É—á–∞—Å—Ç–∏–µ –≤ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏</p>

<h1 id="ntdsutil">ntdsutil</h1>

<p>–ü–µ—Ä–µ–Ω–æ—Å –ë–î AD (ntds.dit): <br />
<code class="language-plaintext highlighter-rouge">Get-Acl C:\Windows\NTDS | Set-Acl D:\AD-DB</code> —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å NTFS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –Ω–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ <br />
<code class="language-plaintext highlighter-rouge">Stop-Service -ComputerName dc -name NTDS</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂–±—É Active Directory Domain Services <br />
<code class="language-plaintext highlighter-rouge">ntdsutil</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —É—Ç–∏–ª–∏—Ç—É ntdsutil <br />
<code class="language-plaintext highlighter-rouge">activate instance NTDS</code> –≤—ã–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –±–∞–∑—ã AD <br />
<code class="language-plaintext highlighter-rouge">files</code> –ø–µ—Ä–µ–π–¥–µ–º –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç files, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏—è —Å —Ñ–∞–π–ª–∞–º–∏ –±–∞–∑—ã ntds.dit <br />
<code class="language-plaintext highlighter-rouge">move DB to D:\AD-DB\</code> –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –±–∞–∑—É AD –≤ –Ω–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ (–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω–æ –µ–≥–æ —Å–æ–∑–¥–∞—Ç—å) <br />
<code class="language-plaintext highlighter-rouge">info</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ë–î –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–æ–≤–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ <br />
<code class="language-plaintext highlighter-rouge">move logs to D:\AD-DB\</code> –ø–µ—Ä–µ–º–µ—Å—Ç–∏–º –≤ —Ç–æ—Ç –∂–µ –∫–∞—Ç–∞–ª–æ–≥ —Ñ–∞–π–ª—ã —Å –∂—É—Ä–Ω–∞–ª–∞–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π <br />
<code class="language-plaintext highlighter-rouge">quit</code> <br />
<code class="language-plaintext highlighter-rouge">Start-Service -ComputerName dc -name NTDS</code></p>

<p>–°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è DSRM (—Ä–µ–∂–∏–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ª—É–∂–± –∫–∞—Ç–∞–ª–æ–≥–æ–≤):  <br />
<code class="language-plaintext highlighter-rouge">ntdsutil</code> <br />
<code class="language-plaintext highlighter-rouge">set dsrm password</code> <br />
<code class="language-plaintext highlighter-rouge">reset password on server NULL</code> <br />
–Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å <br />
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è <br />
<code class="language-plaintext highlighter-rouge">quit</code> <br />
<code class="language-plaintext highlighter-rouge">quit</code></p>

<p>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –ø–∞—Ä–æ–ª–µ–º –£–ó –≤ AD: <br />
<code class="language-plaintext highlighter-rouge">ntdsutil</code> <br />
<code class="language-plaintext highlighter-rouge">set dsrm password</code> <br />
<code class="language-plaintext highlighter-rouge">sync from domain account dsrmadmin</code> <br />
<code class="language-plaintext highlighter-rouge">quit</code> <br />
<code class="language-plaintext highlighter-rouge">quit</code></p>

<p>–û—à–∏–±–∫–∞ 0x00002e2 –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –û–°. <br />
–ó–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–µ–Ω–∏—è WinRE (Windows Recovery Environment) - Startup Settings - Restart - DSRM (Directory Services Restore Mode) <br />
<code class="language-plaintext highlighter-rouge">reagentc /boottore</code> shutdown /f /r /o /t 0 –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –≤ —Ä–µ–∂–∏–º–µ WinRE - –û–° –Ω–∞ –±–∞–∑–µ WinPE (Windows Preinstallation Environment), –æ–±—Ä–∞–∑ winre.wim –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å–∫—Ä—ã—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ System Restore <br />
–ù–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å ‚Äî –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä DSRM. –ü–∞—Ä–æ–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Ä–æ–ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–æ–º–µ–Ω–∞ ADDS –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (SafeModeAdministratorPassword). <br />
<code class="language-plaintext highlighter-rouge">ntdsutil</code> <br />
<code class="language-plaintext highlighter-rouge">activate instance ntds</code> <br />
<code class="language-plaintext highlighter-rouge">Files</code> <br />
<code class="language-plaintext highlighter-rouge">Info</code> <br />
<code class="language-plaintext highlighter-rouge">integrity</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ë–î <br />
–û—à–∏–±–∫–∞: Failed to open DIT for AD DS/LDS instance NTDS. Error -2147418113 <br />
<code class="language-plaintext highlighter-rouge">mkdir c:\ntds_bak</code> <br />
<code class="language-plaintext highlighter-rouge">xcopy c:\Windows\NTDS\*.* c:\ntds_bak</code> backup —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞ —Å –ë–î <br />
<code class="language-plaintext highlighter-rouge">esentutl /g c:\windows\ntds\ntds.dit</code> –ø—Ä–æ–≤–µ—Ä–∏–º —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–∞ <br />
–í—ã–≤–æ–¥: Integrity check completed. Database is CORRUPTED –æ—à–∏–±–∫–∞, –±–∞–∑–∞ AD –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞ <br />
<code class="language-plaintext highlighter-rouge">esentutl /p c:\windows\ntds\ntds.dit</code> –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ <br />
–í—ã–≤–æ–¥: Operation completed successfully in xx seconds. –Ω–µ—Ç –æ—à–∏–±–æ–∫ <br />
<code class="language-plaintext highlighter-rouge">esentutl /g c:\windows\ntds\ntds.dit</code> –ø—Ä–æ–≤–µ—Ä–∏–º —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–∞ <br />
–í—ã–ø–æ–ª–Ω–∏—Ç—å –∞–Ω–∞–ª–∏–∑ —Å–µ–º–∞–Ω—Ç–∏–∫–∏ –±–∞–∑—ã —Å –ø–æ–º–æ—â—å—é ntdsutil: <br />
<code class="language-plaintext highlighter-rouge">ntdsutil</code> <br />
<code class="language-plaintext highlighter-rouge">activate instance ntds</code> <br />
<code class="language-plaintext highlighter-rouge">semantic database analysis</code> <br />
<code class="language-plaintext highlighter-rouge">go</code> <br />
<code class="language-plaintext highlighter-rouge">go fixup</code> –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ <br />
–°–∂–∞—Ç—å —Ñ–∞–π–ª –ë–î: <br />
<code class="language-plaintext highlighter-rouge">activate instance ntds</code> <br />
<code class="language-plaintext highlighter-rouge">files</code> <br />
<code class="language-plaintext highlighter-rouge">compact to C:\Windows\NTDS\TEMP</code> <br />
<code class="language-plaintext highlighter-rouge">copy C:\Windows\NTDS\TEMP\ntds.dit C:\Windows\NTDS\ntds.dit</code> –∑–∞–º–µ–Ω–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª ntds.dit <br />
<code class="language-plaintext highlighter-rouge">Del C:\Windows\NTDS\*.log</code> —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –ª–æ–≥ —Ñ–∞–π–ª—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ NTDS</p>

<h1 id="gpo">GPO</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Command -Module GroupPolicy</code> <br />
<code class="language-plaintext highlighter-rouge">Get-GPO -Domain domain.local -All | ft</code> <br />
<code class="language-plaintext highlighter-rouge">Get-GPO -Name LAPS</code> <br />
<code class="language-plaintext highlighter-rouge">[xml](Get-GPOReport LAPS -ReportType Xml)</code> <br />
<code class="language-plaintext highlighter-rouge">Get-GPPermission -Name LAPS -All</code> <br />
<code class="language-plaintext highlighter-rouge">Get-GPO LAPS | New-GPLink -Target "ou=servers,dc=domain,dc=local"</code> <br />
<code class="language-plaintext highlighter-rouge">Set-GPLink -Name LAPS -Target "ou=servers,dc=domain,dc=local" -LinkEnabled No</code> <br />
<code class="language-plaintext highlighter-rouge">Backup-GPO -Name LAPS -Path "$home\Desktop"</code> <br />
<code class="language-plaintext highlighter-rouge">Backup-GPO -All -Path "$home\Desktop"</code> <br />
<code class="language-plaintext highlighter-rouge">Restore-GPO -Name LAPS -Path C:\Backup\GPOs\</code></p>

<h1 id="servermanager">ServerManager</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Command *WindowsFeature*</code> source module ServerManager <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsFeature -ComputerName "localhost"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsFeature | where Installed -eq $True</code> —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsFeature | where FeatureType -eq "Role"</code> –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Å–ø–∏—Å–∫—É —Ä–æ–ª–µ–π <br />
<code class="language-plaintext highlighter-rouge">Install-WindowsFeature -Name DNS</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å <br />
<code class="language-plaintext highlighter-rouge">Get-Command *DNS*</code> <br />
<code class="language-plaintext highlighter-rouge">Get-DnsServerSetting -ALL</code> <br />
<code class="language-plaintext highlighter-rouge">Uninstall-WindowsFeature -Name DNS</code> —É–¥–∞–ª–∏—Ç—å —Ä–æ–ª—å</p>

<h3 id="pswa">PSWA</h3>
<p><code class="language-plaintext highlighter-rouge">Install-WindowsFeature -Name WindowsPowerShellWebAccess -IncludeManagementTools</code> <br />
<code class="language-plaintext highlighter-rouge">Install-PswaWebApplication -UseTestCertificate</code> –°–æ–∑–¥–∞—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ /pswa <br />
<code class="language-plaintext highlighter-rouge">Add-PswaAuthorizationRule -UserGroupName "$domain\Domain Admins" -ComputerName * -ConfigurationName * -RuleName "For Admins"</code> –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</p>

<h3 id="wsb-windows-server-backup">WSB (Windows Server Backup)</h3>
<p>–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ backup DC —á–µ—Ä–µ–∑ WSB, —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–ø–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã (System State), –∫—É–¥–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –±–∞–∑–∞ AD (NTDS.DIT), –æ–±—ä–µ–∫—Ç—ã –≥—Ä—É–ø–ø–æ–≤—ã—Ö –ø–æ–ª–∏—Ç–∏–∫, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–∞—Ç–∞–ª–æ–≥–∞ SYSVOL, —Ä–µ–µ—Å—Ç—Ä, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ IIS, –±–∞–∑–∞ AD CS, –∏ –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ —Ä–µ—Å—É—Ä—Å—ã. –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–ª—É–∂–±—É —Ç–µ–Ω–µ–≤–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è VSS. <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsFeature Windows-Server-Backup</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ª–∏ —Ä–æ–ª—å <br />
<code class="language-plaintext highlighter-rouge">Add-Windowsfeature Windows-Server-Backup ‚ÄìIncludeallsubfeature</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å</p>
<pre><code class="language-PowerShell">$path="\\$srv\bak-dc\dc-03\"
[string]$TargetUNC=$path+(get-date -f 'yyyy-MM-dd')
if ((Test-Path -Path $path) -eq $true) {New-Item -Path $TargetUNC -ItemType directory} # –µ—Å–ª–∏ –ø—É—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω, —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–æ –¥–∞—Ç–µ
$WBadmin_cmd = "wbadmin.exe START BACKUP -backupTarget:$TargetUNC -systemState -noverify -vssCopy -quiet"
# $WBadmin_cmd = "wbadmin start backup -backuptarget:$path -include:C:\Windows\NTDS\ntds.dit -quiet" # Backup DB NTDS
Invoke-Expression $WBadmin_cmd
</code></pre>
<h3 id="rds">RDS</h3>
<p><code class="language-plaintext highlighter-rouge">Get-Command -Module RemoteDesktop</code> <br />
<code class="language-plaintext highlighter-rouge">Get-RDServer -ConnectionBroker $broker</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ —Ñ–µ—Ä–º–µ—ã, —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ–µ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É —Å —Ä–æ–ª—å—é RDCB <br />
<code class="language-plaintext highlighter-rouge">Get-RDRemoteDesktop -ConnectionBroker $broker</code> —Å–ø–∏—Å–æ–∫ –∫–æ–ª–ª–µ–∫—Ü–∏–π <br />
<code class="language-plaintext highlighter-rouge">(Get-RDLicenseConfiguration -ConnectionBroker $broker | select *).LicenseServer</code> —Å–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å —Ä–æ–ª—å—é RDL <br />
<code class="language-plaintext highlighter-rouge">Get-RDUserSession -ConnectionBroker $broker</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π <br />
<code class="language-plaintext highlighter-rouge">Disconnect-RDUser -HostServer $srv -UnifiedSessionID $id -Force</code> –æ—Ç–∫–ª—é—á–∏—Ç—å —Å–µ—Å—Å–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">Get-RDAvailableApp -ConnectionBroker $broker -CollectionName C03</code> —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ü–û –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">(Get-RDSessionCollectionConfiguration -ConnectionBroker $broker -CollectionName C03 | select *).CustomRdpProperty</code> use redirection server name:i:1 <br />
<code class="language-plaintext highlighter-rouge">Get-RDConnectionBrokerHighAvailability</code></p>

<h1 id="dnsserver">DNSServer</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Command -Module DnsServer</code> <br />
<code class="language-plaintext highlighter-rouge">Show-DnsServerCache</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤–µ—Å—å –∫—ç—à DNS-—Å–µ—Ä–≤–µ—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">Show-DnsServerCache | where HostName -match ru</code> <br />
<code class="language-plaintext highlighter-rouge">Clear-DnsServerCache</code> <br />
<code class="language-plaintext highlighter-rouge">Get-DnsServerCache</code> <br />
<code class="language-plaintext highlighter-rouge">Get-DnsServerDiagnostics</code></p>
<pre><code class="language-PowerShell">$zone = icm $srv {Get-DnsServerZone} | select ZoneName,ZoneType,DynamicUpdate,ReplicationScope,SecureSecondaries,
DirectoryPartitionName | Out-GridView -Title "DNS Server: $srv" ‚ÄìPassThru
$zone_name = $zone.ZoneName
if ($zone_name -ne $null) {
icm $srv {Get-DnsServerResourceRecord -ZoneName $using:zone_name | sort RecordType | select RecordType,HostName, @{
Label="IPAddress"; Expression={$_.RecordData.IPv4Address.IPAddressToString}},TimeToLive,Timestamp
} | select RecordType,HostName,IPAddress,TimeToLive,Timestamp | Out-GridView -Title "DNS Server: $srv"
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Sync-DnsServerZone ‚Äìpassthru</code> —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–æ–Ω—ã —Å –¥—Ä—É–≥–∏–º–∏ DC –≤ –¥–æ–º–µ–Ω–µ <br />
<code class="language-plaintext highlighter-rouge">Remove-DnsServerZone -Name domain.local</code> —É–¥–∞–ª–∏—Ç—å –∑–æ–Ω—É <br />
<code class="language-plaintext highlighter-rouge">Get-DnsServerResourceRecord -ZoneName domain.local -RRType A</code> –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ –ê-–∑–∞–ø–∏—Å–∏ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –∑–æ–Ω–µ <br />
<code class="language-plaintext highlighter-rouge">Add-DnsServerResourceRecordA -Name new-host-name -IPv4Address 192.168.1.100 -ZoneName domain.local -TimeToLive 01:00:00 -CreatePtr</code> —Å–æ–∑–¥–∞—Ç—å –ê-–∑–∞–ø–∏—Å—å –∏ PTR –¥–ª—è –Ω–µ–µ <br />
<code class="language-plaintext highlighter-rouge">Remove-DnsServerResourceRecord -ZoneName domain.local -RRType A -Name new-host-name ‚ÄìForce</code> —É–¥–∞–ª–∏—Ç—å –ê-–∑–∞–ø–∏—Å—å</p>
<pre><code class="language-PowerShell">$DNSServer = "DC-01"
$DNSFZone = "domain.com"
$DataFile = "C:\Scripts\DNS-Create-A-Records-from-File.csv"
# cat $DataFile
# "HostName;IP"
# "server-01;192.168.1.10"
$DNSRR = [WmiClass]"\\$DNSServer\root\MicrosoftDNS:MicrosoftDNS_ResourceRecord"
$ConvFile = $DataFile + "_unicode"
Get-Content $DataFile | Set-Content $ConvFile -Encoding Unicode
Import-CSV $ConvFile -Delimiter ";" | ForEach-Object {
$FQDN = $_.HostName + "." + $DNSFZone
$IP = $_.HostIP
$TextA = "$FQDN IN A $IP"
[Void]$DNSRR.CreateInstanceFromTextRepresentation($DNSServer,$DNSFZone,$TextA)
}
</code></pre>
<h1 id="dhcpserver">DHCPServer</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Command -Module DhcpServer</code></p>
<pre><code class="language-PowerShell">$mac = icm $srv -ScriptBlock {Get-DhcpServerv4Scope | Get-DhcpServerv4Lease} | select AddressState,
HostName,IPAddress,ClientId,DnsRegistration,DnsRR,ScopeId,ServerIP | Out-GridView -Title "HDCP Server: $srv" ‚ÄìPassThru
(New-Object -ComObject Wscript.Shell).Popup($mac.ClientId,0,$mac.HostName,64)
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Add-DhcpServerv4Reservation -ScopeId 192.168.1.0 -IPAddress 192.168.1.10 -ClientId 00-50-56-C0-00-08 -Description "new reservation"</code></p>

<h1 id="dfs">DFS</h1>

<p><code class="language-plaintext highlighter-rouge">dfsutil /root:\\domain.sys\public /export:C:\export-dfs.txt</code> —ç–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ namespace root <br />
<code class="language-plaintext highlighter-rouge">dfsutil /AddFtRoot /Server:\\$srv /Share:public</code> –Ω–∞ –Ω–æ–≤–æ–π –º–∞—à–∏–Ω–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∫–æ—Ä–µ–Ω—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ–º–µ–Ω–∞ <br />
<code class="language-plaintext highlighter-rouge">dfsutil /root:\\domain.sys\public /import:C:\export-dfs.txt /&lt;verify /set</code> Import (–ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º –¥–∞–Ω–Ω—ã—Ö –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ—Ä–µ–Ω—å DFS, —É—Ç–∏–ª–∏—Ç–∞ —Å–æ–∑–¥–∞–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–æ—Ä–Ω—è –≤ —Ç–µ–∫—É—â–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —É—Ç–∏–ª–∏—Ç–∞ dfsutil) <br />
<code class="language-plaintext highlighter-rouge">/verify</code> –≤—ã–≤–æ–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤–Ω–µ—Å–µ–Ω—ã –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∏–º–ø–æ—Ä—Ç–∞, –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">/set</code> –º–µ–Ω—è–µ—Ç —Ü–µ–ª–µ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω –ø—É—Ç–µ–º –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –∏ –∑–∞–º–µ–Ω—ã –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω –∏–∑ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ <br />
<code class="language-plaintext highlighter-rouge">/merge</code> –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–ª–∏—è–Ω–∏—è, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±—É–¥—É—Ç –∏–º–µ—Ç—å –±–æ–ª—å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, —á–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω</p>

<p><code class="language-plaintext highlighter-rouge">Export-DfsrClone</code> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–æ–º–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-DfsrCloneState</code> –ø–æ–ª—É—á–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö <br />
<code class="language-plaintext highlighter-rouge">Import-DfsrClone</code> –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–æ–º–∞</p>

<p><code class="language-plaintext highlighter-rouge">net use x: \\$srv1\public\*</code> –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∏—Å–∫ <br />
<code class="language-plaintext highlighter-rouge">Get-DfsrFileHash x:\* | Out-File C:\$srv1.txt</code> –∑–∞–±—Ä–∞—Ç—å hash –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –¥–∏—Å–∫–∞ –≤ —Ñ–∞–π–ª (—Ñ–∞–π–ª—ã —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ —Ö–µ—à–∞–º–∏ –≤—Å–µ–≥–¥–∞ —è–≤–ª—è—é—Ç—Å—è —Ç–æ—á–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞) <br />
<code class="language-plaintext highlighter-rouge">net use x: /d</code> –æ—Ç–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å <br />
<code class="language-plaintext highlighter-rouge">net use x: \\$srv2\public\*</code> <br />
<code class="language-plaintext highlighter-rouge">Get-DfsrFileHash x:\* | Out-File C:\$srv2.txt</code> <br />
<code class="language-plaintext highlighter-rouge">net use x: /d</code> <br />
<code class="language-plaintext highlighter-rouge">Compare-Object -ReferenceObject (Get-Content C:\$srv1.txt) -DifferenceObject (Get-Content C:\$srv2.txt) -IncludeEqual</code> —Å—Ä–∞–≤–Ω–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤</p>

<p><code class="language-plaintext highlighter-rouge">Get-DfsrBacklog -DestinationComputerName "fs-06" -SourceComputerName "fs-05" -GroupName "folder-rep" -FolderName "folder" -Verbose</code> –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –æ–∂–∏–¥–∞—é—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤ –º–µ–∂–¥—É –¥–≤—É–º—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS <br />
<code class="language-plaintext highlighter-rouge">Get-DfsrConnection</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏, —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ —Å—Ç–∞—Ç—É—Å <br />
<code class="language-plaintext highlighter-rouge">Get-DfsReplicatedFolder</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏–º—è –∏ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ –ø–∞–ø–∫–∞–º —Ä–µ–ª–∏–∫–∞—Ü–∏–∏ –≤ —Å–∏—Å—Ç–µ–º–µ DFS <br />
<code class="language-plaintext highlighter-rouge">Get-DfsrState -ComputerName fs-06 -Verbose</code> —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS –¥–ª—è —á–ª–µ–Ω–∞ –≥—Ä—É–ø–ø—ã <br />
<code class="language-plaintext highlighter-rouge">Get-DfsReplicationGroup</code> –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å <br />
<code class="language-plaintext highlighter-rouge">Add-DfsrConnection</code> —Å–æ–∑–¥–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É —á–ª–µ–Ω–∞–º–∏ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Add-DfsrMember</code> –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –≤ –≥—Ä—É–ø–ø—É —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">ConvertFrom-DfsrGuid</code> –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã GUID –≤ –ø–æ–Ω—è—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ –≤ –∑–∞–¥–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-DfsrConnectionSchedule</code> –ø–æ–ª—É—á–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –º–µ–∂–¥—É —á–ª–µ–Ω–∞–º–∏ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-DfsrGroupSchedule</code> –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-DfsrIdRecord</code> –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø–∏—Å–∏ ID –¥–ª—è —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –ø–∞–ø–æ–∫ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS <br />
<code class="language-plaintext highlighter-rouge">Get-DfsrMember</code> –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –≤ –≥—Ä—É–ø–ø–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-DfsrMembership</code> –ø–æ–ª—É—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–ª–µ–Ω—Å—Ç–≤–∞ –¥–ª—è —á–ª–µ–Ω–æ–≤ –≥—Ä—É–ø–ø —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-DfsrPreservedFiles</code> –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫, —Ä–∞–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π DFS <br />
<code class="language-plaintext highlighter-rouge">Get-DfsrServiceConfiguration</code> –ø–æ–ª—É—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–ª—É–∂–±—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS –¥–ª—è —á–ª–µ–Ω–æ–≤ –≥—Ä—É–ø–ø—ã <br />
<code class="language-plaintext highlighter-rouge">Grant-DfsrDelegation</code> –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Revoke-DfsrDelegation</code> –æ—Ç–º–µ–Ω—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">New-DfsReplicationGroup</code> —Å–æ–∑–¥–∞–µ—Ç –≥—Ä—É–ø–ø—É —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">New-DfsReplicatedFolder</code> —Å–æ–∑–¥–∞–µ—Ç —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–∞–ø–∫—É –≤ –≥—Ä—É–ø–ø–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Remove-DfsrConnection</code> —É–¥–∞–ª—è–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É —á–ª–µ–Ω–∞–º–∏ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Remove-DfsReplicatedFolder</code> —É–¥–∞–ª—è–µ—Ç —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–∞–ø–∫—É –∏–∑ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Remove-DfsReplicationGroup</code> —É–¥–∞–ª—è–µ—Ç –≥—Ä—É–ø–ø—É —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Remove-DfsrMember</code> —É–¥–∞–ª—è–µ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –∏–∑ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Restore-DfsrPreservedFiles</code> –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏, —Ä–∞–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π DFS <br />
<code class="language-plaintext highlighter-rouge">Set-DfsrConnection</code> –∏–∑–º–µ–Ω—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –º–µ–∂–¥—É —á–ª–µ–Ω–∞–º–∏ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Set-DfsrConnectionSchedule</code> –∏–∑–º–µ–Ω—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –º–µ–∂–¥—É —á–ª–µ–Ω–∞–º–∏ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Set-DfsReplicatedFolder</code> –∏–∑–º–µ–Ω—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–∞–ø–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">Set-DfsReplicationGroup</code> –∏–∑–º–µ–Ω—è–µ—Ç –≥—Ä—É–ø–ø—É —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Set-DfsrGroupSchedule</code> –∏–∑–º–µ–Ω—è–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Set-DfsrMember</code> –∏–∑–º–µ–Ω—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ-—É—á–∞—Å—Ç–Ω–∏–∫–µ –≤ –≥—Ä—É–ø–ø–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Set-DfsrMembership</code> –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–ª–µ–Ω—Å—Ç–≤–∞ –¥–ª—è —á–ª–µ–Ω–æ–≤ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Set-DfsrServiceConfiguration</code> –∏–∑–º–µ–Ω—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–ª—É–∂–±—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS <br />
<code class="language-plaintext highlighter-rouge">Sync-DfsReplicationGroup</code> —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –º–µ–∂–¥—É –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Suspend-DfsReplicationGroup</code> –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –º–µ–∂–¥—É –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Update-DfsrConfigurationFromAD</code> –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS <br />
<code class="language-plaintext highlighter-rouge">Write-DfsrHealthReport</code> —Å–æ–∑–¥–∞–µ—Ç –æ—Ç—á–µ—Ç –æ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ DFS <br />
<code class="language-plaintext highlighter-rouge">Write-DfsrPropagationReport</code> —Å–æ–∑–¥–∞–µ—Ç –æ—Ç—á–µ—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Start-DfsrPropagationTest</code> —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –≤ —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ</p>

<h1 id="storagereplica">StorageReplica</h1>

<p><code class="language-plaintext highlighter-rouge">Install-WindowsFeature Storage-Replica ‚ÄìIncludeManagementTools -Restart</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Command -Module StorageReplica</code> <br />
<code class="language-plaintext highlighter-rouge">Test-SRTopology</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ —Å–µ—Ä–≤–µ—Ä –∏ –∫–∞–Ω–∞–ª —Å–≤—è–∑–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ Storage Replica <br />
<code class="language-plaintext highlighter-rouge">New-SRPartnership -SourceComputerName srv-01 -SourceRGName srv-01-rep-group-01 -SourceVolumeName D: -SourceLogVolumeName L: -DestinationComputerName srv-02 -DestinationRGName srv-02-rep-group-01 -DestinationVolumeName D: -DestinationLogVolumeName L: -LogSizeInBytes 1GB</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Counter -Counter "\Storage Replica Statistics(*)"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-WinEvent -ProviderName Microsoft-Windows-StorageReplica -max 10</code> <br />
<code class="language-plaintext highlighter-rouge">Set-SRPartnership -ReplicationMode Asynchronous</code> –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π <br />
<code class="language-plaintext highlighter-rouge">Set-SRPartnership -NewSourceComputerName srv-02 -SourceRGName srv-02-rep-group-01 -DestinationComputerName srv-01 -DestinationRGName srv-01-rep-group-01</code> –∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–≤–µ–¥—è –≤—Ç–æ—Ä–∏—á–Ω—É—é –∫–æ–ø–∏—é –≤ –æ–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º (–ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Å—Ç—Ä–æ—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞) <br />
<code class="language-plaintext highlighter-rouge">Get-SRGroup</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥—Ä—É–ø–ø—ã —Ä–µ–ø–ª–∏–∑–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-SRPartnerShip</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">(Get-SRGroup).Replicas | Select-Object numofbytesremaining</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–ª–∏–Ω—É –æ—á–µ—Ä–µ–¥–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Get-SRPartnership | Remove-SRPartnership</code> —É–¥–∞–ª–∏—Ç—å —Ä–µ–ø–ª–∏–∑–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ <br />
<code class="language-plaintext highlighter-rouge">Get-SRGroup | Remove-SRGroup</code> —É–¥–∞–ª–∏—Ç—å —Ä–µ–ø–ª–∏–∑–∞—Ü–∏—é –Ω–∞ –æ–±–æ–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö</p>

<h1 id="ps2exe">PS2EXE</h1>

<p><code class="language-plaintext highlighter-rouge">Install-Module ps2exe -Repository PSGallery</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Module -ListAvailable</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π <br />
<code class="language-plaintext highlighter-rouge">-noConsole</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GUI, –±–µ–∑ –æ–∫–Ω–∞ –∫–æ–Ω—Å–æ–ª–∏ powershell <br />
<code class="language-plaintext highlighter-rouge">-noOutput</code> –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–µ <br />
<code class="language-plaintext highlighter-rouge">-noError</code> –±–µ–∑ –≤—ã–≤–æ–¥–∞ –æ—à–∏–±–æ–∫ <br />
<code class="language-plaintext highlighter-rouge">-requireAdmin</code> –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">-credentialGUI</code> –≤—ã–≤–æ–¥ –¥–∏–∞–ª–æ–≥–æ–≤–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è –≤–≤–æ–¥–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö <br />
<code class="language-plaintext highlighter-rouge">Invoke-ps2exe -inputFile "$home\Desktop\WinEvent-Viewer-1.1.ps1" -outputFile "$home\Desktop\WEV-1.1.exe" -iconFile "$home\Desktop\log_48px.ico" -title "WinEvent-Viewer" -noConsole -noOutput -noError</code></p>

<h1 id="nssm">NSSM</h1>

<p><code class="language-plaintext highlighter-rouge">$powershell_Path = (Get-Command powershell).Source</code> <br />
<code class="language-plaintext highlighter-rouge">$NSSM_Path = (Get-Command "C:\WinPerf-Agent\NSSM-2.24.exe").Source</code> <br />
<code class="language-plaintext highlighter-rouge">$Script_Path = "C:\WinPerf-Agent\WinPerf-Agent-1.1.ps1"</code> <br />
<code class="language-plaintext highlighter-rouge">$Service_Name = "WinPerf-Agent"</code> <br />
<code class="language-plaintext highlighter-rouge">&amp; $NSSM_Path install $Service_Name $powershell_Path -ExecutionPolicy Bypass -NoProfile -f $Script_Path</code> —Å–æ–∑–¥–∞—Ç—å Service <br />
<code class="language-plaintext highlighter-rouge">&amp; $NSSM_Path start $Service_Name</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å <br />
<code class="language-plaintext highlighter-rouge">&amp; $NSSM_Path status $Service_Name</code> —Å—Ç–∞—Ç—É—Å <br />
<code class="language-plaintext highlighter-rouge">$Service_Name | Restart-Service</code> –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å <br />
<code class="language-plaintext highlighter-rouge">$Service_Name | Get-Service</code> —Å—Ç–∞—Ç—É—Å <br />
<code class="language-plaintext highlighter-rouge">$Service_Name | Stop-Service</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å <br />
<code class="language-plaintext highlighter-rouge">&amp; $NSSM_Path set $Service_Name description "Check performance CPU and report email"</code> –∏–∑–º–µ–Ω–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">&amp; $NSSM_Path remove $Service_Name</code> —É–¥–∞–ª–∏—Ç—å</p>

<h1 id="jobs">Jobs</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Job</code> –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á <br />
<code class="language-plaintext highlighter-rouge">Start-Job</code> –∑–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ <br />
<code class="language-plaintext highlighter-rouge">Stop-Job</code> –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ <br />
<code class="language-plaintext highlighter-rouge">Suspend-Job</code> –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–∞ <br />
<code class="language-plaintext highlighter-rouge">Resume-Job</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–∞ <br />
<code class="language-plaintext highlighter-rouge">Wait-Job</code> –æ–∂–∏–¥–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã <br />
<code class="language-plaintext highlighter-rouge">Receive-Job</code> –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ <br />
<code class="language-plaintext highlighter-rouge">Remove-Job</code> —É–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É</p>
<pre><code class="language-PowerShell">function Start-PingJob ($Network) {
$RNetwork = $Network -replace "\.\d{1,3}$","."
foreach ($4 in 1..254) {
$ip = $RNetwork+$4
# —Å–æ–∑–¥–∞–µ–º –∑–∞–¥–∞–Ω–∏—è, –∑–∞–±–∏—Ä–∞–µ–º 3-—é —Å—Ç—Ä–æ–∫—É –≤—ã–≤–æ–¥–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –≤—ã–≤–æ–¥—É ip-–∞–¥—Ä–µ—Å:
(Start-Job {"$using:ip : "+(ping -n 1 -w 50 $using:ip)[2]}) | Out-Null
}
while ($True){
$status_job = (Get-Job).State[-1] # –∑–∞–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
if ($status_job -like "Completed"){ # –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–∏ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑)
$ping_out = Get-Job | Receive-Job # –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω, –∑–∞–±–∏—Ä–∞–µ–º –≤—ã–≤–æ–¥ –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π
Get-Job | Remove-Job -Force # —É–¥–∞–ª—è–µ–º –∑–∞–¥–∞–Ω–∏—è
$ping_out
break # –∑–∞–≤–µ—Ä—à–∞–µ–º —Ü–∏–∫–ª
}}
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Start-PingJob -Network 192.168.3.0</code> <br />
<code class="language-plaintext highlighter-rouge">(Measure-Command {Start-PingJob -Network 192.168.3.0}).TotalSeconds</code> 60 Seconds</p>

<h3 id="threadjob">ThreadJob</h3>

<p><code class="language-plaintext highlighter-rouge">Install-Module -Name ThreadJob</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Module ThreadJob -list</code> <br />
<code class="language-plaintext highlighter-rouge">Start-ThreadJob {ping ya.ru} | Out-Null</code> —Å–æ–∑–¥–∞—Ç—å —Ñ–æ–Ω–æ–≤—É—é –∑–∞–¥–∞—á—É <br />
<code class="language-plaintext highlighter-rouge">Get-Job | Receive-Job -Keep</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∏ –Ω–µ —É–¥–∞–ª—è—Ç—å –≤—ã–≤–æ–¥ <br />
<code class="language-plaintext highlighter-rouge">(Get-Job).HasMoreData</code> –µ—Å–ª–∏ False, —Ç–æ –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω—ã —É–¥–∞–ª–µ–Ω <br />
<code class="language-plaintext highlighter-rouge">(Get-Job)[-1].Output</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—ã–≤–æ–¥ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–¥–∞—á–∏</p>
<pre><code class="language-PowerShell">function Start-PingThread ($Network) {
$RNetwork = $Network -replace "\.\d{1,3}$","."
foreach ($4 in 1..254) {
$ip = $RNetwork+$4
# —Å–æ–∑–¥–∞–µ–º –∑–∞–¥–∞–Ω–∏—è, –∑–∞–±–∏—Ä–∞–µ–º 3-—é —Å—Ç—Ä–æ–∫—É –≤—ã–≤–æ–¥–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –≤—ã–≤–æ–¥—É ip-–∞–¥—Ä–µ—Å:
(Start-ThreadJob {"$using:ip : "+(ping -n 1 -w 50 $using:ip)[2]}) | Out-Null
}
while ($True){
$status_job = (Get-Job).State[-1] # –∑–∞–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
if ($status_job -like "Completed"){ # –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–∏ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑)
$ping_out = Get-Job | Receive-Job # –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω, –∑–∞–±–∏—Ä–∞–µ–º –≤—ã–≤–æ–¥ –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π
Get-Job | Remove-Job -Force # —É–¥–∞–ª—è–µ–º –∑–∞–¥–∞–Ω–∏—è
$ping_out
break # –∑–∞–≤–µ—Ä—à–∞–µ–º —Ü–∏–∫–ª
}}
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Start-PingThread -Network 192.168.3.0</code> <br />
<code class="language-plaintext highlighter-rouge">(Measure-Command {Start-PingThread -Network 192.168.3.0}).TotalSeconds</code> 24 Seconds</p>

<h3 id="poshrsjob">PoshRSJob</h3>
<pre><code class="language-PowerShell">function Start-PingRSJob ($Network) {
$RNetwork = $Network -replace "\.\d{1,3}$","."
foreach ($4 in 1..254) {
$ip = $RNetwork+$4
(Start-RSJob {"$using:ip : "+(ping -n 1 -w 50 $using:ip)[2]}) | Out-Null
}
$ping_out = Get-RSJob | Receive-RSJob
$ping_out
Get-RSJob | Remove-RSJob
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Start-PingRSJob -Network 192.168.3.0</code> <br />
<code class="language-plaintext highlighter-rouge">(Measure-Command {Start-PingRSJob -Network 192.168.3.0}).TotalSeconds</code> 10 Seconds</p>

<h1 id="smtp">SMTP</h1>
<pre><code class="language-PowerShell">function Send-SMTP {
param (
[Parameter(Mandatory = $True)]$mess
)
$srv_smtp = "smtp.yandex.ru" 
$port = "587"
$from = "login1@yandex.ru" 
$to = "login2@yandex.ru" 
$user = "login1"
$pass = "password"
$subject = "Service status on Host: $hostname"
$Message = New-Object System.Net.Mail.MailMessage
$Message.From = $from
$Message.To.Add($to) 
$Message.Subject = $subject 
$Message.IsBodyHTML = $true 
$Message.Body = "&lt;h1&gt; $mess &lt;/h1&gt;"
$smtp = New-Object Net.Mail.SmtpClient($srv_smtp, $port)
$smtp.EnableSSL = $true 
$smtp.Credentials = New-Object System.Net.NetworkCredential($user, $pass);
$smtp.Send($Message) 
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Send-SMTP $(Get-Service)</code></p>

<h1 id="hyper-v">Hyper-V</h1>

<p><code class="language-plaintext highlighter-rouge">Install-WindowsFeature -Name Hyper-V -IncludeManagementTools -Restart</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å –Ω–∞ Windows Server <br />
<code class="language-plaintext highlighter-rouge">Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V ‚ÄìAll</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å –Ω–∞  Windows Desktop <br />
<code class="language-plaintext highlighter-rouge">Get-Command -Module hyper-v</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VMHost</code></p>
<pre><code class="language-PowerShell">New-VMSwitch -name NAT -SwitchType Internal # —Å–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä –∏ –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è –Ω–µ–≥–æ
Get-NetAdapter | where InterfaceDescription -match Hyper-V # —Å–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–≤—ã—Ö –∞–¥–∞–ø—Ç–µ—Ä–æ–≤
New-NetNat -Name LocalNat -InternalIPInterfaceAddressPrefix "192.168.3.0/24" # –∑–∞–¥–∞—Ç—å —Å–µ—Ç—å
Get-NetAdapter "vEthernet (NAT)" | New-NetIPAddress -IPAddress 192.168.3.200 -AddressFamily IPv4 -PrefixLength 24 # –ø—Ä–∏—Å–≤–æ–∏—Ç—å –∞–¥—Ä–µ—Å, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞ –í–ú —É–∫–∞–∑–∞—Ç—å —à–ª—é–∑ 192.168.3.200, —á—Ç–æ –±—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –∑–∞ NAT, –∏–ª–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –í–ú —É–∫–∞–∑–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∞–¥–∞–ø—Ç–µ—Ä
Add-NetNatStaticMapping -NatName LocalNat -Protocol TCP -ExternalIPAddress 0.0.0.0 -ExternalPort 2222 -InternalIPAddress 192.168.3.103 -InternalPort 2121 # –ø—Ä–æ–±—Ä–æ—Å, –≤–µ—Å—Ç —Ç—Ä–∞—Ñ–∏–∫ –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–∞ —Ö–æ—Å—Ç Hyper-V TCP/2222, –±—É–¥–µ—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø–æ—Ä—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã –∑–∞ NAT.
(Get-NetAdapter | where Name -match NAT).Status
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Get-NetNatStaticMapping</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø—Ä–æ–±—Ä–æ—Å—ã (NAT) <br />
<code class="language-plaintext highlighter-rouge">Get-NetNat</code> —Å–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–π <br />
<code class="language-plaintext highlighter-rouge">Remove-NetNatStaticMapping -StaticMappingID 0</code> —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–±—Ä–æ—Å <br />
<code class="language-plaintext highlighter-rouge">Remove-NetNat -Name LocalNat</code> —É–¥–∞–ª–∏—Ç—å —Å–µ—Ç—å</p>

<p><code class="language-plaintext highlighter-rouge">New-VMSwitch -Name Local -AllowManagementOS $True -NetAdapterName "Ethernet 4" -SwitchType External</code> —Å–æ–∑–¥–∞—Ç—å –≤—à–µ–Ω–∏–π (External) –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä <br />
<code class="language-plaintext highlighter-rouge">$VMName = "hv-dc-01"</code></p>
<pre><code class="language-PowerShell">$VM = @{
Name = $VMName
MemoryStartupBytes = 4Gb
Generation = 2
NewVHDPath = "D:\VM\$VMName\$VMName.vhdx"
NewVHDSizeBytes = 50Gb
BootDevice = "VHD"
Path = "D:\VM\$VMName"
SwitchName = "NAT"
}
New-VM @VM
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Set-VMDvdDrive -VMName $VMName -Path "C:\Users\Lifailon\Documents\WS-2016.iso"</code> <br />
<code class="language-plaintext highlighter-rouge">New-VHD -Path "D:\VM\$VMName\disk_d.vhdx" -SizeBytes 10GB</code> —Å–æ–∑–¥–∞—Ç—å VHDX –¥–∏—Å–∫ <br />
<code class="language-plaintext highlighter-rouge">Add-VMHardDiskDrive -VMName $VMName -Path "D:\VM\$VMName\disk_d.vhdx"</code> –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∏—Å–∫ <br />
<code class="language-plaintext highlighter-rouge">Get-VM ‚ÄìVMname $VMName | Set-VM ‚ÄìAutomaticStartAction Start</code> –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ <br />
<code class="language-plaintext highlighter-rouge">Get-VM -Name $VMName | Set-VMMemory -StartupBytes 8Gb</code> <br />
<code class="language-plaintext highlighter-rouge">Set-VMProcessor $VMName -Count 2</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VM -Name $VMName | Checkpoint-VM -SnapshotName "Snapshot-1"</code> <br />
<code class="language-plaintext highlighter-rouge">Restore-VMCheckpoint -Name Snapshot-1" -VMName $VMName -Confirm:$false</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VM | Select -ExpandProperty NetworkAdapters | Select VMName,IPAddresses,Status</code> –ø–æ–ª—É—á–∏—Ç—å IP –∞–¥—Ä–µ—Å –≤—Å–µ—Ö –í–ú <br />
<code class="language-plaintext highlighter-rouge">vmconnect.exe localhost $VMHost</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-NetTCPConnection -State Established,Listen | Where-Object LocalPort -Match 2179</code> –Ω–∞–π—Ç–∏ –ø–æ—Ä—Ç —Å–ª—É—à–∞—Ç–µ–ª—è 
<code class="language-plaintext highlighter-rouge">Get-Process -Id (Get-NetTCPConnection -State Established,Listen | Where-Object LocalPort -Match 2179).OwningProcess</code> –Ω–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ ID (vmms/VMConnect) <br />
<code class="language-plaintext highlighter-rouge">New-NetFirewallRule -Name "Hyper-V" -DisplayName "Hyper-V" -Group "Hyper-V" -Direction Inbound -Protocol TCP -LocalPort 2179 -Action Allow -Profile Public</code> <br />
<code class="language-plaintext highlighter-rouge">Get-LocalGroupMember -Group "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã Hyper-V"</code> –∏–ª–∏ ‚ÄúHyper-V Administrators‚Äù <br />
<code class="language-plaintext highlighter-rouge">Add-LocalGroupMember -Group "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã Hyper-V" -Member "lifailon"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VM * | select name,ID</code> –¥–æ–±–∞–≤–∏—Ç—å id –≤ RDCMan –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Grant-VMConnectAccess -ComputerName plex-01 -VMName hv-devops-01 -UserName lifailon</code> –¥–∞—Ç—å –¥–æ—Å—Ç—É–ø –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É <br />
<code class="language-plaintext highlighter-rouge">Grant-VMConnectAccess -ComputerName huawei-book -VMName hv-devops-01 -UserName lifailon</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VMConnectAccess</code> <br />
<code class="language-plaintext highlighter-rouge">Revoke-VMConnectAccess -VMName hv-devops-01 -UserName lifailon</code></p>

<p>Error: <code class="language-plaintext highlighter-rouge">Unknown disconnection reason 3848</code> - –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á–∏ —Ä–µ–µ—Å—Ç—Ä–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞</p>
<pre><code class="language-PowerShell">New-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowFreshCredentialsDomain -Name Hyper-V -PropertyType String -Value "Microsoft Virtual Console Service/*" -Force
New-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowDefaultCredentials -Name Hyper-V -PropertyType String -Value "Microsoft Virtual Console Service/*" -Force
New-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowFreshCredentialsWhenNTLMOnlyDomain -Name Hyper-V -PropertyType String -Value "Microsoft Virtual Console Service/*" -Force
ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowDefaultCredentialsDomain -Name Hyper-V -PropertyType String -Value "Microsoft Virtual Console Service/*" -Force
New-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowFreshCredentials -Name Hyper-V -PropertyType String -Value "Microsoft Virtual Console Service/*" -Force
New-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowFreshCredentialsWhenNTLMOnly -Name Hyper-V -PropertyType String -Value "Microsoft Virtual Console Service/*" -Force
New-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowSavedCredentialsWhenNTLMOnly -Name Hyper-V -PropertyType String -Value "Microsoft Virtual Console Service/*" -Force
New-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowSavedCredentials -Name Hyper-V -PropertyType String -Value "Microsoft Virtual Console Service/*" -Force
New-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Credssp\PolicyDefaults\AllowSavedCredentialsDomain -Name Hyper-V -PropertyType String -Value "Microsoft Virtual Console Service/*" -Force
</code></pre>
<h1 id="vmwarepowercli">VMWare/PowerCLI</h1>

<p><code class="language-plaintext highlighter-rouge">Install-Module -Name VMware.PowerCLI # -AllowClobber</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å (PackageProvider: nuget) <br />
<code class="language-plaintext highlighter-rouge">Get-Module -ListAvailable VMware* | Select Name,Version</code> <br />
<code class="language-plaintext highlighter-rouge">Import-Module VMware.VimAutomation.Core</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Å–µ—Å—Å–∏—é <br />
<code class="language-plaintext highlighter-rouge">Get-PSProvider | format-list Name,PSSnapIn,ModuleName</code> —Å–ø–∏—Å–æ–∫ –æ—Å–Ω–∞—Å—Ç–æ–∫ Windows PowerShell</p>

<p><code class="language-plaintext highlighter-rouge">Get-PowerCLIConfiguration</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Set-PowerCLIConfiguration -Scope AllUsers -InvalidCertificateAction ignore -confirm:$false</code> e—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç, –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ InvalidCertificateAction —Å Unset –Ω–∞ Ignore/Warn <br />
<code class="language-plaintext highlighter-rouge">Set-PowerCLIConfiguration -Scope AllUsers -ParticipateInCeip $false</code> –æ—Ç–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ VMware Customer Experience Improvement Program (CEIP)</p>

<p><code class="language-plaintext highlighter-rouge">Read-Host ‚ÄìAsSecureString | ConvertFrom-SecureString | Out-File "$home\Documents\vcsa_password.txt"</code> –∑–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª <br />
<code class="language-plaintext highlighter-rouge">$esxi = "vcsa.domain.local"</code> <br />
<code class="language-plaintext highlighter-rouge">$user = "administrator@vsphere.local"</code> <br />
<code class="language-plaintext highlighter-rouge">$pass = Get-Content "$home\Documents\vcsa_password.txt" | ConvertTo-SecureString</code> –ø—Ä–æ—á–∏—Ç–∞—Ç—å –ø–∞—Ä–æ–ª—å <br />
<code class="language-plaintext highlighter-rouge">$pass = "password"</code> <br />
<code class="language-plaintext highlighter-rouge">$Cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $user ,$pass</code> <br />
<code class="language-plaintext highlighter-rouge">Connect-VIServer $esxi -User $Cred.Username -Password $Cred.GetNetworkCredential().password</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è, –∏—Å–ø–æ–ª—å–∑—É—è PSCredential ($Cred) <br />
<code class="language-plaintext highlighter-rouge">Connect-VIServer $esxi -User $user -Password $pass</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è, –∏—Å–ø–æ–ª—å–∑—É—è –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å</p>

<p><code class="language-plaintext highlighter-rouge">Get-Command ‚ÄìModule *vmware*</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Command ‚ÄìModule *vmware* -name *get*iscsi*</code> <br />
<code class="language-plaintext highlighter-rouge">Get-IScsiHbaTarget</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Datacenter</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Cluster</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VMHost</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VMHost | select Name,Model,ProcessorType,MaxEVCMode,NumCpu,CpuTotalMhz,CpuUsageMhz,MemoryTotalGB,MemoryUsageGB</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VMHostDisk | select VMHost,ScsiLun,TotalSectors</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-Datastore</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Datastore TNAS-vmfs-4tb-01</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Datastore TNAS-vmfs-4tb-01 | get-vm</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Datastore -RelatedObject vm-01</code> <br />
<code class="language-plaintext highlighter-rouge">(Get-Datastore TNAS-vmfs-4tb-01).ExtensionData.Info.GetType()</code> <br />
<code class="language-plaintext highlighter-rouge">(Get-Datastore TNAS-vmfs-4tb-01).ExtensionData.Info.Vmfs.Extent</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-Command ‚ÄìModule *vmware* -name *disk*</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VM vm-01 | Get-Datastore</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VM vm-01 | Get-HardDisk</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VM | Get-HardDisk | select Parent,Name,CapacityGB,StorageFormat,FileName | ft</code> <br />
<code class="language-plaintext highlighter-rouge">Copy-HardDisk</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VM | Get-Snapshot</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VM | where {$_.Powerstate -eq "PoweredOn"}</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VMHost esxi-05 | Get-VM | where {$_.Powerstate -eq "PoweredOff"} | Move-VM ‚ÄìDestination (Get-VMHost esxi-06)</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-VM | select Name,VMHost,PowerState,NumCpu,MemoryGB,</code> <br />
<code class="language-plaintext highlighter-rouge">@{Name="UsedSpaceGB"; Expression={[int32]($_.UsedSpaceGB)}},@{Name="ProvisionedSpaceGB"; Expression={[int32]($_.ProvisionedSpaceGB)}},</code> <br />
<code class="language-plaintext highlighter-rouge">CreateDate,CpuHotAddEnabled,MemoryHotAddEnabled,CpuHotRemoveEnabled,Notes</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-VMGuest vm-01 | Update-Tools</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VMGuest vm-01 | select OSFullName,IPAddress,HostName,State,Disks,Nics,ToolsVersion</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VMGuest * | select -ExpandProperty IPAddress</code> <br />
<code class="language-plaintext highlighter-rouge">Restart-VMGuest -vm vm-01 -Confirm:$False</code> <br />
<code class="language-plaintext highlighter-rouge">Start-VM -vm vm-01 -Confirm:$False</code> <br />
<code class="language-plaintext highlighter-rouge">Shutdown-VMGuest -vm vm-01 -Confirm:$false</code></p>

<p><code class="language-plaintext highlighter-rouge">New-VM ‚ÄìName vm-01 -VMHost esxi-06 ‚ÄìResourcePool Production ‚ÄìDiskGB 60 ‚ÄìDiskStorageFormat Thin ‚ÄìDatastore TNAS-vmfs-4tb-01</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VM vm-01 | Copy-VMGuestFile -Source "\\$srv\Install\Soft\Btest.exe" -Destination "C:\Install\" -LocalToGuest -GuestUser USER -GuestPassword PASS -force</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-VM -name vm-01 | Export-VApp -Destination C:\Install -Format OVF</code> Export template (.ovf, .vmdk, .mf) <br />
<code class="language-plaintext highlighter-rouge">Get-VM -name vm-01 | Export-VApp -Destination C:\Install -Format OVA</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-VMHostNetworkAdapter | select VMHost,Name,Mac,IP,@{Label="Port Group"; Expression={$_.ExtensionData.Portgroup}} | ft</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VM | Get-NetworkAdapter | select Parent,Name,Id,Type,MacAddress,ConnectionState,WakeOnLanEnabled | ft</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-Command ‚ÄìModule *vmware* -name *event*</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VIEvent -MaxSamples 1000 | where {($_.FullFormattedMessage -match "power")} | select username,CreatedTime,FullFormattedMessage</code> <br />
<code class="language-plaintext highlighter-rouge">Get-logtype | select Key,SourceEntityId,Filename,Creator,Info</code> <br />
<code class="language-plaintext highlighter-rouge">(Get-Log vpxd:vpxd.log).Entries | select -Last 50</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-Command ‚ÄìModule *vmware* -name *syslog*</code> <br />
<code class="language-plaintext highlighter-rouge">Set-VMHostSysLogServer -VMHost esxi-05 -SysLogServer "tcp://192.168.3.100" -SysLogServerPort 3515</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VMHostSysLogServer -VMHost esxi-05</code></p>

<h1 id="exchangeemshell">Exchange/EMShell</h1>

<p><code class="language-plaintext highlighter-rouge">$srv_cas = "exchange-cas"</code> <br />
<code class="language-plaintext highlighter-rouge">$session_exchange = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://$srv_cas/PowerShell/</code> -Credential $Cred -Authentication Kerberos <br />
<code class="language-plaintext highlighter-rouge">Get-PSSession</code> <br />
<code class="language-plaintext highlighter-rouge">Import-PSSession $session_exchange -DisableNameChecking</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é</p>

<p><code class="language-plaintext highlighter-rouge">Get-ExchangeServer | select name,serverrole,admindisplayversion,Edition,OriginatingServer,WhenCreated,WhenChanged,DataPath | ft</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤</p>

<p><code class="language-plaintext highlighter-rouge">Get-ImapSettings</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ IMAP <br />
<code class="language-plaintext highlighter-rouge">Get-ExchangeCertificate</code> —Å–ø–∏—Å–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-ExchangeCertificate -Thumbprint "5CEC8544D4743BC279E5FEA1679F79F5BD0C2B3A" | Enable-ExchangeCertificate -Services  IMAP, POP, IIS, SMTP</code> <br />
<code class="language-plaintext highlighter-rouge">iisreset</code> <br />
<code class="language-plaintext highlighter-rouge">Get-ClientAccessService | fl identity, *uri*</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ª—É–∂–±—ã –∞–≤—Ç–æ–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤ Exchange 2016 <br />
<code class="language-plaintext highlighter-rouge">Get-ClientAccessService -Identity $srv | Set-ClientAccessService -AutoDiscoverServiceInternalUri https://mail.domain.ru/Autodiscover/Autodiscover.xml</code> –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –≤–Ω–µ—à–Ω–∏–π –∞–¥—Ä–µ—Å <br />
<code class="language-plaintext highlighter-rouge">Get-OutlookAnywhere</code> OA –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞–º Outlook –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ —Å–≤–æ–∏–º –ø–æ—á—Ç–æ–≤—ã–º —è—â–∏–∫–∞–º –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ (–±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è VPN) <br />
<code class="language-plaintext highlighter-rouge">Get-WebServicesVirtualDirectory</code> <br />
<code class="language-plaintext highlighter-rouge">Get-OwaVirtualDirectory</code> <br />
<code class="language-plaintext highlighter-rouge">Get-ActiveSyncVirtualDirectory</code> <br />
<code class="language-plaintext highlighter-rouge">Get-OabVirtualDirectory</code> –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π –∞–¥—Ä–µ—Å–Ω–æ–π –∫–Ω–∏–≥–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-OabVirtualDirectory -Server $srv | Set-OabVirtualDirectory -InternalUrl "https://mail.domain.ru/OAB" -ExternalUrl "https://mail.domain.ru/OAB"</code></p>

<h3 id="roles">Roles</h3>
<p>MS (Mailbox) - —Å–µ—Ä–≤–µ—Ä —Å –ë–î –ø–æ—á—Ç–æ–≤—ã—Ö —è—â–∏–∫–æ–≤ –∏ –æ–±—â–∏—Ö –ø–∞–ø–æ–∫, –æ—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞ –∏—Ö —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –Ω–∏–∫–∞–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π. <br />
CAS (Client Access Server) - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ø–æ—á—Ç–æ–≤—ã–º —è—â–∏–∫–∞–º, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ Outlook Web Access (HTTP –¥–ª—è Outlook Web App), Outlook Anywhere, ActiveSync (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤), –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª—ã POP3 –∏ IMAP4, MAPI –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ Microsoft Outlook. <br />
Hub Transort - –æ—Ç–≤–µ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π Exchange, –∞ —Ç–∞–∫–∂–µ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏ Exchange. –°–æ–æ–±—â–µ–Ω–∏—è –≤—Å–µ–≥–¥–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ä–æ–ª–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞-–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–æ—Ä–∞, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ—á—Ç–æ–≤—ã—Ö —è—â–∏–∫–æ–≤. <br />
Relay - —Ä–æ–ª—å –ø–æ–≥—Ä–∞–Ω–∏—á–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (—à–ª—é–∑ SMTP –≤ –ø–µ—Ä–∏–º–µ—Ç—Ä–µ —Å–µ—Ç–∏).</p>

<p>SCP (Service Connection Point) - –∑–∞–ø–∏—Å—å –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ AD, –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ CAS. Outlook –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç SCP, –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Å–∞–π—Ç–µ —Å –Ω–∏–º –∏ –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—É WhenCreated ‚Äì –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è, –≤—ã–±–∏—Ä–∞—è —Å–∞–º—ã–π —Å—Ç–∞—Ä—ã–π. <br />
Autodiscover. Outlook –≤—ã–±–∏—Ä–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–µ—Ä–≤–µ—Ä–∞ Client Access —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–ø–∏—Å–∞–Ω –≤ –∞—Ç—Ä–∏–±—É—Ç–µ RPCClientAccessServer –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–≤–µ–¥–µ–Ω–∏—è –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–µ—Ä–≤–µ—Ä–µ mailbox, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∞ –ª–µ–∂–∏—Ç, –±–µ—Ä—É—Ç—Å—è –∏–∑ AD.</p>

<h3 id="messagetrackinglog">MessageTrackingLog</h3>
<p><code class="language-plaintext highlighter-rouge">Get-MessageTrackingLog -ResultSize Unlimited | select Timestamp,Sender,Recipients,RecipientCount,MessageSubject,Source,EventID,ClientHostname,ServerHostname,ConnectorId, @{Name="MessageSize"; Expression={[string]([int]($_.TotalBytes / 1024))+" KB"}},@{Name="MessageLatency"; Expression={$_.MessageLatency -replace "\.\d+$"}}</code> <br />
<code class="language-plaintext highlighter-rouge">Get-MessageTrackingLog -Start (Get-Date).AddHours(-24) -ResultSize Unlimited | where {[string]$_.recipients -like "*@yandex.ru"}</code> –≤—ã–≤–µ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞, –≥–¥–µ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–º –±—ã–ª —É–∫–∞–∑–∞–Ω–Ω—ã–π –¥–æ–º–µ–Ω <br />
-Start ‚Äú04/01/2023 09:00:00‚Äù -End ‚Äú04/01/2023 18:00:00‚Äù - –ø–æ–∏—Å–∫ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø—Ä–æ–º–µ–∂—É—Ç–∫—É –≤—Ä–µ–º–µ–Ω–∏ <br />
-MessageSubject ‚Äú–¢–µ—Å—Ç‚Äù - –ø–æ–∏—Å–∫ –ø–æ —Ç–µ–º–µ –ø–∏—Å—å–º–∞ <br />
-Recipients ‚Äúsupport4@domain.ru‚Äù - –ø–æ–∏—Å–∫ –ø–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—é <br />
-Sender - –ø–æ–∏—Å–∫ –ø–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—é <br />
-EventID ‚Äì –ø–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É —Å–æ–±—ã—Ç–∏—è —Å–µ—Ä–≤–µ—Ä–∞ (RECEIVE, SEND, FAIL, DSN, DELIVER, BADMAIL, RESOLVE, EXPAND, REDIRECT, TRANSFER, SUBMIT, POISONMESSAGE, DEFER) <br />
-Server ‚Äì –ø–æ–∏—Å–∫ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ <br />
-messageID ‚Äì —Ç—Ä–µ–∫–∏–Ω–≥ –ø–∏—Å—å–º–∞ –ø–æ –µ–≥–æ ID</p>

<h3 id="mailbox">Mailbox</h3>
<p><code class="language-plaintext highlighter-rouge">Get-Mailbox -Database "it2"</code> —Å–ø–∏—Å–æ–∫ –ø–æ—á—Ç–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö <br />
<code class="language-plaintext highlighter-rouge">Get-Mailbox -resultsize unlimited | ? Emailaddresses -like "support4" | format-list name,emailaddresses,database,servername</code> –∫–∞–∫—É—é –ë–î, —Å–µ—Ä–≤–µ—Ä –∏ smtp-–∞–¥—Ä–µ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ <br />
<code class="language-plaintext highlighter-rouge">Get-Mailbox -Database $db_name -Archive</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∞—Ä—Ö–∏–≤–Ω—ã–µ –ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏</p>

<p><code class="language-plaintext highlighter-rouge">Get-MailboxFolderStatistics -Identity "support4" -FolderScope All | select Name,ItemsInFolder,FolderSize</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–æ–ª-–≤–æ –ø–∏—Å–µ–º –∏ —Ä–∞–∑–º–µ—Ä –≤ –∫–∞–∂–¥–æ–π –ø–∞–ø–∫–µ <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxStatistics "support4" | select DisplayName,LastLoggedOnUserAccount,LastLogonTime,LastLogoffTime,ItemCount,TotalItemSize,DeletedItemCount,TotalDeletedItemSize,Database,ServerName</code> –æ–±—â–µ–µ –∫–æ–ª-–≤–æ –ø–∏—Å–µ–º, –∏—Ö —Ä–∞–∑–º–µ—Ä, –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞ –∏ –≤—ã—Ö–æ–¥–∞, –∏–º—è —Å–µ—Ä–≤–µ—Ä–∞ –∏ –ë–î <br />
<code class="language-plaintext highlighter-rouge">Get-Mailbox -Server s2 | Get-MailboxStatistics | where {$_.Lastlogontime -lt (get-date).AddDays(-30)} | Sort Lastlogontime -desc | ft displayname,Lastlogontime,totalitemsize</code> —è—â–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å 30 –∏ –±–æ–ª–µ–µ –¥–Ω–µ–π</p>

<p><code class="language-plaintext highlighter-rouge">Enable-Mailbox -Identity support9 -Database test_base</code> —Å–æ–∑–¥–∞—Ç—å –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ AD <br />
<code class="language-plaintext highlighter-rouge">New-Mailbox -Name $login -UserPrincipalName "$login@$domain" -Database $select_db -OrganizationalUnit $path -Password (ConvertTo-SecureString -String "$password" -AsPlainText -Force)</code> —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é AD <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxDatabase -Database $db_name | Remove-MailboxDatabase</code> —É–¥–∞–ª–∏—Ç—å –ë–î</p>

<p><code class="language-plaintext highlighter-rouge">Set-MailBox "support4" -PrimarySmtpAddress support24@domain.ru -EmailAddressPolicyEnabled $false</code> –¥–æ–±–∞–≤–∏—Ç—å –∏ –∏–∑–º–µ–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π SMTP-–∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">Set-Mailbox -Identity "support4" -DeliverToMailboxAndForward $true -ForwardingSMTPAddress "username@outlook.com"</code> –≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—é –ø–æ—á—Ç—ã (—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è support4 –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É username@outlook.com)</p>

<h3 id="moverequest">MoveRequest</h3>
<p><code class="language-plaintext highlighter-rouge">Get-Mailbox -Database $db_in | New-MoveRequest -TargetDatabase $db_out</code> –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤—Å–µ –ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏ –∏–∑ –æ–¥–Ω–æ–π –ë–î –≤ –¥—Ä—É–≥—É—é <br />
<code class="language-plaintext highlighter-rouge">New-MoveRequest -Identity $db_in -TargetDatabase $db_out</code> –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –æ–¥–∏–Ω –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ <br />
<code class="language-plaintext highlighter-rouge">Get-MoveRequest | Suspend-MoveRequest</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Get-MoveRequest | Remove-MoveRequest</code> —É–¥–∞–ª–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">Get-MoveRequest | Get-MoveRequestStatistics</code> —Å—Ç–∞—Ç—É—Å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è</p>

<p>Status: <br />
Cleanup - –Ω—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å <br />
Queued - –≤ –æ—á–µ—Ä–µ–¥–∏ <br />
InProgress - –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ <br />
Percent Complete - –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è <br />
CompletionInProgress - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ <br />
Completed - –∑–∞–≤–µ—Ä—à–µ–Ω–æ</p>

<p><code class="language-plaintext highlighter-rouge">Remove-MoveRequest -Identity $db_name</code> –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è (—É–±—Ä–∞—Ç—å —Å—Ç–∞—Ç—É—Å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —Å –ø–æ—á—Ç–æ–≤–æ–≥–æ —è—â–∏–∫–∞ –∏ –æ—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π) <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxDatabase | Select Name, MailboxRetention</code> –ø–æ—Å–ª–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —è—â–∏–∫–æ–≤, —Ä–∞–∑–º–µ—Ä –±–∞–∑—ã –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è, –ø–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –±–∞–∑—ã –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, –∫–∞–∫ –ø—Ä–æ–π–¥–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π, –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–µ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ MailboxRetention <br />
<code class="language-plaintext highlighter-rouge">Set-MailboxDatabase -MailboxRetention '0.00:00:00' -Identity $db_name</code> –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ</p>

<h3 id="archive">Archive</h3>
<p><code class="language-plaintext highlighter-rouge">Enable-Mailbox -Identity $name -Archive</code> –≤–∫–ª—é—á–∏—Ç—å –∞—Ä—Ö–∏–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">Get-Mailbox $name | New-MoveReques ‚ÄìArchiveOnly ‚ÄìArchiveTargetDatabase DBArch</code> –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∞—Ä—Ö–∏–≤–Ω—ã–π –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ –≤ –¥—Ä—É–≥—É—é –ë–î <br />
<code class="language-plaintext highlighter-rouge">Get-Mailbox $name | fl Name,Database,ArchiveDatabase</code> –º–µ—Å—Ç–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –ë–î –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ë–î –µ–≥–æ –∞—Ä—Ö–∏–≤–∞ <br />
<code class="language-plaintext highlighter-rouge">Disable-Mailbox -Identity $name -Archive</code> –æ—Ç–∫–ª—é—á–∏—Ç—å –∞—Ä—Ö–∏–≤ <br />
<code class="language-plaintext highlighter-rouge">Connect-Mailbox -Identity "8734c04e-981e-4ccf-a547-1c1ac7ebf3e2" -Archive -User $name -Database it2</code> –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø–æ—á—Ç–æ–≤–æ–º—É —è—â–∏–∫—É <br />
<code class="language-plaintext highlighter-rouge">Get-Mailbox $name | Set-Mailbox -ArchiveQuota 20GB -ArchiveWarningQuota 19GB</code> –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–≤–æ—Ç—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –∞—Ä—Ö–∏–≤–∞</p>

<h3 id="quota">Quota</h3>
<p><code class="language-plaintext highlighter-rouge">Get-Mailbox -Identity $mailbox | fl IssueWarningQuota, ProhibitSendQuota, ProhibitSendReceiveQuota, UseDatabaseQuotaDefaults</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–≤–æ—Ç—ã –ø–æ—á—Ç–æ–≤–æ–≥–æ —è—â–∏–∫–∞ <br />
IssueWarningQuota ‚Äî –∫–≤–æ—Ç–∞, –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –∫–æ—Ç–æ—Ä–æ–π Exchange –æ—Ç–ø—Ä–∞–≤–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ <br />
ProhibitSendQuota ‚Äî –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –±—É–¥–µ—Ç –∑–∞–ø—Ä–µ—â–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ <br />
ProhibitSendReceiveQuota ‚Äî –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –±—É–¥–µ—Ç –∑–∞–ø—Ä–µ—â–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ <br />
UseDatabaseQuotaDefaults ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –∫–≤–æ—Ç–∞ –ë–î –∏–ª–∏ false - –∏–Ω–¥–≤–∏–¥–∏—É–∞–ª—å–Ω—ã–µ <br />
<code class="language-plaintext highlighter-rouge">Set-Mailbox -Identity $mailbox -UseDatabaseQuotaDefaults $false -IssueWarningQuota "3 GB" -ProhibitSendQuota "4 GB" -ProhibitSendReceiveQuota "5 GB"</code> –∑–∞–¥–∞—Ç—å –∫–≤–æ—Ç—É –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>

<p><code class="language-plaintext highlighter-rouge">Get-MailboxDatabase $db_name | fl Name, *Quota</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–≤–æ—Ç—ã –Ω–∞–ª–æ–∂–µ–Ω–Ω—ã–µ –Ω–∞ –ë–î <br />
<code class="language-plaintext highlighter-rouge">Set-MailboxDatabase $db -ProhibitSendReceiveQuota "5 GB" -ProhibitSendQuota "4 GB" -IssueWarningQuota "3 GB"</code> –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–≤–æ—Ç—ã –Ω–∞ –ë–î</p>

<h3 id="database">Database</h3>
<p><code class="language-plaintext highlighter-rouge">Get-MailboxDatabase -Status | select ServerName,Name,DatabaseSize</code> —Å–ø–∏—Å–æ–∫ –∏ —Ä–∞–∑–º–µ—Ä –≤—Å–µ—Ö –ë–î –Ω–∞ –≤—Å–µ—Ö MX-—Å–µ—Ä–≤–µ—Ä–∞—Ö <br />
<code class="language-plaintext highlighter-rouge">New-MailboxDatabase -Name it_2022 -EdbFilePath E:\Bases\it_2022\it_2022.edb -LogFolderPath G:\Logs\it_2022 -OfflineAddressBook "Default Offline Address List" -server exch-mx-01</code> —Å–æ–∑–¥–∞—Ç—å –ë–î <br />
<code class="language-plaintext highlighter-rouge">Restart-Service MSExchangeIS</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Service | Where {$_ -match "exchange"} | Restart-Service</code> <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxDatabase -Server exch-01</code> —Å–ø–∏—Å–æ–∫ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ MX-—Å–µ—Ä–≤–µ—Ä–µ <br />
<code class="language-plaintext highlighter-rouge">New-MoveRequest -Identity "support4" -TargetDatabase it_2022</code> –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ –≤ –Ω–æ–≤—É—é –ë–î <br />
<code class="language-plaintext highlighter-rouge">Move-Databasepath $db_name ‚ÄìEdbFilepath "F:\DB\$db_name\$db_name.edb" ‚ÄìLogFolderpath "E:\DB\$db_name\logs\"</code> –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ë–î –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –ª–æ–≥–∏ –Ω–∞ –¥—Ä—É–≥–æ–π –¥–∏—Å–∫ <br />
<code class="language-plaintext highlighter-rouge">Set-MailboxDatabase -CircularLoggingEnabled $true -Identity $db_name</code> –≤–∫–ª—é—á–∏—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –≤–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ (Circular Logging), –≥–¥–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø–∏—à—É—Ç—Å—è 4 —Ñ–∞–π–ª–∞ –ª–æ–≥–æ–≤ –ø–æ 5 –ú–ë, –ø–æ—Å–ª–µ —á–µ–≥–æ –ø–µ—Ä–≤—ã–π –ª–æ–≥-—Ñ–∞–π–ª –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è <br />
<code class="language-plaintext highlighter-rouge">Set-MailboxDatabase -CircularLoggingEnabled $false -Identity $db_name</code> –æ—Ç–∫–ª—é—á–∏—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –≤–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxDatabase -Server "exch-mx-01" -Status | select EdbFilePath,LogFolderPath,LogFilePrefix</code> –ø—É—Ç—å –∫ –ë–î, –ª–æ–≥–∞–º, –∏–º—è —Ç–µ–∫—É—â–µ–≥–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥-—Ñ–∞–π–ª–∞</p>

<h3 id="mailboxrepairrequest">MailboxRepairRequest</h3>
<p><code class="language-plaintext highlighter-rouge">New-MailboxRepairRequest -Database it2 -CorruptionType ProvisionedFolder, SearchFolder, AggregateCounts, Folderview</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç (–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –æ–¥–∏–Ω –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫) –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxRepairRequest -Database it2</code> –ø—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è <br />
–ü–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø—Ä–∞–≤–∏—Ç—å: <br />
ProvisionedFolder ‚Äì –Ω–∞—Ä—É—à–µ–Ω–∏—è –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–ø–æ–∫ <br />
SearchFolder ‚Äì –æ—à–∏–±–∫–∏ –≤ –ø–∞–ø–∫–∞—Ö –ø–æ–∏—Å–∫–∞ <br />
AggregateCounts ‚Äì –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ø–∞–ø–∫–∞—Ö –∏ –∏—Ö —Ä–∞–∑–º–µ—Ä–µ <br />
FolderView ‚Äì –Ω–µ–≤–µ—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º–∏ –ø–∞–ø–æ–∫</p>

<h3 id="eseutil">eseutil</h3>
<p>–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ/–ø–æ–ª—É—á–µ–Ω–∏–∏ –ª—é–±–æ–≥–æ –ø–∏—Å—å–º–∞ Exchange —Å–Ω–∞—á–∞–ª–∞ –≤–Ω–æ—Å–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–π –ª–æ–≥, –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –†–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ –ª–æ–≥ —Ñ–∞–π–ª–∞ - 1 –ú–±. –ï—Å—Ç—å —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞ —É—Ä–µ–∑–∞–Ω–∏—è –ª–æ–≥–æ–≤: DAG, Backup –Ω–∞ –±–∞–∑–µ Volume Shadow Copy, Circular Logging.</p>

<p>–†—É—á–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: <br />
<code class="language-plaintext highlighter-rouge">cd E:\MS_Exchange_2010\MailBox\Reg_v1_MailBoxes\</code> –ø–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥ —Å –ª–æ–≥–∞–º–∏ <br />
<code class="language-plaintext highlighter-rouge">ls E*.chk</code> —É–∑–Ω–∞—Ç—å –∏–º—è —Ñ–∞–π–ª–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∂—É—Ä–Ω–∞–ª–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">eseutil /mk .\E18.chk</code> —É–∑–Ω–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ñ–∞–π–ª –∂—É—Ä–Ω–∞–ª–∞, –¥–µ–π—Å—Ç–≤–∏—è –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –±—ã–ª–∏ –∑–∞–Ω–µ—Å–µ–Ω—ã –≤ –ë–î Exchange <br />
<code class="language-plaintext highlighter-rouge">Checkpoint: (0x561299,8,16)</code> 561299 –∏–º—è —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–º –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω (–µ–≥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —É–∂–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö) <br />
–ù–∞—Ö–æ–¥–∏–º –≤ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–µ —Ñ–∞–π–ª E0500561299.txt, –º–æ–∂–Ω–æ —É–¥–∞–ª—è—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –∂—É—Ä–Ω–∞–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–∞—Ä—à–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞</p>

<p>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î (–µ—Å–ª–∏ –¥–≤–µ –∫–æ–ø–∏–∏ –ë–î —Å –æ—à–∏–±–∫–æ–π): <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxDatabaseCopyStatus -Identity db_name\* | Format-List Name,Status,ContentIndexState</code> <br />
Status            : FailedAndSuspended <br />
ContentIndexState : Failed <br />
Status            : Dismounted <br />
ContentIndexState : Failed</p>

<p><code class="language-plaintext highlighter-rouge">Get-MailboxDatabase -Server exch-mx-01 -Status | fl Name,EdbFilePath,LogFolderPath</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –±–∞–∑—ã –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ª–æ–≥–æ–≤ <br />
LogFolderPath - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ª–æ–≥–æ–≤ <br />
E18 - –∏–º—è —Ç—Ä–∞–Ω–∫–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –ª–æ–≥–∞ (–∏–∑ –Ω–µ–≥–æ —á–∏—Ç–∞—é—Ç—Å—è –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏) <br />
<code class="language-plaintext highlighter-rouge">dismount-Database db_name</code> –æ—Ç–º–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ë–î <br />
<code class="language-plaintext highlighter-rouge">eseutil /mh D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑—É <br />
State: Dirty Shutdown - –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —á–∞—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ –±–∞–∑—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –±—ã–ª–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∞ –∞–≤–∞—Ä–∏–π–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞. <br />
<code class="language-plaintext highlighter-rouge">eseutil /ml E:\MS_Exchange_2010\MailBox\db_name\E18</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ª–æ–≥–∏, –µ—Å–ª–∏ –µ—Å—Ç—å –ª–æ–≥–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ –æ–Ω–∏ –Ω–µ –∏—Å–ø–æ—Ä—á–µ–Ω—ã, —Ç–æ –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –Ω–∏—Ö, –∏–∑ —Ñ–∞–π–ª–∞ E18 —Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –ª–æ–≥–∏, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç–∞—Ç—É—Å - –û–ö</p>

<p>Soft Recovery (–º—è–≥–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ) - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –±–∞–∑—É –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è (Clear shutdown) –ø—É—Ç–µ–º –∑–∞–ø–∏—Å–∏ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤ –∂—É—Ä–Ω–∞–ª–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –ë–î. <br />
<code class="language-plaintext highlighter-rouge">eseutil /R E18 /l E:\MS_Exchange_2010\MailBox\db_name\ /d D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> <br />
<code class="language-plaintext highlighter-rouge">eseutil /R E18 /a /i /l E:\MS_Exchange_2010\MailBox\db_name\ /d D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> –µ—Å–ª–∏ —Å –ª–æ–≥–∞–º–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫, –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –∏–≥–Ω–æ—Ä–∏—Ä—É—è –æ—à–∏–±–∫—É –≤ –ª–æ–≥–∞—Ö <br />
<code class="language-plaintext highlighter-rouge">eseutil /mk D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> c–æ—Å—Ç–æ—è–Ω–∏–∏ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫ <br />
<code class="language-plaintext highlighter-rouge">eseutil /g D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ë–î <br />
<code class="language-plaintext highlighter-rouge">eseutil /k D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Å—É–º–º –±–∞–∑—ã (CRC)</p>

<p>Hard Recovery - –µ—Å–ª–∏ –ª–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ—à–∏–±–∫–∏ –∏ –±–∞–∑–∞ –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, —Ç–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∞–∑—É –±–µ–∑ –ª–æ–≥–æ–≤. <br />
<code class="language-plaintext highlighter-rouge">eseutil /p D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> <br />
/p - —É–¥–∞–ª–∏—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞ –∏–∑ –ë–î –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å <br />
<code class="language-plaintext highlighter-rouge">esetuil /d D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb</code> –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—é (–µ—Å–ª–∏ –±—ã–ª –ø–æ—Ç–µ—Ä—è–Ω –±–æ–ª—å—à–æ–π –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö, —Ç–æ –º–æ–∂–µ—Ç —Å–∏–ª—å–Ω–æ —Å–Ω–∏–∑–∏—Ç—å—Å—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å) <br />
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—Ä—É—á–Ω—É—é —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º log –≤ –ø–∞–ø–∫–µ MDBDATA, –ø–µ—Ä–µ–¥ –ø–æ–ø—ã—Ç–∫–æ–π —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. <br />
<code class="language-plaintext highlighter-rouge">isinteg -s "db_name.edb" -test alltests</code> –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö <br />
<code class="language-plaintext highlighter-rouge">isinteg -s "server_name" -fix -test -alltests</code> –µ—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –±—É–¥–µ—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω–∞. –í—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—É –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ —É –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ –Ω–µ —Å—Ç–∞–Ω–µ—Ç —Å—Ç–∞—Ç—É—Å 0 –∏–ª–∏ —Å—Ç–∞—Ç—É—Å –Ω–µ –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç –º–µ–Ω—è—Ç—å—Å—è, –∏–Ω–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ 3 –ø—Ä–æ—Ö–æ–¥–∞ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞. <br />
<code class="language-plaintext highlighter-rouge">eseutil /mh D:\MS_Exchange_2010\Mailbox\db_name\db_name.edb | Select-String -Pattern "State:","Log Required:"</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å <br />
State: Clear shutdown - —É—Å–ø–µ—à–Ω—ã–π —Å—Ç–∞—Ç—É—Å <br />
<code class="language-plaintext highlighter-rouge">Log Required</code> —Ç—Ä–µ–±—É—é—Ç—Å—è –ª–∏ —Ñ–∞–π–ª—ã –∂—É—Ä–Ω–∞–ª–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∞–∑–µ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –≤ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –ï—Å–ª–∏ –±–∞–∑–∞ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —Ç–æ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–≤–Ω—è—Ç—å—Å—è 0. <br />
<code class="language-plaintext highlighter-rouge">mount-Database -force db_name</code> –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ë–î <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxDatabase ‚ÄìStatus db_name | fl Mounted</code> —Å—Ç–∞—Ç—É—Å –ë–î <br />
<code class="language-plaintext highlighter-rouge">New-MailboxRepairRequest -Database db_name -CorruptionType SearchFolder,AggregateCounts,ProvisionedFolder,FolderView</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö <br />
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Index. <br />
–ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å—ã –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è, –Ω–æ –ë–î –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —Ç–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏ –≤ –Ω–æ–≤—É—é –ë–î.</p>

<p>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –∏–∑ Backup:</p>

<p>1-–π –≤–∞—Ä–∏–∞–Ω—Ç:</p>
<ol>
  <li>–û—Ç–º–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –ë–î –∏ —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å —Ñ–∞–π–ª–∞–º–∏ —Ç–µ–∫—É—â–µ–π –ë–î.</li>
  <li>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ —Ç—É –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏–∑ Backup –±–∞–∑—É —Å –ª–æ–≥–∞–º–∏.</li>
  <li>–ó–∞–ø—É—Å—Ç–∏—Ç—å –º—è–≥–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î (Soft Recovery).</li>
  <li>–ü—Ä–∏–º–æ–Ω–∏—Ç–æ—Ä–≤–∞—Ç—å.</li>
</ol>

<p>2-–π –≤–∞—Ä–∏–∞–Ω—Ç:</p>
<ol>
  <li>–û—Ç–º–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å —Ç–µ–∫—É—â—É—é –ë–î.</li>
  <li>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ë–î —Å –ª–æ–≥–∞–º–∏ –∏–∑ Backup –≤ –ª—é–±–æ–µ –º–µ—Å—Ç–æ.</li>
  <li>–ó–∞–ø—É—Å—Ç–∏—Ç—å –º—è–≥–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î (Soft Recovery).</li>
  <li>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ë–î.</li>
  <li>–°–æ–∑–¥–∞—Ç—å Recovery Database –∏ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –Ω–µ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—É—é –∏–∑ –±—ç–∫–∞–ø–∞ –ë–î, —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ –Ω–µ—ë –ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏ –≤ –Ω–æ–≤—É—é –ë–î –∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ –Ω–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</li>
  <li>–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Dial Tone Recovery, —Ç–æ —Ç–∞–∫ –∂–µ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∏–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ë–î –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—á—Ç–æ–≤—ã—Ö —è—â–∏–∫–æ–≤.</li>
</ol>

<p>3-–π –≤–∞—Ä–∏–∞–Ω—Ç:</p>
<ol>
  <li>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å Soft Repair –∏–ª–∏ Hard Recovery.</li>
  <li>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ë–î. –£–∫–∞–∑—ã–≤–∞—Ç—å –≤ —Å–≤–æ–π—Å—Ç–≤–∞—Ö: ¬´–±–∞–∑–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–∞ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏¬ª.</li>
  <li>–ï—Å–ª–∏ –±–∞–∑–∞ –±—ã–ª–∞ —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ–∑–¥–∞–Ω–∞ –∏ –µ—â–µ –Ω–µ –±—ã–ª–∞ –ø–æ–¥–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞, —Ç–æ —ç—Ç–∞ –ø–∞–ø–∫–∞ –±—É–¥–µ—Ç –ø—É—Å—Ç–∞, —Ç—É–¥–∞ –ø–µ—Ä–µ–º–µ—â–∞–µ–º –±–∞–∑—É –∏–∑ Backup, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ ESEUTIL –≤–º–µ—Å—Ç–µ —Å–æ –≤—Å–µ–º–∏ —Ñ–∞–π–ª–∞–º–∏. –£–∫–∞–∑–∞—Ç—å –∏–º—è .edb —Ç–∞–∫–æ–µ –∂–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—ã–ª–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –±–∞–∑—ã.</li>
  <li>–ú–æ–Ω—Ç–∏—Ä—É–µ–º –±–∞–∑—É.</li>
  <li>–ü–µ—Ä–µ–Ω–∞—Ü–µ–ª–∏–≤–∞–µ–º —è—â–∏–∫–∏ —Å–æ —Å—Ç–∞—Ä–æ–π (Mailbox_DB_02), –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ–π –±–∞–∑—ã, –Ω–∞ –Ω–æ–≤—É—é –±–∞–∑—É (Mailbox_DB_02_02):
<code class="language-plaintext highlighter-rouge">Get-Mailbox -Database Mailbox_DB_02 | where {$_.ObjectClass -NotMatch '(SystemAttendantMailbox|ExOleDbSystemMailbox)'} | Set-Mailbox -Database Mailbox_DB_02_02</code></li>
  <li>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö:
<code class="language-plaintext highlighter-rouge">New-MailboxRepairRequest -Database "Mailbox_DB_02_02" -CorruptionType ProvisionedFolder, SearchFolder, AggregateCounts, Folderview</code></li>
</ol>

<h3 id="dial-tone-recovery">Dial Tone Recovery</h3>
<p><code class="language-plaintext highlighter-rouge">Get-Mailbox -Database "MailboxDB" | Set-Mailbox -Database "TempDB"</code> –ø–µ—Ä–µ–Ω–∞—Ü–µ–ª–∏—Ç—å —è—â–∏–∫–∏ —Å –æ–¥–Ω–æ–π –ë–î (–Ω–µ—Ä–∞–±–æ—á–µ–π) –Ω–∞ –¥—Ä—É–≥—É—é (–ø—É—Å—Ç—É—é) <br />
<code class="language-plaintext highlighter-rouge">Get-Mailbox -Database TempDB</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø–æ—á—Ç–æ–≤—ã–µ —è—â–∏–∫–∏ –≤ –ë–î TempDB <br />
<code class="language-plaintext highlighter-rouge">Restart-Service MSExchangeIS</code> –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É Mailbox Information Store (–±–∞–Ω–∫–∞ –¥–∞–Ω–Ω—ã—Ö), –∏–Ω–∞—á–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å—Ç–∞—Ä–æ–π –ë–î <br />
<code class="language-plaintext highlighter-rouge">iisreset</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Mailbox -Database "TempDB" | Set-Mailbox -Database "MailboxDB"</code> –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ä–æ–π –ë–î, –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ë–î –æ–±—Ä–∞—Ç–Ω–æ <br />
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–¥–µ–ª–∞—Ç—å —Å–ª–∏—è–Ω–∏–µ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ë–î —Å –ø–æ–º–æ—â—å—é Recovery.</p>

<h3 id="recovery-database-rdb">Recovery database (RDB)</h3>
<p><code class="language-plaintext highlighter-rouge">New-MailboxDatabase ‚ÄìRecovery ‚ÄìName RecoveryDB ‚ÄìServer $exch_mx ‚ÄìEdbFilePath "D:\TempDB\TempDB.edb" -LogFolderPath "D:\TempDB"</code> –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –Ω–æ–≤—ã—Ö –ø–∏—Å–µ–º –∏–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ë–î –≤ –æ—Å–Ω–æ–≤–Ω—É—é –Ω–µ–æ–±—Ö–æ–¥–∏–º —Ç–æ–ª—å–∫–æ —Å–∞–º —Ñ–∞–π–ª TempDB.edb —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º Clean Shutdown, –∏–∑ –Ω–µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Å–ª—É–∂–µ–±–Ω—É—é –ë–î (–∫–ª—é—á -Recovery) <br />
<code class="language-plaintext highlighter-rouge">Mount-Database "D:\TempDB\TempDB.edb"</code> –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ë–î <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxStatistics -Database RecoveryDB</code> <br />
<code class="language-plaintext highlighter-rouge">New-MailboxRestoreRequest ‚ÄìSourceDatabase RecoveryDB ‚ÄìSourceStoreMailbox support ‚ÄìTargetMailbox support</code> —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ—á—Ç–æ–≤–æ–≥–æ —è—â–∏–∫–∞ —Å DisplayName: support –∏–∑ RecoveryDB –≤ –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ —Å –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–º support —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑—ã. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—â–µ—Ç –≤ –ø–æ—á—Ç–æ–≤–æ–π –±–∞–∑–µ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ LegacyExchangeDN –ª–∏–±–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ X500, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –¥—Ä—É–≥–æ–π —è—â–∏–∫, –Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –∫–ª—é—á -AllowLegacyDNMisMatch <br />
<code class="language-plaintext highlighter-rouge">New-MailboxRestoreRequest ‚ÄìSourceDatabase RecoveryDB ‚ÄìSourceStoreMailbox support ‚ÄìTargetMailbox support ‚ÄìTargetRootFolder "Restore"</code> —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∏—Å—å–º–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ø–∫—É –≤ —è—â–∏–∫–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏), –≤–æ–∑–º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞–ø–∫–∏ -IncludeFolders ‚Äú#Inbox#‚Äù <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxRestoreRequest | Get-MailboxRestoreRequestStatistics</code> —Å—Ç–∞—Ç—É—Å –∑–∞–ø—Ä–æ—Å–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxRestoreRequestStatistics -Identity support</code> <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxRestoreRequest -Status Completed | Remove-MailboxRestoreRequest</code> —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —É—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã</p>

<h3 id="transport">Transport</h3>
<p><code class="language-plaintext highlighter-rouge">Get-TransportServer $srv_cas | select MaxConcurrentMailboxDeliveries,MaxConcurrentMailboxSubmissions,MaxConnectionRatePerMinute,MaxOutboundConnections,MaxPerDomainOutboundConnections,PickupDirectoryMaxMessagesPerMinute</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ <br />
MaxConcurrentMailboxDeliveries ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å–µ–º. <br />
MaxConcurrentMailboxSubmissions ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∏—Å–µ–º. <br />
MaxConnectionRatePerMinute ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤–æ–∑–º–æ–∂–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–∫—Ä—ã—Ç–∏—è –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É. <br />
MaxOutboundConnections ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤–æ–∑–º–æ–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å Exchange –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏. <br />
MaxPerDomainOutboundConnections ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤–æ–∑–º–æ–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å Exchange –¥–ª—è –æ–¥–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞. <br />
PickupDirectoryMaxMessagesPerMinute ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∏—Å–µ–º –ø–æ –ø–∞–ø–∫–∞–º). <br />
<code class="language-plaintext highlighter-rouge">Set-TransportServer exchange-cas -MaxConcurrentMailboxDeliveries 21 -MaxConcurrentMailboxSubmissions 21 -MaxConnectionRatePerMinute 1201 -MaxOutboundConnections 1001 -MaxPerDomainOutboundConnections 21 -PickupDirectoryMaxMessagesPerMinute 101</code> –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è</p>

<p><code class="language-plaintext highlighter-rouge">Get-TransportConfig | select MaxSendSize, MaxReceiveSize</code> –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç—Ä–∞—Å–ø–æ—Ä—Ç–∞ (–Ω–∞–∏–º–µ–Ω—å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, –ø–æ—Å–ª–µ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞ –∏ –ø–æ—á—Ç–æ–≤–æ–≥–æ —è—â–∏–∫–∞). <br />
<code class="language-plaintext highlighter-rouge">New-TransportRule -Name AttachmentLimit -AttachmentSizeOver 15MB -RejectMessageReasonText "Sorry, messages with attachments over 15 MB are not accepted"</code> —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ –≤–ª–æ–∂–µ–Ω–∏—è</p>

<h3 id="connector">Connector</h3>
<p><code class="language-plaintext highlighter-rouge">Get-ReceiveConnector | select Name,MaxMessageSize,RemoteIPRanges,WhenChanged</code> –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∏–∂–µ, —á–µ–º —É –ø–æ—á—Ç–æ–≤–æ–≥–æ —è—â–∏–∫–∞) <br />
<code class="language-plaintext highlighter-rouge">Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MaxMessageSize 30Mb</code> –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä —É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞ –≤ —Å–ø–∏—Å–∫–µ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤—ã—à–µ, —á–µ–º —É —Ç—Ä–∞—Å–ø–æ—Ä—Ç–∞) <br />
<code class="language-plaintext highlighter-rouge">Get-Mailbox "support4" | select MaxSendSize, MaxReceiveSize</code> –Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç <br />
<code class="language-plaintext highlighter-rouge">Set-Mailbox "support4" -MaxSendSize 30MB -MaxReceiveSize 30MB</code> –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä</p>

<p><code class="language-plaintext highlighter-rouge">Set-SendConnector -Identity "ConnectorName" -Port 26</code> –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-SendConnector "proxmox" | select port</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-ReceiveConnector | select Name,MaxRecipientsPerMessage</code> –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é Exchange –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–¥—Ä–µ—Å–∞—Ç–æ–≤ –≤ –æ–¥–Ω–æ–º –ø–∏—Å—å–º–µ (200) <br />
<code class="language-plaintext highlighter-rouge">Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MaxRecipientsPerMessage 50</code> –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">Set-ReceiveConnector ((Get-ReceiveConnector).Identity)[-1] -MessageRateLimit 1000</code> –∑–∞–¥–∞—Ç—å –ª–∏–º–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É –¥–ª—è –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞</p>

<p><code class="language-plaintext highlighter-rouge">Get-OfflineAddressbook | Update-OfflineAddressbook</code> –æ–±–Ω–æ–≤–∏—Ç—å OAB <br />
<code class="language-plaintext highlighter-rouge">Get-ClientAccessServer | Update-FileDistributionService</code></p>

<h3 id="pst">PST</h3>
<p><code class="language-plaintext highlighter-rouge">New-MailboxExportRequest -Mailbox $name -filepath "\\$srv\pst\$name.PST" # -ContentFilter {(Received -lt "01/01/2021")} -Priority Highest/Lower # -IsArchive</code> –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –∏–∑ –∞—Ä—Ö–∏–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">New-MailboxExportRequest -Mailbox $name -IncludeFolders "#Inbox#" -FilePath "\\$srv\pst\$name.PST"</code> —Ç–æ–ª—å–∫–æ –ø–∞–ø–∫—É –≤—Ö–æ–¥—è—â–∏–µ <br />
<code class="language-plaintext highlighter-rouge">New-MailboxImportRequest -Mailbox $name "\\$srv\pst\$name.PST"</code> –∏–º–ø–æ—Ä—Ç –∏–∑ PST <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxExportRequest</code> —Å—Ç–∞—Ç—É—Å –∑–∞–ø—Ä–æ—Å–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxExportRequest -Status Completed | Remove-MailboxExportRequest</code> —É–¥–∞–ª–∏—Ç—å —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã <br />
<code class="language-plaintext highlighter-rouge">Remove-MailboxExportRequest -RequestQueue MBXDB01 -RequestGuid 25e0eaf2-6cc2-4353-b83e-5cb7b72d441f</code> –æ—Ç–º–µ–Ω–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç</p>

<h3 id="distributiongroup">DistributionGroup</h3>
<p><code class="language-plaintext highlighter-rouge">Get-DistributionGroup</code> —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø —Ä–∞—Å—Å—ã–ª–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-DistributionGroupMember "!_–û—Ñ–∏—Å"</code> —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–µ <br />
<code class="language-plaintext highlighter-rouge">Add-DistributionGroupMember -Identity "!_–û—Ñ–∏—Å" -Member "$name@$domain"</code> –¥–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É —Ä–∞—Å—Å—ã–ª–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">Remove-DistributionGroupMember -Identity "!_–û—Ñ–∏—Å" -Member "$name@$domain"</code> <br />
<code class="language-plaintext highlighter-rouge">New-DistributionGroup -Name "!_–¢–µ—Å—Ç" -Members "$name@$domain"</code> —Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É <br />
<code class="language-plaintext highlighter-rouge">Set-DistributionGroup -Identity "support4" -HiddenFromAddressListsEnabled $true (–∏–ª–∏ Set-Mailbox)</code> —Å–∫—Ä—ã—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞ –∞–¥—Ä–µ—Å–æ–≤ Exchange</p>

<h3 id="search">Search</h3>
<p><code class="language-plaintext highlighter-rouge">Search-Mailbox -Identity "support4" -SearchQuery '–¢–µ–º–∞:"Mikrotik DOWN"'</code> –ø–æ–∏—Å–∫ –ø–∏—Å–µ–º –ø–æ —Ç–µ–º–µ <br />
<code class="language-plaintext highlighter-rouge">Search-Mailbox -Identity "support4" -SearchQuery 'Subject:"Mikrotik DOWN"'</code><br />
<code class="language-plaintext highlighter-rouge">Search-Mailbox -Identity "support4" -SearchQuery 'attachment -like:"*.rar"'</code><br />
<code class="language-plaintext highlighter-rouge">Search-Mailbox -Identity "support4" -SearchQuery "–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: &lt; 01/01/2020" -DeleteContent -Force</code> —É–¥–∞–ª–µ–Ω–∏–µ –ø–∏—Å–µ–º –ø–æ –¥–∞—Ç–µ</p>

<p>–§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–µ—Ä–≤–µ—Ä–∞: <br />
<code class="language-plaintext highlighter-rouge">20/07/2018</code> <br />
<code class="language-plaintext highlighter-rouge">07/20/2018</code> <br />
<code class="language-plaintext highlighter-rouge">20-Jul-2018</code> <br />
<code class="language-plaintext highlighter-rouge">20/July/2018</code></p>

<h3 id="auditlog">AuditLog</h3>
<p><code class="language-plaintext highlighter-rouge">Get-AdminAuditLogConfig</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—É–¥–∏—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">Set-Mailbox -Identity "support4" -AuditOwner HardDelete</code> –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ HardDelete –ø–∏—Å–µ–º <br />
<code class="language-plaintext highlighter-rouge">Set-mailbox -identity "support4" -AuditlogAgelimit 120</code> —É–∫–∞–∑–∞—Ç—å –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Get-mailbox -identity "support4" | Format-list Audit*</code> –¥–∞–Ω–Ω—ã–µ –∞—É–¥–∏—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">Search-MailboxAuditLog -Identity "support4" -LogonTypes Delegate -ShowDetails -Start "2022-02-22 18:00" -End "2022-03-22 18:00"</code> –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Search-AdminAuditLog -StartDate "02/20/2022" | ft CmdLetName,Caller,RunDate,ObjectModified -Autosize</code> –ø–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏–π –∏—Å—Ç–æ—Ä–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –≤ –∂—É—Ä–Ω–∞–ª–µ –∞—É–¥–∏—Ç–∞ Exchange</p>

<h3 id="test">Test</h3>
<p><code class="language-plaintext highlighter-rouge">Test-ServiceHealth</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ä–æ–ª–µ–π —Å–µ—Ä–≤–µ—Ä–∞: –ø–æ—á—Ç–æ–≤—ã—Ö —è—â–∏–∫–æ–≤, –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞, –µ–¥–∏–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, —Ç—Ä–∞—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">$mx_srv_list | %{Test-MapiConnectivity -Server $_}</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è MX-—Å–µ—Ä–≤–µ—Ä–æ–≤ –∫ –ë–î <br />
<code class="language-plaintext highlighter-rouge">Test-MAPIConnectivity -Database $db</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ª–æ–≥–∏–Ω–∞ –≤ –±–∞–∑—É <br />
<code class="language-plaintext highlighter-rouge">Test-MAPIConnectivity ‚ÄìIdentity $user@$domain</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ª–æ–≥–∏–Ω–∞ –≤ –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ <br />
<code class="language-plaintext highlighter-rouge">Test-ComputerSecureChannel</code> –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–ª—É–∂–±—ã AD <br />
<code class="language-plaintext highlighter-rouge">Test-MailFlow</code> —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –ø–æ—á—Ç—ã</p>

<h3 id="queue">Queue</h3>
<p><code class="language-plaintext highlighter-rouge">Get-TransportServer | %{Get-Queue -Server $_.Name}</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –æ—á–µ—Ä–µ–¥–∏ –Ω–∞ –≤—Å–µ—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö <br />
<code class="language-plaintext highlighter-rouge">Get-Queue -Identity EXCHANGE-CAS\155530 | Format-List</code> –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—á–µ—Ä–µ–¥–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-Queue -Identity EXCHANGE-CAS\155530 | Get-Message -ResultSize Unlimited | Select FromAddress,Recipients</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ–π (FromAddress) –∏ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –≤ –æ—á–µ—Ä–µ–¥–∏ (Recipients) <br />
<code class="language-plaintext highlighter-rouge">Get-Message -Queue EXCHANGE-CAS\155530</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∏–Ω–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏ (—Å–µ—Ä–≤–µ—Ä\–æ—á–µ—Ä–µ–¥—å\–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–∏—Å—å–º–∞) <br />
<code class="language-plaintext highlighter-rouge">Resume-Message EXCHANGE-CAS\155530\444010</code> –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –ø–∏—Å—å–º–∞ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ <br />
<code class="language-plaintext highlighter-rouge">Retry-Queue -Filter {Status -eq "Retry"}</code> –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π c —Å—Ç–∞—Ç—É—Å–æ–º ‚Äú–ü–æ–≤—Ç–æ—Ä–∏—Ç—å‚Äù <br />
<code class="language-plaintext highlighter-rouge">Get-Queue -Identity EXCHANGE-CAS\155530 | Get-Message -ResultSize unlimited | Remove-Message -WithNDR $False</code> –æ—á–∏—Å—Ç–∏—Ç—å –æ—á–µ—Ä–µ–¥—å <br />
<code class="language-plaintext highlighter-rouge">Get-transportserver EXCHANGE-CAS | Select MessageExpirationTimeout</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ—á–µ—Ä–µ–¥–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, 2 –¥–Ω—è)</p>

<p>Error Exchange 452 4.3.1 Insufficient system resources - –æ–∫–æ–Ω—á–∞–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥—è—Ç—Å—è –æ—á–µ—Ä–µ–¥–∏ —Å–ª—É–∂–±—ã Exchange Hub Transport, –∑–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Ç–≤–µ—á–∞–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ Back Pressure, –∫–æ—Ç–æ—Ä—ã–π –≤ —Ç–æ–º —á–∏—Å–ª–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ <br />
–ü–æ—Ä–æ–≥ Medium (90%) ‚Äî –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–æ SMTP –ø–æ—á—Ç—É –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ–π (–ø–æ—á—Ç–∞ –æ—Ç MAPI –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏ —ç—Ç–æ–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è) <br />
–ü–æ—Ä–æ–≥ High (99%) ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–∞ –ø–æ—á—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç—Å—è <br />
–†–µ—à–µ–Ω–∏–µ: –æ—á–∏—Å—Ç–∏—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä –ª–æ–≥–∏ IIS (C:\inetpub\logs\LogFiles\W3SVC1), —É–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä –¥–∏—Å–∫–∞, –æ—Ç–∫–ª—é—á–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Back Pressure (–ø–ª–æ—Ö–æ–π –≤–∞—Ä–∏–∞–Ω—Ç) –∏–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ –æ—á–µ—Ä–µ–¥—å –Ω–∞ –¥—Ä—É–≥–æ–π –¥–∏—Å–∫ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –æ–±—ä—ë–º–∞.</p>

<p><code class="language-plaintext highlighter-rouge">Get-Service | ? name -like "MSExchangeTransport" | Stop-Service</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂—É –æ—á–µ—Ä–µ–¥–∏ <br />
<code class="language-plaintext highlighter-rouge">Rename-Item "C:\Program Files\Microsoft\Exchange Server\V15\TransportRoles\data\Queue" "C:\Program Files\Microsoft\Exchange Server\V15\TransportRoles\data\Queue_old"</code> –æ—á–∏—Å—Ç–∏—Ç—å –±–∞–∑—É –æ—á–µ—Ä–µ–¥–∏ <br />
<code class="language-plaintext highlighter-rouge">C:\Program Files\Microsoft\Exchange Server\V15\Bin\EdgeTransport.exe.config</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—É—Ç—å –∫ –±–¥ —Å –æ—á–µ—Ä–µ–¥—å—é (–±–ª–æ–∫ <appSettings> –∫–ª—é—á–∏ <add key="QueueDatabasePath" value="$new_path"></add> –∏ QueueDatabaseLoggingPath) \
–î–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –ë–î, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Mail.que –∏ Trn.chk (–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥–∞—Ö) –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –≤ –Ω–æ–≤–æ–µ. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π Trn.log, Trntmp.log, Trn nnnn.log , Trnres00001.jrs, Trnres00002.jrs –∏ Temp.edb –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –≤ –Ω–æ–≤–æ–µ. tmp.edb ‚Äî –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ö–µ–º—ã —Å–∞–º–æ–π –±–∞–∑—ã, –ø–µ—Ä–µ–Ω–æ—Å—Ç–∏ –Ω–µ –Ω—É–∂–Ω–æ. \
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–ª—É–∂–±—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –æ—á–µ—Ä–µ–¥–∏ –∏ —Ñ–∞–π–ª—ã –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è.</appSettings></p>

<h3 id="defrag">Defrag</h3>
<p><code class="language-plaintext highlighter-rouge">Get-MailboxDatabase -Status | ft Name, DatabaseSize, AvailableNewMailboxSpace</code> <br />
DatabaseSize - —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä –±–∞–∑—ã <br />
AvailableNewMailboxSpace - –æ–±—ä—ë–º –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü, –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –ø—Ä–∏ –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ <br />
(DatabaseSize ‚Äî AvailableNewMailboxSpace) x 1,1 - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏–º–µ—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–µ –º–µ–Ω–µ–µ 110% –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–∞–∑—ã (–±–µ–∑ —É—á–µ—Ç–∞ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü) <br />
<code class="language-plaintext highlighter-rouge">cd $path</code> <br />
<code class="language-plaintext highlighter-rouge">Dismount-Database "$path\$db_name"</code> –æ—Ç–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ë–î <br />
<code class="language-plaintext highlighter-rouge">eseutil /d "$path\$db_name.edb"</code> <br />
<code class="language-plaintext highlighter-rouge">Mount-Database "$path\$db"</code> –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ë–î</p>

<h3 id="dag-database-availability-group">DAG (Database Availability Group)</h3>
<p><code class="language-plaintext highlighter-rouge">Install-WindowsFeature -Name Failover-Clustering -ComputerName EXCH-MX-01</code> –æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ Windows Server Failover Cluster <br />
<code class="language-plaintext highlighter-rouge">New-DatabaseAvailabilityGroup -Name dag-01 -WitnessServer fs-05 -WitnessDirectory C:\witness_exchange1</code> —Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤–æ–≥–æ —Å–≤–∏–¥–µ—Ç–µ–ª—è –¥–ª—è –∫–≤–æ—Ä—É–º–∞ <br />
Quorum - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è, –≤ –∫–æ—Ç–æ—Ä–æ–º –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è –Ω—É–∂–Ω–æ –∏–º–µ—Ç—å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≥–æ–ª–æ—Å–æ–≤, —á—Ç–æ –±—ã —Å–¥–µ–ª–∞—Ç—å —Ç–µ–∫—É—â—É—é –∫–æ–ø–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ–π. <br />
WitnessDirectory ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞-—Å–≤–∏–¥–µ—Ç–µ–ª—è. <br />
<code class="language-plaintext highlighter-rouge">Set-DatabaseAvailabilityGroup dag-01 ‚ÄìDatabaseAvailabilityGroupIPAdress $ip</code> –∏–∑–º–µ–Ω–∏—Ç—å ip-–∞–¥—Ä–µ—Å –≥—Ä—É–ø–ø—ã <br />
<code class="language-plaintext highlighter-rouge">Get-DatabaseAvailabilityGroup</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≥—Ä—É–ø–ø <br />
<code class="language-plaintext highlighter-rouge">Get-DatabaseAvailabilityGroup -Identity dag-01</code> <br />
<code class="language-plaintext highlighter-rouge">Add-DatabaseAvailabilityGroupServer -Identity dag-01 -MailboxServer EXCH-MX-01</code> –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π —Å–µ—Ä–≤–µ—Ä (–≤—Å–µ –ë–î –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö –≤ DAG –¥–æ–ª–∂–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –ø–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º—É –ø—É—Ç–∏) <br />
<code class="language-plaintext highlighter-rouge">Add-MailboxDatabaseCopy -Identity db_name -MailboxServer EXCH-MX-04</code> –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–ø–∏—é –ë–î <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxDatabaseCopyStatus -Identity db_name\* | select Name,Status,LastInspectedLogTime</code> —Å—Ç–∞—Ç—É—Å –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫–∏–π</p>

<p>Status: <br />
Mounted - —Ä–∞–±–æ—á–∞—è –±–∞–∑–∞ <br />
Suspended - –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ <br />
Healthy - —Ä–∞–±–æ—á–∞—è –ø–∞—Å—Å–∏–≤–Ω–∞—è –∫–æ–ø–∏—è <br />
ServiceDown - –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ (–≤—ã–∫–ª—é—á–µ–Ω —Å–µ—Ä–≤–µ—Ä) <br />
Dismounted - –æ—Ç–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ <br />
FailedAndSuspended - –æ—à–∏–±–∫–∞ –∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è <br />
Resynchronizing - –ø—Ä–æ—Ü–µ—Å—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –≥–¥–µ –±—É–¥–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–º–µ–Ω—å—à–∞—Ç—å—Å—è –¥–ª–∏–Ω–∞ –æ—á–µ—Ä–µ–¥–∏ <br />
CopyQueue Length - –¥–ª–∏–Ω–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (0 - –∑–Ω–∞—á–∏—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ –∞–∫—Ç–∏–≤–Ω–æ–π –±–∞–∑—ã —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –≤ –ø–∞—Å—Å–∏–≤–Ω—É—é –∫–æ–ø–∏—é)</p>

<p><code class="language-plaintext highlighter-rouge">Resume-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04</code> –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å (Resume) –∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–¥ –Ω–∞ EXCH-MX-04 (–∏–∑ —Å—Ç–∞—Ç—É—Å–∞ Suspended –≤ Healthy) <br />
<code class="language-plaintext highlighter-rouge">Suspend-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤ —Å—Ç–∞—Ç—É—Å Suspended) <br />
<code class="language-plaintext highlighter-rouge">Update-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04 -DeleteExistingFiles</code> –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–ø–∏—é –ë–î (—Å–¥–µ–ª–∞—Ç—å Full Backup) <br />
<code class="language-plaintext highlighter-rouge">Set-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04 -ActivationPreference 1</code> –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫–æ–ø–∏–π –ë–î (–∫–∞–∫—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, 1 ‚Äì —Å–∞–º–æ–µ –≤—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ) <br />
<code class="language-plaintext highlighter-rouge">Move-ActiveMailboxDatabase db_name -ActivateOnServer EXCH-MX-04 -MountDialOverride:None -Confirm:$false</code> –≤–∫–ª—é—á–∏—Ç—å –∫–æ–ø–∏—é –ë–î –≤ DAG (–ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –∞–∫—Ç–∏–≤–Ω—É—é –∫–æ–ø–∏—é) <br />
<code class="language-plaintext highlighter-rouge">Remove-MailboxDatabaseCopy -Identity db_name\EXCH-MX-04 -Confirm:$False</code> —É–¥–∞–ª–∏—Ç—å –∫–æ–ø–∏–∏ –ø–∞—Å—Å–∏–≤–Ω–æ–π –±–∞–∑—ã –≤ DAG-–≥—Ä—É–ø–ø–µ (—É –ë–î –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–æ –≤–µ–¥–µ–Ω–∏–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–≥–æ –∂—É—Ä–Ω–∞–ª–∞) <br />
<code class="language-plaintext highlighter-rouge">Remove-DatabaseAvailabilityGroupServer -Identity dag-01 -MailboxServer EXCH-MX-04 -ConfigurationOnly</code> —É–¥–∞–ª–∏—Ç—å MX —Å–µ—Ä–≤–µ—Ä –∏–∑ –≥—Ä—É–ø–ø—ã DAG <br />
<code class="language-plaintext highlighter-rouge">Import-Module FailoverClusters</code> <br />
<code class="language-plaintext highlighter-rouge">Get-ClusterNode EXCH-MX-04 | Remove-ClusterNode -Force</code> —É–¥–∞–ª–∏—Ç—å –æ—Ç–∫–∞–∑–∞–≤—à–∏–π —É–∑–µ–ª –∏–∑ Windows Failover Cluster</p>

<p><code class="language-plaintext highlighter-rouge">Get-DatabaseAvailabilityGroup | Get-DatabaseAvailabilityGroupHealth</code> –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</p>

<h3 id="index-1">Index</h3>
<p><code class="language-plaintext highlighter-rouge">Get-MailboxDatabaseCopyStatus * | select name,status,ContentIndexState,ContentIndexErrorMessage,ActiveDatabaseCopy,LatestCopyBackupTime,CopyQueueLength</code> —É–∑–Ω–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –∏–Ω–¥–∫—Å–æ–≤ –ë–î –∏ —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏, –Ω–∞ –∫–∞–∫–æ–º —Å–µ—Ä–≤–µ—Ä–µ –∞–∫—Ç–∏–≤–Ω–∞—è –∫–æ–ø–∏—è –ë–î, –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–ø–∏–∏ –∏ —Ç–µ–∫—É—â–∞—è –æ—á–µ—Ä–µ–¥—å <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxDatabaseCopyStatus -Identity $db_name\* | Format-List Name,ContentIndexState</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–ø–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ë–î –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö, –∏ —Å—Ç–∞—Ç—É—Å –∏—Ö –∏–Ω–¥–µ–∫—Å–æ–≤, –µ—Å–ª–∏ —É –≤—Ç–æ—Ä–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Å—Ç–∞—Ç—É—Å Healthy, –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –Ω–µ–≥–æ <br />
<code class="language-plaintext highlighter-rouge">Get-MailboxDatabaseCopyStatus -Identity $db_name\EXCH-MX-04 | Update-MailboxDatabaseCopy -SourceServer EXCH-MX-01 -CatalogOnly</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ë–î –∏–∑ –∫–æ–ø–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">cd %PROGRAMFILES%\Microsoft\Exchange Server\V14\Scripts</code> –∏–ª–∏ v15 –¥–ª—è Exchange 2016 <br />
<code class="language-plaintext highlighter-rouge">.\ResetSearchIndex.ps1 $db_name</code> —Å–∫—Ä–∏–ø—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞</p>

<p><code class="language-plaintext highlighter-rouge">Get-MailboxDatabaseCopyStatus * | where {$_.ContentIndexState -eq "Failed" -or $_.ContentIndexState -eq "FailedAndSuspended"}</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —É –∫–∞–∫–æ–π –ë–î –ø—Ä–æ–∏–∑–æ—à–µ–ª —Å–±–æ–π —Ä–∞–±–æ—Ç—ã (FailedAndSuspended) –∏–ª–∏ –∏–Ω–¥–µ–∫—Å–∞ (ContentIndexState)</p>

<h1 id="truenas">TrueNAS</h1>

<p><code class="language-plaintext highlighter-rouge">import-Module TrueNas</code> <br />
<code class="language-plaintext highlighter-rouge">(Get-Module TrueNas).ExportedCommands</code> <br />
<code class="language-plaintext highlighter-rouge">Connect-TrueNasServer -Server tnas-01 -SkipCertificateCheck</code> <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasCertificate</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasSetting</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —è–∑—ã–∫–∞, time zone, syslog level –∏ server, https port <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasUser</code> —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasSystemVersion</code> —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (Physical Memory, Model, Cores) –∏ Uptime <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasSystemAlert</code> snmp –¥–ª—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasSystemNTP</code> —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö NTP —Å–µ—Ä–≤–µ—Ä–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasDisk</code> —Å–ø–∏—Å–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –¥–∏—Å–∫–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasInterface</code> —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasGlobalConfig</code> —Å–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasDnsServer</code> –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ DNS-—Å–µ—Ä–≤–µ—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasIscsiTarget</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å ID –≥—Ä—É–ø–ø—ã –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö —Ç–∞—Ä–≥–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π portal, authentification –∏ authen-method <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasIscsiInitiator</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≥—Ä—É–ø–ø—ã –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasIscsiPortal</code> —Å–ª—É—à–∞—Ç–µ–ª—å (Listen) –∏ –ø–æ—Ä—Ç <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasIscsiExtent</code> —Å–ø–∏—Å–æ–∫ ISCSi Target (—Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã, –ø—É—Ç—å) <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasPool</code> —Å–ø–∏—Å–æ–∫ pool (Id, Path, Status, Healthy) <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasVolume -Type FILESYSTEM</code> —Å–ø–∏—Å–æ–∫ pool —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasVolume -Type VOLUME</code> —Å–ø–∏—Å–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ –≤ pool –∏ –∏—Ö —Ä–∞–∑–º–µ—Ä <br />
<code class="language-plaintext highlighter-rouge">Get-TrueNasService | ft</code> —Å–ø–∏—Å–æ–∫ —Å–ª—É–∂–± –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å <br />
<code class="language-plaintext highlighter-rouge">Start-TrueNasService ssh</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É <br />
<code class="language-plaintext highlighter-rouge">Stop-TrueNasService ssh</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂–±—É</p>

<h1 id="veeam">Veeam</h1>

<p><code class="language-plaintext highlighter-rouge">Set-ExecutionPolicy AllSigned</code> or Set-ExecutionPolicy Bypass -Scope Process <br />
<code class="language-plaintext highlighter-rouge">Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))</code> <br />
<code class="language-plaintext highlighter-rouge">choco install veeam-backup-and-replication-console</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Module Veeam.Backup.PowerShell</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Command -Module Veeam.Backup.PowerShell</code> or Get-VBRCommand <br />
<code class="language-plaintext highlighter-rouge">Connect-VBRServer -Server $srv -Credential $cred</code> or -User and -Password<code class="language-plaintext highlighter-rouge"> - Port 9392</code> default <br />
<code class="language-plaintext highlighter-rouge">Get-VBRJob</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VBRCommand *get*backup*</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VBRComputerBackupJob</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VBRBackup</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VBRBackupRepository</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VBRBackupSession</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VBRBackupServerCertificate</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VBRRestorePoint</code> <br />
<code class="language-plaintext highlighter-rouge">Get-VBRViProxy</code></p>

<h1 id="rest-api">REST API</h1>

<p><code class="language-plaintext highlighter-rouge">$url = "https://habr.com/ru/rss/users/Lifailon/publications/articles/?fl=ru"</code> RSS –ª–µ–Ω—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–π –Ω–∞ Habr <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod $url</code> <br />
<code class="language-plaintext highlighter-rouge">$iwr = Invoke-WebRequest -Uri $url</code> <br />
<code class="language-plaintext highlighter-rouge">$iwr | Get-Member</code> <br />
<code class="language-plaintext highlighter-rouge">$iwr.Content</code> <br />
<code class="language-plaintext highlighter-rouge">$iwr.StatusCode -eq 200</code> <br />
<code class="language-plaintext highlighter-rouge">$iwr.Headers</code> <br />
<code class="language-plaintext highlighter-rouge">$iwr.ParsedHtml | Select lastModified</code> <br />
<code class="language-plaintext highlighter-rouge">$iwr.Links | fl title,innerText,href</code> <br />
<code class="language-plaintext highlighter-rouge">$iwr.Images.src</code></p>

<h3 id="methods">Methods</h3>

<p><strong>GET</strong> - Read <br />
<strong>POST</strong> - Create <br />
<strong>PATCH</strong> - Partial update/modify <br />
<strong>PUT</strong> - Update/replace <br />
<strong>DELETE</strong> - Remove</p>

<h3 id="download-image">Download Image</h3>
<pre><code class="language-PowerShell">function Download-Image {
param (
    [Parameter(Mandatory = $True)]$url
)
    $folder = $url -replace "http.+://" -replace "/","-" -replace "-$"
    $path = "$home\Pictures\$folder"
    if (Test-Path $path) {
        Remove-Item $path -Recurse -Force
        New-Item -ItemType Directory $path &gt; $null
    } else {
        New-Item -ItemType Directory $path &gt; $null
    }
    $irm = Invoke-WebRequest -Uri $url
    foreach ($img in $irm.Images.src) {
        $name = $img -replace ".+/"
        Start-Job {
            Invoke-WebRequest $using:img -OutFile "$using:path\$using:name"
        } &gt; $null
    }
    while ($True){
        $status_job = (Get-Job).State[-1]
        if ($status_job -like "Completed"){
        Get-Job | Remove-Job -Force
        break
    }}
    $count_all = $irm.Images.src.Count
    $count_down = (Get-Item $path\*).count
    "Downloaded $count_down of $count_all files to $path"
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Download-Image -url https://losst.pro/</code></p>

<h3 id="token">Token</h3>
<pre><code class="language-PowerShell">https://veeam-11:9419/swagger/ui/index.html
$Header = @{
"x-api-version" = "1.0-rev2"
}
$Body = @{
"grant_type" = "password"
"username" = "$login"
"password" = "$password"
}
$vpost = iwr "https://veeam-11:9419/api/oauth2/token" -Method POST -Headers $Header -Body $Body -SkipCertificateCheck
$vtoken = (($vpost.Content) -split '"')[3]
</code></pre>
<h3 id="get">GET</h3>
<pre><code class="language-PowerShell">$token = $vtoken | ConvertTo-SecureString -AsPlainText ‚ÄìForce
$vjob = iwr "https://veeam-11:9419/api/v1/jobs" -Method GET -Headers $Header -Authentication Bearer -Token $token -SkipCertificateCheck

$Header = @{
"x-api-version" = "1.0-rev1"
"Authorization" = "Bearer $vtoken"
}
$vjob = iwr "https://veeam-11:9419/api/v1/jobs" -Method GET -Headers $Header -SkipCertificateCheck
$vjob = $vjob.Content | ConvertFrom-Json

$vjob = Invoke-RestMethod "https://veeam-11:9419/api/v1/jobs" -Method GET -Headers $Header -SkipCertificateCheck
$vjob.data.virtualMachines.includes.inventoryObject
</code></pre>
<h1 id="pode">Pode</h1>
<pre><code class="language-PowerShell">Start-PodeServer {
    Add-PodeEndpoint -Address localhost -Port "8080" -Protocol "HTTP"
    ### Get info endpoints
    Add-PodeRoute -Path "/" -Method "GET" -ScriptBlock {
        Write-PodeJsonResponse -Value @{
        "service"="/api/service";
        "process"="/api/process"
        }
    }
    ### GET
    Add-PodeRoute -Path "/api/service" -Method "GET" -ScriptBlock {
        Write-PodeJsonResponse -Value $(
            Get-Service | Select-Object Name,@{
                Name="Status"; Expression={[string]$_.Status}
            },@{
                Name="StartType"; Expression={[string]$_.StartType}
            } | ConvertTo-Json
        )
    }
    Add-PodeRoute -Path "/api/process" -Method "GET" -ScriptBlock {
        Write-PodeJsonResponse -Value $(
            Get-Process | Sort-Object -Descending CPU | Select-Object -First 15 ProcessName,
            @{Name="ProcessorTime"; Expression={$_.TotalProcessorTime -replace "\.\d+$"}},
            @{Name="Memory"; Expression={[string]([int]($_.WS / 1024kb))+"MB"}},
            @{Label="RunTime"; Expression={((Get-Date) - $_.StartTime) -replace "\.\d+$"}}
        )
    }
    Add-PodeRoute -Path "/api/process-html" -Method "GET" -ScriptBlock {
        Write-PodeHtmlResponse -Value (
            Get-Process | Sort-Object -Descending CPU | Select-Object -First 15 ProcessName,
            @{Name="ProcessorTime"; Expression={$_.TotalProcessorTime -replace "\.\d+$"}},
            @{Name="Memory"; Expression={[string]([int]($_.WS / 1024kb))+"MB"}},
            @{Label="RunTime"; Expression={((Get-Date) - $_.StartTime) -replace "\.\d+$"}} # Auto ConvertTo-Html
        )
    }
    ### POST
    Add-PodeRoute -Path "/api/service" -Method "POST" -ScriptBlock {
        # https://pode.readthedocs.io/en/latest/Tutorials/WebEvent/
        # $WebEvent | Out-Default
        $Value = $WebEvent.Data["ServiceName"]
        $Status = (Get-Service -Name $Value).Status
        Write-PodeJsonResponse -Value @{
            "Name"="$Value";
            "Status"="$Status";
        }
    }
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">irm http://localhost:8080/api/service -Method Get</code> <br />
<code class="language-plaintext highlighter-rouge">irm http://localhost:8080/api/process -Method Get</code> <br />
<code class="language-plaintext highlighter-rouge">http://localhost:8080/api/process-html</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±—Ä–∞—É–∑–µ—Ä <br />
<code class="language-plaintext highlighter-rouge">irm http://localhost:8080/api/service -Method Post -Body @{"ServiceName" = "AnyDesk"}</code></p>

<h1 id="selenium">Selenium</h1>

<p><code class="language-plaintext highlighter-rouge">Invoke-Expression(New-Object Net.WebClient).DownloadString("https://raw.githubusercontent.com/Lifailon/Deploy-Selenium/rsa/Deploy-Selenium-Drivers.ps1")</code> —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∏ Chromium —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –≤–µ—Ä—Å–∏–∏ –¥–ª—è –¥—Ä–∞–π–≤–µ—Ä–∞</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$path = "$home\Documents\Selenium\"
$log = "$path\ChromeDriver.log"
$ChromeDriver = "$path\ChromeDriver.exe"
$WebDriver = "$path\WebDriver.dll"
$SupportDriver = "$path\WebDriver.Support.dll"
$Chromium = (Get-ChildItem $path -Recurse | Where-Object Name -like chrome.exe).FullName
Add-Type -Path $WebDriver
Add-Type -Path $SupportDriver
try {
    $ChromeOptions = New-Object OpenQA.Selenium.Chrome.ChromeOptions # —Å–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∑–∞–ø—É—Å–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞
    $ChromeOptions.BinaryLocation = $Chromium # –ø–µ—Ä–µ–¥–∞–µ–º –ø—É—Ç—å –¥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–ø—É—Å–∫ –±—Ä–∞—É–∑–µ—Ä–∞
    $ChromeOptions.AddArgument("start-maximized") # –¥–æ–±–∞–≤–ª—è–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
    #$ChromeOptions.AddArgument("start-minimized") # –∑–∞–ø—É—Å–∫–∞–µ–º –±—Ä–∞—É–∑–µ—Ä –≤ –æ–∫–Ω–µ
    #$ChromeOptions.AddArgument("window-size=400,800") # –∑–∞–ø—É—Å–∫–∞–µ–º –±—Ä–∞—É–∑–µ—Ä —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º –æ–∫–Ω–∞ –≤ –ø–∏–∫—Å–µ–ª—è—Ö
    $ChromeOptions.AcceptInsecureCertificates = $True # –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –Ω–∞ —Å–∞–π—Ç–∞—Ö —Å –Ω–µ –≤–∞–ª–∏–¥–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º
    #$ChromeOptions.AddArgument("headless") # —Å–∫—Ä—ã–≤–∞—Ç—å –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
    $ChromeDriverService = [OpenQA.Selenium.Chrome.ChromeDriverService]::CreateDefaultService($ChromeDriver) # —Å–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–ª—É–∂–±—ã –¥—Ä–∞–π–≤–µ—Ä–∞
    $ChromeDriverService.HideCommandPromptWindow = $True # –æ—Ç–∫–ª—é—á–∞–µ–º –≤–µ—Å—å –≤—ã–≤–æ–¥ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞ –≤ –∫–æ–Ω—Å–æ–ª—å (—ç—Ç–æ—Ç –≤—ã–≤–æ–¥ –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å)
    $ChromeDriverService.LogPath = $log # —É–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞ —Å –∂—É—Ä–Ω–∞–ª–æ–º
    $ChromeDriverService.EnableAppendLog = $True # –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –∂—É—Ä–Ω–∞–ª –ø—Ä–∏ –∫–∞–∂–¥–æ–º –Ω–æ–≤–æ–º –∑–∞–ø—É—Å–∫–µ
    #$ChromeDriverService.EnableVerboseLogging = $True # –∫—Ä–æ–º–µ INFO –∏ –æ—à–∏–±–æ–∫, –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å DEBUG —Å–æ–æ–±—â–µ–Ω–∏—è
    $Selenium = New-Object OpenQA.Selenium.Chrome.ChromeDriver($ChromeDriverService, $ChromeOptions) # –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–∞–ø—É—Å–∫ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

    $Selenium.Navigate().GoToUrl("https://google.com") # –ø–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Å—Å—ã–ª–∫–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
    #$Selenium.Manage().Window.Minimize() # —Å–≤–µ—Ä–Ω—É—Ç—å –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ –Ω—É–∂–Ω–æ–º—É url (—á—Ç–æ –±—ã —Å—á–∏—Ç–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
    # –ò—â–µ–º –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞:
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::Id('APjFqb'))
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::XPath('//*[@id="APjFqb"]'))
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::Name('q'))
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::XPath('//*[@name="q"]'))
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::ClassName('gLFyf'))
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::CssSelector('[jsname="yZiJbe"]'))
    $Search = $Selenium.FindElements([OpenQA.Selenium.By]::TagName('textarea')) | Where-Object ComputedAccessibleRole -eq combobox
    $Search.SendKeys("calculator online") # –ø–µ—Ä–µ–¥–∞–µ–º —Ç–µ–∫—Å—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É
    $Search.SendKeys([OpenQA.Selenium.Keys]::Enter) # –Ω–∞–∂–∏–º–∞–µ–º Enter –¥–ª—è –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∏—Å–∫–∞

    Start-Sleep 1
    $div = $Selenium.FindElements([OpenQA.Selenium.By]::TagName("div"))
    $2 = $div | Where-Object {($_.ComputedAccessibleRole -eq "button") -and ($_.ComputedAccessibleLabel -eq "2")}
    $2.Click()
    $2.Click()
    $plus = $div | Where-Object {($_.ComputedAccessibleRole -eq "button") -and ($_.Text -eq "+")}
    $plus.Click()
    $3 = $Selenium.FindElement([OpenQA.Selenium.By]::CssSelector('[jsname="KN1kY"]'))
    $3.Click()
    $3.Click()
    $sum = $Selenium.FindElement([OpenQA.Selenium.By]::CssSelector('[jsname="Pt8tGc"]'))
    $sum.Click()
    $result = $Selenium.FindElement([OpenQA.Selenium.By]::CssSelector('[jsname="VssY5c"]')).Text
    Write-Host "Result: $result" -ForegroundColor Green
}
finally {
    $Selenium.Close()
    $Selenium.Quit()
}
</code></pre></div></div>
<h3 id="selenium-modules">Selenium modules</h3>
<pre><code class="language-PowerShell">Invoke-RestMethod https://raw.githubusercontent.com/Lifailon/Selenium-Modules/rsa/Modules/Get-GPT/Get-GPT.psm1 | Out-File -FilePath "$(New-Item -Path "$($($Env:PSModulePath -split ";")[0])\Get-GPT" -ItemType Directory -Force)\Get-GPT.psm1" -Force
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Get-GPT "–ò—Å–ø–æ–ª–Ω—è–π —Ä–æ–ª—å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞. –ü–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É —á–∏—Å–µ–ª: 22+33"</code></p>
<pre><code class="language-PowerShell">Invoke-RestMethod https://raw.githubusercontent.com/Lifailon/Selenium-Modules/rsa/Modules/Get-Translation/Get-Translation.psm1 | Out-File -FilePath "$(New-Item -Path "$($($Env:PSModulePath -split ";")[0])\Get-Translation" -ItemType Directory -Force)\Get-Translation.psm1" -Force
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Get-Translation -Provider DeepL -Text "I translating the text"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Translation -Provider DeepL -Text "–Ø –ø–µ—Ä–µ–≤–æ–∂—É —Ç–µ–∫—Å—Ç"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Translation -Provider Google -Text "I translating the text"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Translation -Provider Google -Text "–Ø –ø–µ—Ä–µ–≤–æ–∂—É —Ç–µ–∫—Å—Ç" -Language en</code></p>
<pre><code class="language-PowerShell">Invoke-RestMethod https://raw.githubusercontent.com/Lifailon/Selenium-Modules/rsa/Modules/Get-SpeedTest/Get-SpeedTest.psm1 | Out-File -FilePath "$(New-Item -Path "$($($Env:PSModulePath -split ";")[0])\Get-SpeedTest" -ItemType Directory -Force)\Get-SpeedTest.psm1" -Force
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Get-SpeedTest -Provider Libre</code> <br />
<code class="language-plaintext highlighter-rouge">Get-SpeedTest -Provider Open</code> <br />
<code class="language-plaintext highlighter-rouge">Get-SpeedTest -Provider Ookla</code></p>

<h1 id="ie">IE</h1>

<p><code class="language-plaintext highlighter-rouge">$ie.document.IHTMLDocument3_getElementsByTagName("input")  | select name</code> –ø–æ–ª—É—á–∏—Ç—å –∏–º–µ–Ω–∞ –≤—Å–µ—Ö Input Box <br />
<code class="language-plaintext highlighter-rouge">$ie.document.IHTMLDocument3_getElementsByTagName("button") | select innerText</code> –ø–æ–ª—É—á–∏—Ç—å –∏–º–µ–Ω–∞ –≤—Å–µ—Ö Button <br />
<code class="language-plaintext highlighter-rouge">$ie.Document.documentElement.innerHTML</code> –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å—ã—Ä–æ–π Web Content (&lt;input name=‚Äùlogin‚Äù tabindex=‚Äù100‚Äù class=‚Äùinput__control input__input‚Äù id=‚Äùuniq32005644019429136‚Äù spellcheck=‚Äùfalse‚Äù placeholder=‚Äù–õ–æ–≥–∏–Ω‚Äù) <br />
<code class="language-plaintext highlighter-rouge">$All_Elements = $ie.document.IHTMLDocument3_getElementsByTagName("*")</code> –∑–∞–±—Ä–∞—Ç—å –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã <br />
<code class="language-plaintext highlighter-rouge">$Go_Button = $All_Elements | ? innerText -like "go"</code> –ø–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ –∏–º–µ–Ω–∏ <br />
<code class="language-plaintext highlighter-rouge">$Go_Button | select ie9_tagName</code> –ø–æ–ª—É—á–∏—Ç—å TagName (SPAN) –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –ø–æ–∏—Å–∫–∞ <br />
<code class="language-plaintext highlighter-rouge">$SPAN_Elements = $ie.document.IHTMLDocument3_getElementsByTagName("SPAN")</code></p>
<pre><code class="language-PowerShell">$ie = New-Object -ComObject InternetExplorer.Application
$ie.navigate("https://yandex.ru")
$ie.visible = $true
$ie.document.IHTMLDocument3_getElementByID("login").value = "Login"
$ie.document.IHTMLDocument3_getElementByID("passwd").value = "Password"
$Button_Auth = ($ie.document.IHTMLDocument3_getElementsByTagName("button")) | ? innerText -match "–í–æ–π—Ç–∏"
$Button_Auth.Click()
$Result = $ie.Document.documentElement.innerHTML
$ie.Quit()
</code></pre>
<h1 id="com">COM</h1>

<p><code class="language-plaintext highlighter-rouge">$wshell = New-Object -ComObject Wscript.Shell</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell | Get-Member</code> <br />
<code class="language-plaintext highlighter-rouge">$link = $wshell.CreateShortcut("$Home\Desktop\Yandex.lnk")</code> —Å–æ–∑–¥–∞—Ç—å —è—Ä–ª—ã–∫ <br />
<code class="language-plaintext highlighter-rouge">$link | Get-Member</code> <br />
<code class="language-plaintext highlighter-rouge">$link.TargetPath = "https://yandex.ru"</code> –∫—É–¥–∞ —Å—Å—ã–ª–∞–µ—Ç—Å—è (–º–µ—Ç–æ–¥ TargetPath –æ–±—ä–µ–∫—Ç–∞ $link –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –æ–±—ä–µ–∫—Ç CreateShortcut) <br />
<code class="language-plaintext highlighter-rouge">$link.Save()</code> —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å</p>

<p><code class="language-plaintext highlighter-rouge">Set-WinUserLanguageList -LanguageList en-us,ru -Force</code> –∏–∑–º–µ–Ω–∏—Ç—å —è–∑—ã–∫–æ–≤—É—é —Ä–∞—Å–∫–ª–∞–¥–∫—É –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã</p>

<h3 id="wscriptshellsendkeys">Wscript.Shell.SendKeys</h3>

<p><code class="language-plaintext highlighter-rouge">(New-Object -ComObject Wscript.shell).SendKeys([char]173)</code> –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫ <br />
<code class="language-plaintext highlighter-rouge">$wshell.Exec("notepad.exe")</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">$wshell.AppActivate("–ë–ª–æ–∫–Ω–æ—Ç")</code> —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</p>

<p><code class="language-plaintext highlighter-rouge">$wshell.SendKeys("Login")</code> —Ç–µ–∫—Å—Ç <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{A 5}")</code> –Ω–∞–ø–µ—á–∞—Ç–∞—Ç—å –±—É–∫–≤—É 5 —Ä–∞–∑ –ø–æ–¥—Ä—è–¥ <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("%{TAB}")</code> ALT+TAB <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("^")</code> CTRL <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("%")</code> ALT <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("+")</code> SHIFT <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{DOWN}")</code> –≤–Ω–∏–∑ <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{UP}")</code> –≤–≤–µ—Ä—Ö <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{LEFT}")</code> –≤–ª–µ–≤–æ <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{RIGHT}")</code> –≤–ø—Ä–∞–≤–æ <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{PGUP}")</code> PAGE UP <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{PGDN}")</code> PAGE DOWN <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{BACKSPACE}")</code> BACKSPACE/BKSP/BS <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{DEL}")</code> DEL/DELETE <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{INS}")</code> INS/INSERT <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{PRTSC}")</code> PRINT SCREEN <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{ENTER}")</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{ESC}")</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{TAB}")</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{END}")</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{HOME}")</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{BREAK}")</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{SCROLLLOCK}")</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{CAPSLOCK}")</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{NUMLOCK}")</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{F1}")</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.SendKeys("{F12}")</code></p>
<pre><code class="language-PowerShell">function Get-AltTab {
(New-Object -ComObject wscript.shell).SendKeys("%{Tab}")
Start-Sleep $(Get-Random -Minimum 30 -Maximum 180)
Get-AltTab
}
Get-AltTab
</code></pre>
<h3 id="wscriptshellpopup">Wscript.Shell.Popup</h3>

<p><code class="language-plaintext highlighter-rouge">$wshell = New-Object -ComObject Wscript.Shell</code> <br />
<code class="language-plaintext highlighter-rouge">$output = $wshell.Popup("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ?",0,"–ó–∞–≥–æ–ª–æ–≤–æ–∫",4)</code> <br />
<code class="language-plaintext highlighter-rouge">if ($output -eq 6) {"yes"} elseif ($output -eq 7) {"no"} else {"no good"}</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Type:
0 –û–ö
1 –û–ö –∏ –û—Ç–º–µ–Ω–∞
2 –°—Ç–æ–ø, –ü–æ–≤—Ç–æ—Ä, –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å
3 –î–∞, –ù–µ—Ç, –û—Ç–º–µ–Ω–∞
4 –î–∞ –∏ –ù–µ—Ç
5 –ü–æ–≤—Ç–æ—Ä –∏ –û—Ç–º–µ–Ω–∞
16 Stop
32 Question
48 Exclamation
64 Information

Output:
-1 Timeout
1 –û–ö
2 –û—Ç–º–µ–Ω–∞
3 –°—Ç–æ–ø
4 –ü–æ–≤—Ç–æ—Ä
5 –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å
6 –î–∞
7 –ù–µ—Ç
</code></pre></div></div>
<h3 id="wscriptnetwork">WScript.Network</h3>

<p><code class="language-plaintext highlighter-rouge">$wshell = New-Object -ComObject WScript.Network</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell | Get-Member</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.UserName</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.ComputerName</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.UserDomain</code></p>

<h3 id="shellapplication">Shell.Application</h3>

<p><code class="language-plaintext highlighter-rouge">$wshell = New-Object -ComObject Shell.Application</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell | Get-Member</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.Explore("C:\")</code> <br />
<code class="language-plaintext highlighter-rouge">$wshell.Windows() | Get-Member</code> –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –æ—Ç–∫—Ä—ã—Ç—ã–º –≤ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–µ –∏–ª–∏ –±—Ä–∞—É–∑–µ—Ä–µ Internet Explorer –æ–∫–æ–Ω</p>

<p><code class="language-plaintext highlighter-rouge">$shell = New-Object -Com Shell.Application</code> <br />
<code class="language-plaintext highlighter-rouge">$RecycleBin = $shell.Namespace(10)</code> <br />
<code class="language-plaintext highlighter-rouge">$RecycleBin.Items()</code></p>

<h3 id="outlook">Outlook</h3>

<p><code class="language-plaintext highlighter-rouge">$Outlook = New-Object -ComObject Outlook.Application</code> <br />
<code class="language-plaintext highlighter-rouge">$Outlook | Get-Member</code> <br />
<code class="language-plaintext highlighter-rouge">$Outlook.Version</code></p>
<pre><code class="language-PowerShell">$Outlook = New-Object -ComObject Outlook.Application
$Namespace = $Outlook.GetNamespace("MAPI")
$Folder = $namespace.GetDefaultFolder(4)` –∏—Å—Ö–æ–¥—è—â–∏–µ
$Folder = $namespace.GetDefaultFolder(6)` –≤—Ö–æ–¥—è—â–∏–µ
$Explorer = $Folder.GetExplorer()
$Explorer.Display()	
$Outlook.Quit()
</code></pre>
<h3 id="microsoftupdate">Microsoft.Update</h3>

<p><code class="language-plaintext highlighter-rouge">(New-Object -com 'Microsoft.Update.AutoUpdate').Settings</code> <br />
<code class="language-plaintext highlighter-rouge">(New-Object -com 'Microsoft.Update.AutoUpdate').Results</code> <br />
<code class="language-plaintext highlighter-rouge">(New-Timespan -Start ((New-Object -com 'Microsoft.Update.AutoUpdate').Results|Select -ExpandProperty LastInstallationSuccessDate) -End (Get-Date)).hours</code> –∫–æ–ª-–≤–æ —á–∞—Å–æ–≤, –ø—Ä–æ—à–µ–¥—à–∏—Ö —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–∞—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ Windows.</p>

<h1 id="dotnet">dotNET</h1>

<p><code class="language-plaintext highlighter-rouge">[System.Diagnostics.EventLog] | select Assembly,Module</code> <br />
<code class="language-plaintext highlighter-rouge">$EventLog = [System.Diagnostics.EventLog]::new("Application")</code> <br />
<code class="language-plaintext highlighter-rouge">$EventLog = New-Object -TypeName System.Diagnostics.EventLog -ArgumentList Application,192.168.3.100</code> <br />
<code class="language-plaintext highlighter-rouge">$EventLog | Get-Member -MemberType Method</code> <br />
<code class="language-plaintext highlighter-rouge">$EventLog.MaximumKilobytes</code> –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∂—É—Ä–Ω–∞–ª–∞ <br />
<code class="language-plaintext highlighter-rouge">$EventLog.Entries</code> –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∂—É—Ä–Ω–∞–ª <br />
<code class="language-plaintext highlighter-rouge">$EventLog.Clear()</code> –æ—á–∏—Å—Ç–∏—Ç—å –∂—É—Ä–Ω–∞–ª</p>

<p><code class="language-plaintext highlighter-rouge">Join-Path C: Install Test</code> <br />
<code class="language-plaintext highlighter-rouge">[System.IO.Path]::Combine("C:", "Install", "Test")</code></p>

<h3 id="match">Match</h3>

<p><code class="language-plaintext highlighter-rouge">[System.Math] | Get-Member -Static -MemberType Methods</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Math]::Max(2,7)</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Math]::Min(2,7)</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Math]::Floor(3.9)</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Math]::Truncate(3.9)</code></p>

<h3 id="generatepassword">GeneratePassword</h3>

<p><code class="language-plaintext highlighter-rouge">Add-Type -AssemblyName System.Web</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Web.Security.Membership]::GeneratePassword(10,2)</code></p>

<h3 id="soundplayer">SoundPlayer</h3>
<pre><code class="language-PowerShell">$CriticalSound = New-Object System.Media.SoundPlayer
$CriticalSound.SoundLocation = "C:\WINDOWS\Media\Windows Critical Stop.wav"
$CriticalSound.Play()

$GoodSound = New-Object System.Media.SoundPlayer
$GoodSound.SoundLocation = "C:\WINDOWS\Media\tada.wav"
$GoodSound.Play()
</code></pre>
<h3 id="static-class">Static Class</h3>

<p><code class="language-plaintext highlighter-rouge">[System.Environment] | Get-Member -Static</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Environment]::OSVersion</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Environment]::Version</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Environment]::MachineName</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Environment]::UserName</code></p>

<p><code class="language-plaintext highlighter-rouge">[System.Diagnostics.Process] | Get-Member -Static</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Diagnostics.Process]::Start('notepad.exe')</code></p>

<h3 id="clicker">[Clicker]</h3>
<pre><code class="language-PowerShell">$cSource = @'
using System;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Windows.Forms;
public class Clicker
{
//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646270(v=vs.85).aspx
[StructLayout(LayoutKind.Sequential)]
struct INPUT
{ 
    public int        type; // 0 = INPUT_MOUSE,
                            // 1 = INPUT_KEYBOARD
                            // 2 = INPUT_HARDWARE
    public MOUSEINPUT mi;
}
//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646273(v=vs.85).aspx
[StructLayout(LayoutKind.Sequential)]
struct MOUSEINPUT
{
    public int    dx ;
    public int    dy ;
    public int    mouseData ;
    public int    dwFlags;
    public int    time;
    public IntPtr dwExtraInfo;
}
//This covers most use cases although complex mice may have additional buttons
//There are additional constants you can use for those cases, see the msdn page
const int MOUSEEVENTF_MOVED      = 0x0001 ;
const int MOUSEEVENTF_LEFTDOWN   = 0x0002 ;
const int MOUSEEVENTF_LEFTUP     = 0x0004 ;
const int MOUSEEVENTF_RIGHTDOWN  = 0x0008 ;
const int MOUSEEVENTF_RIGHTUP    = 0x0010 ;
const int MOUSEEVENTF_MIDDLEDOWN = 0x0020 ;
const int MOUSEEVENTF_MIDDLEUP   = 0x0040 ;
const int MOUSEEVENTF_WHEEL      = 0x0080 ;
const int MOUSEEVENTF_XDOWN      = 0x0100 ;
const int MOUSEEVENTF_XUP        = 0x0200 ;
const int MOUSEEVENTF_ABSOLUTE   = 0x8000 ;
const int screen_length          = 0x10000 ;
//https://msdn.microsoft.com/en-us/library/windows/desktop/ms646310(v=vs.85).aspx
[System.Runtime.InteropServices.DllImport("user32.dll")]
extern static uint SendInput(uint nInputs, INPUT[] pInputs, int cbSize);
public static void LeftClickAtPoint(int x, int y)
{
    //Move the mouse
    INPUT[] input = new INPUT[3];
    input[0].mi.dx = x*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width);
    input[0].mi.dy = y*(65535/System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height);
    input[0].mi.dwFlags = MOUSEEVENTF_MOVED | MOUSEEVENTF_ABSOLUTE;
    //Left mouse button down
    input[1].mi.dwFlags = MOUSEEVENTF_LEFTDOWN;
    //Left mouse button up
    input[2].mi.dwFlags = MOUSEEVENTF_LEFTUP;
    SendInput(3, input, Marshal.SizeOf(input[0]));
}
}
'@
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Add-Type -TypeDefinition $cSource -ReferencedAssemblies System.Windows.Forms,System.Drawing</code> <br />
<code class="language-plaintext highlighter-rouge">[Clicker]::LeftClickAtPoint(1900,1070)</code></p>

<h3 id="audio">[Audio]</h3>
<pre><code class="language-PowerShell">Add-Type -Language CsharpVersion3 -TypeDefinition @"
using System.Runtime.InteropServices;
[Guid("5CDF2C82-841E-4546-9722-0CF74078229A"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
interface IAudioEndpointVolume {
// f(), g(), ... are unused COM method slots. Define these if you care
int f(); int g(); int h(); int i();
int SetMasterVolumeLevelScalar(float fLevel, System.Guid pguidEventContext);
int j();
int GetMasterVolumeLevelScalar(out float pfLevel);
int k(); int l(); int m(); int n();
int SetMute([MarshalAs(UnmanagedType.Bool)] bool bMute, System.Guid pguidEventContext);
int GetMute(out bool pbMute);
}
[Guid("D666063F-1587-4E43-81F1-B948E807363F"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
interface IMMDevice {
int Activate(ref System.Guid id, int clsCtx, int activationParams, out IAudioEndpointVolume aev);
}
[Guid("A95664D2-9614-4F35-A746-DE8DB63617E6"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
interface IMMDeviceEnumerator {
int f(); // Unused
int GetDefaultAudioEndpoint(int dataFlow, int role, out IMMDevice endpoint);
}
[ComImport, Guid("BCDE0395-E52F-467C-8E3D-C4579291692E")] class MMDeviceEnumeratorComObject { }
public class Audio {
static IAudioEndpointVolume Vol() {
var enumerator = new MMDeviceEnumeratorComObject() as IMMDeviceEnumerator;
IMMDevice dev = null;
Marshal.ThrowExceptionForHR(enumerator.GetDefaultAudioEndpoint(/*eRender*/ 0, /*eMultimedia*/ 1, out dev));
IAudioEndpointVolume epv = null;
var epvid = typeof(IAudioEndpointVolume).GUID;
Marshal.ThrowExceptionForHR(dev.Activate(ref epvid, /*CLSCTX_ALL*/ 23, 0, out epv));
return epv;
}
public static float Volume {
get {float v = -1; Marshal.ThrowExceptionForHR(Vol().GetMasterVolumeLevelScalar(out v)); return v;}
set {Marshal.ThrowExceptionForHR(Vol().SetMasterVolumeLevelScalar(value, System.Guid.Empty));}
}
public static bool Mute {
get { bool mute; Marshal.ThrowExceptionForHR(Vol().GetMute(out mute)); return mute; }
set { Marshal.ThrowExceptionForHR(Vol().SetMute(value, System.Guid.Empty)); }
}
}
"@
</code></pre>
<p><code class="language-plaintext highlighter-rouge">[Audio]::Volume = 0.50</code> <br />
<code class="language-plaintext highlighter-rouge">[Audio]::Mute = $true</code></p>

<h3 id="netsessionenum">NetSessionEnum</h3>

<p><a href="https://learn.microsoft.com/ru-ru/windows/win32/api/lmshare/nf-lmshare-netsessionenum?redirectedfrom=MSDN">Function</a> <br />
<a href="https://fuzzysecurity.com/tutorials/24.html">Source</a></p>
<pre><code class="language-PowerShell">function Invoke-NetSessionEnum {
param (
[Parameter(Mandatory = $True)][string]$HostName
)
Add-Type -TypeDefinition @"
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
[StructLayout(LayoutKind.Sequential)]
public struct SESSION_INFO_10
{
    [MarshalAs(UnmanagedType.LPWStr)]public string OriginatingHost;
    [MarshalAs(UnmanagedType.LPWStr)]public string DomainUser;
    public uint SessionTime;
    public uint IdleTime;
}
public static class Netapi32
{
[DllImport("Netapi32.dll", SetLastError=true)]
    public static extern int NetSessionEnum(
        [In,MarshalAs(UnmanagedType.LPWStr)] string ServerName,
        [In,MarshalAs(UnmanagedType.LPWStr)] string UncClientName,
        [In,MarshalAs(UnmanagedType.LPWStr)] string UserName,
        Int32 Level,
        out IntPtr bufptr,
        int prefmaxlen,
        ref Int32 entriesread,
        ref Int32 totalentries,
        ref Int32 resume_handle);
         
[DllImport("Netapi32.dll", SetLastError=true)]
    public static extern int NetApiBufferFree(
        IntPtr Buffer);
}
"@
# Create SessionInfo10 Struct
$SessionInfo10 = New-Object SESSION_INFO_10
$SessionInfo10StructSize = [System.Runtime.InteropServices.Marshal]::SizeOf($SessionInfo10)` Grab size to loop bufptr
$SessionInfo10 = $SessionInfo10.GetType()` Hacky, but we need this ;))
# NetSessionEnum params
$OutBuffPtr = [IntPtr]::Zero` Struct output buffer
$EntriesRead = $TotalEntries = $ResumeHandle = 0` Counters &amp; ResumeHandle
$CallResult = [Netapi32]::NetSessionEnum($HostName, "", "", 10, [ref]$OutBuffPtr, -1, [ref]$EntriesRead, [ref]$TotalEntries, [ref]$ResumeHandle)
if ($CallResult -ne 0){
echo "Mmm something went wrong!`nError Code: $CallResult"
}
else {
if ([System.IntPtr]::Size -eq 4) {
echo "`nNetapi32::NetSessionEnum Buffer Offset  --&gt; 0x$("{0:X8}" -f $OutBuffPtr.ToInt32())"
}
else {
echo "`nNetapi32::NetSessionEnum Buffer Offset  --&gt; 0x$("{0:X16}" -f $OutBuffPtr.ToInt64())"
}
echo "Result-set contains $EntriesRead session(s)!"
# Change buffer offset to int
$BufferOffset = $OutBuffPtr.ToInt64()
# Loop buffer entries and cast pointers as SessionInfo10
for ($Count = 0; ($Count -lt $EntriesRead); $Count++){
$NewIntPtr = New-Object System.Intptr -ArgumentList $BufferOffset
$Info = [system.runtime.interopservices.marshal]::PtrToStructure($NewIntPtr,[type]$SessionInfo10)
$Info
$BufferOffset = $BufferOffset + $SessionInfo10StructSize
}
echo "`nCalling NetApiBufferFree, no memleaks here!"
[Netapi32]::NetApiBufferFree($OutBuffPtr) |Out-Null
}
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Invoke-NetSessionEnum localhost</code></p>

<h3 id="copyfile">CopyFile</h3>

<p><a href="https://learn.microsoft.com/ru-ru/windows/win32/api/winbase/nf-winbase-copyfile">Function</a> <br />
<a href="https://devblogs.microsoft.com/scripting/use-powershell-to-interact-with-the-windows-api-part-1/">Source</a></p>
<pre><code class="language-PowerShell">$MethodDefinition = @"
[DllImport("kernel32.dll", CharSet = CharSet.Unicode)]
public static extern bool CopyFile(string lpExistingFileName, string lpNewFileName, bool bFailIfExists);
"@
$Kernel32 = Add-Type -MemberDefinition $MethodDefinition -Name "Kernel32" -Namespace "Win32" -PassThru
$Kernel32::CopyFile("$($Env:SystemRoot)\System32\calc.exe", "$($Env:USERPROFILE)\Desktop\calc.exe", $False) 
</code></pre>
<h3 id="showwindowasync">ShowWindowAsync</h3>

<p><a href="https://learn.microsoft.com/ru-ru/windows/win32/api/winuser/nf-winuser-showwindowasync">Function</a></p>
<pre><code class="language-PowerShell">$Signature = @"
[DllImport("user32.dll")]public static extern bool ShowWindowAsync(IntPtr hWnd, int nCmdShow);
"@
$ShowWindowAsync = Add-Type -MemberDefinition $Signature -Name "Win32ShowWindowAsync" -Namespace Win32Functions -PassThru
$ShowWindowAsync | Get-Member -Static
$ShowWindowAsync::ShowWindowAsync((Get-Process -Id $pid).MainWindowHandle, 2)
$ShowWindowAsync::ShowWindowAsync((Get-Process -Id $Pid).MainWindowHandle, 3)
$ShowWindowAsync::ShowWindowAsync((Get-Process -Id $Pid).MainWindowHandle, 4)
</code></pre>
<h3 id="getasynckeystate">GetAsyncKeyState</h3>

<p><a href="https://learn.microsoft.com/ru-ru/windows/win32/api/winuser/nf-winuser-getasynckeystate">Function</a></p>

<p><code class="language-plaintext highlighter-rouge">Add-Type -AssemblyName System.Windows.Forms</code> <br />
<code class="language-plaintext highlighter-rouge">[int][System.Windows.Forms.Keys]::F1</code> –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–æ–º–µ—Ä [Int] –∫–ª–∞–≤–∏—à–∏ –ø–æ –µ–µ –Ω–∞–∑–≤–∞–Ω–∏—é <br />
<code class="language-plaintext highlighter-rouge">65..90 | % {"{0} = {1}" -f $_, [System.Windows.Forms.Keys]$_}</code> –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –±—É–∫–≤ (A..Z)</p>
<pre><code class="language-PowerShell">function Get-ControlKey {
$key = 112
$Signature = @'
[DllImport("user32.dll", CharSet=CharSet.Auto, ExactSpelling=true)] 
public static extern short GetAsyncKeyState(int virtualKeyCode); 
'@
Add-Type -MemberDefinition $Signature -Name Keyboard -Namespace PsOneApi
[bool]([PsOneApi.Keyboard]::GetAsyncKeyState($key) -eq -32767)
}

Write-Warning 'Press F1 to exit'
while ($true) {
Write-Host '.' -NoNewline
if (Get-ControlKey) {
break
}
Start-Sleep -Seconds 0.5
}
</code></pre>
<h1 id="console-api">Console API</h1>

<p><a href="https://powershell.one/tricks/input-devices/detect-key-press">Source</a></p>

<p><code class="language-plaintext highlighter-rouge">[Console] | Get-Member -Static</code> <br />
<code class="language-plaintext highlighter-rouge">[Console]::BackgroundColor = "Blue"</code> <br />
<code class="language-plaintext highlighter-rouge">[Console]::OutputEncoding</code> –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding("utf-8")</code> –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥–∏—Ä–æ–≤–∫—É –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã <br />
<code class="language-plaintext highlighter-rouge">[Console]::outputEncoding = [System.Text.Encoding]::GetEncoding("cp866")</code> –¥–ª—è ISE <br />
<code class="language-plaintext highlighter-rouge">[Console]::OutputEncoding = [System.Text.Encoding]::GetEncoding("windows-1251")</code> –¥–ª—è ps2exe <br />
<code class="language-plaintext highlighter-rouge">Get-Service | Out-File $home\Desktop\Service.txt -Encoding oem</code> &gt; <br />
<code class="language-plaintext highlighter-rouge">Get-Service | Out-File $home\Desktop\Service.txt -Append</code>¬†¬ª</p>
<pre><code class="language-PowerShell">do {
if ([Console]::KeyAvailable) {
$keyInfo = [Console]::ReadKey($true)
break
}
Write-Host "." -NoNewline
sleep 1
} while ($true)
Write-Host
$keyInfo

function Get-KeyPress {
param (
[Parameter(Mandatory)][ConsoleKey]$Key,
[System.ConsoleModifiers]$ModifierKey = 0
)
if ([Console]::KeyAvailable) {
$pressedKey = [Console]::ReadKey($true)
$isPressedKey = $key -eq $pressedKey.Key
if ($isPressedKey) {
$pressedKey.Modifiers -eq $ModifierKey
} else {
[Console]::Beep(1800, 200)
$false
}}}

Write-Warning 'Press Ctrl+Shift+Q to exit'
do {
Write-Host "." -NoNewline
$pressed = Get-KeyPress -Key Q -ModifierKey 'Control,Shift'
if ($pressed) {break}
sleep 1
} while ($true)
</code></pre>
<h1 id="drawing">Drawing</h1>

<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.drawing?view=net-7.0&amp;redirectedfrom=MSDN">API</a></p>
<pre><code class="language-PowerShell">Add-Type -AssemblyName System.Drawing
$Width = 800
$Height = 400
$image = New-Object System.Drawing.Bitmap($Width,$Height)
$graphic = [System.Drawing.Graphics]::FromImage($image)
$background_color = [System.Drawing.Brushes]::Blue # –∑–∞–¥–∞—Ç—å —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ (—Å–∏–Ω–∏–π)
$graphic.FillRectangle($background_color, 0, 0, $image.Width, $image.Height)
$text_color = [System.Drawing.Brushes]::White # –∑–∞–¥–∞—Ç—å —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ (–±–µ–ª—ã–π)
$font = New-Object System.Drawing.Font("Arial", 20, [System.Drawing.FontStyle]::Bold) # –∑–∞–¥–∞—Ç—å —à—Ä–∏—Ñ—Ç
$text = "PowerShell" # —É–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç
$text_position = New-Object System.Drawing.RectangleF(320, 180, 300, 100)  # –∑–∞–¥–∞—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ (x, y, width, height)
$graphic.DrawString($text, $font, $text_color, $text_position) # –Ω–∞–Ω–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
$image.Save("$home\desktop\powershell_image.bmp", [System.Drawing.Imaging.ImageFormat]::Bmp) # —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
$image.Dispose() # –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
</code></pre>
<p><code class="language-plaintext highlighter-rouge">$path = "$home\desktop\powershell_image.bmp"</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-Item $path</code></p>
<pre><code class="language-PowerShell">$src_image = [System.Drawing.Image]::FromFile($path)
$Width = 400
$Height = 200
$dst_image = New-Object System.Drawing.Bitmap -ArgumentList $src_image, $Width, $Height # –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
$dst_image.Save("$home\desktop\powershell_image_resize.bmp", [System.Drawing.Imaging.ImageFormat]::Bmp)

$rotated_image = $src_image.Clone() # —Å–æ–∑–¥–∞—Ç—å –∫–æ–ø–∏—é –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
$rotated_image.RotateFlip([System.Drawing.RotateFlipType]::Rotate180FlipNone) # –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ 180 –≥—Ä–∞–¥—É—Å–æ–≤
$rotated_image.Save("$home\desktop\powershell_image_rotated.bmp", [System.Drawing.Imaging.ImageFormat]::Bmp)
$src_image.Dispose() # –∑–∞–∫—Ä—ã—Ç—å (–æ—Ç–ø—É—Å—Ç–∏—Ç—å) –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª
</code></pre>
<h1 id="objectevent">ObjectEvent</h1>
<pre><code class="language-PowerShell">$Timer = New-Object System.Timers.Timer
$Timer.Interval = 1000
Register-ObjectEvent -InputObject $Timer -EventName Elapsed -SourceIdentifier Timer.Output -Action {
$Random = Get-Random -Min 0 -Max 100
Write-Host $Random 
}
$Timer.Enabled = $True
</code></pre>
<p><code class="language-plaintext highlighter-rouge">$Timer.Enabled = $False</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å <br />
<code class="language-plaintext highlighter-rouge">$Timer | Get-Member -MemberType Event</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –æ–±—ä–µ–∫—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-EventSubscriber</code> —Å–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ —Å–æ–±—ã—Ç–∏—è –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">Unregister-Event -SourceIdentifier Timer.Output</code> —É–¥–∞–ª—è–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ –ø–æ –∏–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏—è (EventName) –∏–ª–∏ –≤—Å–µ * <br />
<code class="language-plaintext highlighter-rouge">-Forward</code> –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å–µ–∞–Ω—Å–∞ (New-PSSession) –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ–∞–Ω—Å <br />
<code class="language-plaintext highlighter-rouge">-SupportEvent</code> –Ω–µ –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏—è –Ω–∞ —ç–∫—Ä–∞–Ω (–∏ Get-EventSubscriber –∏ Get-Job)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Register-EngineEvent -SourceIdentifier PowerShell.Exiting -Action {
$date = Get-Date -f hh:mm:ss
(New-Object -ComObject Wscript.Shell).Popup("PowerShell Exit: $date",0,"Action",64)
}
</code></pre></div></div>
<h1 id="sockets">Sockets</h1>

<h3 id="udp-socket">UDP Socket</h3>
<p><a href="https://cloudbrothers.info/en/test-udp-connection-powershell/">Source</a></p>
<pre><code class="language-PowerShell">function Start-UDPServer {
param(
$Port = 5201
)
$RemoteComputer = New-Object System.Net.IPEndPoint([System.Net.IPAddress]::Any, 0)
do {
$UdpObject = New-Object System.Net.Sockets.UdpClient($Port)
$ReceiveBytes = $UdpObject.Receive([ref]$RemoteComputer)
$UdpObject.Close()
$ASCIIEncoding = New-Object System.Text.ASCIIEncoding
[string]$ReturnString = $ASCIIEncoding.GetString($ReceiveBytes)
[PSCustomObject]@{
LocalDateTime = $(Get-Date -UFormat "%Y-%m-%d %T")
ClientIP      = $RemoteComputer.address.ToString()
ClientPort    = $RemoteComputer.Port.ToString()
Message       = $ReturnString
}
} while (1)
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Start-UDPServer -Port 5201</code></p>

<h3 id="test-netudpconnection">Test-NetUDPConnection</h3>
<pre><code class="language-PowerShell">function Test-NetUDPConnection {
param(
[string]$ComputerName = "127.0.0.1",
[int32]$PortServer    = 5201,
[int32]$PortClient    = 5211,
$Message
)
begin {
$UdpObject = New-Object system.Net.Sockets.Udpclient($PortClient)
$UdpObject.Connect($ComputerName, $PortServer)
}
process {
$ASCIIEncoding = New-Object System.Text.ASCIIEncoding
if (!$Message) {$Message = Get-Date -UFormat "%Y-%m-%d %T"}
$Bytes = $ASCIIEncoding.GetBytes($Message)
[void]$UdpObject.Send($Bytes, $Bytes.length)
}
end {
$UdpObject.Close()
}
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Test-NetUDPConnection -ComputerName 127.0.0.1 -PortServer 5201</code> <br />
<code class="language-plaintext highlighter-rouge">Test-NetUDPConnection -ComputerName 127.0.0.1 -PortServer 514 -Message "&lt;30&gt;May 31 00:00:00 HostName multipathd[784]: Test message"</code></p>

<h3 id="tcp-socket">TCP Socket</h3>
<pre><code class="language-PowerShell">function Start-TCPServer {
param(
$Port = 5201
)
do {
$TcpObject = New-Object System.Net.Sockets.TcpListener($port)
$ReceiveBytes = $TcpObject.Start()
$ReceiveBytes = $TcpObject.AcceptTcpClient()
$TcpObject.Stop()
$ReceiveBytes.Client.RemoteEndPoint | select Address,Port
} while (1)
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Start-TCPServer -Port 5201</code> <br />
<code class="language-plaintext highlighter-rouge">Test-NetConnection -ComputerName 127.0.0.1 -Port 5201</code></p>

<h3 id="wakeonlan">WakeOnLan</h3>
<p>Broadcast package consisting of 6 byte filled ‚Äú0xFF‚Äù and then 96 byte where the mac address is repeated 16 times</p>
<pre><code class="language-PowerShell">function Send-WOL {
param (
[Parameter(Mandatory = $True)]$Mac,
$IP,
[int]$Port = 9
)
$Mac = $Mac.replace(":", "-")
if (!$IP) {$IP = [System.Net.IPAddress]::Broadcast}
$SynchronizationChain = [byte[]](,0xFF * 6)
$ByteMac = $Mac.Split("-") | %{[byte]("0x" + $_)}
$Package = $SynchronizationChain + ($ByteMac * 16)
$UdpClient = New-Object System.Net.Sockets.UdpClient
$UdpClient.Connect($IP, $port)
$UdpClient.Send($Package, $Package.Length)
$UdpClient.Close()
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Send-WOL -Mac "D8-BB-C1-70-A3-4E"</code> <br />
<code class="language-plaintext highlighter-rouge">Send-WOL -Mac "D8-BB-C1-70-A3-4E" -IP 192.168.3.100</code></p>

<h3 id="encoding">Encoding</h3>
<p><code class="language-plaintext highlighter-rouge">$ByteText = [System.Text.Encoding]::UTF8.GetBytes("password")</code> <br />
<code class="language-plaintext highlighter-rouge">$Text = [System.Text.Encoding]::UTF8.GetString($ByteText)</code></p>

<h3 id="base64">Base64</h3>
<p><code class="language-plaintext highlighter-rouge">$text = "password"</code> <br />
<code class="language-plaintext highlighter-rouge">$byte = [System.Text.Encoding]::Unicode.GetBytes($text)</code> <br />
<code class="language-plaintext highlighter-rouge">$base64 = [System.Convert]::ToBase64String($byte)</code> <br />
<code class="language-plaintext highlighter-rouge">$decode_base64 = [System.Convert]::FromBase64String($base64)</code> <br />
<code class="language-plaintext highlighter-rouge">$decode_string = [System.Text.Encoding]::Unicode.GetString($decode_base64)</code></p>

<p><code class="language-plaintext highlighter-rouge">$path_image = "$home\Documents\1200x800.jpg"</code> <br />
<code class="language-plaintext highlighter-rouge">$BBase64 = [System.Convert]::ToBase64String((Get-Content $path_image -Encoding Byte))</code> <br />
<code class="language-plaintext highlighter-rouge">Add-Type -assembly System.Drawing</code> <br />
<code class="language-plaintext highlighter-rouge">$Image = [System.Drawing.Bitmap]::FromStream([IO.MemoryStream][Convert]::FromBase64String($BBase64))</code> <br />
<code class="language-plaintext highlighter-rouge">$Image.Save("$home\Desktop\1200x800.jpg")</code></p>

<h3 id="http-listener">HTTP Listener</h3>
<pre><code class="language-PowerShell">$httpListener = New-Object System.Net.HttpListener
$httpListener.Prefixes.Add("http://+:8888/")
$httpListener.Start()
while (!([console]::KeyAvailable)) {
$info = Get-Service | select name,status | ConvertTo-HTML
$context = $httpListener.GetContext()
$context.Response.StatusCode = 200
$context.Response.ContentType = 'text/HTML'
$WebContent = $info
$EncodingWebContent = [Text.Encoding]::UTF8.GetBytes($WebContent)
$context.Response.OutputStream.Write($EncodingWebContent , 0, $EncodingWebContent.Length)
$context.Response.Close()
Get-NetTcpConnection -LocalPort 8888
(Get-Date).datetime
}
$httpListener.Close()
</code></pre>
<h3 id="webclient">WebClient</h3>
<p><code class="language-plaintext highlighter-rouge">[System.Net.WebClient] | Get-Member</code> <br />
<code class="language-plaintext highlighter-rouge">(New-Object Net.WebClient).DownloadString("https://raw.githubusercontent.com/Lifailon/PowerShell-Commands/rsa/README.md")</code></p>

<h3 id="certificate">Certificate</h3>
<pre><code class="language-PowerShell">function Get-WebCertificate ($srv) {
$iwr = iwr $srv
$status_code = $iwr.StatusCode
$status = $iwr.BaseResponse.StatusCode
$info = $iwr.BaseResponse.Server
$spm = [System.Net.ServicePointManager]::FindServicePoint($srv)
$date_end = $spm.Certificate.GetExpirationDateString()
$cert_name = ($spm.Certificate.Subject) -replace "CN="
$cert_owner = ((($spm.Certificate.Issuer) -split ", ") | where {$_ -match "O="}) -replace "O="
$Collections = New-Object System.Collections.Generic.List[System.Object]
$Collections.Add([PSCustomObject]@{
Host = $srv;
Server = $info;
Status =  $status;
StatusCode = $status_code;
Certificate = $cert_name;
Issued = $cert_owner;
End = $date_end
})
$Collections
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Get-WebCertificate https://google.com</code></p>

<h1 id="excel">Excel</h1>
<pre><code class="language-PowerShell">$path = "$home\Desktop\Services-to-Excel.xlsx"
$Excel = New-Object -ComObject Excel.Application
$Excel.Visible = $false` –æ—Ç–∫–ª—é—á–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç–∏–µ GUI
$ExcelWorkBook = $Excel.Workbooks.Add()` –°–æ–∑–¥–∞—Ç—å –∫–Ω–∏–≥—É
$ExcelWorkSheet = $ExcelWorkBook.Worksheets.Item(1)` –°–æ–∑–¥–∞—Ç—å –ª–∏—Å—Ç
$ExcelWorkSheet.Name = "Services"` –∑–∞–¥–∞—Ç—å –∏–º—è –ª–∏—Å—Ç–∞
$ExcelWorkSheet.Cells.Item(1,1) = "Name service"
# –ó–∞–¥–∞—Ç—å –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤:
$ExcelWorkSheet.Cells.Item(1,2) = "Description"
$ExcelWorkSheet.Cells.Item(1,3) = "Status"
$ExcelWorkSheet.Cells.Item(1,4) = "Startup type"
$ExcelWorkSheet.Rows.Item(1).Font.Bold = $true` –≤—ã–¥–µ–ª–∏—Ç—å –∂–∏—Ä–Ω—ã–º —à—Ä–∏—Ñ—Ç–æ–º
$ExcelWorkSheet.Rows.Item(1).Font.size=14
# –ó–∞–¥–∞—Ç—å —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–æ–∫:
$ExcelWorkSheet.Columns.Item(1).ColumnWidth=30
$ExcelWorkSheet.Columns.Item(2).ColumnWidth=80
$ExcelWorkSheet.Columns.Item(3).ColumnWidth=15
$ExcelWorkSheet.Columns.Item(4).ColumnWidth=25
$services =  Get-Service
$counter = 2` –∑–∞–¥–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏
foreach ($service in $services) {
$status = $service.Status
if ($status -eq 1) {
$status_type = "Stopped"
} elseif ($status -eq 4) {
$status_type = "Running"
}
$Start = $service.StartType
if ($Start -eq 1) {
$start_type = "Delayed start"
} elseif ($Start -eq 2) {
$start_type = "Automatic"
} elseif ($Start -eq 3) {
$start_type = "Manually"
} elseif ($Start -eq 4) {
$start_type = "Disabled"
}
$ExcelWorkSheet.Columns.Item(1).Rows.Item($counter) = $service.Name
$ExcelWorkSheet.Columns.Item(2).Rows.Item($counter) = $service.DisplayName
$ExcelWorkSheet.Columns.Item(3).Rows.Item($counter) = $status_type
$ExcelWorkSheet.Columns.Item(4).Rows.Item($counter) = $start_type
if ($status_type -eq "Running") {
$ExcelWorkSheet.Columns.Item(3).Rows.Item($counter).Font.Bold = $true
}
$counter++` +1 —É–≤–µ–ª–∏—á–∏—Ç—å –¥–ª—è —Å—á–µ—Ç—á–∏–∫–∞ —Å—Ç—Ä–æ–∫–∏ Rows
}
$ExcelWorkBook.SaveAs($path)
$ExcelWorkBook.close($true)
$Excel.Quit()
</code></pre>
<h3 id="excelapplicationopen">Excel.Application.Open</h3>
<pre><code class="language-PowerShell">$path = "$home\Desktop\Services-to-Excel.xlsx"
$Excel = New-Object -ComObject Excel.Application
$Excel.Visible = $false
$ExcelWorkBook = $excel.Workbooks.Open($path)` –æ—Ç–∫—Ä—ã—Ç—å xlsx-—Ñ–∞–π–ª
$ExcelWorkBook.Sheets | select Name,Index` –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ª–∏—Å—Ç—ã
$ExcelWorkSheet = $ExcelWorkBook.Sheets.Item(1)` –æ—Ç–∫—Ä—ã—Ç—å –ª–∏—Å—Ç –ø–æ –Ω–æ–º–µ—Ä—É Index
1..100 | %{$ExcelWorkSheet.Range("A$_").Text}` –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ –ê —Å—Ç—Ä–æ–∫–∏ c 1 –ø–æ 100
$Excel.Quit()
</code></pre>
<h3 id="importexcel">ImportExcel</h3>
<p><code class="language-plaintext highlighter-rouge">Install-Module -Name ImportExcel</code> <br />
<code class="language-plaintext highlighter-rouge">$data | Export-Excel .\Data.xlsx</code> <br />
<code class="language-plaintext highlighter-rouge">$data = Import-Excel .\Data.xlsx</code></p>

<p><code class="language-plaintext highlighter-rouge">$data = ps</code> <br />
<code class="language-plaintext highlighter-rouge">$Chart = New-ExcelChartDefinition -XRange CPU -YRange WS -Title "Process" -NoLegend</code> <br />
<code class="language-plaintext highlighter-rouge">$data | Export-Excel .\ps.xlsx -AutoNameRange -ExcelChartDefinition $Chart -Show</code></p>

<h1 id="csv">CSV</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Service | Select Name,DisplayName,Status,StartType | Export-Csv -path "$home\Desktop\Get-Service.csv" -Append -Encoding Default</code> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ csv (-Encoding UTF8) <br />
<code class="language-plaintext highlighter-rouge">Import-Csv "$home\Desktop\Get-Service.csv" -Delimiter ","</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤</p>
<pre><code class="language-PowerShell">$data = ConvertFrom-Csv @"
Region,State,Units,Price
West,Texas,927,923.71
$null,Tennessee,466,770.67
"@
</code></pre>
<p><code class="language-plaintext highlighter-rouge">$systeminfo = systeminfo /FO csv | ConvertFrom-Csv</code> –≤—ã–≤–æ–¥ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ CSV –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –æ–±—ä–µ–∫—Ç <br />
<code class="language-plaintext highlighter-rouge">$systeminfo."–ü–æ–ª–Ω—ã–π –æ–±—ä–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏"</code> <br />
<code class="language-plaintext highlighter-rouge">$systeminfo."–î–æ—Å—Ç—É–ø–Ω–∞—è —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç—å"</code></p>

<h3 id="convertfrom-string">ConvertFrom-String</h3>
<pre><code class="language-PowerShell">'
log = 
{
   level = 4;
};
' | ConvertFrom-String` —Å–æ–∑–¥–∞–µ—Ç PSCustomObject (—Ä–∞–∑–±–∏–≤–∞–µ—Ç –ø–æ –ø—Ä–æ–±–µ–ª–∞–º, —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã –∏ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏)
</code></pre>
<h3 id="convertfrom-stringdata">ConvertFrom-StringData</h3>
<pre><code class="language-PowerShell">"
key1 = value1
key2 = value2
" | ConvertFrom-StringData # —Å–æ–∑–¥–∞–µ—Ç Hashtable
</code></pre>
<h1 id="xml">XML</h1>
<pre><code class="language-PowerShell">$xml = [xml](Get-Content $home\desktop\test.rdg)` –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ XML-—Ñ–∞–π–ª–∞
$xml.load("$home\desktop\test.rdg")` –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª
$xml.RDCMan.file.group.properties.name` –∏–º–µ–Ω–∞ –≥—Ä—É–ø–ø
$xml.RDCMan.file.group.server.properties` –∏–º–µ–Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
$xml.RDCMan.file.group[3].server.properties` —Å–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ 4-–π –≥—Ä—É–ø–ø–µ
($xml.RDCMan.file.group[3].server.properties | ? name -like ADIRK).Name = "New-Name"` –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
$xml.RDCMan.file.group[3].server[0].properties.displayName = "New-displayName" 
$xml.RDCMan.file.group[3].server[1].RemoveAll()` —É–¥–∞–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç (2-–π —Å–µ—Ä–≤–µ—Ä –≤ —Å–ø–∏—Å–∫–µ)
$xml.Save($file)` —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–±—ä–µ–∫—Ç–∞ –≤ —Ñ–∞–π–ª–∞
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Get-Service | Export-Clixml -path $home\desktop\test.xml</code> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç PowerShell –≤ XML <br />
<code class="language-plaintext highlighter-rouge">Import-Clixml -Path $home\desktop\test.xml</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç XML –≤ PowerShell <br />
<code class="language-plaintext highlighter-rouge">ConvertTo-Xml (Get-Service)</code></p>

<h3 id="get-credtoxml">Get-CredToXML</h3>
<pre><code class="language-PowerShell">function Get-CredToXML {
    param (
        $CredFile = "$home\Documents\cred.xml"
    )
    if (Test-Path $CredFile) {
        Import-Clixml -path $CredFile
    }
    elseif (!(Test-Path $CredFile)) {
        $Cred = Get-Credential -Message "Enter credential"
        if ($Cred -ne $null) {
        $Cred | Export-CliXml -Path $CredFile
        $Cred
    }
    else {
        return
    }
    }
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">$Cred = Get-CredToXML</code> <br />
<code class="language-plaintext highlighter-rouge">$Login = $Cred.UserName</code> <br />
<code class="language-plaintext highlighter-rouge">$PasswordText = $Cred.GetNetworkCredential().password</code> –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–µ</p>

<h3 id="xmlwriter-extensible-markup-language">XmlWriter (Extensible Markup Language)</h3>
<pre><code class="language-PowerShell">$XmlWriterSettings = New-Object System.Xml.XmlWriterSettings
$XmlWriterSettings.Indent = $true` –≤–∫–ª—é—á–∏—Ç—å –æ—Ç—Å—Ç—É–ø—ã
$XmlWriterSettings.IndentChars = "    "` –∑–∞–¥–∞—Ç—å –æ—Ç—Å—Ç—É–ø

$XmlFilePath = "$home\desktop\test.xml"
$XmlObjectWriter = [System.XML.XmlWriter]::Create($XmlFilePath, $XmlWriterSettings)` —Å–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç
$XmlObjectWriter.WriteStartDocument()` –Ω–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å –≤ –¥–æ–∫—É–º–µ–Ω—Ç

$XmlObjectWriter.WriteComment("Comment")
$XmlObjectWriter.WriteStartElement("Root")` —Å–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ—á–µ—Ä–Ω–∏–µ –æ–±—ä–µ–∫—Ç—ã
    $XmlObjectWriter.WriteStartElement("Configuration")` —Å–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –¥–æ—á–µ—Ä–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è BaseSettings
        $XmlObjectWriter.WriteElementString("Language","RU")
        $XmlObjectWriter.WriteStartElement("Fonts")   		# &lt;Fonts&gt;
            $XmlObjectWriter.WriteElementString("Name","Arial")
            $XmlObjectWriter.WriteElementString("Size","12")
        $XmlObjectWriter.WriteEndElement()               	# &lt;/Fonts&gt;
    $XmlObjectWriter.WriteEndElement()` –∫–æ–Ω–µ—á–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç &lt;/Configuration&gt;
$XmlObjectWriter.WriteEndElement()` –∫–æ–Ω–µ—á–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç &lt;/Root&gt;

$XmlObjectWriter.WriteEndDocument()` –∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –¥–æ–∫—É–º–µ–Ω—Ç
$XmlObjectWriter.Flush()
$XmlObjectWriter.Close()
</code></pre>
<h3 id="createelement">CreateElement</h3>
<pre><code class="language-PowerShell">$xml = [xml](gc $home\desktop\test.xml)
$xml.Root.Configuration.Fonts
$NewElement = $xml.CreateElement("Fonts")` –≤—ã–±—Ä–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∫—É–¥–∞ –¥–æ–±–∞–≤–∏—Ç—å
$NewElement.set_InnerXML("&lt;Name&gt;Times New Roman&lt;/Name&gt;&lt;Size&gt;14&lt;/Size&gt;")` –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –¥–æ—á–µ—Ä–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã Fonts
$xml.Root.Configuration.AppendChild($NewElement)` –¥–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–æ–π –≤ Configuration (—Ä–æ–¥–∏—Ç–µ–ª—å Fonts)
$xml.Save("$home\desktop\test.xml")
</code></pre>
<h1 id="json">JSON</h1>
<pre><code class="language-PowerShell">$log = '
{
  "log": {
    "level": 7
  }
}
' | ConvertFrom-Json

Get-Service | ConvertTo-Json

$OOKLA  = '
{
"result" : 
{"date":1683534970,"id":"14708271987","connection_icon":"wireless","download":33418,"upload":35442,"latency":15,"distance":50,"country_code":"RU","server_id":2707,"server_name":"Bryansk","sponsor_name":"DOM.RU","sponsor_url":null,"connection_mode":"multi","isp_name":"Resource Link","isp_rating":"4.0","test_rank":63,"test_grade":"B-","test_rating":4,"idle_latency":"17","download_latency":"116","upload_latency":"75","additional_servers":
[{"server_id":8191,"server_name":"Bryansk","sponsor_name":"SectorTelecom.ru"},{"server_id":46278,"server_name":"Fokino","sponsor_name":"Fokks - Promyshlennaya avtomatika Ltd."},{"server_id":18218,"server_name":"Bryansk","sponsor_name":"RIA-link Ltd."}],
"path":"result\u002F14708271987","hasSecondary":true
}
}
' | ConvertFrom-Json
$ookla.result
</code></pre>
<h1 id="yaml">YAML</h1>
<pre><code class="language-PowerShell">Import-Module PSYaml` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Docker/Ansible
$netplan = "
network:` —Å–ª–æ–≤–∞—Ä—å –ø–æ —Ç–∏–ø—É - –∫–ª—é—á : –∑–Ω–∞—á–µ–Ω–∏–µ —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Å–ª–æ–≤–∞—Ä—è–º–∏
  ethernets:
    ens160:
      dhcp4: yes
      dhcp6: no
      nameservers:
        addresses:` [8.8.8.8, 1.1.1.1]` —Å–ø–∏—Å–æ–∫ –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–∫)
		  - 8.8.8.8
		  - 1.1.1.1
  version: 2
"
$network = ConvertFrom-Yaml $netplan
$network.Values.ethernets.ens160.nameservers

$DataType = "
int: !!int 10.1
flo: !!float 10.1
str: !!str string
bool: !!bool` boolean
"
</code></pre>
<h1 id="html">HTML</h1>

<h3 id="convertfrom-html">ConvertFrom-Html</h3>
<pre><code class="language-PowerShell">function ConvertFrom-Html {
    param (
        [Parameter(ValueFromPipeline)]$url
    )
    $irm = Invoke-RestMethod $url
    $HTMLFile = New-Object -ComObject HTMLFile
    $Bytes = [System.Text.Encoding]::Unicode.GetBytes($irm)
    $HTMLFile.write($Bytes)
    ($HTMLFile.all | where {$_.tagname -eq "body"}).innerText
}

$apache_status = "http://192.168.3.102/server-status"
$apache_status | ConvertFrom-Html
</code></pre>
<h3 id="convertto-html">ConvertTo-Html</h3>

<p><code class="language-plaintext highlighter-rouge">Get-Process | select Name, CPU | ConvertTo-Html -As Table &gt; "$home\desktop\proc-table.html"</code> –≤—ã–≤–æ–¥ –≤ —Ñ–æ—Ä–º–∞—Ç–µ List (Format-List) –∏–ª–∏ Table (Format-Table)</p>
<pre><code class="language-PowerShell">$servers = "ya.ru","ya.com","google.com"
$path = "$home\Desktop\Ping.html" 
$header = @"
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"&gt;
&lt;head&gt;
&lt;title&gt;–û—Ç—á–µ—Ç –æ —Å—Ç–∞—Ç—É—Å–µ —Å–µ—Ä–≤–µ—Ä–æ–≤&lt;/title&gt;
&lt;style type="text/css"&gt;
&lt;!--
body {
background-color: #E0E0E0;
font-family: sans-serif
}
table, th, td {
background-color: white;
border-collapse:collapse;
border: 1px solid black;
padding: 5px
}
--&gt;
&lt;/style&gt;
"@
$body = @"
&lt;h1&gt;Ping status&lt;/h1&gt;
&lt;p&gt;$(get-date -Format "dd.MM.yyyy hh:mm").&lt;/p&gt;
"@
$results = foreach ($server in $servers) { 
    if (Test-Connection $server -Count 1 -ea 0 -Quiet) { 
        $status = "Up" 
    }
    else { 
        $status = "Down"
    }
    [PSCustomObject]@{
        Name = $server
        Status = $status
    }
}
$results | ConvertTo-Html -head $header -body $body | foreach {
    $_ -replace "&lt;td&gt;Down&lt;/td&gt;","&lt;td style='background-color:#FF8080'&gt;Down&lt;/td&gt;" -replace "&lt;td&gt;Up&lt;/td&gt;","&lt;td style='background-color:#5BCCF3'&gt;Up&lt;/td&gt;"
} | Out-File $path
Invoke-Item $path
</code></pre>
<h3 id="pswritehtml">PSWriteHTML</h3>
<pre><code class="language-PowerShell">Import-Module PSWriteHTML
(Get-Module PSWriteHTML).ExportedCommands
Get-Service | Out-GridHtml -FilePath ~\Desktop\Get-Service-Out-GridHtml.html
</code></pre>
<h3 id="htmlreport">HtmlReport</h3>
<pre><code class="language-PowerShell">Import-Module HtmlReport
$topVM = ps | Sort PrivateMemorySize -Descending | Select -First 10 | %{,@(($_.ProcessName + " " + $_.Id), $_.PrivateMemorySize)}
$topCPU = ps | Sort CPU -Descending | Select -First 10 | %{,@(($_.ProcessName + " " + $_.Id), $_.CPU)}
New-Report -Title "Piggy Processes" -Input {
New-Chart Bar "Top VM Users" -input $topVm
New-Chart Column "Top CPU Overall" -input $topCPU
ps | Select ProcessName, Id, CPU, WorkingSet, *MemorySize | New-Table "All Processes"
} &gt; ~\Desktop\Get-Process-HtmlReport.html
</code></pre>
<h1 id="htmlagilitypack">HtmlAgilityPack</h1>

<p><a href="https://www.nuget.org/packages/HtmlAgilityPack">Source</a></p>
<pre><code class="language-PowerShell"># –ó–∞–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ C#, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∞—Ä—Å–∏—Ç—å HTML-–¥–æ–∫—É–º–µ–Ω—Ç—ã, –≤—ã–±–∏—Ä–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã DOM –∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å –∏–∑ –Ω–∏—Ö –¥–∞–Ω–Ω—ã–µ
Add-Type -Path "C:\Users\Lifailon\Downloads\HtmlAgilityPack\Net40\HtmlAgilityPack.dll"
$title = "–Ω–æ–≤–æ–±—Ä–∞–Ω–µ—Ü"
$url = "http://fasts-torrent.net"
$ep = "engine/ajax/search_torrent.php?title=$title"
$html = Invoke-RestMethod "$url/$ep"
# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ HtmlDocument –∏–∑ HtmlAgilityPack, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ HTML-–∫–æ–¥–∞
$HtmlDocument = New-Object HtmlAgilityPack.HtmlDocument
# –ó–∞–≥—Ä—É–∑–∫–∞ HTML –≤ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç HtmlDocument
$HtmlDocument.LoadHtml($html)
$torrents = @()
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ XPath –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ &lt;tr&gt; (—Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã) –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
$HtmlDocument.DocumentNode.SelectNodes("//tr") | ForEach-Object {
    # –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –≤—ã–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—é —Ä–∞–∑–¥–∞—á–∏, —Ä–∞–∑–º–µ—Ä—É –∏ —Å—Å—ã–ª–∫–µ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è.
    $titleNode = $_.SelectSingleNode(".//td[@class='torrent-title']")
    $sizeNode = $_.SelectSingleNode(".//td[@class='torrent-sp']")
    $downloadLinkNode = $_.SelectSingleNode(".//td[@class='torrent-d-btn']/a")
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –∫–ª–∞—Å—Å—ã –Ω–∞–π–¥–µ–Ω—ã
    if ($titleNode -ne $null -and $sizeNode -ne $null -and $downloadLinkNode -ne $null) {
        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –∫–ª–∞—Å—Å–æ–≤
        $title = $titleNode.InnerText.Trim()
        $size = $sizeNode.InnerText.Trim()
        $downloadLink = $downloadLinkNode.Attributes["href"].Value
        $torrent = New-Object PSObject -Property @{
            Title = $title
            Size = $size
            DownloadLink = "$($url)$($downloadLink)"
        }
        $torrents += $torrent
    }
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">$torrents</code></p>
<pre><code class="language-PowerShell">Title                                                                    Size     DownloadLink
-----                                                                    ----     ------------
–ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü (6 —Å–µ–∑–æ–Ω: 1-3 —Å–µ—Ä–∏–∏ –∏–∑ 13) (2024) WEBRip | RuDub              1,55 –ì–ë  http://fasts-torrent.net/download/449613/torrent/-6-1-3-13-2024-webrip-rudub/
–ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü (5 —Å–µ–∑–æ–Ω: 1-22 —Å–µ—Ä–∏–∏ –∏–∑ 22) (2023) WEBRip 1080p | RuDub       54,15 –ì–ë http://fasts-torrent.net/download/433749/torrent/-5-1-22-22-2023-webrip-1080p-rudub/
–ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü (5 —Å–µ–∑–æ–Ω: 1-22 —Å–µ—Ä–∏–∏ –∏–∑ 22) (2023) WEBRip 720p | RuDub        30,14 –ì–ë http://fasts-torrent.net/download/433750/torrent/-5-1-22-22-2023-webrip-720p-rudub/
–ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü (5 —Å–µ–∑–æ–Ω: 1-22 —Å–µ—Ä–∏–∏ –∏–∑ 22) (2023) WEBRip | RuDub             11,55 –ì–ë http://fasts-torrent.net/download/433751/torrent/-5-1-22-22-2023-webrip-rudub/
–ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü (4 —Å–µ–∑–æ–Ω: 1-22 —Å–µ—Ä–∏–∏ –∏–∑ 22) (2021) WEB-DL 720p | RG.Paravozik 21.33 Gb http://fasts-torrent.net/download/418618/torrent/-4-1-22-22-2021-web-dl-720p-rgparavozik/
–ü–æ–ª–∏—Ü–µ–π—Å–∫–∏–π —Å –ø–æ–ª–æ–≤–∏–Ω–æ–π: –ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü (2017) WEB-DLRip 720p| –ß–∏—Å—Ç—ã–π –∑–≤—É–∫   3.41 Gb  http://fasts-torrent.net/download/254846/torrent/-2017-web-dlrip-720p-/
–ü–æ–ª–∏—Ü–µ–π—Å–∫–∏–π —Å –ø–æ–ª–æ–≤–∏–Ω–æ–π: –ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü (2017) WEB-DLRip | –ß–∏—Å—Ç—ã–π –∑–≤—É–∫       1.37 Gb  http://fasts-torrent.net/download/254845/torrent/-2017-web-dlrip-/
–ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü (2 —Å–µ–∑–æ–Ω: 1-20 —Å–µ—Ä–∏–∏ –∏–∑ 20) (2019) WEBRip | BaibaKo           11.28 Gb http://fasts-torrent.net/download/364669/torrent/-2-1-20-20-2019-webrip-baibako/
–ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü (2 —Å–µ–∑–æ–Ω: 1-20 —Å–µ—Ä–∏–∏ –∏–∑ 20) (2019) WEBRip 1080p | Octopus     45.97 Gb http://fasts-torrent.net/download/364161/torrent/-2-1-20-20-2019-webrip-1080p-octopus/
–ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü (2 —Å–µ–∑–æ–Ω: 1-20 —Å–µ—Ä–∏–∏ –∏–∑ 20) (2019) WEB-DLRip | LostFilm       11.95 Gb http://fasts-torrent.net/download/364668/torrent/-2-1-20-20-2019-web-dlrip-lostfilm/
</code></pre>
<h1 id="sqlite">SQLite</h1>
<pre><code class="language-PowerShell">$path = "$home\Documents\Get-Service.db"
$Module = Get-Module MySQLite
if ($Module -eq $null) {
Install-Module MySQLite -Repository PSGallery -Scope CurrentUser
}
Import-Module MySQLite
New-MySQLiteDB -Path $path # —Å–æ–∑–¥–∞—Ç—å –ë–î
Invoke-MySQLiteQuery -Path $path -Query "CREATE TABLE Service (Name TEXT NOT NULL, DisplayName TEXT NOT NULL, Status TEXT NOT NULL);" # —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É

$Service = Get-Service | select Name,DisplayName,Status
foreach ($S in $Service) {
$Name = $S.Name
$DName = $S.DisplayName
$Status = $S.Status
Invoke-MySQLiteQuery -Path $path -Query "INSERT INTO Service (Name, DisplayName, Status) VALUES ('$Name', '$DName', '$Status');"
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">(Get-MySQLiteDB $path).Tables</code> —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ <br />
<code class="language-plaintext highlighter-rouge">Invoke-MySQLiteQuery -Path $path -Query "SELECT name FROM sqlite_master WHERE type='table';"</code> —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ <br />
<code class="language-plaintext highlighter-rouge">Invoke-MySQLiteQuery -Path $path -Query "DROP TABLE Service;"</code> —É–¥–∞–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É</p>
<pre><code class="language-PowerShell">$TableName = "Service"
Invoke-MySQLiteQuery -Path $path -Query "SELECT * FROM $TableName" # –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–∞–±–ª–∏—Ü—ã (–≤ —Ñ–æ—Ä–º–∞—Ç–µ –æ–±—ä–µ–∫—Ç–∞)
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Get-Service | select  Name,DisplayName,Status | ConvertTo-MySQLiteDB -Path $path -TableName Service -force</code> –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –≤ —Ç–∞–±–ª–∏—Ü—É</p>

<h3 id="database-password">Database password</h3>
<pre><code class="language-PowerShell">$Connection = New-SQLiteConnection -DataSource $path
$Connection.ChangePassword("password")
$Connection.Close()
Invoke-SqliteQuery -Query "SELECT * FROM Service" -DataSource "$path;Password=password"
</code></pre>
<h1 id="mysql">MySQL</h1>

<p><code class="language-plaintext highlighter-rouge">apt -y install mysql-server mysql-client</code> <br />
<code class="language-plaintext highlighter-rouge">mysql -V</code> <br />
<code class="language-plaintext highlighter-rouge">systemctl status mysql</code> <br />
<code class="language-plaintext highlighter-rouge">mysqladmin -u root password</code> –∑–∞–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å root</p>

<p><code class="language-plaintext highlighter-rouge">nano /etc/mysql/mysql.conf.d/mysqld.cnf</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[mysqld]
user            = mysql
# pid-file      = /var/run/mysqld/mysqld.pid
# socket        = /var/run/mysqld/mysqld.sock
# port          = 3306
# datadir       = /var/lib/mysql
# tmpdir                = /tmp
bind-address            = 0.0.0.0
mysqlx-bind-address     = 0.0.0.0
log_error = /var/log/mysql/error.log
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">systemctl restart mysql</code> <br />
<code class="language-plaintext highlighter-rouge">ss -tulnp | grep 3306</code> <br />
<code class="language-plaintext highlighter-rouge">ufw allow 3306/tcp</code> <br />
<code class="language-plaintext highlighter-rouge">nc -zv 192.168.1.253 3306</code> <br />
<code class="language-plaintext highlighter-rouge">tnc 192.168.1.253 -p 3306</code></p>

<p><code class="language-plaintext highlighter-rouge">mysql -u root -p</code> <br />
<code class="language-plaintext highlighter-rouge">SELECT user(), now(), version();</code> <br />
<code class="language-plaintext highlighter-rouge">quit;</code></p>

<p><code class="language-plaintext highlighter-rouge">mysql -u root -p -e 'SHOW TABLES FROM db_aduser;'</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –±–µ–∑ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–æ–Ω—Å–æ–ª–∏ MySQL</p>

<p><code class="language-plaintext highlighter-rouge">CREATE</code> —Å–æ–∑–¥–∞—Ç—å –ë–î, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ç–∞–±–ª–∏—Ü—É <br />
<code class="language-plaintext highlighter-rouge">ALTER</code>  —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Ç–∞–±–ª–∏—Ü–µ <br />
<code class="language-plaintext highlighter-rouge">DROP</code> —É–¥–∞–ª–∏—Ç—å –ë–î, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ç–∞–±–ª–∏—Ü—É <br />
<code class="language-plaintext highlighter-rouge">USE</code> –≤—ã–±—Ä–∞—Ç—å –ë–î <br />
<code class="language-plaintext highlighter-rouge">SHOW</code> –≤—ã–≤–µ—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ë–î, –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (GRANTS), –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞ <br />
<code class="language-plaintext highlighter-rouge">GRANT</code> –¥–∞—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∫ –ë–î <br />
<code class="language-plaintext highlighter-rouge">REVOKE</code>  —É–¥–∞–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –ë–î <br />
<code class="language-plaintext highlighter-rouge">UPDATE</code> –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞, –∑–Ω–∞—á–µ–Ω–∏—è —Å —Ç–∞–±–ª–∏—Ü–µ <br />
<code class="language-plaintext highlighter-rouge">FLUSH</code> –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ <br />
<code class="language-plaintext highlighter-rouge">SELECT</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –ë–î, –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ <br />
<code class="language-plaintext highlighter-rouge">INSERT</code> –≤–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ <br />
<code class="language-plaintext highlighter-rouge">DELETE</code> —É–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ (FROM) —Ç–∞–±–ª–∏—Ü–µ</p>

<h3 id="data-type">DATA TYPE</h3>

<p><code class="language-plaintext highlighter-rouge">VARCHAR(N)</code> —Å—Ç—Ä–æ–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã, –≤ —Ñ–æ—Ä–º–∞—Ç–µ ASCII, –≥–¥–µ –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª –∑–∞–Ω–∏–º–∞–µ—Ç 1 –±–∞–π—Ç, —á–∏—Å–ª–æ–º N —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–∞—è –¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">NVARCHAR(N)</code> —Å—Ç—Ä–æ–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã, –≤ —Ñ–æ—Ä–º–∞—Ç–µ Unicode, –≥–¥–µ –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª –∑–∞–Ω–∏–º–∞–µ—Ç 2 –±–∞–π—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">CHAR(N)/nchar(N)</code> —Å—Ç—Ä–æ–∫–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã, –∫–æ—Ç–æ—Ä–∞—è –≤—Å–µ–≥–¥–∞ –¥–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–ø—Ä–∞–≤–∞ –ø—Ä–æ–±–µ–ª–∞–º–∏ –¥–æ –¥–ª–∏–Ω—ã N –∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –æ–Ω–∞ –∑–∞–Ω–∏–º–∞–µ—Ç —Ä–æ–≤–Ω–æ N —Å–∏–º–≤–æ–ª–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">INT</code> —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –æ—Ç -2147483648 –¥–æ 2147483647, –∑–∞–Ω–∏–º–∞–µ—Ç 4 –±–∞–π—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">FLOAT</code> —á–∏—Å–ª–æ, –≤ –∫–æ—Ç–æ—Ä–æ–º –º–æ–∂–µ—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –¥–µ—Å—è—Ç–∏—á–Ω–∞—è —Ç–æ—á–∫–∞ (–∑–∞–ø—è—Ç–∞—è) <br />
<code class="language-plaintext highlighter-rouge">BIT</code> —Ñ–ª–∞–≥, –î–∞ - 1 –∏–ª–∏ –ù–µ—Ç - 0 <br />
<code class="language-plaintext highlighter-rouge">DATE</code> —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä 25.05.2023 <br />
<code class="language-plaintext highlighter-rouge">TIME</code> 23:30:55.1234567 <br />
<code class="language-plaintext highlighter-rouge">DATETIME</code> 25.05.2023 23:30:55.1234567</p>

<h3 id="database-1">DATABASE</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SHOW databases;                                                                     # –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –ë–î
CREATE DATABASE db_aduser;                                                          # —Å–æ–∑–¥–∞—Ç—å –ë–î
CREATE DATABASE db_rep DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;  # —Å–æ–∑–¥–∞—Ç—å –ë–î —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π UTF-8
DROP DATABASE db_rep;                                                               # —É–¥–∞–ª–∏—Ç—å –ë–î
USE db_aduser;                                                                      # –≤—ã–±—Ä–∞—Ç—å/–ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –ë–î
SELECT database();                                                                  # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –ë–î
</code></pre></div></div>
<h3 id="user">USER</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT USER,HOST FROM mysql.user;                                     # –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –£–ó
CREATE USER posh@localhost IDENTIFIED BY '1qaz!QAZ';                  # —Å–æ–∑–¥–∞—Ç—å –£–ó, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
CREATE USER posh@localhost IDENTIFIED BY '1qaz!QAZ';                  # —Å–æ–∑–¥–∞—Ç—å –£–ó, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è —Å —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
CREATE USER posh@'192.168.3.99' IDENTIFIED BY '1qaz!QAZ';             # –£–ó –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
CREATE USER 'admin'@'%' IDENTIFIED BY 'Admin12#';                     # –£–ó –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ —Å –ª—é–±–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (% - wildcard)
DROP USER posh@localhost;                                             # —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SHOW GRANTS FOR posh@'%';                                             # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
GRANT ALL PRIVILEGES ON db_aduser.* TO posh@'192.168.3.99';           # –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è posh –∫ –ë–î db_aduser
GRANT ALL PRIVILEGES ON *.* TO posh@'%';                              # –¥–æ—Å—Ç—É–ø –∫ –≤—Å–µ–º –ë–î c –ª—é–±–æ–≥–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ —Ö–æ—Å—Ç–∞
GRANT SELECT,DELETE ON mysql.* TO posh@'%';                           # –ø—Ä–∞–≤–∞ SELECT –∏ DELETE –Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –ë–î mysql
REVOKE DELETE ON mysql.* FROM posh@'%';                               # —É–¥–∞–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø DELETE
UPDATE mysql.user SET super_priv='Y' WHERE USER='posh' AND host='%';  # –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∏–≤–µ–ª–µ–≥–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT USER,HOST,super_priv FROM mysql.user;                          # —Å–ø–∏—Å–æ–∫ –£–ó –∏ —Ç–∞–±–ª–∏—Ü–∞ —Å –ø—Ä–∞–≤–∞–º–∏ SUPER privilege
FLUSH PRIVILEGES;                                                     # –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
</code></pre></div></div>
<h3 id="table">TABLE</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SHOW TABLES;               # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
SHOW TABLES LIKE '%user';  # –ø–æ–∏—Å–∫ —Ç–∞–±–ª–∏—Ü—ã –ø–æ wildcard-–∏–º–µ–Ω–∏
CREATE TABLE table_aduser (id INT NOT NULL AUTO_INCREMENT, Name VARCHAR(100), email VARCHAR(100), PRIMARY KEY (ID));  # —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É
DROP TABLE table_aduser;   # —É–¥–∞–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É
</code></pre></div></div>
<h3 id="column">COLUMN</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SHOW COLUMNS FROM table_aduser;                                                         # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–±—Ü–æ–≤ –∏ –∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞
ALTER TABLE table_aduser DROP COLUMN id;                                                # —É–¥–∞–ª–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü id
ALTER TABLE table_aduser ADD COLUMN info VARCHAR(10);                                   # –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü info
ALTER TABLE table_aduser CHANGE info new_info VARCHAR(100);                             # –∏–∑–º–µ–Ω–∏—Ç—å –∏–º—è —Å—Ç–æ–ª–±—Ü–∞ info –Ω–∞ new_info –∏ –µ–≥–æ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö
ALTER TABLE table_aduser ADD COLUMN (id INT NOT NULL AUTO_INCREMENT, PRIMARY KEY (ID)); # –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü id
</code></pre></div></div>
<h3 id="insert">INSERT</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INSERT table_aduser (Name,email) VALUES ('Alex','no-email');
INSERT table_aduser (Name,email) VALUES ('Alex','no-email');
INSERT table_aduser (Name) VALUES ('Support');
INSERT table_aduser (Name) VALUES ('Jack');
</code></pre></div></div>
<h3 id="select">SELECT</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT * FROM table_aduser;                     # —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—Å–µ—Ö —Å—Ç–æ–±—Ü–æ–≤ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π (FROM) —Ç–∞–±–ª–∏—Ü–µ
SELECT Name,email FROM table_aduser;            # —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Å—Ç–æ–±—Ü–æ–≤
SELECT DISTINCT Name,Email FROM table_aduser;   # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π)
SELECT * FROM table_aduser ORDER BY Name;       # –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ Name
SELECT * FROM table_aduser ORDER BY Name DESC;  # –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
SELECT COUNT(*) FROM table_aduser;              # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ
SELECT COUNT(new_info) FROM table_aduser;       # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Å—Ç–æ–ª–±—Ü–µ
</code></pre></div></div>
<h3 id="where">WHERE</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NOT; AND; OR                                                  # –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º —É—Å–ª–æ–≤–∏–π
SELECT * FROM table_aduser WHERE Name = 'Alex';               # –ø–æ–∏—Å–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É
SELECT * FROM table_aduser WHERE NOT Name != 'Alex';          # —É—Å–ª–æ–≤–∏–µ NOT –≥–¥–µ Name –Ω–µ —Ä–∞–≤–µ–Ω –∑–Ω–∞—á–µ–Ω–∏—é
SELECT * FROM table_aduser WHERE email != '';                 # –≤—ã–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ email –Ω–µ —Ä–∞–Ω–æ null
SELECT * FROM table_aduser WHERE email != '' OR id &gt; 1000;    # –∏–ª–∏ id –≤—ã—à–µ 1000
SELECT * FROM table_aduser WHERE Name RLIKE "support";        # —Ä–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–µ–º—ã–π (RLIKE) –ø–æ–∏—Å–∫
SELECT * FROM table_aduser WHERE Name RLIKE "^support";       # –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å —ç—Ç–æ–≥–æ —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è
</code></pre></div></div>
<h3 id="delete">DELETE</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT * FROM table_aduser WHERE Name RLIKE "alex";   # –Ω–∞–π—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
DELETE FROM table_aduser WHERE Name RLIKE "alex";     # Query OK, 2 rows affected # —É–¥–∞–ª–µ–Ω–æ –¥–≤–µ —Å—Ç—Ä–æ–∫–∏
DELETE FROM table_aduser;                             # —É–¥–∞–ª–∏—Ç—å –í–°–ï –∑–Ω–∞—á–µ–Ω–∏—è
</code></pre></div></div>
<h3 id="update">UPDATE</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT * FROM table_aduser WHERE Name = 'Jack';             # –Ω–∞–π—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º
UPDATE table_aduser SET Name = 'Alex' WHERE Name = 'Jack';  # –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ 'Jack' –Ω–∞ 'Alex'
UPDATE db_aduser.table_aduser SET Name='BCA' WHERE id=1;    # –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å—Ç—Ä–æ–∫–µ —Å ID 1
</code></pre></div></div>
<h3 id="check">CHECK</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CHECK TABLE db_aduser.table_aduser;     # –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
ANALYZE TABLE db_aduser.table_aduser;   # –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
OPTIMIZE TABLE db_aduser.table_aduser;  # –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
REPAIR TABLE db_aduser.table_aduser;    # –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
TRUNCATE TABLE db_aduser.table_aduser;  # –æ—á–∏—Å—Ç–∏—Ç—å
</code></pre></div></div>
<h3 id="dump">DUMP</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysqldump -u root -p --databases db_aduser &gt; /bak/db_aduser.sql
mysql -u root -p db_aduser &lt; /bak/db_aduser.sql

crontab -e
00 22 * * * /usr/bin/mysqldump -uroot -p1qaz!QAZ db_zabbix | /bin/bzip2 &gt; `date +/dump/zabbix/zabbix-\%d-\%m-\%Y-\%H:\%M.bz2`
00 23 * * * /usr/bin/mysqldump -uroot -p1qaz!QAZ db_zabbix &gt; `date +/dump/smb/zabbix-\%d-\%m-\%Y-\%H:\%M.sql`
0 0 * * * find /dump/zabbix -mtime +7 -exec rm {} \;

mysqldump -u root --single-transaction db_zabbix &gt; /dump/zabbix/db_zabbix.sql
mysql -u user_zabbix -p -e 'CREATE DATABASE db_zabbix;'
mysql -u user_zabbix -p db_zabbix &lt; /root/db_zabbix.sql
</code></pre></div></div>
<h3 id="innodb_force_recovery">innodb_force_recovery</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sed -i '/innodb_force_recovery/d' /etc/mysql/my.cnf # —É–¥–∞–ª–∏—Ç—å
mode=6; sed -i "/^\[mysqld\]/{N;s/$/\ninnodb_force_recovery=$mode/}" /etc/mysql/my.cnf # –¥–æ–±–∞–≤–∏—Ç—å mode 6
systemctl restart mysql

[mysqld]
innodb_force_recovery=1 # —Å–µ—Ä–≤–µ—Ä –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –µ—Å—Ç—å –ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ InnoDB –∏–ª–∏ –Ω–µ—Ç
innodb_force_recovery=2 # —É–¥–∞–µ—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É –∑–∞ —Å—á–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ—Ç–æ–∫–∞ –∫–æ–º–∞–Ω–¥, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —á–∞—Å—Ç–∏—á–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –∏–ª–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã (–Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–æ–Ω–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
innodb_force_recovery=3 # –æ—Ç–º–µ–Ω—è–µ—Ç –æ—Ç–∫–∞—Ç –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (–Ω–µ –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–∫–∞—Ç–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
innodb_force_recovery=6 # –∑–∞–ø—É—Å–∫ –°–£–ë–î –≤ —Ä–µ–∂–∏–º–µ read only
</code></pre></div></div>
<h3 id="mysql-connector-net">MySQL Connector NET</h3>

<h3 id="add-aduser">Add-ADUser</h3>
<pre><code class="language-PowerShell">$ip = "192.168.1.253"
$user = "posh"
$pass = "1qaz!QAZ"
$db = "db_aduser"
Add-Type ‚ÄìPath "$home\Documents\MySQL-Connector-NET\8.0.31-4.8\MySql.Data.dll"
$Connection = [MySql.Data.MySqlClient.MySqlConnection]@{
ConnectionString="server=$ip;uid=$user;pwd=$pass;database=$db"
}
$Connection.Open()
$Command = New-Object MySql.Data.MySqlClient.MySqlCommand
$Command.Connection = $Connection
$UserList = Get-ADUser -filter * -properties name,EmailAddress
foreach ($user in $UserList) {
$uname=$user.Name
$uemail=$user.EmailAddress
$Command.CommandText = "INSERT INTO table_aduser (Name,Email) VALUES ('$uname','$uemail')"
$Command.ExecuteNonQuery()
}
$Connection.Close()
</code></pre>
<h3 id="get-aduser">Get-ADUser</h3>
<pre><code class="language-PowerShell">$ip = "192.168.1.253"
$user = "posh"
$pass = "1qaz!QAZ"
$db = "db_aduser"
Add-Type ‚ÄìPath "$home\Documents\MySQL-Connector-NET\8.0.31-4.8\MySql.Data.dll"
$Connection = [MySql.Data.MySqlClient.MySqlConnection]@{
ConnectionString = "server=$ip;uid=$user;pwd=$pass;database=$db"
}
$Connection.Open()
$Command = New-Object MySql.Data.MySqlClient.MySqlCommand
$Command.Connection = $Connection
$MYSQLDataAdapter = New-Object MySql.Data.MySqlClient.MySqlDataAdapter
$MYSQLDataSet = New-Object System.Data.DataSet
$Command.CommandText = "SELECT * FROM table_aduser"
$MYSQLDataAdapter.SelectCommand = $Command
$NumberOfDataSets = $MYSQLDataAdapter.Fill($MYSQLDataSet, "data")
$Collections = New-Object System.Collections.Generic.List[System.Object]
foreach($DataSet in $MYSQLDataSet.tables[0]) {
$Collections.Add([PSCustomObject]@{
Name = $DataSet.name;
Mail = $DataSet.email
})
}
$Connection.Close()
$Collections
</code></pre>
<h1 id="mssql">MSSQL</h1>

<p><code class="language-plaintext highlighter-rouge">wget -qO- https://packages.microsoft.com/keys/microsoft.asc | apt-key add -</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å GPG-–∫–ª—é—á –¥–ª—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è <br />
<code class="language-plaintext highlighter-rouge">https://packages.microsoft.com/config/ubuntu/</code> –≤—ã–±—Ä–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å URL <br />
<code class="language-plaintext highlighter-rouge">add-apt-repository "$(wget -qO- https://packages.microsoft.com/config/ubuntu/20.04/mssql-server-2019.list)"</code> <br />
<code class="language-plaintext highlighter-rouge">apt-get update</code> –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">apt-get install mssql-server</code> <br />
<code class="language-plaintext highlighter-rouge">/opt/mssql/bin/mssql-conf setup</code> —Å–∫—Ä–∏–ø—Ç –Ω–∞—á–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–≤—ã–±—Ä–∞—Ç—å —Ä–µ–¥–∞–∫—Ü–∏—é, 3 - express –∏ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ 9 –∏–∑ 11) <br />
<code class="language-plaintext highlighter-rouge">systemctl status mssql-server</code> <br />
<code class="language-plaintext highlighter-rouge">curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç <br />
<code class="language-plaintext highlighter-rouge">curl https://packages.microsoft.com/config/ubuntu/20.04/prod.list | tee /etc/apt/sources.list.d/msprod.list</code> <br />
<code class="language-plaintext highlighter-rouge">apt-get update</code> <br />
<code class="language-plaintext highlighter-rouge">apt-get install mssql-tools</code> <br />
<code class="language-plaintext highlighter-rouge">echo 'export PATH="$PATH:/opt/mssql-tools/bin"' &gt;&gt; ~/.bashrc</code> –¥–æ–±–∞–≤–∏—Ç—å –≤ –¥–æ–º–∞—à–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ —Ñ–∞–π–ª–∞ bashrc, —á—Ç–æ –±—ã –Ω–µ –ø–∏—Å–∞—Ç—å –ø—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É <br />
<code class="language-plaintext highlighter-rouge">export PATH="$PATH:/opt/mssql-tools/bin"</code> <br />
<code class="language-plaintext highlighter-rouge">iptables -I INPUT 1 -p tcp --dport 1433 -j ACCEPT</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlcmd -S localhost -U SA
CREATE DATABASE itinvent
go
SELECT name FROM master.dbo.sysdatabases
go
</code></pre></div></div>
<h3 id="systemdatasqlclient">System.Data.SqlClient</h3>
<pre><code class="language-PowerShell">$user = "itinvent"
$pass = "itinvent"
$db   = "itinvent"
$srv  = "192.168.3.103"
$SqlConnection = New-Object System.Data.SqlClient.SqlConnection
$SqlConnection.ConnectionString = "server=$srv;database=$db;user id=$user;password=$pass;Integrated Security=false"

$SqlCommand = New-Object System.Data.SqlClient.SqlCommand` –∫–ª–∞—Å—Å —Ñ–æ—Ä–º–∞—Ç–∞ –∫–æ–º–∞–Ω–¥—ã
$SqlCommand.CommandText = "SELECT * FROM ITINVENT.dbo.USERS"` –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–∞–±–ª–∏—Ü—ã
#$SqlCommand.CommandText = "SELECT LICENCE_DATE,DESCR,MODEL_NO,TYPE_NO FROM ITINVENT.dbo.ITEMS where LICENCE_DATE IS NOT NULL"
$SqlCommand.Connection = $SqlConnection` –ø–µ—Ä–µ–¥–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
$SqlAdapter = New-Object System.Data.SqlClient.SqlDataAdapter` —Å–æ–∑–¥–∞—Ç—å –∞–¥–∞–ø—Ç–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SELECT –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
$SqlAdapter.SelectCommand = $SqlCommand` –ø–µ—Ä–µ–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—É

$DataSet = New-Object System.Data.DataSet` —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç –ø—Ä–∏–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞ XML
$SqlAdapter.Fill($DataSet)` –∑–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –æ—Ç –∞–¥–∞–ø—Ç–µ—Ä–∞ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª-–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤)
$SqlConnection.Close()
$Data = $DataSet.Tables
$Data[0] | ft
</code></pre>
<h3 id="sqlclient-insert">SqlClient INSERT</h3>
<pre><code class="language-PowerShell">$user = "itinvent"
$pass = "itinvent"
$db   = "db_test"
$srv  = "192.168.3.103"
$sql = "INSERT INTO table_test (column_user) VALUES ('lifailon')"` –¥–æ–±–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É table_test –≤ –∫–æ–ª–æ–Ω–∫—É column_user
$SqlConnection = New-Object System.Data.SqlClient.SqlConnection
$SqlConnection.ConnectionString = "server=$srv;database=$db;user id=$user;password=$pass;Integrated Security=false"
$SqlCommand = New-Object System.Data.SqlClient.SqlCommand
$SqlCommand.CommandText = $sql
$SqlCommand.Connection = $SqlConnection
$SqlConnection.Open()
$rowsAffected = $SqlCommand.ExecuteNonQuery();` –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ INSERT/UPDATE/DELETE –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SqlDataAdapter
$SqlConnection.Close()
</code></pre>
<h3 id="ssms-insert">SSMS INSERT</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>USE [db_test]
GO
INSERT INTO [dbo].[table_test]
           ([column_user])
     VALUES
           ('lifailon')
GO
SELECT TOP (1000) [column_user]
FROM [db_test].[dbo].[table_test]
</code></pre></div></div>
<h3 id="t-sql">T-SQL</h3>

<ul>
  <li>
    <p>DDL (Data Definition Language / –Ø–∑—ã–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö). –ö —ç—Ç–æ–º—É —Ç–∏–ø—É –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞—é—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–±–ª–∏—Ü—ã, –∏–Ω–¥–µ–∫—Å—ã, —Ö—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã. <br />
<code class="language-plaintext highlighter-rouge">CREATE</code> —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Å–∞–º—É –±–∞–∑—É –¥–∞–Ω—ã—Ö, —Ç–∞–±–ª–∏—Ü—ã, –∏–Ω–¥–µ–∫—Å—ã –∏ —Ç.–¥.) <br />
<code class="language-plaintext highlighter-rouge">ALTER</code> –∏–∑–º–µ–Ω—è–µ—Ç –æ–±—ä–µ–∫—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö <br />
<code class="language-plaintext highlighter-rouge">DROP</code> —É–¥–∞–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö <br />
<code class="language-plaintext highlighter-rouge">TRUNCATE</code> —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü</p>
  </li>
  <li>
    <p>DML (Data Manipulation Language / –Ø–∑—ã–∫ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã–º–∏). –ö —ç—Ç–æ–º—É —Ç–∏–ø—É –æ—Ç–Ω–æ—Å—è—Ç –∫–æ–º–∞–Ω–¥—ã –ø–æ –≤—ã–±–æ—Ä—É, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é, –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –∏ —É–¥–∞–ª–µ–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö. <br />
<code class="language-plaintext highlighter-rouge">SELECT</code> –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î <br />
<code class="language-plaintext highlighter-rouge">UPDATE</code> –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ <br />
<code class="language-plaintext highlighter-rouge">INSERT</code> –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ <br />
<code class="language-plaintext highlighter-rouge">DELETE</code> —É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ</p>
  </li>
  <li>
    <p>DCL (Data Control Language / –Ø–∑—ã–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º). –ö —ç—Ç–æ–º—É —Ç–∏–ø—É –æ—Ç–Ω–æ—Å—è—Ç –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–ø—Ä–∞–≤–ª—è—é—Ç –ø—Ä–∞–≤–∞–º–∏ –ø–æ –¥–æ—Å—Ç—É–ø—É –∫ –¥–∞–Ω–Ω—ã–º. <br />
<code class="language-plaintext highlighter-rouge">GRANT</code> –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º <br />
<code class="language-plaintext highlighter-rouge">REVOKE</code> –æ—Ç–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º
```
‚Äì –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
DECLARE @text NVARCHAR(20), @int INT;
SET @text=‚ÄôTest‚Äô;
SET @int = 21;
select @text,@int</p>
  </li>
</ul>

<p>‚Äì –ò–º–µ–Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ 
Select @@SERVERNAME as [Server\Instance];</p>

<p>‚Äì –≤–µ—Ä—Å–∏—è SQL Server 
Select @@VERSION as SQLServerVersion;</p>

<p>‚Äì –¢–µ–∫—É—â–∞—è –ë–î (–ë–î, –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∫–æ—Ç–æ—Ä–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å)
Select DB_NAME() AS CurrentDB_Name;</p>

<p>‚Äì –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–º–µ–Ω—Ç–∞ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
SELECT  @@Servername AS ServerName ,
        create_date AS  ServerStarted ,
        DATEDIFF(s, create_date, GETDATE()) / 86400.0 AS DaysRunning ,
        DATEDIFF(s, create_date, GETDATE()) AS SecondsRunnig
FROM    sys.databases
WHERE   name = ‚Äòtempdb‚Äô;</p>

<p>‚Äì –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
SELECT  @@Servername AS Server ,
        DB_NAME(database_id) AS DatabaseName ,
        COUNT(database_id) AS Connections ,
        Login_name AS  LoginName ,
        MIN(Login_Time) AS Login_Time ,
        MIN(COALESCE(last_request_end_time, last_request_start_time))
                                                         AS  Last_Batch
FROM    sys.dm_exec_sessions
WHERE   database_id &gt; 0
        AND DB_NAME(database_id) NOT IN ( ‚Äòmaster‚Äô, ‚Äòmsdb‚Äô )
GROUP BY database_id ,
         login_name
ORDER BY DatabaseName;</p>

<p>‚Äì –°—Ç–∞—Ç—É—Å Backup
SELECT  @@Servername AS ServerName ,
        d.Name AS DBName ,
        MAX(b.backup_finish_date) AS LastBackupCompleted
FROM    sys.databases d
        LEFT OUTER JOIN msdb..backupset b
                    ON b.database_name = d.name
                       AND b.[type] = ‚ÄòD‚Äô
GROUP BY d.Name
ORDER BY d.Name;</p>

<p>‚Äì –ü—É—Ç—å –∫ Backup
SELECT  @@Servername AS ServerName ,
        d.Name AS DBName ,
        b.Backup_finish_date ,
        bmf.Physical_Device_name
FROM    sys.databases d
        INNER JOIN msdb..backupset b ON b.database_name = d.name
                                        AND b.[type] = ‚ÄòD‚Äô
        INNER JOIN msdb.dbo.backupmediafamily bmf ON b.media_set_id = bmf.media_set_id
ORDER BY d.NAME ,
        b.Backup_finish_date DESC;</p>

<p>‚Äì –í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ë–î, –º–æ–¥–µ–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –ø—É—Ç—å –∫ mdf/ldf
EXEC sp_helpdb; 
SELECT  @@SERVERNAME AS Server ,
        d.name AS DBName ,
        create_date ,
        recovery_model_Desc AS RecoveryModel ,
        m.physical_name AS FileName
FROM    sys.databases d
        JOIN sys.master_files m ON d.database_id = m.database_id
ORDER BY d.name;</p>

<p>‚Äì –†–∞–∑–º–µ—Ä –ë–î
with fs
as
(
    select database_id, type, size * 8.0 / 1024 size
    from sys.master_files
)
select 
    name,
    (select sum(size) from fs where type = 0 and fs.database_id = db.database_id) DataFileSizeMB,
    (select sum(size) from fs where type = 1 and fs.database_id = db.database_id) LogFileSizeMB
from sys.databases</p>

<p>‚Äì –ü–æ–∏—Å–∫ —Ç–∞–±–ª–∏—Ü—ã –ø–æ –º–∞—Å–∫–µ –∏–º–µ–Ω–∏ (–≤—ã–≤–æ–¥: –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ö–µ–º—ã –≥–¥–µ —Ä–∞—Å–ø–æ–ª–æ–≥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç, —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞, –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏):
select [object_id], [schema_id],
	   schema_name([schema_id]) as [schema_name], 
	   [name], 
	   [type], 
	   [type_desc], 
	   [create_date], 
	   [modify_date]
from sys.all_objects
‚Äì where [name]=‚ÄôINVENT‚Äô;
where [name] like ‚Äò%INVENT%‚Äô;</p>

<p>‚Äì –ö–æ–ª-–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö
SELECT  @@ServerName AS Server ,
        DB_NAME() AS DBName ,
        OBJECT_SCHEMA_NAME(p.object_id) AS SchemaName ,
        OBJECT_NAME(p.object_id) AS TableName ,
        i.Type_Desc ,
        i.Name AS IndexUsedForCounts ,
        SUM(p.Rows) AS Rows
FROM    sys.partitions p
        JOIN sys.indexes i ON i.object_id = p.object_id
                              AND i.index_id = p.index_id
WHERE   i.type_desc IN ( ‚ÄòCLUSTERED‚Äô, ‚ÄòHEAP‚Äô )
                             ‚Äì This is key (1 index per table) 
        AND OBJECT_SCHEMA_NAME(p.object_id) &lt;&gt; ‚Äòsys‚Äô
GROUP BY p.object_id ,
        i.type_desc ,
        i.Name
ORDER BY SchemaName ,
        TableName;</p>

<p>‚Äì –ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫–æ–≤–æ–µ (nvarchar) –∑–Ω–∞—á–µ–Ω–∏–µ 2023 –ø–æ –≤—Å–µ–º —Ç–∞–±–ª–∏—Ü–∞–º –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚Äì –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∫–∞–∫–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ —Å—Ç–æ–ª–±—Ü–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ, –∞ —Ç–∞–∫–∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–∞—Ä—ã —Ç–∞–±–ª–∏—Ü–∞-–∫–æ–ª–æ–Ω–∫–∞
set nocount on
declare @name varchar(128), @substr nvarchar(4000), @column varchar(128)
set @substr = ‚Äò%2023%‚Äô
declare @sql nvarchar(max);
create table<code class="language-plaintext highlighter-rouge">rslt 
(table_name varchar(128), field_name varchar(128), [value] nvarchar(max))
declare s cursor for select table_name as table_name from information_schema.tables where table_type = 'BASE TABLE' order by table_name
open s
fetch next from s into @name
while @@fetch_status = 0
begin
declare c cursor for 
select quotename(column_name) as column_name from information_schema.columns 
where data_type in ('text', 'ntext', 'varchar', 'char', 'nvarchar', 'char', 'sysname', 'int', 'tinyint') and table_name  = @name
set @name = quotename(@name)
open c
fetch next from c into @column
while @@fetch_status = 0
begin
--print 'Processing table - ' + @name + ', column - ' + @column
set @sql='insert into</code>rslt select ‚Äò‚Äô‚Äô + @name + ‚Äò‚Äô‚Äô as Table_name, ‚Äò‚Äô‚Äô + @column + ‚Äò‚Äô‚Äô, cast(‚Äò + @column + 
‚Äò as nvarchar(max)) from‚Äô + @name + ‚Äò where cast(‚Äò + @column + ‚Äò as nvarchar(max)) like ‚Äò‚Äô‚Äô + @substr + ‚Äò‚Äô‚Äô‚Äô;
print @sql;
exec(@sql);
fetch next from c into @column;
end
close c
deallocate c
fetch next from s into @name
end
select table_name as [Table Name], field_name as [Field Name], count(*) as [Found Mathes] from<code class="language-plaintext highlighter-rouge">rslt
group by table_name, field_name
order by table_name, field_name
drop table</code>rslt
close s
deallocate s</p>

<p>‚Äì –ü–æ–∏—Å–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ [CI_HISTORY] –∏ —Å—Ç–æ–ª–±—Ü—É [HIST_ID]:
SELECT * FROM ITINVENT.dbo.CI_HISTORY where [HIST_ID] like ‚Äò%2023%‚Äô;</p>

<p>‚Äì –£–∑–Ω–∞—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—é –∏–Ω–¥–µ–∫—Å–æ–≤
DECLARE @db_id SMALLINT;
SET @db_id = DB_ID(N‚Äôitinvent‚Äô);
IF @db_id IS NULL
BEGIN;
    PRINT N‚Äô–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è –±–∞–∑—ã‚Äô;
END;
ELSE
BEGIN;
	SELECT
		object_id AS [ID –æ–±—ä–µ–∫—Ç–∞],
		index_id AS [ID –∏–Ω–¥–µ–∫—Å–∞],
		index_type_desc AS [–¢–∏–ø –∏–Ω–¥–µ–∫—Å–∞],
		avg_fragmentation_in_percent AS [–§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –≤ %]</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FROM sys.dm_db_index_physical_stats(@db_id, NULL, NULL, NULL , 'LIMITED')
 
ORDER BY [avg_fragmentation_in_percent] DESC; END; GO
</code></pre></div></div>

<p>‚Äì TempDB
‚Äì Initial size - –Ω–∞—á–∞–ª—å–Ω—ã–π/–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ë–î (1024 MB)
‚Äì Autogrowh - –ø—Ä–∏—Ä–æ—Å—Ç (512MB)
‚Äì –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é tempdb –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –∞–≤—Ç–æ-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (Autogrow) –∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ SQL Server –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª—ã —ç—Ç–æ–π –ë–î —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.
‚Äì –£–≤–µ–ª–∏—á–∏–≤ —Ä–∞–∑–º–µ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤ tempdb, –º–æ–∂–Ω–æ —Å–≤–µ—Å—Ç–∏ –∫ –º–∏–Ω–∏–º—É–º—É –∑–∞—Ç—Ä–∞—Ç—ã —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∞–≤—Ç–æ-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.</p>

<p>‚Äì –ò–∑–º–µ–Ω–∏—Ç—å –ø—É—Ç—å –∫ –ë–î:
USE master;
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = tempdev, FILENAME = ‚ÄòF:\tempdb.mdf‚Äô);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp2, FILENAME = ‚ÄòF:\tempdb_mssql_2.ndf‚Äô);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp3, FILENAME = ‚ÄòF:\tempdb_mssql_3.ndf‚Äô);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp4, FILENAME = ‚ÄòF:\tempdb_mssql_4.ndf‚Äô);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp5, FILENAME = ‚ÄòF:\tempdb_mssql_5.ndf‚Äô);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp6, FILENAME = ‚ÄòF:\tempdb_mssql_6.ndf‚Äô);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp7, FILENAME = ‚ÄòF:\tempdb_mssql_7.ndf‚Äô);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = temp8, FILENAME = ‚ÄòF:\tempdb_mssql_8.ndf‚Äô);
GO
ALTER DATABASE tempdb
MODIFY FILE (NAME = templog, FILENAME = ‚ÄòF:\templog.ldf‚Äô);
GO</p>

<p>‚Äì –£–∫–∞–∑–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:
MODIFY FILE (NAME = temp2, FILENAME = ‚ÄòF:\tempdb_mssql_2.ndf‚Äô , SIZE = 1048576KB , FILEGROWTH = 524288KB);</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>### –¢–∏–ø —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏

- Full (–ü–æ–ª–Ω–∞—è –∫–æ–ø–∏—è). –ö–æ–≥–¥–∞ —Å—Ç–∞—Ä—Ç—É–µ—Ç –ø–æ–ª–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ, –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è Log Sequence Number (LSN - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –∂—É—Ä–Ω–∞–ª–∞), –∞ —Ç–∞–∫ –∂–µ LSN –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∏ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø–æ–ª–Ω–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è. –≠—Ç–æ—Ç LSN —è–≤–ª—è–µ—Ç—Å—è –º–µ—Ö–∞–Ω–∏–∑–º–æ–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º SQL Server, —á—Ç–æ–±—ã –∑–Ω–∞—Ç—å, –≤ –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã INSERT, UPDATE –∏–ª–∏ DELETE. –ü—Ä–∏ —ç—Ç–æ–º –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö LSN –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è, –∫–∞–∫ —á–∞—Å—Ç–∏ –ø–æ–ª–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞, –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–∏ –ø–æ–ª–Ω–æ–º —Ä–µ–∑–µ—Ä–≤–Ω–æ–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—è, –ø—Ä–æ–∏–∑–æ—à–µ–¥—à–∏–µ –≤–æ –≤—Ä–µ–º—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–∞–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –±—ç–∫–∞–ø–∞.
- Differential (–¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è/—Ä–∞–∑–Ω–æ—Å—Ç–Ω–∞—è –∫–æ–ø–∏—è). –•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã—Ö, –∏–∑–º–µ–Ω–∏–≤—à–∏–µ—Å—è —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ü–æ–ª–Ω–æ–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏. –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ü–æ–ª–Ω—É—é —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –≤ —Ä–µ–∂–∏–º–µ NORECOVERY, –ø–æ—Ç–æ–º –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ª—é–±—É—é –∏–∑ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –†–∞–∑–Ω–æ—Å—Ç–Ω—ã—Ö –∫–æ–ø–∏–π, –±–µ–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ü–æ–ª–Ω–æ–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –†–∞–∑–Ω–æ—Å—Ç–Ω–∞—è –∫–æ–ø–∏—è –±–µ—Å–ø–æ–ª–µ–∑–Ω–∞. –ö–∞–∂–¥–∞—è –ø–æ—Å–ª–µ–¥—É—é—â–∞—è –†–∞–∑–Ω–æ—Å—Ç–Ω–∞—è –∫–æ–ø–∏—è –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ, –≤—Ö–æ–¥—è—â–∏–µ –≤ –ø—Ä–µ–¥—ã–¥—É—â—É—é –†–∞–∑–Ω–æ—Å—Ç–Ω—É—é —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é, —Å–¥–µ–ª–∞–Ω–Ω—É—é –ø–æ—Å–ª–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ü–æ–ª–Ω–æ–π –∫–æ–ø–∏–∏.
- Incremental (–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è/–∫–æ–ø–∏—è –∂—É—Ä–Ω–∞–ª–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π). –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∫–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–∏–∑–æ—à–ª–∏ —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ –∑–∞—Ç–µ–º —É—Ä–µ–∑–∞–µ—Ç –∂—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (LSN), –±—ç–∫–∞–ø –∂—É—Ä–Ω–∞–ª–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç—Ç–æ—Ç –ø–æ—Ä—è–¥–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –ë—ç–∫–∞–ø—ã –∂—É—Ä–Ω–∞–ª–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–æ–ª–∂–Ω—ã –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –ø–æ –ø–æ—Ä—è–¥–∫—É. –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—Å—è —Ü–µ–ø–æ—á–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π: –ø–æ–ª–Ω–∞—è –∏ –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

### –ú–æ–¥–µ–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

- Simple (–ü—Ä–æ—Å—Ç–∞—è). –•—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –∂–∏–∑–Ω–∏ –æ—Å—Ç–∞—Ç–æ–∫ –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–ª–æ–≥) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞, –ø–æ—ç—Ç–æ–º—É –æ—Å—Ç–∞–µ—Ç—Å—è —Å–∞–º–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –æ–ø—Ü–∏–π –ø–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é. –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª: Always On, Point-In-Time –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ, –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.
- Full (–ü–æ–ª–Ω–∞—è). –•—Ä–∞–Ω–∏—Ç—Å—è –∂—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ë–î —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –ñ—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–µ –±—É–¥–µ—Ç –æ—á–∏—â–∞—Ç—å—Å—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –∂—É—Ä–Ω–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.
- Bulk logged (–° –Ω–µ–ø–æ–ª–Ω—ã–º –ø—Ä–æ—Ç–æ–∫–æ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º). –ò–¥–µ–Ω—Ç–∏—á–Ω–∞ Full, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ: SELECT INTO, BULK INSERT –∏ BCP, INSERT INTO SELECT, –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ (CREATE INDEX, ALTER INDEX REBUILD, DROP INDEX)

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –ë–î

- master. –•—Ä–∞–Ω—è—Ç—Å—è –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã, —Å–≤–µ–¥–µ–Ω—å—è –æ–± —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å—è—Ö –≤—Ö–æ–¥–∞, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–±–æ –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö) –¥–ª—è —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ SQL Server.
- tempdb. –†–∞–±–æ—á–µ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã, —Ç–∞–±–ª–∏—á–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∫—É—Ä—Å–æ—Ä—ã. –ü–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ SQL Server.
- model. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ —à–∞–±–ª–æ–Ω–∞ –¥–ª—è –≤—Å–µ—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö, —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö –≤ —ç–∫–∑–µ–º–ø–ª—è—Ä–µ SQL Server, –≤—Å–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö model, –≤–∫–ª—é—á–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ —Å–æ–∑–¥–∞–≤–∞–µ–º—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –¢–∞–∫ –∫–∞–∫ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö tempdb —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ SQL Server, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö model –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ SQL Server. 
- msdb. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≥–µ–Ω—Ç–æ–º SQL Server –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (–æ–ø–µ—Ä–∞—Ç–æ—Ä) –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π, –∞ —Ç–∞–∫–∂–µ –¥—Ä—É–≥–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏. SQL Server —Ö—Ä–∞–Ω–∏—Ç –ø–æ–ª–Ω—ã–π –∂—É—Ä–Ω–∞–ª —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö msdb. –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ—á—Ç—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: USE [msdb].
- resource. –î–æ—Å—Ç—É–ø–Ω–∞—è —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä sys.objects, —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö resource, –Ω–æ –ª–æ–≥–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ —Å—Ö–µ–º–µ sys –∫–∞–∂–¥–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

### –†–µ–≥–ª–∞–º–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

`DBCC CHECKDB`

- –ò–Ω–¥–µ–∫—Å—ã. –ò–Ω–¥–µ–∫—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–∏—Å–∫–∞/–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ —Ç–∞–±–ª–∏—Ü–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –ò–Ω–¥–µ–∫—Å —É—Å–∫–æ—Ä—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—Ä–æ—Å–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å—Ç—Ä–æ–∫–∞–º –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ç–æ–º—É, –∫–∞–∫ —É–∫–∞–∑–∞—Ç–µ–ª—å –≤ –∫–Ω–∏–≥–µ –ø–æ–º–æ–≥–∞–µ—Ç –≤–∞–º –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –ò–Ω–¥–µ–∫—Å—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –ø—É—Ç—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤ —ç—Ç–∏—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –µ–≥–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞. MS SQL Server —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ—Ç –∏ –∏–∑–º–µ–Ω—è–µ—Ç –∏–Ω–¥–µ–∫—Å—ã –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–∞–∑–æ–π. –° —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ –¥–∞–Ω–Ω—ã–µ –≤ –∏–Ω–¥–µ–∫—Å–µ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏, —Ç.–µ. —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–Ω—ã–º–∏ –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤. –ï—Å–ª–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç 5 –¥–æ 30% (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ –≤ –∑–∞–¥–∞–Ω–∏–∏ 15%), —Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –µ–µ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, –ø—Ä–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤—ã—à–µ 30% (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ –∑–∞–¥–∞—á–µ &gt; 30% —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —á–∏—Å–ª–æ —Å—Ç—Ä–∞–Ω–∏—Ü &gt; 1000) –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª–Ω–æ–µ –ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤. –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–ª–∞–Ω–æ–≤–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è.

- –†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è (Reorganize) –∏–ª–∏ –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–∞ ‚Äî —ç—Ç–æ —Å–µ—Ä–∏—è –Ω–µ–±–æ–ª—å—à–∏—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π —Å—Ç—Ä–∞–Ω–∏—Ü —Ç–∞–∫, —á—Ç–æ–±—ã –∏–Ω–¥–µ–∫—Å –Ω–µ –±—ã–ª —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω. –ü–æ—Å–ª–µ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è. –í–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—á—Ç–∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.

`sp_msforeachtable N'DBCC INDEXDEFRAG (&lt;–∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö&gt;, ''?'')'`

- –ü–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ (Rebuild) –∏–Ω–¥–µ–∫—Å–æ–≤ (–∏–ª–∏ –∑–∞–¥–∞—á–∞ –≤ –º–∞—Å—Ç–µ—Ä–µ –ø–ª–∞–Ω–æ–≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å) –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª–Ω–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤. –í –≤–µ—Ä—Å–∏–∏ MS SQL Server Standard –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ—Ç –±–∞–∑—ã –Ω–∞ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏. –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.

`sp_msforeachtable N'DBCC DBREINDEX (''?'')'`

- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Äî –Ω–µ–±–æ–ª—å—à–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–æ–±—ã—á–Ω–æ –¥–æ 200 —Å—Ç—Ä–æ–∫), –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –æ–±–æ–±—â–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, –∫–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –∫–∞–∫ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ. –ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ, –∫–∞–∫ –ª—É—á—à–µ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–ø—Ä–æ—Å. –ö–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, SELECT) –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –¥–∞–Ω–Ω—ã–µ, –Ω–æ –Ω–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç–µ —Ç–æ, –∫–∞–∫ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω—ã. –í –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–º–æ–≥–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞. –í–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è.

`exec sp_msforeachtable N'UPDATE STATISTICS ? WITH FULLSCAN'`

- –û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω–æ–≥–æ –∫—ç—à–∞, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏. –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä MS SQL Server –∫—ç—à–∏—Ä—É–µ—Ç –ø–ª–∞–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∏—Ö –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —ç–∫–æ–Ω–æ–º–∏—Ç—å –≤—Ä–µ–º—è, –∑–∞—Ç—Ä–∞—á–∏–≤–∞–µ–º–æ–µ –Ω–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏—é –∑–∞–ø—Ä–æ—Å–∞ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —Ç–∞–∫–æ–π –∂–µ –∑–∞–ø—Ä–æ—Å —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–ª—Å—è –∏ –µ–≥–æ –ø–ª–∞–Ω –∏–∑–≤–µ—Å—Ç–µ–Ω. –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –Ω–µ –±—É–¥–µ—Ç –æ—á–∏—â–µ–Ω –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–π –∫—ç—à, —Ç–æ SQL Server –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å —Å—Ç–∞—Ä—ã–π (–Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π) –ø–ª–∞–Ω –∑–∞–ø—Ä–æ—Å–∞ –∏–∑ –∫—ç—à–∞ –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –Ω–æ–≤—ã–π (–±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π) –ø–ª–∞–Ω.

`DBCC FREEPROCCACHE`

# InfluxDB

[Download InfluxDB 1.x Open Source](https://www.influxdata.com/downloads)
[InfluxDB-Studio](https://github.com/CymaticLabs/InfluxDBStudio)

### Install Windows
```PowerShell
Invoke-RestMethod "https://dl.influxdata.com/influxdb/releases/influxdb-1.8.10_windows_amd64.zip" -OutFile "$home\Downloads\influxdb-1.8.10_windows_amd64.zip"
Expand-Archive "$home\Downloads\influxdb-1.8.10_windows_amd64.zip" -DestinationPath "$home\Documents\"
Remove-Item "$home\Downloads\influxdb-1.8.10_windows_amd64.zip"
&amp; "$home\Downloads\influxdb-1.8.10-1\influxd.exe"
</code></pre></div></div>
<h3 id="install-ubuntu">Install Ubuntu</h3>
<pre><code class="language-Bash">wget https://dl.influxdata.com/influxdb/releases/influxdb_1.8.10_amd64.deb
sudo dpkg -i influxdb_1.8.10_amd64.deb
systemctl start influxdb
systemctl status influxdb

ps aux | grep influxdb | grep -Ev "grep"
netstat -natpl | grep 80[8-9][3-9]
</code></pre>
<h3 id="api">API</h3>
<pre><code class="language-Bash">nano /etc/influxdb/influxdb.conf

[http]
  enabled = true
  bind-address = ":8086"
  auth-enabled = false

systemctl restart influxdb
</code></pre>
<h3 id="chronograf">Chronograf</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://dl.influxdata.com/chronograf/releases/chronograf-1.10.2_windows_amd64.zip -UseBasicParsing -OutFile chronograf-1.10.2_windows_amd64.zip
Expand-Archive .\chronograf-1.10.2_windows_amd64.zip -DestinationPath 'C:\Program Files\InfluxData\chronograf\'

wget https://dl.influxdata.com/chronograf/releases/chronograf_1.10.2_amd64.deb
sudo dpkg -i chronograf_1.10.2_amd64.deb
systemctl status influxdb
http://192.168.3.102:8888
</code></pre></div></div>
<h3 id="grafana">Grafana</h3>

<p><a href="https://grafana.com/grafana/download">Download</a></p>

<p><code class="language-plaintext highlighter-rouge">invoke-RestMethod https://dl.grafana.com/enterprise/release/grafana-enterprise-10.3.1.windows-amd64.msi -OutFile "$home\Download\grafana.msi"</code></p>
<pre><code class="language-Bash">apt-get install -y adduser libfontconfig1 musl
wget https://dl.grafana.com/enterprise/release/grafana-enterprise_10.3.1_amd64.deb
dpkg -i grafana-enterprise_10.3.1_amd64.deb
systemctl start grafana-server
systemctl status grafana-server
</code></pre>
<h3 id="cli-client">CLI Client</h3>

<p><code class="language-plaintext highlighter-rouge">apt install influxdb-client</code> <br />
<code class="language-plaintext highlighter-rouge">influx</code> <br />
<code class="language-plaintext highlighter-rouge">influx --host 192.168.3.102 --username admin --password password</code></p>
<pre><code class="language-PowerShell">$influx_client_exec = "$home\Documents\influxdb-1.8.10-1\influx.exe"
&amp; $influx_client_exec -host 192.168.3.102 -port 8086
help
show databases
use PowerShell
SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m
</code></pre>
<h3 id="users">USERS</h3>

<p><code class="language-plaintext highlighter-rouge">SHOW USERS</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ <br />
<code class="language-plaintext highlighter-rouge">CREATE USER admin WITH PASSWORD 'password' WITH ALL PRIVILEGES</code> —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">GRANT ALL PRIVILEGES TO "admin"</code> –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ <br />
<code class="language-plaintext highlighter-rouge">GRANT READ ON "database" TO "admin"</code> –¥–æ—Å—Ç—É–ø –Ω–∞ —á—Ç–µ–Ω–∏–µ –¥–ª—è –ë–î –∏–ª–∏ –∑–∞–ø–∏—Å—å (WRITE) <br />
<code class="language-plaintext highlighter-rouge">REVOKE ALL PRIVILEGES FROM "admin"</code> –æ—Ç–æ–∑–≤–∞—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ <br />
<code class="language-plaintext highlighter-rouge">SHOW GRANTS FOR "admin"</code> –ë–î –∏ –ø—Ä–∏–≤–µ–ª–µ–≥–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">SET PASSWORD FOR "admin" = 'new_password'</code> –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å <br />
<code class="language-plaintext highlighter-rouge">DROP USER "admin"</code> —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>

<h3 id="database-2">DATABASE</h3>

<p><code class="language-plaintext highlighter-rouge">CREATE DATABASE powershell</code> —Å–æ–∑–¥–∞—Ç—å –ë–î <br />
<code class="language-plaintext highlighter-rouge">SHOW DATABASES</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ë–î <br />
<code class="language-plaintext highlighter-rouge">DROP DATABASE powershell</code> —É–¥–∞–ª–∏—Ç—å –ë–î <br />
<code class="language-plaintext highlighter-rouge">USE powershell</code> <br />
<code class="language-plaintext highlighter-rouge">SHOW measurements</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã <br />
<code class="language-plaintext highlighter-rouge">INSERT performance,host=console,counter=CPU value=0.88</code> –∑–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É performance</p>

<h3 id="measurement">MEASUREMENT</h3>

<p><code class="language-plaintext highlighter-rouge">SHOW TAG KEYS FROM "HardwareMonitor"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ —Ç—ç–≥–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ <br />
<code class="language-plaintext highlighter-rouge">SHOW TAG VALUES FROM "HardwareMonitor" WITH KEY = "HardwareName"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ç—ç–≥–∞ <br />
<code class="language-plaintext highlighter-rouge">SHOW FIELD KEYS FROM "HardwareMonitor"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ Field Tags –∏ –∏—Ö —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö <br />
<code class="language-plaintext highlighter-rouge">SHOW SERIES FROM "HardwareMonitor"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Ä–∏–π –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ. –°–µ—Ä–∏—è - —ç—Ç–æ –Ω–∞–±–æ—Ä —Ç–æ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Ç–µ–≥–æ–≤, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏. <br />
<code class="language-plaintext highlighter-rouge">DROP SERIES FROM "HardwareMonitor"</code> –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ <br />
<code class="language-plaintext highlighter-rouge">DROP MEASUREMENT "HardwareMonitor"</code> —É–¥–∞–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É</p>

<h3 id="selectwhere">SELECT/WHERE</h3>

<p><code class="language-plaintext highlighter-rouge">SELECT * FROM performance</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ <br />
<code class="language-plaintext highlighter-rouge">SELECT value FROM performance</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Å—Ç–æ–ª–±—Ü—É value (—Ç–æ–ª—å–∫–æ Field Keys) <br />
<code class="language-plaintext highlighter-rouge">SELECT * FROM performance limit 10</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å 10 –µ–¥–∏–Ω–∏—Ü –¥–∞–Ω–Ω—ã—Ö <br />
<code class="language-plaintext highlighter-rouge">SELECT * FROM performance WHERE time &gt; now() -2d</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 –¥–Ω—è <br />
<code class="language-plaintext highlighter-rouge">SELECT * FROM performance WHERE time &gt; now() +3h -5m</code> –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –º–∏–Ω—É—Ç (+3 —á–∞—Å–∞ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ UTC 0 -5 –º–∏–Ω—É—Ç) <br />
<code class="language-plaintext highlighter-rouge">SELECT * FROM performance WHERE counter = 'CPU'</code> –≤—ã–±–æ—Ä–∫–∞ –ø–æ —Ç—ç–≥—É <br />
<code class="language-plaintext highlighter-rouge">SELECT upload/1000 FROM speedtest WHERE upload/1000 &lt;= 250</code> –≤—ã–±–æ—Ä–∫–∞ –ø–æ —Å—Ç–æ–ª–±—Ü—É upload –∏ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≤—ã–≤–æ–¥ –Ω–∞ 1000, –≤—ã–≤–µ—Å—Ç–∏ upload –º–µ–Ω—å—à–µ 250 <br />
<code class="language-plaintext highlighter-rouge">DELETE FROM performance WHERE time &gt; now() -1h</code> —É–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 1/4 —á–∞—Å–∞ <br />
<code class="language-plaintext highlighter-rouge">DELETE FROM performance WHERE time &lt; now() -24h</code> —É–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤</p>

<h3 id="regex-1">REGEX</h3>

<p><code class="language-plaintext highlighter-rouge">SELECT * FROM "win_pdisk" WHERE instance =~/.*C:/ and time &gt; now() - 5m</code> –∏ <br />
<code class="language-plaintext highlighter-rouge">SELECT * FROM "win_pdisk" WHERE instance =~/.*E:/ or instance =~ /.*F:/</code> –∏–ª–∏ <br />
<code class="language-plaintext highlighter-rouge">SELECT * FROM "win_pdisk" WHERE instance !~ /.*Total/</code> –Ω–µ —Ä–∞–≤–Ω–æ (–∏—Å–∫–ª—é—á–∏—Ç—å) <br />
<code class="language-plaintext highlighter-rouge">SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m and HardwareName =~ /Intel/</code> –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–≤–Ω–æ <br />
<code class="language-plaintext highlighter-rouge">SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m and HardwareName =~ /Intel.+i7/</code> —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç 12th_Gen_Intel_Core_i7-1260P <br />
<code class="language-plaintext highlighter-rouge">SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m and HardwareName =~ /^Intel/</code> –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ Intel <br />
<code class="language-plaintext highlighter-rouge">SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m and HardwareName =~ /00$/</code> –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 00</p>

<h3 id="group-by-tag_key">GROUP BY tag_key</h3>

<p><code class="language-plaintext highlighter-rouge">SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m and SensorName = 'Temperature' GROUP BY HardwareName</code> —Å–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≥—Ä—É–ø–ø—ã –ø–æ —Ç—ç–≥—É HardwareName <br />
<code class="language-plaintext highlighter-rouge">SELECT * FROM "HardwareMonitor" WHERE time &gt; now() - 5m and SensorName = 'Temperature' GROUP BY Host,HardwareName</code> –±–æ–ª—å—à–µ –≥—Ä—É–ø–ø –ø–æ –¥–≤—É–º —Ç—ç–≥–∞–∞–º</p>

<h3 id="functionsfield_key">Functions(field_key)</h3>

<p><a href="https://docs.influxdata.com/influxdb/v1.8/query_language/functions">Functions</a></p>

<p><code class="language-plaintext highlighter-rouge">SELECT instance,LAST(Avg._Disk_Read_Queue_Length) FROM "win_pdisk" GROUP BY instance</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É/—Ç–µ–∫—É—â–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é <br />
<code class="language-plaintext highlighter-rouge">SELECT instance,FIRST(Avg._Disk_Read_Queue_Length) FROM "win_pdisk" GROUP BY instance</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ –ø–µ—Ä–≤–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –∑–∞ –≤–µ—Å—å –∏–ª–∏ —É–∫–∞–∑–∞–Ω–Ω—ã–π –æ—Ç—Ä–µ–∑–æ–∫ –≤—Ä–µ–º–µ–Ω–∏ <br />
<code class="language-plaintext highlighter-rouge">SELECT instance,MIN(Avg._Disk_Read_Queue_Length) FROM "win_pdisk" GROUP BY instance</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">SELECT instance,MAX(Avg._Disk_Read_Queue_Length) FROM "win_pdisk" GROUP BY instance</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">SELECT SUM(Bytes_Received_persec) FROM "win_net" GROUP BY instance</code> —Å—É–º–º–∞—Ö –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">SELECT COUNT(Bytes_Received_persec) FROM "win_net" WHERE Bytes_Received_persec &gt;= 0 GROUP BY instance</code> –∫–æ–ª-–≤–æ –¥–∞–Ω–Ω—ã—Ö, –≥–¥–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ 0 <br />
<code class="language-plaintext highlighter-rouge">SELECT MEAN(Bytes_Received_persec) FROM "win_net" WHERE Bytes_Received_persec &lt; 1000 GROUP BY instance</code> —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º –æ—Ç 0 –¥–æ 1000 (509)</p>

<p><code class="language-plaintext highlighter-rouge">SELECT *,MAX(Value) FROM "HardwareMonitor" WHERE time &gt; now() -1h GROUP BY SensorName,Host</code> —Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—ã –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–±—Ü–∞ Value –∫–∞–∂–¥–æ–≥–æ —Ç—ç–≥–∞ SensorName –∏ —Ö–æ—Å—Ç–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å <br />
<code class="language-plaintext highlighter-rouge">SELECT *,MAX(Value) FROM "HardwareMonitor" WHERE time &gt; now() -1h and SensorName = 'CPU_Package' GROUP BY Host</code> –º–∞—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ CPU_Package –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ö–æ—Å—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">SELECT MEAN(Value) FROM "HardwareMonitor" WHERE time &gt; now() -1h and SensorName = 'CPU_Package' GROUP BY Host</code> —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ CPU_Package –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å</p>

<h3 id="policy">POLICY</h3>

<p><code class="language-plaintext highlighter-rouge">CREATE DATABASE powershell WITH DURATION 48h REPLICATION 1 NAME "del2d"</code> —Å–æ–∑–¥–∞—Ç—å –ë–î —Å –ø–æ–ª–∏—Ç–∏–∫–æ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è 2 –¥–Ω—è <br />
<code class="language-plaintext highlighter-rouge">CREATE RETENTION POLICY del2h ON powershell DURATION 2h REPLICATION 1</code> —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ø–æ–ª–∏—Ç–∏–∫—É —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è –ë–î <br />
<code class="language-plaintext highlighter-rouge">CREATE RETENTION POLICY del6h ON powershell DURATION 6h REPLICATION 1 SHARD DURATION 2h</code> —É–∫–∞–∑–∞—Ç—å –ø–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è 6 —á–∞—Å–æ–≤ + 2 —á–∞—Å–∞ –¥–æ –æ—á–∏—Å—Ç–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1—á –∏–ª–∏ –±–æ–ª—å—à–µ) <br />
<code class="language-plaintext highlighter-rouge">ALTER RETENTION POLICY del6h ON powershell DEFAULT</code> –∏–∑–º–µ–Ω–∏—Ç—å (ALTER) –ø–æ–ª–∏—Ç–∏–∫—É —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è –ë–î –Ω–∞ del6h (DEFAULT) <br />
<code class="language-plaintext highlighter-rouge">DROP RETENTION POLICY del2d ON powershell</code> —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ–º—É —É–¥–∞–ª–µ–Ω–∏—é –≤—Å–µ—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π (—Ç–∞–±–ª–∏—Ü) –∏ –¥–∞–Ω–Ω—ã—Ö, —Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è –≤ –ø–æ–ª–∏—Ç–∏–∫–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">SHOW RETENTION POLICIES ON PowerShell</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –¥–µ–π—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PowerShell</p>
<pre><code class="language-PowerShell">$data = Invoke-RestMethod http://192.168.3.102:8086/query?q="SHOW RETENTION POLICIES ON PowerShell"
$col = $data.results.series.columns
$val = $data.results.series.values
$mass    = @()
$mass   += [string]$col
foreach ($v in $val) {
	$mass += [string]$v
}
$mass = $mass -replace '^','"'
$mass = $mass -replace '$','"'
$mass = $mass -replace '\s','","'
$mass | ConvertFrom-Csv
</code></pre>
<h3 id="api-post">API POST</h3>

<p>–í–º–µ—Å—Ç–æ —Ç–∞–±–ª–∏—Ü –≤ InfluxDB –∏–º–µ—é—Ç—Å—è –∏–∑–º–µ—Ä–µ–Ω–∏—è. –í–º–µ—Å—Ç–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ –Ω–µ–π –µ—Å—Ç—å —Ç–µ–≥–∏ –∏ –ø–æ–ª—è.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   Table                        Tag (string/int)                          Field (double/int)           TIMESTAMP
measurement,Tag_Keys1=Tag_Values1,Tag_Keys2=Tag_Values2 Field_Keys1="Values",Field_Keys2="Values" 0000000000000000000
           1                                           2                                         3

$ip        = "192.168.3.104"
$port      = "8086"
$db        = "powershell"
$table     = "speedtest"
$ipp       = $ip+":"+$port
$url       = "http://$ipp/write?db=$db"
$user      = "admin"
$pass      = "password" | ConvertTo-SecureString -AsPlainText -Force
$cred      = [System.Management.Automation.PSCredential]::new($user,$pass)
$unixtime  = (New-TimeSpan -Start (Get-Date "01/01/1970") -End (Get-Date)).TotalSeconds
$timestamp = ([string]$unixtime -replace "\..+") + "000000000"

Invoke-RestMethod -Method POST -Uri $url -Body "$table,host=$(hostname) download=200000,upload=300000,ping=3 $timestamp"
</code></pre></div></div>
<h3 id="api-get">API GET</h3>

<p><code class="language-plaintext highlighter-rouge">curl http://192.168.3.104:8086/query --data-urlencode "q=SHOW DATABASES"</code> pwsh7 (ConvertFrom-Json) and bash</p>

<p><code class="language-plaintext highlighter-rouge">$dbs = irm "http://192.168.3.104:8086/query?q=SHOW DATABASES"</code> <br />
<code class="language-plaintext highlighter-rouge">$dbs = irm "http://192.168.3.104:8086/query?epoch=ms&amp;u=admin&amp;p=password&amp;q=SHOW DATABASES"</code> <br />
<code class="language-plaintext highlighter-rouge">$dbs.results.series.values</code></p>
<pre><code class="language-PowerShell">$ip    = "192.168.3.104"
$port  = "8086"
$db    = "powershell"
$table = "speedtest"
$query = "SELECT * FROM $table"
$ipp   = $ip+":"+$port
$url   = "http://$ipp/query?db=$db&amp;q=$query"
$data  = Invoke-RestMethod -Method GET -Uri $url` -Credential $cred 
$data.results.series.name   ` –∏–º—è —Ç–∞–±–ª–∏—Ü—ã
$data.results.series.columns` —Å—Ç–æ–ª–±—Ü—ã/–∫–ª—é—á–∏
$data.results.series.values ` –¥–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ
</code></pre>
<h3 id="endpoints">Endpoints</h3>
<p><a href="https://docs.influxdata.com/influxdb/v1.7/tools/api/">API doc</a></p>
<pre><code class="language-PowerShell">$stats = irm http://192.168.3.104:8086/debug/vars` —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
$stats."database:powershell".values` –∫–æ–ª-–≤–æ —Ç–∞–±–ª–∏—Ü –∫ –ë–î
$stats.queryExecutor.values` –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ query-–∑–∞–ø—Ä–æ—Å–æ–≤ (–æ–±—Ä–∞—â–µ–Ω–∏–π –∫ endpoint /query)
$stats.write.values` –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ write-–∑–∞–ø—Ä–æ—Å–æ–≤
$stats.system.uptime
</code></pre>
<p><code class="language-plaintext highlighter-rouge">http://192.168.3.104:8086/debug/requests</code> –∫–æ–ª-–≤–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –∫–æ–Ω–µ—á–Ω—ã–º —Ç–æ—á–∫–∞–º /write–∏ /query <br />
<code class="language-plaintext highlighter-rouge">http://192.168.3.104:8086/debug/pprof</code> <br />
<code class="language-plaintext highlighter-rouge">http://192.168.3.104:8086/ping</code> <br />
<code class="language-plaintext highlighter-rouge">http://192.168.3.104:8086/query</code> <br />
<code class="language-plaintext highlighter-rouge">http://192.168.3.104:8086/write</code></p>

<p><code class="language-plaintext highlighter-rouge">http://192.168.3.99:8086/api/v2/setup</code> <br />
<code class="language-plaintext highlighter-rouge">http://192.168.3.99:8086/api/v2/config</code> <br />
<code class="language-plaintext highlighter-rouge">http://192.168.3.99:8086/api/v2/write</code></p>

<h3 id="pingto-influxdb">PingTo-InfluxDB</h3>
<pre><code class="language-PowerShell">while ($true) {
	$tz = (Get-TimeZone).BaseUtcOffset.TotalMinutes
	$unixtime  = (New-TimeSpan -Start (Get-Date "01/01/1970") -End ((Get-Date).AddMinutes(-$tz))).TotalSeconds` -3h UTC
	$timestamp = ([string]$unixtime -replace "\..+") + "000000000"
	$tnc = tnc 8.8.8.8
	$Status = $tnc.PingSucceeded
	$RTime = $tnc.PingReplyDetails.RoundtripTime
	Invoke-RestMethod -Method POST -Uri "http://192.168.3.104:8086/write?db=powershell" -Body "ping,host=$(hostname) status=$status,rtime=$RTime $timestamp"
	sleep 1
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">SELECT * FROM ping WHERE status = false</code></p>

<h3 id="performanceto-influxdb">PerformanceTo-InfluxDB</h3>
<pre><code class="language-PowerShell">function ConvertTo-Encoding ([string]$From, [string]$To) {
    Begin {
        $encFrom = [System.Text.Encoding]::GetEncoding($from)
        $encTo = [System.Text.Encoding]::GetEncoding($to)
    }
    Process {
        $bytes = $encTo.GetBytes($_)
        $bytes = [System.Text.Encoding]::Convert($encFrom, $encTo, $bytes)
        $encTo.GetString($bytes)
    }
}

$localization = (Get-Culture).LCID` —Ç–µ–∫—É—â–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
if ($localization -eq 1049) {
	$performance = "\\$(hostname)\–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä(_Total)\% –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞" | ConvertTo-Encoding UTF-8 windows-1251` –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∫–∏—Ä–∏–ª–ª–∏—Ü—É
} else {
	$performance = "\Processor(_Total)\% Processor Time"
}

$tz = (Get-TimeZone).BaseUtcOffset.TotalMinutes
while ($true) {
	$unixtime  = (New-TimeSpan -Start (Get-Date "01/01/1970") -End ((Get-Date).AddMinutes(-$tz))).TotalSeconds` -3h UTC
	$timestamp = ([string]$unixtime -replace "\..+") + "000000000"
	[double]$value = (Get-Counter $performance).CounterSamples.CookedValue.ToString("0.00").replace(",",".")` –æ–∫—Ä—É–≥–ª–∏—Ç—å –≤ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö Double
	Invoke-RestMethod -Method POST -Uri "http://192.168.3.104:8086/write?db=powershell" -Body "performance,host=$(hostname),counter=CPU value=$value $timestamp"
	sleep 5
}
</code></pre>
<h3 id="service">Service</h3>
<pre><code class="language-PowerShell">$powershell_Path = (Get-Command powershell).Source
$NSSM_Path = "C:\NSSM\NSSM-2.24.exe"
$Script_Path = "C:\NSSM\PerformanceTo-InfluxDB.ps1"
$Service_Name = "PerformanceTo-InfluxDB"
&amp; $NSSM_Path install $Service_Name $powershell_Path -ExecutionPolicy Bypass -NoProfile -f $Script_Path
Get-Service $Service_Name | Start-Service
Get-Service $Service_Name | Set-Service -StartupType Automatic
</code></pre>
<h1 id="telegraf">Telegraf</h1>

<p><a href="https://docs.influxdata.com/telegraf/v1.27/plugins/#input-plugins">Plugins</a></p>

<p><code class="language-plaintext highlighter-rouge">iwr https://dl.influxdata.com/telegraf/releases/telegraf-1.27.1_windows_amd64.zip -UseBasicParsing -OutFile telegraf-1.27.1_windows_amd64.zip</code> <br />
<code class="language-plaintext highlighter-rouge">Expand-Archive .\telegraf-1.27.1_windows_amd64.zip -DestinationPath "C:\Telegraf"</code> <br />
<code class="language-plaintext highlighter-rouge">rm telegraf-1.27.1_windows_amd64.zip</code> <br />
<code class="language-plaintext highlighter-rouge">cd C:\Telegraf</code> <br />
<code class="language-plaintext highlighter-rouge">.\telegraf.exe -sample-config --input-filter cpu:mem:dns_query --output-filter influxdb &gt; telegraf_nt.conf</code> —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å –≤—ã–±–∞—Ä–Ω–Ω—ã–º–∏ –ø–ª–∞–≥–∏–Ω–∞–º–∏ –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ <br />
<code class="language-plaintext highlighter-rouge">Start-Process notepad++ C:\Telegraf\telegraf_nt.conf</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[[outputs.influxdb]]
  urls = ["http://192.168.3.104:8086"]
  database = "telegraf_nt"
  username = "user"
  password = "pass"
[[inputs.cpu]]
  percpu = false
  totalcpu = true
[[inputs.dns_query]]
  servers = ["8.8.8.8"]
  network = "udp"
  domains = ["."]
  record_type = "A"
  port = 53
  timeout = "2s"
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">.\telegraf.exe --test -config C:\Telegraf\telegraf_nt.conf</code> —Ç–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ —Å –≤—ã–≤–æ–¥–æ–º –≤ –∫–æ–Ω—Å–æ–ª—å) <br />
<code class="language-plaintext highlighter-rouge">C:\Telegraf\telegraf.exe -config C:\Telegraf\telegraf_nt.conf</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å telegraf (—Ç–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö) <br />
<code class="language-plaintext highlighter-rouge">.\telegraf.exe --config "C:\Telegraf\telegraf_nt.conf" --service install</code> —Å–æ–∑–¥–∞—Ç—å —Å–ª—É–∂–±—É <br />
<code class="language-plaintext highlighter-rouge">Get-Service telegraf | Start-Service</code> <br />
<code class="language-plaintext highlighter-rouge">.\telegraf.exe --service uninstall</code></p>

<p><code class="language-plaintext highlighter-rouge">USE telegraf</code> <br />
<code class="language-plaintext highlighter-rouge">SELECT usage_idle,usage_system,usage_user FROM cpu</code></p>

<h1 id="elasticsearch">Elasticsearch</h1>

<p><code class="language-plaintext highlighter-rouge">Install-Module -Name Elastic.Console -AllowPrerelease</code> <a href="https://github.com/elastic/powershell/blob/master/Elastic.Console/README.md">github source</a> <br />
<code class="language-plaintext highlighter-rouge">Get-Command -Module Elastic.Console</code> <br />
<code class="language-plaintext highlighter-rouge">Get-ElasticsearchVersion</code> <br />
<code class="language-plaintext highlighter-rouge">Set-ElasticsearchVersion 7.3.0</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-Elasticsearch</code> REST API –∑–∞–ø—Ä–æ—Å—ã</p>

<h1 id="cdata">CData</h1>

<p><a href="https://www.powershellgallery.com/profiles/CData">PowerShell Gallery CData</a> <br />
<a href="https://www.cdata.com/kb/tech/elasticsearch-ado-powershell.rst">Automate Elasticsearch Integration Tasks from PowerShell</a></p>

<p><code class="language-plaintext highlighter-rouge">Install-Module ElasticsearchCmdlets</code> <a href="https://www.powershellgallery.com/packages/ElasticsearchCmdlets/23.0.8565.1">–ø–∞–∫–µ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞ –≤ psgallery</a> <br />
<code class="language-plaintext highlighter-rouge">Import-Module ElasticsearchCmdlets</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Command -Module ElasticsearchCmdlets</code></p>
<pre><code class="language-PowerShell">$elasticsearch = Connect-Elasticsearch  -Server "$Server" -Port "$Port" -User "$User" -Password "$Password"
$shipcity = "New York"
$orders = Select-Elasticsearch -Connection $elasticsearch -Table "Orders" -Where "ShipCity = `'$ShipCity`'"` –ø–æ–∏—Å–∫ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
$orders = Invoke-Elasticsearch -Connection $elasticsearch -Query 'SELECT * FROM Orders WHERE ShipCity = @ShipCity' -Params @{'@ShipCity'='New York'}` SQL –∑–∞–ø—Ä–æ—Å—ã
</code></pre>
<h3 id="adonet-assembly">ADO.NET Assembly</h3>

<p><code class="language-plaintext highlighter-rouge">Install-Package CData.Elasticsearch</code> <a href="https://www.nuget.org/packages/CData.Elasticsearch">–ø–∞–∫–µ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞ –≤ nuget</a> <br />
<code class="language-plaintext highlighter-rouge">[Reflection.Assembly]::LoadFile("C:\Program Files\PackageManagement\NuGet\Packages\CData.Elasticsearch.23.0.8565\lib\net40\System.Data.CData.Elasticsearch.dll")</code></p>
<pre><code class="language-PowerShell">$connect = New-Object System.Data.CData.Elasticsearch.ElasticsearchConnection("Server=127.0.0.1;Port=9200;User=admin;Password=123456;")
$connect.Open()
$sql = "SELECT OrderName, Freight from Orders"
$da = New-Object System.Data.CData.Elasticsearch.ElasticsearchDataAdapter($sql, $conn)
$dt = New-Object System.Data.DataTable
$da.Fill($dt)
$dt.Rows | foreach {
Write-Host $_.ordername $_.freight
}
</code></pre>
<h3 id="update-1">UPDATE</h3>
<pre><code class="language-PowerShell">Update-Elasticsearch -Connection $Elasticsearch -Columns @('OrderName','Freight') -Values @('MyOrderName', 'MyFreight') -Table Orders -Id "MyId"

$cmd =  New-Object System.Data.CData.Elasticsearch.ElasticsearchCommand("UPDATE Orders SET ShipCity='New York' WHERE Id = @myId", $conn)
$cmd.Parameters.Add(new System.Data.CData.Elasticsearch.ElasticsearchParameter("@myId","10456255-0015501366"))
$cmd.ExecuteNonQuery()
</code></pre>
<h3 id="insert-1">INSERT</h3>
<pre><code class="language-PowerShell">Add-Elasticsearch -Connection $Elasticsearch -Table Orders -Columns @("OrderName", "Freight") -Values @("MyOrderName", "MyFreight")

$cmd =  New-Object System.Data.CData.Elasticsearch.ElasticsearchCommand("INSERT INTO Orders (ShipCity) VALUES (@myShipCity)", $conn)
$cmd.Parameters.Add(new System.Data.CData.Elasticsearch.ElasticsearchParameter("@myShipCity","New York"))
$cmd.ExecuteNonQuery()
</code></pre>
<h3 id="delete-1">DELETE</h3>
<pre><code class="language-PowerShell">Remove-Elasticsearch -Connection $Elasticsearch -Table "Orders" -Id "MyId"

$cmd =  New-Object System.Data.CData.Elasticsearch.ElasticsearchCommand("DELETE FROM Orders WHERE Id=@myId", $conn)
$cmd.Parameters.Add(new System.Data.CData.Elasticsearch.ElasticsearchParameter("@myId","001d000000YBRseAAH"))
$cmd.ExecuteNonQuery()
</code></pre>
<h1 id="odbc">ODBC</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Command -Module Wdac</code> <br />
<code class="language-plaintext highlighter-rouge">Get-OdbcDriver | ft</code> —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤</p>

<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/sql-client-apps-ps1.html">Elasticsearch ODBC –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º Elasticsearch –∏–∑ Microsoft PowerShell</a></p>
<pre><code class="language-PowerShell">$connectstring = "DSN=Local Elasticsearch;"
$sql = "SELECT * FROM library"
$conn = New-Object System.Data.Odbc.OdbcConnection($connectstring)
$conn.open()
$cmd = New-Object system.Data.Odbc.OdbcCommand($sql,$conn)
$da = New-Object system.Data.Odbc.OdbcDataAdapter($cmd)
$dt = New-Object system.Data.datatable
$null = $da.fill($dt)
$conn.close()
$dt
</code></pre>
<h1 id="postgresql">PostgreSQL</h1>

<p><a href="https://www.postgresql.org/ftp/odbc/versions/msi/">–°–∫–∞—á–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä</a></p>
<pre><code class="language-PowerShell">$dbServer = "192.168.3.101"
$port = "5432"
$dbName = "test"
$dbUser = "admin"
$dbPass = "admin"
$szConnect = "Driver={PostgreSQL Unicode(x64)};Server=$dbServer;Port=$port;Database=$dbName;Uid=$dbUser;Pwd=$dbPass;" 

$cnDB = New-Object System.Data.Odbc.OdbcConnection($szConnect)
$dsDB = New-Object System.Data.DataSet
try {
    $cnDB.Open()
    $adDB = New-Object System.Data.Odbc.OdbcDataAdapter
    $adDB.SelectCommand = New-Object System.Data.Odbc.OdbcCommand("SELECT id, name, age, login FROM public.users" , $cnDB)
    $adDB.Fill($dsDB)
    $cnDB.Close()
}
catch [System.Data.Odbc.OdbcException] {
    $_.Exception
    $_.Exception.Message
    $_.Exception.ItemName
}
foreach ($row in $dsDB[0].Tables[0].Rows) {
    $row.login
    $row.age
}
</code></pre>
<h1 id="wmi">WMI</h1>

<h3 id="wmicim-windows-management-instrumentationcommon-information-model">WMI/CIM (Windows Management Instrumentation/Common Information Model)</h3>
<p><code class="language-plaintext highlighter-rouge">Get-WmiObjec -ComputerName localhost -Namespace root -class "__NAMESPACE" | select name,__namespace</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –¥–æ—á–µ—Ä–Ω–∏–∏ Namespace (–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –≥—Ä—É–ø–ø—ã) <br />
<code class="language-plaintext highlighter-rouge">Get-WmiObject -List</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –∫–ª–∞—Å—Å—ã –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω ‚Äúroot\cimv2‚Äù (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), —Å–≤–æ–π—Å—Ç–≤–∞ (–æ–ø–∏—Å—ã–≤–∞—é—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞) –∏ –∏—Ö –º–µ—Ç–æ–¥—ã (–∫–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞–¥ —ç—Ç–∏–º —Ä–µ—Å—É—Ä—Å–æ–º) <br />
<code class="language-plaintext highlighter-rouge">Get-WmiObject -List | Where-Object {$_.name -match "video"}</code> –ø–æ–∏—Å–∫ –∫–ª–∞—Å—Å–∞ –ø–æ –∏–º–µ–Ω–∏, –µ–≥–æ —Å–≤–æ–π—Å—Ç–≤ –∏ –º–µ—Ç–æ–¥–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-WmiObject -ComputerName localhost -Class Win32_VideoController</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–≤–æ–π—Å—Ç–≤ –∫–ª–∞—Å—Å–∞</p>

<p><code class="language-plaintext highlighter-rouge">gwmi -List | where name -match "service" | ft -auto</code> –µ—Å–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç Methods, —Ç–æ –º–æ–∂–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å {StartService, StopService} <br />
<code class="language-plaintext highlighter-rouge">gwmi -Class win32_service | select *</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–ª—É–∂–± –∏ –≤—Å–µ—Ö –∏—Ö —Å–≤–æ–π—Å—Ç–≤ <br />
<code class="language-plaintext highlighter-rouge">Get-CimInstance Win32_service</code> –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä—è–º—É—é –∫ ‚Äúroot\cimv2‚Äù <br />
<code class="language-plaintext highlighter-rouge">gwmi win32_service -Filter "name='Zabbix Agent'"</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ –∏–º–µ–Ω–∏ <br />
<code class="language-plaintext highlighter-rouge">(gwmi win32_service -Filter "name='Zabbix Agent'").State</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ <br />
<code class="language-plaintext highlighter-rouge">gwmi win32_service -Filter "State = 'Running'"</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ —Å–ª—É–∂–±—ã <br />
<code class="language-plaintext highlighter-rouge">gwmi win32_service -Filter "StartMode = 'Auto'"</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–ª—É–∂–±—ã –ø–æ –º–µ—Ç–æ–¥—É –∑–∞–ø—É—Å–∫–∞ <br />
<code class="language-plaintext highlighter-rouge">gwmi -Query 'select * from win32_service where startmode="Auto"'</code> WQL-–∑–∞–ø—Ä–æ—Å (WMI Query Language) <br />
<code class="language-plaintext highlighter-rouge">gwmi win32_service | Get-Member -MemberType Method</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –º–µ—Ç–æ–¥—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è (Delete, StartService) <br />
<code class="language-plaintext highlighter-rouge">(gwmi win32_service -Filter 'name="Zabbix Agent"').Delete()</code> —É–¥–∞–ª–∏—Ç—å —Å–ª—É–∂–±—É <br />
<code class="language-plaintext highlighter-rouge">(gwmi win32_service -Filter 'name="MSSQL$MSSQLE"').StartService()</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É</p>

<p><code class="language-plaintext highlighter-rouge">Get-CimInstance -ComputerName $srv Win32_OperatingSystem | select LastBootUpTime</code> –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">gwmi -ComputerName $srv -Class Win32_OperatingSystem | select LocalDateTime,LastBootUpTime</code> —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">gwmi Win32_OperatingSystem | Get-Member -MemberType Method</code> –º–µ—Ç–æ–¥—ã reboot –∏ shutdown <br />
<code class="language-plaintext highlighter-rouge">(gwmi Win32_OperatingSystem -EnableAllPrivileges).Reboot()</code> –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å –∫–ª—é—á–µ–º –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–µ–ª–µ–≥–∏–π <br />
<code class="language-plaintext highlighter-rouge">(gwmi Win32_OperatingSystem -EnableAllPrivileges).Win32Shutdown(0)</code> –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
<pre><code class="language-PowerShell">$system = Get-WmiObject -Class Win32_OperatingSystem
$InstallDate = [Management.ManagementDateTimeconverter]::ToDateTime($system.installdate)` –ü–æ–ª—É—á–∞–µ–º –¥–∞—Ç—É —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –û–°
$AfterInstallDays = ((Get-Date) ‚Äî $Installdate).Days` –í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è, –ø—Ä–æ—à–µ–¥—à–µ–µ —Å –º–æ–º–µ–Ω—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
$ShortInstallDate = "{0:yyyy-MM-dd HH:MM}" -f ($InstallDate)
"–°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: $ShortInstallDate (–ü—Ä–æ—à–ª–æ $AfterInstalldays –¥–Ω–µ–π)"
</code></pre>
<p><code class="language-plaintext highlighter-rouge">(Get-WmiObject win32_battery).estimatedChargeRemaining</code> –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö <br />
<code class="language-plaintext highlighter-rouge">gwmi Win32_UserAccount</code> –¥–æ–º–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ <br />
<code class="language-plaintext highlighter-rouge">(gwmi Win32_SystemUsers).PartComponent</code> <br />
<code class="language-plaintext highlighter-rouge">Get-CimInstance -ClassName Win32_LogonSession</code> <br />
<code class="language-plaintext highlighter-rouge">Get-CimInstance -ClassName Win32_BIOS</code></p>

<p><code class="language-plaintext highlighter-rouge">gwmi -list -Namespace root\CIMV2\Terminalservices</code> <br />
<code class="language-plaintext highlighter-rouge">(gwmi -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).AllowTSConnections</code> <br />
<code class="language-plaintext highlighter-rouge">(gwmi -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).SetAllowTSConnections(1)</code> –≤–∫–ª—é—á–∏—Ç—å RDP</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$srv = "localhost"
gwmi Win32_logicalDisk -ComputerName $srv | where {$_.Size -ne $null} | select @{
Label="Value"; Expression={$_.DeviceID}}, @{Label="AllSize"; Expression={
[string]([int]($_.Size/1Gb))+" GB"}},@{Label="FreeSize"; Expression={
[string]([int]($_.FreeSpace/1Gb))+" GB"}}, @{Label="Free%"; Expression={
[string]([int]($_.FreeSpace/$_.Size*100))+" %"}}
</code></pre></div></div>
<h3 id="nla-network-level-authentication">NLA (Network Level Authentication)</h3>
<p><code class="language-plaintext highlighter-rouge">(gwmi -class "Win32_TSGeneralSetting" -Namespace root\cimv2\Terminalservices -Filter "TerminalName='RDP-tcp'").UserAuthenticationRequired</code> <br />
<code class="language-plaintext highlighter-rouge">(gwmi -class "Win32_TSGeneralSetting" -Namespace root\cimv2\Terminalservices -Filter "TerminalName='RDP-tcp'").SetUserAuthenticationRequired(1)</code> –≤–∫–ª—é—á–∏—Ç—å NLA <br />
<code class="language-plaintext highlighter-rouge">Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name SecurityLayer</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (2) <br />
<code class="language-plaintext highlighter-rouge">Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name UserAuthentication</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (1) <br />
<code class="language-plaintext highlighter-rouge">Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name SecurityLayer -Value 0</code> –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name UserAuthentication -Value 0</code> <br />
<code class="language-plaintext highlighter-rouge">REG ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters /v AllowEncryptionOracle /t REG_DWORD /d 2</code> –æ—Ç–∫–ª—é—á–∏—Ç—å –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä–∫—É –≤–µ—Ä—Å–∏–∏ CredSSP, –µ—Å–ª–∏ –Ω–∞ —Ü–µ–ª–µ–≤–æ–º –∫–æ–º—å—é—Ç–µ—Ä–µ-—Å–µ—Ä–≤–µ—Ä–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è KB4512509 –æ—Ç –º–∞—è 2018 –≥–æ–¥–∞</p>

<h1 id="regedit">Regedit</h1>

<p><code class="language-plaintext highlighter-rouge">Get-PSDrive</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∏—Å–∫–æ–≤/—Ä–∞–∑–¥–µ–ª–æ–≤, –∏—Ö —Ä–∞–∑–º–µ—Ä –∏ –≤–µ—Ç–æ–∫ —Ä–µ–µ—Å—Ç—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">cd HKLM:\</code> HKEY_LOCAL_MACHINE <br />
<code class="language-plaintext highlighter-rouge">cd HKCU:\</code> HKEY_CURRENT_USER <br />
<code class="language-plaintext highlighter-rouge">Get-Item</code> –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–µ—Ç–∫–µ —Ä–µ–µ—Å—Ç—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">New-Item</code> —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª —Ä–µ–µ—Å—Ç—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">Remove-Item</code> —É–¥–∞–ª–∏—Ç—å –≤–µ—Ç–∫—É —Ä–µ–µ—Å—Ç—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-ItemProperty</code> –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π/–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–µ—Å—Ç—Ä–∞ (—ç—Ç–æ —Å–≤–æ–π—Å—Ç–≤–∞ –≤–µ—Ç–∫–∏ —Ä–µ–µ—Å—Ç—Ä–∞, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–≤–æ–π—Å—Ç–≤–∞–º —Ñ–∞–π–ª–∞) <br />
<code class="language-plaintext highlighter-rouge">Set-ItemProperty</code> –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–µ–µ—Å—Ç—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">New-ItemProperty</code> —Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">Remove-ItemProperty</code> —É–¥–∞–ª–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä</p>

<p><code class="language-plaintext highlighter-rouge">Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Select DisplayName</code> —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º <br />
<code class="language-plaintext highlighter-rouge">Get-Item HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002</code> –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ Items <br />
<code class="language-plaintext highlighter-rouge">(Get-ItemProperty HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002)."New Signature"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (Value) —Å–≤–æ–π—Å—Ç–≤–∞ (Property) Items <br />
<code class="language-plaintext highlighter-rouge">$reg_path = "HKCU:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6676\00000002"</code> <br />
<code class="language-plaintext highlighter-rouge">$sig_name = "auto"</code> <br />
<code class="language-plaintext highlighter-rouge">Set-ItemProperty -Path $reg_path -Name "New Signature" -Value $sig_name</code> –∏–∑–º–µ–Ω–∏—Ç—å –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–Ω–µ –≤–µ—Ç–∫–∏ (Path) —Å–≤–æ–π—Å—Ç–≤–æ (Name) —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º (Value) <br />
<code class="language-plaintext highlighter-rouge">Set-ItemProperty -Path $reg_path -Name "Reply-Forward Signature" -Value $sig_name</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\taskmgr.exe]
"Debugger"="\"C:\\Windows\\System32\\Taskmgr.exe\""
</code></pre></div></div>
<h1 id="performance">Performance</h1>

<p><code class="language-plaintext highlighter-rouge">lodctr /R</code> –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å—á–µ—Ç—á–∏–∫–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∞—Ä—Ö–∏–≤–æ–≤ (—Ç–∞–∫ –∂–µ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç —Å—á–µ—Ç—á–∏–∫–∏ –¥–ª—è CIM, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è cpu Win32_PerfFormattedData_PerfOS_Processor –∏ iops Win32_PerfFormattedData_PerfDisk_PhysicalDisk) <br />
<code class="language-plaintext highlighter-rouge">(Get-Counter -ListSet *).CounterSetName</code> –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—á–µ—Ç—á–∏–∫–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º–µ <br />
<code class="language-plaintext highlighter-rouge">(Get-Counter -ListSet *memory*).Counter</code> –ø–æ–∏—Å–∫ –ø–æ wildcard-–∏–º–µ–Ω–∏ –≤–æ –≤—Å–µ—Ö —Å—á–µ—Ç—á–∏–∫–∞—Ö (–≤–∫–ª—é—á–∞—è –¥–æ—á–µ—Ä–Ω–∏–∏) <br />
<code class="language-plaintext highlighter-rouge">Get-Counter "\Memory\Available MBytes"</code> –æ–±—ä–µ–º —Å–≤–æ–±–æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-Counter -cn $srv "\LogicalDisk(*)\% Free Space"</code> % —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö –¥–∏—Å–∫–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">(Get-Counter "\Process(*)\ID Process").CounterSamples</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Counter "\Processor(_Total)\% Processor Time" ‚ÄìComputerName $srv -MaxSamples 5 -SampleInterval 2</code> 5 –ø—Ä–æ–≤–µ—Ä–æ–∫ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã <br />
<code class="language-plaintext highlighter-rouge">Get-Counter "\–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä(_Total)\% –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞" -Continuous</code> –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ <br />
<code class="language-plaintext highlighter-rouge">(Get-Counter "\–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä(*)\% –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞").CounterSamples</code></p>

<p><code class="language-plaintext highlighter-rouge">(Get-Counter -ListSet *–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å*).Counter</code> –Ω–∞–π—Ç–∏ –≤—Å–µ —Å—á–µ—Ç—á–∏–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">Get-Counter "\–°–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å(*)\–í—Å–µ–≥–æ –±–∞–π—Ç/—Å"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –∞–¥–∞–ø—Ç–µ—Ä—ã (–≤—ã–±—Ä–∞—Ç—å –¥–µ–π—Å—Ç–≤—É—é—â–∏–π –ø–æ —Ç—Ä–∞—Ñ–∏–∫—É)</p>
<pre><code class="language-PowerShell">$WARNING = 25
$CRITICAL = 50
$TransferRate = ((Get-Counter "\\huawei-mb-x-pro\—Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å(intel[r] wi-fi 6e ax211 160mhz)\–≤—Å–µ–≥–æ –±–∞–π—Ç/—Å"
).countersamples | select -ExpandProperty CookedValue)*8
$NetworkUtilisation = [math]::round($TransferRate/1000000000*100,2)
if ($NetworkUtilisation -gt $CRITICAL){
Write-Output "CRITICAL: $($NetworkUtilisation) % Network utilisation, $($TransferRate.ToString('N0')) b/s"   
#exit 2		
}
if ($NetworkUtilisation -gt $WARNING){
Write-Output "WARNING: $($NetworkUtilisation) % Network utilisation, $($TransferRate.ToString('N0')) b/s"
#exit 1
}
Write-Output "OK: $($NetworkUtilisation) % Network utilisation, $($TransferRate.ToString('N0')) b/s"   
#exit 0
</code></pre>
<h1 id="snmp">SNMP</h1>

<h3 id="setup-snmp-service">Setup SNMP Service</h3>

<p><code class="language-plaintext highlighter-rouge">Install-WindowsFeature SNMP-Service,SNMP-WMI-Provider -IncludeManagementTools</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å SNMP –∏ WMI –ø—Ä–æ–≤–∞–π–¥–µ—Ä —á–µ—Ä–µ–∑ Server Manager <br />
<code class="language-plaintext highlighter-rouge">Get-WindowsFeature SNMP*</code> <br />
<code class="language-plaintext highlighter-rouge">Add-WindowsCapability -Online -Name SNMP.Client~~~~0.0.1.0</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Feature On Demand –¥–ª—è Windows 10/11<code class="language-plaintext highlighter-rouge"> \
</code>Get-Service SNMP<em><code class="language-plaintext highlighter-rouge"> \
</code>Get-NetFirewallrule -DisplayName *snmp</em> | ft<code class="language-plaintext highlighter-rouge"> \
</code>Get-NetFirewallrule -DisplayName <em>snmp</em> | Enable-NetFirewallRule`</p>

<h3 id="setting-snmp-service-via-regedit">Setting SNMP Service via Regedit</h3>

<p>Agent: <br />
<code class="language-plaintext highlighter-rouge">New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\RFC1156Agent" -Name "sysContact" -Value "lifailon-user"</code> —Å–æ–∑–¥–∞—Ç—å (New) –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å (Set) <br />
<code class="language-plaintext highlighter-rouge">New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\RFC1156Agent" -Name "sysLocation" -Value "plex-server"</code></p>

<p>Security: <br />
<code class="language-plaintext highlighter-rouge">New-Item -Path "HKLM:\SYSTEM\CurrentControlSet\services\SNMP\Parameters\TrapConfiguration\public"</code> —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π community string <br />
<code class="language-plaintext highlighter-rouge">New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\SNMP\Parameters\ValidCommunities" -Name "public" -Value 16</code> –Ω–∞–∑–Ω–∞—á–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ public <br />
<code class="language-plaintext highlighter-rouge">1 ‚Äî NONE</code> <br />
<code class="language-plaintext highlighter-rouge">2 ‚Äî NOTIFY</code> –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å SNMP –ª–æ–≤—É—à–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">4 ‚Äî READ ONLY</code> –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ <br />
<code class="language-plaintext highlighter-rouge">8 ‚Äî READ WRITE</code> –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –∏–∑–º–µ–Ω—è—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ <br />
<code class="language-plaintext highlighter-rouge">16 ‚Äî READ CREATE</code> –ø–æ–∑–≤–æ–ª—è–µ—Ç —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –∏–∑–º–µ–Ω—è—Ç—å –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã <br />
<code class="language-plaintext highlighter-rouge">New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\SNMP\Parameters\PermittedManagers" -Name "1" -Value "192.168.3.99"</code> –æ—Ç –∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã <br />
<code class="language-plaintext highlighter-rouge">Get-Service SNMP | Restart-Service</code></p>

<h3 id="snmpwalk">snmpwalk</h3>

<p><code class="language-plaintext highlighter-rouge">snmpwalk -v 2c -c public 192.168.3.100</code> <br />
<code class="language-plaintext highlighter-rouge">snmpwalk -v 2c -c public -O e 192.168.3.100</code></p>

<h3 id="snmp-modules">SNMP Modules</h3>

<p><code class="language-plaintext highlighter-rouge">Install-Module -Name SNMP</code> <br />
<code class="language-plaintext highlighter-rouge">Get-SnmpData -IP 192.168.3.100 -OID 1.3.6.1.2.1.1.4.0 -UDPport 161 -Community public</code> <br />
<code class="language-plaintext highlighter-rouge">(Get-SnmpData -IP 192.168.3.100 -OID 1.3.6.1.2.1.1.4.0).Data</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.1</code> –ø—Ä–æ–π—Ç–∏—Å—å –ø–æ –¥–µ—Ä–µ–≤—É OID <br />
<code class="language-plaintext highlighter-rouge">Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.25.6.3.1.2</code> —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ü–û <br />
<code class="language-plaintext highlighter-rouge">Invoke-SnmpWalk -IP 192.168.3.100 -OID 1.3.6.1.2.1.25.2.3.1</code> —Å–ø–∏—Å–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ –∏ –ø–∞–º—è—Ç–∏ (C: D: Virtual Memory –∏ Physical Memory) <br />
<code class="language-plaintext highlighter-rouge">Set-SnmpData</code> –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</p>

<p><code class="language-plaintext highlighter-rouge">Install-Module -Name SNMPv3</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-SNMPv3Get</code> –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ–¥–Ω–æ–º—É OID <br />
<code class="language-plaintext highlighter-rouge">Invoke-SNMPv3Set</code> –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö <br />
<code class="language-plaintext highlighter-rouge">Invoke-SNMPv3Walk</code> –æ–±—Ö–æ–¥ –ø–æ –¥–µ—Ä–µ–≤—É OID <br />
<code class="language-plaintext highlighter-rouge">Invoke-SNMPv3Walk -UserName lifailon -Target 192.168.3.100 -AuthSecret password -PrivSecret password -OID 1.3.6.1.2.1.1 -AuthType MD5 -PrivType AES128</code></p>

<h3 id="lextmsharpsnmplib">Lextm.SharpSnmpLib</h3>

<p><a href="https://learn.microsoft.com/ru-ru/powershell/dsc/reference/resources/windows/fileresource?view=dsc-1.1">–°–∏–Ω—Ç–∞–∫—Å–∏—Å</a> <br />
<a href="https://api.nuget.org/v3-flatcontainer/lextm.sharpsnmplib/12.5.2/lextm.sharpsnmplib.12.5.2.nupkg">Download lib</a></p>

<p><code class="language-plaintext highlighter-rouge">Add-Type -LiteralPath "$home\Desktop\lextm.sharpsnmplib-12.5.2\net471\SharpSnmpLib.dll"</code></p>
<pre><code class="language-PowerShell">$port = 161
$OID = "1.3.6.1.2.1.1.4.0"
$variableList = New-Object Collections.Generic.List[Lextm.SharpSnmpLib.Variable]
$variableList.Add([Lextm.SharpSnmpLib.Variable]::new([Lextm.SharpSnmpLib.ObjectIdentifier]::new($OID)))
$timeout = 3000
[Net.IPAddress]$ip = "192.168.3.100"
$endpoint = New-Object Net.IpEndPoint $ip, $port
$Community = "public"
[Lextm.SharpSnmpLib.VersionCode]$Version = "V2"

$message = [Lextm.SharpSnmpLib.Messaging.Messenger]::Get(
$Version,
$endpoint,
$Community,
$variableList,
$TimeOut
)
$message.Data.ToString()
</code></pre>
<h3 id="walk">Walk</h3>
<pre><code class="language-PowerShell">[Lextm.SharpSnmpLib.ObjectIdentifier]$OID = "1.3.6.1.2.1.1" # –¥–µ—Ä–µ–≤–æ –∏–ª–∏ –∫–æ–Ω–µ—á–Ω—ã–π OID
$WalkMode = [Lextm.SharpSnmpLib.Messaging.WalkMode]::WithinSubtree # —Ä–µ–∂–∏–º –æ–±—Ö–æ–¥–∞ –ø–æ –¥–µ—Ä–µ–≤—É
$results = New-Object Collections.Generic.List[Lextm.SharpSnmpLib.Variable]
$message = [Lextm.SharpSnmpLib.Messaging.Messenger]::Walk(
  $Version,
  $endpoint,
  $Community,
  $OID,
  $results,
  $TimeOut,
  $WalkMode
)
$results

$results2 = @()
foreach ($d in $results) {
$results2 +=[PSCustomObject]@{'ID'=$d.id.ToString();'Data'=$d.Data.ToString()} # –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ –≤ —Å—Ç—Ä–æ–∫—É
}
$results2
</code></pre>
<h1 id="zabbix">Zabbix</h1>

<h3 id="zabbix-agent-deploy">Zabbix Agent Deploy</h3>
<pre><code class="language-PowerShell">$url = "https://cdn.zabbix.com/zabbix/binaries/stable/6.4/6.4.5/zabbix_agent2-6.4.5-windows-amd64-static.zip"
$path = "$home\Downloads\zabbix-agent2-6.4.5.zip"
$WebClient = New-Object System.Net.WebClient
$WebClient.DownloadFile($url, $path)` —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª
Expand-Archive $path -DestinationPath "C:\zabbix-agent2-6.4.5\"` —Ä–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å
Remove-Item $path` —É–¥–∞–ª–∏—Ç—å –∞—Ä—Ö–∏–≤
New-NetFirewallRule -DisplayName "Zabbix-Agent" -Profile Any -Direction Inbound -Action Allow -Protocol TCP -LocalPort 10050,10051` –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç—ã –≤ FW

$Zabbix_Server = "192.168.3.102"
$conf = "C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.conf"
$cat = cat $conf
$rep = $cat -replace "Server=.+","Server=$Zabbix_Server"
$rep | Select-String Server=
$rep &gt; $conf

$exe = "C:\zabbix-agent2-6.4.5\bin\zabbix_agent2.exe"
.$exe --config $conf --install` —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂–±—É
Get-Service *Zabbix*Agent* | Start-Service` –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É
#.$exe --config $conf --uninstall` —É–¥–∞–ª–∏—Ç—å —Å–ª—É–∂–±—É
</code></pre>
<h3 id="zabbix_sender">zabbix_sender</h3>

<p>–°–æ–∑–¥–∞—Ç—å host - –∑–∞–¥–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∏–º—è (powershell-host) –∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É <br />
–°–æ–∑–¥–∞—Ç—å Items: <br />
Name: Service Count <br />
Type: Zabbix trapper <br />
Key: service.count <br />
Type of Information: Numeric</p>
<pre><code class="language-PowerShell">$path = "C:\zabbix-agent2-6.4.5\bin"
$scount = (Get-Service).Count
.$path\zabbix_sender.exe -z 192.168.3.102 -s "powershell-host" -k service.count -o $scount
</code></pre>
<h3 id="zabbix_get">zabbix_get</h3>

<p><code class="language-plaintext highlighter-rouge">apt install zabbix-get</code> <br />
<code class="language-plaintext highlighter-rouge">nano /etc/zabbix/zabbix_agentd.conf</code> <br />
<code class="language-plaintext highlighter-rouge">Server=127.0.0.1,192.168.3.102,192.168.3.99</code> –¥–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö zabbix_get —Å –∞–≥–µ–Ω—Ç–∞ (–∫–∞–∫ –∏—Ö –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä)</p>

<p><code class="language-plaintext highlighter-rouge">.$path\zabbix_get -s 192.168.3.101 -p 10050 -k agent.version</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é –∞–≥–µ–Ω—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">.$path\zabbix_get -s 192.168.3.101 -p 10050 -k agent.ping</code> 1 - ok <br />
<code class="language-plaintext highlighter-rouge">.$path\zabbix_get -s 192.168.3.101 -p 10050 -k net.if.discovery</code> —Å–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">.$path\zabbix_get -s 192.168.3.101 -p 10050 -k net.if.in["ens33"]</code> <br />
<code class="language-plaintext highlighter-rouge">.$path\zabbix_get -s 192.168.3.101 -p 10050 -k net.if.out["ens33"]</code></p>

<h3 id="userparameter">UserParameter</h3>

<p><code class="language-plaintext highlighter-rouge">UserParameter=process.count,powershell -Command "(Get-Process).Count"</code> <br />
<code class="language-plaintext highlighter-rouge">UserParameter=process.vm[*],powershell -Command "(Get-Process $1).ws"</code></p>

<p>Test: <br />
<code class="language-plaintext highlighter-rouge">C:\zabbix-agent2-6.4.5\bin\zabbix_get.exe -s 127.0.0.1 -p 10050 -k process.count</code> <br />
<code class="language-plaintext highlighter-rouge">C:\zabbix-agent2-6.4.5\bin\zabbix_get.exe -s 127.0.0.1 -p 10050 -k process.vm[zabbix_agent2] </code><br />
<code class="language-plaintext highlighter-rouge">C:\zabbix-agent2-6.4.5\bin\zabbix_get.exe -s 127.0.0.1 -p 10050 -k process.vm[powershell]</code></p>

<p>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ Items: <br />
key: <code class="language-plaintext highlighter-rouge">process.count</code> <br />
key: <code class="language-plaintext highlighter-rouge">process.vm[zabbix_agent2]</code></p>

<h3 id="include">Include</h3>

<ul>
  <li>
    <p>–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä Include –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ–¥–∫–ª—é—á–∞–µ–º—ã—Ö –ø–ª–∞–≥–∏–Ω–æ–≤
<code class="language-plaintext highlighter-rouge">'Include=.\zabbix_agent2.d\plugins.d\*.conf' &gt;&gt; C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.conf</code></p>
  </li>
  <li>
    <p>–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ, –ø—É—Ç—å –∫ –∫–æ—Ç–æ—Ä–æ–º—É —É–∫–∞–∑–∞–Ω –≤ zabbix_agentd.conf <br />
<code class="language-plaintext highlighter-rouge">'UserParameter=Get-Query-Param[*],powershell.exe -noprofile -executionpolicy bypass -File C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.d\scripts\User-Sessions\Get-Query-Param.ps1 $1' &gt; C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.d\plugins.d\User-Sessions.conf</code></p>
  </li>
  <li>–ü–æ–º–µ—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç Get-Query-Param.ps1 –≤ –∫–∞—Ç–∞–ª–æ–≥, –ø—É—Ç—å –∫ –∫–æ—Ç–æ—Ä–æ–º—É —É–∫–∞–∑–∞–Ω –≤ User-Sessions.conf. –°–∫—Ä–∏–ø—Ç —Å–æ–¥–µ—Ä–∂–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ—Ç Zabbix —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∏—Ö –≤ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞.
    <pre><code class="language-PowerShell">Param([string]$select)
if ($select -eq "ACTIVEUSER") {
(Get-Query | where status -match "Active").User
}
if ($select -eq "INACTIVEUSER") {
(Get-Query | where status -match "Disconnect").User
}
if ($select -eq "ACTIVECOUNT") {
(Get-Query | where status -match "Active").Status.Count
}
if ($select -eq "INACTIVECOUNT") {
(Get-Query | where status -match "Disconnect").Status.Count
}
</code></pre>
  </li>
  <li>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–∫—Ä–∏–ø—Ç–∞:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">$path = "C:\zabbix-agent2-6.4.5\conf\zabbix_agent2.d\scripts\User-Sessions"</code> <br />
<code class="language-plaintext highlighter-rouge">.$path\Get-Query-Param.ps1 ACTIVEUSER</code> <br />
<code class="language-plaintext highlighter-rouge">.$path\Get-Query-Param.ps1 INACTIVEUSER</code> <br />
<code class="language-plaintext highlighter-rouge">.$path\Get-Query-Param.ps1 ACTIVECOUNT</code> <br />
<code class="language-plaintext highlighter-rouge">.$path\Get-Query-Param.ps1 INACTIVECOUNT</code></p>

<ul>
  <li>–°–æ–∑–¥–∞—Ç—å Items —Å –∫–ª—é—á–∞–º–∏:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">Get-Query-Param[ACTIVEUSER]</code> Type: Text <br />
<code class="language-plaintext highlighter-rouge">Get-Query-Param[INACTIVEUSER]</code> Type: Text <br />
<code class="language-plaintext highlighter-rouge">Get-Query-Param[ACTIVECOUNT]</code> Type: Int <br />
<code class="language-plaintext highlighter-rouge">Get-Query-Param[INACTIVECOUNT]</code> Type: Int</p>

<ul>
  <li>–ú–∞–∫—Ä–æ—Å—ã:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">{$ACTIVEMAX} = 16</code> <br />
<code class="language-plaintext highlighter-rouge">{$ACTIVEMIN} = 0</code></p>

<ul>
  <li>–¢—Ä–∏–≥–≥–µ—Ä—ã:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">last(/Windows-User-Sessions/Get-Query-Param[ACTIVECOUNT])&gt;{$ACTIVEMAX}</code> <br />
<code class="language-plaintext highlighter-rouge">min(/Windows-User-Sessions/Get-Query-Param[ACTIVECOUNT],24h)={$ACTIVEMIN}</code></p>

<h3 id="zabbix_agent2conf">zabbix_agent2.conf</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># –ê–≥–µ–Ω—Ç –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ø–∞—Å—Å–∏–≤–Ω–æ–º (—Å–µ—Ä–≤–µ—Ä –∑–∞–±–∏—Ä–∞–µ—Ç —Å–∞–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é) –∏ –∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ (–∞–≥–µ–Ω—Ç —Å–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç):
Server=192.168.3.102
ServerActive=192.168.3.102
# –¢—Ä–µ–±—É–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç—å hostname –¥–ª—è ServerActive:
Hostname=huawei-book-01
# –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–º–µ–Ω–∏ —Ö–æ—Å—Ç–∞ (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –µ—Å–ª–∏ –∏–º—è —Ö–æ—Å—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ):
# HostnameItem=system.hostname
# –ö–∞–∫ —á–∞—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫, –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (Range: 60-3600):
RefreshActiveChecks=120
# IP-–∞–¥—Ä–µ—Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–ª—è –∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π:
# SourceIP=
# –ê–≥–µ–Ω—Ç –±—É–¥–µ—Ç —Å–ª—É—à–∞—Ç—å –Ω–∞ —ç—Ç–æ–º –ø–æ—Ä—Ç—É —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º (Range: 1024-32767):
# ListenPort=10050
# –°–ø–∏—Å–æ–∫ IP-–∞–¥—Ä–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∞–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—Å–ª—É—à–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
# ListenIP=0.0.0.0
# –ê–≥–µ–Ω—Ç –±—É–¥–µ—Ç –ø—Ä–æ—Å–ª—É—à–∏–≤–∞—Ç—å —ç—Ç–æ—Ç –ø–æ—Ä—Ç –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Å—Ç–∞—Ç—É—Å–∞ HTTP (Range: 1024-32767):
# StatusPort=
ControlSocket=\\.\pipe\agent.sock
# –ö—É–¥–∞ –≤–µ—Å—Ç–∏ –∂—É—Ä–Ω–∞–ª (file/syslog/console):
LogType=file
LogFile=C:\zabbix-agent2-6.4.5\zabbix_agent2.log
# –†–∞–∑–º–µ—Ä –ª–æ–≥–∞ –æ—Ç 0-1024 MB (0 - –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤)
LogFileSize=100
# –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è. 4 - –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (–≤—ã–¥–∞–µ—Ç –º–Ω–æ–≥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
DebugLevel=4
</code></pre></div></div>
<h3 id="api-token">API Token</h3>

<p><a href="https://www.zabbix.com/documentation/current/en/manual/api/reference">Documentation</a></p>

<p><code class="language-plaintext highlighter-rouge">$ip = "192.168.3.102"</code> <br />
<code class="language-plaintext highlighter-rouge">$url = "http://$ip/zabbix/api_jsonrpc.php"</code></p>
<pre><code class="language-PowerShell">$data = @{
    "jsonrpc"="2.0";
    "method"="user.login";
    "params"=@{
        "username"="Admin";` –≤ –≤–µ—Ä—Å–∏–∏ –¥–æ 6.4 –ø–∞—Ä–∞–º–µ—Ç—Ä "user"
        "password"="zabbix";
    };
    "id"=1;
}
$token = (Invoke-RestMethod -Method POST -Uri $url -Body ($data | ConvertTo-Json) -ContentType "application/json").Result
</code></pre>
<p><code class="language-plaintext highlighter-rouge">$token = "2eefd25fdf1590ebcdb7978b5bcea1fff755c65b255da8cbd723181b639bb789"</code> —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –≤ UI (http://192.168.3.102/zabbix/zabbix.php?action=token.list)</p>

<h3 id="userget">user.get</h3>
<pre><code class="language-PowerShell">$data = @{
    "jsonrpc"="2.0";
    "method"="user.get";
    "params"=@{
    };
    "auth"=$token;
    "id"=1;
}
$users = (Invoke-RestMethod -Method POST -Uri $url -Body ($data | ConvertTo-Json) -ContentType "application/json").Result
</code></pre>
<h3 id="problemget">problem.get</h3>
<pre><code class="language-PowerShell">$data = @{
    "jsonrpc"="2.0";
    "method"="problem.get";
    "params"=@{
    };
    "auth"=$token;
    "id"=1;
}
(Invoke-RestMethod -Method POST -Uri $url -Body ($data | ConvertTo-Json) -ContentType "application/json").Result
</code></pre>
<h3 id="hostget">host.get</h3>

<p>–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ö–æ—Å—Ç–æ–≤ (–∏–º—è –∏ id)</p>

<p><a href="https://www.zabbix.com/documentation/current/en/manual/api/reference/host">Endpoint host</a></p>

<p>host.create - creating new hosts <br />
host.delete - deleting hosts <br />
host.get - retrieving hosts <br />
host.massadd - adding related objects to hosts <br />
host.massremove - removing related objects from hosts <br />
host.massupdate - replacing or removing related objects from hosts <br />
host.update - updating hosts</p>
<pre><code class="language-PowerShell">$data = @{
    "jsonrpc"="2.0";
    "method"="host.get";
    "params"=@{
        "output"=@(` –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥
            "hostid";
            "host";
        );
    };
    "id"=2;
    "auth"=$token;
}
$hosts = (Invoke-RestMethod -Method POST -Uri $url -Body ($data | ConvertTo-Json) -ContentType "application/json").Result
$host_id = $hosts[3].hostid` –∑–∞–±—Ä–∞—Ç—å id —Ö–æ—Å—Ç–∞ –ø–æ –∏–Ω–¥–µ–∫—Å—É
</code></pre>
<h3 id="itemget">item.get</h3>

<p>–ü–æ–ª—É—á–∏—Ç—å id —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö –ø–æ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—é –∫–ª—é—á–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞</p>
<pre><code class="language-PowerShell">$data = @{
    "jsonrpc"="2.0";
    "method"="item.get";
    "params"=@{
        "hostids"=@($host_id);` –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Ö–æ—Å—Ç—É
    };
    "auth"=$token;
    "id"=1;
}
$items = (Invoke-RestMethod -Method POST -Uri $url -Body ($data | ConvertTo-Json) -ContentType "application/json").Result
$items_id = ($items | where key_ -match system.uptime).itemid` –∑–∞–±—Ä–∞—Ç—å id —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
</code></pre>
<h3 id="historyget">history.get</h3>

<p>–ü–æ–ª—É—á–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –µ–≥–æ id</p>
<pre><code class="language-PowerShell">$data = @{
    "jsonrpc"="2.0";
    "method"="history.get";
    "params"=@{
        "hostids"=@($host_id); ` —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ö–æ—Å—Ç—É
        "itemids"=@($items_id);` —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —ç–ª–µ–º–µ–Ω—Ç—É –¥–∞–Ω–Ω—ã—Ö
    };
    "auth"=$token;
    "id"=1;
}
$items_data_uptime = (Invoke-RestMethod -Method POST -Uri $url -Body ($data | ConvertTo-Json) -ContentType "application/json").Result` –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–ª—é—á—É —É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞
</code></pre>
<h3 id="convert-secconds-to-timespan-and-datetime">Convert Secconds To TimeSpan and DateTime</h3>

<p><code class="language-plaintext highlighter-rouge">$sec = $items_data_uptime.value</code></p>
<pre><code class="language-PowerShell">function ConvertSecondsTo-TimeSpan {
    param (
        $insec
    )
    $TimeSpan = [TimeSpan]::fromseconds($insec)
    "{0:dd' day 'hh\:mm\:ss}" -f $TimeSpan
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">$UpTime = ConvertSecondsTo-TimeSpan $sec[-1]</code></p>

<h3 id="convert-from-unix-time">Convert From Unix Time</h3>

<p><code class="language-plaintext highlighter-rouge">$time = $items_data_uptime.clock</code></p>
<pre><code class="language-PowerShell">function ConvertFrom-UnixTime {
    param (
        $intime
    )
    $EpochTime = [DateTime]"1/1/1970"
    $TimeZone = Get-TimeZone
    $UTCTime = $EpochTime.AddSeconds($intime)
    $UTCTime.AddMinutes($TimeZone.BaseUtcOffset.TotalMinutes)
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">$GetDataTime = ConvertFrom-UnixTime $time[-1]</code></p>

<p><code class="language-plaintext highlighter-rouge">($hosts | where hostid -eq $host_id).host</code> –ø–æ–ª—É—á–∏—Ç—å –∏–º—è —Ö–æ—Å—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">$UpTime</code> –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã —Ö–æ—Å—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">$GetDataTime</code> –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è</p>

<h1 id="pki">pki</h1>

<p><code class="language-plaintext highlighter-rouge">New-SelfSignedCertificate -CertStoreLocation Cert:\LocalMachine\My -DnsName "$env:computername" -FriendlyName "Test Certificate" -NotAfter (Get-Date).AddYears(5)</code> —Å–æ–∑–¥–∞—Ç—å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–≤ LocalMachine\My - –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∫–æ–º–ø—å—é—Ç–µ—Ä–∞\–õ–∏—á–Ω–æ–µ) —Å —Å—Ä–æ–∫–æ–º –¥–µ–π—Å—Ç–≤–∏—è 5 –ª–µ—Ç</p>

<p><code class="language-plaintext highlighter-rouge">Get-ChildItem -Path Cert:\CurrentUser\Root\</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –î–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ –¶–° –¢–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">Get-ChildItem -Path Cert:\CurrentUser\My\</code> —Å–ø–∏—Å–æ–∫ —Å–∞–º–æ–∑–∞–≤–µ—Ä—è—é—â–∏—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ –õ–∏—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¢–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">Get-ChildItem -Path Cert:\LocalMachine\My\</code> —Å–ø–∏—Å–æ–∫ —Å–∞–º–æ–∑–∞–≤–µ—Ä—è—é—â–∏—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ –õ–∏—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –õ–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-ChildItem -Path Cert:\LocalMachine\My\ | select NotBefore,NotAfter,Thumbprint,Subject</code> —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">Get-ChildItem -Path Cert:\LocalMachine\My\ | where Thumbprint -eq D9356FB774EE0E6206B7D5B59B99102CA5B17BDA</code> –ø–æ–∏—Å–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ –æ—Ç–ø–µ—á–∞—Ç–∫—É</p>

<p><code class="language-plaintext highlighter-rouge">Get-ChildItem -Path $env:APPDATA\Microsoft\SystemCertificates\My\Certificates\</code> —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ, –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É –≤ –ª–∏—á–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">Get-ChildItem -Path $env:APPDATA\Microsoft\SystemCertificates\My\Keys\</code> —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—ä–µ–∫—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã—Ö –∫–ª—é—á–µ–π, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∫–ª—é—á–µ–π (KSP) <br />
<code class="language-plaintext highlighter-rouge">Get-ChildItem -Path HKCU:\Software\Microsoft\SystemCertificates\CA\Certificates | ft -AutoSize</code> —Å–ø–∏—Å–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ —Ä–µ–µ—Å—Ç—Ä–µ –≤–æ—à–µ–¥—à–µ–≥–æ –≤ —Å–∏—Å—Ç–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>

<p><code class="language-plaintext highlighter-rouge">$cert = (Get-ChildItem -Path Cert:\CurrentUser\My\)[1]</code> –≤—ã–±—Ä–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç <br />
<code class="language-plaintext highlighter-rouge">$cert | Remove-Item</code> —É–¥–∞–ª–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</p>

<p><code class="language-plaintext highlighter-rouge">Export-Certificate -FilePath $home\Desktop\certificate.cer -Cert $cert</code> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç <br />
<code class="language-plaintext highlighter-rouge">$cert.HasPrivateKey</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ <br />
<code class="language-plaintext highlighter-rouge">$pass = "password" | ConvertTo-SecureString -AsPlainText -Force</code> —Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ <br />
<code class="language-plaintext highlighter-rouge">Export-PfxCertificate -FilePath $home\Desktop\certificate.pfx -Password $pass -Cert $certificate</code> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å –∑–∞–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–µ–º</p>

<p><code class="language-plaintext highlighter-rouge">Import-Certificate -FilePath $home\Desktop\certificate.cer -CertStoreLocation Cert:\CurrentUser\My</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç <br />
<code class="language-plaintext highlighter-rouge">Import-PfxCertificate -Exportable -Password $pass -CertStoreLocation Cert:\CurrentUser\My -FilePath $home\Desktop\certificate.pfx</code></p>

<h1 id="openssl">OpenSSL</h1>
<pre><code class="language-PowerShell">Invoke-WebRequest -Uri https://slproweb.com/download/Win64OpenSSL_Light-3_1_1.msi -OutFile $home\Downloads\OpenSSL-Light-3.1.1.msi
Start-Process $home\Downloads\OpenSSL-Light-3.1.1.msi -ArgumentList '/quiet' -Wait` —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å msi –ø–∞–∫–µ—Ç –≤ —Ç–∏—Ö–æ–º —Ä–µ–∂–∏–º–µ (–∑–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
rm $home\Downloads\OpenSSL-Light-3.1.1.msi
cd "C:\Program Files\OpenSSL-Win64\bin"
</code></pre>
<ul>
  <li>
    <p>–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è PFX <br />
<code class="language-plaintext highlighter-rouge">openssl pkcs12 -in "C:\Cert\domain.ru.pfx" -out "C:\Cert\domain.ru.pem" -nodes</code> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∏–º–µ—é—â–∏–π—Å—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á –≤ .pem-—Ñ–∞–π–ª –±–µ–∑ –ø–∞—Ä–æ–ª—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–∞—Ä–æ–ª—è <br />
<code class="language-plaintext highlighter-rouge">openssl pkcs12 -export -in "C:\Cert\domain.ru.pem" -out "C:\Cert\domain.ru_password.pfx" -nodes</code> –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º .pem –æ–±—Ä–∞—Ç–Ω–æ –≤ .pfx c —É–∫–∞–∑–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è</p>
  </li>
  <li>
    <p>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∏ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ PEM –≤ PFX <br />
<code class="language-plaintext highlighter-rouge">openssl pkcs12 -export -in "C:\tmp\vpn\vpn.itproblog.ru-crt.pem" -inkey "C:\tmp\vpn\vpn.itproblog.ru-key.pem" -out "C:\tmp\vpn\vpn.iiproblog.ru.pfx"</code> <br />
in ‚Äì –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–æ–º <br />
inkey ‚Äì –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞ —Å –∑–∞–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–æ–º <br />
out ‚Äì –ø—É—Ç—å –¥–æ —Ñ–∞–π–ª–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (pfx)</p>
  </li>
  <li>
    <p>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PFX –≤ CRT <br />
<code class="language-plaintext highlighter-rouge">openssl pkcs12 -in "C:\OpenSSL-Win64\bin\_.domain.ru.pfx" -clcerts -out "C:\OpenSSL-Win64\bin\_.domain.ru.crt"</code> —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–π –∏ 2 —Ä–∞–∑–∞ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å PEM pass phrase (—Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç EGIN CERTIFICATE –∏ BEGIN ENCRYPTED PRIVATE KEY) <br />
<code class="language-plaintext highlighter-rouge">openssl pkcs12 -in "C:\OpenSSL-Win64\bin\_.domain.ru.pfx" -clcerts -nokeys -out "C:\OpenSSL-Win64\bin\_.domain.ru.crt"</code> –±–µ–∑ –∫–ª—é—á–∞, –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç—É—é —á–∞—Å—Ç—å (—Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ EGIN CERTIFICATE)</p>
  </li>
  <li>
    <p>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PFX –≤ KEY <br />
<code class="language-plaintext highlighter-rouge">openssl pkcs12 -in "C:\OpenSSL-Win64\bin\_.domain.ru.pfx" -nocerts -out "C:\OpenSSL-Win64\bin\_.domain.ru.key"</code> —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ BEGIN ENCRYPTED PRIVATE KEY</p>
  </li>
  <li>
    <p>–°–Ω—è—Ç—å –ø–∞—Ä–æ–ª—å –∫ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ .key <br />
<code class="language-plaintext highlighter-rouge">openssl rsa -in "C:\OpenSSL-Win64\bin\_.domain.ru.key" -out "C:\OpenSSL-Win64\bin\_.domain.ru-decrypted.key"</code></p>
  </li>
  <li>
    <p>CRT –∏ KEY –≤ PFX: <br />
<code class="language-plaintext highlighter-rouge">openssl pkcs12 -inkey certificate.key -in certificate.crt -export -out certificate.pfx</code></p>
  </li>
</ul>

<h1 id="openvpn">OpenVPN</h1>

<p><code class="language-plaintext highlighter-rouge">Invoke-WebRequest -Uri https://swupdate.openvpn.org/community/releases/OpenVPN-2.6.5-I001-amd64.msi -OutFile $home\Downloads\OpenVPN-2.6.5.msi</code> <br />
<code class="language-plaintext highlighter-rouge">Start-Process $home\Downloads\OpenVPN-2.6.5.msi -ArgumentList '/quiet /SELECT_OPENSSL_UTILITIES=1' -Wait</code> <br />
<code class="language-plaintext highlighter-rouge">msiexec /i $home\Downloads\OpenVPN-2.6.5.msi ADDLOCAL=EasyRSA /passive /quiet # —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç EasyRSA Certificate Management Scripts</code> <br />
<code class="language-plaintext highlighter-rouge"># msiexec /i $home\Downloads\OpenVPN-2.6.5.msi ADDLOCAL=OpenVPN.Service,Drivers,Drivers.Wintun,OpenVPN,OpenVPN.GUI,OpenVPN.GUI.OnLogon,EasyRSA /passive</code> –≤—ã–±–æ—Ä–æ—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ <br />
<code class="language-plaintext highlighter-rouge"># Invoke-WebRequest -Uri https://github.com/OpenVPN/easy-rsa/releases/download/v3.1.5/EasyRSA-3.1.5-win64.zip -OutFile $home\Downloads\EasyRSA-3.1.5.zip</code> —Å–∫–∞—á–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç EasyRSA <br />
<code class="language-plaintext highlighter-rouge">rm $home\Downloads\OpenVPN-2.6.5.msi</code></p>

<p><code class="language-plaintext highlighter-rouge">cd "C:\Program Files\OpenVPN\easy-rsa"</code> <br />
<code class="language-plaintext highlighter-rouge">Copy-Item vars.example vars</code> —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è EasyRSA</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set_var EASYRSA_TEMP_DIR "$EASYRSA_PKI"
set_var EASYRSA_REQ_COUNTRY "RU"
set_var EASYRSA_REQ_PROVINCE "MSK"
set_var EASYRSA_REQ_CITY "MSK"
set_var EASYRSA_REQ_ORG "FAILON.NET"
set_var EASYRSA_REQ_EMAIL "lifailon@domain.ru"
set_var EASYRSA_REQ_OU "IT"
#set_var EASYRSA_KEY_SIZE 2048
#set_var EASYRSA_CA_EXPIRE 3650
#set_var EASYRSA_CERT_EXPIRE 825
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">.\EasyRSA-Start.bat</code> —Å—Ä–µ–¥–∞ EasyRSA Shell <br />
<code class="language-plaintext highlighter-rouge">easyrsa init-pki</code> –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PKI, —Å–æ–∑–¥–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: C:\Program Files\OpenVPN\easy-rsa\pki –∏ —á–∏—Ç–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞ \easy-rsa\vars <br />
<code class="language-plaintext highlighter-rouge">easyrsa build-ca</code> –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ—Ä–Ω–µ–≤–æ–≥–æ CA —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–∞—Ä–æ–ª—è –∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∏–º—è —Å–µ—Ä–≤–µ—Ä–∞ (\pki\ca.crt –∏ \pki\private\ca.key) <br />
<code class="language-plaintext highlighter-rouge">easyrsa gen-req server nopass</code> –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∏ –∫–ª—é—á –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ OpenVPN - yes (\pki\reqs\server.req –∏ \pki\private\server.key) <br />
<code class="language-plaintext highlighter-rouge">easyrsa sign-req server server</code> –ø–æ–¥–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–ø—É—Å–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ —Å –ø–æ–º–æ—â—å—é CA - yes (\pki\issued\server.crt) <br />
<code class="language-plaintext highlighter-rouge">easyrsa gen-dh</code> —Å–æ–∑–¥–∞—Ç—å –∫–ª—é—á –î–∏—Ñ—Ñ–∏-–•–µ–ª–ª–º–∞–Ω–∞ (\pki\dh.pem) <br />
<code class="language-plaintext highlighter-rouge">easyrsa gen-req client1</code> nopass<code class="language-plaintext highlighter-rouge"> –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∏ –∫–ª—é—á –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ OpenVPN (\pki\reqs\client1.req –∏ \pki\private\client1.key)</code> <br />
<code class="language-plaintext highlighter-rouge">easyrsa sign-req client client1</code> –ø–æ–¥–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–ø—É—Å–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ —Å –ø–æ–º–æ—â—å—é CA - yes (\pki\issued\client1.crt) <br />
<code class="language-plaintext highlighter-rouge">easyrsa revoke client1</code> –æ—Ç–æ–∑–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">openssl rsa -in "C:\Program Files\OpenVPN\easy-rsa\pki\private\client1.key" -out "C:\Program Files\OpenVPN\easy-rsa\pki\private\client1_nopass.key"</code> —Å–Ω—è—Ç—å –∑–∞—â–∏—Ç—É –ø–∞—Ä–æ–ª–µ–º –¥–ª—è –∫–ª—é—á–∞ (BEGIN ENCRYPTED PRIVATE KEY -&gt; BEGIN PRIVATE KEY) <br />
<code class="language-plaintext highlighter-rouge">exit</code> <br />
<code class="language-plaintext highlighter-rouge">cd "C:\Program Files\OpenVPN\bin"</code> <br />
<code class="language-plaintext highlighter-rouge">.\openvpn --genkey secret ta.key</code> –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ tls-auth (\bin\ta.key) <br />
<code class="language-plaintext highlighter-rouge">Move-Item "C:\Program Files\OpenVPN\bin\ta.key" "C:\Program Files\OpenVPN\easy-rsa\pki\"</code></p>

<h3 id="serverovpn">server.ovpn</h3>

<p><code class="language-plaintext highlighter-rouge"># Copy-Item "C:\Program Files\OpenVPN\sample-config\server.ovpn" "C:\Program Files\OpenVPN\config-auto\server.ovpn"</code> <br />
<code class="language-plaintext highlighter-rouge">New-Item -ItemType File -Path "C:\Program Files\OpenVPN\config-auto\server.ovpn"</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>port 1194
proto udp
# –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç—É–Ω–Ω–µ–ª–µ (ethernet —Ñ—Ä–µ–π–º—ã - tap –∏–ª–∏ ip –ø–∞–∫–µ—Ç—ã - tun)
dev tun
ca "C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\ca.crt"
cert "C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\issued\\server.crt"
key "C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\private\\server.key"
dh "C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\dh.pem"
server 192.168.4.0 255.255.255.0
# –•—Ä–∞–Ω–∏—Ç —Å–ø–∏—Å–æ–∫ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è ip –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤, —á—Ç–æ –±—ã –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ç–æ—Ç –∂–µ –∞–¥—Ä–µ—Å –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
# ifconfig-pool-persist "C:\\Program Files\\OpenVPN\\dhcp-client-list.txt"
# –†–∞–∑—Ä–µ—à–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞–º –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –ø–æ–¥ –æ–¥–Ω–∏–º –∫–ª—é—á–æ–º
# duplicate-cn
# max-clients 30
# –†–∞–∑—Ä–µ—à–∏—Ç—å –æ–±–º–µ–Ω —Ç—Ä–∞—Ñ–∏–∫–æ–º –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏
client-to-client
# compress
tls-auth "C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\ta.key" 0
cipher AES-256-GCM
keepalive 20 60
# –ù–µ –ø–µ—Ä–µ—á–∏—Ç–∞–≤–∞—Ç—å —Ñ–∞–π–ª—ã –∫–ª—é—á–µ–π –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Ç—É–Ω–Ω–µ–ª—è
persist-key
# –û—Å—Ç–∞–≤–ª—è–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ tun/tap –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ OpenVPN
persist-tun
status "C:\\Program Files\\OpenVPN\\log\\status.log"
log "C:\\Program Files\\OpenVPN\\log\\openvpn.log"
verb 3
mute 20
windows-driver wintun
# –û—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–æ–¥—Å–µ—Ç–∏ –∑–∞ —Å–µ—Ä–≤–µ—Ä–æ–º
push "route 192.168.3.0 255.255.255.0"
push "route 192.168.4.0 255.255.255.0"
# –ó–∞–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫–ª–∏–µ–Ω—Ç–∞ (–≤ —Ç–æ–º —á–∏—Å–ª–µ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Ç—Ä–∞—Ñ–∏–∫) –Ω–∞ OpenVPN —Å–µ—Ä–≤–µ—Ä
# push "redirect-gateway def1"
# push "dhcp-option DNS 192.168.3.101"
# push "dhcp-option DOMAIN failon.net"
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">New-NetFirewallRule -DisplayName "AllowOpenVPN-In" -Direction Inbound -Protocol UDP ‚ÄìLocalPort 1194 -Action Allow</code> –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ <br />
<code class="language-plaintext highlighter-rouge">New-NetFirewallRule -DisplayName "AllowOpenVPN-Out" -Direction Outbound -Protocol UDP ‚ÄìLocalPort 1194 -Action Allow</code> –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ <br />
<code class="language-plaintext highlighter-rouge">Get-Service *openvpn* | Restart-Service</code></p>

<h3 id="clientovpn">client.ovpn</h3>

<p><code class="language-plaintext highlighter-rouge"># Copy-Item "C:\Program Files\OpenVPN\sample-config\client.ovpn" "C:\Program Files\OpenVPN\config-auto\client.ovpn"</code> <br />
<code class="language-plaintext highlighter-rouge">New-Item -ItemType File -Path "C:\Program Files\OpenVPN\config-auto\client.ovpn"</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>client
dev tun
proto udp
remote 26.115.154.67 1194
resolv-retry infinite
nobind
persist-key
persist-tun
ca ca.crt
cert client1.crt
key client1.key
remote-cert-tls server
tls-auth ta.key 1
cipher AES-256-GCM
connect-retry-max 25
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä wintun –∏ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –¥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ openvpn gui
windows-driver wintun
verb 3
</code></pre></div></div>
<h3 id="client">Client</h3>

<p><code class="language-plaintext highlighter-rouge">iwr -Uri https://openvpn.net/downloads/openvpn-connect-v3-windows.msi -OutFile "$home\downloads\OpenVPN-Connect-3.msi"</code> <br />
–ü–µ—Ä–µ–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –∫–ª—é—á–∏: <br />
<code class="language-plaintext highlighter-rouge">client.ovpn</code> <br />
<code class="language-plaintext highlighter-rouge">ca.crt</code> <br />
<code class="language-plaintext highlighter-rouge">dh.pem</code> <br />
<code class="language-plaintext highlighter-rouge">ta.key</code> <br />
<code class="language-plaintext highlighter-rouge">client1.crt</code> <br />
<code class="language-plaintext highlighter-rouge">client1.key</code></p>

<h1 id="route">Route</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Service RemoteAccess | Stop-Service</code> <br />
<code class="language-plaintext highlighter-rouge">Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters" -Name "IPEnableRouter" -Value 1</code> –≤–∫–ª—é—á–∞–µ—Ç IP –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é <br />
<code class="language-plaintext highlighter-rouge">(Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters").IPEnableRouter</code> <br />
<code class="language-plaintext highlighter-rouge">Get-NetIPInterface | select ifIndex,InterfaceAlias,AddressFamily,ConnectionState,Forwarding | ft</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã <br />
<code class="language-plaintext highlighter-rouge">Set-NetIPInterface -ifIndex 13 -Forwarding Enabled</code> –≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—é –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ</p>

<p><code class="language-plaintext highlighter-rouge">sysctl net.ipv4.ip_forward=1</code> <br />
<code class="language-plaintext highlighter-rouge">echo "sysctl net.ipv4.ip_forward = 1" &gt;&gt; /etc/sysctl.conf</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-NetRoute</code> <br />
<code class="language-plaintext highlighter-rouge">New-NetRoute -DestinationPrefix "192.168.3.0/24" -NextHop "192.168.4.1" -InterfaceIndex 8</code> <br />
<code class="language-plaintext highlighter-rouge">route -p add 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 1</code> <br />
<code class="language-plaintext highlighter-rouge">route -p change 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 2</code> <br />
<code class="language-plaintext highlighter-rouge">route -p add 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 1 if 7</code> —É–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å—ã–ª–∞—Ç—å –ø–∞–∫–µ—Ç (Wintun Userspace Tunnel) <br />
<code class="language-plaintext highlighter-rouge">route print -4</code> <br />
<code class="language-plaintext highlighter-rouge">route delete 192.168.3.0</code></p>

<p><code class="language-plaintext highlighter-rouge">tracert 192.168.3.101</code> —Å 192.168.4.6</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1    17 ms     *       22 ms  192.168.4.1
2    12 ms    13 ms    14 ms  192.168.3.101
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">route add -net 192.168.4.0 netmask 255.255.255.0 gw 192.168.3.100</code> <br />
<code class="language-plaintext highlighter-rouge">route -e</code></p>

<p><code class="language-plaintext highlighter-rouge">traceroute 192.168.4.6</code> —Å 192.168.3.101</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1  192.168.3.100 (192.168.3.100)  0.148 ms  0.110 ms  0.106 ms
2  192.168.4.6 (192.168.4.6)  14.573 ms * *
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ping 192.168.3.101 -t</code> —Å 192.168.4.6 <br />
<code class="language-plaintext highlighter-rouge">tcpdump -n -i ens33 icmp</code> –Ω–∞ 192.168.3.101</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>14:36:34.533771 IP 192.168.4.6 &gt; 192.168.3.101: ICMP echo request, id 1, seq 2962, length 40 # –æ—Ç–ø—Ä–∞–≤–∏–ª –∑–∞–ø—Ä–æ—Å
14:36:34.533806 IP 192.168.3.101 &gt; 192.168.4.6: ICMP echo reply, id 1, seq 2962, length 40 # –æ—Ç–ø—Ä–∞–≤–∏–ª –æ—Ç–≤–µ—Ç
</code></pre></div></div>
<h1 id="nat">NAT</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Command -Module NetNat</code> <br />
<code class="language-plaintext highlighter-rouge">New-NetNat -Name LocalNat -InternalIPInterfaceAddressPrefix "192.168.3.0/24"</code> <br />
<code class="language-plaintext highlighter-rouge">Add-NetNatStaticMapping -NatName LocalNat -Protocol TCP -ExternalIPAddress 0.0.0.0 -ExternalPort 80 -InternalIPAddress 192.168.3.102 -InternalPort 80</code> <br />
<code class="language-plaintext highlighter-rouge">Remove-NetNatStaticMapping -StaticMappingID 0</code> <br />
<code class="language-plaintext highlighter-rouge">Remove-NetNat -Name LocalNat</code></p>

<h1 id="wireguard">WireGuard</h1>

<p><code class="language-plaintext highlighter-rouge">Invoke-WebRequest "https://download.wireguard.com/windows-client/wireguard-amd64-0.5.3.msi" -OutFile "$home\Downloads\WireGuard-Client-0.5.3.msi"</code> <br />
<code class="language-plaintext highlighter-rouge">msiexec.exe /i "$home\Downloads\WireGuard-Client-0.5.3.msi" DO_NOT_LAUNCH=1 /qn</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-WebRequest "http://www.wiresock.net/downloads/wiresock-vpn-gateway-x64-1.1.4.1.msi" -OutFile "$home\Downloads\WireSock-VPN-Gateway-1.1.4.1.msi"</code> <br />
<code class="language-plaintext highlighter-rouge">msiexec.exe /i "http://www.wiresock.net/downloads/wiresock-vpn-gateway-x64-1.1.4.1.msi" /qn</code> <br />
<code class="language-plaintext highlighter-rouge">$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")</code> <br />
<code class="language-plaintext highlighter-rouge">wg-quick-config -add -start</code> <br />
<code class="language-plaintext highlighter-rouge">26.115.154.67:8181</code> <br />
<code class="language-plaintext highlighter-rouge">192.168.21.4/24</code> <br />
<code class="language-plaintext highlighter-rouge">Successfully saved client configuration: C:\ProgramData\NT KERNEL\WireSock VPN Gateway\wsclient_1.conf</code> <br />
<code class="language-plaintext highlighter-rouge">Successfully saved server configuration: C:\ProgramData\NT KERNEL\WireSock VPN Gateway\wiresock.conf</code> <br />
<code class="language-plaintext highlighter-rouge">get-service *wire*</code> <br />
<code class="language-plaintext highlighter-rouge">wg show</code> <br />
<code class="language-plaintext highlighter-rouge">wg-quick-config -add -restart</code> add client</p>

<p>wiresock.conf</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Interface]
PrivateKey = gCHC0g2JPwr6sXPiaOL4/KTkMyjN9TculrJUA/GORV8=
Address = 192.168.21.5/24
ListenPort = 8181

[Peer]
PublicKey = NoSxjew2RCHiUzI6mlahjd4I+0EcLsoYom/H01z91yU=
AllowedIPs = 192.168.21.6/32
</code></pre></div></div>
<p>wsclient_1.conf (–¥–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –≤ AllowedIPs)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Interface]
PrivateKey = yIpRQRmaGrrk9Y+49E8JhEpFmKzSeecvUAdeNgf1hUM=
Address = 192.168.21.6/24
DNS = 8.8.8.8, 1.1.1.1
MTU = 1420

[Peer]
PublicKey = Fp7674VSYeGj8CYt6RCKR7Qz1y/IKUXCw8ImOFhX3hk=
AllowedIPs = 192.168.21.0/24, 192.168.3.0/24
Endpoint = 26.115.154.67:8181
PersistentKeepalive = 25
</code></pre></div></div>
<h1 id="vpnclient">VpnClient</h1>

<p><code class="language-plaintext highlighter-rouge">Get-Command -Module VpnClient</code> <br />
<code class="language-plaintext highlighter-rouge">Add-VpnConnection -Name "vpn-failon" -ServerAddress "26.115.154.67" -TunnelType L2TP -L2tpPsk "123098" -EncryptionLevel "Required" -AuthenticationMethod MSChapv2 -RememberCredential -AllUserConnection ‚ÄìPassThru -Force</code> <br />
<code class="language-plaintext highlighter-rouge">-TunnelType PPTP/L2TP/SSTP/IKEv2/Automatic</code> <br />
<code class="language-plaintext highlighter-rouge">-L2tpPsk</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–π –∫–ª—é—á –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –¥–ª—è L2TP –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç) <br />
<code class="language-plaintext highlighter-rouge">-AuthenticationMethod Pap/Chap/MSChapv2/Eap/MachineCertificate</code> <br />
<code class="language-plaintext highlighter-rouge">-EncryptionLevel NoEncryption/Optional/Required/Maximum/Custom</code> <br />
<code class="language-plaintext highlighter-rouge">-SplitTunneling</code> –∑–∞–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ VPN-—Ç—É–Ω–Ω–µ–ª—å (–≤–∫–ª—é—á–µ–Ω–∏–µ Use default gateway on remote network –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ VPN –∞–¥–∞–ø—Ç–µ—Ä–∞) <br />
<code class="language-plaintext highlighter-rouge">-UseWinlogonCredential</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ VPN —Å–µ—Ä–≤–µ—Ä–µ <br />
<code class="language-plaintext highlighter-rouge">-RememberCredential</code> —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –∏ –ø–∞—Ä–æ–ª—å —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–∏—Å–ø–µ—Ç—á–µ—Ä —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö Windows –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è) <br />
<code class="language-plaintext highlighter-rouge">-DnsSuffix domain.local</code> <br />
<code class="language-plaintext highlighter-rouge">-AllUserConnection</code> —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª: C:\ProgramData\Microsoft\Network\Connections\Pbk\rasphone.pbk)</p>

<p><code class="language-plaintext highlighter-rouge">Install-Module -Name VPNCredentialsHelper</code> –º–æ–¥—É–ª—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–∏–Ω–∞ –∏ –ø–∞—Ä–æ–ª—è –≤ Windows Credential Manager –¥–ª—è VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Set-VpnConnectionUsernamePassword -connectionname vpn-failon -username user1 -password password</code></p>

<p><code class="language-plaintext highlighter-rouge">rasdial "vpn-failon"</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è <br />
<code class="language-plaintext highlighter-rouge">Get-VpnConnection -AllUserConnection | select *</code> —Å–ø–∏—Å–æ–∫ VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–∞–π—Å—Ç—Ä–æ–π–∫–∏ –∏ —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (ConnectionStatus) <br />
<code class="language-plaintext highlighter-rouge">Add-VpnConnectionRoute -ConnectionName vpn-failon -DestinationPrefix 192.168.3.0/24 ‚ÄìPassThru</code> –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –º–∞—Ä—à—Ä—É—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–µ–Ω –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ VPN <br />
<code class="language-plaintext highlighter-rouge">Remove-VpnConnection -Name vpn-failon -AllUserConnection -Force</code> —É–¥–∞–ª–∏—Ç—å</p>

<p><code class="language-plaintext highlighter-rouge">Set-VpnConnection -Name "vpn-failon" -SplitTunneling $True</code> –≤–∫–ª—é—á–∏—Ç—å —Ä–∞–∑–¥–µ–ª—å–Ω–æ–µ —Ç—É–Ω–µ–ª–ª–∏—Ä–æ–≤–∞–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">Add-VpnConnectionRoute -ConnectionName "vpn-failon" -DestinationPrefix 172.22.22.0/24</code> –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏ —á–µ—Ä–µ–∑ VPN-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">(Get-VpnConnection -ConnectionName "vpn-failon").routes</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">Remove-VpnConnectionRoute -ConnectionName "vpn-failon" -DestinationPrefix "172.22.23.0/24"</code></p>

<h1 id="proxy">Proxy</h1>

<p><code class="language-plaintext highlighter-rouge">$user = "lifailon"</code> <br />
<code class="language-plaintext highlighter-rouge">$pass = "Proxy"</code> <br />
<code class="language-plaintext highlighter-rouge">$SecureString = ConvertTo-SecureString $pass -AsPlainText -Force</code> <br />
<code class="language-plaintext highlighter-rouge">$Credential = New-Object System.Management.Automation.PSCredential($user, $SecureString)</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Net.Http.HttpClient]::DefaultProxy = New-Object System.Net.WebProxy("http://192.168.3.100:9090")</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Net.Http.HttpClient]::DefaultProxy.Credentials = [System.Net.CredentialCache]::DefaultCredentials</code> <br />
<code class="language-plaintext highlighter-rouge">[System.Net.Http.HttpClient]::DefaultProxy.Credentials = $Credential</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod http://ifconfig.me/ip</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://kinozal.tv/rss.xml</code></p>

<h1 id="netsh">netsh</h1>

<h3 id="proxy-1">Proxy</h3>

<p><code class="language-plaintext highlighter-rouge">netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=192.168.3.108</code> <br />
<code class="language-plaintext highlighter-rouge">netsh interface portproxy show all</code> <br />
<code class="language-plaintext highlighter-rouge">netsh interface portproxy delete v4tov4 listenport=8080 listenaddress=0.0.0.0</code></p>

<h3 id="wlan">Wlan</h3>

<p><code class="language-plaintext highlighter-rouge">netsh wlan show profile</code> —Å–ø–∏—Å–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã –ø—Ä–æ—Ñ–∏–ª–µ–π Wi-Fi –∏ –ø–∞—Ä–æ–ª–µ–π <br />
<code class="language-plaintext highlighter-rouge">netsh wlan show interfaces</code> —Ö–∞—Ä-–∫–∏ —Ç–µ–∫—É—â–µ–π —Å–µ—Ç–∏ (MAC, speed) <br />
<code class="language-plaintext highlighter-rouge">netsh wlan show profile SSID-Name-Network key=clear</code> –æ—á–∏—Å—Ç–∏—Ç—å –ø–∞—Ä–æ–ª—å <br />
<code class="language-plaintext highlighter-rouge">netsh wlan show networks</code> —Å–ø–∏—Å–æ–∫ –≤–∏–¥–µ–º—ã—Ö —Å–µ—Ç–µ–π <br />
<code class="language-plaintext highlighter-rouge">netsh wlan disconnect</code> –æ—Ç–∫–ª—é—á–∏—Ç—å—Å—è –æ—Ç Wi-Fi <br />
<code class="language-plaintext highlighter-rouge">netsh wlan connect name="SSID-Name-Network"</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è <br />
<code class="language-plaintext highlighter-rouge">netsh wlan show drivers</code> –¥—Ä–∞–π–≤–µ—Ä Wi-Fi <br />
<code class="language-plaintext highlighter-rouge">netsh wlan set hostednetwork mode=allow ssid="WiFi-Test" key="password"</code> —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ Wi-Fi (SoftAP)</p>

<h3 id="firewall-1">Firewall</h3>

<p><code class="language-plaintext highlighter-rouge">netsh advfirewall set allprofiles state off</code> –æ—Ç–∫–ª—é—á–∏—Ç—å fw <br />
<code class="language-plaintext highlighter-rouge">netsh advfirewall reset</code> —Å–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">netsh advfirewall firewall add rule name="Open Remote Desktop" protocol=TCP dir=in localport=3389 action=allow</code> –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç 3389 <br />
<code class="language-plaintext highlighter-rouge">netsh advfirewall firewall add rule name="All ICMP V4" dir=in action=allow protocol=icmpv4</code> –æ—Ç–∫—Ä—ã—Ç—å icmp</p>

<h1 id="openssh">OpenSSH</h1>

<p><code class="language-plaintext highlighter-rouge">Get-WindowsCapability -Online | ? Name -like 'OpenSSH.Client*'</code> <br />
<code class="language-plaintext highlighter-rouge">Add-WindowsCapability -Online -Name OpenSSH.Client*</code> <br />
<code class="language-plaintext highlighter-rouge">dism /Online /Add-Capability /CapabilityName:OpenSSH.Client~~~~0.0.1.0</code> <br />
<code class="language-plaintext highlighter-rouge">iwr https://github.com/PowerShell/Win32-OpenSSH/releases/download/v9.2.2.0p1-Beta/OpenSSH-Win64-v9.2.2.0.msi -OutFile $home\Downloads\OpenSSH-Win64-v9.2.2.0.msi</code> —Å–∫–∞—á–∞—Ç—å <br />
<code class="language-plaintext highlighter-rouge">msiexec /i $home\Downloads\OpenSSH-Win64-v9.2.2.0.msi</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å msi –ø–∞–∫–µ—Ç <br />
<code class="language-plaintext highlighter-rouge">Set-Service sshd -StartupType Automatic</code> <br />
<code class="language-plaintext highlighter-rouge">Get-NetTCPConnection | where LocalPort -eq 22</code> <br />
<code class="language-plaintext highlighter-rouge">New-NetFirewallRule -Name sshd -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22</code> <br />
<code class="language-plaintext highlighter-rouge">Get-NetFirewallRule -Name *ssh*</code> <br />
<code class="language-plaintext highlighter-rouge">Start-Process notepad++ C:\Programdata\ssh\sshd_config</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª <br />
<code class="language-plaintext highlighter-rouge">GSSAPIAuthentication yes</code> –≤–∫–ª—é—á–∏—Ç—å Kerberos –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (—á–µ—Ä–µ–∑ AD) <br />
<code class="language-plaintext highlighter-rouge">SyslogFacility LOCAL0</code> –≤–∫–ª—é—á–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ –≤ —Ñ–∞–π–ª (C:\ProgramData\ssh\logs\sshd.log) <br />
<code class="language-plaintext highlighter-rouge">LogLevel INFO</code> <br />
<code class="language-plaintext highlighter-rouge">Restart-Service sshd</code> <br />
<code class="language-plaintext highlighter-rouge">ssh -K $srv</code> –≤—ã–ø–æ–ª–Ω–∏—Ç—å Kerberos –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é <br />
<code class="language-plaintext highlighter-rouge">ssh Lifailon@192.168.3.99 -p 22</code> <br />
<code class="language-plaintext highlighter-rouge">pwsh -command Get-Service</code> <br />
<code class="language-plaintext highlighter-rouge">ssh -L 3101:192.168.3.101:22 -R 3101:192.168.3.101:22 lifailon@192.168.3.101 -p 22</code> SSH Tunnel lifailon@localhost:3101 -&gt; 192.168.3.101:3101</p>

<h1 id="winrm">WinRM</h1>

<p><code class="language-plaintext highlighter-rouge">Enter-PSSession -ComputerName $srv</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PowerShell —Å–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ PSRemoting. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ FQDN-–∏–º–µ–Ω–∏ <br />
<code class="language-plaintext highlighter-rouge">Invoke-Command $srv -ScriptBlock {Get-ComputerInfo}</code> –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ PSRemoting <br />
<code class="language-plaintext highlighter-rouge">$session = New-PSSession $srv</code> –æ—Ç–∫—Ä—ã—Ç—å —Å–µ—Å—Å–∏—é <br />
<code class="language-plaintext highlighter-rouge">Get-PSSession</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">icm -Session $session {$srv = $using:srv}</code> –ø–µ—Ä–µ–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ ($using) –≤ —É–¥–∞–ª–µ–Ω–Ω—É—é <br />
<code class="language-plaintext highlighter-rouge">Disconnect-PSSession $session</code> –∑–∞–∫—Ä—ã—Ç—å —Å–µ—Å—Å–∏—é <br />
<code class="language-plaintext highlighter-rouge">Remove-PSSession $session</code> —É–¥–∞–ª–∏—Ç—å —Å–µ—Å—Å–∏—é <br />
<code class="language-plaintext highlighter-rouge">Import-Module -Name ActiveDirectory -PSSession $srv</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å —Å —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ –ª–æ–∫–∞–ª—å–Ω—É—é —Å–µ—Å—Å–∏—é</p>

<h3 id="windows-remote-management-configuration">Windows Remote Management Configuration</h3>

<p><code class="language-plaintext highlighter-rouge">winrm quickconfig -quiet</code> –∏–∑–º–µ–Ω–∏—Ç –∑–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã WinRM –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π, –∑–∞–¥–∞—Å—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ WinRM –∏ –¥–æ–±–∞–≤–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –ø–æ—Ä—Ç–æ–≤ –≤ fw <br />
<code class="language-plaintext highlighter-rouge">Enable-PSRemoting ‚ÄìForce</code> –≤–∫–ª—é—á–∏—Ç—å PowerShell Remoting, —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ–º–µ–Ω–Ω–æ–≥–æ –∏ —á–∞—Å—Ç–Ω–æ–≥–æ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π Windows <br />
<code class="language-plaintext highlighter-rouge">Enable-PSRemoting -SkipNetworkProfileCheck -Force</code> –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ –æ–±—â–µ–π (public) —Å–µ—Ç–∏ (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤–µ—Ä—Å–∏–∏ powershell 6)</p>

<p><code class="language-plaintext highlighter-rouge">$NetProfiles = Get-NetConnectionProfile</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ —Å–µ—Ç–µ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">Set-NetConnectionProfile -InterfaceIndex $NetProfiles[1].InterfaceIndex -NetworkCategory Private</code> –∏–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø —Å–µ—Ç–∏ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è (DomainAuthenticated/Public) <br />
<code class="language-plaintext highlighter-rouge">(Get-CimInstance -ClassName Win32_ComputerSystem).PartOfDomain</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–æ–º–ø—å—é—Ç–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –¥–æ–º–µ–Ω AD <br />
<code class="language-plaintext highlighter-rouge">Get-Service WinRM | Set-Service -StartupType AutomaticDelayedStart</code> –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ <br />
<code class="language-plaintext highlighter-rouge">Get-Service -Name winrm -RequiredServices</code> —Å—Ç–∞—Ç—É—Å –∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–ª—É–∂–± <br />
<code class="language-plaintext highlighter-rouge">New-NetFirewallRule -Profile Any -DisplayName "WinRM HTTP" -Direction Inbound -Protocol TCP -LocalPort 5985,5986</code> <br />
<code class="language-plaintext highlighter-rouge">Test-NetConnection $srv -port 5895</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç <br />
<code class="language-plaintext highlighter-rouge">Test-WSMan $srv -ErrorAction Ignore</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É WinRM –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –æ—à–∏–±–æ–∫ –¥–ª—è —Å–∫—Ä–∏–ø—Ç–∞) –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ (localhost)</p>

<p><code class="language-plaintext highlighter-rouge">$Cert = New-SelfSignedCertificate -CertStoreLocation Cert:\LocalMachine\My -DnsName "$env:computername" -FriendlyName "WinRM HTTPS Certificate" -NotAfter (Get-Date).AddYears(5)</code> —Å–æ–∑–¥–∞—Ç—å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç <br />
<code class="language-plaintext highlighter-rouge">$Thumbprint = $Cert.Thumbprint</code> –∑–∞–±—Ä–∞—Ç—å –æ—Ç–ø–µ—á–∞—Ç–æ–∫ <br />
<code class="language-plaintext highlighter-rouge">New-Item -Path WSMan:\Localhost\Listener -Transport HTTPS -Address * -CertificateThumbprint $Thumbprint -Name WinRM_HTTPS_Listener -Force</code> —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å–ª—É—à–∏–≤–∞—Ç–µ–ª—å <br />
<code class="language-plaintext highlighter-rouge">New-NetFirewallRule -DisplayName 'WinRM HTTPS' -Profile Domain,Private -Direction Inbound -Action Allow -Protocol TCP -LocalPort 5986</code> –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç –≤ fw</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$selector_set = @{
    Address = "*"
    Transport = "HTTPS"
}
$value_set = @{
    CertificateThumbprint = "66ABFDA044D8C85135048186E2FDC0DBE6125163"
}
New-WSManInstance -ResourceURI "winrm/config/Listener" -SelectorSet $selector_set -ValueSet $value_set
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">winrm get winrm/config</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (Client/Service) <br />
<code class="language-plaintext highlighter-rouge">winrm get winrm/config/service/auth</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ <br />
<code class="language-plaintext highlighter-rouge">winrm enumerate winrm/config/listener</code> —Ç–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞—Ç–µ–ª–µ–π WinRM (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ—Ç–ø–µ—á–∞—Ç–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –¥–ª—è HTTPS 5986) <br />
<code class="language-plaintext highlighter-rouge">Get-ChildItem -Path Cert:\LocalMachine\My\ | where Thumbprint -eq D9356FB774EE0E6206B7D5B59B99102CA5B17BDA | select *</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ</p>

<p><code class="language-plaintext highlighter-rouge">ls WSMan:\localhost\Client</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∫–ª–∏–µ–Ω—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">ls WSMan:\localhost\Service</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">ls WSMan:\localhost\Service\auth</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ WinRM —Å–µ—Ä–≤–µ—Ä–∞ <br />
<code class="language-plaintext highlighter-rouge">Set-Item -path WSMan:\localhost\Service\auth\basic -value $true</code> —Ä–∞–∑—Ä–µ—à–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∫ —Ç–µ–∫—É—â–µ–º—É —Å–µ—Ä–≤–µ—Ä—É <br />
<code class="language-plaintext highlighter-rouge">ls HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\WSMAN</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ä–µ–µ—Å—Ç—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –∞—É–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ \Service\auth_basic = 1) <br />
<code class="language-plaintext highlighter-rouge">Set-Item WSMan:\localhost\Client\TrustedHosts -Value 192.168.* -Force</code> –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ö–æ—Å—Ç—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ, —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–∞ Negotiate –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ NTLM <br />
<code class="language-plaintext highlighter-rouge">Set-Item WSMan:\localhost\Client\TrustedHosts -Value 192.168.3.100 -Concatenate -Force</code> –¥–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä <br />
<code class="language-plaintext highlighter-rouge">ls WSMan:\localhost\Client\TrustedHosts</code> <br />
<code class="language-plaintext highlighter-rouge">Set-Item WSMan:\localhost\Client\AllowUnencrypted $true</code> –≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á–∞ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">Set-Item WSMan:\localhost\Service\AllowUnencrypted $true</code> –≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á–∞ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—ã—Ç—å –≤ private —Å–µ—Ç–∏)</p>

<p><code class="language-plaintext highlighter-rouge">Get-PSSessionConfiguration</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤–∫–ª—é—á–µ–Ω –ª–∏ PSremoting –∏ –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø, –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ WinRM <br />
<code class="language-plaintext highlighter-rouge">Set-PSSessionConfiguration -Name Microsoft.PowerShell -ShowSecurityDescriptorUI</code> –Ω–∞–∑–Ω–∞—á–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ (–¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∫–∏) <br />
<code class="language-plaintext highlighter-rouge">(Get-PSSessionConfiguration -Name "Microsoft.PowerShell").SecurityDescriptorSDDL</code> –ø–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ SDDL <br />
<code class="language-plaintext highlighter-rouge">Set-PSSessionConfiguration -Name Microsoft.PowerShell -SecurityDescriptorSDDL $SDDL</code> –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –Ω–∞ –¥—Ä—É–≥–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GUI \</p>

<p><code class="language-plaintext highlighter-rouge">New-LocalUser "WinRM-Writer" -Password (ConvertTo-SecureString -AsPlainText "123098")</code> —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">Add-LocalGroupMember -Group "Remote Management Users" -Member "WinRM-Writer"</code> –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è WinRM-Writer –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –≥—Ä—É–ø–ø—É –¥–æ—Å—Ç—É–ø–∞ ‚Äú–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è‚Äù <br />
<code class="language-plaintext highlighter-rouge">cmdkey /add:192.168.3.99 /user:WinRM-Writer /pass:123098</code> —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ CredentialManager
<code class="language-plaintext highlighter-rouge">cmdkey /list</code> <br />
<code class="language-plaintext highlighter-rouge">Import-Module CredentialManager</code> <br />
<code class="language-plaintext highlighter-rouge">Add-Type -AssemblyName System.Web</code> <br />
<code class="language-plaintext highlighter-rouge">New-StoredCredential -Target 192.168.3.99 -UserName WinRM-Writer -Password 123098 -Comment WinRM</code> —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ CredentialManager (–∏–∑ PS5) <br />
<code class="language-plaintext highlighter-rouge">Get-StoredCredential -AsCredentialObject</code> <br />
<code class="language-plaintext highlighter-rouge">$cred = Get-StoredCredential -Target 192.168.3.99</code> <br />
<code class="language-plaintext highlighter-rouge">Enter-PSSession -ComputerName 192.168.3.99 -Credential $cred -Authentication Negotiate</code> <br />
<code class="language-plaintext highlighter-rouge">Enter-PSSession -ComputerName 192.168.3.99 -Credential $cred -Authentication Basic -Port 5985</code> —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ allowunencrypted –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∫–ª–∏–µ–Ω—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">winrs -r:http://192.168.3.100:5985/wsman -u:WinRM-Writer -p:123098 ipconfig</code> –ø–µ—Ä–µ–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—É —á–µ—Ä–µ–∑ winrs (-?) <br />
<code class="language-plaintext highlighter-rouge">winrs -r:https://192.168.3.100:5985/wsman -u:WinRM-Writer -p:123098 -ssl ipconfig</code> —á–µ—Ä–µ–∑ https <br />
<code class="language-plaintext highlighter-rouge">pwsh -Command "Install-Module -Name PSWSMan"</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ Linux —Å–∏—Å—Ç–µ–º–µ</p>

<h3 id="kerberos">Kerberos</h3>

<p><code class="language-plaintext highlighter-rouge">.\CheckMaxTokenSize.ps1 -Principals login -OSEmulation $true -Details $true</code> —É–∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–æ–∫–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –¥–æ–º–µ–Ω–µ <br />
<code class="language-plaintext highlighter-rouge">Get-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Parameters | select maxtokensize</code> –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ <br />
<code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\HTTP\Parameters</code> –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä–∞, –µ—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø–∞–∫–µ—Ç–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 16 –ö–± (–∏–∑ –∑–∞ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª-–≤–∞ –≥—Ä—É–ø–ø) <br />
<code class="language-plaintext highlighter-rouge">MaxFieldLength —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 0000ffff (65535)</code> <br />
<code class="language-plaintext highlighter-rouge">MaxRequestBytes —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 0000ffff (65535)</code></p>

<h1 id="packagemanagement">PackageManagement</h1>

<p><code class="language-plaintext highlighter-rouge">Import-Module PackageManagement</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å <br />
<code class="language-plaintext highlighter-rouge">Get-Module PackageManagement</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥—É–ª–µ <br />
<code class="language-plaintext highlighter-rouge">Get-Command -Module PackageManagement</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –∫–æ–º–∞–Ω–¥–ª–µ—Ç—ã –º–æ–¥—É–ª—è <br />
<code class="language-plaintext highlighter-rouge">Get-Package</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã PowerShellGallery <br />
<code class="language-plaintext highlighter-rouge">Get-Package -ProviderName msi,Programs</code> —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º
<code class="language-plaintext highlighter-rouge">[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12</code> –≤–∫–ª—é—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª TLS 1.2 (–µ—Å–ª–∏ –Ω–µ –æ—Ç–∫–ª—é—á–µ–Ω—ã –ø—Ä–æ—Ç–æ–∫–æ–ª—ã TLS 1.0 –∏ 1.1) <br />
<code class="language-plaintext highlighter-rouge">Find-PackageProvider</code> –ø–æ–∏—Å–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Install-PackageProvider PSGallery -force</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ <br />
<code class="language-plaintext highlighter-rouge">Install-PackageProvider NuGet -force</code> <br />
<code class="language-plaintext highlighter-rouge">Install-PackageProvider Chocolatey -force</code> <br />
<code class="language-plaintext highlighter-rouge">Get-PackageSource</code> –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">Set-PackageSource -Name PSGallery -Trusted</code> –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é <br />
<code class="language-plaintext highlighter-rouge">Find-Package -Name *Veeam* -Source PSGallery</code> –ø–æ–∏—Å–∫ –ø–∞–∫–µ—Ç–æ–≤ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞ <br />
<code class="language-plaintext highlighter-rouge">Install-Package -Name VeeamLogParser -ProviderName PSGallery -scope CurrentUser</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Command *Veeam*</code> <br />
<code class="language-plaintext highlighter-rouge">Import-Module -Name VeeamLogParser</code> –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥—É–ª—å <br />
<code class="language-plaintext highlighter-rouge">Get-Module VeeamLogParser | select -ExpandProperty ExportedCommands</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π</p>

<h3 id="winget">winget</h3>

<p><a href="https://github.com/microsoft/winget-cli">Source</a>
<a href="https://winget.run">Web</a></p>

<p><code class="language-plaintext highlighter-rouge">winget list</code> —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">winget search VLC</code> –Ω–∞–π—Ç–∏ –ø–∞–∫–µ—Ç <br />
<code class="language-plaintext highlighter-rouge">winget show VideoLAN.VLC</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–∫–µ—Ç–µ <br />
<code class="language-plaintext highlighter-rouge">winget show VideoLAN.VLC --versions</code> —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–µ—Ä—Å–∏–π –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">winget install VideoLAN.VLC</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç <br />
<code class="language-plaintext highlighter-rouge">winget uninstall VideoLAN.VLC</code> —É–¥–∞–ª–∏—Ç—å –ø–∞–∫–µ—Ç <br />
<code class="language-plaintext highlighter-rouge">winget download jqlang.jq</code> –∑–∞–≥—Ä—É–∑–∫–∏—Ç—å –ø–∞–∫–µ—Ç (https://github.com/jqlang/jq/releases/download/jq-1.7/jq-windows-amd64.exe) <br />
<code class="language-plaintext highlighter-rouge">winget install jqlang.jq</code> –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ä–µ–¥—É –∏ –ø—Å–µ–≤–¥–æ–Ω–∏–º –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ jq <br />
<code class="language-plaintext highlighter-rouge">winget uninstall jqlang.jq</code></p>

<h3 id="jqlang-install">jqlang-install</h3>
<pre><code class="language-PowerShell">[uri]$url = $($(irm https://api.github.com/repos/jqlang/jq/releases/latest).assets.browser_download_url -match "windows-amd64").ToString() # –ø–æ–ª—É—á–∏—Ç—å –≤–µ—Ä—Å–∏—é latest –Ω–∞ GitHub
irm $url -OutFile "C:\Windows\System32\jq.exe" # –∑–∞–≥—Ä—É–∑–∏—Ç—å jq.exe
</code></pre>
<h3 id="scoop">Scoop</h3>

<p><code class="language-plaintext highlighter-rouge">Set-ExecutionPolicy RemoteSigned -Scope CurrentUser</code> <br />
<code class="language-plaintext highlighter-rouge">irm get.scoop.sh | iex</code> —É—Å—Ç–∞–Ω–æ–≤–∫–∞ <br />
<code class="language-plaintext highlighter-rouge">scoop help</code> <br />
<code class="language-plaintext highlighter-rouge">scoop search jq</code> <br />
<code class="language-plaintext highlighter-rouge">scoop info jq</code> <br />
<code class="language-plaintext highlighter-rouge">(scoop info jq).version</code> <br />
<code class="language-plaintext highlighter-rouge">scoop cat jq</code> <br />
<code class="language-plaintext highlighter-rouge">scoop download jq</code> C:\Users\lifailon\scoop\cache <br />
<code class="language-plaintext highlighter-rouge">scoop install jq</code> C:\Users\lifailon\scoop\apps\jq\1.7 <br />
<code class="language-plaintext highlighter-rouge">scoop list</code> <br />
<code class="language-plaintext highlighter-rouge">(scoop list).version</code> <br />
<code class="language-plaintext highlighter-rouge">scoop uninstall jq</code></p>

<h3 id="chocolatey">Chocolatey</h3>
<pre><code class="language-PowerShell">Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
</code></pre>
<p><code class="language-plaintext highlighter-rouge">choco -v</code> <br />
<code class="language-plaintext highlighter-rouge">choco -help</code> <br />
<code class="language-plaintext highlighter-rouge">choco list</code> <br />
<code class="language-plaintext highlighter-rouge">choco install adobereader</code></p>

<h1 id="nuget">NuGet</h1>

<p><code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://dist.nuget.org/win-x86-commandline/latest/nuget.exe -OutFile "$home\Documents\nuget.exe"</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-Expression "$home\Documents\nuget.exe search Selenium.WebDriver"</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-Expression "$home\Documents\nuget.exe install Selenium.WebDriver"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Item $home\Documents\*Selenium*</code></p>

<p><code class="language-plaintext highlighter-rouge">&amp; "$home\Documents\nuget.exe" list console-translate</code> <br />
<code class="language-plaintext highlighter-rouge">$nuget_api_key = "&lt;API-KEY&gt;"</code> <br />
<code class="language-plaintext highlighter-rouge">$source = "https://api.nuget.org/v3/index.json"</code> <br />
<code class="language-plaintext highlighter-rouge">$Name = "Console-Translate"</code> <br />
<code class="language-plaintext highlighter-rouge">$path = "$home\Documents\$Name"</code> <br />
<code class="language-plaintext highlighter-rouge">New-Item -Type Directory $path</code> <br />
<code class="language-plaintext highlighter-rouge">Copy-Item "$home\Documents\Git\$Name\$Name\0.2\*" "$path\"</code> <br />
<code class="language-plaintext highlighter-rouge">Copy-Item "$home\Documents\Git\$Name\LICENSE" "$path\"</code> <br />
<code class="language-plaintext highlighter-rouge">Copy-Item "$home\Documents\Git\$Name\README.md" "$path\"</code></p>
<pre><code class="language-PowerShell">'&lt;?xml version="1.0"?&gt;
&lt;package &gt;
  &lt;metadata&gt;
    &lt;id&gt;Console-Translate&lt;/id&gt;
    &lt;version&gt;0.2.2&lt;/version&gt;
    &lt;authors&gt;Lifailon&lt;/authors&gt;
    &lt;owners&gt;Lifailon&lt;/owners&gt;
    &lt;description&gt;Cross-platform client for translating text in the console, uses API Google (edded public free token), MyMemory and DeepLX (no token required)&lt;/description&gt;
    &lt;tags&gt;PowerShell, Module, Translate, api&lt;/tags&gt;
    &lt;projectUrl&gt;https://github.com/Lifailon/Console-Translate&lt;/projectUrl&gt;
    &lt;contentFiles&gt;
      &lt;files include="Console-Translate.psm1" buildAction="Content" /&gt;
      &lt;files include="Console-Translate.psd1" buildAction="Content" /&gt;
      &lt;files include="lang-iso-639-1.csv" buildAction="Content" /&gt;
      &lt;files include="README.md" buildAction="Content" /&gt;
      &lt;files include="LICENSE" buildAction="Content" /&gt;
    &lt;/contentFiles&gt;
  &lt;/metadata&gt;
&lt;/package&gt;' &gt; "$path\$Name.nuspec"
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Set-Location $path</code> <br />
<code class="language-plaintext highlighter-rouge">&amp; "$home\Documents\nuget.exe" pack "$path\$Name.nuspec"</code> <br />
<code class="language-plaintext highlighter-rouge">&amp; "$home\Documents\nuget.exe" push "$path\$Name.0.2.2.nupkg" -ApiKey $nuget_api_key -Source $source</code> <br />
<code class="language-plaintext highlighter-rouge">&amp; "$home\Documents\nuget.exe" push "$path\$Name.0.2.2.nupkg" -ApiKey $nuget_api_key -Source $source -SkipDuplicate</code></p>

<p><code class="language-plaintext highlighter-rouge">Install-Package Console-Translate -Source nuget.org</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Package Console-Translate | select *</code></p>

<p><code class="language-plaintext highlighter-rouge">Register-PSRepository -Name "NuGet" -SourceLocation "https://www.nuget.org/api/v2" -InstallationPolicy Trusted</code> <br />
<code class="language-plaintext highlighter-rouge">Get-PSRepository</code> <br />
<code class="language-plaintext highlighter-rouge">Find-Module -Name Console-Translate</code> <br />
<code class="language-plaintext highlighter-rouge">Install-Module Console-Translate -Repository NuGet</code></p>

<p><code class="language-plaintext highlighter-rouge">&amp; "$home\Documents\nuget.exe" delete Console-Translate 0.2.0 -Source https://api.nuget.org/v3/index.json -ApiKey $nuget_api_key -NoPrompt</code></p>

<h1 id="git">Git</h1>

<p><code class="language-plaintext highlighter-rouge">git --version</code> <br />
<code class="language-plaintext highlighter-rouge">git config --global user.name "Lifailon"</code> –¥–æ–±–∞–≤–∏—Ç—å –∏–º—è –¥–ª—è –∫–æ–º–º–∏—Ç–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">git config --global user.email "lifailon@yandex.ru"</code> <br />
<code class="language-plaintext highlighter-rouge">git config --global --edit</code> <br />
<code class="language-plaintext highlighter-rouge">ssh-keygen -t rsa -b 4096</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Service | where name -match "ssh-agent" | Set-Service -StartupType Automatic</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Service | where name -match "ssh-agent" | Start-Service</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Service | where name -match "ssh-agent" | select Name,Status,StartType</code> <br />
<code class="language-plaintext highlighter-rouge">ssh-agent</code> <br />
<code class="language-plaintext highlighter-rouge">ssh-add C:\Users\Lifailon\.ssh\id_rsa</code> <br />
<code class="language-plaintext highlighter-rouge">cat ~\.ssh\id_rsa.pub | Set-Clipboard</code> copy to <a href="https://github.com/settings/keys">settings keys</a> <br />
<code class="language-plaintext highlighter-rouge">cd $home\Documents\Git</code> <br />
<code class="language-plaintext highlighter-rouge">git clone git@github.com:Lifailon/lifailon.github.io</code> <br />
<code class="language-plaintext highlighter-rouge">cd lifailon.github.io</code> <br />
<code class="language-plaintext highlighter-rouge">git grep "ping ya.ru"</code> –ø–æ–∏—Å–∫ —Ç–µ–∫—Å—Ç–∞ –≤ —Ñ–∞–π–ª–∞—Ö <br />
<code class="language-plaintext highlighter-rouge">git fetch</code> –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –≤–µ—Ç–æ–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—è —Ç–µ–∫—É—â—É—é —Ä–∞–±–æ—á—É—é –≤–µ—Ç–∫—É (–∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –∫–æ–º–º–∏—Ç—ã, –≤–µ—Ç–∫–∏ –∏ —Ç.–¥. –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏) <br />
<code class="language-plaintext highlighter-rouge">git pull</code> –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–≤—ã–ø–æ–ª–Ω—è–µ—Ç git fetch –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å –ª–æ–∫–∞–ª—å–Ω—ã–º –∏ git merge –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Ä–∞–±–æ—á–µ–π –≤–µ—Ç–∫–∏) <br />
<code class="language-plaintext highlighter-rouge">git status</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ —Ñ–∞–π–ª–∞–º <br />
<code class="language-plaintext highlighter-rouge">git diff</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ—Å—Ç—Ä–æ—á–Ω–æ <br />
<code class="language-plaintext highlighter-rouge">git diff pandoc</code> —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–µ–∫—É—â–µ–π —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º –∫–æ–º–º–∏—Ç–æ–º –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –≤–µ—Ç–∫–µ <br />
<code class="language-plaintext highlighter-rouge">git add .</code> –¥–æ–±–∞–≤–∏—Ç—å (–ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å) –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö —Ç–µ–∫—É—â–µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞ <br />
<code class="language-plaintext highlighter-rouge">git commit -m "update powershell commands"</code> —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º <br />
<code class="language-plaintext highlighter-rouge">git push</code> —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ <br />
<code class="language-plaintext highlighter-rouge">git branch hugo</code> —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É <br />
<code class="language-plaintext highlighter-rouge">git branch -m hugo-public</code> –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ç–∫—É <br />
<code class="language-plaintext highlighter-rouge">git branch -d hugo-public</code> —É–¥–∞–ª–∏—Ç—å –≤–µ—Ç–∫—É <br />
<code class="language-plaintext highlighter-rouge">git switch hugo</code> –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥—É—é –≤–µ—Ç–∫—É <br />
<code class="language-plaintext highlighter-rouge">git push origin hugo</code> –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –≤–µ—Ç–∫—É <br />
<code class="language-plaintext highlighter-rouge">git push --set-upstream origin hugo</code> –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–µ—Ç–∫–µ (–ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å push –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –≤–µ—Ç–∫–∏) <br />
<code class="language-plaintext highlighter-rouge">git merge hugo</code> —Å–ª–∏—è–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏ (pandoc) —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π (hugo) <br />
<code class="language-plaintext highlighter-rouge">git log --oneline --all</code> –ª–æ–≥ –∫–æ–º–º–∏—Ç–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">git log --graph</code> –∫–æ–º–º–∏—Ç—ã –∏ —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–µ—Ç–æ–∫ <br />
<code class="language-plaintext highlighter-rouge">git log --author="Lifailon"</code> –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–º–∏—Ç–æ–≤ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code class="language-plaintext highlighter-rouge">git blame index.html</code> –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ –≤–Ω–µ—Å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ <br />
<code class="language-plaintext highlighter-rouge">git show d01f09dead3a6a8d75dda848162831c58ca0ee13</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –ª–æ–≥ –ø–æ –Ω–æ–º–µ—Ä—É –∫–æ–º–º–∏—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">git restore filename</code> –æ—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–∞–±–æ—á–µ–π –∫–æ–ø–∏–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –±—ã–ª–∏ –æ–Ω–∏ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –∏–ª–∏ –Ω–µ—Ç (–µ—Å–ª–∏ –±—ã–ª–∞ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —á–µ—Ä–µ–∑ add), –≤–æ–∑–≤—Ä–∞—â–∞—è –µ–≥–æ –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–º–∏—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">git restore --source d01f09dead3a6a8d75dda848162831c58ca0ee13 filename</code> –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –ø–æ —Ö—ç—à—É –∏–Ω–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –∫–æ–º–º–∏—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">git checkout filename</code> –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–ª—è –∫–æ–º–º–∏—Ç–∞, –≤–æ–∑–≤—Ä–∞—â–∞—è –µ–≥–æ –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é, –∫–∞–∫–∏–º –æ–Ω–æ –±—ã–ª–æ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–º–∏—Ç–∞ (–µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ add) <br />
<code class="language-plaintext highlighter-rouge">git checkout d01f09dead3a6a8d75dda848162831c58ca0ee13</code> –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã —Ä–∞–±–æ—á–µ–π –∫–æ–ø–∏–∏ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–æ–º–º–∏—Ç (–ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç HEAD –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–æ–º–º–∏—Ç) <br />
<code class="language-plaintext highlighter-rouge">git reset HEAD filename</code> —É–¥–∞–ª–∏—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –∏–∑ –∏–Ω–¥–µ–∫—Å–∞ –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è —Å–∞–º–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ñ–∞–π–ª–µ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ (–µ—Å–ª–∏ –±—ã–ª add –Ω–æ –Ω–µ –±—ã–ª–æ commit, –ø–æ—Ç–æ–º –≤—ã–ø–æ–ª–Ω–∏—Ç—å checkout) <br />
<code class="language-plaintext highlighter-rouge">git reset --soft HEAD^</code> –æ—Ç–º–µ–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π (^) –∫–æ–º–º–∏—Ç, —Å–æ—Ö—Ä–∞–Ω—è—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ —ç—Ç–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ –≤ —Ä–∞–±–æ—á–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ –∏ –∏–Ω–¥–µ–∫—Å–µ (–ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏), –º–æ–∂–Ω–æ –≤–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª—ã –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Ö –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å <br />
<code class="language-plaintext highlighter-rouge">git reset --hard HEAD^</code> –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–º–µ–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç, —É–¥–∞–ª—è—è –≤—Å–µ –µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ —Ä–∞–±–æ—á–µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞ –∏ –∏–Ω–¥–µ–∫—Å–∞ –¥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–º–∏—Ç–∞ <br />
<code class="language-plaintext highlighter-rouge">git reset --hard d01f09dead3a6a8d75dda848162831c58ca0ee13</code> –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç HEAD –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∫–æ–º–º–∏—Ç—É –∏ —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –∫–æ–º–º–∏—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —Å–¥–µ–ª–∞–Ω—ã –ø–æ—Å–ª–µ –Ω–µ–≥–æ (–±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã –≤—Å–µ –Ω–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–º–∏—Ç–æ–≤ –ø–æ—Å–ª–µ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ) <br />
<code class="language-plaintext highlighter-rouge">git revert HEAD --no-edit</code> —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –∫–æ–º–º–∏—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–º–µ–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç (HEAD) –∏ –Ω–æ–≤—ã–π –∫–æ–º–º–∏—Ç –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–≤–µ—Ä—Ö –Ω–µ–≥–æ (—Å–æ–±—ã—Ç–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ git log) <br />
<code class="language-plaintext highlighter-rouge">git revert d01f09dead3a6a8d75dda848162831c58ca0ee13</code> —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –∫–æ–º–º–∏—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è, –≤–Ω–µ—Å–µ–Ω–Ω—ã–µ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–æ–º–º–∏—Ç —Å —Ö–µ—à–µ–º (–Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–º–∏—Ç–æ–≤, –∞ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –∫–æ–º–º–∏—Ç —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –æ—Ç–º–µ–Ω—ã) <br />
<code class="language-plaintext highlighter-rouge">git stash</code> —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—É—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—ç—à (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ) –∏ –æ—á–∏—â–∞–µ—Ç —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é <br />
<code class="language-plaintext highlighter-rouge">git stash pop</code> –ø—Ä–∏–º–µ–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ —Å—Ç—ç—à–∞ –∫ —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–µ</p>

<h1 id="github">GitHub</h1>

<p><code class="language-plaintext highlighter-rouge">$user = "Lifailon"</code> <br />
<code class="language-plaintext highlighter-rouge">$repository = "ReverseProxyNET"</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.github.com/users/$($user)</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.github.com/users/$($user)/repos</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.github.com/repos/$($user)/$($repository)/contents</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.github.com/repos/$($user)/$($repository)/contents/source/rpnet.cs</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.github.com/repos/$($user)/$($repository)/commits</code> <br />
<code class="language-plaintext highlighter-rouge">$sha = $(Invoke-RestMethod https://api.github.com/repos/$($user)/$($repository)/commits).sha</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.github.com/repos/$($user)/$($repository)/commits/$($sha[-1])</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod "https://api.github.com/repos/$($user)/$($repository)/releases/latest"</code> <br />
<code class="language-plaintext highlighter-rouge">$(Invoke-RestMethod "https://api.github.com/repos/$($user)/$($repository)/releases/latest").assets.name</code> <br />
<code class="language-plaintext highlighter-rouge">$issues = Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/issues</code> <br />
<code class="language-plaintext highlighter-rouge">$issue_number = $($issues | Where-Object title -match "PowerShell").number</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/issues/$($issue_number)/comments</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/pulls</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/languages</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/stargazers</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/forks</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.github.com/repos/LibreHardwareMonitor/LibreHardwareMonitor/subscribers</code></p>

<h1 id="dsc">DSC</h1>

<p><code class="language-plaintext highlighter-rouge">Import-Module PSDesiredStateConfiguration</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Command -Module PSDesiredStateConfiguration</code> <br />
<code class="language-plaintext highlighter-rouge">(Get-Module PSDesiredStateConfiguration).ExportedCommands</code> <br />
<code class="language-plaintext highlighter-rouge">Get-DscLocalConfigurationManager</code></p>

<p><code class="language-plaintext highlighter-rouge">Get-DscResource</code> <br />
<code class="language-plaintext highlighter-rouge">Get-DscResource -Name File -Syntax</code> <a href="https://learn.microsoft.com/ru-ru/powershell/dsc/reference/resources/windows/fileresource?view=dsc-1.1">—Å–∏–Ω—Ç–∞–∫—Å–∏—Å</a></p>

<p><code class="language-plaintext highlighter-rouge">Ensure = Present</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω–∞ (–∫–∞—Ç–∞–ª–æ–≥ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å, –ø—Ä–æ—Ü–µ—Å—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω, –µ—Å–ª–∏ –Ω–µ—Ç ‚Äì —Å–æ–∑–¥–∞—Ç—å, –∑–∞–ø—É—Å—Ç–∏—Ç—å) <br />
<code class="language-plaintext highlighter-rouge">Ensure = Absent</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã–∫–ª—é—á–µ–Ω–∞ (–∫–∞—Ç–∞–ª–æ–≥–∞ –±—ã—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ, –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω, –µ—Å–ª–∏ –Ω–µ—Ç ‚Äì —É–¥–∞–ª–∏—Ç—å, –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å)</p>
<pre><code class="language-PowerShell">Configuration TestConfiguraion
{
    Ctrl+Space
}

Configuration DSConfigurationProxy 
{
    Node vproxy-01 
    {
        File CreateDir
        {
            Ensure = "Present"
            Type = "Directory"
            DestinationPath = "C:\Temp"
        }
        Service StopW32time
        {
            Name = "w32time"
            State = "Stopped"` Running
        }
		WindowsProcess RunCalc
        {
            Ensure = "Present"
            Path = "C:\WINDOWS\system32\calc.exe"
            Arguments = ""
        }
        Registry RegSettings
        {
            Ensure = "Present"
            Key = "HKEY_LOCAL_MACHINE\SOFTWARE\MySoft"
            ValueName = "TestName"
            ValueData = "TestValue"
            ValueType = "String"
        }
#		WindowsFeature IIS
#       {
#            Ensure = "Present"
#            Name = "Web-Server"
#       }
    }
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">$Path = (DSConfigurationProxy).DirectoryName</code> <br />
<code class="language-plaintext highlighter-rouge">Test-DscConfiguration -Path $Path | select *</code> ResourcesInDesiredState - —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ, ResourcesNotInDesiredState - –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ (–Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç) <br />
<code class="language-plaintext highlighter-rouge">Start-DscConfiguration -Path $Path</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Job</code> <br />
<code class="language-plaintext highlighter-rouge">$srv = "vproxy-01"</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Service -ComputerName $srv | ? name -match w32time # Start-Service</code> <br />
<code class="language-plaintext highlighter-rouge">icm $srv {Get-Process | ? ProcessName -match calc} | ft # Stop-Process -Force</code> <br />
<code class="language-plaintext highlighter-rouge">icm $srv {ls C:\ | ? name -match Temp} | ft</code> rm`</p>
<pre><code class="language-PowerShell">Configuration InstallPowerShellCore {
    Import-DscResource -ModuleName PSDesiredStateConfiguration
    Node localhost {
        Script InstallPowerShellCore {
            GetScript = {
                return @{
                    GetScript = $GetScript
                }
            }
            SetScript = {
				[string]$url = $(Invoke-RestMethod https://api.github.com/repos/PowerShell/PowerShell/releases/latest).assets.browser_download_url -match "win-x64.zip"
                $downloadPath = "$home\Downloads\PowerShell.zip"
                $installPath = "$env:ProgramFiles\PowerShell\7"
                Invoke-WebRequest -Uri $url -OutFile $downloadPath
                Expand-Archive -Path $downloadPath -DestinationPath $installPath -Force
            }
            TestScript = {
                return Test-Path "$env:ProgramFiles\PowerShell\7\pwsh.exe"
            }
        }
    }
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">$Path = (InstallPowerShellCore).DirectoryName</code> <br />
<code class="language-plaintext highlighter-rouge">Test-DscConfiguration -Path $Path</code> <br />
<code class="language-plaintext highlighter-rouge">Start-DscConfiguration -Path $path -Wait -Verbose</code> <br />
<code class="language-plaintext highlighter-rouge">Get-Job</code></p>

<h1 id="ansible">Ansible</h1>

<p><code class="language-plaintext highlighter-rouge">apt -y update &amp;&amp; apt -y upgrade</code> <br />
<code class="language-plaintext highlighter-rouge">apt -y install ansible</code> v2.10.8 <br />
<code class="language-plaintext highlighter-rouge">apt -y install ansible-core</code> v2.12.0 <br />
<code class="language-plaintext highlighter-rouge">apt -y install sshpass</code></p>

<p><code class="language-plaintext highlighter-rouge">ansible-galaxy collection install ansible.windows</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é –º–æ–¥—É–ª–µ–π <br />
<code class="language-plaintext highlighter-rouge">ansible-galaxy collection install community.windows</code> <br />
<code class="language-plaintext highlighter-rouge">ansible-galaxy collection list | grep windows</code> <br />
<code class="language-plaintext highlighter-rouge">ansible-config dump | grep DEFAULT_MODULE_PATH</code> –ø—É—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥—É–ª–µ–π</p>

<p><code class="language-plaintext highlighter-rouge">apt-get -y install python-dev libkrb5-dev krb5-user</code> –ø–∞–∫–µ—Ç—ã –¥–ª—è Kerberos –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">apt install python3-pip</code> <br />
<code class="language-plaintext highlighter-rouge">pip3 install requests-kerberos</code> <br />
<code class="language-plaintext highlighter-rouge">nano /etc/krb5.conf</code> –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å [realms] –∏ [domain_realm] <br />
<code class="language-plaintext highlighter-rouge">kinit -C support4@domail.local</code> <br />
<code class="language-plaintext highlighter-rouge">klist</code></p>

<p><code class="language-plaintext highlighter-rouge">ansible --version</code> <br />
<code class="language-plaintext highlighter-rouge">config file = None</code> <br />
<code class="language-plaintext highlighter-rouge">nano /etc/ansible/ansible.cfg</code> —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[defaults]
inventory = /etc/ansible/hosts
# uncomment this to disable SSH key host checking
# –û—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∫–ª—é—á–∞ ssh (–¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—è –ø–∞—Ä–æ–ª—å)
host_key_checking = False
</code></pre></div></div>
<h3 id="hosts">Hosts</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/hosts</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[us]
pi-hole-01 ansible_host=192.168.3.101
zabbix-01 ansible_host=192.168.3.102
grafana-01 ansible_host=192.168.3.103
netbox-01 ansible_host=192.168.3.104

[all:vars]
ansible_ssh_port=2121
ansible_user=lifailon
ansible_password=123098
path_user=/home/lifailon
ansible_python_interpreter=/usr/bin/python3

[ws]
huawei-book-01 ansible_host=192.168.3.99
plex-01 ansible_host=192.168.3.100

[ws:vars]
ansible_port=5985
#ansible_port=5986
ansible_user=Lifailon
#ansible_user=support4@DOMAIN.LOCAL
ansible_password=123098
ansible_connection=winrm
ansible_winrm_scheme=http
ansible_winrm_transport=basic
#ansible_winrm_transport=kerberos
ansible_winrm_server_cert_validation=ignore
validate_certs=false

[win_ssh]
huawei-book-01 ansible_host=192.168.3.99
plex-01 ansible_host=192.168.3.100

[win_ssh:vars]
ansible_python_interpreter=C:\Users\Lifailon\AppData\Local\Programs\Python\Python311\` –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ä–µ–¥—ã –∏–Ω—Ç–µ—Ä–ø—Ä–∏—Ç–∞—Ç–æ—Ä–∞ Python –≤ Windows
ansible_connection=ssh
#ansible_shell_type=cmd
ansible_shell_type=powershell
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-inventory --list</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (—á–∏—Ç–∞–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON) –∏–ª–∏ YAML (-y) —Å –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º –≤—Å–µ –ø—Ä–∏–º–µ–Ω—è–µ–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</p>

<h1 id="win_modules">Win_Modules</h1>

<p><code class="language-plaintext highlighter-rouge">ansible us -m ping</code> <br />
<code class="language-plaintext highlighter-rouge">ansible win_ssh -m ping</code> <br />
<code class="language-plaintext highlighter-rouge">ansible us -m shell -a "uptime &amp;&amp; df -h | grep lv"</code> <br />
<code class="language-plaintext highlighter-rouge">ansible us -m setup | grep -iP "mem|proc"</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∂–µ–ª–µ–∑–µ <br />
<code class="language-plaintext highlighter-rouge">ansible us -m apt -a "name=mc" -b</code> –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ sudo (-b) <br />
<code class="language-plaintext highlighter-rouge">ansible us -m service -a "name=ssh state=restarted enabled=yes" -b</code> –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É <br />
<code class="language-plaintext highlighter-rouge">echo "echo test" &gt; test.sh</code> <br />
<code class="language-plaintext highlighter-rouge">ansible us -m copy -a "src=test.sh dest=/root mode=777" -b</code> <br />
<code class="language-plaintext highlighter-rouge">ansible us -a "ls /root" -b</code> <br />
<code class="language-plaintext highlighter-rouge">ansible us -a "cat /root/test.sh" -b</code></p>

<p><code class="language-plaintext highlighter-rouge">ansible-doc -l | grep win_</code> <a href="https://docs.ansible.com/ansible/latest/collections/ansible/windows/">—Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π Windows</a> <br />
<code class="language-plaintext highlighter-rouge">ansible ws -m win_ping</code> windows –º–æ–¥—É–ª—å <br />
<code class="language-plaintext highlighter-rouge">ansible ws -m win_ping -u WinRM-Writer</code> —É–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏–Ω <br />
<code class="language-plaintext highlighter-rouge">ansible ws -m setup</code> —Å–æ–±—Ä–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∏—Å—Ç–µ–º–µ <br />
<code class="language-plaintext highlighter-rouge">ansible ws -m win_whoami</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∞–≤–∞—Ö –¥–æ—Å—Ç—É–ø–∞—Ö, –≥—Ä—É–ø–ø–∞—Ö –¥–æ—Å—Ç—É–ø–∞ <br />
<code class="language-plaintext highlighter-rouge">ansible ws -m win_shell -a '$PSVersionTable'</code> <br />
<code class="language-plaintext highlighter-rouge">ansible ws -m win_shell -a 'Get-Service | where name -match "ssh|winrm"'</code> <br />
<code class="language-plaintext highlighter-rouge">ansible ws -m win_service -a "name=sshd state=stopped"</code> <br />
<code class="language-plaintext highlighter-rouge">ansible ws -m win_service -a "name=sshd state=started"</code></p>

<h3 id="win_shell-varsdebug">win_shell (vars/debug)</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/PowerShell-Vars.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
 ` –£–∫–∞–∑–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é –º–æ–¥—É–ª–µ–π
  collections:
  - ansible.windows
 ` –ó–∞–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
  vars:
    SearchName: PermitRoot
  tasks:
  - name: Get port ssh
    win_shell: |
      Get-Content "C:\Programdata\ssh\sshd_config" | Select-String ""
   ` –ü–µ—Ä–µ–¥–∞—Ç—å –≤—ã–≤–æ–¥ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
    register: command_output
  - name: Output port ssh
   ` –í—ã–≤–µ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –Ω–∞ —ç–∫—Ä–∞–Ω
    debug:
      var: command_output.stdout_lines
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/PowerShell-Vars.yml</code> <br />
<code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/PowerShell-Vars.yml --extra-vars "SearchName='LogLevel|Syslog'"</code> –ø–µ—Ä–µ–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é</p>

<h3 id="win_powershell">win_powershell</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/powershell-param.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Run PowerShell script with parameters
    ansible.windows.win_powershell:
      parameters:
        Path: C:\Temp
        Force: true
      script: |
        [CmdletBinding()]
        param (
          [String]$Path,
          [Switch]$Force
        )
        New-Item -Path $Path -ItemType Directory -Force:$Force
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/powershell-param.yml</code></p>

<h3 id="win_chocolatey">win_chocolatey</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/setup-adobe-acrobat.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Install Acrobat Reader
    win_chocolatey:
      name: adobereader
      state: present
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/setup-adobe-acrobat.yml</code></p>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/setup-openssh.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: install the Win32-OpenSSH service
    win_chocolatey:
      name: openssh
      package_params: /SSHServerFeature
      state: present
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/setup-openssh.yml</code></p>

<h3 id="win_regedit">win_regedit</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/win-set-shell-ssh-ps7.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Set the default shell to PowerShell 7 for Windows OpenSSH
    win_regedit:
      path: HKLM:\SOFTWARE\OpenSSH
      name: DefaultShell
     ` data: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
      data: 'C:\Program Files\PowerShell\7\pwsh.exe'
      type: string
      state: present
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/win-set-shell-ssh-ps7.yml</code></p>

<h3 id="win_service">win_service</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/win-service.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Start service
    win_service:
      name: sshd
      state: started
#     state: stopped
#     state: restarted
#     start_mode: auto
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/win-service.yml</code></p>

<h3 id="win_service_info">win_service_info</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/get-service.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Get info for a single service
    win_service_info:
      name: sshd
    register: service_info
  - name: Print returned information
    ansible.builtin.debug:
      var: service_info.services
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/get-service.yml</code></p>

<h3 id="fetchslurp">fetch/slurp</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/copy-from-win-to-local.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Retrieve remote file on a Windows host
#   –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –∏–∑ Windows-—Å–∏—Å—Ç–µ–º—ã
    ansible.builtin.fetch:
#   –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª (–ø–µ—Ä–µ–¥–∞—Ç—å –≤ –ø–∞–º—è—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ Base64)
#   ansible.builtin.slurp:
      src: C:\Telegraf\telegraf.conf
      dest: /root/telegraf.conf
      flat: yes
    register: telegraf_conf
  - name: Print returned information
    ansible.builtin.debug:
      msg: ""
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/copy-from-win-to-local.yml</code></p>

<h3 id="win_copy">win_copy</h3>

<p><code class="language-plaintext highlighter-rouge">echo "Get-Service | where name -eq vss | Start-Service" &gt; /home/lifailon/Start-Service-VSS.ps1</code> <br />
<code class="language-plaintext highlighter-rouge">nano /etc/ansible/copy-file-to-win.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Copy file to win hosts
    win_copy:
      src: /home/lifailon/Start-Service-VSS.ps1
      dest: C:\Users\Lifailon\Desktop\Start-Service-VSS.ps1
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/copy-file-to-win.yml</code></p>

<p><code class="language-plaintext highlighter-rouge">curl -OL https://github.com/PowerShell/PowerShell/releases/download/v7.3.6/PowerShell-7.3.6-win-x64.msi</code> <br />
<code class="language-plaintext highlighter-rouge">nano /etc/ansible/copy-file-to-win.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Copy file to win hosts
    win_copy:
      src: /home/lifailon/PowerShell-7.3.6-win-x64.msi
      dest: C:\Install\PowerShell-7.3.6.msi
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/copy-file-to-win.yml</code></p>

<h3 id="win_command">win_command</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/run-script-ps1.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Run PowerShell Script
    win_command: powershell -ExecutionPolicy ByPass -File C:\Users\Lifailon\Desktop\Start-Service-VSS.ps1
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/run-script-ps1.yml</code></p>

<h3 id="win_package">win_package</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/setup-msi-package.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Install MSI Package
    win_package:
#     path: C:\Install\7z-23.01.msi
      path: C:\Install\PowerShell-7.3.6.msi
      arguments:
        - /quiet
        - /passive
        - /norestart
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/setup-msi-package.yml</code></p>

<h3 id="win_firewall_rule">win_firewall_rule</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/win-fw-open.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Open RDP port
    win_firewall_rule:
      name: Open RDP port
      localport: 3389
      action: allow
      direction: in
      protocol: tcp
      state: present
      enabled: yes
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/win-fw-open.yml</code></p>

<h3 id="win_group">win_group</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/win-creat-group.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Create a new group
    win_group:
      name: deploy
      description: Deploy Group
      state: present
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/win-creat-group.yml</code></p>

<h3 id="win_group_membership">win_group_membership</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/add-user-to-group.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Add a local and domain user to a local group
    win_group_membership:
      name: deploy
      members:
        - WinRM-Writer
      state: present
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/add-user-to-group.yml</code></p>

<h3 id="win_user">win_user</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/creat-win-user.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Creat user
    win_user:
      name: test
      password: 123098
      state: present
      groups:
        - deploy
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/creat-win-user.yml</code></p>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/delete-win-user.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Delete user
    ansible.windows.win_user:
      name: test
      state: absent
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/delete-win-user.yml</code></p>

<h3 id="win_feature">win_feature</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/install-feature.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Install Windows Feature
      win_feature:
        name: SNMP-Service
        state: present
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/install-feature.yml</code></p>

<h3 id="win_reboot">win_reboot</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/win-reboot.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Reboot a slow machine that might have lots of updates to apply
    win_reboot:
      reboot_timeout: 3600
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/win-reboot.yml</code></p>

<h3 id="win_find">win_find</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/win-ls.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Find files in multiple paths
    ansible.windows.win_find:
      paths:
      - D:\Install\OpenSource
      patterns: ['*.rar','*.zip','*.msi']
     ` –§–∞–π–ª —Å–æ–∑–¥–∞–Ω–Ω—ã–π –º–µ–Ω–µ–µ 7 –¥–Ω–µ–π –Ω–∞–∑–∞–¥
      age: -7d
     ` –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –±–æ–ª—å—à–µ 10MB
      size: 10485760
     ` –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ (–≤ –¥–æ—á–µ—Ä–Ω–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö)
      recurse: true
    register: command_output
  - name: Output
    debug:
      var: command_output
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/win-ls.yml</code></p>

<h3 id="win_uri">win_uri</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/rest-get.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: REST GET request to endpoint github
    ansible.windows.win_uri:
      url: https://api.github.com/repos/Lifailon/pSyslog/releases/latest
    register: http_output
  - name: Output
    debug:
      var: http_output
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/rest-get.yml</code></p>

<h3 id="win_updates">win_updates</h3>

<p><code class="language-plaintext highlighter-rouge">nano /etc/ansible/win-update.yml</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- hosts: ws
  tasks:
  - name: Install only particular updates based on the KB numbers
    ansible.windows.win_updates:
      category_names:
      - SecurityUpdates
      - CriticalUpdates
      - UpdateRollups
      - Drivers
     ` –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
     ` accept_list:
     ` - KB2267602
     ` –ü–æ–∏—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
     ` state: searched
     ` –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
     ` state: downloaded
     ` –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
      state: installed
      log_path: C:\Ansible-Windows-Upadte-Log.txt
      reboot: false
    register: wu_output
  - name: Output
    debug:
      var: wu_output
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">ansible-playbook /etc/ansible/win-update.yml</code></p>

<h3 id="win_chocolatey-1">win_chocolatey</h3>

<p><a href="https://chocolatey.org/install">Install</a> <br />
<a href="https://community.chocolatey.org/api/v2/package/chocolatey">API</a> <br />
<a href="https://docs.chocolatey.org/en-us/guides/organizations/organizational-deployment-guide">Deployment</a></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- name: Ensure Chocolatey installed from internal repo
  win_chocolatey:
    name: chocolatey
    state: present
	# source: URL-–∞–¥—Ä–µ—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
    source: https://community.chocolatey.org/api/v2/ChocolateyInstall.ps1
</code></pre></div></div>
<h1 id="gigachat">GigaChat</h1>

<p><a href="https://developers.sber.ru/gigachat/login">Developers chat</a></p>

<h3 id="1-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤">1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤:</h3>

<p><code class="language-plaintext highlighter-rouge">Invoke-WebRequest "https://gu-st.ru/content/lending/russian_trusted_root_ca_pem.crt" -OutFile "$home\Downloads\russian_trusted_root_ca.cer"</code> —Å–∫–∞—á–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –º–∏–Ω—Ü–∏—Ñ—Ä—ã <br />
<code class="language-plaintext highlighter-rouge">Invoke-WebRequest "https://gu-st.ru/content/lending/russian_trusted_sub_ca_pem.crt" -OutFile "$home\Downloads\russian_trusted_sub_ca.cer"</code> <br />
<code class="language-plaintext highlighter-rouge">Import-Certificate -FilePath "$home\Downloads\russian_trusted_root_ca.cer" -CertStoreLocation "Cert:\CurrentUser\Root"</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –º–∏–Ω—Ü–∏—Ñ—Ä—ã <br />
<code class="language-plaintext highlighter-rouge">Import-Certificate -FilePath "$home\Downloads\russian_trusted_sub_ca.cer" -CertStoreLocation "Cert:\CurrentUser\CA"</code></p>

<h3 id="2-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è-–ø–æ-sber-id-–∏-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è-–Ω–æ–≤—ã—Ö-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö-–¥–ª—è-–ø–æ–ª—É—á–µ–Ω–∏—è-—Ç–æ–∫–µ–Ω–∞-developers-–≤—Ä–µ–º—è-–∂–∏–∑–Ω–∏-30-–º–∏–Ω—É—Ç">2. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ Sber ID –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞: <a href="https://developers.sber.ru/studio">Developers</a> (–≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ 30 –º–∏–Ω—É—Ç)</h3>

<h3 id="3-—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö-–≤-—Ñ–æ—Ä–º–∞—Ç–µ-base64-–∏–∑-client-id-–∏-client-secret">3. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ Base64 –∏–∑ Client ID –∏ Client Secret:</h3>
<pre><code class="language-PowerShell">$Client_ID     = "7e6d2f9f-825e-49b7-98f4-62fbb7506427" # [System.Guid]::Parse("7e6d2f9f-825e-49b7-98f4-62fbb7506427")
$Client_Secret = "c35113ee-6757-47ba-9853-ea1d0d9db1ef" # [System.Guid]::Parse("c35113ee-6757-47ba-9853-ea1d0d9db1ef")
$Client_Join   = $Client_ID+":"+$Client_Secret # –æ–±—ä–µ–¥–∏–Ω—è–µ–º –¥–≤–∞ UUID –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É, —Ä–∞–∑–¥–µ–ª—è—è –∏—Ö —Å–∏–º–≤–æ–ª–æ–º ':'
$Bytes         = [System.Text.Encoding]::UTF8.GetBytes($Client_Join) # –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –≤ –º–∞—Å—Å–∏–≤ –±–∞–π—Ç
$Cred_Base64   = [Convert]::ToBase64String($Bytes) # –∫–æ–¥–∏—Ä—É–µ–º –±–∞–π—Ç—ã –≤ —Å—Ç—Ä–æ–∫—É Base64
</code></pre>
<h3 id="4-–ø–æ–ª—É—á–µ–Ω–∏–µ-—Ç–æ–∫–µ–Ω–∞">4. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:</h3>

<p><code class="language-plaintext highlighter-rouge">$Cred_Base64   = "N2U2ZDJmOWYtODI1ZS00OWI3LTk4ZjQtNjJmYmI3NTA2NDI3OmIyYzgwZmZmLTEzOGUtNDg1Mi05MjgwLWE2MGI4NTc0YTM2MQ=="</code> <br />
<code class="language-plaintext highlighter-rouge">$UUID = [System.Guid]::NewGuid()</code> –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º UUID –¥–ª—è –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –≤—ã–∑–æ–≤–æ–≤ –∏ —Ä–∞–∑–±–æ—Ä–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤</p>
<pre><code class="language-PowerShell">$url = "https://ngw.devices.sberbank.ru:9443/api/v2/oauth"
$headers = @{
    "Authorization" = "Basic $Cred_Base64"
    "RqUID" = "$UUID"
    "Content-Type" = "application/x-www-form-urlencoded"
}
$body = @{
    scope = "GIGACHAT_API_PERS"
}
$GIGA_TOKEN = $(Invoke-RestMethod -Uri $url -Method POST -Headers $headers -Body $body).access_token
</code></pre>
<h3 id="5-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã">5. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:</h3>
<pre><code class="language-PowerShell">[string]$content = "–ü–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É —á–∏—Å–µ–ª: 22+33"
[string]$role = "user" # —Ä–æ–ª—å –∞–≤—Ç–æ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (user/assistant/system)
[float]$temperature = 0.7 # —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤—ã–±–æ—Ä–∫–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ 2. –ß–µ–º –≤—ã—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–µ–º –±–æ–ª–µ–µ —Å–ª—É—á–∞–π–Ω—ã–º –±—É–¥–µ—Ç –æ—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏.
[float]$top_p = 0.1 # –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ temperature –∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ 1. –ó–∞–¥–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—É—é –º–∞—Å—Å—É —Ç–æ–∫–µ–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω–∞ —É—á–∏—Ç—ã–≤–∞—Ç—å –º–æ–¥–µ–ª—å. –¢–∞–∫, –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ 0.1, –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω—ã, —á—å—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–∞—è –º–∞—Å—Å–∞ –≤—Ö–æ–¥–∏—Ç –≤ –≤–µ—Ä—Ö–Ω–∏–µ 10%.
[int64]$n = 1 # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤ (1..4), –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—Ö–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
[int64]$max_tokens = 512 # –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤
[boolean]$stream = $false # –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ —á–∞—Å—Ç—è–º –≤ –ø–æ—Ç–æ–∫–µ
</code></pre>
<h3 id="6-—Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ-–∑–∞–ø—Ä–æ—Å–æ–≤">6. –°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤:</h3>
<pre><code class="language-PowerShell">$url = "https://gigachat.devices.sberbank.ru/api/v1/chat/completions"
$headers = @{
    "Authorization" = "Bearer $GIGA_TOKEN"
    "Content-Type" = "application/json"
}

$(Invoke-RestMethod -Uri "https://gigachat.devices.sberbank.ru/api/v1/models" -Headers $headers).data # —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π

$body = @{
    model = "GigaChat:latest"
    messages = @(
        @{
            role = $role
            content = $content
        }
    )
    temperature = $temperature
	n = $n
	max_tokens = $max_tokens
	stream = $stream
} | ConvertTo-Json
$Request = Invoke-RestMethod -Method POST -Uri $url -Headers $headers -Body $body
$Request.choices.message.content
</code></pre>
<h2 id="curl">Curl</h2>

<h3 id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤-–≤-ubuntu">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ Ubuntu:</h3>

<p><code class="language-plaintext highlighter-rouge">wget https://gu-st.ru/content/lending/russian_trusted_root_ca_pem.crt</code> <br />
<code class="language-plaintext highlighter-rouge">wget https://gu-st.ru/content/lending/russian_trusted_sub_ca_pem.crt</code> <br />
<code class="language-plaintext highlighter-rouge">mkdir /usr/local/share/ca-certificates/russian_trusted</code> <br />
<code class="language-plaintext highlighter-rouge">cp russian_trusted_root_ca_pem.crt russian_trusted_sub_ca_pem.crt /usr/local/share/ca-certificates/russian_trusted</code> <br />
<code class="language-plaintext highlighter-rouge">update-ca-certificates -v</code> <br />
<code class="language-plaintext highlighter-rouge">wget -qS --spider --max-redirect=0 https://www.sberbank.ru</code></p>

<h3 id="–ø–æ–ª—É—á–µ–Ω–∏–µ-—Ç–æ–∫–µ–Ω–∞">–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:</h3>
<pre><code class="language-Bash">Cred_Base64="N2U2ZDJmOWYtODI1ZS00OWI3LTk4ZjQtNjJmYmI3NTA2NDI3OmIyYzgwZmZmLTEzOGUtNDg1Mi05MjgwLWE2MGI4NTc0YTM2MQ=="
UUID=$(uuidgen)
GIGA_TOKEN=$(curl -s --location --request POST "https://ngw.devices.sberbank.ru:9443/api/v2/oauth" \
--header "Authorization: Basic $Cred_Base64" \
--header "RqUID: $UUID" \
--header "Content-Type: application/x-www-form-urlencoded" \
--data-urlencode 'scope=GIGACHAT_API_PERS' | jq -r .access_token)
</code></pre>
<p><code class="language-plaintext highlighter-rouge">curl -s --location "https://gigachat.devices.sberbank.ru/api/v1/models" --header "Authorization: Bearer $GIGA_TOKEN" | jq .</code> –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</p>

<h3 id="—Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ-–∑–∞–ø—Ä–æ—Å–∞">–°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞:</h3>
<pre><code class="language-Bash">request=$(curl -s https://gigachat.devices.sberbank.ru/api/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $GIGA_TOKEN" \
  -d '{
  "model": "GigaChat:latest",
  "messages": [
        {
            "role": "user",
            "content": "–ö–æ–≥–¥–∞ —É–∂–µ –ò–ò –∑–∞—Ö–≤–∞—Ç–∏—Ç —ç—Ç–æ—Ç –º–∏—Ä?"
        }
    ],
  "temperature": 0.7
}')
echo $request | jq -r .choices[].message.content
</code></pre>
<h1 id="yandexgpt">YandexGPT</h1>

<h2 id="–ø–æ–ª—É—á–∏—Ç—å-oauth-token">–ü–æ–ª—É—á–∏—Ç—å OAuth-Token:</h2>

<p><a href="https://cloud.yandex.ru/ru/docs/iam/operations/iam-token/create">Create AIM Token</a> –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ IAM-—Ç–æ–∫–µ–Ω–∞ –Ω–µ –±–æ–ª—å—à–µ 12 —á–∞—Å–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">yandexPassportOauthToken="y0_AgAAAAAGaLFLAATuwQAAAAD3xtRLQE4hvlazQ5euKO43XXXXXXXXXXX"</code> –¥–ª—è bash <br />
<code class="language-plaintext highlighter-rouge">$yandexPassportOauthToken = "y0_AgAAAAAGaLFLAATuwQAAAAD3xtRLQE4hvlazQ5euKO43XXXXXXXXXXX"</code> –¥–ª—è PowerShell</p>

<h2 id="–æ–±–º–µ–Ω—è—Ç—å-oauth-token-–Ω–∞-iam-token">–û–±–º–µ–Ω—è—Ç—å OAuth-Token –Ω–∞ IAM-Token:</h2>

<p><code class="language-plaintext highlighter-rouge">IAM_TOKEN=$(curl -s -d "{\"yandexPassportOauthToken\":\"$yandexPassportOauthToken\"}" "https://iam.api.cloud.yandex.net/iam/v1/tokens" | jq -r .iamToken)</code> <br />
<code class="language-plaintext highlighter-rouge">$IAM_TOKEN = $(Invoke-RestMethod -Method POST -Uri "https://iam.api.cloud.yandex.net/iam/v1/tokens" -Body $(@{yandexPassportOauthToken = "$yandexPassportOauthToken"} | ConvertTo-Json -Compress)).iamToken</code></p>

<h2 id="–ø–æ–ª—É—á–∏—Ç—å-folder_id">–ü–æ–ª—É—á–∏—Ç—å FOLDER_ID:</h2>
<pre><code class="language-Bash">CLOUD_ID=$(curl -s -H "Authorization: Bearer $IAM_TOKEN" https://resource-manager.api.cloud.yandex.net/resource-manager/v1/clouds | jq -r .clouds[].id) # –ø–æ–ª—É—á–∏—Ç—å cloud id
curl -s --request GET -H "Authorization: Bearer $IAM_TOKEN" https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders -d "{\"cloudId\": \"$CLOUD_ID\"}" # –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –≤ –æ–±–ª–∞–∫–µ
curl -s --request POST -H "Authorization: Bearer $IAM_TOKEN" https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders -d "{\"cloudId\": \"$CLOUD_ID\", \"name\": \"test\"}" # —Å–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –æ–±–ª–∞–∫–µ
FOLDER_ID=$(curl -s --request GET -H "Authorization: Bearer $IAM_TOKEN" https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders -d '{"cloudId": "b1gf9n6heihqj0pt5piu"}' | jq -r '.folders[] | select(.name == "test") | .id') # –∑–∞–±—Ä–∞—Ç—å id –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
</code></pre>
<pre><code class="language-PowerShell">$CLOUD_ID = $(Invoke-RestMethod -Method Get -Uri "https://resource-manager.api.cloud.yandex.net/resource-manager/v1/clouds" -Headers @{"Authorization"="Bearer $IAM_TOKEN"; "Content-Type"="application/json"}).clouds.id
$FOLDER_ID = $(Invoke-RestMethod -Method Get -Uri "https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders" -Headers @{"Authorization"="Bearer $IAM_TOKEN"; "Content-Type"="application/json"} -Body (@{"cloudId"= $CLOUD_ID} | ConvertTo-Json)).folders | Where-Object name -eq test | Select-Object -ExpandProperty id
</code></pre>
<h3 id="—Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ-–∑–∞–ø—Ä–æ—Å–∞-1">–°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞:</h3>
<pre><code class="language-Bash">model="gpt://$FOLDER_ID/yandexgpt/latest" # https://cloud.yandex.ru/ru/docs/yandexgpt/concepts/models
body=$(cat &lt;&lt;EOF
{
  "modelUri": "$model",
  "completionOptions": {
    "stream": false,
    "temperature": 0.6,
    "maxTokens": 2000
  },
  "messages": [
    {
      "role": "user",
      "text": "–ü–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É 22+33"
    }
  ]
}
EOF)
curl --request POST \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $IAM_TOKEN" \
  -H "x-folder-id: $FOLDER_ID" \
  -d "$body" \
  "https://llm.api.cloud.yandex.net/foundationModels/v1/completion"
</code></pre>
<pre><code class="language-PowerShell">$model = "gpt://$FOLDER_ID/yandexgpt/latest"
$body = @"
{
  "modelUri": "$model",
  "completionOptions": {
    "stream": false,
    "temperature": 0.6,
    "maxTokens": 2000
  },
  "messages": [
    {
      "role": "user",
      "text": "–ü–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É 22+33"
    }
  ]
}
"@
Invoke-RestMethod -Method POST -Uri "https://llm.api.cloud.yandex.net/foundationModels/v1/completion" -Headers @{"Content-Type"="application/json"; "Authorization"="Bearer $IAM_TOKEN"; "x-folder-id"="$FOLDER_ID"} -Body $body
</code></pre>
<h1 id="superagi">SuperAGI</h1>

<p><a href="https://github.com/TransformerOptimus/SuperAGI">Source</a> <br />
<a href="https://models.superagi.com/playground/generate">Playground generate</a> <br />
<a href="https://documenter.getpostman.com/view/30119783/2s9YR3cFJG">API Doc (exaples)</a></p>
<pre><code class="language-Bash">SUPERAGI_API_KEY="31f72164129XXXXX"
prompt="–ø–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É 22+33, –¥–∞–π —Ç–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ —Ç–µ–∫—Å—Ç–∞"
request=$(curl -s -X POST 'https://api.superagi.com/v1/generate/65437cbf227a4018516ad1ce' \
-H 'Content-Type: application/json' \
-H "Authorization: Bearer $SUPERAGI_API_KEY" \
-d '{
  "prompt": ["$prompt"],
  "max_tokens": 500,
  "temperature": 0.9,
  "top_p": 0.15,
  "repetition_penalty": 0,
  "best_of": 1.05,
  "top_k": 50,
  "stream": false
}')
echo $request | sed "s/data: //" | jq -r .choices[].text
</code></pre>
<pre><code class="language-PowerShell">$SUPERAGI_API_KEY = "31f72164129XXXXX"
$prompt = "–ø–æ—Å—á–∏—Ç–∞–π —Å—É–º–º—É 22+33, –¥–∞–π —Ç–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ —Ç–µ–∫—Å—Ç–∞"
$request = Invoke-RestMethod -Method Post -Uri 'https://api.superagi.com/v1/generate/65437cbf227a4018516ad1ce' -Headers @{
    'Content-Type' = 'application/json'
    'Authorization' = "Bearer $SUPERAGI_API_KEY"
} -Body (@{
    prompt = @($prompt)
    max_tokens = 500
    temperature = 0.9
    top_p = 0.15
    repetition_penalty = 0
    best_of = 1.05
    top_k = 50
    stream = $false
} | ConvertTo-Json)
$($request -replace "^data: " | ConvertFrom-Json).choices.text
</code></pre>
<h1 id="replicate">Replicate</h1>

<p><a href="https://replicate.com/stability-ai/stable-diffusion/examples?input=http">API curl examples</a></p>
<pre><code class="language-Bash">REPLICATE_API_TOKEN="r8_STyeUNXiGonkLfxE1FSKaqll26lXXXXXXXXXX"
prompt="–ñ–∏—Ä–∞—Ñ –≤ –ø–æ–ª–æ—Å–∫—É –∑–µ–±—Ä—ã"
request=$(curl -s -X POST \
  -H "Authorization: Token $REPLICATE_API_TOKEN" \
  -H "Content-Type: application/json" \
  -d $'{
    "version": "ac732df83cea7fff18b8472768c88ad041fa750ff7682a21affe81863cbe77e4",
    "input": {
      "prompt": "$prompt"
    }
  }' \
  https://api.replicate.com/v1/predictions)
request_url=$(echo $request | jq -r .urls.get)
response_status=$(curl -s -H "Authorization: Token $REPLICATE_API_TOKEN" $request_url | jq -r .status)
while [[ $response_status != succeeded ]]; do
    response_status=$(curl -s -H "Authorization: Token $REPLICATE_API_TOKEN" $request_url | jq -r .status)
done
curl -s -H "Authorization: Token $REPLICATE_API_TOKEN" $request_url | jq -r .output[]
</code></pre>
<pre><code class="language-PowerShell">$REPLICATE_API_TOKEN = "r8_STyeUNXiGonkLfxE1FSKaqll26lXXXXXXXXXX"
$prompt = "–ñ–∏—Ä–∞—Ñ –≤ –ø–æ–ª–æ—Å–∫—É –∑–µ–±—Ä—ã"
$body = @{
   version = "ac732df83cea7fff18b8472768c88ad041fa750ff7682a21affe81863cbe77e4"
   input = @{
       prompt = $prompt
   }
} | ConvertTo-Json
$headers = @{
   "Authorization" = "Token $REPLICATE_API_TOKEN"
   "Content-Type" = "application/json"
}
$request = Invoke-RestMethod -Uri "https://api.replicate.com/v1/predictions" -Method POST -Body $body -Headers $headers
$response = Invoke-RestMethod $($request.urls.get) -Headers @{"Authorization" = "Token $REPLICATE_API_TOKEN"}
while ($response.status -ne "succeeded") {
    $response = Invoke-RestMethod $($request.urls.get) -Headers @{"Authorization" = "Token $REPLICATE_API_TOKEN"}
}
$response.output
</code></pre>
<h1 id="google-filter">Google-Filter</h1>

<p><code class="language-plaintext highlighter-rouge">https://www.google.com/search?q=the+rookie+2018+imdb</code> —Ñ–æ—Ä–º–∞—Ç url-–∑–∞–ø—Ä–æ—Å–∞ –ø–æ–∏—Å–∫–∞ —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ <br />
<code class="language-plaintext highlighter-rouge">https://www.google.com/search?q=the+rookie+2018+site:imdb.com</code> –ø–æ–∏—Å–∫ –ø–æ —Å–∞–π—Ç—É <br />
<code class="language-plaintext highlighter-rouge">https://www.google.com/search?q=the+rookie+intitle:index.of+"last modified"+(mkv|avi)</code> –∏—Å–∫–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö —É–∫–∞–∑–∞–Ω–æ ‚Äúlast modified‚Äù (–ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è), –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —á–µ—Ä–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ–∏—Å–∫–∞ (–≤—Å–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ –¥–æ–ª–∂–Ω—ã –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ) —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–æ ‚Äúindex.of‚Äù (—É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–µ, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤) –∏ –∏—Å–∫–∞—Ç—å —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏ .mkv –∏–ª–∏ (|) .avi <br />
<code class="language-plaintext highlighter-rouge">https://www.google.com/search?q=the+rookie+2018+filetype:torrent</code> <br />
<code class="language-plaintext highlighter-rouge">–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è gopro hero 11 filetype:pdf</code> –∏—Å–∫–∞—Ç—å —Å—Ä–∞–∑—É –¥–æ–∫—É–º–µ–Ω—Ç (–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ .pdf –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞) <br />
<code class="language-plaintext highlighter-rouge">"–¥–µ–π—Å—Ç–≤–∏—è/–≥–ª–∞–≥–æ–ª—ã, —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–º–∞–Ω–¥–ª–µ—Ç–∞—Ö"</code> –∏—Å–∫–∞—Ç—å –ø–æ —Ñ—Ä–∞–∑–µ —Ü–µ–ª–∏–∫–æ–º, –±–µ–∑ —Ä–∞–∑–±–∏–µ–Ω–∏—è –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ <br />
<code class="language-plaintext highlighter-rouge">"—è–≥—É–∞—Ä —Å–∫–æ—Ä–æ—Å—Ç—å -–∂–∏–≤–æ—Ç–Ω–æ–µ -xe -xj"</code> —É–∑–Ω–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –Ø–≥—É–∞—Ä–∞, –∏—Å–∫–ª—é—á–∞–µ–º –∂–∏–≤–æ—Ç–Ω–æ–µ –∏ –º–æ–¥–µ–ª–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è <br />
<code class="language-plaintext highlighter-rouge">"intitle:–ª—É—á—à–∏–µ —Ñ–∏–ª—å–º—ã 2023"</code> –∑–∞–ø—Ä–æ—Å –∏—â–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∑–∞–≥–æ–ª–æ–≤–∫–∏ (title HTML –¥–æ–∫—É–º–µ–Ω—Ç–∞) –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–ª–æ–≤–∞ ‚Äú–ª—É—á—à–∏–µ‚Äù, ‚Äú—Ñ–∏–ª—å–º—ã‚Äù –∏ ‚Äú2023‚Äù (–≤—Å–µ —Å–ª–æ–≤–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ) <br />
<code class="language-plaintext highlighter-rouge">"allintitle:–ª—É—á—à–∏–µ —Ñ–∏–ª—å–º—ã 2023"</code> –∑–∞–ø—Ä–æ—Å –∏—â–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∑–∞–≥–æ–ª–æ–≤–∫–∏ (title HTML –¥–æ–∫—É–º–µ–Ω—Ç–∞) –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–ª–æ–≤–∞ ‚Äú–ª—É—á—à–∏–µ‚Äù, ‚Äú—Ñ–∏–ª—å–º—ã‚Äù –∏–ª–∏ ‚Äú2023‚Äù (–æ–¥–Ω–æ –∏–∑) <br />
<code class="language-plaintext highlighter-rouge">"intext:telegram –±–æ—Ç powershell"</code> –ø–æ–∏—Å–∫ —Å—Ç—Ä–∞–Ω–∏—Ü, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –≤ —Ç–µ–∫—Å—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ) <br />
<code class="language-plaintext highlighter-rouge">"inurl:lifailon"</code> –ø–æ–∏—Å–∫ —Å—Ç—Ä–∞–Ω–∏—Ü, –≤ URL –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ <br />
<code class="language-plaintext highlighter-rouge">intitle:index.of "game of thrones" mkv daterange:2010..2015</code> —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYYMMDD..YYYYMMDD <br />
<code class="language-plaintext highlighter-rouge">intitle:index.of "game of thrones" mkv after:2015</code> –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤, –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö –¥–æ (before) –∏–ª–∏ –ø–æ—Å–ª–µ (after) —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∞—Ç—ã <br />
<code class="language-plaintext highlighter-rouge">intitle:index.of "game of thrones" mkv from:2010 to:2015</code> —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –¥–∞—Ç <br />
<code class="language-plaintext highlighter-rouge">https://www.google.com/search?q=the-rookie-2018+site:imdb.com&amp;btnI</code> —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ø–µ—Ä–≤—ã–π url</p>

<h1 id="google-api">Google-API</h1>

<h3 id="google-translate">Google-Translate</h3>
<pre><code class="language-PowerShell">$Key = "&lt;TOKEN_API&gt;" # –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω: https://console.cloud.google.com/apis/credentials
$Text = "You can see in the right corner how long each translation request takes (this does not depend on the amount of text being transferred)."
$LanguageTarget = "RU"
$LanguageSource = "EN"
$url = "https://translation.googleapis.com/language/translate/v2?key=$key"
$Header = @{
    "Content-Type" = "application/json"
}
$Body = @{
    "q" = "$Text"
    "target" = "$LanguageTarget"
    "source" = "$LanguageSource"
} | ConvertTo-Json
$WebClient = New-Object System.Net.WebClient
foreach ($key in $Header.Keys) {
    $WebClient.Headers.Add($key, $Header[$key])
}
$Response = $WebClient.UploadString($url, "POST", $Body) | ConvertFrom-Json
$Response.data.translations.translatedText
</code></pre>
<h3 id="google-search">Google-Search</h3>
<pre><code class="language-PowerShell">$Key = "&lt;TOKEN_API&gt;" # –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω: https://developers.google.com/custom-search/v1/overview?hl=ru (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø–æ–∏—Å–∫ JSON API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç 100 –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ)
$cx = "35c78340f49eb474a" # —Å–æ–∑–¥–∞—Ç—å –ø–æ–∏—Å–∫–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É https://programmablesearchengine.google.com/controlpanel/all
$Query = "–∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ discord"
$Lang = "ru"
$Num = 10
$Start = 0
$response = Invoke-RestMethod "https://www.googleapis.com/customsearch/v1?q=$Query&amp;key=$Key&amp;cx=$cx&amp;lr=lang_$Lang&amp;num=$Num&amp;$start=$Start"
$response.items | Select-Object title,snippet,displayLink,link | Format-List
</code></pre>
<h1 id="rapidapi">RapidAPI</h1>

<p><a href="https://rapidapi.com/ru/neoscrap-net/api/google-search72">Google-Search72</a></p>
<pre><code class="language-PowerShell">$Key = "&lt;TOKEN_API&gt;"
$headers=@{}
$headers.Add("X-RapidAPI-Key", "$Key")
$headers.Add("X-RapidAPI-Host", "google-search72.p.rapidapi.com")
$query = "–∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ discord"
$response = Invoke-RestMethod "https://google-search72.p.rapidapi.com/search?q=$query%20gitgub&amp;gl=us&amp;lr=lang_ru&amp;num=20&amp;start=0" -Method GET -Headers $headers
$response.items | Select-Object title,snippet,displayLink,link | Format-List
</code></pre>
<h3 id="imdb">IMDb</h3>

<p><a href="https://rapidapi.com/apidojo/api/imdb8">IMDb8</a></p>
<pre><code class="language-PowerShell">$key = "&lt;TOKEN_API&gt;" # 500 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–µ—Å—è—Ü
$query="Break"
$headers=@{}
$headers.Add("X-RapidAPI-Key", "$key")
$headers.Add("X-RapidAPI-Host", "imdb8.p.rapidapi.com")
$response = Invoke-RestMethod "https://imdb8.p.rapidapi.com/title/find?q=$query" -Method GET -Headers $headers
$response.results | select title,titletype,year,runningTimeInMinutes,id | Format-Table
"https://www.imdb.com$($response.results.id[0])"
$response.results.principals # –∞–∫—Ç–µ—Ä—ã
$response.results.image
</code></pre>
<h3 id="moviesdatabase">MoviesDatabase</h3>

<p><a href="https://rapidapi.com/SAdrian/api/moviesdatabase">MoviesDatabase</a></p>
<pre><code class="language-PowerShell">$key = "&lt;TOKEN_API&gt;"
$imdb_id = "tt0455275"
$headers=@{}
$headers.Add("X-RapidAPI-Key", "$key")
$headers.Add("X-RapidAPI-Host", "moviesdatabase.p.rapidapi.com")
$response = Invoke-RestMethod "https://moviesdatabase.p.rapidapi.com/titles/$imdb_id" -Method GET -Headers $headers
$response.results
</code></pre>
<h1 id="tmdb">TMDB</h1>

<p><a href="https://developer.themoviedb.org/reference/intro/getting-started">Developer TMDB</a></p>
<pre><code class="language-PowerShell">$TOKEN = "548e444e7812575caa0a7eXXXXXXXXXX"
$Endpoint = "search/tv" # –ø–æ–∏—Å–∫ —Å–µ—Ä–∏–∞–ª–∞ (tv) –∏ —Ñ–∏–ª—å–º–∞ (movie) –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
$Query = "–∑–∏–º–æ—Ä–æ–¥–æ–∫"
$url = $("https://api.themoviedb.org/3/$Endpoint"+"?api_key=$TOKEN&amp;query=$Query")
$(Invoke-RestMethod -Uri $url -Method Get).results
$id = $(Invoke-RestMethod -Uri $url -Method Get).results.id # –∑–∞–±—Ä–∞—Ç—å id —Å–µ—Ä–∏–∞–ª–∞ (210865) https://www.themoviedb.org/tv/210865

$Endpoint = "tv/$id" # –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä–∏–∞–ª–µ –ø–æ –µ–≥–æ ID
$url = $("https://api.themoviedb.org/3/$Endpoint"+"?api_key=$TOKEN")
$(Invoke-RestMethod -Uri $url -Method Get) # —Å–ø–∏—Å–æ–∫ —Å–µ–∑–æ–Ω–æ–≤ (.seasons), –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–∏–∑–æ–¥–æ–≤ (.seasons.episode_count)

(Invoke-RestMethod -Uri "https://api.themoviedb.org/3/tv/$id/season/2?api_key=$Token" -Method Get).episodes # –≤—ã–≤–µ—Å—Ç–∏ 2 —Å–µ–∑–æ–Ω
Invoke-RestMethod -Uri "https://api.themoviedb.org/3/tv/$id/season/2/episode/8?api_key=$Token" -Method Get # –≤—ã–≤–µ—Å—Ç–∏ 8 —ç–ø–∏–∑–æ–¥
</code></pre>
<h1 id="omdb">OMDb</h1>

<p>–ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–∞ –ø–æ <a href="https://www.omdbapi.com">email</a></p>

<p><code class="language-plaintext highlighter-rouge">$API_KEY = "XXXXXXXX"</code> <br />
<code class="language-plaintext highlighter-rouge">$IMDb_ID = "tt7587890"</code> <br />
<code class="language-plaintext highlighter-rouge">curl -s "https://omdbapi.com/?apikey=$($API_KEY)&amp;i=$($IMDb_ID)" | jq .</code> <br />
<code class="language-plaintext highlighter-rouge">curl -s "https://omdbapi.com/?apikey=$($API_KEY)&amp;i=$($IMDb_ID)" | ConvertFrom-Json</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&amp;s=The Rookie"</code> <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&amp;t=The Rookie"</code> –ø–æ–∏—Å–∫ –ø–æ Title <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&amp;t=The Rookie&amp;y=1990"</code> –ø–æ–∏—Å–∫ –ø–æ Title –∏ –≥–æ–¥—É –≤—ã—Ö–æ–¥–∞ <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&amp;t=The Rookie&amp;type=movie"</code> –ø–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ —Ñ–∏–ª—å–º–∞ (movie) –∏–ª–∏ —Å–µ—Ä–∏–∞–ª–∞ (series) <br />
<code class="language-plaintext highlighter-rouge">$(Invoke-RestMethod "https://omdbapi.com/?apikey=$($API_KEY)&amp;s=The Rookie").Search</code> –ø–æ–∏—Å–∫ –≤—Å–µ—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π (—Ñ–∏–ª—å–º—ã –∏ —Å–µ—Ä–∏–∞–ª—ã)</p>

<h1 id="ivi">ivi</h1>

<p><a href="https://ask.ivi.ru/knowledge-bases/10/articles/51697-dokumentatsiya-dlya-api-ivi">ivi api doc</a></p>

<p><code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.ivi.ru/mobileapi/categories</code> —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –∂–∞–Ω—Ä–æ–≤ (genres/meta_genres) <br />
<code class="language-plaintext highlighter-rouge">Invoke-RestMethod https://api.ivi.ru/mobileapi/collections</code> –ø–æ–¥–±–æ—Ä–∫–∏</p>

<p><code class="language-plaintext highlighter-rouge">(Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.seasons.number</code> –∫–æ–ª-–≤–æ —Å–µ–∑–æ–Ω–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">(Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.seasons[1].episode_count</code> –∫–æ–ª-–≤–æ —Å–µ—Ä–∏–π –≤–æ –≤—Ç–æ—Ä–æ–º —Å–µ–∑–æ–Ω–µ <br />
<code class="language-plaintext highlighter-rouge">(Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.seasons[1].ivi_release_info.date_interval_min</code> –¥–∞—Ç–∞ –≤—ã—Ö–æ–¥–∞ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ—Ä–∏–∏ <br />
<code class="language-plaintext highlighter-rouge">(Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.kp_rating</code> —Ä–µ–π—Ç–∏–Ω–≥ –≤ –ö–∏–Ω–æ–ø–æ–∏—Å–∫ (8.04)</p>

<p><code class="language-plaintext highlighter-rouge">$id = (Invoke-RestMethod "https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok").result.kp_id</code> –ø–æ–ª—É—á–∏—Ç—å id –≤ –ö–∏–Ω–æ–ø–æ–∏—Å–∫ (5106881) <br />
<code class="language-plaintext highlighter-rouge">id=$(curl -s https://api.ivi.ru/mobileapi/search/v7/?query=zimorodok | jq .result[].kp_id)</code> –ø–æ–ª—É—á–∏—Ç—å id –≤ –ö–∏–Ω–æ–ø–æ–∏—Å–∫</p>

<h1 id="kinopoisk">Kinopoisk</h1>
<pre><code class="language-Bash">id=5106881
get=$(curl -s https://www.kinopoisk.ru/film/$id/episodes/)
printf "%s\n" "${get[@]}" | grep -A 1 "–°–µ–∑–æ–Ω 2" | grep "—ç–ø–∏–∑–æ–¥–æ–≤" | sed -r "s/^.+\: //" # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–∏–∑–¥–æ–≤–æ–¥ –≤–æ –≤—Ç–æ—Ä–æ–º —Å–µ–∑–æ–Ω–µ
</code></pre>
<h3 id="kinopoiskdev">kinopoisk.dev</h3>

<p><a href="https://t.me/kinopoiskdev_bot">–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω</a> <br />
<a href="https://kinopoisk.dev/documentation">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ API –≤ —Ñ–æ—Ä–º–∞—Ç–µ OpenAPI</a></p>

<p><code class="language-plaintext highlighter-rouge">GET /v1.4/movie/{id}</code> –ø–æ–∏—Å–∫ –ø–æ id</p>
<pre><code class="language-PowerShell">$id = 5106881
$API_KEY = "ZYMNJJA-0J8MNPN-PB4N7R7-XXXXXXX"

$Header = @{
    "accept" = "application/json"
    "X-API-KEY" = "$API_KEY"
}
$irm = Invoke-RestMethod "https://api.kinopoisk.dev/v1.4/movie/$id" -Method GET -Headers $Header
$irm.rating.kp # —Ä–µ–π—Ç–∏–Ω–≥ –≤ –ö–∏–Ω–æ–ø–æ–∏—Å–∫ (8,079)
$irm.seasonsInfo # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–∑–æ–Ω–æ–≤ –∏ —ç–ø–∏–∑–æ–¥–æ–≤ –≤ –Ω–∏—Ö
</code></pre>
<pre><code class="language-Bash">id=5106881
API_KEY="ZYMNJJA-0J8MNPN-PB4N7R7-XXXXXXX"
get=$(curl -s -X GET \
  "https://api.kinopoisk.dev/v1.4/movie/$id" \
  -H "accept: application/json" \
  -H "X-API-KEY: $API_KEY")
echo $get | jq .rating.kp # —Ä–µ–π—Ç–∏–Ω–≥ –≤ –ö–∏–Ω–æ–ø–æ–∏—Å–∫ (8,079)
echo $get | jq .seasonsInfo[1].episodesCount # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–∏–∑–æ–¥–æ–≤ –≤–æ –≤—Ç–æ—Ä–æ–º [1] —Å–µ–∑–æ–Ω–µ (6)
</code></pre>
<p><code class="language-plaintext highlighter-rouge">GET /v1.4/movie/search</code></p>
<pre><code class="language-Bash">query="zimorodok"
page=1 # –∫–æ–ª-–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –≤—ã–±–æ—Ä–∫–∏
limit=1 # –∫–æ–ª-–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
curl -s -X GET \
  "https://api.kinopoisk.dev/v1.4/movie/search?page=$page&amp;limit=$limit&amp;query=$query" \
  -H "accept: application/json" \
  -H "X-API-KEY: $API_KEY" | jq .

limit=5
request=$(curl -s -X GET \
  "https://api.kinopoisk.dev/v1.4/movie/search?page=$page&amp;limit=$limit&amp;query=%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA" \
  -H "accept: application/json" \
  -H "X-API-KEY: $API_KEY" | jq .)
echo $request | jq '.docs[] | select(.year == 2022)' # –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ –≥–æ–¥—É –≤—ã—Ö–æ–¥–∞
</code></pre>
<pre><code class="language-PowerShell">$API_KEY = "ZYMNJJA-0J8MNPN-PB4N7R7-XXXXXXX"
$page = 1
$limit = 5
$query = "%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA"
$request = Invoke-RestMethod -Uri "https://api.kinopoisk.dev/v1.4/movie/search?page=$page&amp;limit=$limit&amp;query=$query" -Headers @{"accept"="application/json"; "X-API-KEY"="$API_KEY"}
$request.docs | Where-Object year -eq 2022
</code></pre>
<h3 id="urlcode">UrlCode</h3>
<pre><code class="language-PowerShell">function Get-PercentEncode ($str) {
   $bytes = [System.Text.Encoding]::UTF8.GetBytes($str)
   ($bytes | ForEach-Object { "{0:X2}" -f $_ }) -join '%' -replace "^","%"
}
Get-PercentEncode "–∑–∏–º–æ—Ä–æ–¥–æ–∫"
</code></pre>
<pre><code class="language-PowerShell">function Get-UrlEncode($str) {
   [System.Web.HttpUtility]::UrlEncode($str)
}
UrlEncode "–∑–∏–º–æ—Ä–æ–¥–æ–∫"
</code></pre>
<pre><code class="language-Bash">percent-encode() {
	str=$1
    echo -n "$1" | iconv -t utf8 | od -An -tx1 | tr ' ' % | tr -d '\n'
}
percent-encode "–∑–∏–º–æ—Ä–æ–¥–æ–∫"
</code></pre>
<pre><code class="language-PowerShell">function Get-UrlDecode($encoded) {
    [System.Uri]::UnescapeDataString($encoded)
}
Get-UrlDecode "%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA"
</code></pre>
<pre><code class="language-Bash">percent-decode() {
    encoded=$1
    local url_encoded="${1//+/ }"
    printf '%b' "${url_encoded//%/\\x}"
}
percent-decode "%D0%B7%D0%B8%D0%BC%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%BA"
</code></pre>
<h3 id="kinopoiskapiunofficial">KinopoiskApiUnofficial</h3>

<p>–ë–µ—Å–ø–ª–∞—Ç–Ω–æ 500 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å—É—Ç–∫–∏. <a href="https://kinopoiskapiunofficial.tech/documentation/api">Swagger documentation</a></p>
<pre><code class="language-PowerShell">API_KEY="828ec96a-f45d-4e3d-84b1-XXXXXXXXXXXX"
$headers = @{
    "accept" = "application/json"
    "X-API-KEY" = "$API_KEY"
}
Invoke-RestMethod -Uri 'https://kinopoiskapiunofficial.tech/api/v2.2/films/1142153' -Headers $headers
</code></pre>
<p><code class="language-plaintext highlighter-rouge">curl -s "https://kinopoiskapiunofficial.tech/api/v2.2/films/1142153" -H "accept: application/json" -H "X-API-KEY: $API_KEY" | jq .</code></p>

<h3 id="kinobox">Kinobox</h3>

<p><code class="language-plaintext highlighter-rouge">$url = "https://www.kinopoisk.ru/film/694051"</code> <br />
<code class="language-plaintext highlighter-rouge">$kp_id = $url -replace ".+/"</code> <br />
<code class="language-plaintext highlighter-rouge">https://kinomix.web.app/#694051</code> <br />
<code class="language-plaintext highlighter-rouge">curl -s -X GET "https://kinobox.tv/api/players/main?kinopoisk=$kp_id" -H "accept: application/json"</code> –ø–æ–∏—Å–∫ –ø–æ id –ö–∏–Ω–æ–ø–æ–∏—Å–∫ <br />
<code class="language-plaintext highlighter-rouge">curl -s -X GET "https://kinobox.tv/api/players/main?imdb=tt2293640" -H "accept: application/json"</code> –ø–æ–∏—Å–∫ –ø–æ id IMDb <br />
<code class="language-plaintext highlighter-rouge">curl -s -X GET "https://kinobox.tv/api/players/main?title=minions" -H "accept: application/json"</code> –ø–æ–∏—Å–∫ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–ª–µ–µ—Ä–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é <br />
<code class="language-plaintext highlighter-rouge">curl -s -X GET "https://kinobox.tv/api/players/all?title=minions" -H "accept: application/json"</code> –ø–æ–∏—Å–∫ –≤—Å–µ—Ö –ø–ª–µ–µ—Ä–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">curl -s -X GET "https://kinobox.tv/api/popular/films" -H "accept: application/json"</code> –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–ª—å–º—ã <br />
<code class="language-plaintext highlighter-rouge">curl -s -X GET "https://kinobox.tv/api/popular/series" -H "accept: application/json"</code> –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å–µ—Ä–∏–∞–ª—ã</p>

<h1 id="videocdn">VideoCDN</h1>

<p><a href="https://github.com/notssh/videocdn-api">API</a> <br />
<a href="https://github.com/API-Movies/videocdn">Source</a> <br />
<a href="https://api-movies.github.io/videocdn/index.json">API JSON</a></p>
<pre><code class="language-PowerShell">$kp_id = 5106881
$token = "YfTWH2p3Mai7ziqDoGjS3yXXXXXXXXXX"
$ep = "tv-series"
$(Invoke-RestMethod $("https://videocdn.tv/api/$ep"+"?api_token=$token&amp;field=kinopoisk_id&amp;query=$kp_id")).data.episodes | Where-Object season_num -eq 2 | Select-Object @{Name="Episode"; Expression={$_.num}}, @{Name="Voice"; Expression={$_.media.translation.title}} # –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–∏–∏ –ø–æ –≤—Ç–æ—Ä–æ–º—É —Å–µ–∑–æ–Ω—É –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –æ–∑–≤—É—á–∫–∏ –∫ —Å–µ—Ä–∏—è–º
</code></pre>
<pre><code class="language-Bash">kp_id=5106881
token="YfTWH2p3Mai7ziqDoGjS3yXXXXXXXXXX"
ep="tv-series"
curl -s "https://videocdn.tv/api/$ep?api_token=$token&amp;field=kinopoisk_id&amp;query=$kp_id" | jq ".data[].episodes | length" # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä–∏–π
curl -s "https://videocdn.tv/api/$ep?api_token=$token&amp;field=kinopoisk_id&amp;query=$kp_id" | jq ".data[].episodes[] | select(.season_num == 2) | {episode: .ru_title, voice: .media[].translation.title}" # –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã–≤–æ–¥–∞
</code></pre>
<h1 id="telegram">Telegram</h1>

<p>@BotFather (https://t.me/BotFather) /newbot</p>

<p>Format: <code class="language-plaintext highlighter-rouge">https://api.telegram.org/bot&lt;token&gt;/&lt;endpoint&gt;</code></p>

<p><a href="https://core.telegram.org/bots/api#getupdates">getupdates</a></p>
<pre><code class="language-PowerShell">function Get-FromTelegram {
    param (
        $Token = "687...:AAF...",
        [switch]$Date,
        [switch]$Last,
        [switch]$ChatID
    )
    $endpoint = "getUpdates"
    $url      = "https://api.telegram.org/bot$Token/$endpoint"
    $result   = Invoke-RestMethod -Uri $url
    if ($Date) {
        $Collections = New-Object System.Collections.Generic.List[System.Object]
        foreach ($r in $($result.result)) {
            $EpochTime = [DateTime]"1/1/1970"
            $TimeZone = Get-TimeZone
            $UTCTime = $EpochTime.AddSeconds($r.message.date)
            $d = $UTCTime.AddMinutes($TimeZone.BaseUtcOffset.TotalMinutes)
            $Collections.Add([PSCustomObject]@{
                Message = $r.message.text;
                Date    = $d
            })
        }
        $Collections
    }
    else {
        if ($Last) {
            $result.result.message.text[-1]
        }
        elseif ($ChatID) {
            $Collections = New-Object System.Collections.Generic.List[System.Object]
            foreach ($r in $($result.result)) {
                $Collections.Add([PSCustomObject]@{
                    Message = $r.message.text;
                    UserName = $r.message.chat.username;
                    ChatID = $r.message.chat.id;
                    ChatType = $r.message.chat.type
                })
            }
            $Collections
        }
        else {
            $result.result.message.text
        }
    }
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Get-FromTelegram</code> <br />
<code class="language-plaintext highlighter-rouge">Get-FromTelegram -Last</code> <br />
<code class="language-plaintext highlighter-rouge">Get-FromTelegram -Date</code> <br />
<code class="language-plaintext highlighter-rouge">Get-FromTelegram -ChatID</code></p>

<p><a href="https://core.telegram.org/bots/api#sendmessage">sendmessage</a></p>
<pre><code class="language-PowerShell">function Send-ToTelegram {
param (
    [Parameter(Mandatory = $True)]$Text,
    $Token    = "687...:AAF...",
    $Chat     = "125468108",
    $Keyboard
)
    $endpoint = "sendMessage"
    $url      = "https://api.telegram.org/bot$Token/$endpoint"
    $Body = @{
        chat_id = $Chat
        text    = $Text
    }
    if ($keyboard -ne $null) {
        $Body += @{reply_markup = $keyboard}
    }
    Invoke-RestMethod -Uri $url -Body $Body
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">Send-ToTelegram -Text "Send test from powershell"</code></p>
<pre><code class="language-PowerShell">$LastDate = (Get-FromTelegram -date)[-1].Date
while ($true) {
    $LastMessage  = (Get-FromTelegram -date)[-1]
    Start-Sleep 1
    $LastDateTest = $LastMessage.Date
    if (($LastMessage.Message -match "/Service") -and ($LastDate -ne $LastDateTest)) {
        $ServiceName = $($LastMessage.Message -split " ")[-1]
        $Result = $(Get-Service $ServiceName -ErrorAction Ignore).Status
        if ($Result) {
            Send-ToTelegram -Text $Result
        } else {
            Send-ToTelegram -Text "Service not found"
        }
        $LastDate = $LastDateTest
    }
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">/Service vpnagent</code> <br />
<code class="language-plaintext highlighter-rouge">/Service WinRM</code> <br />
<code class="language-plaintext highlighter-rouge">/Service test</code></p>

<h3 id="button">Button</h3>
<pre><code class="language-PowerShell">$keyboard = '{
    "inline_keyboard":[[
        {"text":"Uptime","callback_data":"/Uptime"},
        {"text":"Test","callback_data":"/Test"}
    ]]
}'
Send-ToTelegram -Text "Test buttons" -Keyboard $keyboard
$request = (Invoke-RestMethod -Uri "https://api.telegram.org/bot$Token/getUpdates").result.callback_query
$request.data # –ø—Ä–æ—á–∏—Ç–∞—Ç—å callback_data –Ω–∞–∂–∞—Ç–æ–π –∫–Ω–æ–ø–∫–∏
$request.message.date
</code></pre>
<h1 id="discord">Discord</h1>

<p><a href="https://discord.com/developers/applications">Developers</a></p>

<p>–°–æ–∑–¥–∞–µ–º Applications (General Information). –í Bot –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫ Application –∏ –∫–æ–ø–∏—Ä—É–µ–º —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –í OAuth2 - URL Generator –≤—ã–±–∏—Ä–∞–µ–º bot –∏ –ø—Ä–∞–≤–∞ Administrator –∏ –∫–æ–ø–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–π URL –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –∫–∞–Ω–∞–ª. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ url –∏ –¥–æ–±–∞–≤–ª—è–µ–º –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –ü–æ–ª—É—á–∞–µ–º ID –∫–∞–Ω–∞–ª–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (—Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∫–∞–Ω–∞–ª—ã, –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –∫–æ–ø–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É –∏ –∑–∞–±–∏—Ä–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π id –≤ url).</p>

<h3 id="send-to-discord">Send to Discord</h3>
<pre><code class="language-Bash">DISCORD_TOKEN="MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX"
DISCORD_CHANNEL_ID="119403124XXXXXXXXXX"
TEXT="test from bash"
URL="https://discordapp.com/api/channels/$DISCORD_CHANNEL_ID/messages"
curl -s -X POST $URL \
  -H "Authorization: Bot $DISCORD_TOKEN" \
  -H "Content-Type: application/json" \
  -d "{\"content\": \"$TEXT\"}"
</code></pre>
<pre><code class="language-PowerShell">$DISCORD_TOKEN = "MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX"
$DISCORD_CHANNEL_ID = "119403124XXXXXXXXXX"
$TEXT = "test from PowerShell"
$URL = "https://discordapp.com/api/channels/$DISCORD_CHANNEL_ID/messages"
$Body = @{
    content = $TEXT
} | ConvertTo-Json
curl -s $URL -X POST -H "Authorization: Bot $DISCORD_TOKEN" -H "Content-Type: application/json" -d $Body
</code></pre>
<h3 id="read-from-discord">Read from Discord</h3>
<pre><code class="language-Bash">curl -s -X GET $URL \
  -H "Authorization: Bot $DISCORD_TOKEN" \
  -H "Content-Type: application/json" | jq -r .[0].content
</code></pre>
<pre><code class="language-PowerShell">$messages = (curl -s -X GET $URL -H "Authorization: Bot $DISCORD_TOKEN" -H "Content-Type: application/json" | ConvertFrom-Json)
$messages | Select-Object content,timestamp,{$_.author.username}
</code></pre>
<h3 id="httpclient">HttpClient</h3>
<pre><code class="language-PowerShell">$DISCORD_TOKEN = "MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX"
$DISCORD_CHANNEL_ID = "119403124XXXXXXXXXX"
$URL = "https://discordapp.com/api/channels/$DISCORD_CHANNEL_ID/messages"
$HttpClient = New-Object System.Net.Http.HttpClient
$HttpClient.DefaultRequestHeaders.Authorization = "Bot $DISCORD_TOKEN"
$response = $HttpClient.GetAsync($URL).Result
$messages = $response.Content.ReadAsStringAsync().Result
($messages | ConvertFrom-Json).content
</code></pre>
<h3 id="button-1">Button</h3>
<pre><code class="language-Bash">curl -X POST $URL \
  -H "Content-Type: application/json" \
  -H "Authorization: Bot $DISCORD_TOKEN" \
  -d '
  {
    "content": "Test text for button",
    "components": [
      {
        "type": 1,
        "components": [
          {
            "type": 2,
            "label": "Button",
            "style": 1,
            "custom_id": "button_click"
          }
        ]
      }
    ]
  }'
</code></pre>
<h3 id="discordnetwebhook">Discord.Net.Webhook</h3>
<pre><code class="language-PowerShell">Add-Type -Path $(ls "$home\Documents\Discord.NET\*.dll").FullName
# https://discordapp.com/api/webhooks/&lt;webhook_id&gt;/&lt;webhook_token&gt; (–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–∞–Ω–∞–ª - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
$webhookId = 1197577280000000000
$webhookToken = "rs8AA-XXXXXXXXXXX_Vk5RUI4A6HuSGhpCCTepq25duwCwLXasfv6u23a7XXXXXXXXXX"
$messageContent = "Test dotNET"
$client = New-Object Discord.Webhook.DiscordWebhookClient($webhookId, $webhookToken)
$client.SendMessageAsync($messageContent).Wait()
</code></pre>
<h3 id="discordnetwebsocket">Discord.Net.WebSocket</h3>
<pre><code class="language-PowerShell">$DiscordAssemblies = $(ls "$home\Documents\Discord.NET\*.dll").FullName
foreach ($assembly in $DiscordAssemblies) {
    Add-Type -Path $assembly
}
$DISCORD_TOKEN = "MTE5NzE1NjM0NTM3NjQxMTcyOQ.XXXXXX.EzBF6RA9Kx_MSuhLW5elH1U-XXXXXXXXXXXXXX"
$Client = New-Object Discord.WebSocket.DiscordSocketClient
$Client.Add_MessageReceived({
    param($message)
    if ($message.Author.Id -ne $Client.CurrentUser.Id) {
        Write-Host ("Received message from " + $message.Author.Username + ": " + $message.Content)
        if ($message.Content.Contains("ping")) {
            $message.Channel.SendMessageAsync("pong").GetAwaiter().GetResult()
        }
    }
})
$Client.LoginAsync([Discord.TokenType]::Bot, $DISCORD_TOKEN).GetAwaiter().GetResult()
#$Client.StartAsync().Wait()
$Client.StartAsync().GetAwaiter().GetResult()
$Client.ConnectionState

[console]::ReadKey($true)
$Client.LogoutAsync().GetAwaiter().GetResult()
$Client.Dispose()
</code></pre>
<h1 id="oh-my-posh">oh-my-posh</h1>

<p><a href="https://ohmyposh.dev/docs/installation/windows">Install</a></p>

<p><code class="language-plaintext highlighter-rouge">winget install JanDeDobbeleer.OhMyPosh -s winget</code> <br />
<code class="language-plaintext highlighter-rouge">choco install oh-my-posh -y</code> <br />
<code class="language-plaintext highlighter-rouge">scoop install https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/oh-my-posh.json</code> <br />
<code class="language-plaintext highlighter-rouge">Set-ExecutionPolicy Bypass -Scope Process -Force; Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://ohmyposh.dev/install.ps1'))</code></p>

<p><a href="https://ohmyposh.dev/docs/themes">Themes</a></p>

<p><code class="language-plaintext highlighter-rouge">Get-PoshThemes</code> <br />
<code class="language-plaintext highlighter-rouge">oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/di4am0nd.omp.json" | Invoke-Expression</code> <br />
<code class="language-plaintext highlighter-rouge">oh-my-posh init pwsh --config "https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/cert.omp.json" | Invoke-Expression</code></p>

<p><code class="language-plaintext highlighter-rouge">New-Item -Path $PROFILE -Type File -Force</code> <br />
<code class="language-plaintext highlighter-rouge">notepad $PROFILE</code> <br />
<code class="language-plaintext highlighter-rouge">oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/di4am0nd.omp.json" | Invoke-Expression</code></p>

<h3 id="themes-performance">themes-performance</h3>
<pre><code class="language-PowerShell">Install-Module themes-performance -Repository NuGet
Import-Module themes-performance
Set-PoshTheme -Theme System-Sensors # -Save
Set-PoshTheme -Theme System-Performance # -Save
Set-PoshTheme -Theme Pwsh-Process-Performance # -Save
</code></pre>
<h3 id="terminal-icons">Terminal-Icons</h3>

<p><code class="language-plaintext highlighter-rouge">Install-Module -Name Terminal-Icons -Repository PSGallery</code> <br />
<code class="language-plaintext highlighter-rouge">scoop bucket add extras</code> <br />
<code class="language-plaintext highlighter-rouge">scoop install terminal-icons</code></p>

<p><code class="language-plaintext highlighter-rouge">notepad $PROFILE</code> <br />
<code class="language-plaintext highlighter-rouge">Import-Module -Name Terminal-Icons</code></p>

<p>–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —à—Ä–∏—Ñ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –ø—Ä–æ—Ñ–∏–ª—è PowerShell: <a href="https://github.com/ryanoasis/nerd-fonts">Nerd Fonts</a> <br />
<a href="https://www.nerdfonts.com/font-downloads">–°–ø–∏—Å–æ–∫ —à—Ä–∏—Ñ—Ç–æ–≤</a> <br />
–°–∫–∞—á–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —à—Ä–∏—Ñ—Ç –ø–æ—Ö–æ–∂–∏–π –Ω–∞ Cascadia Code - <a href="https://github.com/ryanoasis/nerd-fonts/releases/download/v3.1.1/CascadiaCode.zip">CaskaydiaCove</a></p>

<h1 id="pester">Pester</h1>

<p><a href="https://github.com/pester/Pester">Source</a></p>

<p><code class="language-plaintext highlighter-rouge">Install-Module -Name Pester -Repository PSGallery -Force -AllowClobber</code> <br />
<code class="language-plaintext highlighter-rouge">Import-Module Pester</code> <br />
<code class="language-plaintext highlighter-rouge">$(Get-Module Pester -ListAvailable).Version</code></p>

<p><code class="language-plaintext highlighter-rouge">.Tests.ps1</code></p>
<pre><code class="language-PowerShell">function Add-Numbers {
    param (
        [int]$a,
        [int]$b
    )
    $a + $b
}
Describe "Add-Numbers" {
    Context "–ü—Ä–∏ —Å–ª–æ–∂–µ–Ω–∏–∏ –¥–≤—É—Ö —á–∏—Å–µ–ª" {
        It "–î–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—É–º–º–∞" {
            $result = Add-Numbers -a 3 -b 4
            $result | Should -Be 7
        }
    }
    Context "–ü—Ä–∏ —Å–ª–æ–∂–µ–Ω–∏–∏ –¥–≤—É—Ö —á–∏—Å–µ–ª" {
        It "–î–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å—Å—è –æ—à–∏–±–∫–∞ (5+0 -ne 4)" {
            $result = Add-Numbers -a 5 -b 0
            $result | Should -Be 4
        }
    }
}

function Get-RunningProcess {
    return Get-Process | Select-Object -ExpandProperty Name
}
Describe "Get-RunningProcess" {
    Context "–ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤" {
        It "–î–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å–æ–≤" {
            $result = Get-RunningProcess
            $result | Should -Contain "svchost"
            $result | Should -Contain "explorer"
        }
    }
    Context "–ö–æ–≥–¥–∞ –Ω–µ—Ç –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤" {
        It "–î–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫" {
            # –ó–∞–º–æ–∫–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é Get-Process, —á—Ç–æ–±—ã –æ–Ω–∞ –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
            Mock Get-Process { return @() }
            $result = Get-RunningProcess
            $result | Should -BeEmpty
        }
    }
}
</code></pre>
<h1 id="pandoc">Pandoc</h1>
<pre><code class="language-PowerShell">$release_latest = Invoke-RestMethod "https://api.github.com/repos/jgm/pandoc/releases/latest"
$url = $($release_latest.assets | Where-Object name -match "windows-x86_64.zip").browser_download_url
Invoke-RestMethod $url -OutFile $home\Downloads\pandoc.zip
Expand-Archive -Path "$home\Downloads\pandoc.zip" -DestinationPath "$home\Downloads\"
$path = $(Get-ChildItem "$home\Downloads\pandoc-*\*.exe").FullName
Copy-Item -Path $path -Destination "C:\Windows\System32\pandoc.exe"
Remove-Item "$home\Downloads\pandoc*" -Force -Recurse
</code></pre>
<p><code class="language-plaintext highlighter-rouge">pandoc -s README.md -o index.html</code> –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ Markdown –≤ HTML <br />
<code class="language-plaintext highlighter-rouge">pandoc README.md -o index.html --css=styles.css</code> –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ç–∏–ª–∏ –∏–∑ css <br />
<code class="language-plaintext highlighter-rouge">pandoc -s index.html -o README.md</code> –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ HTML –≤ Markdown <br />
<code class="language-plaintext highlighter-rouge">pandoc -s README.md -o README.docx</code> –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Word <br />
<code class="language-plaintext highlighter-rouge">pandoc -s README.md -o README.epub</code> –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –æ—Ç–∫—Ä—ã—Ç—ã–π —Ñ–æ—Ä–º–∞—Ç —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –≤–µ—Ä—Å–∏–π –∫–Ω–∏–≥ <br />
<code class="language-plaintext highlighter-rouge">pandoc -s README.md -o README.pdf</code> –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ PDF (—Ç—Ä–µ–±—É–µ—Ç—Å—è rsvg-convert)</p>
<pre><code class="language-PowerShell">Import-Module ImportExcel
Import-Excel -Path srv.xlsx | Export-Csv -Path $csvFilePath -NoTypeInformation -Encoding UTF8 # –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Excel –≤ csv
pandoc -s -f csv -t markdown input.csv -o output.md # –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—É csv –≤ markdown
</code></pre>
<h1 id="ffmpeg">FFmpeg</h1>
<pre><code class="language-PowerShell">$release_latest = Invoke-RestMethod "https://api.github.com/repos/BtbN/FFmpeg-Builds/releases/latest"
$url = $($release_latest.assets | Where-Object name -match "ffmpeg-master-latest-win64-gpl.zip").browser_download_url
Invoke-RestMethod $url -OutFile $home\Downloads\ffmpeg-master-latest-win64-gpl.zip
Expand-Archive -Path "$home\Downloads\ffmpeg-master-latest-win64-gpl.zip" -DestinationPath "$home\Downloads\"
Copy-Item -Path "$home\Downloads\ffmpeg-master-latest-win64-gpl\bin\ffmpeg.exe" -Destination "C:\Windows\System32\ffmpeg.exe"
Remove-Item "$home\Downloads\ffmpeg-*" -Force -Recurse
</code></pre>
<p><code class="language-plaintext highlighter-rouge">ffmpeg -i input.mp4 output.gif</code> –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å mp4 –≤ gif <br />
<code class="language-plaintext highlighter-rouge">ffmpeg -i input.mp4 -filter_complex "scale=1440:-1:flags=lanczos" output.gif</code> –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –≤—ã—Ö–æ–¥–µ <br />
<code class="language-plaintext highlighter-rouge">ffmpeg -i input.mp4 -filter_complex "scale=1440:-1:flags=lanczos" -r 10 output.gif</code> –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–¥—Ä–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É –Ω–∞ –≤—ã—Ö–æ–¥–µ <br />
<code class="language-plaintext highlighter-rouge">ffmpeg -i input.mp4 -filter_complex "fps=5,scale=960:-1:flags=lanczos,split[s0][s1];[s0]palettegen=max_colors=32[p];[s1][p]paletteuse=dither=bayer" output.gif</code> —Å–∂–∞—Ç–∏–µ –∑–∞ —Å—á–µ—Ç —Ü–≤–µ—Ç–æ–≤–æ–π –ø–æ–ª–∏—Ç—Ä—ã <br />
<code class="language-plaintext highlighter-rouge">ffmpeg -i input.mp4 -ss 00:00:10 -frames:v 1 -q:v 1 output.jpg</code> –≤—ã—Ç–∞—â–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç –∏–∑ –≤–∏–¥–µ–æ –Ω–∞ 10 —Å–µ–∫—É–Ω–¥–µ <br />
<code class="language-plaintext highlighter-rouge">ffmpeg -i input.mp4 -ss 00:00:05 -to 00:00:10 -c copy output.mp4</code> –≤—ã—Ç–∞—â–∏—Ç—å –∫—É—Å–æ–∫ –≤–∏–¥–µ–æ <br />
<code class="language-plaintext highlighter-rouge">ffmpeg -i "%d.jpeg" -framerate 2 -c:v libx264 -r 30 -pix_fmt yuv420p output.mp4</code> —Å–æ–∑–¥–∞—Ç—å –≤–∏–¥–µ–æ –∏–∑ —Ñ–æ—Ç–æ (1.jpeg, 2.jpeg –∏ —Ç.–¥.) —Å framerate (—á–∞—Å—Ç–æ—Ç–æ–π –∫–∞–¥—Ä–æ–≤) –≤ —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–º –≤–∏–¥–µ–æ 2 –∫–∞–¥—Ä–∞ –≤ —Å–µ–∫—É–Ω–¥—É <br />
<code class="language-plaintext highlighter-rouge">ffmpeg -i "rtsp://admin:password@192.168.3.201:554" -rtsp_transport tcp -c:v copy -c:a aac -strict experimental output.mp4</code> –∑–∞–ø–∏—Å—å –±–µ–∑ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (copy) RTSP-–ø–æ—Ç–æ–∫–∞ —Å –∫–∞–º–µ—Ä—ã –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è (+ –∞—É–¥–∏–æ –≤ –∫–æ–¥–µ–∫–µ AAC) –≤ —Ñ–∞–π–ª <br />
<code class="language-plaintext highlighter-rouge">ffmpeg -i "rtsp://admin:password@192.168.3.201:554" -rtsp_transport tcp -c:v copy -c:a aac -strict experimental -movflags +faststart+frag_keyframe+empty_moov output.mp4</code> –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—á–∞—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–µ –¥–æ –µ–≥–æ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ <br />
<code class="language-plaintext highlighter-rouge">ffmpeg -i "rtsp://admin:password@192.168.3.201:554" -rtsp_transport tcp -frames:v 1 -c:v mjpeg output.jpg</code> —Å–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç</p>

<h1 id="imagemagick">ImageMagick</h1>

<p>Source: <a href="https://sourceforge.net/projects/imagemagick">ImageMagick</a></p>

<p><code class="language-plaintext highlighter-rouge">magick identify -verbose PowerShell-Commands.png</code> –∏–∑–≤–ª–µ—á—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">magick PowerShell-Commands.png output.jpg</code> –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è <br />
<code class="language-plaintext highlighter-rouge">magick PowerShell-Commands.png -resize 800x600 output.jpg</code> –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä (—É–≤–µ–ª–∏—á–∏—Ç—å –∏–ª–∏ —É–º–µ–Ω—å—à–∏—Ç—å) <br />
<code class="language-plaintext highlighter-rouge">magick PowerShell-Commands.png -crop 400x300+100+50 output.jpg</code> –æ–±—Ä–µ–∑–∞—Ç—å <br />
<code class="language-plaintext highlighter-rouge">magick PowerShell-Commands.png -rotate 90 output.jpg</code> –ø–æ–≤–µ—Ä–Ω—É—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">magick PowerShell-Commands.png -fill white -pointsize 24 -gravity center -annotate +0+0 "PowerShell" output.jpg</code> –Ω–∞–ª–æ–∂–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ <br />
<code class="language-plaintext highlighter-rouge">magick PowerShell-Commands.png -brightness-contrast +20x+10 output.jpg</code> –∏–∑–º–µ–Ω–∏—Ç—å —è—Ä–∫–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å <br />
<code class="language-plaintext highlighter-rouge">magick convert -delay 100 1.png 2.png 3.png output.gif</code> —Å–æ–∑–¥–∞—Ç—å gif –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π <br />
<code class="language-plaintext highlighter-rouge">magick convert image1.jpg image2.jpg -append output.jpg</code> –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</p>

<h1 id="hugo">Hugo</h1>

<p><a href="https://github.com/gohugoio/hugo">Source</a></p>

<p><code class="language-plaintext highlighter-rouge">winget install Hugo.Hugo.Extended</code> <br />
<code class="language-plaintext highlighter-rouge">scoop install hugo-extended</code> <br />
<code class="language-plaintext highlighter-rouge">choco install hugo-extended</code></p>
<pre><code class="language-PowerShell">$user = "gohugoio"
$repository = "hugo"
$release_latest = Invoke-RestMethod "https://api.github.com/repos/$($user)/$($repository)/releases/latest"
$url = $($release_latest.assets | Where-Object name -match "hugo_extended_[\d.]+_windows-amd64\.zip").browser_download_url
Invoke-RestMethod $url -OutFile $home\Downloads\hugo.zip
Expand-Archive -Path "$home\Downloads\hugo.zip" -DestinationPath "$home\Downloads\hugo\"
Copy-Item -Path "$home\Downloads\hugo\hugo.exe" -Destination "C:\Windows\System32\hugo.exe"
Remove-Item "$home\Downloads\hugo*" -Force -Recurse
</code></pre>
<p><a href="https://themes.gohugo.io">–°–ø–∏—Å–æ–∫ —Ç–µ–º</a> <br />
<a href="https://gohugo.io/commands">–°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥</a> <br />
<code class="language-plaintext highlighter-rouge">hugo completion powershell | Out-String | Invoke-Expression</code> –≤–∫–ª—é—á–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –∞–≤—Ç–æ–∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ <br />
<code class="language-plaintext highlighter-rouge">hugo version</code></p>
<pre><code class="language-PowerShell">hugo new site lifailon.github.io.hugo # —Å–æ–∑–¥–∞—Ç—å –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —Å–∞–π—Ç
cd lifailon.github.io.hugo
git init # –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø—É—Å—Ç–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Git –≤ —Ç–µ–∫—É—â–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ–º—ã –∫–∞—Ç–∞–ª–æ–≥ themes, –¥–æ–±–∞–≤–∏–≤ –µ–µ –≤ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç –∫–∞–∫ –ø–æ–¥–º–æ–¥—É–ª—å Git (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
git submodule add -f https://github.com/JingWangTW/dark-theme-editor.git themes/dark-theme-editor
echo 'theme = "dark-theme-editor"' &gt;&gt; hugo.toml
#git submodule add https://github.com/rhazdon/hugo-theme-hello-friend-ng.git themes/hello-friend-ng
#echo 'theme = "hello-friend-ng"' &gt;&gt; hugo.toml
mkdir "$home\Downloads\lifailon.github.io.hugo\content\powershell\"
cp "$home\Downloads\README.md" "$home\Downloads\lifailon.github.io.hugo\content\powershell\index.md" # —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å markdown –¥–æ–∫—É–º–µ–Ω—Ç –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞
hugo server #  –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä —Å –ø—Ä–æ–µ–∫—Ç–æ–º (http://localhost:1313)
</code></pre>
<p><a href="https://github.com/JingWangTW/dark-theme-editor">Dark-Theme-Editor</a></p>

<p><code class="language-plaintext highlighter-rouge">code hugo.toml</code></p>
<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">baseURL</span> <span class="p">=</span> <span class="s">'https://lifailon.github.io'</span>
<span class="py">languageCode</span> <span class="p">=</span> <span class="s">'en-us'</span>
<span class="py">title</span> <span class="p">=</span> <span class="s">'PS-Commands'</span>
<span class="py">theme</span> <span class="p">=</span> <span class="s">"dark-theme-editor"</span>

<span class="nn">[taxonomies]</span>
<span class="py">autor</span> <span class="p">=</span> <span class="s">"Lifailon"</span>
<span class="py">tag</span> <span class="p">=</span> <span class="s">"Code"</span>
<span class="py">category</span> <span class="p">=</span> <span class="s">"PowerShell"</span>

<span class="nn">[params]</span>
<span class="nn">[params.site]</span>
<span class="py">faviconUrl</span> <span class="p">=</span> <span class="s">""</span>

<span class="nn">[params.header]</span>
<span class="py">title</span> <span class="p">=</span> <span class="s">"Lifailon.GitHub.io"</span>
<span class="py">subtitle</span> <span class="p">=</span> <span class="s">"–ë–æ–ª—å—à–∞—è –±–∞–∑–∞ –∑–∞–º–µ—Ç–æ–∫ PowerShell –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ."</span>

<span class="nn">[params.header.logo]</span>
<span class="py">imgUrl</span> <span class="p">=</span> <span class="s">""</span>
<span class="py">logoLink</span> <span class="p">=</span> <span class="s">""</span>

<span class="nn">[params.footer]</span>
<span class="py">copyrightStr</span> <span class="p">=</span> <span class="s">"GitHub"</span>
<span class="py">counter</span> <span class="p">=</span> <span class="kc">false</span>
<span class="py">language</span> <span class="p">=</span> <span class="kc">false</span>
<span class="py">hugoVersion</span> <span class="p">=</span> <span class="kc">true</span>
<span class="py">theme</span> <span class="p">=</span> <span class="kc">true</span>
<span class="py">modifiedTime</span> <span class="p">=</span> <span class="kc">true</span>
<span class="py">dateFormat</span> <span class="p">=</span> <span class="s">"Jan 02 2006"</span>
<span class="py">gitHash</span> <span class="p">=</span> <span class="kc">false</span>
<span class="nn">[params.footer.socialLink]</span>
<span class="py">github</span> <span class="p">=</span> <span class="s">"https://github.com/Lifailon"</span>

<span class="nn">[params.globalFrontmatter]</span>
<span class="py">author</span> <span class="p">=</span> <span class="s">"Lifailon"</span>
<span class="py">description</span> <span class="p">=</span> <span class="s">"Large base of PowerShell notes in Russian language"</span>
<span class="py">keywords</span> <span class="p">=</span> <span class="s">"PowerShell"</span>

<span class="nn">[params.homePage]</span>
<span class="py">siteLongDescriptionTitle</span> <span class="p">=</span> <span class="s">"PowerShell Commands"</span>
<span class="py">siteLongDescription</span> <span class="p">=</span> <span class="s">"–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —è–∑—ã–∫–∞, —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–º–∞–Ω–¥–ª–µ—Ç–æ–≤ –∏ –º–æ–¥—É–ª–µ–π, —Ä–∞–±–æ—Ç–∞ —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –∏ –≤–Ω–µ—à–Ω–∏–º–∏ —É—Ç–∏–ª–∏—Ç–∞–º–∏, –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π .NET, —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ —á–µ—Ä–µ–∑ REST API, –∞ —Ç–∞–∫ –∂–µ —Å–∏—Å—Ç–µ–º–∞–º–∏ AD, Exchange, Hyper-V, VMWare, –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ —Ç.–¥."</span>
<span class="py">showRecentPostsBlock</span> <span class="p">=</span> <span class="kc">false</span>
<span class="py">numOfRecentPosts</span> <span class="p">=</span> <span class="mi">5</span>
<span class="py">recentPostShowUrl</span> <span class="p">=</span> <span class="kc">false</span>

<span class="nn">[params.page]</span>
<span class="py">includeToc</span> <span class="p">=</span> <span class="kc">false</span>
<span class="py">showAuthor</span> <span class="p">=</span> <span class="kc">true</span>
<span class="py">showDate</span> <span class="p">=</span> <span class="kc">true</span>
<span class="py">dateFormat</span> <span class="p">=</span> <span class="s">"Jan 02 2006"</span>
<span class="py">showTimeToRead</span> <span class="p">=</span> <span class="kc">true</span>
<span class="py">showBreadcrumb</span> <span class="p">=</span> <span class="kc">true</span>
<span class="py">codeBlockCopible</span> <span class="p">=</span> <span class="kc">true</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">code "content\powershell\index.md"</code></p>
<pre><code class="language-Markdown">---
title: "PowerShell Commands"
author: "Lifailon"
date: "2024-03-14T03:00:00+03:00"
categories: ["PowerShell"]
tags: ["dotNET", "REST API", "Active Dirtctory", "EMShell", "PowerCLI", "Database"]
---
</code></pre>
<p><a href="https://github.com/rhazdon/hugo-theme-hello-friend-ng">Hugo-Theme-Hello-Friend-ng</a></p>
<div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">baseURL</span> <span class="p">=</span> <span class="s">'https://lifailon.github.io'</span>
<span class="py">title</span> <span class="p">=</span> <span class="s">"Shell Commands"</span>
<span class="py">languageCode</span> <span class="p">=</span> <span class="s">"en-us"</span>
<span class="py">theme</span> <span class="p">=</span> <span class="s">"hello-friend-ng"</span>
<span class="py">contentDir</span> <span class="p">=</span> <span class="s">"content"</span>

<span class="nn">[taxonomies]</span>
<span class="py">autor</span> <span class="p">=</span> <span class="s">"Lifailon"</span>
<span class="py">tag</span> <span class="p">=</span> <span class="s">"PowerShell"</span>
<span class="py">category</span> <span class="p">=</span> <span class="s">"Code"</span>

<span class="nn">[params.author]</span>
<span class="py">name</span> <span class="p">=</span> <span class="s">"Lifailon"</span>

<span class="nn">[params.footer]</span>
<span class="py">trademark</span> <span class="p">=</span> <span class="s">"2022-2024"</span>
<span class="py">bottomText</span> <span class="p">=</span> <span class="p">[</span><span class="s">"GitHub ‚ñ∂Ô∏è &lt;a href=</span><span class="se">\"</span><span class="s">https://github.com/Lifailon</span><span class="se">\"</span><span class="s">&gt;Lifailon&lt;/a&gt;"</span><span class="p">]</span>

<span class="nn">[params.logo]</span>
<span class="py">logoMark</span> <span class="p">=</span> <span class="s">"&gt;"</span>
<span class="py">logoText</span> <span class="p">=</span> <span class="s">"$ /home/lifailon/"</span>
<span class="py">logoHomeLink</span> <span class="p">=</span> <span class="s">"/"</span>
<span class="py">logoCursorColor</span> <span class="p">=</span> <span class="s">"#67a2c9"</span>
<span class="py">logoCursorAnimate</span> <span class="p">=</span> <span class="s">"2s"</span>
<span class="py">logoCursorPathname</span> <span class="p">=</span> <span class="kc">true</span>
<span class="py">logoCursorDisabled</span> <span class="p">=</span> <span class="kc">false</span>

<span class="c">#[params.portrait]</span>
<span class="c">#path = "/img/image.jpg"</span>
<span class="c">#alt = "Portrait"</span>
<span class="c">#maxWidth = "1500px"</span>

<span class="nn">[[params.social]]</span>
<span class="py">name</span> <span class="p">=</span> <span class="s">"github"</span>
<span class="py">url</span> <span class="p">=</span> <span class="s">"https://github.com/Lifailon"</span>

<span class="nn">[menu]</span>
<span class="nn">[[menu.main]]</span>
<span class="py">identifier</span> <span class="p">=</span> <span class="s">"ps"</span>
<span class="py">name</span> <span class="p">=</span> <span class="s">"PowerShell Commands"</span>
<span class="py">url</span> <span class="p">=</span> <span class="s">"/powershell/"</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">hugo</code> –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∞–π—Ç–∞ (—Å–æ–∑–¥–∞—Å—Ç –ø–∞–ø–∫—É public —Å –≥–æ—Ç–æ–≤—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ —Å–∞–π—Ç–∞ –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è)</p>

  </div>

  <div class="date">
    Written on April 15, 2024
  </div>

  
</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          



<a href="https://github.com/Lifailon/PS-Commands"><i class="svg-icon github"></i></a>








        </footer>
      </div>
    </div>

    

  </body>
</html>
