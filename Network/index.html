
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Lifailon">
      
      
        <link rel="canonical" href="https://lifailon.github.io/Network/">
      
      
        <link rel="prev" href="../FileSystem/">
      
      
        <link rel="next" href="../Windows/">
      
      
      <link rel="icon" href="../Logo/PowerShell-Logo.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.20">
    
    
      
        <title>Network - PowerShell Commands</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CInter:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Inter"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/highlight/obsidian.min.css">
    
      <link rel="stylesheet" href="../assets/custom/headers.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ping" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PowerShell Commands" class="md-header__button md-logo" aria-label="PowerShell Commands" data-md-component="logo">
      
  <img src="../Logo/PowerShell-Logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PowerShell Commands
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Network
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Lifailon/PS-Commands" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PowerShell Commands" class="md-nav__button md-logo" aria-label="PowerShell Commands" data-md-component="logo">
      
  <img src="../Logo/PowerShell-Logo.png" alt="logo">

    </a>
    PowerShell Commands
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Lifailon/PS-Commands" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Syntax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syntax
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../FileSystem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File System
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Network
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Network
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ping" class="md-nav__link">
    <span class="md-ellipsis">
      ping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dhcp" class="md-nav__link">
    <span class="md-ellipsis">
      dhcp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#port" class="md-nav__link">
    <span class="md-ellipsis">
      port
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netstat" class="md-nav__link">
    <span class="md-ellipsis">
      netstat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nslookup" class="md-nav__link">
    <span class="md-ellipsis">
      nslookup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ipconfig" class="md-nav__link">
    <span class="md-ellipsis">
      ipconfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adapter" class="md-nav__link">
    <span class="md-ellipsis">
      Adapter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnsclient" class="md-nav__link">
    <span class="md-ellipsis">
      DNSClient
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnscache" class="md-nav__link">
    <span class="md-ellipsis">
      DNSCache
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#binding" class="md-nav__link">
    <span class="md-ellipsis">
      Binding
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tcpsetting" class="md-nav__link">
    <span class="md-ellipsis">
      TCPSetting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hostname" class="md-nav__link">
    <span class="md-ellipsis">
      hostname
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arp" class="md-nav__link">
    <span class="md-ellipsis">
      arp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-adapter-statistics" class="md-nav__link">
    <span class="md-ellipsis">
      Network Adapter Statistics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#speedtest" class="md-nav__link">
    <span class="md-ellipsis">
      SpeedTest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iperf" class="md-nav__link">
    <span class="md-ellipsis">
      iPerf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install" class="md-nav__link">
    <span class="md-ellipsis">
      Install
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#env-update-exec-path" class="md-nav__link">
    <span class="md-ellipsis">
      Env-Update-Exec-Path
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iperf-gui" class="md-nav__link">
    <span class="md-ellipsis">
      iPerf-GUI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iperf-docker" class="md-nav__link">
    <span class="md-ellipsis">
      iPerf-Docker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server" class="md-nav__link">
    <span class="md-ellipsis">
      Server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client" class="md-nav__link">
    <span class="md-ellipsis">
      Client
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ps-iperf" class="md-nav__link">
    <span class="md-ellipsis">
      PS-iPerf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#firewall" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#firewall-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall-Manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdp" class="md-nav__link">
    <span class="md-ellipsis">
      RDP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ipban" class="md-nav__link">
    <span class="md-ellipsis">
      IPBan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      shutdown
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#udp-socket" class="md-nav__link">
    <span class="md-ellipsis">
      UDP-Socket
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-netudpconnection" class="md-nav__link">
    <span class="md-ellipsis">
      Test-NetUDPConnection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tcp-socket" class="md-nav__link">
    <span class="md-ellipsis">
      TCP-Socket
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wakeonlan" class="md-nav__link">
    <span class="md-ellipsis">
      WakeOnLan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#httplistener" class="md-nav__link">
    <span class="md-ellipsis">
      HTTPListener
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#webclient" class="md-nav__link">
    <span class="md-ellipsis">
      WebClient
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#httpclient" class="md-nav__link">
    <span class="md-ellipsis">
      HttpClient
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#certificate" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openvpn" class="md-nav__link">
    <span class="md-ellipsis">
      OpenVPN
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serverovpn" class="md-nav__link">
    <span class="md-ellipsis">
      server.ovpn
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clientovpn" class="md-nav__link">
    <span class="md-ellipsis">
      client.ovpn
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client_1" class="md-nav__link">
    <span class="md-ellipsis">
      Client
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#route" class="md-nav__link">
    <span class="md-ellipsis">
      Route
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nat" class="md-nav__link">
    <span class="md-ellipsis">
      NAT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wireguard" class="md-nav__link">
    <span class="md-ellipsis">
      WireGuard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vpnclient" class="md-nav__link">
    <span class="md-ellipsis">
      VpnClient
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proxyclient" class="md-nav__link">
    <span class="md-ellipsis">
      ProxyClient
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netsh" class="md-nav__link">
    <span class="md-ellipsis">
      netsh
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse-proxy" class="md-nav__link">
    <span class="md-ellipsis">
      Reverse Proxy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wlan" class="md-nav__link">
    <span class="md-ellipsis">
      Wlan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#firewall_1" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openssh" class="md-nav__link">
    <span class="md-ellipsis">
      OpenSSH
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psremoting-over-ssh" class="md-nav__link">
    <span class="md-ellipsis">
      PSRemoting over SSH
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#winrm" class="md-nav__link">
    <span class="md-ellipsis">
      WinRM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-remote-management-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Remote Management Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kerberos" class="md-nav__link">
    <span class="md-ellipsis">
      Kerberos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#console-download" class="md-nav__link">
    <span class="md-ellipsis">
      Console-Download
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psdomaintest" class="md-nav__link">
    <span class="md-ellipsis">
      PSDomainTest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#check-host" class="md-nav__link">
    <span class="md-ellipsis">
      Check-Host
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syslog" class="md-nav__link">
    <span class="md-ellipsis">
      Syslog
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Syslog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#psyslog" class="md-nav__link">
    <span class="md-ellipsis">
      pSyslog
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syslog-source-message" class="md-nav__link">
    <span class="md-ellipsis">
      Syslog source message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syslog-type-message" class="md-nav__link">
    <span class="md-ellipsis">
      Syslog type message
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Threads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threads
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dotNET/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    .NET
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../COM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    COM
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ServerManager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server Manager
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ActiveDirectory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active Directory
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exchange/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microsoft Exchange
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Virtualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtualization
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../MarkupLanguages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markup Languages
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../DevOps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DevOps
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Zabbix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zabbix
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../SCM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCM
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ansible/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ansible
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üê≥ Docker
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üêß Linux
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../TorAPI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üìö TorAPI Docs
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ping" class="md-nav__link">
    <span class="md-ellipsis">
      ping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dhcp" class="md-nav__link">
    <span class="md-ellipsis">
      dhcp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#port" class="md-nav__link">
    <span class="md-ellipsis">
      port
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netstat" class="md-nav__link">
    <span class="md-ellipsis">
      netstat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nslookup" class="md-nav__link">
    <span class="md-ellipsis">
      nslookup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ipconfig" class="md-nav__link">
    <span class="md-ellipsis">
      ipconfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adapter" class="md-nav__link">
    <span class="md-ellipsis">
      Adapter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnsclient" class="md-nav__link">
    <span class="md-ellipsis">
      DNSClient
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnscache" class="md-nav__link">
    <span class="md-ellipsis">
      DNSCache
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#binding" class="md-nav__link">
    <span class="md-ellipsis">
      Binding
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tcpsetting" class="md-nav__link">
    <span class="md-ellipsis">
      TCPSetting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hostname" class="md-nav__link">
    <span class="md-ellipsis">
      hostname
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arp" class="md-nav__link">
    <span class="md-ellipsis">
      arp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-adapter-statistics" class="md-nav__link">
    <span class="md-ellipsis">
      Network Adapter Statistics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#speedtest" class="md-nav__link">
    <span class="md-ellipsis">
      SpeedTest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iperf" class="md-nav__link">
    <span class="md-ellipsis">
      iPerf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install" class="md-nav__link">
    <span class="md-ellipsis">
      Install
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#env-update-exec-path" class="md-nav__link">
    <span class="md-ellipsis">
      Env-Update-Exec-Path
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iperf-gui" class="md-nav__link">
    <span class="md-ellipsis">
      iPerf-GUI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iperf-docker" class="md-nav__link">
    <span class="md-ellipsis">
      iPerf-Docker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server" class="md-nav__link">
    <span class="md-ellipsis">
      Server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client" class="md-nav__link">
    <span class="md-ellipsis">
      Client
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ps-iperf" class="md-nav__link">
    <span class="md-ellipsis">
      PS-iPerf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#firewall" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#firewall-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall-Manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdp" class="md-nav__link">
    <span class="md-ellipsis">
      RDP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ipban" class="md-nav__link">
    <span class="md-ellipsis">
      IPBan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      shutdown
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#udp-socket" class="md-nav__link">
    <span class="md-ellipsis">
      UDP-Socket
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-netudpconnection" class="md-nav__link">
    <span class="md-ellipsis">
      Test-NetUDPConnection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tcp-socket" class="md-nav__link">
    <span class="md-ellipsis">
      TCP-Socket
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wakeonlan" class="md-nav__link">
    <span class="md-ellipsis">
      WakeOnLan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#httplistener" class="md-nav__link">
    <span class="md-ellipsis">
      HTTPListener
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#webclient" class="md-nav__link">
    <span class="md-ellipsis">
      WebClient
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#httpclient" class="md-nav__link">
    <span class="md-ellipsis">
      HttpClient
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#certificate" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openvpn" class="md-nav__link">
    <span class="md-ellipsis">
      OpenVPN
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serverovpn" class="md-nav__link">
    <span class="md-ellipsis">
      server.ovpn
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clientovpn" class="md-nav__link">
    <span class="md-ellipsis">
      client.ovpn
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client_1" class="md-nav__link">
    <span class="md-ellipsis">
      Client
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#route" class="md-nav__link">
    <span class="md-ellipsis">
      Route
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nat" class="md-nav__link">
    <span class="md-ellipsis">
      NAT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wireguard" class="md-nav__link">
    <span class="md-ellipsis">
      WireGuard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vpnclient" class="md-nav__link">
    <span class="md-ellipsis">
      VpnClient
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proxyclient" class="md-nav__link">
    <span class="md-ellipsis">
      ProxyClient
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#netsh" class="md-nav__link">
    <span class="md-ellipsis">
      netsh
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse-proxy" class="md-nav__link">
    <span class="md-ellipsis">
      Reverse Proxy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wlan" class="md-nav__link">
    <span class="md-ellipsis">
      Wlan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#firewall_1" class="md-nav__link">
    <span class="md-ellipsis">
      Firewall
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openssh" class="md-nav__link">
    <span class="md-ellipsis">
      OpenSSH
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psremoting-over-ssh" class="md-nav__link">
    <span class="md-ellipsis">
      PSRemoting over SSH
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#winrm" class="md-nav__link">
    <span class="md-ellipsis">
      WinRM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-remote-management-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Remote Management Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kerberos" class="md-nav__link">
    <span class="md-ellipsis">
      Kerberos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#console-download" class="md-nav__link">
    <span class="md-ellipsis">
      Console-Download
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#psdomaintest" class="md-nav__link">
    <span class="md-ellipsis">
      PSDomainTest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#check-host" class="md-nav__link">
    <span class="md-ellipsis">
      Check-Host
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syslog" class="md-nav__link">
    <span class="md-ellipsis">
      Syslog
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Syslog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#psyslog" class="md-nav__link">
    <span class="md-ellipsis">
      pSyslog
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syslog-source-message" class="md-nav__link">
    <span class="md-ellipsis">
      Syslog source message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syslog-type-message" class="md-nav__link">
    <span class="md-ellipsis">
      Syslog type message
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Network</h1>

<h3 id="ping">ping</h3>
<p><code>Test-Connection -Count 1 $srv1, $srv2</code> –æ—Ç–ø—Ä–∞–≤–∏—Ç—å icmp-–ø–∞–∫–µ—Ç –¥–≤—É–º —Ö–æ—Å—Ç–∞–º <br />
<code>Test-Connection $srv -ErrorAction SilentlyContinue</code> –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—å –æ—à–∏–±–æ–∫, –µ—Å–ª–∏ —Ö–æ—Å—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç <br />
<code>Test-Connection -Source $srv1 -ComputerName $srv2</code> –ø–∏–Ω–≥ —Å —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</p>
<pre><code class="language-PowerShell">function Test-PingNetwork {
param (
    [Parameter(Mandatory,ValueFromPipeline)][string[]]$Network,
    [ValidateRange(100,10000)][int]$Timeout = 100
)
$ping = New-Object System.Net.NetworkInformation.Ping
$Network  = $Network -replace &quot;0$&quot;
$net = @()
foreach ($r in @(1..254)) {
    $net += &quot;$network$r&quot;
}
foreach ($n in $net) {
    $ping.Send($n, $timeout) | select @{Name=&quot;Address&quot;; Expression={$n -replace &quot;.+\.&quot;}}, Status
}
}
</code></pre>
<p><code>Test-PingNetwork -Network 192.168.3.0</code> <br />
<code>Test-PingNetwork -Network 192.168.3.0 -Timeout 1000</code></p>
<p><code>Get-CimInstance -Class Win32_PingStatus -Filter "Address='127.0.0.1'"</code> <br />
<code>Get-CimInstance -Class Win32_PingStatus -Filter "Address='127.0.0.1'" | Format-Table -Property Address,ResponseTime,StatusCode -Autosize</code> 0 - —É—Å–ø–µ—Ö <br />
<code>'127.0.0.1','8.8.8.8' | ForEach-Object -Process {Get-CimInstance -Class Win32_PingStatus -Filter ("Address='$_'") | Select-Object -Property Address,ResponseTime,StatusCode}</code> <br />
<code>$ips = 1..254 | ForEach-Object -Process {'192.168.1.' + $_}</code> —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ –∏–∑ ip-–∞–¥—Ä–µ—Å–æ–≤ –ø–æ–¥—Å–µ—Ç–∏</p>
<h3 id="dhcp">dhcp</h3>
<p><code>Get-CimInstance -Class Win32_NetworkAdapterConfiguration -Filter "DHCPEnabled=$true"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∞–¥–∞–ø—Ç–µ—Ä—ã —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º DHCP <br />
<code>$wql = 'SELECT * from Win32_NetworkAdapterConfiguration WHERE IPEnabled=True and DHCPEnabled=False'</code> <br />
<code>Invoke-CimMethod -MethodName ReleaseDHCPLease -Query $wql</code> –≤–∫–ª—é—á–µ–Ω–∏–µ DHCP –Ω–∞ –≤—Å–µ—Ö –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö <br />
<code>Invoke-CimMethod -ClassName Win32_NetworkAdapterConfiguration -MethodName ReleaseDHCPLeaseAll</code> –æ—Ç–º–µ–Ω–∏—Ç—å –∞—Ä–µ–Ω–¥—É –∞–¥—Ä–µ—Å–æ–≤ DHCP –Ω–∞ –≤—Å–µ—Ö –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö <br />
<code>Invoke-CimMethod -ClassName Win32_NetworkAdapterConfiguration -MethodName RenewDHCPLeaseAll</code> –æ–±–Ω–æ–≤–∏—Ç—å –∞—Ä–µ–Ω–¥—É –∞–¥—Ä–µ—Å–æ–≤ DHCP –Ω–∞ –≤—Å–µ—Ö –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö</p>
<h3 id="port">port</h3>
<p><code>tnc $srv -p 5985</code> <br />
<code>tnc $srv -CommonTCPPort WINRM</code> HTTP,RDP,SMB <br />
<code>tnc ya.ru ‚ÄìTraceRoute -Hops 2</code> TTL=2 <br />
<code>tnc ya.ru -DiagnoseRouting</code> –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –¥–æ —Ö–æ—Å—Ç–∞, –∫—É–¥–∞ (DestinationPrefix: 0.0.0.0/0) —á–µ—Ä–µ–∑ (NextHop: 192.168.1.254)</p>
<h3 id="netstat">netstat</h3>
<p><code>netstat -anop tcp</code> -n/-f/-b <br />
<code>Get-NetTCPConnection -State Established,Listen | ? LocalPort -Match 3389</code> <br />
<code>Get-NetTCPConnection -State Established,Listen | ? RemotePort -Match 22</code> <br />
<code>Get-NetUDPEndpoint | ? LocalPort -Match 514</code> netstat -ap udp`</p>
<h3 id="nslookup">nslookup</h3>
<p><code>nslookup ya.ru 1.1.1.1</code> —Å —É–∫–∞–∑–∞–Ω–∏–µ–º DNS —Å–µ—Ä–≤–µ—Ä–∞ <br />
<code>nslookup -type=any ya.ru</code> —É–∫–∞–∑–∞—Ç—å —Ç–∏–ø –∑–∞–ø–∏—Å–∏ <br />
<code>Resolve-DnsName ya.ru -Type MX</code> ALL,ANY,A,NS,SRV,CNAME,PTR,TXT(spf) <br />
<code>[System.Net.Dns]::GetHostEntry("ya.ru")</code></p>
<h3 id="ipconfig">ipconfig</h3>
<p><code>Get-NetIPConfiguration</code> <br />
<code>Get-NetIPConfiguration -InterfaceIndex 14 -Detailed</code></p>
<h3 id="adapter">Adapter</h3>
<p><code>Get-NetAdapter</code> <br />
<code>Set-NetIPInterface -InterfaceIndex 14 -Dhcp Disabled</code> –æ—Ç–∫–ª—é—á–∏—Ç—å DHCP <br />
<code>Get-NetAdapter -InterfaceIndex 14 | New-NetIPAddress ‚ÄìIPAddress 192.168.3.99 -DefaultGateway 192.168.3.1 -PrefixLength 24</code> –∑–∞–¥–∞—Ç—å/–¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP-–∞–¥—Ä–µ—Å <br />
<code>Set-NetIPAddress -InterfaceIndex 14 -IPAddress 192.168.3.98</code> –∏–∑–º–µ–Ω–∏—Ç—å IP-–∞–¥—Ä–µ–∞—Å –Ω–∞ –∞–¥–∞–ø—Ç–µ—Ä–µ <br />
<code>Remove-NetIPAddress -InterfaceIndex 14 -IPAddress 192.168.3.99</code> —É–¥–∞–ª–∏—Ç—å IP-–∞–¥—Ä–µ—Å –Ω–∞ –∞–¥–∞–ø—Ç–µ—Ä–µ <br />
<code>Set-NetIPInterface -InterfaceIndex 14 -Dhcp Enabled</code> –≤–∫–ª—é—á–∏—Ç—å DHCP</p>
<h3 id="dnsclient">DNSClient</h3>
<p><code>Get-DNSClientServerAddress</code> —Å–ø–∏—Å–æ–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –Ω–∞ –Ω–∏—Ö –∞–¥—Ä–µ—Å–∞ DNS —Å–µ—Ä–≤–µ—Ä–∞ <br />
<code>Set-DNSClientServerAddress -InterfaceIndex 14 -ServerAddresses 8.8.8.8</code> –∏–∑–º–µ–Ω–∏—Ç—å –∞–¥—Ä–µ—Å DNS —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ</p>
<h3 id="dnscache">DNSCache</h3>
<p><code>Get-DnsClientCache</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞ DNS <br />
<code>Clear-DnsClientCache</code> –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à</p>
<h3 id="binding">Binding</h3>
<p><code>Get-NetAdapterBinding -Name Ethernet -IncludeHidden -AllBindings</code> <br />
<code>Get-NetAdapterBinding -Name "–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–∞—è —Å–µ—Ç—å" -DisplayName "IP –≤–µ—Ä—Å–∏–∏ 6 (TCP/IPv6)" | Set-NetAdapterBinding -Enabled $false</code> –æ—Ç–∫–ª—é—á–∏—Ç—å IPv6 –Ω–∞ –∞–¥–∞–ø—Ç–µ—Ä–µ</p>
<h3 id="tcpsetting">TCPSetting</h3>
<p><code>Get-NetTCPSetting</code> <br />
<code>Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -CongestionProvider DCTCP</code> –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–æ–π (Congestion Control Provider) –Ω–∞ DCTCP (Data Center TCP) –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–µ–π TCP —Å –∏–º–µ–Ω–∞–º–∏ DatacenterCustom –∏ Datacenter <br />
<code>Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -CwndRestart True</code> –≤–∫–ª—é—á–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –æ–∫–Ω–∞ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ (Congestion Window Restart, CwndRestart) –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π TCP. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–æ—Å–ª–µ –ø–µ—Ä–∏–æ–¥–∞ –∏–¥–ª–µ (–∫–æ–≥–¥–∞ –Ω–µ—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö) TCP –æ–∫–Ω–æ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ –±—É–¥–µ—Ç —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å—Å—è <br />
<code>Set-NetTCPSetting -SettingName DatacenterCustom,Datacenter -ForceWS Disabled</code> –æ—Ç–∫–ª—é—á–∞–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∫–Ω–∞ (Forced Window Scaling) –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π TCP. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∫–Ω–∞ ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ TCP, —á—Ç–æ–±—ã —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–µ—Ç–∏ —Å –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é –∏ –±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π</p>
<h3 id="hostname">hostname</h3>
<p><code>$env:computername</code> <br />
<code>hostname.exe</code> <br />
<code>(Get-CIMInstance CIM_ComputerSystem).Name</code> <br />
<code>(New-Object -ComObject WScript.Network).ComputerName</code> <br />
<code>[System.Environment]::MachineName</code> <br />
<code>[System.Net.Dns]::GetHostName()</code></p>
<h3 id="arp">arp</h3>
<p><code>ipconfig /all | Select-String "—Ñ–∏–∑"</code> grep <br />
<code>Get-NetNeighbor -AddressFamily IPv4</code></p>
<pre><code class="language-PowerShell">function Get-ARP {
    Param (
        $proxy,
        $search
    )
    if (!$proxy) {
        $arp = arp -a
    }
    if ($proxy) {
        $arp = icm $proxy { arp -a }
    }
    $mac = $arp[3..260]
    $mac = $mac -replace &quot;^\s\s&quot;
    $mac = $mac -replace &quot;\s{1,50}&quot;, &quot; &quot;
    $mac_coll = New-Object System.Collections.Generic.List[System.Object]
    foreach ($m in $mac) {
        $smac = $m -split &quot; &quot;
        $mac_coll.Add([PSCustomObject]@{
                IP   = $smac[0];
                MAC  = $smac[1];
                Type = $smac[2]
            })
    }
    if ($search) {
        if ($search -NotMatch &quot;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}&quot;) {
            #$ns = nslookup $search
            #$ns = $ns[-2]
            #$global:ns = $ns -replace &quot;Address:\s{1,10}&quot;
            $rdns = Resolve-DnsName $search -ErrorAction Ignore
            $ns = $rdns.IPAddress
            if ($ns -eq $null) {
                return
            }
        }
        else {
            $ns = $search
        }
        $mac_coll = $mac_coll | ? ip -Match $ns
    }
    $mac_coll
}
</code></pre>
<p><code>Get-ARP -search 192.168.3.100</code> <br />
<code>Get-ARP -search 192.168.3.100 -proxy dc-01</code></p>
<h3 id="network-adapter-statistics">Network Adapter Statistics</h3>
<p><code>netstat -se</code> <br />
<code>Get-NetAdapterStatistics</code></p>
<h3 id="speedtest">SpeedTest</h3>
<pre><code class="language-PowerShell">function Get-SpeedTestOokla {
    param (
        $Server = 3682,
        [switch]$List
    )
    $path = &quot;$env:TEMP\speedtest.exe&quot;
    $testPath = Test-Path &quot;$env:TEMP\speedtest.exe&quot;
    if ($testPath -eq $false) {
        Invoke-RestMethod https://install.speedtest.net/app/cli/ookla-speedtest-1.2.0-win64.zip -OutFile &quot;$env:TEMP\speedtest.zip&quot;
        Expand-Archive &quot;$env:TEMP\speedtest.zip&quot; -DestinationPath $env:TEMP
    }
    if ($List) {
        $(&amp; $path -L -f json | ConvertFrom-Json).servers
    } else {
        $test = &amp; $path -s $Server -f json
        $Collections = New-Object System.Collections.Generic.List[System.Object]
        $Collections.Add(
            [PSCustomObject]@{
                Date = $($test | ConvertFrom-Json).timestamp
                Url = $($test | ConvertFrom-Json).result.url
                Download = [double]::Round($($($test | ConvertFrom-Json).download.bandwidth / 1mb * 8), 2)
                Upload = [double]::Round($($($test | ConvertFrom-Json).upload.bandwidth / 1mb * 8), 2)
                Ping = $($test | ConvertFrom-Json).ping.latency
                Internal_IP = $($test | ConvertFrom-Json).interface.internalIp
                External_IP = $($test | ConvertFrom-Json).interface.externalIp
                Server = $($test | ConvertFrom-Json).server
            }
        )
        $Collections
    }
}
</code></pre>
<h3 id="iperf">iPerf</h3>
<h3 id="install">Install</h3>
<pre><code class="language-PowerShell">$url = $($(Invoke-RestMethod https://api.github.com/repos/ar51an/iperf3-win-builds/releases/latest).assets | Where-Object name -match &quot;win64.zip&quot;).browser_download_url
Invoke-RestMethod $url -OutFile $home\Downloads\iperf.zip
New-Item &quot;$home\Documents\iperf3&quot; -Type Directory | Out-Null
Expand-Archive -Path &quot;$home\Downloads\iperf.zip&quot; -OutputPath &quot;$home\Documents\iperf3&quot;
Remove-Item &quot;$home\Downloads\iperf*&quot; -Force -Recurse
</code></pre>
<p><code>&amp; "$home\Documents\iperf3\iperf3.exe" -h</code></p>
<h3 id="env-update-exec-path">Env-Update-Exec-Path</h3>
<pre><code class="language-PowerShell">$EnvPath = [Environment]::GetEnvironmentVariable(&quot;Path&quot;, [EnvironmentVariableTarget]::Machine)
$EnvPath -split &quot;;&quot;
$iperfPath = &quot;$home\Documents\iperf3\&quot;
$EnvAddPath = $EnvPath + &quot;;&quot; + $iperfPath
[Environment]::SetEnvironmentVariable(&quot;Path&quot;, $EnvAddPath, [EnvironmentVariableTarget]::Machine)
$([Environment]::GetEnvironmentVariable(&quot;Path&quot;, [EnvironmentVariableTarget]::Machine)) -split &quot;;&quot;
</code></pre>
<p><code>iperf3 -h</code></p>
<h3 id="iperf-gui">iPerf-GUI</h3>
<p><code>Invoke-RestMethod "https://github.com/Lifailon/iPerf-GUI/raw/rsa/iPerf-GUI-Install.exe" -OutFile "$home\Downloads\iPerf-GUI-Install.exe"</code> —Å–∫–∞—á–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—É—é –≤–µ—Ä—Å–∏—é —Å–æ–±—Ä–∞–Ω–Ω—É—é —Å –ø–æ–º–æ—â—å—é WinRAR <br />
<code>Start-Process -FilePath "$home\Downloads\iPerf-GUI-Install.exe" -ArgumentList "/S" -NoNewWindow -Wait</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ —Ç–∏—Ö–æ–º —Ä–µ–∂–∏–º–µ</p>
<h3 id="iperf-docker">iPerf-Docker</h3>
<pre><code class="language-PowerShell">echo '
FROM alpine:latest
RUN apk update &amp;&amp; apk add --no-cache iperf3
ENV PORT=5201
EXPOSE $PORT
CMD [&quot;sh&quot;, &quot;-c&quot;, &quot;iperf3 -s -p $PORT&quot;]
' &gt; Dockerfile
</code></pre>
<p><code>docker build -t iperf3-alpine-server .</code> <br />
<code>docker run -d -p 5201:5201 --name iperf3-alpine-server iperf3-alpine-server</code></p>
<h3 id="server">Server</h3>
<p><code>iperf3 -s</code> –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ <br />
<code>iperf3 -s -D</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –∫–∞–∫ —Å–ª—É–∂–±—É (--daemon) <br />
<code>Get-NetTCPConnection -State Established,Listen | ? LocalPort -Match 5201</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ —Å–ª—É—à–∞–µ—Ç <br />
<code>Get-Process -Id $(Get-NetTCPConnection -State Established,Listen | ? LocalPort -Match 5201).OwningProcess</code> –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –ø–æ –ø–æ—Ä—Ç—É <br />
<code>Get-Process iperf3 | Stop-Process</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å <br />
<code>iperf3 -s -D --logfile "$home\Documents\iperf3\iperf3.log"</code> –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –≤—ã–≤–æ–¥ –≤ –ª–æ–≥ —Ñ–∞–π–ª <br />
<code>iperf3 -s -p 5211</code> —É–∫–∞–∑–∞—Ç—å –ø–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Å–ª—É—à–∞—Ç—å —Å–µ—Ä–≤–µ—Ä –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫–ª–∏–µ–Ω—Ç <br />
<code>iperf3 -s -p 5211 -f M</code> –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∏–∑–º–µ—Ä—è—Ç—å –≤ –±–∞–π—Ç–∞—Ö –∞ –Ω–µ –≤ –±–∏—Ç–∞—Ö, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: K,M,G,T) <br />
<code>iperf3 -s -p 5211 -f M -J</code> –≤—ã–≤–æ–¥ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json <br />
<code>iperf3 -s -p 5211 -f M -V</code> –≤—ã–≤–æ–¥ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</p>
<h3 id="client">Client</h3>
<p><code>iperf3 -c 192.168.3.100 -p 5211</code> –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –æ—Ç–¥–∞—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å –∫–ª–∏–µ–Ω—Ç–∞) <br />
<code>iperf3 -c 192.168.3.100 -p 5211 -R</code> –æ–±—Ä–∞—Ç–Ω—ã–π —Ç–µ—Å—Ç, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–∞ (--reverse, —Å–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—É) <br />
<code>iperf3 -c 192.168.3.100 -p 5211 -R -P 2</code> –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ ([SUM] - —Å—É–º–º–∞—Ä–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏ –ø–æ—Ç–æ–∫–æ–≤) <br />
<code>iperf3 -c 192.168.3.100 -p 5211 -R -4</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ IPv4 <br />
<code>iperf3 -c 192.168.3.100 -p 5211 -R -u</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UDP –≤–º–µ—Å—Ç–æ TCP <br />
<code>iperf3 -c 192.168.3.100 -p 5211 -R -u -b 2mb</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏—Ç—Ä–µ–π—Ç –≤ 2.00 Mbits/sec –¥–ª—è UDP (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1 –ú–±–∏—Ç/—Å–µ–∫, –¥–ª—è TCP –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ) <br />
<code>iperf3 -c 192.168.3.100 -p 5211 -R -t 30</code> –≤—Ä–µ–º—è –æ–¥–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10 —Å–µ–∫—É–Ω–¥) <br />
<code>iperf3 -c 192.168.3.100 -p 5211 -R -n 1gb</code> —É–∫–∞–∑–∞—Ç—å –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ –≤—Ä–µ–º–µ–Ω–∏ -t) <br />
<code>iperf3 -c 192.168.3.100 -p 5211 -R --get-server-output</code> –≤—ã–≤–µ—Å—Ç–∏ –≤—ã–≤–æ–¥ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ</p>
<h3 id="output">Output</h3>
<p><code>sender</code> upload (—Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä) <br />
<code>receiver</code> download (—Å–∫–æ—Ä–æ—Å—Ç—å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Å —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞) <br />
<code>Interval</code> –æ–±—â–µ–µ –≤—Ä–µ–º—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è <br />
<code>Transfer</code> –∫–æ–ª-–≤–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ú–ë–∞–π—Ç <br />
<code>Bandwidth</code> —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ (–∏–∑–º–µ—Ä—è–µ—Ç—Å—è –≤ –ú–±–∏—Ç/c)</p>
<h3 id="ps-iperf">PS-iPerf</h3>
<p><code>Install-Module ps-iperf -Repository NuGet</code> <br />
<code>Import-Module PS-iPerf</code> <br />
<code>Start-iPerfServer -Port 5211</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä <br />
<code>Get-iPerfServer</code> —Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞ <br />
<code>Stop-iPerfServer</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä <br />
<code>Connect-iPerfServer -Server 192.168.3.100 -Port 5211 -MBytes 500 -Download</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ —Å–∫–∞—á–∞—Ç—å 500 –ú–ë–∞–π—Ç <br />
<code>$SpeedTest = Connect-iPerfServer -Server 192.168.3.100 -Port 5211 -MBytes 500 -LogWrite</code> –ø–µ—Ä–µ–¥–∞—Ç—å 500 –ú–ë–∞–π—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–≤–µ—Å—Ç–∏ –∑–∞–ø–∏—Å—å –≤ –ª–æ–≥-—Ñ–∞–π–ª) <br />
<code>$SpeedTest.Intervals</code> –º–µ—Ç—Ä–∏–∫–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π <br />
<code>Get-iPerfLog</code> –ø—Ä–æ—á–∏—Ç–∞—Ç—å –ª–æ–≥-—Ñ–∞–π–ª</p>
<h3 id="firewall">Firewall</h3>
<pre><code class="language-PowerShell">$days = 5
$obj = @()
$fw = Get-WinEvent &quot;Microsoft-Windows-Windows Firewall With Advanced Security/Firewall&quot;
foreach ($temp_fw in $fw) {
if ($temp_fw.id -eq 2097) { # 2004
    $type = &quot;Added Rule&quot;
}
elseif ($temp_fw.id -eq 2006) {
    $type = &quot;Deleted Rule&quot;
}
$port = $temp_fw.Properties[7] | select -ExpandProperty value
$name = $temp_fw.Properties[1] | select -ExpandProperty value
$obj += [PSCustomObject]@{
    Time = $temp_fw.TimeCreated;
    Type = $type;
    Port = $port;
    Name = $name}
}
$obj | Where-Object time -gt (Get-Date).AddDays(-$days)
</code></pre>
<p><code>New-NetFirewallRule -Profile Any -DisplayName "Open Port 135 RPC" -Direction Inbound -Protocol TCP -LocalPort 135</code> –æ—Ç–∫—Ä—ã—Ç—å in-–ø–æ—Ä—Ç <br />
<code>Get-NetFirewallRule | where DisplayName -match kms | select *</code> –Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª–æ –ø–æ –∏–º–µ–Ω–∏ <br />
<code>Get-NetFirewallPortFilter | where LocalPort -like 80</code> –Ω–∞–π—Ç–∏ –¥–µ–π—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∞–≤–∏–ª–æ –ø–æ –Ω–æ–º–µ—Ä—É –ø–æ—Ä—Ç–∞</p>
<pre><code class="language-PowerShell">Get-NetFirewallRule -Enabled True -Direction Inbound | select -Property DisplayName,
@{Name='Protocol';Expression={($_ | Get-NetFirewallPortFilter).Protocol}},
@{Name='LocalPort';Expression={($_ | Get-NetFirewallPortFilter).LocalPort}},
@{Name='RemotePort';Expression={($_ | Get-NetFirewallPortFilter).RemotePort}},
@{Name='RemoteAddress';Expression={($_ | Get-NetFirewallAddressFilter).RemoteAddress}},
Enabled,Profile
</code></pre>
<h3 id="firewall-manager">Firewall-Manager</h3>
<p><code>Install-Module Firewall-Manager</code> <br />
<code>Export-FirewallRules -Name * -CSVFile $home\documents\fw.csv</code> -Inbound -Outbound -Enabled -Disabled -Allow -Block (—Ñ–∏–ª—å—Ç—Ä –ø—Ä–∞–≤–∏–ª –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞) <br />
<code>Import-FirewallRules -CSVFile $home\documents\fw.csv</code></p>
<h3 id="rdp">RDP</h3>
<p><code>Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "PortNumber"</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ RDP –ø–æ—Ä—Ç–∞ <br />
<code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "PortNumber" -Value "3390"</code> –∏–∑–º–µ–Ω–∏—Ç—å RDP-–ø–æ—Ä—Ç <br />
<code>$(Get-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server\" -Name "fDenyTSConnections").fDenyTSConnections</code> –µ—Å–ª–∏ 0, —Ç–æ –≤–∫–ª—é—á–µ–Ω <br />
<code>Set-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server\" -Name "fDenyTSConnections" -Value 0</code> –≤–∫–ª—é—á–∏—Ç—å RDP <br />
<code>reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f</code> <br />
<code>(gcim -Class Win32_TerminalServiceSetting -Namespace root\CIMV2\TerminalServices).SetAllowTSConnections(0)</code> –≤–∫–ª—é—á–∏—Ç—å RDP (–¥–ª—è Windows Server) <br />
<code>Get-Service TermService | Restart-Service -Force</code> –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å rdp-—Å–ª—É–∂–±—É <br />
<code>New-NetFirewallRule -Profile Any -DisplayName "RDP 3390" -Direction Inbound -Protocol TCP -LocalPort 3390</code> –æ—Ç–∫—Ä—ã—Ç—å RDP-–ø–æ—Ä—Ç</p>
<h3 id="ipban">IPBan</h3>
<p><code>auditpol /get /category:*</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –∞—É–¥–∏—Ç–∞ <br />
<code>auditpol /get /category:–í—Ö–æ–¥/–≤—ã—Ö–æ–¥</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –∞—É–¥–∏—Ç–∞ –¥–ª—è –í—Ö–æ–¥–∞ –∏ –í—ã—Ö–æ–¥–∞ –∏–∑ —Å–∏—Å—Ç–µ–º—ã <br />
<code>auditpol /set /subcategory:"–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É" /success:enable /failure:enable</code> –≤–∫–ª—é—á–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ - –ê—É–¥–∏—Ç –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É <br />
<code>auditpol /set /subcategory:"–í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã" /success:enable /failure:enable</code></p>
<p><code>$url = $($(Invoke-RestMethod https://api.github.com/repos/DigitalRuby/IPBan/releases/latest).assets | Where-Object name -match ".+win.+x64.+").browser_download_url</code> –ø–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ <br />
<code>$version = $(Invoke-RestMethod https://api.github.com/repos/DigitalRuby/IPBan/releases/latest).tag_name</code> –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ <br />
<code>$path = "$home\Documents\ipban-$version"</code> –ø—É—Ç—å –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ <br />
<code>Invoke-RestMethod $url -OutFile "$home\Downloads\IPBan-$version.zip"</code> —Å–∫–∞—á–∞—Ç—å –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ <br />
<code>Expand-Archive "$home\Downloads\ipban-$version.zip" -DestinationPath $path</code> —Ä–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—É—Ç—å –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ <br />
<code>Remove-Item "$home\Downloads\ipban-$version.zip"</code> —É–¥–∞–ª–∏—Ç—å –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ <br />
<code>sc create IPBan type=own start=delayed-auto binPath="$path\DigitalRuby.IPBan.exe" DisplayName=IPBan</code> —Å–æ–∑–¥–∞—Ç—å —Å–ª—É–∂–±—É <br />
<code>Get-Service IPBan</code> —Å—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã <br />
<code>$conf = $(Get-Content "$path\ipban.config")</code> —á–∏—Ç–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é <br />
<code>$conf = $conf -replace '&lt;add key="Whitelist" value=""/&gt;','&lt;add key="Whitelist" value="192.168.3.0/24"/&gt;'</code> –¥–æ–±–∞–≤–∏—Ç—å –≤ –±–µ–ª—ã–π –ª–∏—Å—Ç –¥–æ–º–∞—à–Ω—é—é —Å–µ—Ç—å –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è <br />
<code>$conf = $conf -replace '&lt;add key="ProcessInternalIPAddresses" value="false"/&gt;','&lt;add key="ProcessInternalIPAddresses" value="true"/&gt;'</code> –≤–∫–ª—é—á–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ª–æ–∫–∞–ª—å–Ω—ã—Ö (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö) ip-–∞–¥—Ä–µ—Å–æ–≤ <br />
<code>$conf = $conf -replace '&lt;add key="FailedLoginAttemptsBeforeBanUserNameWhitelist" value="20"/&gt;','&lt;add key="FailedLoginAttemptsBeforeBanUserNameWhitelist" value="5"/&gt;'</code> —É–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ <br />
<code>$conf = $conf -replace '&lt;add key="ExpireTime" value="01:00:00:00"/&gt;','&lt;add key="ExpireTime" value="00:01:00:00"/&gt;'</code> –∑–∞–¥–∞—Ç—å –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ 1 —á–∞—Å <br />
<code>$conf &gt; "$path\ipban.config"</code> –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é <br />
<code>Get-Service IPBan | Start-Service</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É</p>
<pre><code>Get-NetFirewallRule | Where-Object DisplayName -Match &quot;IPBan&quot; | ForEach-Object {
    $Name = $_.DisplayName
    Get-NetFirewallAddressFilter -AssociatedNetFirewallRule $_ | Select-Object @{Name=&quot;Name&quot;; Expression={$Name}},LocalIP,RemoteIP
} # –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –æ–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª –ë—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ –¥–ª—è IPBan
</code></pre>
<p><code>Get-Content -Wait "$path\logfile.txt"</code> —á–∏—Ç–∞—Ç—å –ª–æ–≥ <br />
<code>Get-Service IPBan | Stop-Service</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂–±—É <br />
<code>sc delete IPBan</code> —É–¥–∞–ª–∏—Ç—å —Å–ª—É–∂–±—É</p>
<h3 id="shutdown">shutdown</h3>
<p><code>shutdown /r /o</code> –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º <br />
<code>shutdown /s /t 600 /c "Power off after 10 minutes"</code> –≤—ã–∫–ª—é—á–µ–Ω–∏–µ <br />
<code>shutdown /s /f</code> –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π <br />
<code>shutdown /a</code> –æ—Ç–º–µ–Ω–∞ <br />
<code>shutdown /r /t 0 /m \\192.168.3.100</code> <br />
<code>Restart-Computer -ComputerName 192.168.3.100 -Protocol WSMan</code> —á–µ—Ä–µ–∑ WinRM <br />
<code>Restart-Computer ‚ÄìComputerName 192.168.3.100 ‚ÄìForce</code> —á–µ—Ä–µ–∑ WMI <br />
<code>Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\Start\HideShutDown" -Name "value" -Value 1</code> —Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –≤—ã–∫–ª—é—á–µ–Ω–∏—è <br />
<code>Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\PolicyManager\default\Start\HideRestart" -Name "value" -Value 1</code> —Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏</p>
<pre><code class="language-PowerShell">function Start-Shutdown {
    &lt;#
    .SYNOPSIS
    Module for shutdown and restart the computer at a specified time
    .DESCRIPTION
    Example:
    # Start-Shutdown -Time &quot;18:00&quot;
    # Start-Shutdown -Restart -Time &quot;18:00&quot;
    # Start-Shutdown -Cancel
    .LINK
    https://github.com/Lifailon/PS-Commands
    #&gt;
    param(
        [string]$Time,
        [switch]$Restart,
        [switch]$Cancel
    )
    if ($Time) {
        $currentDateTime = Get-Date
        $shutdownTime = Get-Date $Time
        if ($shutdownTime -lt $currentDateTime) {
            $shutdownTime = $shutdownTime.AddDays(1)
        }
        $timeUntilShutdown = $shutdownTime - $currentDateTime
        $secondsUntilShutdown = [math]::Round($timeUntilShutdown.TotalSeconds)
    }
    if ($Cancel) {
        Start-Process -FilePath &quot;shutdown.exe&quot; -ArgumentList &quot;/a&quot;
    } elseif ($Restart) {
        Write-Host &quot;The computer will restart after $($timeUntilShutdown.Hours) hours and $($timeUntilShutdown.Minutes) minutes.&quot;
        Start-Process -FilePath &quot;shutdown.exe&quot; -ArgumentList &quot;/r&quot;, &quot;/f&quot;, &quot;/t&quot;, &quot;$secondsUntilShutdown&quot;
    } else {
        Write-Host &quot;The computer will shutdown after $($timeUntilShutdown.Hours) hours and $($timeUntilShutdown.Minutes) minutes.&quot;
        Start-Process -FilePath &quot;shutdown.exe&quot; -ArgumentList &quot;/s&quot;, &quot;/f&quot;, &quot;/t&quot;, &quot;$secondsUntilShutdown&quot;
    }
}
</code></pre>
<h3 id="udp-socket">UDP-Socket</h3>
<p><a href="https://cloudbrothers.info/en/test-udp-connection-powershell/">Source</a></p>
<pre><code class="language-PowerShell">function Start-UDPServer {
    param(
        $Port = 5201
    )
    $RemoteComputer = New-Object System.Net.IPEndPoint([System.Net.IPAddress]::Any, 0)
    do {
        $UdpObject = New-Object System.Net.Sockets.UdpClient($Port)
        $ReceiveBytes = $UdpObject.Receive([ref]$RemoteComputer)
        $UdpObject.Close()
        $ASCIIEncoding = New-Object System.Text.ASCIIEncoding
        [string]$ReturnString = $ASCIIEncoding.GetString($ReceiveBytes)
        [PSCustomObject]@{
            LocalDateTime = $(Get-Date -UFormat &quot;%Y-%m-%d %T&quot;)
            ClientIP      = $RemoteComputer.address.ToString()
            ClientPort    = $RemoteComputer.Port.ToString()
            Message       = $ReturnString
        }
    } while (1)
}
</code></pre>
<p><code>Start-UDPServer -Port 5201</code></p>
<h3 id="test-netudpconnection">Test-NetUDPConnection</h3>
<pre><code class="language-PowerShell">function Test-NetUDPConnection {
    param(
        [string]$ComputerName = &quot;127.0.0.1&quot;,
        [int32]$PortServer = 5201,
        [int32]$PortClient = 5211,
        $Message
    )
    begin {
        $UdpObject = New-Object system.Net.Sockets.Udpclient($PortClient)
        $UdpObject.Connect($ComputerName, $PortServer)
    }
    process {
        $ASCIIEncoding = New-Object System.Text.ASCIIEncoding
        if (!$Message) { $Message = Get-Date -UFormat &quot;%Y-%m-%d %T&quot; }
        $Bytes = $ASCIIEncoding.GetBytes($Message)
        [void]$UdpObject.Send($Bytes, $Bytes.length)
    }
    end {
        $UdpObject.Close()
    }
}
</code></pre>
<p><code>Test-NetUDPConnection -ComputerName 127.0.0.1 -PortServer 5201</code> <br />
<code>Test-NetUDPConnection -ComputerName 127.0.0.1 -PortServer 514 -Message "&lt;30&gt;May 31 00:00:00 HostName multipathd[784]: Test message"</code></p>
<h3 id="tcp-socket">TCP-Socket</h3>
<pre><code class="language-PowerShell">function Start-TCPServer {
    param(
        $Port = 5201
    )
    do {
        $TcpObject = New-Object System.Net.Sockets.TcpListener($port)
        $ReceiveBytes = $TcpObject.Start()
        $ReceiveBytes = $TcpObject.AcceptTcpClient()
        $TcpObject.Stop()
        $ReceiveBytes.Client.RemoteEndPoint | select Address, Port
    } while (1)
}
</code></pre>
<p><code>Start-TCPServer -Port 5201</code> <br />
<code>Test-NetConnection -ComputerName 127.0.0.1 -Port 5201</code></p>
<h3 id="wakeonlan">WakeOnLan</h3>
<p>Broadcast package consisting of 6 byte filled "0xFF" and then 96 byte where the mac address is repeated 16 times</p>
<pre><code class="language-PowerShell">function Send-WOL {
    param (
        [Parameter(Mandatory = $True)]$Mac,
        $IP,
        [int]$Port = 9
    )
    $Mac = $Mac.replace(&quot;:&quot;, &quot;-&quot;)
    if (!$IP) { $IP = [System.Net.IPAddress]::Broadcast }
    $SynchronizationChain = [byte[]](, 0xFF * 6)
    $ByteMac = $Mac.Split(&quot;-&quot;) | % { [byte](&quot;0x&quot; + $_) }
    $Package = $SynchronizationChain + ($ByteMac * 16)
    $UdpClient = New-Object System.Net.Sockets.UdpClient
    $UdpClient.Connect($IP, $port)
    $UdpClient.Send($Package, $Package.Length)
    $UdpClient.Close()
}
</code></pre>
<p><code>Send-WOL -Mac "D8-BB-C1-70-A3-4E"</code> <br />
<code>Send-WOL -Mac "D8-BB-C1-70-A3-4E" -IP 192.168.3.100</code></p>
<h3 id="httplistener">HTTPListener</h3>
<pre><code class="language-PowerShell">$httpListener = New-Object System.Net.HttpListener
$httpListener.Prefixes.Add(&quot;http://+:8888/&quot;)
$httpListener.Start()
while (!([console]::KeyAvailable)) {
    $info = Get-Service | select name, status | ConvertTo-HTML
    $context = $httpListener.GetContext()
    $context.Response.StatusCode = 200
    $context.Response.ContentType = 'text/HTML'
    $WebContent = $info
    $EncodingWebContent = [Text.Encoding]::UTF8.GetBytes($WebContent)
    $context.Response.OutputStream.Write($EncodingWebContent , 0, $EncodingWebContent.Length)
    $context.Response.Close()
    Get-NetTcpConnection -LocalPort 8888
(Get-Date).datetime
}
$httpListener.Close()
</code></pre>
<h3 id="webclient">WebClient</h3>
<p><code>[System.Net.WebClient] | Get-Member</code> <br />
<code>(New-Object Net.WebClient).DownloadString("https://raw.githubusercontent.com/Lifailon/PowerShell-Commands/rsa/README.md")</code></p>
<h3 id="httpclient">HttpClient</h3>
<pre><code class="language-PowerShell">$url = &quot;https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip&quot;
$path = &quot;$home\Downloads\$(Split-Path -Path $url -Leaf)&quot;
$httpClient = [System.Net.Http.HttpClient]::new()
# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ GET-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ (—Å—á–∏—Ç—ã–≤–∞—è –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞)
$response = $httpClient.GetAsync($url, [System.Net.Http.HttpCompletionOption]::ResponseHeadersRead).Result
# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞
$stream = $response.Content.ReadAsStreamAsync().Result
# –û—Ç–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏
$fileStream = [System.IO.File]::OpenWrite($path)
try {
    # –°–æ–∑–¥–∞–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ —Ä–∞–∑–º–µ—Ä–æ–º 81920 –±–∞–π—Ç (80 –ö–ë) –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–æ—Ç–æ–∫–∞
    $buffer = New-Object byte[] 81920
    # –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–æ—Ç–æ–∫–∞ –∏ –∑–∞–ø–∏—Å—å –∏—Ö –≤ —Ñ–∞–π–ª
    while (($bytesRead = $stream.Read($buffer, 0, $buffer.Length)) -ne 0) {
        $fileStream.Write($buffer, 0, $bytesRead)
    }
}
finally {
    # –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø–æ—Ç–æ–∫–∞–º–∏
    $stream.Dispose()
    $fileStream.Dispose()
}
</code></pre>
<h3 id="certificate">Certificate</h3>
<pre><code class="language-PowerShell">function Get-WebCertificate ($srv) {
    $iwr = iwr $srv
    $status_code = $iwr.StatusCode
    $status = $iwr.BaseResponse.StatusCode
    $info = $iwr.BaseResponse.Server
    $spm = [System.Net.ServicePointManager]::FindServicePoint($srv)
    $date_end = $spm.Certificate.GetExpirationDateString()
    $cert_name = ($spm.Certificate.Subject) -replace &quot;CN=&quot;
    $cert_owner = ((($spm.Certificate.Issuer) -split &quot;, &quot;) | where { $_ -match &quot;O=&quot; }) -replace &quot;O=&quot;
    $Collections = New-Object System.Collections.Generic.List[System.Object]
    $Collections.Add([PSCustomObject]@{
            Host        = $srv;
            Server      = $info;
            Status      = $status;
            StatusCode  = $status_code;
            Certificate = $cert_name;
            Issued      = $cert_owner;
            End         = $date_end
        })
    $Collections
}
</code></pre>
<p><code>Get-WebCertificate https://google.com</code></p>
<h3 id="openvpn">OpenVPN</h3>
<p><code>Invoke-WebRequest -Uri https://swupdate.openvpn.org/community/releases/OpenVPN-2.6.5-I001-amd64.msi -OutFile $home\Downloads\OpenVPN-2.6.5.msi</code> <br />
<code>Start-Process $home\Downloads\OpenVPN-2.6.5.msi -ArgumentList '/quiet /SELECT_OPENSSL_UTILITIES=1' -Wait</code> <br />
<code>msiexec /i $home\Downloads\OpenVPN-2.6.5.msi ADDLOCAL=EasyRSA /passive /quiet # —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç EasyRSA Certificate Management Scripts</code> <br />
<code># msiexec /i $home\Downloads\OpenVPN-2.6.5.msi ADDLOCAL=OpenVPN.Service,Drivers,Drivers.Wintun,OpenVPN,OpenVPN.GUI,OpenVPN.GUI.OnLogon,EasyRSA /passive</code> –≤—ã–±–æ—Ä–æ—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ <br />
<code># Invoke-WebRequest -Uri https://github.com/OpenVPN/easy-rsa/releases/download/v3.1.5/EasyRSA-3.1.5-win64.zip -OutFile $home\Downloads\EasyRSA-3.1.5.zip</code> —Å–∫–∞—á–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç EasyRSA <br />
<code>rm $home\Downloads\OpenVPN-2.6.5.msi</code></p>
<p><code>cd "C:\Program Files\OpenVPN\easy-rsa"</code> <br />
<code>Copy-Item vars.example vars</code> —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è EasyRSA</p>
<pre><code>set_var EASYRSA_TEMP_DIR &quot;$EASYRSA_PKI&quot;
set_var EASYRSA_REQ_COUNTRY &quot;RU&quot;
set_var EASYRSA_REQ_PROVINCE &quot;MSK&quot;
set_var EASYRSA_REQ_CITY &quot;MSK&quot;
set_var EASYRSA_REQ_ORG &quot;FAILON.NET&quot;
set_var EASYRSA_REQ_EMAIL &quot;lifailon@domain.ru&quot;
set_var EASYRSA_REQ_OU &quot;IT&quot;
#set_var EASYRSA_KEY_SIZE 2048
#set_var EASYRSA_CA_EXPIRE 3650
#set_var EASYRSA_CERT_EXPIRE 825
</code></pre>
<p><code>.\EasyRSA-Start.bat</code> —Å—Ä–µ–¥–∞ EasyRSA Shell <br />
<code>easyrsa init-pki</code> –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PKI, —Å–æ–∑–¥–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: C:\Program Files\OpenVPN\easy-rsa\pki –∏ —á–∏—Ç–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞ \easy-rsa\vars <br />
<code>easyrsa build-ca</code> –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ—Ä–Ω–µ–≤–æ–≥–æ CA —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–∞—Ä–æ–ª—è –∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∏–º—è —Å–µ—Ä–≤–µ—Ä–∞ (\pki\ca.crt –∏ \pki\private\ca.key) <br />
<code>easyrsa gen-req server nopass</code> –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∏ –∫–ª—é—á –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ OpenVPN - yes (\pki\reqs\server.req –∏ \pki\private\server.key) <br />
<code>easyrsa sign-req server server</code> –ø–æ–¥–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–ø—É—Å–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ —Å –ø–æ–º–æ—â—å—é CA - yes (\pki\issued\server.crt) <br />
<code>easyrsa gen-dh</code> —Å–æ–∑–¥–∞—Ç—å –∫–ª—é—á –î–∏—Ñ—Ñ–∏-–•–µ–ª–ª–º–∞–Ω–∞ (\pki\dh.pem) <br />
<code>easyrsa gen-req client1</code> nopass<code>–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∏ –∫–ª—é—á –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ OpenVPN (\pki\reqs\client1.req –∏ \pki\private\client1.key)</code> <br />
<code>easyrsa sign-req client client1</code> –ø–æ–¥–ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–ø—É—Å–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ —Å –ø–æ–º–æ—â—å—é CA - yes (\pki\issued\client1.crt) <br />
<code>easyrsa revoke client1</code> –æ—Ç–æ–∑–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code>openssl rsa -in "C:\Program Files\OpenVPN\easy-rsa\pki\private\client1.key" -out "C:\Program Files\OpenVPN\easy-rsa\pki\private\client1_nopass.key"</code> —Å–Ω—è—Ç—å –∑–∞—â–∏—Ç—É –ø–∞—Ä–æ–ª–µ–º –¥–ª—è –∫–ª—é—á–∞ (BEGIN ENCRYPTED PRIVATE KEY -&gt; BEGIN PRIVATE KEY) <br />
<code>exit</code> <br />
<code>cd "C:\Program Files\OpenVPN\bin"</code> <br />
<code>.\openvpn --genkey secret ta.key</code> –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ tls-auth (\bin\ta.key) <br />
<code>Move-Item "C:\Program Files\OpenVPN\bin\ta.key" "C:\Program Files\OpenVPN\easy-rsa\pki\"</code></p>
<h3 id="serverovpn">server.ovpn</h3>
<p><code># Copy-Item "C:\Program Files\OpenVPN\sample-config\server.ovpn" "C:\Program Files\OpenVPN\config-auto\server.ovpn"</code> <br />
<code>New-Item -ItemType File -Path "C:\Program Files\OpenVPN\config-auto\server.ovpn"</code></p>
<pre><code>port 1194
proto udp
# –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç—É–Ω–Ω–µ–ª–µ (ethernet —Ñ—Ä–µ–π–º—ã - tap –∏–ª–∏ ip –ø–∞–∫–µ—Ç—ã - tun)
dev tun
ca &quot;C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\ca.crt&quot;
cert &quot;C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\issued\\server.crt&quot;
key &quot;C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\private\\server.key&quot;
dh &quot;C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\dh.pem&quot;
server 192.168.4.0 255.255.255.0
# –•—Ä–∞–Ω–∏—Ç —Å–ø–∏—Å–æ–∫ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è ip –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤, —á—Ç–æ –±—ã –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ç–æ—Ç –∂–µ –∞–¥—Ä–µ—Å –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
# ifconfig-pool-persist &quot;C:\\Program Files\\OpenVPN\\dhcp-client-list.txt&quot;
# –†–∞–∑—Ä–µ—à–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞–º –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –ø–æ–¥ –æ–¥–Ω–∏–º –∫–ª—é—á–æ–º
# duplicate-cn
# max-clients 30
# –†–∞–∑—Ä–µ—à–∏—Ç—å –æ–±–º–µ–Ω —Ç—Ä–∞—Ñ–∏–∫–æ–º –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏
client-to-client
# compress
tls-auth &quot;C:\\Program Files\\OpenVPN\\easy-rsa\\pki\\ta.key&quot; 0
cipher AES-256-GCM
keepalive 20 60
# –ù–µ –ø–µ—Ä–µ—á–∏—Ç–∞–≤–∞—Ç—å —Ñ–∞–π–ª—ã –∫–ª—é—á–µ–π –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Ç—É–Ω–Ω–µ–ª—è
persist-key
# –û—Å—Ç–∞–≤–ª—è–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ tun/tap –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ OpenVPN
persist-tun
status &quot;C:\\Program Files\\OpenVPN\\log\\status.log&quot;
log &quot;C:\\Program Files\\OpenVPN\\log\\openvpn.log&quot;
verb 3
mute 20
windows-driver wintun
# –û—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–æ–¥—Å–µ—Ç–∏ –∑–∞ —Å–µ—Ä–≤–µ—Ä–æ–º
push &quot;route 192.168.3.0 255.255.255.0&quot;
push &quot;route 192.168.4.0 255.255.255.0&quot;
# –ó–∞–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫–ª–∏–µ–Ω—Ç–∞ (–≤ —Ç–æ–º —á–∏—Å–ª–µ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Ç—Ä–∞—Ñ–∏–∫) –Ω–∞ OpenVPN —Å–µ—Ä–≤–µ—Ä
# push &quot;redirect-gateway def1&quot;
# push &quot;dhcp-option DNS 192.168.3.101&quot;
# push &quot;dhcp-option DOMAIN failon.net&quot;
</code></pre>
<p><code>New-NetFirewallRule -DisplayName "AllowOpenVPN-In" -Direction Inbound -Protocol UDP ‚ÄìLocalPort 1194 -Action Allow</code> –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ <br />
<code>New-NetFirewallRule -DisplayName "AllowOpenVPN-Out" -Direction Outbound -Protocol UDP ‚ÄìLocalPort 1194 -Action Allow</code> –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ <br />
<code>Get-Service *openvpn* | Restart-Service</code></p>
<h3 id="clientovpn">client.ovpn</h3>
<p><code># Copy-Item "C:\Program Files\OpenVPN\sample-config\client.ovpn" "C:\Program Files\OpenVPN\config-auto\client.ovpn"</code> <br />
<code>New-Item -ItemType File -Path "C:\Program Files\OpenVPN\config-auto\client.ovpn"</code></p>
<pre><code>client
dev tun
proto udp
remote 26.115.154.67 1194
resolv-retry infinite
nobind
persist-key
persist-tun
ca ca.crt
cert client1.crt
key client1.key
remote-cert-tls server
tls-auth ta.key 1
cipher AES-256-GCM
connect-retry-max 25
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä wintun –∏ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –¥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ openvpn gui
windows-driver wintun
verb 3
</code></pre>
<h3 id="client_1">Client</h3>
<p><code>iwr -Uri https://openvpn.net/downloads/openvpn-connect-v3-windows.msi -OutFile "$home\downloads\OpenVPN-Connect-3.msi"</code> <br />
–ü–µ—Ä–µ–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –∫–ª—é—á–∏: <br />
<code>client.ovpn</code> <br />
<code>ca.crt</code> <br />
<code>dh.pem</code> <br />
<code>ta.key</code> <br />
<code>client1.crt</code> <br />
<code>client1.key</code></p>
<h3 id="route">Route</h3>
<p><code>Get-Service RemoteAccess | Stop-Service</code> <br />
<code>Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters" -Name "IPEnableRouter" -Value 1</code> –≤–∫–ª—é—á–∞–µ—Ç IP –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é <br />
<code>(Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters").IPEnableRouter</code> <br />
<code>Get-NetIPInterface | select ifIndex,InterfaceAlias,AddressFamily,ConnectionState,Forwarding | ft</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã <br />
<code>Set-NetIPInterface -ifIndex 13 -Forwarding Enabled</code> –≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—é –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ</p>
<p><code>sysctl net.ipv4.ip_forward=1</code> <br />
<code>echo "sysctl net.ipv4.ip_forward = 1" &gt;&gt; /etc/sysctl.conf</code></p>
<p><code>Get-NetRoute</code> <br />
<code>New-NetRoute -DestinationPrefix "192.168.3.0/24" -NextHop "192.168.4.1" -InterfaceIndex 8</code> <br />
<code>route -p add 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 1</code> <br />
<code>route -p change 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 2</code> <br />
<code>route -p add 192.168.3.0 mask 255.255.255.0 192.168.4.1 metric 1 if 7</code> —É–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å—ã–ª–∞—Ç—å –ø–∞–∫–µ—Ç (Wintun Userspace Tunnel) <br />
<code>route print -4</code> <br />
<code>route delete 192.168.3.0</code></p>
<p><code>tracert 192.168.3.101</code> —Å 192.168.4.6</p>
<pre><code>1    17 ms     *       22 ms  192.168.4.1
2    12 ms    13 ms    14 ms  192.168.3.101
</code></pre>
<p><code>route add -net 192.168.4.0 netmask 255.255.255.0 gw 192.168.3.100</code> <br />
<code>route -e</code></p>
<p><code>traceroute 192.168.4.6</code> —Å 192.168.3.101</p>
<pre><code>1  192.168.3.100 (192.168.3.100)  0.148 ms  0.110 ms  0.106 ms
2  192.168.4.6 (192.168.4.6)  14.573 ms * *
</code></pre>
<p><code>ping 192.168.3.101 -t</code> —Å 192.168.4.6 <br />
<code>tcpdump -n -i ens33 icmp</code> –Ω–∞ 192.168.3.101</p>
<pre><code>14:36:34.533771 IP 192.168.4.6 &gt; 192.168.3.101: ICMP echo request, id 1, seq 2962, length 40 # –æ—Ç–ø—Ä–∞–≤–∏–ª –∑–∞–ø—Ä–æ—Å
14:36:34.533806 IP 192.168.3.101 &gt; 192.168.4.6: ICMP echo reply, id 1, seq 2962, length 40 # –æ—Ç–ø—Ä–∞–≤–∏–ª –æ—Ç–≤–µ—Ç
</code></pre>
<h3 id="nat">NAT</h3>
<p><code>Get-Command -Module NetNat</code> <br />
<code>New-NetNat -Name LocalNat -InternalIPInterfaceAddressPrefix "192.168.3.0/24"</code> <br />
<code>Add-NetNatStaticMapping -NatName LocalNat -Protocol TCP -ExternalIPAddress 0.0.0.0 -ExternalPort 80 -InternalIPAddress 192.168.3.102 -InternalPort 80</code> <br />
<code>Remove-NetNatStaticMapping -StaticMappingID 0</code> <br />
<code>Remove-NetNat -Name LocalNat</code></p>
<h3 id="wireguard">WireGuard</h3>
<p><code>Invoke-WebRequest "https://download.wireguard.com/windows-client/wireguard-amd64-0.5.3.msi" -OutFile "$home\Downloads\WireGuard-Client-0.5.3.msi"</code> <br />
<code>msiexec.exe /i "$home\Downloads\WireGuard-Client-0.5.3.msi" DO_NOT_LAUNCH=1 /qn</code> <br />
<code>Invoke-WebRequest "http://www.wiresock.net/downloads/wiresock-vpn-gateway-x64-1.1.4.1.msi" -OutFile "$home\Downloads\WireSock-VPN-Gateway-1.1.4.1.msi"</code> <br />
<code>msiexec.exe /i "http://www.wiresock.net/downloads/wiresock-vpn-gateway-x64-1.1.4.1.msi" /qn</code> <br />
<code>$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")</code> <br />
<code>wg-quick-config -add -start</code> <br />
<code>26.115.154.67:8181</code> <br />
<code>192.168.21.4/24</code> <br />
<code>Successfully saved client configuration: C:\ProgramData\NT KERNEL\WireSock VPN Gateway\wsclient_1.conf</code> <br />
<code>Successfully saved server configuration: C:\ProgramData\NT KERNEL\WireSock VPN Gateway\wiresock.conf</code> <br />
<code>get-service *wire*</code> <br />
<code>wg show</code> <br />
<code>wg-quick-config -add -restart</code> add client</p>
<p>wiresock.conf</p>
<pre><code>[Interface]
PrivateKey = gCHC0g2JPwr6sXPiaOL4/KTkMyjN9TculrJUA/GORV8=
Address = 192.168.21.5/24
ListenPort = 8181

[Peer]
PublicKey = NoSxjew2RCHiUzI6mlahjd4I+0EcLsoYom/H01z91yU=
AllowedIPs = 192.168.21.6/32
</code></pre>
<p>wsclient_1.conf (–¥–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –≤ AllowedIPs)</p>
<pre><code>[Interface]
PrivateKey = yIpRQRmaGrrk9Y+49E8JhEpFmKzSeecvUAdeNgf1hUM=
Address = 192.168.21.6/24
DNS = 8.8.8.8, 1.1.1.1
MTU = 1420

[Peer]
PublicKey = Fp7674VSYeGj8CYt6RCKR7Qz1y/IKUXCw8ImOFhX3hk=
AllowedIPs = 192.168.21.0/24, 192.168.3.0/24
Endpoint = 26.115.154.67:8181
PersistentKeepalive = 25
</code></pre>
<h3 id="vpnclient">VpnClient</h3>
<p><code>Get-Command -Module VpnClient</code> <br />
<code>Add-VpnConnection -Name "vpn-failon" -ServerAddress "26.115.154.67" -TunnelType L2TP -L2tpPsk "123098" -EncryptionLevel "Required" -AuthenticationMethod MSChapv2 -RememberCredential -AllUserConnection ‚ÄìPassThru -Force</code> <br />
<code>-TunnelType PPTP/L2TP/SSTP/IKEv2/Automatic</code> <br />
<code>-L2tpPsk</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–π –∫–ª—é—á –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –¥–ª—è L2TP –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç) <br />
<code>-AuthenticationMethod Pap/Chap/MSChapv2/Eap/MachineCertificate</code> <br />
<code>-EncryptionLevel NoEncryption/Optional/Required/Maximum/Custom</code> <br />
<code>-SplitTunneling</code> –∑–∞–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ VPN-—Ç—É–Ω–Ω–µ–ª—å (–≤–∫–ª—é—á–µ–Ω–∏–µ Use default gateway on remote network –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ VPN –∞–¥–∞–ø—Ç–µ—Ä–∞) <br />
<code>-UseWinlogonCredential</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ VPN —Å–µ—Ä–≤–µ—Ä–µ <br />
<code>-RememberCredential</code> —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –∏ –ø–∞—Ä–æ–ª—å —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–∏—Å–ø–µ—Ç—á–µ—Ä —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö Windows –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è) <br />
<code>-DnsSuffix domain.local</code> <br />
<code>-AllUserConnection</code> —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª: C:\ProgramData\Microsoft\Network\Connections\Pbk\rasphone.pbk)</p>
<p><code>Install-Module -Name VPNCredentialsHelper</code> –º–æ–¥—É–ª—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–∏–Ω–∞ –∏ –ø–∞—Ä–æ–ª—è –≤ Windows Credential Manager –¥–ª—è VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è <br />
<code>Set-VpnConnectionUsernamePassword -connectionname vpn-failon -username user1 -password password</code></p>
<p><code>rasdial "vpn-failon"</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è <br />
<code>Get-VpnConnection -AllUserConnection | select *</code> —Å–ø–∏—Å–æ–∫ VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–∞–π—Å—Ç—Ä–æ–π–∫–∏ –∏ —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (ConnectionStatus) <br />
<code>Add-VpnConnectionRoute -ConnectionName vpn-failon -DestinationPrefix 192.168.3.0/24 ‚ÄìPassThru</code> –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –º–∞—Ä—à—Ä—É—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–µ–Ω –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ VPN <br />
<code>Remove-VpnConnection -Name vpn-failon -AllUserConnection -Force</code> —É–¥–∞–ª–∏—Ç—å</p>
<p><code>Set-VpnConnection -Name "vpn-failon" -SplitTunneling $True</code> –≤–∫–ª—é—á–∏—Ç—å —Ä–∞–∑–¥–µ–ª—å–Ω–æ–µ —Ç—É–Ω–µ–ª–ª–∏—Ä–æ–≤–∞–Ω–∏–µ <br />
<code>Add-VpnConnectionRoute -ConnectionName "vpn-failon" -DestinationPrefix 172.22.22.0/24</code> –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏ —á–µ—Ä–µ–∑ VPN-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ <br />
<code>(Get-VpnConnection -ConnectionName "vpn-failon").routes</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è <br />
<code>Remove-VpnConnectionRoute -ConnectionName "vpn-failon" -DestinationPrefix "172.22.23.0/24"</code></p>
<h3 id="proxyclient">ProxyClient</h3>
<p><code>$user = "lifailon"</code> <br />
<code>$pass = "Proxy"</code> <br />
<code>$SecureString = ConvertTo-SecureString $pass -AsPlainText -Force</code> <br />
<code>$Credential = New-Object System.Management.Automation.PSCredential($user, $SecureString)</code> <br />
<code>[System.Net.Http.HttpClient]::DefaultProxy = New-Object System.Net.WebProxy("http://192.168.3.100:9090")</code> <br />
<code>[System.Net.Http.HttpClient]::DefaultProxy.Credentials = [System.Net.CredentialCache]::DefaultCredentials</code> <br />
<code>[System.Net.Http.HttpClient]::DefaultProxy.Credentials = $Credential</code> <br />
<code>Invoke-RestMethod http://ifconfig.me/ip</code> —É–∑–Ω–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π ip-–∞–¥—Ä–µ—Å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±—É–¥—É—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –∑–∞–¥–∞–Ω–Ω—ã–π –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä) <br />
<code>Invoke-RestMethod https://kinozal.tv/rss.xml</code></p>
<h3 id="netsh">netsh</h3>
<h3 id="reverse-proxy">Reverse Proxy</h3>
<p><code>netsh interface portproxy add v4tov4 listenport=8080 listenaddress=0.0.0.0 connectport=80 connectaddress=192.168.3.108</code> –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–µ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ 8080 –ø–æ—Ä—Ç—É –∏ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ 80 –ø–æ—Ä—Ç —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞ <br />
<code>netsh interface portproxy show all</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ <br />
<code>netsh interface portproxy delete v4tov4 listenport=8080 listenaddress=0.0.0.0</code> —É–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—é</p>
<h3 id="wlan">Wlan</h3>
<p><code>netsh wlan show profile</code> —Å–ø–∏—Å–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã –ø—Ä–æ—Ñ–∏–ª–µ–π Wi-Fi –∏ –ø–∞—Ä–æ–ª–µ–π <br />
<code>netsh wlan show interfaces</code> —Ö–∞—Ä-–∫–∏ —Ç–µ–∫—É—â–µ–π —Å–µ—Ç–∏ (MAC, speed) <br />
<code>netsh wlan show profile SSID-Name-Network key=clear</code> –æ—á–∏—Å—Ç–∏—Ç—å –ø–∞—Ä–æ–ª—å <br />
<code>netsh wlan show networks</code> —Å–ø–∏—Å–æ–∫ –≤–∏–¥–µ–º—ã—Ö —Å–µ—Ç–µ–π <br />
<code>netsh wlan disconnect</code> –æ—Ç–∫–ª—é—á–∏—Ç—å—Å—è –æ—Ç Wi-Fi <br />
<code>netsh wlan connect name="SSID-Name-Network"</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è <br />
<code>netsh wlan show drivers</code> –¥—Ä–∞–π–≤–µ—Ä Wi-Fi <br />
<code>netsh wlan set hostednetwork mode=allow ssid="WiFi-Test" key="password"</code> —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ Wi-Fi (SoftAP)</p>
<h3 id="firewall_1">Firewall</h3>
<p><code>netsh advfirewall set allprofiles state off</code> –æ—Ç–∫–ª—é—á–∏—Ç—å fw <br />
<code>netsh advfirewall reset</code> —Å–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ <br />
<code>netsh advfirewall firewall add rule name="Open Remote Desktop" protocol=TCP dir=in localport=3389 action=allow</code> –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç 3389 <br />
<code>netsh advfirewall firewall add rule name="All ICMP V4" dir=in action=allow protocol=icmpv4</code> –æ—Ç–∫—Ä—ã—Ç—å icmp</p>
<h3 id="openssh">OpenSSH</h3>
<p><code>Get-WindowsCapability -Online | ? Name -like 'OpenSSH.Client*'</code> <br />
<code>Add-WindowsCapability -Online -Name OpenSSH.Client*</code> <br />
<code>dism /Online /Add-Capability /CapabilityName:OpenSSH.Client~~~~0.0.1.0</code> <br />
<code>iwr https://github.com/PowerShell/Win32-OpenSSH/releases/download/v9.2.2.0p1-Beta/OpenSSH-Win64-v9.2.2.0.msi -OutFile $home\Downloads\OpenSSH-Win64-v9.2.2.0.msi</code> —Å–∫–∞—á–∞—Ç—å <br />
<code>msiexec /i $home\Downloads\OpenSSH-Win64-v9.2.2.0.msi</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å msi –ø–∞–∫–µ—Ç <br />
<code>Set-Service sshd -StartupType Automatic</code> <br />
<code>Get-NetTCPConnection | where LocalPort -eq 22</code> <br />
<code>New-NetFirewallRule -Name sshd -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22</code> <br />
<code>Get-NetFirewallRule -Name *ssh*</code> <br />
<code>Start-Process notepad++ C:\Programdata\ssh\sshd_config</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª <br />
<code>GSSAPIAuthentication yes</code> –≤–∫–ª—é—á–∏—Ç—å Kerberos –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (—á–µ—Ä–µ–∑ AD) <br />
<code>SyslogFacility LOCAL0</code> –≤–∫–ª—é—á–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ –≤ —Ñ–∞–π–ª (C:\ProgramData\ssh\logs\sshd.log) <br />
<code>LogLevel INFO</code> <br />
<code>Restart-Service sshd</code> <br />
<code>ssh -K $srv</code> –≤—ã–ø–æ–ª–Ω–∏—Ç—å Kerberos –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é <br />
<code>ssh Lifailon@192.168.3.99 -p 22</code> <br />
<code>pwsh -command Get-Service</code> <br />
<code>ssh -L 3101:192.168.3.101:22 -R 3101:192.168.3.101:22 lifailon@192.168.3.101 -p 22</code> SSH Tunnel lifailon@localhost:3101 -&gt; 192.168.3.101:3101</p>
<h3 id="psremoting-over-ssh">PSRemoting over SSH</h3>
<p><code>Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0</code> —É—Å—Ç–∞–Ω–æ–≤–∫–∞ OpenSSH Server <br />
<code>Get-WindowsCapability -Online | ? Name -like 'OpenSSH.Ser*'</code> <br />
<code>iex "&amp; { $(irm https://aka.ms/install-powershell.ps1) } -UseMSI"</code> —É—Å—Ç–∞–Ω–æ–≤–∫–∞ PowerShell Core –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–µ) <br />
<code>Set-Service -Name sshd -StartupType "Automatic"</code> <br />
<code>Start-Service sshd</code> <br />
<code>Get-NetTCPConnection -State Listen|where {$_.localport -eq '22'}</code> <br />
<code>Enable-NetFirewallRule -Name *OpenSSH-Server*</code> <br />
<code>New-ItemProperty -Path "HKLM:\SOFTWARE\OpenSSH" -Name DefaultShell -Value "C:\Program Files\PowerShell\7\pwsh.exe" -PropertyType String ‚ÄìForce</code> –∏–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–∏—Ç–∞—Ç–æ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ pwsh <br />
<code>notepad $Env:ProgramData\ssh\sshd_config</code></p>
<p>PasswordAuthentication yes <br />
Subsystem powershell c:/progra~1/powershell/7/pwsh.exe -sshs -NoLogo # –∑–∞–ø—É—Å–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ pwsh –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω—ã—Ö SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π</p>
<p><code>Restart-Service sshd</code></p>
<p><code>$session = New-PSSession -HostName 192.168.3.100 -Port 2121 -UserName lifailon -SSHTransport</code> <br />
<code>Invoke-Command -Session $session -ScriptBlock {Get-Service}</code></p>
<h3 id="winrm">WinRM</h3>
<p><code>Enter-PSSession -ComputerName $srv</code> –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PowerShell —Å–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ PSRemoting. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ FQDN-–∏–º–µ–Ω–∏ <br />
<code>Invoke-Command $srv -ScriptBlock {Get-ComputerInfo}</code> –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ PSRemoting <br />
<code>$session = New-PSSession $srv</code> –æ—Ç–∫—Ä—ã—Ç—å —Å–µ—Å—Å–∏—é <br />
<code>Get-PSSession</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ <br />
<code>icm -Session $session {$srv = $using:srv}</code> –ø–µ—Ä–µ–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ ($using) –≤ —É–¥–∞–ª–µ–Ω–Ω—É—é <br />
<code>Disconnect-PSSession $session</code> –∑–∞–∫—Ä—ã—Ç—å —Å–µ—Å—Å–∏—é <br />
<code>Remove-PSSession $session</code> —É–¥–∞–ª–∏—Ç—å —Å–µ—Å—Å–∏—é <br />
<code>Import-Module -Name ActiveDirectory -PSSession $srv</code> –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å —Å —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ –ª–æ–∫–∞–ª—å–Ω—É—é —Å–µ—Å—Å–∏—é</p>
<h3 id="windows-remote-management-configuration">Windows Remote Management Configuration</h3>
<p><code>winrm quickconfig -quiet</code> –∏–∑–º–µ–Ω–∏—Ç –∑–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã WinRM –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π, –∑–∞–¥–∞—Å—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ WinRM –∏ –¥–æ–±–∞–≤–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –ø–æ—Ä—Ç–æ–≤ –≤ fw <br />
<code>Enable-PSRemoting ‚ÄìForce</code> –≤–∫–ª—é—á–∏—Ç—å PowerShell Remoting, —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ–º–µ–Ω–Ω–æ–≥–æ –∏ —á–∞—Å—Ç–Ω–æ–≥–æ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π Windows <br />
<code>Enable-PSRemoting -SkipNetworkProfileCheck -Force</code> –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ –æ–±—â–µ–π (public) —Å–µ—Ç–∏ (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤–µ—Ä—Å–∏–∏ powershell 6)</p>
<p><code>$NetProfiles = Get-NetConnectionProfile</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ —Å–µ—Ç–µ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π <br />
<code>Set-NetConnectionProfile -InterfaceIndex $NetProfiles[1].InterfaceIndex -NetworkCategory Private</code> –∏–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø —Å–µ—Ç–∏ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è (DomainAuthenticated/Public) <br />
<code>(Get-CimInstance -ClassName Win32_ComputerSystem).PartOfDomain</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–æ–º–ø—å—é—Ç–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –¥–æ–º–µ–Ω AD <br />
<code>Get-Service WinRM | Set-Service -StartupType AutomaticDelayedStart</code> –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ <br />
<code>Get-Service -Name winrm -RequiredServices</code> —Å—Ç–∞—Ç—É—Å –∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–ª—É–∂–± <br />
<code>New-NetFirewallRule -Profile Any -DisplayName "WinRM HTTP" -Direction Inbound -Protocol TCP -LocalPort 5985,5986</code> <br />
<code>Test-NetConnection $srv -port 5895</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç <br />
<code>Test-WSMan $srv -ErrorAction Ignore</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É WinRM –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –æ—à–∏–±–æ–∫ –¥–ª—è —Å–∫—Ä–∏–ø—Ç–∞) –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ (localhost)</p>
<p><code>$Cert = New-SelfSignedCertificate -CertStoreLocation Cert:\LocalMachine\My -DnsName "$env:computername" -FriendlyName "WinRM HTTPS Certificate" -NotAfter (Get-Date).AddYears(5)</code> —Å–æ–∑–¥–∞—Ç—å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç <br />
<code>$Thumbprint = $Cert.Thumbprint</code> –∑–∞–±—Ä–∞—Ç—å –æ—Ç–ø–µ—á–∞—Ç–æ–∫ <br />
<code>New-Item -Path WSMan:\Localhost\Listener -Transport HTTPS -Address * -CertificateThumbprint $Thumbprint -Name WinRM_HTTPS_Listener -Force</code> —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å–ª—É—à–∏–≤–∞—Ç–µ–ª—å <br />
<code>New-NetFirewallRule -DisplayName 'WinRM HTTPS' -Profile Domain,Private -Direction Inbound -Action Allow -Protocol TCP -LocalPort 5986</code> –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç –≤ fw</p>
<pre><code>$selector_set = @{
    Address = &quot;*&quot;
    Transport = &quot;HTTPS&quot;
}
$value_set = @{
    CertificateThumbprint = &quot;66ABFDA044D8C85135048186E2FDC0DBE6125163&quot;
}
New-WSManInstance -ResourceURI &quot;winrm/config/Listener&quot; -SelectorSet $selector_set -ValueSet $value_set
</code></pre>
<p><code>winrm get winrm/config</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (Client/Service) <br />
<code>winrm get winrm/config/service/auth</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ <br />
<code>winrm enumerate winrm/config/listener</code> —Ç–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞—Ç–µ–ª–µ–π WinRM (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ—Ç–ø–µ—á–∞—Ç–æ–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –¥–ª—è HTTPS 5986) <br />
<code>Get-ChildItem -Path Cert:\LocalMachine\My\ | where Thumbprint -eq D9356FB774EE0E6206B7D5B59B99102CA5B17BDA | select *</code> –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ</p>
<p><code>ls WSMan:\localhost\Client</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∫–ª–∏–µ–Ω—Ç–∞ <br />
<code>ls WSMan:\localhost\Service</code> –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ <br />
<code>ls WSMan:\localhost\Service\auth</code> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ WinRM —Å–µ—Ä–≤–µ—Ä–∞ <br />
<code>Set-Item -path WSMan:\localhost\Service\auth\basic -value $true</code> —Ä–∞–∑—Ä–µ—à–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∫ —Ç–µ–∫—É—â–µ–º—É —Å–µ—Ä–≤–µ—Ä—É <br />
<code>ls HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\WSMAN</code> –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ä–µ–µ—Å—Ç—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –∞—É–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ \Service\auth_basic = 1) <br />
<code>Set-Item WSMan:\localhost\Client\TrustedHosts -Value 192.168.* -Force</code> –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ö–æ—Å—Ç—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ, —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–∞ Negotiate –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ NTLM <br />
<code>Set-Item WSMan:\localhost\Client\TrustedHosts -Value 192.168.3.100 -Concatenate -Force</code> –¥–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä <br />
<code>ls WSMan:\localhost\Client\TrustedHosts</code> <br />
<code>Set-Item WSMan:\localhost\Client\AllowUnencrypted $true</code> –≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á–∞ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ <br />
<code>Set-Item WSMan:\localhost\Service\AllowUnencrypted $true</code> –≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á–∞ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—ã—Ç—å –≤ private —Å–µ—Ç–∏)</p>
<p><code>Get-PSSessionConfiguration</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤–∫–ª—é—á–µ–Ω –ª–∏ PSremoting –∏ –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø, –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ WinRM <br />
<code>Set-PSSessionConfiguration -Name Microsoft.PowerShell -ShowSecurityDescriptorUI</code> –Ω–∞–∑–Ω–∞—á–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ (–¥–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∫–∏) <br />
<code>(Get-PSSessionConfiguration -Name "Microsoft.PowerShell").SecurityDescriptorSDDL</code> –ø–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ SDDL <br />
<code>Set-PSSessionConfiguration -Name Microsoft.PowerShell -SecurityDescriptorSDDL $SDDL</code> –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –Ω–∞ –¥—Ä—É–≥–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GUI </p>
<p><code>New-LocalUser "WinRM-Writer" -Password (ConvertTo-SecureString -AsPlainText "123098")</code> —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br />
<code>Add-LocalGroupMember -Group "Remote Management Users" -Member "WinRM-Writer"</code> –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è WinRM-Writer –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –≥—Ä—É–ø–ø—É –¥–æ—Å—Ç—É–ø–∞ "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è" <br />
<code>cmdkey /add:192.168.3.99 /user:WinRM-Writer /pass:123098</code> —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ CredentialManager<br />
<code>cmdkey /list</code> <br />
<code>Import-Module CredentialManager</code> <br />
<code>Add-Type -AssemblyName System.Web</code> <br />
<code>New-StoredCredential -Target 192.168.3.99 -UserName WinRM-Writer -Password 123098 -Comment WinRM</code> —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ CredentialManager (–∏–∑ PS5) <br />
<code>Get-StoredCredential -AsCredentialObject</code> <br />
<code>$cred = Get-StoredCredential -Target 192.168.3.99</code> <br />
<code>Enter-PSSession -ComputerName 192.168.3.99 -Credential $cred -Authentication Negotiate</code> <br />
<code>Enter-PSSession -ComputerName 192.168.3.99 -Credential $cred -Authentication Basic -Port 5985</code> —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ allowunencrypted –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∫–ª–∏–µ–Ω—Ç–∞ <br />
<code>winrs -r:http://192.168.3.100:5985/wsman -u:WinRM-Writer -p:123098 ipconfig</code> –ø–µ—Ä–µ–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—É —á–µ—Ä–µ–∑ winrs (-?) <br />
<code>winrs -r:https://192.168.3.100:5985/wsman -u:WinRM-Writer -p:123098 -ssl ipconfig</code> —á–µ—Ä–µ–∑ https <br />
<code>pwsh -Command "Install-Module -Name PSWSMan"</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ Linux —Å–∏—Å—Ç–µ–º–µ</p>
<h3 id="kerberos">Kerberos</h3>
<p><code>.\CheckMaxTokenSize.ps1 -Principals login -OSEmulation $true -Details $true</code> —É–∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ç–æ–∫–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –¥–æ–º–µ–Ω–µ <br />
<code>Get-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Parameters | select maxtokensize</code> –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ <br />
<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\HTTP\Parameters</code> –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä–∞, –µ—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø–∞–∫–µ—Ç–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 16 –ö–± (–∏–∑ –∑–∞ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª-–≤–∞ –≥—Ä—É–ø–ø) <br />
<code>MaxFieldLength —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 0000ffff (65535)</code> <br />
<code>MaxRequestBytes —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 0000ffff (65535)</code></p>
<h3 id="console-download">Console-Download</h3>
<p><code>Install-Module Console-Download -Repository NuGet</code> —É—Å—Ç–∞–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å –∏–∑ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤ NuGet <br />
<code>Invoke-Expression $(Invoke-RestMethod "https://raw.githubusercontent.com/Lifailon/Console-Download/rsa/module/Console-Download/Console-Download.psm1")</code> –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å –∏–∑ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤ —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é PowerShell <br />
<code>Invoke-Download -Url "https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip"</code> –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –≤ –æ–¥–∏–Ω –ø–æ—Ç–æ–∫ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —Å–∫–æ—Ä–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω (–ø—É—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: $home\downloads) <br />
<code>Invoke-Download -Url "https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip" -Thread 3</code> –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç–∂–µ —Ñ–∞–π–ª –≤ 3 –ø–æ—Ç–æ–∫–∞ (—Å–æ–∑–¥–∞–µ—Ç—Å—è 3 —Ñ–∞–π–ª–∞, –¥–æ—Å—Ç—É–ø–Ω–æ –æ—Ç 1 –¥–æ 20 –ø–æ—Ç–æ–∫–æ–≤)</p>
<pre><code class="language-PowerShell">$urls = @(
    &quot;https://github.com/PowerShell/PowerShell/releases/download/v7.4.2/PowerShell-7.4.2-win-x64.zip&quot;,
    &quot;https://github.com/Lifailon/helperd/releases/download/0.0.1/Helper-Desktop-Setup-0.0.1.exe&quot;
)
Invoke-Download $urls # –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ 2 —Ñ–∞–π–ª–∞
</code></pre>
<p><code>$urls = Get-Content "$home\Desktop\links.txt"</code> <br />
<code>Invoke-Download $urls</code> –ø–µ—Ä–µ–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ URL-–∞–¥—Ä–µ—Å–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤, —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ–º—É —á–∏—Å–ª—É url</p>
<p><code>$urls = Get-LookingGlassList</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ Looking Glass —á–µ—Ä–µ–∑ Looking.House (–≤—ã–¥–∞–µ—Ç 3 —Å—Å—ã–ª–∫–∏ –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤ –ø–æ 10, 100 –∏ 1000 –º–±–∞–π—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞) <br />
<code>$usaNy = $urls | Where-Object region -like *USA*New*York*</code> –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ —Ä–µ–≥–∏–æ–Ω—É –∏ –≥–æ—Ä–æ–¥—É <br />
<code>$url = $usaNy[0].url100mb</code> –∑–∞–±—Ä–∞—Ç—å –ø–µ—Ä–≤—É—é —Å—Å—ã–ª–∫—É —Å —Ñ–∞–π–ª–æ–≤ –Ω–∞ 100 –ú–ë–∞–π—Ç <br />
<code>Invoke-Download $url</code> –Ω–∞—á–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–∞ <br />
<code>Invoke-Download $url -Thread 3</code> –Ω–∞—á–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É 3-—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤</p>
<h3 id="psdomaintest">PSDomainTest</h3>
<p><code>Install-Module PSDomainTest -Repository NuGet -Scope CurrentUser</code> <br />
<code>Get-DomainTest -Domain github.com -Warning</code> –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ–º–µ–Ω –∏ DNS –∑–∞–ø–∏—Å–∏ –Ω–∞ –æ—à–∏–±–∫–∏ (–≤—ã–≤–µ—Å—Ç–∏ —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏) —á–µ—Ä–µ–∑ ZoneMaster (https://github.com/zonemaster/zonemaster) <br />
<code>Get-DomainTest -Domain github.com -Warning -json</code> –≤—ã–≤–æ–¥ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json <br />
<code>Get-DomainTest -Domain github.com -html | Out-File .\result.html</code> –ø–æ–ª—É—á–∏—Ç—å –æ—Ç—á–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ HTML-—Ç–∞–±–ª–∏—Ü—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º</p>
<h2 id="check-host">Check-Host</h2>
<pre><code class="language-PowerShell">$path = $(($env:PSModulePath -split &quot;;&quot;)[0]) + &quot;\Get-CheckHost&quot;
if (Test-Path $path) {
    Remove-Item $path -Force -Recurse
    New-Item -ItemType Directory -Path $path
} else {
    New-Item -ItemType Directory -Path $path
}
Invoke-RestMethod &quot;https://raw.githubusercontent.com/Lifailon/Check-Host/rsa/Get-CheckHost/Get-CheckHost.psm1&quot; -OutFile &quot;$path\Get-CheckHost.psm1&quot;
</code></pre>
<p><code>Install-Module CheckHost</code> —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å Check-Host (https://check-host.net) —á–µ—Ä–µ–∑ api <br />
<code>Get-CheckHost -List</code> —Å–ø–∏—Å–æ–∫ —Ö–æ—Å—Ç–æ–≤ (node) —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ (40) <br />
<code>Get-CheckHost -Server google.com -Type ping -Count 5</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 5 –ª—é–±—ã—Ö —Ö–æ—Å—Ç–æ–≤ –¥–ª—è 4 –ø–∏–Ω–≥–æ–≤ —Å –∫–∞–∂–¥–æ–≥–æ –¥–æ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ url (google) <br />
<code>Get-CheckHost -Server google.com -Type dns -Count 5</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å DNS (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ê-–∑–∞–ø–∏—Å—å –∏–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω —Å ip-–∞–¥—Ä–µ—Å–æ–º) <br />
<code>Get-CheckHost -Server google.com:443 -Type http -Count 5</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–∞ <br />
<code>Get-CheckHost -Server google.com:443 -Type tcp -Count 5</code> –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å TCP –∏–ª–∏ UDP –ø–æ—Ä—Ç–∞</p>
<h2 id="syslog">Syslog</h2>
<h3 id="psyslog">pSyslog</h3>
<p><code>Install-Module pSyslog -Repository NuGet</code> <br />
<code>Start-pSyslog -Port 514</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 514 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) <br />
<code>Start-pSyslog -RotationSize 500</code> —É–∫–∞–∑–∞—Ç—å —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∂—É—Ä–Ω–∞–ª–∞ –¥–ª—è –µ–≥–æ —Ä–æ—Ç–∞—Ü–∏–∏ (–æ–±—Ä–µ–∑–∞–Ω–∏—è) –≤ –ö–ë <br />
<code>Get-pSyslog -Status | Format-List</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã <br />
<code>Get-pSyslog</code> –≤—ã–≤–µ—Å—Ç–∏ –∂—É—Ä–Ω–∞–ª —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ <br />
<code>Stop-pSyslog</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä <br />
<code>Send-pSyslog -Content "Test" -Server 192.168.3.99</code> –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ Syslog-—Å–µ—Ä–≤–µ—Ä <br />
<code>Send-pSyslog -Content "Test" -Server 192.168.3.99 -Type Informational -PortServer 514 -PortClient 55514</code> <br />
<code>(Get-Service -Name WinRM).Status | Send-pSyslog -Server 192.168.3.102 -Tag Service[WinRM]</code> <br />
<code>Send-pSyslog -Content "test" -Server 192.168.3.99 -PortServer 514 -Base64</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è (—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ pSyslog) <br />
<code>Start-UDPRelay -inPort 515 -outIP 192.168.3.102 -outPort 514</code> –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –≤ —Ä–µ–∂–∏–º–µ UDP-Relay, –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 515 –∏ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ Syslog —Å–µ—Ä–≤–µ—Ä 192.168.3.102 —Å –ø–æ—Ä—Ç–æ–º 514 <br />
<code>Send-pSyslog -Server 192.168.3.99 -PortServer 515 -Content $(Get-Date)</code> –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ UDP-Relay <br />
<code>Show-pSyslog -Type Warning -Count</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫) <br />
<code>Show-pSyslog -Type Alert -Count</code> <br />
<code>Show-pSyslog -Type Critical -Count</code> <br />
<code>Show-pSyslog -Type Error -Count</code> <br />
<code>Show-pSyslog -Type Emergency -Count</code> <br />
<code>Show-pSyslog -Type Informational -Count</code> <br />
<code>Show-pSyslog -LogFile 05-06 | Out-GridView</code> –ø—Ä–æ—á–∏—Ç–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –∂—É—Ä–Ω–∞–ª –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤—ã–≤–µ—Å—Ç–∏ –≤ GridView –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π <br />
<code>Show-pSyslog -Count</code> –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∂—É—Ä–Ω–∞–ª–∞ <br />
<code>Show-pSyslog -Count -LogFile 10-06</code> –≤—ã–±—Ä–∞—Ç—å –∂—É—Ä–Ω–∞–ª –ø–æ –¥–∞—Ç–µ</p>
<h3 id="syslog-source-message">Syslog source message</h3>
<pre><code class="language-PowerShell">Add-Type -TypeDefinition @&quot;
public enum Syslog_Facility {
    kern,     // 0  kernel (core) messages
    user,     // 1  user level messages
    mail,     // 2  mail system
    daemon,   // 3  system daemons
    auth,     // 4  security/authorization messages (login/su)
    syslog,   // 5  syslog daemon
    lpr,      // 6  line printer subsystem (creating jobs and send to spool for print by using lpd)
    news,     // 7  network news subsystem (USENET)
    uucp,     // 8  Unix-to-Unix Copy subsystem
    cron,     // 9  scheduling daemon
    authpriv, // 10 security/authorization private messages
    ftp,      // 11 FTP daemon
    ntp,      // 12 NTP daemon
    security, // 13 security log audit
    console,  // 14 console log alert
    clock,    // 15 clock subsystem
    local0,   // 16 local use
    local1,   // 17
    local2,   // 18
    local3,   // 19
    local4,   // 20
    local5,   // 21
    local6,   // 22
    local7    // 23
}
&quot;@
</code></pre>
<h3 id="syslog-type-message">Syslog type message</h3>
<pre><code class="language-PowerShell">Add-Type -TypeDefinition @&quot;
public enum Syslog_Severity {
    Emergency,     // 0 emerg
    Alert,         // 1 alert
    Critical,      // 2 crit
    Error,         // 3 err
    Warning,       // 4 warning
    Notice,        // 5 notice
    Informational, // 6 info
    Debug          // 7 debug
}
&quot;@
</code></pre>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright ¬© 2023-2024 Alex Kup (Lifailon)
    </div>
  
  
  PowerShell Commands on
  <a href="https://github.com/Lifailon/PS-Commands" target="_blank" rel="noopener">
    GitHub
  </a>
  | Theme
  <a href="https://github.com/squidfunk/mkdocs-material" target="_blank" rel="noopener">
    Material
  </a>
  for
  <a href="https://github.com/mkdocs/mkdocs" target="_blank" rel="noopener">
    MkDocs
  </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/Lifailon/PS-Commands" target="_blank" rel="noopener" title="PS-Commands on Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dd8806f2.min.js"></script>
      
        <script src="../assets/highlight/highlight.min.js"></script>
      
        <script src="../assets/highlight/powershell.min.js"></script>
      
        <script src="../assets/highlight/init.js"></script>
      
    
  </body>
</html>